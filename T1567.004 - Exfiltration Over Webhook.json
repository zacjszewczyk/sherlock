[
  {
    "Is the adversary exfiltrating data over webhook? (TA0010 - Exfiltration)": {
      "Indicators": {
        "T1567.004 - Exfiltration Over Webhook": {
          "Unusual HTTP/S POST requests from internal hosts to external webhook domains or IP addresses that are not part of sanctioned services.": {
            "Data": "Zeek http.log; Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek http.log for external POST requests, particularly those with large body sizes or unusual content types. Identify destination domains/IPs that are not whitelisted or commonly used services. Use descriptive statistics to find outliers in request size or frequency per host/user. Correlate with Zeek conn.log to identify associated connections."
          },
          "Outbound network connections or API calls originating from sanctioned SaaS/collaboration services (e.g., Slack, Discord, Github) to newly observed external webhook URLs.": {
            "Data": "Zeek conn.log; Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for new or low-frequency outbound connections to external domains/IPs. Analyze Zeek http.log for connections to known SaaS/collaboration services (e.g., Discord, Slack) and identify outbound requests *from* these services targeting *other* external destinations. Use entropy analysis on destination URLs or connection patterns to flag potentially randomized or unusual endpoints."
          },
          "Large outbound HTTP/S POST requests to known public webhook or collaboration service domains (e.g., discord.com, slack.com, webhook.site).": {
            "Data": "Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek http.log for POST requests targeting domains of known public webhook or collaboration services (e.g., `*discord.com`, `*slack.com`, `*webhook.site`). Identify requests with unusually large `resp_body_len` or `orig_bytes`/`resp_bytes`. Use percentile analysis or IQR on `resp_body_len` per destination domain or source host to flag outliers. Investigate source host and specific request details."
          },
          "Execution of command-line utilities (e.g., curl, Invoke-WebRequest) making outbound HTTP/S POST requests to external URLs, especially to known webhook or collaboration service domains.": {
            "Data": "Windows Event ID 4688; Zeek http.log",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for execution of command-line utilities like `curl.exe`, `powershell.exe` (with `Invoke-WebRequest` or `Invoke-RestMethod`), `wget.exe`, etc. Analyze command-line arguments for outbound URLs, specifically looking for `POST` methods and domains associated with public webhook or collaboration services. Correlate process execution events with Zeek http.log entries from the same source IP and timestamp showing corresponding HTTP/S POST requests. Use frequency analysis to identify rare command line patterns or destinations."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]