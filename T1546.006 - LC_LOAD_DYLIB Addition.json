[
  {
    "Is the adversary establishing or maintaining persistence using LC_LOAD_DYLIB injection? (TA0003 - Persistence)": {
      "Indicators": {
        "T1546.006 - LC_LOAD_DYLIB Addition": {
          "Suspicious processes modifying executable binary headers (e.g., Mach-O files).": {
            "Data": "Host File System/Process Logs",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor host file system events and process activity for modifications to executable files in system or application directories. Use correlation analysis to link binary modifications to suspicious processes or user accounts. Flag modifications not coinciding with scheduled software updates."
          },
          "Executable binaries exhibiting invalid or missing digital signatures or altered checksums.": {
            "Data": "Host File Integrity Monitoring Logs",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Regularly calculate checksums or verify digital signatures for critical system and application binaries. Compare current checksums/signatures against known good values. Flag binaries with invalid or missing signatures. Use time series analysis to identify unusual frequency or timing of signature invalidation events across the environment."
          },
          "Unexpected dynamic libraries being loaded by legitimate system or application processes from non-standard paths.": {
            "Data": "Host Process Module Load Logs; Host Process Execution Logs",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor host logs for events indicating a process loading a dynamic library (e.g., macOS `DYLD_INSERT_LIBRARIES` usage, `dlopen`, specific audit events). Filter for legitimate processes loading libraries from non-standard locations (e.g., user directories, /tmp, paths not in system library lists). Use frequency analysis to baseline library loads for critical processes and flag statistically rare or newly observed libraries."
          },
          "Network connections initiated by legitimate system or application processes that have loaded suspicious dynamic libraries, especially to unusual destinations.": {
            "Data": "Zeek conn.log; Host Process Module Load Logs; Host Process Execution Logs",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Zeek conn.log entries with host process execution/module load logs. Identify network connections made by processes that have loaded suspicious dynamic libraries or loaded libraries from non-standard paths. Analyze destination IPs and ports for connections to known malicious infrastructure (Threat Intelligence feeds), unusual destinations, or command and control patterns (e.g., using correlation analysis between traffic volume/timing and the process/library load activity)."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary attempting privilege escalation using LC_LOAD_DYLIB injection? (TA0004 - Privilege-Escalation)": {
      "Indicators": {
        "T1546.006 - LC_LOAD_DYLIB Addition": {
          "Execution of critical system or application binaries that have been recently modified or have invalid signatures/checksums.": {
            "Data": "Host Process Execution Logs; Host File Integrity Monitoring Logs",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process execution logs for execution of binaries previously identified with invalid signatures or recent modifications. Analyze execution patterns, including parent-child process relationships, user context, and command-line arguments, specifically for privileged processes. Correlate execution events with file modification/integrity monitoring logs."
          },
          "Processes loading unexpected dynamic libraries (dylibs), particularly those from unusual or non-standard paths.": {
            "Data": "Host Process Module Load Logs; Host Process Execution Logs",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process events for dynamic library loading. Identify loaded libraries originating from non-standard system paths (e.g., user directories, temporary folders). Use frequency analysis to identify rare or previously unseen dylibs being loaded by legitimate processes. Focus particularly on libraries loaded by processes running with elevated privileges."
          },
          "Modification or invalidation of digital signatures on executable binaries with elevated privileges (e.g., setuid/setgid binaries).": {
            "Data": "Host File Integrity Monitoring Logs; Host File System/Process Logs",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Host File Integrity Monitoring logs and file system events for changes to executable files. Filter for binaries with setuid or setgid permissions. Flag any modifications or invalidations of digital signatures for these specific privileged binaries. Use correlation analysis to link modifications to the user/process performing the change and investigate changes not associated with authorized system updates."
          },
          "Privileged system or application processes loading dynamic libraries from user-writable directories or temporary folders.": {
            "Data": "Host Process Module Load Logs; Host Process Execution Logs",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor host logs for processes loading dynamic libraries. Identify processes running with root or other elevated privileges. Flag instances where these privileged processes load dylibs located in standard user home directories (/Users/*), /tmp, or other locations not typically used for system libraries (/usr/lib, /System/Library). Use frequency analysis to identify statistically rare library loads by privileged processes and investigate potential dylib hijacking attempts."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]