[
  {
    "Has the adversary executed commands using software deployment tools? (TA0002 - Execution)": {
      "Indicators": {
        "T1072 - Software Deployment Tools": {
          "Unauthorized or unusual software deployment jobs detected on management tools (SCCM, Intune, etc.).": {
            "Data": "Software deployment tool logs",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor software deployment tool logs for new or unusual deployment jobs. Compare job initiation times, source accounts, and target systems against baseline deployment activity using time series analysis or descriptive statistics. Flag jobs initiated outside scheduled maintenance windows or by non-standard accounts."
          },
          "Execution of suspicious commands or scripts deployed via management tools.": {
            "Data": "Windows Event ID 4688; Zeek conn.log; Software deployment tool logs",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect process creation logs (Event ID 4688) and analyze scripts or binaries executed on target systems via deployment tools. Look for suspicious command-line arguments or script content (e.g., base64 encoding, remote downloads). Correlate process execution with specific deployment jobs identified in deployment tool logs. Use frequency analysis to identify rare processes executed by the deployment tool."
          },
          "Creation of suspicious processes or services on targeted endpoints following a software deployment event.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4697; Software deployment tool logs",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) and 4697 (Service Installation) on endpoints. Identify processes or services with suspicious names, locations (e.g., temp directories, user profiles), or command-line arguments. Correlate these host events with recent software deployment actions recorded in software deployment tool logs to identify suspicious post-deployment activity. Use frequency analysis to identify processes/services rarely seen across the environment or on specific endpoint types following deployments."
          },
          "Outbound network connections originating from processes deployed by management tools to known malicious or unusual external destinations.": {
            "Data": "Zeek conn.log; Windows Event ID 4688; Windows Event ID 5156",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log and Windows Event ID 5156 (Network Connection) for outbound connections from endpoints recently targeted by software deployments. Correlate network connection events with process creation events (Windows Event ID 4688) to identify the originating process and its command line. Compare destination IPs/domains against threat intelligence feeds. Use correlation analysis to link outbound connections from unusual processes back to specific deployment events or source hosts, looking for patterns indicative of C2 or data exfiltration."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Has the adversary moved laterally using software deployment tools? (TA0008 - Lateral Movement)": {
      "Indicators": {
        "T1072 - Software Deployment Tools": {
          "Network connections initiated by a software deployment tool to unexpected or unauthorized endpoints.": {
            "Data": "Zeek conn.log; Software deployment tool logs",
            "Data Platform": "Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and software deployment tool logs. Identify network connections originating from systems acting as deployment servers or targeted by recent deployments, especially if the destination is an unexpected internal host or an external IP. Map connections to deployment job targets and analyze using correlation analysis to identify unusual lateral movement patterns initiated by the tool itself or resulting from deployed code."
          },
          "Suspicious or unauthorized account logins to software deployment tool consoles or APIs.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4625; Software deployment tool logs",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect authentication logs for software deployment tools (Windows Event ID 4624, 4625, tool audit logs). Monitor for login attempts using unauthorized accounts, logins from unusual source IPs or locations, or logins occurring outside typical administrator working hours. Use correlation analysis to link suspicious logins to subsequent deployment activity and identify accounts potentially compromised for lateral movement."
          },
          "Software deployment jobs initiated from an endpoint or server not typically used for management tasks.": {
            "Data": "Software deployment tool logs; Windows Event ID 4624; Windows Event ID 4625",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze software deployment tool logs to identify the source system/IP from which a deployment job was initiated. Compare the source against a baseline of approved or typical management workstations/servers using frequency analysis or baselining techniques. Investigate logins (Windows Event ID 4624, 4625) on the deployment server originating from these unusual source IPs to identify the account used for initiation."
          },
          "Software deployment jobs targeting critical servers or a sequence of unrelated systems in a manner inconsistent with standard patch/software distribution.": {
            "Data": "Software deployment tool logs",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze software deployment tool logs, specifically focusing on the list of target systems for each job. Use correlation analysis to identify deployment jobs targeting a diverse set of machines across different organizational units or targeting critical infrastructure servers outside of routine maintenance windows. Compare targeted systems against standard deployment ring definitions or asset criticality lists. Flag deployments targeting sequences of machines that suggest path traversal or targeting high-value assets as potential lateral movement."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]