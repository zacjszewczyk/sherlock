[
  {
    "Is the adversary maintaining persistence using login/logout hooks? (TA0003 - Persistence)": {
      "Indicators": {
        "T1037.002 - Login Hook": {
          "Unauthorized modification of system login/startup scripts or configuration files (analogous to login hooks).": {
            "Data": "Windows Event ID 4657; Windows Event ID 4663",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4657 (Registry Value Set) and 4663 (File Access) for modifications to known autostart locations (e.g., Run/RunOnce registry keys, Startup folder paths, Group Policy script directories). Identify modifications performed by user accounts outside standard administrative groups. Calculate the frequency of modifications per user account and location, flagging outliers using percentile analysis."
          },
          "Execution of unusual or unauthorized scripts/executables initiated at user logon or system startup.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation). Filter for processes spawned from common logon/startup parent processes (e.g., explorer.exe, services.exe) or within a short time window after system boot. Analyze process command lines for uncommon executables or script interpreter usage. Use entropy measures on command line arguments or file names to identify potentially obfuscated payloads."
          },
          "Unusual network connections originating from processes launched at logon/startup.": {
            "Data": "Zeek conn.log; Windows Event ID 4688; Windows Event ID 5156",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate process creation events (Event ID 4688) tagged as originating from logon/startup with subsequent network connection events (Event ID 5156) and Zeek conn.log entries. Filter for connections to external or unusual internal destinations made by these specific processes. Use frequency analysis and correlation to identify processes exhibiting rare or non-baseline network communication patterns occurring immediately after user logon."
          },
          "Creation or modification of scheduled tasks configured to run at user logon or system startup by unusual accounts or locations.": {
            "Data": "Windows Event ID 4698; Windows Event ID 4702",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4698 and 4702 for task creation or modification. Filter for tasks configured with triggers 'At logon' or 'At startup'. Analyze the SubjectUserName and source IP (if available via remote management logs) of the events. Use frequency analysis or outlier detection (e.g., IQR) to identify task modifications by accounts or from locations that do not typically manage scheduled tasks."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Has the adversary elevated privileges using login/logout hooks? (TA0004 - Privilege-Escalation)": {
      "Indicators": {
        "T1037.002 - Login Hook": {
          "Scripts or executables launched via logon/startup mechanisms are running with unexpected elevated privileges.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 (Process Creation) for processes originating from logon/startup. Examine the TokenElevationType field (if auditing is configured) to determine the privilege level. Identify unexpected instances where processes launched at logon/startup run with Full or Limited elevated privileges by non-system accounts and correlate with process name and command line."
          },
          "Modifications to system autostart locations performed by low-privilege or non-standard accounts attempting to setup privileged execution.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4663",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Review Windows Event IDs 4657 and 4663 targeting autostart locations. Identify events where the SubjectUserName is a standard user or an unusual account. Correlate these modification events with subsequent privileged process creation events (from Action for Privilege Escalation) to establish a potential privilege escalation chain. Calculate correlation metrics between modification events by specific users and subsequent privileged executions."
          },
          "Correlation between low-privilege account modification of startup locations and subsequent elevated execution of processes from those locations.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4663; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify modification events (Event IDs 4657, 4663) to known startup locations by non-administrative or unusual accounts. Within a short time window (e.g., 30 minutes) after a system boot or user logon following such modification, identify process creation events (Event ID 4688) from the modified location running with elevated privileges (TokenElevationType = 'Full' or 'Limited'). Use correlation analysis to link modification events by specific low-privilege users to subsequent elevated process execution, potentially flagging specific file paths or registry keys used in the attack."
          },
          "Command line arguments or process properties of executables/scripts launched at startup containing known indicators of privilege escalation techniques.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) for processes launched from known startup locations (identified via parent process or execution time after boot/logon). Analyze the 'CommandLine' field for presence of commands or tool names associated with privilege escalation (e.g., specific UAC bypass tools, commands interacting with sensitive system components). Use string matching or regex and prioritize processes with high entropy command lines or unusual character sets often seen in obfuscated PE commands."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]