[
  {
    "Is the adversary maintaining persistence using print processors? (TA0003 - Persistence)": {
      "Indicators": {
        "T1547.012 - Print Processors": {
          "Registry key writes to the Print Processors hive (HKLM\\SYSTEM\\...\\Control\\Print\\Environments\\...).": {
            "Data": "Windows Event ID 4657",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event Logs (4657) for writes to the Print Processors Registry hive (HKLM\\SYSTEM\\...\\Control\\Print\\Environments\\...\\Print Processors). Identify writes by processes or users not typically authorized for system-level configuration. Use frequency analysis to flag unusual or unexpected writes."
          },
          "spoolsv.exe loading unexpected or unsigned DLLs from the print processor directory during system boot.": {
            "Data": "Windows Event ID 7 (Sysmon), Windows Event ID 1 (Sysmon), Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 7 (ImageLoad) where the Image is 'spoolsv.exe'. Analyze the 'ImageLoaded' field (the DLL path). Compare loaded DLLs against a baseline of known good print processor DLLs. Use file reputation services or hash lookups against threat intelligence feeds to identify unexpected or unsigned DLLs loaded from the print processor directory during boot."
          }
        }
      }
    }
  },
  {
    "Is the adversary attempting to gain elevated privileges via print processors? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1547.012 - Print Processors": {
          "Registry key writes to the Print Processors hive by a process not typically associated with print driver/processor installation or without appropriate privileges.": {
            "Data": "Windows Event ID 4657, Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event Logs (4657) showing writes to the Print Processors Registry hive. Correlate with Process Creation events (4688) to identify the writing process and user. Use statistical analysis (e.g., frequency or outlier detection) on the 'Creator Process Name' or 'SubjectUserName' fields for writes to this specific hive to identify anomalous activity."
          },
          "spoolsv.exe loading a DLL with a low reputation or known malicious hash from the print processor directory.": {
            "Data": "Windows Event ID 7 (Sysmon)",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 7 (ImageLoad) for spoolsv.exe loading DLLs. Extract DLL file hashes. Perform correlation analysis by joining the loaded DLLs and hashes with threat intelligence data (IOCs for malicious DLLs or hashes). Investigate any matches or DLLs with low reputation scores."
          }
        }
      }
    }
  }
]