[
  {
    "Is the adversary executing malicious code using shared modules? (TA0002 - Execution)": {
      "Indicators": {
        "T1129 - Shared Modules": {
          "Loading of shared modules (DLLs) from unusual or non-standard directories (%SystemRoot%, %ProgramFiles%).": {
            "Data": "Windows Event ID 7",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor host logs (Windows Event ID 7) for 'LoadLibrary' or similar calls loading DLLs. Filter for DLLs loaded from paths outside of common system directories like C:\\Windows\\System32, C:\\Program Files, etc. Use descriptive statistics to identify paths with low frequency of DLL loads across the environment."
          },
          "Shared module (DLL) load events correlating with recent suspicious file writes or process behaviors.": {
            "Data": "Windows Event ID 7, Windows Event ID 11, Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 7 (ImageLoad) events with recent Windows Event ID 11 (FileCreate) events on the same host and within a short time window. Analyze process relationships (via Event ID 4688) for processes loading modules shortly after creating suspicious files. Use correlation analysis to identify statistically significant associations between module loads from non-standard paths and suspicious file creation events."
          }
        }
      }
    }
  }
]