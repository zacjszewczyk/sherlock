[
  {
    "Is the adversary communicating via command and control using non-standard encoding? (TA0011 - Command and Control)": {
      "Indicators": {
        "T1132.002 - Non-Standard Encoding": {
          "Network traffic exhibiting significantly asymmetric data flow inconsistent with expected protocol behavior (e.g., client sending more data than receiving, or unexpected large outbound data chunks).": {
            "Data": "Zeek conn.log, Zeek http.log, Zeek dce_rpc.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log to calculate bytes sent (orig_bytes) and bytes received (resp_bytes) per connection. Calculate ratios (orig_bytes / resp_bytes) and identify connections with extreme ratios, especially for client-initiated sessions where orig_bytes >> resp_bytes. Use descriptive statistics and box plots to identify outliers in data volume and flow direction per protocol/port."
          },
          "Analysis of packet content showing encoding or data patterns that deviate from standard protocols used on observed ports.": {
            "Data": "Zeek http.log, Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Examine Zeek logs (http.log, dns.log, etc.) for data fields known to carry C2 traffic (e.g., HTTP request bodies/headers, DNS query names). Apply entropy calculations to these data fields to identify strings with unusually high randomness, indicative of non-standard encoding like modified Base64. Correlate high entropy findings with connections flagged for anomalous data flow."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]