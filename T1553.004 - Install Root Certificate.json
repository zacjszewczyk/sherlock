[
  {
    "Is the adversary evading defenses by installing a malicious root certificate? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1553.004 - Install Root Certificate": {
          "Detection of newly installed or modified root certificates in the system certificate store.": {
            "Data": "Windows Event ID 4688; Windows Registry Events (if available)",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process command lines containing keywords related to certificate installation (e.g., 'certutil -addstore', 'powershell Install-Certificate', 'certreq -accept', 'makecert'). Analyze event logs for changes to registry keys associated with root certificates (HKLM\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\ and HKLM/HKCU\\Software[\\Policies\\]\\Microsoft\\SystemCertificates\\Root\\Certificates\\) if registry auditing is enabled and logged via Windows Events. Compare certificate hashes/fingerprints against known trusted lists and identify new, untrusted, or statistically rare certificates based on frequency of occurrence across endpoints."
          },
          "SSL/TLS traffic involving certificates signed by a newly installed or untrusted root certificate.": {
            "Data": "Zeek ssl.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek ssl.log to identify connections using certificates signed by unfamiliar or newly installed root certificates by inspecting the 'server_cert_issuer' and 'server_cert_subject' fields. Join ssl.log data with historical certificate data to identify statistically rare certificate issuers or subjects appearing in network traffic using frequency analysis. Flag connections using certificates not chaining up to known, trusted root CAs by comparing against a trusted baseline."
          },
          "Presence of root certificates on a system whose thumbprints or characteristics do not match a list of trusted, baseline, or manufacturer-approved certificates.": {
            "Data": "Zeek ssl.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect certificate fingerprints/hashes from Zeek ssl.log for root certificates observed in traffic. Compare these fingerprints against a pre-defined list of trusted root certificates (e.g., Microsoft Trusted Root Program list). Identify and flag connections involving root certificates whose fingerprints do not match the trusted list. Use descriptive statistics to summarize the prevalence of trusted vs. untrusted roots seen in traffic."
          },
          "Execution of processes associated with certificate creation or manipulation outside of standard IT administration tasks or tools.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for execution of binaries known to interact with certificate stores or generate certificates (e.g., 'certutil.exe', 'certreq.exe', 'makecert.exe', 'sigcheck.exe', 'powershell.exe' with certificate cmdlets). Analyze command line arguments for operations like adding, deleting, exporting, or requesting certificates. Identify statistically rare executable names or command line patterns involving certificate manipulation using frequency analysis and compare against a baseline of authorized certificate-related activities."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]