[
  {
    "Is the adversary evading defenses by installing a malicious root certificate? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1553.004 - Install Root Certificate": {
          "Detection of newly installed or modified root certificates in the system certificate store.": {
            "Data": "Windows Event ID 4688, Windows Registry Events (if available)",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process command lines containing keywords related to certificate installation (e.g., 'certutil -addstore', 'powershell Install-Certificate'). Analyze event logs for changes to registry keys associated with root certificates (HKLM\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\ and HKLM/HKCU\\Software[\\Policies\\]\\Microsoft\\SystemCertificates\\Root\\Certificates\\). Compare certificate hashes/fingerprints against known trusted lists and identify new, untrusted, or statistically rare certificates."
          },
          "SSL/TLS traffic involving certificates signed by a newly installed or untrusted root certificate.": {
            "Data": "Zeek ssl.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek ssl.log to identify connections using certificates signed by unfamiliar or newly installed root certificates. Join ssl.log data with historical certificate data to identify statistically rare certificate issuers or subjects appearing in network traffic. Flag connections using certificates not chaining up to known, trusted root CAs."
          }
        }
      }
    }
  }
]