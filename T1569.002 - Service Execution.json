[
  {
    "Has the adversary executed code via Windows service manipulation? (TA0002 - Execution)": {
      "Indicators": {
        "T1569.002 - Service Execution": {
          "Creation or modification of Windows services using suspicious command-line parameters or non-standard executables.": {
            "Data": "Windows Event ID 4697, Windows Event ID 7045, Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4697 and 7045 for new service installations and Event ID 4688 for process creations involving 'sc.exe' or other service control utilities with 'create' or 'config' commands. Analyze command lines and service executable paths for suspicious characteristics (e.g., short, random names, unusual locations, mismatched descriptions). Correlate service creation events with known system administration activities using time series analysis to identify outliers or unexpected patterns."
          },
          "Execution of tools like sc.exe or PsExec with remote service manipulation arguments.": {
            "Data": "Windows Event ID 4688, Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation events where the process image name is 'sc.exe' or 'PsExec.exe'. Parse command-line arguments to identify service manipulation commands ('create', 'config', 'start', 'stop') and target hostnames/IP addresses, especially those targeting remote systems. Monitor Zeek conn.log for connections on ports associated with PsExec (e.g., 445 SMB) originating from suspicious sources or targeting multiple systems; analyze connection frequency and volume using descriptive statistics to spot anomalous activity."
          }
        }
      }
    }
  }
]