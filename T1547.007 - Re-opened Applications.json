[
  {
    "Is the adversary maintaining persistence by auto-starting applications? (TA0003 - Persistence)": {
      "Indicators": {
        "T1547.007 - Re-opened Applications": {
          "Detection of new or modified auto-start entries launching unusual executables or scripts.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 logs for process creations associated with common auto-start locations (e.g., Run keys, Startup folders). Identify processes launched from unusual paths or with unusual parent processes. Use frequency analysis to find rare executables or command lines appearing in auto-start contexts."
          },
          "Outbound network connections from applications configured for auto-start that typically do not make network connections.": {
            "Data": "Zeek conn.log; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4688 logs (process creation with command line) with Zeek conn.log. Identify network connections initiated by processes launched via auto-start mechanisms. Flag connections from processes known to be typically non-networked. Use correlation analysis between process names/paths and destination IPs/ports to identify suspicious network activity."
          },
          "Modification of registry keys used for auto-start (e.g., Run, RunOnce) to add or change entries.": {
            "Data": "Windows Event ID 4657",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for modifications to registry keys like `HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run`, `HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run`, `HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce`, `HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce`, etc. Filter for `ObjectType`='Key' and `OperationType`='%%7050%%' (SetValue). Analyze the `NewValue` and `TargetObject` fields for suspicious executable paths or commands being added/modified. Use frequency analysis to identify rare modifications and baseline normal system/application behavior."
          },
          "Repeated network connections to suspicious or external destinations originating from the same auto-started process across multiple login sessions.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4688 (process creation, noting parent process and command line) with Zeek conn.log entries where the timestamp aligns with user login events and the process name/path from 4688 initiates connections. Group connections by process path, destination IP, and user. Identify patterns of repeated connections (e.g., daily, upon each login) from the same process/user to suspicious or consistent external destinations. Use time series analysis on connection events per process to detect recurring patterns indicative of persistence."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Has the adversary escalated privileges via auto-starting applications? (TA0004 - Privilege-Escalation)": {
      "Indicators": {
        "T1547.007 - Re-opened Applications": {
          "Auto-start of executables or scripts under elevated privileges or unusual user contexts.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4624",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 logs for processes created under elevated contexts (e.g., check integrity level, or processes launched by system services). Analyze login types (Event ID 4624) associated with auto-start mechanisms that grant elevated privileges. Use descriptive statistics to baseline normal process execution contexts upon login and identify outliers."
          },
          "Auto-start of suspicious unsigned executables or those with low prevalence, launched with elevated privileges.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 logs for processes launched with elevated privileges (`IntegrityLevel`='System' or 'High'). Extract process image paths and verify digital signatures. Identify unsigned executables or those with low global prevalence using external threat intelligence/reputation services. Flag unsigned or low-prevalence processes starting in elevated contexts via auto-start mechanisms using frequency analysis."
          },
          "Outbound network connections from processes launched with elevated privileges via auto-start mechanisms.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4624; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Windows Event ID 4688 logs for processes launched with elevated privileges (e.g., check `IntegrityLevel`). Correlate these processes with network connection events (Zeek conn.log) by time and source IP/process. Identify processes started with elevated privileges that initiate outbound connections, especially to external or unusual destinations. Use correlation analysis between elevated processes and destination network indicators to prioritize investigation."
          },
          "Process creation with suspicious command-line arguments, executed with elevated privileges at user login or system startup.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4624",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 logs for processes executing with elevated privileges (`IntegrityLevel`='System' or 'High'). Extract command-line arguments. Use frequency analysis and pattern matching on command lines to identify suspicious arguments (e.g., base64 encoded strings, direct execution of scripts, unusual utility usage). Correlate with login events (Event ID 4624) or system startup events to understand the execution context and flag processes with suspicious command lines launched with elevation via auto-start mechanisms."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]