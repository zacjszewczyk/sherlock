```json
[
  {
    "Is the adversary using resource forking to evade defenses? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1564.009 - Resource Forking": {
          "A file's resource fork contains data matching the hash of a known malicious payload.": {
            "Data": "File system event logs; Endpoint Detection and Response (EDR) data",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Upon file creation or modification events, inspect the file's resource fork (e.g., accessed on macOS via `<filename>/..namedfork/rsrc`). Calculate the hash (e.g., SHA256) of the resource fork's content and inner join it with a threat intelligence database of known malicious file hashes. Alert on any match and isolate the host for forensic analysis."
          },
          "An unusual process, such as a network utility or script interpreter, writes data to a file's resource fork.": {
            "Data": "File system event logs (e.g., from Apple Endpoint Security Framework)",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor file write events, specifically targeting a file's resource fork path (`<filename>/..namedfork/rsrc`). Establish a baseline of legitimate processes (e.g., Finder) that interact with resource forks. Alert on write activity from anomalous source processes, such as `curl`, `python`, `bash`, or Microsoft Office applications, as this pattern is highly indicative of payload staging. Use frequency analysis to identify rare process-to-resource-fork-write events."
          },
          "A file with execute permissions is created or modified to have a non-empty resource fork, a combination highly uncharacteristic of legitimate software on modern macOS.": {
            "Data": "File system event logs; EDR data",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor file system events for files being created or modified. For any file with execute permissions (`+x`), check the size of its resource fork. A resource fork size greater than zero on an executable file is a strong behavioral anomaly that warrants immediate investigation. Use descriptive statistics (mean, max) on resource fork sizes across the fleet to build a baseline, but any non-zero size on an executable should be treated as a high-fidelity alert."
          },
          "A sequence of events where a file is downloaded, its resource fork is subsequently modified, and then code execution is initiated by a separate process.": {
            "Data": "Process execution logs; File system event logs; Zeek conn.log",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Create a correlated detection rule that triggers on the following sequence: 1) A file download is observed via network logs (Zeek conn.log) or a file is written by a browser or network utility. 2) A subsequent file system event shows the downloaded file's resource fork being written to. 3) A new process (e.g., `bash`, `osascript`) is created by the process that handled the download or modification. Use time-series analysis and correlation of events based on host, file path, and a defined time window (e.g., 5 minutes) to detect this multi-stage behavioral pattern."
          }
        }
      },
      "version": "2.0",
      "last_updated": "2025-05-11"
    }
  }
]
```