[
  {
    "Is the adversary maintaining persistence using Office Template Macros? (TA0003 - Persistence)": {
      "Indicators": {
        "T1137.001 - Office Template Macros": {
          "Modification of Office template files (e.g., Normal.dotm, PERSONAL.XLSB) or relevant registry keys (e.g., GlobalDotName).": {
            "Data": "Windows Event ID 4656, Windows Event ID 4657, Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event Logs (4656/4663 for file access, 4657 for registry modification, 4688 for process creation) for changes to standard Office template paths (AppData\\Roaming\\Microsoft\\Templates, AppData\\Roaming\\Microsoft\\Excel\\XLSTART) or modifications to the GlobalDotName registry key. Investigate processes modifying these files/keys that are not standard software installers or updates. Use correlation analysis between process creation and file/registry modification events targeting these specific locations."
          },
          "Office application process (WINWORD.EXE, EXCEL.EXE) loading a template from an unusual location or executing unexpected macros on startup.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) for WINWORD.EXE or EXCEL.EXE processes starting. Analyze command-line arguments for non-standard template file paths being loaded. Analyze process ancestry to identify suspicious parent processes launching Office applications. Look for Office processes launching child processes (e.g., cmd.exe, powershell.exe) immediately after startup, which could indicate macro execution. Use frequency analysis to identify rare parent-child process combinations involving Office applications."
          }
        }
      }
    }
  }
]