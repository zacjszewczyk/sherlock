[
  {
    "Has the adversary executed commands using AutoHotKey or AutoIT scripts? (TA0002 - Execution)": {
      "Indicators": {
        "T1059.010 - AutoHotKey & AutoIT": {
          "Suspicious process execution involving AutoHotKey or AutoIT interpreter with script file arguments.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations where the command line or process path includes 'AutoIt3.exe' or 'AutoHotkey.exe' and the arguments include file paths ending in '.au3' or '.ahk'. Use frequency analysis on the script file names or paths being executed to identify rare occurrences or deviations from expected behavior."
          },
          "Execution of unknown or newly created executable files exhibiting characteristics of compiled automation scripts.": {
            "Data": "Windows Event ID 4688, Zeek pe.log",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for execution of new or unknown '.exe' files. Correlate process execution events with file creation events (e.g., using Sysmon Event ID 1 or 11 if available) to identify newly created executables that are immediately executed. Analyze Zeek pe.log for characteristics of compiled AutoIt/AutoHotKey executables if possible. Use correlation analysis to link file creation and execution timelines. Use descriptive statistics or anomaly detection on file properties (size, compile time, parent process) compared to known good executables."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]