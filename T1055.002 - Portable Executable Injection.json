[
  {
    "Has the adversary escalated privileges using PE injection? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1055.002 - Portable Executable Injection": {
          "Unusual process creation or modification activity associated with high-privilege processes.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for new process creation or modification by/of high-privilege processes (e.g., SYSTEM user). Use correlation analysis to identify sequences of events that might indicate injection setup (e.g., permissions changes followed by process creation). Profile typical process activity for these high-privilege processes using descriptive statistics on child processes and command lines, flagging deviations."
          },
          "A high-privilege process initiating network connections uncharacteristic of its normal function.": {
            "Data": "Zeek conn.log; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections where the originating process (identified via correlation with Windows Event ID 4688 based on timestamp/host) is a high-privilege process. Use time series analysis or statistical profiling to identify network activity patterns for these processes that deviate from baselines. Investigate connections to unusual ports or external destinations."
          },
          "A typically low-privilege process exhibiting behavior consistent with interacting with or modifying a high-privilege process memory or threads.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for processes (especially low-privilege ones) with command lines or parent-child relationships known to be associated with injection tools or techniques (e.g., use of 'rundll32' with unusual arguments, processes executing from temporary directories). Correlate these events with subsequent unusual activity (e.g., network connections, child process creation) from a high-privilege target process identified around the same time. Use frequency analysis of process command lines and parent-child relationships to flag rare occurrences involving low-privilege sources and high-privilege targets."
          },
          "A high-privilege process creating suspicious child processes uncharacteristic of its normal function.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688. Identify child processes spawned by high-privilege processes (e.g., lsass.exe, services.exe, winlogon.exe). Maintain a baseline of typical child processes for these high-privilege parents using frequency analysis. Flag and investigate child processes with low frequency, suspicious names/paths, or unusual command lines, especially if they involve execution of newly written files or files from unusual locations, which could indicate code injected into the parent."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary using PE injection to evade defenses? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1055.002 - Portable Executable Injection": {
          "Unusual process creation or modification activity targeting a common, typically non-interactive process.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for unusual parent-child relationships where a process is creating or modifying a typically benign, non-interactive process (e.g., svchost.exe, explorer.exe). Use frequency analysis to identify rare or unexpected parent processes for these common target processes. Investigate processes attempting to launch threads or modify memory in these target processes based on event details."
          },
          "A typically benign process initiating network connections to suspicious destinations or creating suspicious child processes.": {
            "Data": "Zeek conn.log; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log and Windows Event ID 4688. Correlate network connections with the process name/path. Identify connections originating from typically benign processes (e.g., explorer.exe, svchost.exe) connecting to known malicious IPs (from threat intel) or exhibiting unusual network behavior (e.g., high volume, unusual ports) using time series analysis. Identify suspicious child processes created by typically benign processes (via 4688) that have low prevalence or suspicious command lines using frequency analysis. Use correlation analysis to link process creation events with subsequent network activity."
          },
          "A process known to be associated with malware or suspicious activity attempting to interact with or modify a common, benign process.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688. Identify processes with suspicious names, paths, or command lines (e.g., matching threat intelligence, living-off-the-land binaries used maliciously, processes running from temp directories). Analyze the target process/parent process relationship for these suspicious processes. Flag instances where these suspicious processes attempt to interact with (e.g., as a parent or via command line arguments targeting PIDs) common, benign processes like 'svchost.exe' or 'explorer.exe'. Use correlation to identify sequences of events."
          },
          "A process initiating network connections to suspicious destinations immediately followed by activity indicative of injection targeting a benign process.": {
            "Data": "Zeek conn.log; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections from processes (identified via correlation with 4688 based on timestamp/host) to known malicious IPs or suspicious domains (from threat intel). Correlate these network connections with subsequent Windows Event ID 4688 events showing the connecting process interacting with or creating threads/modifying memory in common, benign processes (svchost.exe, explorer.exe, etc.) within a short timeframe. Use correlation analysis to link network beaconing or data staging attempts by the source process with its subsequent attempt to inject and hide within a benign process."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]