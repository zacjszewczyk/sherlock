[
  {
    "Is the adversary attempting to discover domain accounts? (TA0007 - Discovery)": {
      "Indicators": {
        "T1087.002 - Domain Account": {
          "Execution of command-line utilities (e.g., net user /domain, net group /domain) to enumerate domain accounts or groups.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 on endpoints and servers for process creations containing command-line arguments like 'net user /domain', 'net group /domain', 'ldapsearch', 'dscacheutil -q group'. Identify execution by non-standard users or from unusual process trees. Use frequency analysis on command execution per host/user to detect anomalous spikes."
          },
          "Execution of PowerShell cmdlets (e.g., Get-ADUser, Get-ADGroupMember) or direct API calls for domain account/group enumeration.": {
            "Data": "Windows Event ID 4104, Windows Event ID 4662",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4104 for PowerShell script blocks containing 'Get-ADUser', 'Get-ADGroupMember', or similar AD-related cmdlets. Monitor Windows Event ID 4662 for directory service access events targeting user or group objects (requires appropriate SACL configuration). Correlate these events with process execution (Event ID 4688) and network connections (Zeek logs) to identify the source and potential exfiltration or subsequent use of enumerated data."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]