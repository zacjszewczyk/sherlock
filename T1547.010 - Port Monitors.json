[
  {
    "Is the adversary establishing persistence using port monitors? (TA0003 - Persistence)": {
      "Indicators": {
        "T1547.010 - Port Monitors": {
          "Modification of the Print Monitor Registry keys, specifically adding or changing the 'Driver' value under HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 (Registry value set) for modifications to keys under HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors, specifically changes to the 'Driver' value. Analyze the process (via Event ID 4688) making the change and its parent process. Use correlation analysis between Registry modifications and process events to identify unexpected processes making these changes or changes occurring at unusual times."
          },
          "Anomalous DLL files being loaded by spoolsv.exe or API calls to AddMonitor.": {
            "Data": "Windows Event ID 4688; Sysmon Event ID 7",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 7 (Image Load) for spoolsv.exe loading DLLs from locations other than C:\\Windows\\System32 or C:\\Windows\\System64, or loading DLLs with suspicious names or unknown origins. Monitor Windows Event ID 4688 for spoolsv.exe parent process analysis. Use frequency analysis to identify rare DLLs loaded by spoolsv.exe."
          },
          "Creation or modification of suspicious DLL files within the C:\\Windows\\System32 directory by non-standard processes.": {
            "Data": "Sysmon Event ID 11; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 11 (File Creation) for file creation/modification in C:\\Windows\\System32\\*.dll. Correlate with Windows Event ID 4688 (Process Creation) to identify the process responsible and its parent. Establish a baseline of legitimate processes that write to this directory (e.g., Windows Installer, patching tools) and flag creations by anomalous processes using frequency analysis. Use time series analysis to identify unusual bursts of file creation or activity outside maintenance windows."
          },
          "Outbound network connections initiated by spoolsv.exe to suspicious external destinations after system boot or user logon.": {
            "Data": "Zeek conn.log; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for outbound connections initiated by spoolsv.exe (correlate process info using Windows Event ID 4688) to suspicious or unknown external IP addresses/domains (cross-reference against threat intelligence feeds). Correlate connections with system boot or user logon events. Use correlation analysis to link network activity to the loading of a suspicious DLL by spoolsv.exe. Filter out expected printer-related network traffic."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary attempting privilege escalation using port monitors? (TA0004 - Privilege-Escalation)": {
      "Indicators": {
        "T1547.010 - Port Monitors": {
          "Modification of the Print Monitor Registry keys by a process without typical SYSTEM privileges or during an unusual system state.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 (Registry value set) for modifications to keys under HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors, focusing on the 'Driver' value. Correlate these events with process creation events (Event ID 4688) and logon events (Event ID 4624) to determine the process integrity level and user context making the change. Flag modifications made by non-SYSTEM processes or during unusual administrative sessions."
          },
          "API calls to AddMonitor originating from unexpected processes or user contexts, or the loading of unusual DLLs by spoolsv.exe associated with processes attempting privilege escalation.": {
            "Data": "Windows Event ID 4688; Sysmon Event ID 7",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 7 (Image Load) for spoolsv.exe loading unusual DLLs. Analyze the process details (Event ID 4688) associated with spoolsv.exe startup and its parent processes. Correlate unusual DLL loads or spoolsv.exe activity with other events indicating privilege escalation attempts occurring around the same time, such as access token manipulation (Sysmon Event ID 22) or suspicious service installations (Windows Event ID 4697)."
          },
          "Creation or modification of suspicious DLL files within the C:\\Windows\\System32 directory by non-standard processes.": {
            "Data": "Sysmon Event ID 11; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 11 (File Creation) for file creation/modification in C:\\Windows\\System32\\*.dll. Correlate with Windows Event ID 4688 (Process Creation) to identify the process responsible and its parent. Establish a baseline of legitimate processes that write to this directory (e.g., Windows Installer, patching tools) and flag creations by anomalous processes using frequency analysis. Use time series analysis to identify unusual bursts of file creation or activity outside maintenance windows."
          },
          "Outbound network connections initiated by spoolsv.exe to suspicious external destinations after system boot or user logon.": {
            "Data": "Zeek conn.log; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for outbound connections initiated by spoolsv.exe (correlate process info using Windows Event ID 4688) to suspicious or unknown external IP addresses/domains (cross-reference against threat intelligence feeds). Correlate connections with system boot or user logon events. Use correlation analysis to link network activity to the loading of a suspicious DLL by spoolsv.exe. Filter out expected printer-related network traffic."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]