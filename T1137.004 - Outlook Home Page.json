[
  {
    "Is the adversary maintaining persistence using Outlook Home Pages? (TA0003 - Persistence)": {
      "Indicators": {
        "T1137.004 - Outlook Home Page": {
          "Detection of malicious HTML or script execution attempts initiated by Outlook Home Page.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 logs for cmd.exe, powershell.exe, or script interpreter processes spawned with command lines containing potentially malicious or unusual arguments immediately following Outlook.exe activity. Analyze command line arguments for known scripting techniques or obfuscation. Use frequency analysis on command line arguments associated with Outlook child processes to identify rare occurrences."
          },
          "Abnormal child processes spawned by Outlook.exe, deviating from standard user activity.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 logs to identify child processes spawned by outlook.exe. Establish a baseline of normal child processes (e.g., web browser, pdf viewer). Use correlation analysis (e.g., Parent-Child Process Trees) to detect uncommon or suspicious child processes originating from Outlook.exe. Analyze entropy of process names or command lines to detect unusual binaries or scripts."
          },
          "Modification of Outlook registry keys related to folder Home Page settings.": {
            "Data": "Windows Event ID 4657",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for modifications to registry keys under paths like `HKCU\\Software\\Microsoft\\Office\\[version]\\Outlook\\Explorer\\[Folders]\\` or `HKCU\\Software\\Microsoft\\Office\\[version]\\Outlook\\WebBrowser\\` where Home Page settings are stored. Filter for changes to values like `URL` or `HomePage`. Alert on unexpected changes, especially if not associated with known Outlook updates or user configuration changes. Use frequency analysis to identify rare registry modifications related to Outlook configuration."
          },
          "Outbound network connections initiated by Outlook.exe or its immediate child processes to unusual or suspicious destinations (IPs/domains).": {
            "Data": "Zeek conn.log; Windows Event ID 5156",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Zeek conn.log and Windows Event ID 5156 (Filtering for `ProcessID` corresponding to `outlook.exe` or its recent child processes) to identify outbound connections. Analyze destination IPs and domains for suspicious indicators (e.g., new/rarely seen domains, IPs listed in threat intelligence feeds, connections to non-standard ports). Use frequency analysis on destination IPs/domains seen originating from Outlook to identify rare or unusual connections. Correlate with time-of-day analysis to flag connections occurring outside normal business hours."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]