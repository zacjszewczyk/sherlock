[
  {
    "Has the adversary exfiltrated data by transferring it to another cloud account? (TA0010 - Exfiltration)": {
      "Indicators": {
        "T1537 - Transfer Data to Cloud Account": {
          "Detection of attempts to share cloud snapshots or data objects with untrusted/unusual external cloud accounts.": {
            "Data": "Zeek conn.log, Zeek http.log, Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor cloud service logs (e.g., AWS CloudTrail, Azure Activity Logs - note: these are not Windows Events or Zeek but necessary for technique). Identify events related to sharing snapshots or data objects ('ModifySnapshotAttribute', 'Get Snapshot SAS URL', 'ShareObject'). Filter for external or public sharing attempts. Analyze Zeek http.log for API calls to cloud sharing endpoints. Correlate Zeek/Host events with cloud logs if possible. Use descriptive statistics to identify unusual frequency or targets of sharing events."
          },
          "Monitoring for anomalous file transfer activity or unusual API calls related to data transfer between accounts within the same cloud provider.": {
            "Data": "Zeek conn.log, Zeek http.log, Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze cloud service logs for API calls indicating data transfer between accounts within the provider (e.g., S3 CopyObject, Blob Copy). Monitor Zeek conn.log and http.log for unusual traffic volume or patterns to cloud storage/transfer endpoints originating from internal assets. Use time series analysis on transfer volume or API call frequency to detect spikes or deviations from baseline behavior."
          }
        }
      }
    }
  }
]