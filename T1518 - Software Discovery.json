[
  {
    "Is the adversary enumerating installed software? (TA0007 - Discovery)": {
      "Indicators": {
        "T1518 - Software Discovery": {
          "Execution of system commands or scripts commonly used for software inventory (e.g., 'wmic product get name,version', 'Get-Package', registry queries).": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations containing command-line arguments associated with software inventory queries (e.g., 'wmic product', 'powershell Get-Package', 'reg query HKLM\\Software'). Identify execution frequency of such commands by user and endpoint. Use frequency analysis to detect unusual spikes or executions by non-standard accounts or endpoints."
          },
          "Usage of WMI or PowerShell cmdlets/scripts to query installed software information.": {
            "Data": "Windows Event ID 4104",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4104 (PowerShell Script Block Logging) for scripts or commands querying software information (e.g., Get-WmiObject Win32_Product, Get-CimInstance Win32_Product, Get-Package). Monitor WMI activity logs if available. Look for execution originating from unusual processes or user contexts. Use correlation analysis to link software discovery activity with subsequent suspicious actions."
          }
        }
      }
    }
  }
]