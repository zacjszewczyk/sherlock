[
  {
    "information_requirement": "Is the adversary communicating with command and control infrastructure via an external proxy?",
    "tactic_id": "TA0011",
    "tactic_name": "Command-And-Control",
    "indicators": [
      {
        "technique_id": "T1090.002",
        "name": "External Proxy",
        "evidence": [
          {
            "description": "Outbound network connections from internal hosts to external IP addresses or domains known to be part of malicious proxy networks or public anonymizing services.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Inner join destination IP addresses from Zeek conn.log and queried domains from Zeek dns.log with a high-confidence, continuously updated CTI feed of known malicious proxy IPs, TOR exit nodes, and public anonymizing VPN services. Alert on any matches and investigate the source host and associated process activity."
          },
          {
            "description": "Execution of processes matching the file names or file hashes of known external proxy or tunneling tools.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "Endpoints",
              "Servers"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Monitor Windows Event ID 4688 for process creation events. Compare the new process name and its file hash against a maintained list of known proxy/tunneling tools (e.g., htran, ngrok, chisel, plink). Alert on any exact matches. Use frequency analysis on all process names to spot low-prevalence executables that warrant further investigation for proxy-like behavior."
          },
          {
            "description": "Process execution with command-line arguments indicative of configuring or using an external proxy or network tunnel.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "Endpoints",
              "Servers"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Analyze command-line arguments from Windows Event ID 4688 events using regular expressions to detect patterns associated with proxy/tunneling tool configuration. Search for flags such as '-listen', '-tran', '-proxy', '-R', '-L', followed by port numbers or IP addresses. Use correlation analysis to link processes with suspicious command-lines to their subsequent network connections observed in Zeek conn.log."
          },
          {
            "description": "Use of SSL/TLS connections with client fingerprints (JA3/JA3S) or Server Name Indication (SNI) values known to be associated with specific proxy tools or C2 frameworks.",
            "data_sources": [
              "Zeek ssl.log"
            ],
            "data_platforms": [
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Extract JA3/JA3S hashes and SNI string values from Zeek ssl.log for all outbound connections. Compare these against a threat intelligence feed or a maintained list of fingerprints known to be used by specific proxy tools (e.g., ngrok, chisel) or common C2 frameworks. Flag connections with matching fingerprints and analyze the source and destination for other signs of compromise."
          },
          {
            "description": "Network connections to external destinations initiated by processes not typically expected to be network-aware (e.g., system utilities, document viewers) or from unusual file paths.",
            "data_sources": [
              "Windows Event ID 4688",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "Endpoints",
              "Servers",
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Establish a baseline of common network-aware processes and their typical file paths within the environment. Monitor Windows Event ID 4688 for process creation and correlate with network connection data from Zeek conn.log. Use descriptive statistics and frequency analysis to identify rare processes making external network connections, or processes running from non-standard locations (e.g., %TEMP%, C:\\Users\\Public\\). Flag these events for investigation as they may indicate a custom proxy tool."
          },
          {
            "description": "Outbound network connections exhibiting C2-like characteristics such as periodic beaconing, long connection durations with low data volume, asymmetric data flows, or non-standard protocols over common ports.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek weird.log"
            ],
            "data_platforms": [
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Analyze Zeek conn.log for outbound connections. Use time series analysis to detect periodic connections (beaconing) by modeling the time delta between connections from a source to a destination. Calculate the ratio of sent vs. received bytes; use IQR or percentile analysis to flag connections with extreme asymmetry (e.g., >10:1 upload to download). Monitor Zeek weird.log or connection logs for traffic on standard web ports (80, 443) that is not identified as HTTP/SSL, indicating protocol tunneling."
          },
          {
            "description": "Direct connections from internal hosts to external IP addresses belonging to public cloud providers, VPN services, or hosting providers, especially when bypassing the designated corporate web proxy.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Identify the IP address(es) of the corporate web proxy. Filter Zeek conn.log for all external connections on ports 80/443 that do not have the proxy IP as a destination. For the remaining direct connections, enrich the destination IPs with ASN and service provider information. Flag connections to ASNs belonging to major cloud providers (AWS, Azure, GCP), known VPN services, or generic hosting providers. Use frequency analysis to find hosts making many such connections, as this may indicate policy bypass for C2."
          }
        ]
      }
    ],
    "version": "2.1",
    "date_created": "2025-05-04",
    "last_updated": "2025-07-20",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]