[
  {
    "information_requirement": "Is the adversary conducting reconnaissance to identify network trust dependencies?",
    "tactic_id": "TA0043",
    "tactic_name": "Reconnaissance",
    "indicators": [
      {
        "technique_id": "T1590.003",
        "name": "Network Trust Dependencies",
        "evidence": [
          {
            "description": "A statistically significant volume of network connections or DNS queries originating from or targeting external IP addresses/domains that match threat intelligence feeds or deviate from established partner traffic baselines.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internet Gateway, Cloud Egress Points, External DNS Resolvers",
            "action": "1. (Symbolic) Continuously correlate source/destination IPs in Zeek conn.log and queried domains in Zeek dns.log against a CTI feed of known reconnaissance infrastructure. Alert on any matches. 2. (Statistical) For traffic from external IPs not on a partner allowlist, calculate the Jaccard similarity between the set of domains they query and the set of domains typically queried by legitimate partners. Alert on sources with a similarity score below a dynamically calculated threshold (e.g., 10th percentile). 3. (ML) Employ a time-series anomaly detection model (e.g., Prophet) on the volume of traffic (bytes and connections) from known third-party and partner IP ranges. An alert is triggered if observed traffic volume significantly deviates from the model's predicted forecast, suggesting a compromised partner network is being used for reconnaissance."
          },
          {
            "description": "Execution of specific reconnaissance commands or tools from a partner-associated user account or IP address, where the command or its parameters are inconsistent with the user's established behavioral profile.",
            "data_sources": [
              "Windows Event ID 4688",
              "Zeek http.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, ADFS Servers, Partner-accessible Application Servers",
            "action": "1. (Symbolic) Monitor Windows Event ID 4688 (Process Creation with Command Line) for processes initiated by partner accounts, filtering for a watchlist of commands (e.g., `nltest`, `net group`, `AdFind`, `certutil`) and tool-specific User-Agents in Zeek http.log (e.g., 'Nmap Scripting Engine'). 2. (Statistical) For each partner account, establish a baseline of unique processes executed per session. Alert if the count of unique processes in a new session exceeds the 95th percentile of their historical activity, particularly if new processes are reconnaissance-related. 3. (ML) Train a one-class SVM model on tokenized command-line arguments historically used by partner accounts. Flag any new command execution whose arguments are classified as outliers by the model, indicating novel or suspicious tool usage."
          },
          {
            "description": "A source IP from an external or partner network exhibits network or port scanning behavior, defined by a statistically anomalous fan-out ratio of connections to unique hosts or ports and a high rate of failed connections.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network Perimeter Firewalls, DMZ Segments, VPN Concentrators",
            "action": "1. (Symbolic) Correlate source IPs exhibiting high connection counts against a public blocklist of known internet scanners (e.g., Shodan, Censys). 2. (Statistical) In a 5-minute window, calculate the fan-out ratio (unique destination IPs / total connections) and the entropy of destination ports for each source IP. Alert on sources where these metrics exceed 3 standard deviations from the established baseline for their network segment (e.g., external, partner VPN). A high ratio of failed connection states (e.g., 'REJ', 'S0') for the source IP should significantly increase the alert's priority. 3. (ML) Use a DBSCAN clustering algorithm on connection metadata from Zeek conn.log (features: source IP, destination port, connection state, duration). Source IPs classified as noise points or forming small, distinct clusters are potential scanners, as their behavior deviates from large, legitimate traffic clusters."
          },
          {
            "description": "An external or partner source IP initiates DNS queries indicative of enumeration, such as zone transfer requests, or exhibits a statistically significant increase in subdomain query entropy or NXDOMAIN responses.",
            "data_sources": [
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Authoritative and Recursive DNS Servers, Domain Controllers",
            "action": "1. (Symbolic) Create high-priority alerts for any DNS `AXFR` or `IXFR` query types originating from IP addresses not explicitly authorized for zone transfers. 2. (Statistical) For each source IP, calculate the Shannon entropy of requested subdomains and the ratio of NXDOMAIN responses to total queries within a 1-minute window. Alert if the entropy score or NXDOMAIN ratio exceeds the 98th percentile of the historical baseline for external traffic. 3. (ML) Train a Gradient Boosting classifier to distinguish between benign and malicious DNS query sequences. Features should include query type frequency, query name length statistics, subdomain entropy, and time-delta between queries. Classify real-time query streams from source IPs to detect reconnaissance patterns."
          },
          {
            "description": "An authenticated partner account accesses an anomalously high number of network shares or files, deviating significantly from both their individual baseline and the typical behavior of their peer group.",
            "data_sources": [
              "Windows Event ID 5140",
              "Windows Event ID 4663"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "File Servers, SharePoint Sites, Code Repositories accessible by partners",
            "action": "1. (Symbolic) Deploy and monitor a honeypot network share (e.g., `\\\\server\\_Partner-Credentials`) with auditing enabled. Any access attempt logged via Windows Event ID 5140 is a high-fidelity alert for reconnaissance. 2. (Statistical) For each partner user session, model resource access as a graph where nodes are shares/files. Alert if the number of nodes accessed in a session exceeds 3 standard deviations above the user's 30-day rolling average, indicating unusually broad enumeration. 3. (ML) Apply peer group analysis by clustering partner accounts based on their resource access patterns (features: set of shares accessed, access times, data volume). An alert is generated if a user's activity causes them to shift to a different cluster from their established peer group, indicating a significant behavioral deviation."
          }
        ]
      }
    ],
    "version": "2.2",
    "date_created": "2025-05-04",
    "last_updated": "2025-09-29",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]