[
  {
    "information_requirement": "Has the adversary gained initial access to the network via exploiting a public-facing application?",
    "tactic_id": "TA0001",
    "tactic_name": "Initial Access",
    "indicators": [
      {
        "technique_id": "T1190",
        "name": "Exploit Public-Facing Application",
        "evidence": [
          {
            "description": "Network traffic targeting public-facing applications originating from known malicious IP addresses or matching high-confidence signatures for specific vulnerabilities (e.g., known CVEs).",
            "data_sources": [
              "Zeek conn.log",
              "Zeek signatures.log"
            ],
            "data_platforms": [
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Correlate source IP addresses from Zeek conn.log traffic targeting public-facing web servers with a continuously updated CTI feed of IPs known for scanning or exploitation activity. Separately, monitor Zeek signatures.log for alerts with specific CVE identifiers (e.g., Log4Shell, ProxyLogon, F5 BIG-IP RCE) and prioritize these high-fidelity events. Inner join signature alert logs with connection logs to investigate the full session context for confirmed malicious activity."
          },
          {
            "description": "Presence of common exploit patterns, reconnaissance tool User-Agents, or webshell-related artifacts in web server traffic logs.",
            "data_sources": [
              "Zeek http.log",
              "Zeek files.log"
            ],
            "data_platforms": [
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Use regular expression matching on Zeek http.log URIs, headers, and request bodies to detect common attack strings (e.g., 'SELECT...FROM', '../', '<script>', 'powershell.exe', 'bash -c'). Maintain and search for a list of User-Agent strings associated with vulnerability scanners and exploitation tools (e.g., nmap, sqlmap, Metasploit, Nuclei). Monitor Zeek files.log for files transferred via HTTP with common webshell extensions (.php, .aspx, .jsp) or names (e.g., cmd.asp, shell.php)."
          },
          {
            "description": "Anomalous process execution on a public-facing server, such as a web server process spawning a command shell, reconnaissance commands, or an unexpected child process.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "Servers"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "On public-facing servers, monitor Windows Event ID 4688 for process creation events. Establish a baseline of normal parent-child process relationships. Alert on anomalous chains, especially a web server process (e.g., w3wp.exe, httpd.exe, tomcat.exe) spawning a command interpreter (cmd.exe, powershell.exe), network utility (net.exe, whoami.exe, ipconfig.exe, curl.exe), or any script host (cscript.exe, wscript.exe). Correlate the timing of these events with suspicious inbound traffic identified in Zeek logs to pinpoint potential exploitation."
          },
          {
            "description": "A public-facing server initiating unexpected outbound network connections or exhibiting anomalous data transfer patterns shortly after suspicious inbound activity.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Monitor Zeek conn.log for all outbound connections originating from the IP addresses of public-facing servers. Establish a baseline of normal outbound destinations, ports, and data volumes for each server/application. Alert on new or rare outbound connections, especially to non-standard ports or known dynamic DNS providers. Use time series analysis to detect sudden spikes in outbound data volume. Use descriptive statistics (mean, standard deviation, percentiles) on connection duration and bytes transferred to identify outlier sessions, which may represent reverse shells or initial data exfiltration."
          },
          {
            "description": "Statistically significant deviation in web traffic metrics for a public-facing application, such as an unusual spike in error rates, a sudden change in request methods, or high entropy in URL parameters.",
            "data_sources": [
              "Zeek http.log"
            ],
            "data_platforms": [
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Aggregate Zeek http.log data per public-facing application. Calculate time series data for metrics like HTTP status code counts (especially 4xx/5xx errors), request method distribution (GET, POST, etc.), and request volume. Use time series analysis (e.g., ARIMA, Holt-Winters) to detect anomalous spikes or shifts in these metrics compared to historical norms. For dynamic applications, calculate the Shannon entropy of URL parameters or paths for each source IP over a sliding window; a sustained high entropy can indicate fuzzing or scanning attempts. Use Inter-Quartile Range (IQR) or Z-score methods to flag outlier values in these metrics for further investigation."
          }
        ]
      }
    ],
    "version": "2.1",
    "date_created": "2025-05-04",
    "last_updated": "2025-07-20",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]