[
  {
    "information_requirement": "Is the adversary communicating with compromised systems via legitimate web services?",
    "tactic_id": "TA0011",
    "tactic_name": "Command And Control",
    "indicators": [
      {
        "technique_id": "T1102.002",
        "name": "Bidirectional Communication",
        "evidence": [
          {
            "description": "Network traffic to/from legitimate web services using domains, URLs, or IP addresses known to be associated with specific C2 frameworks or threat actor campaigns.",
            "data_sources": [
              "Zeek dns.log",
              "Zeek http.log",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Continuously correlate DNS queries (Zeek dns.log), HTTP host headers and URIs (Zeek http.log), and destination IPs (Zeek conn.log) against a high-confidence cyber threat intelligence (CTI) feed of known malicious domains, URLs, and IPs used for C2 via legitimate web services (e.g., specific Pastebin URLs, public GitHub raw file URLs, known malicious accounts on cloud services). Alert on any matches and investigate the associated internal host."
          },
          {
            "description": "HTTP requests to legitimate web services containing specific User-Agent strings, API call structures, or URL path patterns characteristic of known malware or C2 tools.",
            "data_sources": [
              "Zeek http.log"
            ],
            "data_platforms": [
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Scan Zeek http.log requests to legitimate services (e.g., GitHub, Dropbox, Telegram, Slack, Pastebin). Use regular expressions to match against a maintained list of known malicious User-Agents, specific API endpoint patterns used by malware (e.g., frequent POSTs to `api.dropbox.com/2/files/upload`), or suspicious URL structures (e.g., `github.com/user/repo/raw/main/payload.ps1`). Maintain and update this list of patterns based on threat intelligence reports on malware families. Use frequency analysis to flag rare User-Agents making requests to these services."
          },
          {
            "description": "Anomalous data transfer patterns to legitimate web services, such as unusually high data upload volumes, high-entropy data, or beaconing-like communication frequency.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek http.log"
            ],
            "data_platforms": [
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "For each internal host, baseline typical data transfer volume (sent/received bytes) and connection frequency to common web services. Use time series analysis on Zeek conn.log data to detect periodic, 'heartbeat' connections indicative of beaconing. Calculate the entropy of HTTP POST bodies or uploaded files; high entropy can indicate encrypted/packed C2 data. Use Inter-Quartile Range (IQR) analysis on upload/download ratios to flag sessions where an internal host sends significantly more data than it receives, which is atypical for normal web browsing."
          },
          {
            "description": "Network connections to legitimate web services originating from unusual, non-interactive, or unauthorized processes, especially those running with elevated privileges.",
            "data_sources": [
              "Windows Event ID 4688",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "Endpoints",
              "Servers",
              "Network devices"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Correlate Windows Event ID 4688 (Process Creation) with Zeek conn.log network traffic. Identify processes communicating with legitimate web services (e.g., `powershell.exe`, `cscript.exe`, `rundll32.exe`, or unsigned executables in temporary directories). Flag connections from processes running under system accounts (e.g., NT AUTHORITY\\SYSTEM), running for unusually long durations while communicating with these services, or those not typically associated with user web browsing. Use correlation analysis to link the suspicious process creation event with the corresponding network flow."
          },
          {
            "description": "Hosts, particularly servers, initiating communication with legitimate web services (e.g., social media, personal cloud storage, Pastebin) that are inconsistent with their designated role or established network behavior baseline.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log",
              "Zeek http.log"
            ],
            "data_platforms": [
              "Network devices",
              "Servers"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Categorize hosts based on their roles (e.g., Domain Controller, database server, web server, user workstation) and establish baselines of normal external web service destinations for each category. Monitor Zeek dns.log and http.log for connections from hosts in server roles\u2014which typically have restricted and predictable outbound traffic\u2014to domains associated with consumer-grade services like social media, chat applications, or public file sharing sites. Use frequency analysis to identify rare and suspicious host-destination pairs and investigate the purpose of the communication."
          }
        ]
      }
    ],
    "version": "2.1",
    "date_created": "2025-05-04",
    "last_updated": "2025-07-20",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]