[
  {
    "information_requirement": "Is the adversary attempting to gain credentials using GUI input capture?",
    "tactic_id": "TA0006",
    "tactic_name": "Credential Access",
    "indicators": [
      {
        "technique_id": "T1056.002",
        "name": "GUI Input Capture",
        "evidence": [
          {
            "description": "Execution of a process with a file hash matching known credential theft tools that employ GUI mimicry.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "Endpoints",
              "Servers"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Monitor Windows Event ID 4688 for all process creation events. Continuously compare the file hashes of executed processes against a threat intelligence feed or internal repository of known malicious hashes associated with GUI-based credential theft tools (e.g., modules from PowerSploit, Empire, or standalone phishers). Alert on any hash matches."
          },
          {
            "description": "Execution of a scripting interpreter with command-line arguments containing specific keywords or module names used for creating GUI elements for credential prompts.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "Endpoints",
              "Servers"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Analyze command-line arguments from Windows Event ID 4688 for scripting interpreters (e.g., powershell.exe, cscript.exe, wscript.exe). Use regular expression matching to search for specific, case-insensitive patterns indicative of GUI creation, such as 'System.Windows.Forms', 'Add-Type', 'Show-Dialog', 'Out-GridView -PassThru', or known credential theft function names. Flag command lines containing these patterns, especially when launched by non-interactive processes or unusual parent processes (e.g., WINWORD.EXE)."
          },
          {
            "description": "An unusual parent-child process relationship where a common application (e.g., WINWORD.EXE, OUTLOOK.EXE, AcroRd32.exe) spawns a scripting interpreter.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "Endpoints",
              "Servers"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Analyze process lineage using Windows Event ID 4688. Establish a baseline of normal parent-child relationships for common user applications. Flag anomalous chains, such as an Office application, PDF reader, or browser spawning powershell.exe, cmd.exe, or cscript.exe. Use frequency analysis to identify rare parent-child pairs in the environment, as this is a common behavior for macro-based or exploit-based payloads that launch credential phishers."
          },
          {
            "description": "A scripting process execution with a highly obfuscated or unusually long command line, indicative of an attempt to hide malicious code that may create a credential prompt.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "Endpoints",
              "Servers"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "For every scripting interpreter process captured in Windows Event ID 4688, calculate the length and character entropy of the command-line arguments. Establish a baseline for normal script execution within the environment. Use statistical methods (e.g., Inter-Quartile Range, Z-score on length) to identify significant outliers. High entropy can indicate encrypted or compressed commands, while extreme length can indicate an embedded script. Prioritize investigation of these outliers as they frequently represent malicious scripts, including those for GUI mimicry."
          }
        ]
      }
    ],
    "version": "2.1",
    "date_created": "2025-05-04",
    "last_updated": "2025-07-20",
    "contributors": [
      "Zachary Szewczyk"
    ]
  },
  {
    "information_requirement": "Is the adversary collecting sensitive data (credentials) using GUI input capture?",
    "tactic_id": "TA0009",
    "tactic_name": "Collection",
    "indicators": [
      {
        "technique_id": "T1056.002",
        "name": "GUI Input Capture",
        "evidence": [
          {
            "description": "Outbound network connection from a host to an IP address, domain, or URI known to be associated with credential exfiltration C2 infrastructure, occurring shortly after a suspected GUI mimicry event.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek http.log",
              "Zeek dns.log",
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "Network devices",
              "Endpoints",
              "Servers"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Correlate the timestamp of a suspicious process creation (identified via Windows Event ID 4688 per Credential Access IR detections) with subsequent outbound network connections from the same host. Compare destination IPs (Zeek conn.log), domains (Zeek dns.log), and URIs (Zeek http.log) against a CTI feed of known credential harvesting sites and C2 infrastructure. Alert on any matches occurring within a 5-minute window of the suspicious process execution."
          },
          {
            "description": "An outbound HTTP POST request containing common credential field names in the request body, originating from an unusual process not associated with normal authentication.",
            "data_sources": [
              "Zeek http.log",
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "Network devices",
              "Endpoints",
              "Servers"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Analyze the `request_body` of HTTP POST requests captured in Zeek http.log. Search for key-value pairs that match common credential field names (e.g., 'user', 'pass', 'username', 'password', 'login', 'credential'). Correlate the source IP of these requests back to host process logs (Windows Event ID 4688) to verify if the request originated from an unexpected process (e.g., powershell.exe, rundll32.exe, or a randomly named executable) rather than a legitimate browser or application. Flag any such correlations as likely credential collection."
          },
          {
            "description": "A small, anomalous outbound data transfer over a covert channel (e.g., DNS, ICMP) or an unusual TCP/UDP port, immediately following a suspected GUI mimicry event on a host.",
            "data_sources": [
              "Zeek dns.log",
              "Zeek conn.log",
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "Network devices",
              "Endpoints",
              "Servers"
            ],
            "nai": "Insert site-specific NAI here",
            "action": "Establish a baseline of typical data transfer sizes and protocols for hosts. After detecting a potential GUI mimicry process (from Windows Event ID 4688), monitor the host's network traffic for anomalous behavior. Use correlation analysis to link the timing of the suspicious process to anomalous network traffic. Use descriptive statistics and IQR to flag small outbound data transfers (<1KB) over non-standard ports (low frequency ports in Zeek conn.log) or via DNS (unusually long query names in Zeek dns.log), as these are common TTPs for exfiltrating small amounts of data like credentials."
          }
        ]
      }
    ],
    "version": "2.1",
    "date_created": "2025-05-04",
    "last_updated": "2025-07-20",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]