[
  {
    "information_requirement": "Is an adversary actively gathering our organization's email addresses for targeting? (PIR)",
    "tactic_id": "TA0043",
    "tactic_name": "Reconnaissance",
    "indicators": [
      {
        "technique_id": "T1589.002",
        "name": "Email Addresses",
        "evidence": [
          {
            "description": "An external IP address, flagged on a threat intelligence feed for reconnaissance or malicious activity, establishes an anomalously high number of connections to public-facing services within a defined time window, exceeding established baselines.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek http.log",
              "Threat Intelligence Feed"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internet gateway, network DMZ, public-facing web servers, external-facing authentication services (e.g., M365, VPN concentrators).",
            "action": [
              "Symbolic: Continuously correlate the source IP address ('id.orig_h') in Zeek conn.log against a high-confidence threat intelligence feed of known malicious scanners, reconnaissance tools, and anonymizing services (e.g., TOR exit nodes, known C2). Generate a high-severity alert for any match initiating a connection.",
              "Statistical: For IPs matching a lower-confidence threat feed (e.g., generic VPNs), calculate the connection frequency to a specific destination port (e.g., 443) over a 10-minute sliding window. Flag any source IP whose connection count exceeds the 99th percentile of connection rates for all external IPs to that same service port over the last 24 hours.",
              "Machine Learning: Train a time-series forecasting model (e.g., SARIMA) on the volume of connections from known anonymizing services over the last 90 days, accounting for weekly seasonality. An observed connection volume that significantly exceeds the model's 95% prediction interval indicates a potential coordinated reconnaissance campaign."
            ]
          },
          {
            "description": "One or more HTTP requests to public-facing web services are observed with a User-Agent string or a combination of HTTP headers matching signatures of known automated email harvesting or OSINT tools.",
            "data_sources": [
              "Zeek http.log",
              "Zeek weird.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Public-facing web servers (e.g., company 'About Us' or 'Contact' pages), SharePoint sites, and web application frontends.",
            "action": [
              "Symbolic: Using regular expressions, search the 'user_agent' field in Zeek http.log for signatures of known email harvesting and reconnaissance tools (e.g., 'theHarvester', 'hunter.io', 'Email-Harvester', 'Recon-ng', 'sqlmap', 'Nmap Scripting Engine', 'Go-http-client', 'python-requests'). Generate an alert on any match, excluding known benign scanners.",
              "Statistical: For each source IP, calculate the Shannon entropy of the 'uri' field across all requests in a 5-minute session. A very low entropy score (e.g., < 1.0), combined with a high request rate (>30 requests per minute), suggests automated enumeration of a predictable directory path. Alert if both thresholds are met.",
              "Machine Learning: Use a pre-trained classification model (e.g., a Gradient Boosting Classifier) to score each HTTP request based on its headers (User-Agent, Accept, Referer), URI structure, and method. Flag requests classified as 'automated' or 'scraping' with high confidence (>0.9), especially when originating from IPs not associated with known benign crawlers (e.g., Googlebot, Bingbot)."
            ]
          },
          {
            "description": "A statistically significant deviation from the baseline ratio of failed (Windows Event ID 4625) to successful (Windows Event ID 4624) authentication attempts from a single external IP address against multiple distinct accounts.",
            "data_sources": [
              "Windows Event ID 4625",
              "Windows Event ID 4624",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Active Directory Federation Services (ADFS) servers, Remote Desktop Gateway servers, VPN concentrators, Microsoft 365 / Entra ID tenant.",
            "action": [
              "Symbolic: Create a detection rule that triggers when a single source IP address generates more than 10 failed logon events (Windows Event ID 4625 with Logon Type 3, 8, or 10) for more than 5 unique user accounts within a 1-minute window. Use Zeek conn.log to verify the source IP is external and not from a known corporate IP range.",
              "Statistical: For each external source IP, calculate the ratio of failed logons (Event ID 4625) to the total logon attempts over a 15-minute window. Establish a baseline ratio for normal traffic during business and non-business hours. Alert if the observed ratio for an IP exceeds the baseline by 3 standard deviations and involves more than 3 unique target accounts.",
              "Machine Learning: Implement an unsupervised learning algorithm (e.g., Isolation Forest or DBSCAN) on authentication log data. Use features such as source IP, count of unique target users per IP per minute, success/failure status, and the variance in time between successive attempts from the same IP. The model will identify anomalous clusters of activity indicative of enumeration or password spraying that deviate from normal user behavior."
            ]
          },
          {
            "description": "An external source IP demonstrates behavior consistent with automated web scraping, characterized by a request rate exceeding normal user thresholds (e.g., >5 requests/sec), systematic URI traversal, and session lengths far exceeding the user average.",
            "data_sources": [
              "Zeek http.log",
              "Zeek conn.log",
              "Zeek files.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Public-facing websites, especially those with employee directories, contact lists, or profile pages.",
            "action": [
              "Symbolic: Alert when a single external source IP requests more than 100 pages containing '/profile/', '/staff/', '/team/', '/contact/', or '/about-us/' in the URI within a 5-minute period. Exclude known benign web crawlers by their User-Agent string and source ASN.",
              "Statistical: Establish a baseline for normal user sessions, calculating the 95th percentile for requests per minute and total pages viewed. Flag any external IP session that exceeds both of these thresholds. Concurrently, calculate the Levenshtein distance between consecutive URI requests from the same IP; a consistently low distance (e.g., 1 or 2) indicates sequential enumeration and should heavily weight the risk score.",
              "Machine Learning: Develop a session-based classifier (e.g., Random Forest) using features like request frequency, URI entropy, diversity of User-Agents from the source IP, time-of-day, and average time between requests. Train the model on labeled data of 'human' vs. 'bot' sessions. Apply the model in real-time to classify incoming traffic sessions and alert on those identified as 'malicious bot' or 'scraper'."
            ]
          },
          {
            "description": "A sudden, anomalous increase in authentication attempts or password spray attacks against a specific set of user accounts that share a common attribute (e.g., same department, same role) shortly after a suspected reconnaissance event.",
            "data_sources": [
              "Windows Event ID 4625",
              "Windows Event ID 4624",
              "Zeek conn.log",
              "HR Information System Data"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, ADFS servers, VPN concentrators, and SIEM correlation environment.",
            "action": [
              "Symbolic: If a reconnaissance alert (e.g., from scraping or tool usage detection) triggers for a source IP, create a dynamic rule to monitor for any subsequent authentication attempts from that same IP for the next 72 hours. Escalate the alert severity for any failed logon from this tainted IP.",
              "Statistical: Group user accounts by department using HR data. For each group, calculate a 30-day moving average and standard deviation for failed logon attempts (Event ID 4625). Generate a high-severity alert if the number of failures for any single group in a 1-hour window exceeds 3 standard deviations above its moving average.",
              "Machine Learning: Use a graph-based clustering algorithm (e.g., Louvain community detection) on authentication logs. Create a graph where nodes are users and source IPs, and edges represent failed authentication attempts. A dense cluster of failures originating from one or a few source IPs targeting a community of users (who can be cross-referenced with HR data to confirm a departmental link) indicates a targeted attack following successful reconnaissance."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.3",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]