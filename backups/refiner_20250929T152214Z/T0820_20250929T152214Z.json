[
  {
    "information_requirement": "Is an adversary exploiting software vulnerabilities in ICS devices to evade security controls? (PIR)",
    "tactic_id": "TA0103",
    "tactic_name": "Evasion",
    "indicators": [
      {
        "technique_id": "T0820",
        "name": "Exploitation for Evasion",
        "evidence": [
          {
            "description": "Network connections to or from ICS devices exhibiting unusual protocol usage, non-standard ports, or unexpected data volumes, indicative of exploit attempts or unauthorized data exfiltration designed to bypass network security controls.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek notice.log",
              "Zeek dce_rpc.log",
              "Zeek rdp.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Process Control Network (PCN), Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Network boundary between IT and OT networks, Industrial Demilitarized Zone (IDMZ)",
            "action": "1. Establish a baseline of normal network communications (source/destination IP, port, protocol, connection duration, byte count) between EWS/HMIs and field devices (e.g., PLCs, RTUs) using Zeek conn.log over a 30-day period. 2. **(Symbolic Logic)** Generate high-priority alerts for connections from non-EWS/HMI assets to known device engineering ports (e.g., Modbus/TCP 502, S7Comm 102) or for connections using non-standard ICS protocols. Cross-reference alerts with Zeek notice.log for signatures of known ICS exploits. 3. **(Statistical Method)** For established connections, calculate the 99th percentile for 'orig_bytes' and 'resp_bytes' for each unique source-destination-port-protocol tuple. Alert on any connection exceeding these thresholds, indicating unusually high data volume transfers. 4. **(Machine Learning)** Apply a time series anomaly detection model to monitor connection counts and durations for each critical ICS device. Flag significant deviations from historical patterns (e.g., sudden spikes in connections to a PLC that is typically stable) as potential exploit attempts or post-exploitation activity for evasion. 5. Analyze Zeek dce_rpc.log and rdp.log for anomalous RDP/DCE/SMB activity from EWS/HMIs to ICS devices or between ICS devices, such as connections to devices not typically accessed via these protocols."
          },
          {
            "description": "Execution of processes or scripts with unusual names, paths, or command-line arguments on ICS-connected workstations (EWS, HMIs), particularly those associated with system modification, network scanning, or unauthorized communication, indicating potential exploit payload execution or post-exploitation activity for evasion.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 5156"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Jump Servers within the OT network",
            "action": "1. On EWS and HMI systems, monitor for process creation (Windows Event ID 4688). Establish a whitelist of legitimate engineering software, system utilities, and their expected execution paths. 2. **(Symbolic Logic)** Alert on the execution of processes not present in the whitelist, or on known malicious tools (e.g., mimikatz, nmap, psexec) or scripting interpreters (e.g., powershell.exe, cmd.exe) with suspicious command-line arguments (e.g., base64 encoded strings, network discovery parameters). 3. **(Statistical Method)** Calculate the entropy of command-line arguments for all executed processes. Generate alerts for command lines with an entropy score exceeding the 99th percentile, indicating potential obfuscation or random string generation. Additionally, identify rare parent-child process relationships (e.g., a Microsoft Word process spawning cmd.exe). 4. **(Machine Learning)** Use a process classification model trained on historical data to identify anomalous process execution patterns or command-line argument structures. Flag processes that deviate significantly from their expected behavior profile. 5. Correlate suspicious process execution with subsequent outbound network connections (Windows Event ID 5156) to ICS devices or external IP addresses."
          },
          {
            "description": "Detected file transfers to ICS devices, specifically those with firmware-related extensions, originating from unauthorized sources, exhibiting unexpected file hashes, or occurring outside approved maintenance windows, indicating an attempt to manipulate device firmware for evasion.",
            "data_sources": [
              "Zeek files.log",
              "Zeek conn.log",
              "Windows Event ID 4663"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Process Control Network (PCN), Engineering Workstations (EWS), Industrial Demilitarized Zone (IDMZ) for firmware update servers, OT File Servers",
            "action": "1. Filter Zeek files.log for file transfers over common industrial protocols (e.g., FTP, TFTP, HTTP, SMB) with file extensions associated with firmware (.bin, .hex, .fw, .img, .upd). 2. **(Symbolic Logic)** Create a whitelist of authorized source systems (e.g., specific EWS IPs) and known-good file hashes for legitimate firmware. Alert immediately on any firmware file transfer originating from an unauthorized source IP, destined for an unauthorized device, or having an unknown file hash. Also, alert on firmware transfers occurring outside of defined maintenance windows. 3. **(Statistical Method)** Identify instances where the same firmware file is transferred to an unusually high number of devices within a short period (e.g., exceeding the 99th percentile for device count per file hash per hour). Analyze the byte count and duration of firmware transfers, flagging any significant deviations from historical norms for specific firmware types. 4. **(Machine Learning)** Employ a classification model to categorize firmware transfer events as legitimate or malicious based on features like source reputation, destination type, file hash entropy, and transfer patterns. 5. Analyze the corresponding Zeek conn.log record to identify the source, destination, and service used for the transfer. For Windows-based file shares, monitor Windows Event ID 4663 for access to firmware repositories."
          },
          {
            "description": "Specific Windows Event IDs indicating the clearing of security logs, disabling of critical security services (e.g., antivirus, firewall), or modifications to system security configurations on EWS or HMIs, signifying an adversary's attempt to remove forensic evidence or bypass host-based defenses.",
            "data_sources": [
              "Windows Event ID 1102",
              "Windows Event ID 7040",
              "Windows Event ID 4719",
              "Windows Event ID 4657"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Windows Servers within the ICS network, OT Domain Controllers",
            "action": "1. Create high-priority alerts for Windows Event ID 1102 (The audit log was cleared) on all critical HMI, EWS, and Windows servers. 2. **(Symbolic Logic)** Monitor for Windows Event ID 7040 (A service was installed/started/stopped) specifically for critical security tools (e.g., antivirus, EDR agent, host-based firewall, logging services), and alert if these services are stopped or disabled. Also, alert on Windows Event ID 4719 (System audit policy was changed) and Windows Event ID 4657 (A registry value was modified) targeting known security-related registry keys or audit policies. 3. **(Statistical Method)** Perform a frequency analysis of service state changes (Event ID 7040) across all monitored systems. Alert on any service status change that falls outside the 99th percentile of historical occurrences for that specific service, especially if it's a security service. Monitor security event log volume; a sudden drop (e.g., 90% reduction within 5 minutes) could indicate log tampering. 4. **(Machine Learning)** Apply a sequence analysis model to correlate these evasion events. For example, identify patterns where an anomalous login (Windows Event ID 4624) or process execution (Windows Event ID 4688) is immediately followed by a log clear (1102) or security service disable (7040). 5. Correlate these events with preceding anomalous login activity (Windows Event ID 4624) or process execution (Windows Event ID 4688) to identify the source of the evasion activity."
          }
        ]
      }
    ],
    "version": "1.1",
    "date_created": "2025-09-26",
    "last_updated": "2025-09-29",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]