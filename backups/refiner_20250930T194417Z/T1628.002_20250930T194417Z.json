[
  {
    "information_requirement": "Is an adversary attempting to evade user detection on corporate-managed mobile devices? (PIR)",
    "tactic_id": "TA0030",
    "tactic_name": "Defense Evasion",
    "indicators": [
      {
        "technique_id": "T1628.002",
        "name": "User Evasion",
        "evidence": [
          {
            "description": "An application not categorized as 'Gaming', 'Fitness', or 'AR/VR' accesses motion sensors (accelerometer, gyroscope) as reported by Mobile Threat Defense (MTD) logs. This access coincides with a device state change from 'at rest' (no motion detected for >60 seconds) to 'in motion'. Within 5 seconds of this state change, periodic network connections from the device, previously observed at a regular interval (e.g., standard deviation of time delta < 5 seconds) and directed to a single domain/IP, cease completely for at least 5 minutes. The ceased connections were characterized by low data volume (<2KB per connection).",
            "data_sources": [
              "Mobile Threat Defense (MTD) sensor access logs",
              "Mobile Device Management (MDM) application inventory logs",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Endpoints: Corporate-managed mobile devices with MTD/MDM agents. Network: Network taps at Wi-Fi access points, VPN egress points, and internet gateways where Zeek sensors are deployed. Infrastructure: MDM servers providing application metadata; DNS servers providing query logs.",
            "action": "1. Symbolic Logic: Create a SIEM correlation rule with the following pseudo-logic: TRIGGER on an MTD event where `sensor_type` is in `['accelerometer', 'gyroscope']`. ENRICH the event with the application's category from the MDM application inventory. CONDITION 1: `app_category` is NOT IN `['Gaming', 'Fitness', 'AR/VR', 'Health']`. CONDITION 2: In the 5 minutes prior to the event, search Zeek conn.log for the device's IP and confirm `COUNT(connections) > 3` and `STDEV(time_between_connections) < 5s`, indicating periodic beaconing. CONDITION 3: In the 5 minutes after the event, search Zeek conn.log for the device's IP and confirm `COUNT(connections) == 0`, indicating cessation of traffic. ALERT with high severity if all three conditions are met. 2. Statistical Analysis: For each managed device and installed application, create two aligned time series over 24-hour periods. The first, a 'Motion Series' from MTD logs, is a binary series sampled per minute (1 if motion is detected, 0 if not). The second, a 'Network Series' from Zeek conn.log, is a count of outbound connections per minute. Calculate the Pearson correlation coefficient `r` between the two series for each application. Generate a medium-severity alert for any application not on a motion-access allowlist that exhibits a strong negative correlation, such as $$ r < -0.7 $$, indicating network activity consistently stops when the user is active. Elevate alert severity if, during 'at rest' periods (motion=0), the network traffic exhibits low Shannon entropy of destination ports and a low standard deviation of inter-arrival times, which is characteristic of C2 heartbeats. 3. Machine Learning: For each unique application, train a dedicated Isolation Forest model to learn its normal 'at rest' network behavior. First, aggregate 'at rest' network data from Zeek logs, defined as periods of at least 10 minutes with no MTD-reported motion. Second, create 5-minute windowed feature vectors from this data, including `connection_count`, `total_bytes_out`, `avg_connection_duration`, `entropy_of_destination_ips`, and `stdev_of_inter_connection_time_delta`. Third, train the model on these feature vectors. In real-time, monitor for a state change from 'at rest' to 'in motion'. When this occurs, create a feature vector for the subsequent 5-minute window. A vector of near-zero values, representing the sudden stop in traffic, will be highly anomalous compared to the learned 'at rest' profile. Feed this vector into the model; if it returns a high anomaly score, generate a high-confidence alert for evasive C2 activity."
          }
        ]
      }
    ],
    "last_updated": "2025-09-29",
    "version": "1.3",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]