[
  {
    "information_requirement": "Has an adversary successfully tricked an ICS operator or engineer into executing malicious code?",
    "tactic_id": "TA0104",
    "tactic_name": "Execution",
    "indicators": [
      {
        "technique_id": "T0863",
        "name": "User Execution",
        "evidence": [
          {
            "description": "A Windows Event ID 4688 records a process creation on an ICS host (e.g., EWS, HMI) where a parent process from an approved Office application or PDF reader whitelist (e.g., winword.exe, excel.exe, powerpnt.exe, acrord32.exe) launches a suspicious child process. The child process is considered suspicious if it is a command-line interpreter or scripting engine (e.g., cmd.exe, powershell.exe, wscript.exe, cscript.exe, rundll32.exe) and its command line contains indicators of obfuscation (e.g., base64 encoding, excessive carets) or download/execution cradles. This event is further corroborated if the child process initiates an outbound network connection, observed in Zeek conn.log, within 15 seconds of its creation to an IP address with a low reputation, a newly registered domain, or a destination not on an established ICS communication baseline.",
            "data_sources": [
              "Windows Event ID 4688",
              "Zeek files.log",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Endpoint devices within the ICS network, including Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, and ICS DMZ servers; network traffic monitoring points at ICS zone boundaries and egress points.",
            "action": "1. Symbolic Logic: Implement a SIEM rule to detect Windows Event ID 4688 where ParentProcessName IS IN ('winword.exe', 'excel.exe', 'powerpnt.exe', 'acrord32.exe') AND NewProcessName IS IN ('cmd.exe', 'powershell.exe', 'wscript.exe', 'cscript.exe', 'rundll32.exe'). Enhance the rule to check if the child process's CommandLine contains suspicious arguments such as '/c', '-EncodedCommand', '-nop', '-w hidden', 'IEX', or 'Invoke-Expression' that are not part of an approved baseline. Correlate by ProcessId and timestamp with Zeek conn.log to flag if the child process initiates any outbound connections to non-RFC1918 addresses not on a pre-approved destination whitelist within 15 seconds. Cross-reference destination domains from Zeek dns.log against threat intelligence feeds for age and reputation.\n2. Statistical Method: For all process chains matching the parent-child pattern (Office app -> interpreter), calculate the Shannon entropy of the CommandLine argument. Alert if the entropy exceeds a dynamically calculated baseline threshold (e.g., > 4.5), indicating probable obfuscation. Separately, maintain a 90-day baseline of all unique ParentProcessName, NewProcessName, and CommandLine combinations. Alert if a new combination is observed (a zero-frequency event) or if its frequency falls in the bottom 1st percentile of historical observations for that host, indicating rarity.\n3. Machine Learning Application: Train an unsupervised anomaly detection model (e.g., Isolation Forest) on Windows Event ID 4688 data. Use features such as ParentProcessName, NewProcessName, CommandLine length, CommandLine entropy, and the count of special characters in the command line. The model should be trained on a 'golden' dataset representing at least 30 days of normal ICS operations. Flag process events with high anomaly scores (e.g., top 0.5%). For alerted events, automatically enrich with correlated network data (Zeek conn.log, dns.log) and file data (Zeek files.log), and use a secondary reputation scoring model to prioritize the anomalies based on destination IP/domain reputation and file hash reputation."
          },
          {
            "description": "A Windows Event ID 4688 records a process creation where the executable path (NewProcessPath) is within a non-standard or user-writable directory on an ICS host (e.g., C:\\Users\\*\\Downloads\\, C:\\Users\\*\\AppData\\Local\\Temp\\, C:\\ProgramData\\, C:\\PerfLogs\\). The event's suspicion level increases if the process's metadata (OriginalFileName, Description) is missing or mismatched with the NewProcessName, or if its code signature is invalid or absent. This is strongly corroborated if, within 30 seconds, the new process initiates a network connection (seen in Zeek conn.log) to an external IP address not on an approved whitelist, especially over a non-standard port for that host.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 4697",
              "Zeek conn.log",
              "Zeek dns.log",
              "Zeek x509.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Endpoint devices such as Engineering Workstations (EWS), HMIs, Maintenance Laptops, and Jump Boxes within ICS zones; network egress points from the ICS network; ICS DMZ network segments where software updates might be staged.",
            "action": "1. Symbolic Logic: Create a SIEM rule to detect Windows Event ID 4688 where NewProcessPath matches patterns for user-writable or temporary directories ('\\\\Users\\\\', '\\\\AppData\\\\Local\\\\Temp\\\\', '\\\\ProgramData\\\\') and is not on a pre-approved installer/updater path whitelist. Alert if the process's ImageHash (SHA256) matches a known-bad value from threat intelligence. Also, flag if the OriginalFileName is empty or does not match NewProcessName (e.g., NewProcessName is 'svchost.exe' but OriginalFileName is 'legit_app.exe'). Correlate by ProcessId with Zeek conn.log to flag any outbound connections within 30 seconds to destinations not on an approved IP/port whitelist.\n2. Statistical Method: For all processes launched from user-writable directories, establish a 60-day baseline of destination Autonomous System Numbers (ASNs) and countries from correlated Zeek conn.log data. Alert if a connection is made to a rare ASN or country (e.g., in the bottom 5th percentile of frequency for that host group). Calculate the Jaccard similarity between the CommandLine of a new process and the set of all historical command lines for the same NewProcessName on that host. An extremely low similarity score (e.g., < 0.2) indicates a novel execution pattern warranting investigation.\n3. Machine Learning Application: Develop a supervised classification model (e.g., Gradient Boosting) trained on labeled historical data from both Windows events and Zeek logs. Features should include: NewProcessPath (as categorical features like 'is_temp', 'is_user_dir'), CommandLine entropy, process signature status, destination IP reputation, destination port prevalence, connection duration, and data volume (orig_bytes, resp_bytes). The model will classify each process execution/connection pair as 'benign', 'suspicious', or 'malicious'. Suspicious or malicious classifications should trigger an automated workflow to query Zeek dns.log for related domain lookups and Zeek x509.log to check for self-signed or unusual certificates associated with the connection."
          },
          {
            "description": "A process on an ICS host is created with elevated privileges, identified by Windows Event ID 4688 where the 'Token Elevation Type' is 'Type 2' ('%%1937'), indicating a full, elevated token. This event is highly suspicious if the process name (NewProcessName) and its path (NewProcessPath) do not exactly match an entry in a strictly maintained whitelist of applications authorized to run with elevated privileges in the ICS environment. Suspicion is amplified if the process is unsigned, originates from a user-writable directory, or is executed by a user account that does not typically perform administrative functions.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "All Windows-based ICS assets requiring strict change control, including Engineering Workstations, SCADA servers, Data Historians, and Domain Controllers in the process control network.",
            "action": "1. Symbolic Logic: Implement a high-priority SIEM alert for any Windows Event ID 4688 with Token Elevation Type '%%1937' where the combination of NewProcessName, NewProcessPath, and ImageHash (SHA256) does NOT exist in a tightly controlled whitelist of approved administrative tools and installers. This whitelist must be actively maintained through change management processes. The rule should have zero expected false positives in a properly configured ICS environment.\n2. Statistical Method: For each user account, establish a 90-day baseline of the specific privileged processes (NewProcessName) they execute. Alert if a user account executes a privileged process they have never run before. Additionally, monitor the overall daily count of privileged process executions per host. Using a moving average and standard deviation (e.g., over a 14-day window), alert if the daily count exceeds the mean by more than 3 standard deviations, which could indicate anomalous widespread activity.\n3. Machine Learning Application: Employ a time-series anomaly detection algorithm (e.g., Seasonal-Hybrid ESD) on the aggregated count of privileged executions (Token Elevation Type '%%1937') per host and per user role (e.g., 'Operator', 'Engineer'). Train the model on at least 90 days of data to learn normal operational rhythms, including maintenance windows (which can be added as known events to the model). This model will detect unusual spikes or changes in the volume of privileged activity. For each anomalous event, use a separate classification model to analyze the CommandLine, flagging those with high entropy, presence of suspicious keywords, or patterns associated with lateral movement or persistence tools."
          }
        ]
      }
    ],
    "version": "1.4",
    "date_created": "2025-09-25",
    "last_updated": "2025-09-29",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]