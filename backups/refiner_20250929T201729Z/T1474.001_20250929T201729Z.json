[
  {
    "information_requirement": "Has an adversary compromised our mobile applications by injecting malicious code into their software dependencies or development tools? (PIR)",
    "tactic_id": "TA0027",
    "tactic_name": "Initial Access",
    "indicators": [
      {
        "technique_id": "T1474.001",
        "name": "Compromise Software Dependencies and Development Tools",
        "evidence": [
          {
            "description": "A mobile application, running on a corporate-managed device, generates network traffic that matches one or more of the following conditions: (1) connection to a destination IP/domain on a threat intelligence feed; (2) connection using an SSL certificate issuer or JA3/JA3S hash that is statistically rare across the enterprise; (3) a 25% or greater increase in total data egress over a 24-hour period compared to its 30-day rolling average.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log",
              "Zeek ssl.log",
              "Mobile Device Management (MDM) logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate Wi-Fi network gateways, VPN concentrators, and Mobile Device Management (MDM) platforms monitoring mobile device traffic.",
            "action": "1. (Symbolic Logic) In your SIEM, join network logs (Zeek conn.log, dns.log) with threat intelligence feeds containing known malicious IPs, domains, and JA3/JA3S hashes. Create a rule to generate a high-severity alert for any connection from a mobile device IP range that matches an indicator in the feeds. 2. (Statistical Method) For each mobile application, create a 30-day rolling baseline of network behavior. A) Using Zeek conn.log, calculate the 95th percentile for daily data egress per application and alert if the current daily volume exceeds this baseline. B) Using Zeek dns.log, calculate the Shannon entropy of requested domains per application per hour; alert on entropy values that are more than 3 standard deviations above the application's typical entropy baseline, which may indicate DGA activity. C) Using Zeek ssl.log, build a frequency table of SSL certificate issuers and JA3 hashes seen across all mobile applications. Alert when an application uses an issuer or hash that falls in the bottom 5% of rarity (i.e., is very uncommon). 3. (Machine Learning) Implement an unsupervised learning model, such as Isolation Forest, using features from Zeek conn.log (e.g., connection duration, protocol, service, total bytes) and ssl.log (e.g., certificate validity period, issuer, subject). Train the model on historical network data to identify outlier connections that deviate from established patterns of legitimate traffic. Flag these outliers for analyst investigation as potential C2 channels."
          },
          {
            "description": "A software development process on a developer workstation or build server exhibits one or more of the following behaviors: (1) spawns a child process such as powershell.exe or cmd.exe containing base64 encoded commands or download strings (e.g., '-enc', 'IEX(New-Object Net.WebClient).DownloadString'); (2) creates a child process that is unsigned and not on an established allowlist for that parent; (3) initiates a network connection to a destination IP/domain first observed within the last 72 hours across the entire enterprise.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Sysmon Event ID 1",
              "Windows Sysmon Event ID 3",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Developer endpoints and continuous integration/continuous delivery (CI/CD) build servers within the corporate network.",
            "action": "1. (Symbolic Logic) Using Windows Event ID 4688 or Sysmon Event ID 1, create a detection rule that triggers when a known development process (e.g., `devenv.exe`, `gcc.exe`, `MSBuild.exe`, `xcodebuild.exe`) spawns a child process (e.g., `powershell.exe`, `cmd.exe`, `wscript.exe`) with suspicious command-line arguments such as `-enc`, `-w hidden`, `IEX`, `DownloadString`, or `Invoke-Expression`. Also, hunt for process creations of unsigned executables from directories associated with development tools or build artifacts. 2. (Statistical Method) For each developer host, establish a baseline of normal parent-child process relationships originating from development tools. Calculate the rarity of a given child process being spawned by a parent development tool (e.g., `MSBuild.exe` spawning `ftp.exe`). Alert when a relationship's frequency is below the 1st percentile across the environment. Additionally, for command lines in Sysmon Event ID 1, calculate the entropy and length. Alert when a command line's entropy or length exceeds 3 standard deviations from the historical norm for that specific parent-child process pair. 3. (Machine Learning) Train a supervised classification model (e.g., Random Forest, Gradient Boosting) on labeled data from Sysmon Event ID 1 (Process Creation) and Event ID 3 (Network Connection). Use features such as parent process name, process name, command-line length and entropy, user context, and network destination attributes (reputation, ASN, geo-location). The model will classify new events from development tools as 'benign' or 'suspicious', with 'suspicious' classifications generating an alert for analyst review."
          }
        ]
      }
    ],
    "last_updated": "2025-09-29",
    "version": "1.2",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]