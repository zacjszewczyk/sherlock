[
  {
    "information_requirement": "Is an adversary removing indicators of compromise from mobile devices to evade detection? (PIR)",
    "tactic_id": "TA0030",
    "tactic_name": "Defense Evasion",
    "indicators": [
      {
        "technique_id": "T1630",
        "name": "Indicator Removal on Host",
        "evidence": [
          {
            "description": "A Mobile EDR log event indicates an application invoked a data or cache clearing API call, such as Android's `clearApplicationUserData` or iOS's `FileManager.removeItem`. The event is considered suspicious if the `event.properties` field does not explicitly flag the action as user-initiated, and it occurs outside of established behavioral baselines for the application, such as at an anomalous time of day or immediately following a network connection to a low-reputation domain.",
            "data_sources": [
              "MDM Application Activity Log",
              "Mobile EDR/MTP Agent Log",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Managed mobile devices (iOS, Android); Corporate Wi-Fi access points; VPN concentrators; Cloud-based MDM/UEM management consoles",
            "action": [
              "Create a SIEM correlation rule that triggers when a Mobile EDR log shows an `event.type` of 'api_call' with `api.name` as 'clearApplicationUserData' or 'FileManager.removeItem' AND the `app.hash` or `app.package_name` exists on a threat intelligence feed of known malware.",
              "For each application (`app.package_name`), execute a scheduled hourly query to calculate the frequency of non-user-initiated data-clearing events per device. Establish a 30-day rolling baseline of this frequency. Generate an alert if the current hour's frequency for an application on any device exceeds the 99th percentile of its historical baseline, indicating an unusual spike in activity.",
              "Train a Random Forest classifier to predict if a data-clearing event is malicious (`is_malicious` = 1) or benign (`is_malicious` = 0). Engineer features from MDM/EDR and Zeek logs including: `app_category`, `is_user_initiated` (boolean), `time_of_day_bucket` (e.g., 'business_hours', 'after_hours'), `day_of_week`, and `sum_bytes_out_5min_prior` (calculated from Zeek conn.log). An event with a predicted probability score > 0.9 should trigger an automated workflow to isolate the device via MDM API and create a high-priority incident."
            ]
          },
          {
            "description": "A Mobile EDR or File Integrity Monitoring (FIM) agent log shows a mobile application process generating a high volume of file deletion events or deleting files outside its designated sandboxed directory. The activity is considered malicious if it targets sensitive, non-application-specific locations such as user data folders (e.g., `/storage/emulated/0/DCIM`, `/storage/emulated/0/Documents` on Android) or system log directories on jailbroken/rooted devices (e.g., `/var/log` on iOS, `/data/log` on Android), and the process is not on an established allowlist.",
            "data_sources": [
              "MDM File Integrity Monitoring Log",
              "Mobile EDR/MTP Agent Log",
              "Zeek files.log",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Managed mobile devices (iOS, Android); MDM/UEM servers; Network egress points with file transfer monitoring",
            "action": [
              "Deploy an EDR/FIM policy to generate a critical alert if a process whose `process.name` is not on an enterprise allowlist performs a delete operation (`event.type` = 'deletion') within protected directories such as `/var/log`, `/storage/emulated/0/DCIM`, or `/private/var/mobile/Library/SMS/`. The rule should filter out known good processes like system updaters or security agents.",
              "Run an hourly SIEM query grouping by `app.package_name` to compute two metrics: (1) the total count of deleted files, and (2) the Shannon entropy of the file extensions of deleted files using the formula $$ H(X) = -\\sum_{i=1}^{n} P(x_i) \\log_2 P(x_i) $$. High entropy suggests indiscriminate deletion of varied file types. Alert if the deletion count exceeds 3 standard deviations of the application's 30-day hourly baseline OR if the entropy score increases by more than 50% from its baseline.",
              "Ingest EDR file events into a data analytics platform. Use a DBSCAN clustering model on a feature set including `deletion_count_per_minute`, `total_bytes_deleted`, and `directory_path_depth` for each application's burst of activity. DBSCAN is effective here as it does not require a predefined number of clusters. Isolate and investigate outlier event clusters, which represent anomalous deletion patterns. Correlate these outlier device and timestamp events with Zeek `files.log` (for `mime_type`) and `conn.log` (for `orig_bytes` and `resp_bytes`) to check for preceding data exfiltration."
            ]
          },
          {
            "description": "MDM application inventory logs show an application was uninstalled from a device in a time period that is anomalously short (e.g., under one hour) following its installation. This evidence is strengthened when the uninstall event is programmatic (e.g., via Android's `PackageInstaller.uninstall()` API) and not explicitly user-initiated through the OS GUI, or is preceded by suspicious network activity, such as connections to known malicious domains or a high rate of DNS resolution failures (NXDOMAIN).",
            "data_sources": [
              "MDM Application Inventory Log",
              "Mobile EDR/MTP Agent Log",
              "Zeek dns.log",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Managed mobile devices (iOS, Android); MDM/UEM servers; Enterprise DNS resolvers",
            "action": [
              "Create a SIEM rule to alert when an MDM log shows an `app_uninstall` event AND the `app.package_name` or `app.hash` is present on a threat intelligence feed specifically categorized as 'short-lived malware' or 'dropper'.",
              "Using a scheduled query, join MDM application install and uninstall logs on `device_id` and `app.name` to calculate `app_lifetime_seconds`. Alert if `app_lifetime_seconds` is below the 5th percentile of all app lifetimes calculated across the enterprise over the last 90 days. To reduce false positives, enrich alerts by querying Zeek `dns.log` for the `device_id` during the app's lifetime; a ratio of NXDOMAIN responses to total queries greater than 0.5 is a strong corroborating indicator of C2 behavior.",
              "Train a logistic regression model to produce a risk score for each uninstallation event. Engineer features such as: `app_lifetime_seconds`, `install_source` (categorical: 'AppStore', 'Sideloaded', 'EnterpriseStore'), `unique_dns_domains_contacted` (from Zeek `dns.log`), `total_bytes_transferred` (from Zeek `conn.log`), and `is_programmatic_uninstall` (boolean from EDR). A predicted risk score > 0.85 should automatically create an incident ticket for Tier 2 analysis, including all feature values for the analyst's review."
            ]
          },
          {
            "description": "An MDM or Mobile EDR log indicates a process has attempted to terminate, modify the configuration of, or revoke Device Administrator permissions from a recognized mobile security agent. This is identified by monitoring for process termination events targeting the security agent's process name (e.g., `com.mobile.security.agent`) or system events showing a change in the active Device Administrator list where the change was not initiated by an MDM policy.",
            "data_sources": [
              "Mobile EDR/MTP Agent Log",
              "MDM Policy Compliance Log",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Managed mobile devices; MDM/UEM management consoles; Centralized mobile log aggregation platform",
            "action": [
              "Create a critical severity SIEM alert that triggers when an MDM log shows an `event.type` of 'device_admin_revoked' for a `process.name` matching the enterprise security agent AND the `initiator.process.name` is not the MDM agent or a known system process.",
              "Establish a heartbeat check for the mobile security agent, reporting its status every 5 minutes. Calculate the 95th percentile for the time delta between successful check-ins for each device over a 30-day period. Trigger an alert if a device's agent fails to check in within this time threshold and the device is still online, as verified by recent Zeek conn.log traffic from the device IP.",
              "Train an Isolation Forest model on time-series data from the security agent, using features like `cpu_usage`, `memory_usage`, and `network_bytes_sent`. The model learns the normal operating profile. A new data point that is flagged as an anomaly (returns a score of -1) indicates a significant deviation, such as a process crash or suspension, and should generate an alert for investigation."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "1.5",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]