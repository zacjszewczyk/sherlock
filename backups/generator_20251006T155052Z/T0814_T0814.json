[
  {
    "information_requirement": "Is an adversary attempting to disrupt industrial control system (ICS) device functionality via Denial of Service? (PIR)",
    "tactic_id": "TA0107",
    "tactic_name": "Inhibit Response Function",
    "indicators": [
      {
        "technique_id": "T0814",
        "name": "Denial of Service",
        "evidence": [
          {
            "description": "A sustained, anomalous increase in network traffic volume (bytes or packets per second) or connection rate directed at a critical ICS device (e.g., PLC, RTU, HMI), where traffic metrics exceed the 99th percentile of a 30-day historical baseline for three consecutive 60-second intervals. This traffic surge is correlated with a simultaneous spike in ICS protocol-specific errors, such as Modbus exception codes, EtherNet/IP status errors, or DNP3 errors.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek modbus.log",
              "Zeek ether_ip.log",
              "Zeek dnp3.log",
              "Zeek s7comm.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).",
            "action": [
              "Create a correlation rule that alerts when a high volume of connections (e.g., >1000 connections/minute) to a critical ICS device IP on a known ICS port (e.g., 502, 20000, 44818, 102) occurs within the same 1-minute window as a burst of protocol-specific errors (e.g., Modbus exception codes) from the same device in Zeek logs.",
              "For each critical ICS device, calculate a 30-day rolling baseline of 1-minute interval statistics for total bytes, total packets, and new connection counts from Zeek conn.log. Alert if any of these metrics exceed the 99th percentile for three consecutive minutes. Concurrently, calculate the Shannon entropy of source IP addresses (`id.orig_h`); a simultaneous drop in entropy (e.g., below 1.0) with a high traffic alert strongly indicates a targeted flood.",
              "Apply a trained multivariate time-series anomaly detection model (e.g., Variational Autoencoder) to 1-minute aggregated network features for each critical ICS asset, including `total_bytes`, `packet_count`, `connection_count`, `unique_source_ips`, and `protocol_error_rate`. Alert when the model's reconstruction error surpasses a dynamic threshold, indicating a significant deviation from learned normal traffic patterns."
            ]
          },
          {
            "description": "An anomalous rate of connection rejections from a critical ICS device, evidenced by a count of connection states ('REJ', 'RSTO', 'RSTR') in Zeek conn.log exceeding the 99th percentile of a 30-day baseline for at least 60 seconds. The majority (>90%) of these rejected connection attempts originate from a small set of source IPs (fewer than 5).",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).",
            "action": [
              "Create a rule that alerts when, for a single critical ICS device IP (`id.resp_h`), the count of Zeek conn.log entries with `conn_state` IN ['REJ', 'RSTO', 'RSTR', 'RSTRH'] exceeds a static threshold (e.g., 100 events in 60 seconds) and the number of unique source IPs (`id.orig_h`) is less than 5.",
              "For each critical ICS device, establish a 30-day rolling baseline for the 1-minute count of connections with reset/rejection states from Zeek conn.log. Alert if this count exceeds the 99th percentile. Upon alert, automatically calculate the source IP distribution for that interval; escalate the alert if a single source IP accounts for >80% of the total connection attempts to the victim device.",
              "Every 5 minutes, apply an unsupervised clustering algorithm (e.g., DBSCAN) to Zeek conn.log features including `id.resp_h`, `duration`, `orig_bytes`, and `conn_state`. Alert on clusters characterized by a high density of points with a single critical ICS device IP, short duration, zero/low `orig_bytes`, and a rejection `conn_state`, as these represent a DoS attack pattern."
            ]
          },
          {
            "description": "An unexpected crash or service termination on a critical Windows-based ICS host (e.g., HMI, EWS, Historian), evidenced by an Application Error (Windows Event ID 1000), Application Hang (Event ID 1002), or Service Control Manager abnormal termination (Event ID 7031, 7034). The host event is temporally correlated, occurring within a 60-second window following a statistically significant surge in network traffic to the host.",
            "data_sources": [
              "Windows Event ID 1000",
              "Windows Event ID 1002",
              "Windows Event ID 7031",
              "Windows Event ID 7034",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).",
            "action": [
              "Create a correlation rule that alerts when a Windows Event ID (1000, 1002, 7031, or 7034) for a monitored critical process/service is logged, and within the preceding 60 seconds, the host's IP received an anomalous number of connections (e.g., >500) from a single source IP, as seen in Zeek conn.log.",
              "Upon detecting a critical process termination event (Event IDs 1000, 1002, 7031, 7034), automatically query network traffic metrics (connection count, total bytes) from Zeek conn.log for the affected host over the preceding 5 minutes. Compare these metrics to the host's 30-day historical distribution for the same time-of-day and day-of-week. Flag the event as a potential network-induced DoS if recent traffic metrics exceed the 99th percentile of the historical distribution.",
              "Deploy a trained sequence-aware model (e.g., RNN, LSTM) on time-ordered event data, using a sequence of network traffic features (e.g., connection rate, byte rate from Zeek) to predict a binary label indicating if a critical host crash event (e.g., Event ID 1000) occurs in the next minute. Alert when the model predicts a high probability of a crash, indicating that the current traffic pattern is a known precursor to system failure."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "1.5",
    "date_created": "2025-09-25",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  },
  {
    "information_requirement": "Is an adversary attempting to disrupt operator visibility of the industrial process? (PIR)",
    "tactic_id": "TA0105",
    "tactic_name": "Impact",
    "indicators": [
      {
        "technique_id": "T0814",
        "name": "Denial of Service",
        "evidence": [
          {
            "description": "Evidence is a high-volume network flood targeting a critical ICS asset (e.g., HMI, Historian, OPC server), characterized by traffic rates exceeding 10 times the normal baseline (99th percentile) and a high proportion (>90%) of incomplete or rejected TCP connections (e.g., Zeek conn.log states 'S0', 'RSTO', 'REJ'). The traffic originates from source IPs not on an approved whitelist of ICS network segments.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek notice.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "ICS Level 3 (Manufacturing Operations) and Level 2 (Control System) network boundaries, Data Historian servers, HMI Workstations.",
            "action": [
              "Deploy a rule that monitors Zeek conn.log for traffic destined for critical ICS asset IPs. The rule should trigger a high-severity alert if, within a 60-second window, an external source IP (not on the internal network whitelist) generates over 500 connection attempts AND the ratio of connection states 'S0', 'RSTO', or 'REJ' to total connections from that source exceeds 90%. Correlate with Zeek's notice.log for `Scan::Address_Scan` notices against the same target.",
              "For each critical ICS asset, continuously calculate a 14-day rolling baseline and 99.9th percentile for two metrics: new connections per minute and total bytes per minute. Trigger a high-severity alert if the current rate for both metrics exceeds their respective thresholds for three consecutive minutes. Concurrently, calculate the Shannon entropy of source IP addresses connecting to the asset over 5-minute windows. A sudden drop in entropy below the 5th percentile of its historical baseline, combined with a high connection rate, indicates a low-complexity flood attack.",
              "Implement an unsupervised anomaly detection model (e.g., Isolation Forest) on real-time network flow data (Zeek conn.log) targeting critical ICS assets. The model should be trained on feature vectors including source/destination IP, destination port, protocol, packet count, byte count, and connection state within 1-minute time windows. The model will learn the normal traffic distribution; any new flow data flagged with a high anomaly score indicates a deviation from normal behavior, such as a DoS attack, and should be alerted for investigation."
            ]
          },
          {
            "description": "Evidence is the unexpected termination of a critical ICS-related Windows service (e.g., OPC server, Historian agent), identified by Windows Event ID 7034 ('Service terminated unexpectedly'). The termination is considered anomalous if the service does not successfully restart (logged as Event ID 7036) within its configured recovery window (e.g., 60 seconds) and the termination is not associated with a planned system shutdown (Event ID 1074).",
            "data_sources": [
              "Windows Event ID 7034",
              "Windows Event ID 7036",
              "Windows Event ID 7024",
              "Windows Event ID 1074",
              "Windows Event ID 4688",
              "Windows Event ID 1 (Sysmon Process Create)"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "ICS Level 2 (Control System) HMI Workstations, Engineering Workstations, and SCADA/Historian Servers.",
            "action": [
              "Create a rule that triggers on Windows Event ID 7034 or 7024 for any service name on a critical ICS services watchlist. The rule logic should wait 60 seconds to see if a corresponding Event ID 7036 (service started) for the same service name is logged. If no restart event is seen, and there is no preceding Event ID 1074 (system shutdown) initiated by an authorized administrator within the last 5 minutes, generate a high-severity alert.",
              "For each critical ICS service, use historical data (Event IDs 7034/7024) to calculate its mean time between failures (MTBF). Trigger a medium-severity alert if a service fails and its uptime since the last failure is less than 50% of the historical MTBF, suggesting an abnormal failure rate. Additionally, profile the frequency of error codes from Event ID 7024; an error code that is statistically rare (e.g., has a frequency of <1% in the last 90 days) should be flagged for immediate investigation.",
              "Develop a supervised classification model (e.g., XGBoost) trained on historical Windows event logs surrounding service terminations. Features should include service name, error code (from Event ID 7024), time since last failure, recent administrative logins (Event ID 4624), and recent software installations (Event ID 11707). Label historical events as 'benign' (planned restart) or 'anomalous'. Use the model to predict the likelihood that new service terminations are anomalous, flagging events with a high anomaly score for analyst review."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "1.5",
    "date_created": "2025-09-25",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]