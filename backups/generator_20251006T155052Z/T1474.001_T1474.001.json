[
  {
    "information_requirement": "Has an adversary compromised our mobile applications by injecting malicious code into their software dependencies or development tools? (PIR)",
    "tactic_id": "TA0027",
    "tactic_name": "Initial Access",
    "indicators": [
      {
        "technique_id": "T1474.001",
        "name": "Compromise Software Dependencies and Development Tools",
        "evidence": [
          {
            "description": "A mobile application on a managed device exhibits anomalous network behavior, evidenced by one or more of the following: (1) communication with an IP, domain, JA3/JA3S hash, or SSL/TLS certificate serial number present on a threat intelligence feed; (2) network traffic to a domain with high Shannon entropy, indicative of DGA; (3) a daily data egress volume exceeding the 95th percentile for that specific application's 30-day baseline; (4) use of an SSL certificate issuer or JA3/JA3S hash that is rare (bottom 1% prevalence) across the mobile device fleet.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log",
              "Zeek ssl.log",
              "Zeek http.log",
              "Mobile Device Management (MDM) logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate Wi-Fi network gateways, VPN concentrators, and Mobile Device Management (MDM) platforms monitoring mobile device traffic.",
            "action": [
              "Implement a real-time SIEM rule that correlates Zeek logs (conn.log, dns.log, ssl.log) with threat intelligence feeds. Generate a high-severity alert for any mobile device IP address making a connection where the destination IP/domain, SSL certificate serial, or JA3/JA3S hash is a known indicator of compromise. Additionally, alert on any HTTP User-Agent string from mobile devices that matches a known malicious signature or is not on an approved list for common libraries.",
              "For each managed mobile application, establish a 30-day rolling baseline of network activity and apply a multi-metric risk score. From Zeek conn.log, calculate the 95th percentile for daily data egress and add to the score if exceeded. From Zeek dns.log, calculate the Shannon entropy of requested second-level domains per hour and add to the score for values greater than 3 standard deviations above the application's mean. From Zeek ssl.log, maintain a frequency table of JA3 hashes and certificate issuers and add to the score if an application uses a hash or issuer in the bottom 1% of prevalence. Alert when an application's cumulative risk score crosses a defined threshold.",
              "Deploy an unsupervised anomaly detection model, such as an Isolation Forest or Autoencoder, on network session data from mobile devices. Engineer features from Zeek logs by aggregating data per connection uid: conn_state, protocol, duration, orig_bytes, resp_bytes from conn.log; query_length and answer_count from dns.log; cert_validity_period and server_name_length from ssl.log. The model will identify and score network sessions that are statistical outliers compared to the learned 'normal' behavior, flagging high-scoring sessions as potential malicious C2 channels for analyst review."
            ]
          },
          {
            "description": "A development process on a developer workstation or CI/CD build server performs suspicious actions, evidenced by: (1) a development tool (e.g., gradle.bat, xcodebuild) spawning a scripting interpreter (e.g., powershell.exe) with encoded or download-related command-line arguments; (2) a network connection from a development tool to a newly registered domain or a raw IP address; (3) file modification (Sysmon Event ID 11) of a project dependency file (e.g., package.json, Podfile.lock) by a process other than a package manager or source control client; (4) creation of an unsigned child process by a signed development tool.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 4104",
              "Windows Sysmon Event ID 1",
              "Windows Sysmon Event ID 3",
              "Windows Sysmon Event ID 11",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Developer endpoints and continuous integration/continuous delivery (CI/CD) build servers within the corporate network.",
            "action": [
              "Create a detection rule using Sysmon Event ID 1 that triggers when a development process (e.g., devenv.exe, xcodebuild, MSBuild.exe, gradle.bat, npm.cmd, yarn.cmd) spawns powershell.exe, cmd.exe, wscript.exe, or cscript.exe with command-line arguments containing keywords like '-enc', '-w hidden', 'IEX', or 'DownloadString'. Correlate with Windows Event ID 4104 (PowerShell Script Block Logging) for script deobfuscation. Also, alert if a signed parent development tool spawns an unsigned child process (where the 'Signed' field is 'false').",
              "For each developer host, establish a statistical baseline of process and network activity. Using Sysmon Event ID 1, profile parent-child process relationships and alert when a development tool spawns a child process not seen in its 30-day baseline. Calculate the command-line length and entropy for each process and alert if either metric exceeds 3 standard deviations from the historical norm for that specific parent-child pair. Using Sysmon Event ID 3 and Zeek dns.log, track domain age and alert if a development tool connects to a domain registered in the last 30 days.",
              "Train a supervised classification model, such as a Gradient Boosting classifier, on process-level event sequences. Create feature vectors for sessions, defined as a parent process and its children and network connections within a 5-minute window. Features should include: parent process name, child process count, command-line entropy, count of network connections, and count of file modifications (from Sysmon Event ID 11). Label historical data as benign or malicious and train the model to classify new sessions as 'suspicious supply chain activity', triggering a high-priority alert."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-10-01",
    "version": "1.5",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]