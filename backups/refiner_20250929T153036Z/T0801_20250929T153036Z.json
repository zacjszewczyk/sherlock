[
  {
    "information_requirement": "Has an unauthorized entity accessed or queried process state data from key ICS components? (PIR)",
    "tactic_id": "TA0100",
    "tactic_name": "Collection",
    "indicators": [
      {
        "technique_id": "T0801",
        "name": "Monitor Process State",
        "evidence": [
          {
            "description": "A recorded ICS protocol read request (e.g., Modbus Function Code 0x03/0x04, DNP3 Function Code 0x01/0x02, OPC-UA Read/Browse service calls) targeting a Data Historian or PLC from a source IP address or user account not present in an established allow-list. Alternatively, an allow-listed source IP or user account initiating a daily volume of read requests or total data transfer size that exceeds its 99th percentile baseline, calculated over the past 30 days.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek modbus.log",
              "Zeek dnp3.log",
              "Zeek opc.log",
              "Windows Event ID 4624",
              "Windows Event ID 4663"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Data Historian servers (Level 3), Process Control Network (PCN) gateways (Level 3/2), PLC subnets (Level 1/2), HMI/EWS subnets (Level 2.5/2), DMZ between IT and OT networks.",
            "action": "1. **Symbolic Logic:** Maintain an allow-list of authorized source IPs, user accounts, and their corresponding destination ICS assets (Historians, PLCs) and allowed ICS ports/protocols (Modbus 502, DNP3 20000, OPC-UA 4840, Siemens S7 102). Generate an alert if `Zeek conn.log` shows a connection to an ICS asset on an ICS port from a source IP not in the allow-list. Further, parse `Zeek modbus.log`, `Zeek dnp3.log`, and `Zeek opc.log` for read requests (e.g., Modbus FC 0x03/0x04, DNP3 FC 0x01/0x02, OPC-UA Read/Browse) originating from an unapproved IP or user. Correlate with `Windows Event ID 4663` for file/object access on Historian servers by unauthorized users or processes, and `Windows Event ID 4624` for successful authentication by unauthorized users to critical ICS assets."
          },
          {
            "description": "A source IP address, typically an HMI or EWS, establishes network connections on ICS-specific ports (e.g., Modbus 502, DNP3 20000, OPC-UA 4840) to a count of unique destination ICS devices (PLCs, RTUs, IEDs) within a 15-minute rolling window that exceeds its 99th percentile historical count. This includes connections to devices outside its documented operational zone or established communication allow-list.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek modbus.log",
              "Zeek dnp3.log",
              "Zeek opc.log",
              "Windows Event ID 5156",
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Engineering Workstations (EWS) (Level 2), Human-Machine Interface (HMI) systems (Level 2), Level 2/3 network boundary devices, PLC/RTU subnets (Level 1/2), ICS application servers (Level 2.5).",
            "action": "1. **Symbolic Logic:** Maintain a dynamic allow-list of known, authorized peer-to-peer communication relationships between ICS hosts (EWS, HMI, PLCs) and specific ICS assets on ICS ports (e.g., 502, 20000, 4840). Generate an alert when `Zeek conn.log` shows a source IP initiating a connection to an ICS device on an ICS port that is not part of its established communication allow-list or documented operational zone. Correlate this with `Windows Event ID 4688` for any new or unusual process execution on the source host immediately preceding the anomalous connection attempt (within 60 seconds). 2. **Statistical Method:** For each unique source IP observed in `Zeek conn.log` (filtered for ICS ports 502, 20000, 4840), calculate the number of unique destination IPs and unique destination ICS ports contacted within a rolling 10-minute window. Establish a 30-day rolling baseline for these counts for each source IP. Trigger an alert if the current count of unique destinations or unique ports for a source IP exceeds its 99th percentile within the 10-minute window, indicating a sudden and statistically significant expansion of network interaction potentially for discovery or widespread data collection. 3. **Machine Learning:** Apply a clustering algorithm (e.g., K-Means, DBSCAN, Gaussian Mixture Model) to historical `Zeek conn.log` and ICS protocol-specific logs (`Zeek modbus.log`, `Zeek dnp3.log`, `Zeek opc.log`) data for ICS source IPs. Use features such as source IP, destination IP, destination port, ICS function codes/service calls, and connection duration to group hosts by their typical communication profiles. Flag a host if its current communication pattern significantly deviates from its assigned cluster's centroid (e.g., a host suddenly communicating with devices across multiple clusters it typically doesn't interact with, or showing a high Mahalanobis distance from its cluster center), suggesting a change in behavior indicative of reconnaissance or widespread process data collection."
          },
          {
            "description": "A successful remote interactive login (RDP, SSH, console) to a critical ICS host (HMI, EWS, Data Historian) where the source IP's geolocation is outside an approved region, the login occurs outside defined operational hours, or the user account has no prior history of interactive logins to that specific host. This login is followed within 5 minutes by multiple outbound ICS protocol communications (e.g., Modbus FC 0x03/0x04, DNP3 FC 0x01/0x02, OPC-UA Read/Browse) from the logged-in host to different Level 1/2 ICS devices.",
            "data_sources": [
              "Windows Event ID 4624",
              "Windows Event ID 4648",
              "Zeek conn.log",
              "Zeek rdp.log",
              "Zeek modbus.log",
              "Zeek dnp3.log",
              "Zeek opc.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Human-Machine Interfaces (HMIs) (Level 2), Engineering Workstations (EWS) (Level 2), ICS Application Servers (Level 2.5), Jump Servers (Level 3/2.5), Active Directory Domain Controllers (Level 3).",
            "action": "1. **Symbolic Logic:** Establish an allow-list of authorized source IPs, user accounts, and typical logon times/days for remote interactive logons (Windows Event ID 4624, Logon Type 10 for RDP, 7 for Unlock, or 2 for Interactive Console; `Zeek rdp.log` for RDP activity) to critical ICS hosts. Generate an alert for any successful remote logon (Event ID 4624, Type 10/7/2) from a source IP with a geolocation outside the approved region, occurring outside defined operational hours (e.g., 07:00-18:00 M-F), or using an account that has no prior interactive logon history to that specific host. Upon such an alert, immediately query `Zeek conn.log` and protocol-specific logs (e.g., `modbus.log`, `dnp3.log`, `opc.log`) for any outbound connections from the affected ICS host to Level 1/2 devices on ICS ports within a 5-minute window. Flag if multiple unique Level 1/2 devices are contacted with ICS protocol read requests. 2. **Statistical Method:** For each critical ICS host, baseline the frequency and duration of remote interactive logon sessions (Windows Event ID 4624, Logon Type 10) and the subsequent volume of ICS protocol traffic (`Zeek conn.log`, `modbus.log`, `dnp3.log`, `opc.log`) to Level 1/2 devices within a 5-minute post-login window. Calculate the 99th percentile for these metrics over the last 30 days. Trigger an alert if an interactive logon session, especially one from a source IP or user account with a low historical frequency (e.g., below 5th percentile), is immediately followed by ICS traffic to Level 1/2 devices that exceeds its 99th percentile in terms of unique destination devices contacted or total data transfer volume within that 5-minute window. 3. **Machine Learning:** Train a supervised learning model (e.g., Gradient Boosting, XGBoost) to classify remote logon sessions on critical ICS hosts as 'normal' or 'anomalous'. Features for the model should include source IP entropy, time of day, day of week, user account history (e.g., `last_login_time`, `login_frequency` for that host), source IP geolocation (country, ASN), and the number of prior successful logins from that source IP. If a logon is classified as anomalous, then apply a sequential pattern mining algorithm (e.g., GSP, PrefixSpan) to `Zeek conn.log` and ICS protocol logs to identify common sequences of events post-login on that host. Flag any sequence that includes connections to a high number of unique Level 1/2 devices or a high volume of ICS protocol read requests as suspicious process state monitoring activity."
          }
        ]
      }
    ],
    "version": "1.2",
    "date_created": "2025-09-25",
    "last_updated": "2025-09-29",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]