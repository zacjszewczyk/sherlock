[
  {
    "information_requirement": "Has the adversary established persistence by creating unauthorized accounts on the enterprise network?",
    "tactic_id": "TA0003",
    "tactic_name": "Persistence",
    "indicators": [
      {
        "technique_id": "T1136",
        "name": "Create Account",
        "evidence": [
          {
            "description": "A user account creation event (Windows Event ID 4720) is observed where the 'TargetUserName' field contains a value matching a known-bad indicator from a threat intelligence feed, or matches a regular expression designed to catch suspicious naming conventions (e.g., default tool names, names with excessive numbers, or names mimicking system accounts).",
            "data_sources": [
              "Windows Event ID 4720",
              "Threat Intelligence Feed"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Member Servers, Administrator Workstations, SIEM/Data Lake",
            "action": [
              "Symbolic: Create and maintain a watchlist of known malicious account usernames from threat intelligence and suspicious naming conventions using regular expressions (e.g., '.*admin.*', '.*backup.*', 'test', 'support_[a-f0-9]{8}', 'svc-.*'). Configure a SIEM rule to generate a high-priority alert when the 'TargetUserName' field in a Windows Event ID 4720 matches any entry on this watchlist.",
              "Statistical: Calculate the rate of account creations per hour across the enterprise. Establish a baseline using a 30-day moving average and standard deviation. Generate a medium-priority alert if the hourly account creation count exceeds 3 standard deviations above the baseline, which may indicate a mass account creation event often associated with ransomware or wiper attacks.",
              "Machine Learning: Train a classification model (e.g., Random Forest, Gradient Boosting) on historical account creation events. Use features such as the creator account's role, time of day, day of week, and username string characteristics (length, character types, presence of numbers, ratio of vowels to consonants). Label historical events as 'benign' or 'suspicious' based on past incident reports. Use the trained model to score new account creation events in real-time for their probability of being malicious."
            ]
          },
          {
            "description": "The creation of a user account is preceded by the execution of account management utilities (e.g., 'net.exe', 'net1.exe', 'wmic.exe', 'powershell.exe') via a process creation event (Windows Event ID 4688), where the parent process is anomalous. Anomalous parents include non-interactive processes like web servers ('w3wp.exe'), database services, or common user productivity applications ('WINWORD.EXE', 'EXCEL.EXE').",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 4720",
              "Windows Event ID 4722"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Web Servers, User Endpoints, Application Servers",
            "action": [
              "Symbolic: Create a detection rule that triggers on Windows Event ID 4688 when 'ProcessName' is 'net.exe', 'wmic.exe', or 'powershell.exe' AND the 'CommandLine' contains keywords like '/add', 'New-LocalUser', 'Enable-LocalUser', or 'useraccount create'. Escalate the alert priority if the 'ParentProcessName' is on a list of suspicious parents, such as 'w3wp.exe', 'WINWORD.EXE', 'EXCEL.EXE', or 'svchost.exe' running under a non-system account.",
              "Statistical: For each child process associated with account creation (e.g., 'net.exe'), build a frequency table of its historical parent processes across the environment. Calculate the rarity of each observed parent-child combination. Generate an alert when a parent-child combination falls below a low percentile threshold (e.g., <1st percentile), indicating a highly unusual execution chain.",
              "Machine Learning: Use a sequence anomaly detection model to learn the normal grammar of process execution chains that lead to legitimate account creation. Model sequences of process creations (from Event ID 4688) as sentences. Flag any sequence that significantly deviates from learned normal patterns (e.g., a web shell spawning PowerShell to create a user) as a high-confidence anomaly indicative of post-exploitation activity."
            ]
          },
          {
            "description": "A user account creation event (Windows Event ID 4720) is temporally correlated (e.g., within 5 minutes) with a subsequent group membership change event (Windows Event ID 4728, 4732, or 4756) that adds the newly created account to a high-privilege administrative group (e.g., 'Domain Admins', 'Administrators').",
            "data_sources": [
              "Windows Event ID 4720",
              "Windows Event ID 4728",
              "Windows Event ID 4732",
              "Windows Event ID 4756"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Active Directory Federation Services (ADFS), IT Service Management (ITSM) Platform, Human Resources Systems",
            "action": [
              "Symbolic: Maintain an explicit allow-list of user accounts authorized to create new accounts and a list of highly privileged groups. Create a correlation rule that triggers when an account creation event (4720) is initiated by a user not on the allow-list OR if a new account is added to a privileged group (4728, 4732, 4756) within 10 minutes of its creation (4720), especially outside of a defined change management window.",
              "Statistical: For each administrator, profile the distribution of days and times they typically perform account creation and privilege modification tasks. For each new account creation (4720) followed by group addition, calculate the z-score for the event time based on the specific administrator's historical activity. Alert if the z-score exceeds a threshold (e.g., > 3), indicating activity at a highly unusual time for that specific admin.",
              "Machine Learning: Develop a sequence analysis model to learn the typical chain of events for provisioning a new user (e.g., HR ticket created -> ITSM ticket approved -> account created -> groups assigned). Ingest logs from HR systems, ITSM tools, and Active Directory. Use this model to identify account creations and privilege escalations that occur without a preceding, corresponding authorization event, flagging them as policy violations that break the chain of custody."
            ]
          },
          {
            "description": "A new account is created (Windows Event ID 4720) where the 'TargetUserName' string has statistical properties that are anomalous when compared to the population of existing usernames. These properties include high Shannon entropy (indicating randomness) or low Levenshtein distance to an existing privileged account's name (indicating typosquatting).",
            "data_sources": [
              "Windows Event ID 4720",
              "Active Directory User Object Export"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Member Servers, SIEM/Data Lake",
            "action": [
              "Symbolic: Define and enforce a regular expression that codifies the standard corporate username format (e.g., '^[a-z]+\\.[a-z]+[0-9]*$'). Run this regex against the 'TargetUserName' field for every Windows Event ID 4720. Generate an alert for any new username that does not match the established pattern.",
              "Statistical: Periodically, or on-demand, calculate the character entropy for all existing usernames to establish a baseline distribution. For each new account creation (Event ID 4720), calculate the entropy of the new username and alert if the score is in the top 99th percentile. Concurrently, calculate the Levenshtein distance between the new username and all existing privileged usernames; alert if the distance is 1 or 2, suggesting a typosquatting attempt.",
              "Machine Learning: Train a one-class SVM or an autoencoder on the character-level n-grams of all legitimate existing usernames to learn the 'shape' of a normal username. For each new username from Event ID 4720, feed it into the model. If the model flags the new name as an outlier (one-class SVM) or has a high reconstruction error (autoencoder), generate an alert for a potentially algorithmically generated or typosquatted username."
            ]
          },
          {
            "description": "A user account creation event (Windows Event ID 4720) is immediately followed by activity from that new account, such as an interactive logon from an unusual location (Windows Event ID 4624, Logon Type 2/10) or the initiation of anomalous outbound network connections (Zeek conn.log) or DNS requests (Zeek dns.log).",
            "data_sources": [
              "Windows Event ID 4720",
              "Windows Event ID 4624",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, User Endpoints, Network Egress Points, DNS Resolvers",
            "action": [
              "Symbolic: Create a correlation rule that looks for a Windows Event ID 4720 (account created) followed within 15 minutes by a Windows Event ID 4624 (logon) where the 'TargetUserName' is the same in both events and the Logon Type is 2 (Interactive) or 10 (RemoteInteractive). Generate a high-priority alert on this sequence, especially if the source IP address is external.",
              "Statistical: For each host, baseline the volume and destination port distribution of outbound network traffic using Zeek conn.log. After an account is created on a host (Event 4720), monitor its outbound traffic for the next hour. Alert if there is a statistically significant spike in traffic volume or if connections are made to ports that are rare for that host (e.g., outside the top 95% most common ports). Also, monitor for a sudden increase in the entropy of requested domain names in Zeek dns.log, which could indicate DGA activity.",
              "Machine Learning: Use a graph-based anomaly detection model where nodes represent users, hosts, and destination IPs, and edges represent events like 'created', 'logged-on-to', and 'connected-to'. Search for the emergence of subgraphs where a new user node is created and immediately becomes active, forming connections to unusual external nodes or exhibiting behavior patterns (e.g., specific port/protocol usage) that differ from established peer groups of users."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.3",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]