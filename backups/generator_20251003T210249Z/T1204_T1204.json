[
  {
    "information_requirement": "Has the adversary achieved execution through user interaction? (PIR)",
    "tactic_id": "TA0002",
    "tactic_name": "Execution",
    "indicators": [
      {
        "technique_id": "T1204",
        "name": "User Execution",
        "evidence": [
          {
            "description": "A user-facing application (e.g., OUTLOOK.EXE, chrome.exe) spawns a child process that makes an outbound network connection to a destination IP or domain matching a known-bad indicator from a threat intelligence feed.",
            "data_sources": [
              "Windows Event ID 4688",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, Email gateways, Web proxies, DNS resolvers",
            "action": [
              "Join process creation events (Windows Event ID 4688) with network connection logs (Zeek conn.log) by process ID and timestamp. Enrich destination IPs with domain names from DNS logs (Zeek dns.log). Alert if the destination IP or domain matches an entry in a high-confidence threat intelligence feed of known malicious hosts.",
              "For each common parent process (e.g., WINWORD.EXE, AcroRd32.exe), profile the historical frequency of destination domains its child processes connect to over a 30-day baseline. Generate an alert when a connection is made to a domain that falls below the 1st percentile of frequency for that parent process across the enterprise, indicating a rare destination.",
              "Train a decision tree or random forest classifier using features such as parent process name, child process name, destination IP geolocation, destination ASN, destination port, and threat intel score. Deploy the model to classify new process-network event chains and alert on those classified as malicious with high confidence."
            ]
          },
          {
            "description": "A command-line interpreter (powershell.exe, cmd.exe, wscript.exe) is executed with command-line arguments containing indicators of obfuscation, execution policy bypasses, or remote file download and execution commands.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, Domain Controllers, Application servers",
            "action": [
              "Using regex, scan command-line arguments in process creation events (Windows Event ID 4688) for malicious patterns such as 'IEX(New-Object Net.WebClient).DownloadString', '-enc', '-w hidden', 'Bypass', or 'FromBase64String'. Generate an alert on any match.",
              "For all interpreter processes (powershell.exe, cmd.exe, wscript.exe), calculate the Shannon entropy score of their command-line arguments. Establish a baseline entropy distribution for each interpreter. Alert when a new command's entropy exceeds the 99th percentile of its respective baseline, indicating likely obfuscation.",
              "Deploy a pre-trained Natural Language Processing (NLP) model or train a new one using TF-IDF vectorization on a labeled dataset of malicious and benign command lines. Use the model to classify new command lines from Event ID 4688 in real-time, flagging suspicious commands that do not match known symbolic signatures."
            ]
          },
          {
            "description": "A user-facing application (e.g., WINWORD.EXE, EXCEL.EXE, AcroRd32.exe) spawns a suspicious child process, such as a command-line interpreter (powershell.exe), scripting engine (wscript.exe, cscript.exe), or living-off-the-land binary (certutil.exe).",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, Terminal servers, Virtual Desktop Infrastructure (VDI)",
            "action": [
              "Maintain an explicit allow-list of known-good parent-child process relationships for high-risk parent applications (e.g., WINWORD.EXE -> splwow64.exe). Monitor process creation events (Windows Event ID 4688) and alert on any relationship not on the allow-list, such as WINWORD.EXE -> powershell.exe.",
              "For each parent process across the enterprise, build a 30-day rolling baseline of its child processes and their execution frequency. Alert when a parent process spawns a child that has never been seen before or is statistically rare (e.g., frequency is below the 1st percentile).",
              "Represent parent-child process relationships as a directed graph where nodes are processes and edges represent spawning events. Apply an unsupervised anomaly detection algorithm like Local Outlier Factor (LOF) or Isolation Forest to the graph structure to identify rare or abnormal edges (process creation events) that warrant investigation."
            ]
          },
          {
            "description": "Network traffic from a user endpoint shows connections to destinations with anomalous characteristics, including rare geolocations, recent domain registration dates, or unusual TLS client fingerprints (JA3/JA4S).",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log",
              "Zeek ssl.log",
              "Zeek x509.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network egress points, Web proxies, DNS resolvers",
            "action": [
              "Correlate DNS logs (Zeek dns.log) with a feed of newly registered domains (NRDs). Alert on any connection from a user endpoint (Zeek conn.log) to a domain registered within the last 30 days.",
              "For each user, create a baseline profile of typical destination countries, ASNs, and JA3/JA4S hashes. Alert when a new connection deviates significantly, such as a connection to a country a user has never connected to before, or a JA3/JA4S hash that is rare (<1% prevalence) across the entire organization.",
              "Implement a time series forecasting model (e.g., ARIMA) on key network metrics per user, such as bytes sent/received and connection count. Alert when observed activity significantly deviates from the forecasted range (e.g., exceeds the 95% confidence interval), indicating a potential C2 channel."
            ]
          },
          {
            "description": "An archive utility process (e.g., 7z.exe, winrar.exe, tar.exe) is executed, followed within 60 seconds by the execution of a file from a temporary or download directory.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, Download directories on shared servers",
            "action": [
              "Define a rule that triggers when a process creation event for an archive utility (7z.exe, winrar.exe) is followed within 60 seconds by another process creation event where the executable's path is within a high-risk directory (%APPDATA%, %TEMP%, C:\\Users\\*\\Downloads\\). Alert on this sequence.",
              "For all process creation events originating from temporary or download directories, analyze the time delta from the preceding process creation event. Flag any execution where the parent process was an archive utility and the time delta is an outlier (e.g., below the 10th percentile), suggesting an automated unpack-and-run sequence.",
              "Train a sequence analysis model, such as a Recurrent Neural Network (RNN) or Hidden Markov Model (HMM), on labeled sequences of process creation events (Windows Event ID 4688). Deploy the model to identify high-risk sequences in real-time, such as 'outlook.exe -> 7z.exe -> powershell.exe', even with variations in timing."
            ]
          },
          {
            "description": "A browser process (e.g., chrome.exe, msedge.exe) spawns a command-line interpreter (powershell.exe, cmd.exe) or makes a network connection to a domain with a suspicious TLD or character set (e.g., Punycode).",
            "data_sources": [
              "Windows Event ID 4688",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, Web proxies, DNS resolvers",
            "action": [
              "Monitor process creation events (Windows Event ID 4688) for any instance where a browser process (chrome.exe, msedge.exe, firefox.exe) is the parent of a command-line interpreter or scripting engine (cmd.exe, powershell.exe, wscript.exe). Alert immediately, as this behavior is highly anomalous.",
              "From DNS logs (Zeek dns.log), create a list of requested domains. Profile the frequency of all Top-Level Domains (TLDs) requested across the enterprise. Alert on requests for TLDs that are in the bottom 5th percentile of frequency, as adversaries often use obscure TLDs for C2.",
              "Use unsupervised clustering (e.g., K-Means) on network connection features (destination IP, port, data volume, protocol) originating from browser processes. Identify and investigate outliers and small clusters, as they may represent C2 activity or data exfiltration initiated via a malicious script in the browser."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.3",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]