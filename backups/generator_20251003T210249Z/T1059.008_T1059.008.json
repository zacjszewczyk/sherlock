[
  {
    "information_requirement": "Has an adversary gained execution on a network device by abusing its command-line interface (CLI)?",
    "tactic_id": "TA0002",
    "tactic_name": "Execution",
    "indicators": [
      {
        "technique_id": "T1059.008",
        "name": "Network Device CLI",
        "evidence": [
          {
            "description": "A network management session (SSH/Telnet) originates from an IP address present on a current threat intelligence feed, or a command executed within the session, captured via syslog, contains a string matching a known malicious signature.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek ssh.log",
              "Zeek telnet.log",
              "Zeek syslog.log",
              "Windows Event ID 4624",
              "Windows Event ID 4776"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Edge firewalls, core routers, distribution/access layer switches, VPN concentrators, RADIUS/TACACS+ servers",
            "action": [
              "Symbolic: Continuously correlate source IPs from Zeek conn.log (where `id.resp_p` is 22 or 23) against a threat intelligence feed of known malicious IPs using a SIEM rule. Generate a high-severity alert for any match.",
              "Statistical: From syslog data, parse commands executed on network devices. Establish a 30-day baseline of command 1-gram frequencies. Alert on any command execution containing a token (word) that falls below the 1st percentile of frequency, indicating a rare or novel command not seen in normal operations.",
              "Machine Learning: Scan command strings from syslog using a pre-trained NLP model (e.g., a BERT-based classifier fine-tuned on public exploit databases) to identify patterns indicative of obfuscation or exploitation. Alert on classifications with a confidence score greater than 0.9."
            ]
          },
          {
            "description": "A temporally-proximate sequence of commands is executed within a single administrative session that matches a known malicious TTP, such as disabling security logging followed by creating a new user account or modifying an access control list.",
            "data_sources": [
              "Zeek syslog.log",
              "Network device configuration backups"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Centralized syslog servers, TACACS+/RADIUS authentication servers, core network infrastructure",
            "action": [
              "Symbolic: Define and monitor for stateful sequences in syslog data, correlated by source IP and device hostname. Trigger a high-severity alert if a command to disable logging (e.g., `no logging console`) is followed by a command to create a privileged user (e.g., `username sec_admin privilege 15`) within a 10-minute window.",
              "Statistical: Model command sequences from a 90-day baseline of syslog data as Markov chains, where each command is a state. Calculate the transition probabilities between all observed command pairs. Flag any session containing a command transition with a probability below a set threshold (e.g., less than 0.005), indicating a rare and suspicious sequence of actions.",
              "Machine Learning: Train a Long Short-Term Memory (LSTM) autoencoder on sequences of commands from known-benign administrative sessions. Process new command sequences in real-time through the model and calculate the reconstruction error. Alert on any sequence with a reconstruction error exceeding the 99th percentile of baseline errors, indicating a significant deviation from normal administrative command patterns."
            ]
          },
          {
            "description": "A successful administrative login to a network device exhibits a combination of two or more anomalous properties, such as: originating from a geographically rare IP address, occurring outside the user's established working hours, or having a session duration significantly longer than the user's historical average.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek ssh.log",
              "Zeek telnet.log",
              "Windows Event ID 4624",
              "Windows Event ID 4776"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "VPN concentrators, jump boxes/bastion hosts, network management subnets, Domain Controllers, RADIUS/TACACS+ servers",
            "action": [
              "Symbolic: Create and maintain an allow-list of authorized administrative country codes and Autonomous System Numbers (ASNs). Alert on any successful SSH/Telnet connection to a network device (from Zeek conn.log) that originates from a country or ASN not on the allow-list.",
              "Statistical: For each admin user, establish a baseline profile from the last 90 days of activity (Zeek conn.log, Windows Event ID 4624) including: (1) typical login hours, (2) source ASNs, (3) source countries, (4) session duration mean and standard deviation. Assign risk points for deviations: +2 for rare country, +1 for rare ASN, +1 for off-hours login (e.g., 10pm-6am local time), +1 for session duration > 3 standard deviations from the mean. Alert when a session's cumulative score is 3 or greater.",
              "Machine Learning: On a daily basis, use a clustering algorithm (e.g., DBSCAN) on session feature vectors: `[user_id, source_ASN, hour_of_day, log(duration_seconds)]`. Identify large, stable clusters as normal behavior. Flag any session that is classified as a noise point (outlier) by the algorithm, as it does not fit any established pattern of activity for that user or the general population."
            ]
          },
          {
            "description": "A change is detected in a network device's running or startup configuration that is not associated with an approved change request ticket in the organization's change management system within a +/- 1-hour window of the change.",
            "data_sources": [
              "Zeek syslog.log",
              "Network device configuration backups",
              "CMDB/ITSM API"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Configuration backup repositories, change management system (e.g., ServiceNow, Jira), centralized syslog servers",
            "action": [
              "Symbolic: For every configuration change log event (e.g., Cisco `%SYS-5-CONFIG_I`, Juniper `UI_COMMIT_COMPLETED`) parsed from syslog, execute an automated query to the change management system's API. The query should search for an approved and open ticket for that device hostname within a 1-hour window of the event timestamp. Alert if no matching ticket is found.",
              "Statistical: Perform a daily `diff` between the current device configuration and the previous day's backup. Calculate the normalized Levenshtein distance (edit distance divided by the length of the larger config). Establish a per-device-type baseline for this metric. Alert if the normalized distance exceeds the 99th percentile for that device type, indicating an unusually large configuration modification.",
              "Machine Learning: Apply a time series decomposition model (e.g., Seasonal and Trend decomposition using Loess - STL) to the daily count of configuration change events per device. This separates the series into trend, seasonal, and residual components. Alert when the residual component for any given day exceeds 3 standard deviations from its mean, indicating an anomalous number of changes not explained by normal trends or seasonality."
            ]
          },
          {
            "description": "A network infrastructure device (e.g., router, switch, firewall) initiates an outbound network connection to a destination IP address and port that is not on a pre-defined allow-list of approved operational destinations (e.g., NTP, syslog, TACACS+, SNMP, software repositories).",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network device management VLANs, core and edge routers, internet gateways",
            "action": [
              "Symbolic: Maintain an explicit allow-list of `destination_ip:port` tuples for all network infrastructure VLANs (e.g., `10.1.1.100:514` for syslog). Filter Zeek conn.log for all traffic where `id.orig_h` is an IP within a network device management range. Generate a high-severity alert on any connection where the `id.resp_h:id.resp_p` combination is not on the allow-list.",
              "Statistical: For each network device, use Zeek conn.log to calculate the Shannon entropy of the set of unique destination ports it connects to over a 24-hour sliding window. Establish a 30-day historical baseline of entropy values. Alert if the current entropy value exceeds the 98th percentile of its historical baseline, indicating the device is connecting to an anomalously diverse set of ports.",
              "Machine Learning: Train a One-Class Support Vector Machine (OC-SVM) on feature vectors of (`protocol`, `destination_port`, `log(bytes_out)`) from a 30-day baseline of benign outbound connections from network devices. Use the trained model to classify new connections. Any connection classified as an anomaly indicates a deviation from the established profile of normal device-initiated traffic and should generate an alert."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.3",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]