[
  {
    "information_requirement": "Is an adversary discovering the physical location of our mobile devices? (PIR)",
    "tactic_id": "TA0032",
    "tactic_name": "Discovery",
    "indicators": [
      {
        "technique_id": "T1430",
        "name": "Location Tracking",
        "evidence": [
          {
            "description": "An application's manifest (Android) or Info.plist (iOS) file contains a high-risk location permission (e.g., ACCESS_BACKGROUND_LOCATION, NSLocationAlwaysAndWhenInUseUsageDescription) that is absent from an allow-list of permissions for that specific application version or is statistically anomalous for its app store category.",
            "data_sources": [
              "Mobile Device Management (MDM) application inventory logs",
              "AndroidManifest.xml",
              "Info.plist",
              "Threat intelligence feeds"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "MDM/UEM server, internal application repository, cloud-hosted application vetting sandboxes, threat intelligence platform.",
            "action": "For each application identified on managed devices: 1. (Symbolic) Correlate the application's package name and file hash against a threat intelligence feed of known malicious mobile applications. Trigger a high-severity alert for any match. 2. (Statistical) Parse the application's manifest/Info.plist file to extract all requested permissions. Group applications by their functional category (e.g., 'Productivity', 'Navigation'). For each category, calculate the 95th percentile for the total number of requested permissions. Flag for manual review any application that requests background location permissions AND exceeds this category-specific percentile. 3. (Machine Learning) Utilize a pre-trained binary classification model (e.g., Random Forest) on a labeled dataset of benign/malicious application manifests. Extract features including one-hot encoded permissions, counts of exported components (activities, services), and the presence of sensitive API calls. An application predicted as 'malicious' with high confidence (>0.90), especially if it requests location permissions, should trigger an automated quarantine action via MDM and a critical analyst alert."
          },
          {
            "description": "The hourly count of location service API calls from a single device, as logged by a Mobile Threat Defense (MTD) agent, exceeds 3 standard deviations above its 30-day rolling average. Alternatively, location data from the device is transmitted to a destination IP address not previously seen from that device within a 60-day lookback period.",
            "data_sources": [
              "Mobile Threat Defense (MTD) API call logs",
              "MDM location history logs",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate-managed mobile devices, network egress points (e.g., VPN concentrators, corporate Wi-Fi access points), DNS resolvers, cloud-hosted MTD/MDM platforms.",
            "action": "For each managed mobile device: 1. (Symbolic) From network traffic logs (Zeek conn.log), correlate destination IP addresses (id.resp_h) and DNS queries (query in dns.log) against threat intelligence feeds of known C2 infrastructure. Generate a high-severity alert for any match originating from a managed mobile device. 2. (Statistical) Calculate a 30-day rolling baseline (mean, standard deviation) of hourly location API calls using MTD logs. Trigger an alert if the current hourly count exceeds the mean by more than 3 standard deviations. Separately, maintain a stateful set of destination IP addresses seen in Zeek conn.log over the past 60 days. Trigger an alert if a connection is made to an IP not in this historical set, enriching the alert with GeoIP and ASN data for the new destination. 3. (Machine Learning) Apply a time-series anomaly detection model (e.g., Seasonal-Hybrid ESD) to the per-device, hourly location API call count time series to account for user-specific seasonality (e.g., daily commute). Trigger an alert for any point identified as an anomaly. Concurrently, apply a density-based clustering algorithm (e.g., DBSCAN) to the geo-coordinates of location reports to identify travel to anomalous locations outside the user's typical clusters of activity."
          }
        ]
      }
    ],
    "last_updated": "2025-09-29",
    "version": "1.3",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  },
  {
    "information_requirement": "Is an adversary collecting and exfiltrating location data from our mobile devices? (PIR)",
    "tactic_id": "TA0035",
    "tactic_name": "Collection",
    "indicators": [
      {
        "technique_id": "T1430",
        "name": "Location Tracking",
        "evidence": [
          {
            "description": "A network connection originates from a mobile application with known location permissions to a destination IP or domain on a C2 threat intelligence list. Alternatively, the connection's client TLS fingerprint (JA3 hash) is statistically rare, with a prevalence of less than 0.01% across all mobile device connections in the last 30 days.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log",
              "Zeek ssl.log",
              "Threat intelligence feeds",
              "MDM/MTD application network logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network egress points, firewalls, proxies, VPN concentrators, DNS resolvers, threat intelligence platforms, MDM/MTD cloud consoles.",
            "action": "For outbound mobile connections: 1. (Symbolic) Join network connection logs (Zeek conn.log) with application-specific network logs from MDM/MTD, correlating on device IP and timestamp. For any connection made by an application with location permissions, check if the destination IP (id.resp_h), DNS query (dns.log), or SNI (ssl.log) matches an indicator in a C2 threat intelligence feed. Trigger a critical alert upon a match. 2. (Statistical) From Zeek ssl.log, compute the frequency of every unique client TLS fingerprint (JA3 hash) observed from the mobile device IP range over the last 30 days. Trigger an alert when an application with location permissions initiates a connection using a JA3 hash seen in less than 0.01% of all mobile connections. 3. (Machine Learning) Develop a supervised learning model (e.g., XGBoost) to generate a risk score for each outbound mobile connection. Engineer features such as: destination IP/ASN reputation, destination port rarity, JA3 hash prevalence, DNS query entropy, connection byte count (orig_bytes), and a binary feature indicating if the source app has location permissions. A connection scoring above a defined threshold triggers an analyst investigation."
          },
          {
            "description": "The total daily data upload volume (sum of orig_bytes) from a single mobile device to external, non-whitelisted destinations exceeds the 99th percentile of its 30-day historical daily uploads. This data transfer anomaly occurs within a 5-minute window of an application with location permissions being the foreground application.",
            "data_sources": [
              "Zeek conn.log",
              "MDM/MTD application activity logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network egress points (e.g., VPN concentrators, corporate Wi-Fi gateways), corporate-managed mobile devices, MDM/MTD cloud consoles.",
            "action": "For each managed mobile device: 1. (Symbolic) Maintain an explicit allow-list of corporate and sanctioned cloud service domains/IPs. Trigger an alert when a single connection from a mobile device (in Zeek conn.log) uploads more than 100MB of data (orig_bytes) to a destination not on the allow-list. Automatically correlate the alert's timestamp with MDM logs to identify the foreground application and its permissions. 2. (Statistical) For each device, calculate a 30-day rolling baseline of total daily upload bytes to external IPs (sum of orig_bytes from Zeek conn.log). Trigger an alert when a device's daily upload volume exceeds the 99th percentile of its historical baseline. Enrich the alert with the top 5 destination ASNs for that day and the top 5 foreground applications from MDM logs. 3. (Machine Learning) For each device, implement a time-series forecasting model (e.g., Prophet) to predict daily upload volume, accounting for day-of-week effects. Trigger an alert when the actual volume significantly exceeds the model's predicted upper confidence bound. During an alert, apply a topic modeling algorithm (e.g., Latent Dirichlet Allocation) to the set of destination domains visited during the anomalous period to identify thematic clusters in the network activity."
          }
        ]
      }
    ],
    "last_updated": "2025-09-29",
    "version": "1.3",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]