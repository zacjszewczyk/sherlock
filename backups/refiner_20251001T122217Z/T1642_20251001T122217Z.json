[
  {
    "information_requirement": "Has an adversary performed an Endpoint Denial of Service attack against a mobile device? (TA0034 - Impact)",
    "tactic_id": "TA0034",
    "tactic_name": "Impact",
    "indicators": [
      {
        "technique_id": "T1642",
        "name": "Endpoint Denial of Service",
        "evidence": [
          {
            "description": "A connection is recorded in Zeek logs from a mobile device's IP address to a destination IP or domain that is present in a threat intelligence feed and explicitly tagged as C2 infrastructure for mobile malware known to possess Endpoint DoS capabilities (e.g., KeyRaider).",
            "data_sources": [
              "Zeek intel.log",
              "Zeek conn.log",
              "MDM Logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate and Guest Wi-Fi network gateways, VPN concentrators, DNS resolvers, Mobile Device Management (MDM) platform.",
            "action": "1. (Symbolic) Create a SIEM rule to trigger a high-severity alert when a Zeek intel.log entry shows `Intel::MATCH` for a `seen.where` of `Conn::IN_ORIG` or `DNS::IN_QUERY`. The rule should filter for source IPs within the mobile device DHCP range and where the `meta.source` tag includes 'mobile_malware' or 'T1642'. 2. (Statistical) For each mobile device, maintain a 30-day rolling baseline of unique destination Autonomous System Numbers (ASNs) from Zeek conn.log. Trigger an alert if a device communicates with an ASN not in its baseline, and that ASN has a poor reputation score. Rank the alert's severity based on the connection frequency, flagging any frequency that exceeds the 99th percentile for that device's peer group (e.g., all iOS 17 devices). 3. (Machine Learning) Use a trained Logistic Regression model to produce a risk score for each connection in Zeek conn.log. Model features should include: connection duration, protocol, service, byte counts, and enrichments like destination IP reputation, ASN, and geographic rarity. A score > 0.9 should automatically query the MDM via API to retrieve the device's owner, compliance status, and recent activity."
          },
          {
            "description": "A mobile device's IP address generates a series of DNS queries for domains with high Shannon entropy (>3.5) or domains registered within the last 72 hours, which is immediately followed by a cessation of all network traffic from that IP in Zeek conn.log for a duration that exceeds the 95th percentile of its typical offline periods.",
            "data_sources": [
              "Zeek dns.log",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internal DNS resolvers, network traffic monitoring points at internet gateways.",
            "action": "1. (Symbolic) Implement a detection rule that triggers if a DNS query in Zeek dns.log from a mobile IP is for a domain whose WHOIS registration date is less than 3 days old, and this query is immediately followed by a connection attempt in Zeek conn.log to the resolved IP. 2. (Statistical) In a streaming analytics platform, calculate the Shannon entropy for every `qname` in Zeek dns.log. For each source IP, maintain a count of high-entropy (>3.5) queries per minute. If the count exceeds 5, flag the IP. Then, check if the IP has sent any traffic in Zeek conn.log in the last hour. The combination of the high-entropy flag and a subsequent lack of traffic triggers a 'Potential DoS Precursor' alert. 3. (Machine Learning) Deploy a time-series anomaly detection model (e.g., ARIMA or LSTM) trained on per-minute connection counts and byte volumes for each mobile IP. An alert is generated when the model predicts activity but the actual observed traffic in Zeek conn.log drops to zero and stays there. The alert's priority is elevated if it was preceded within the last 30 minutes by high-entropy DNS queries from the same IP."
          },
          {
            "description": "A mobile device's IP address is observed in Zeek logs connecting to a domain/IP on a threat intelligence list of known rooting/jailbreaking sites, or the device's HTTP User-Agent string in Zeek http.log is statistically rare (<0.5% prevalence) compared to the population of managed mobile devices.",
            "data_sources": [
              "Zeek dns.log",
              "Zeek http.log",
              "Zeek intel.log",
              "MDM Logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate Wi-Fi access points, VPN concentrators, web proxies, Mobile Device Management (MDM) platform.",
            "action": "1. (Symbolic) Ingest a threat intelligence feed of domains/IPs associated with mobile device rooting and jailbreaking tools into the Zeek Intel Framework. Configure a rule to generate a critical alert upon a match in Zeek intel.log originating from an IP in the corporate mobile device range. 2. (Statistical) Periodically (e.g., hourly), aggregate all `user_agent` strings from Zeek http.log for the mobile device fleet. Calculate the frequency percentage for each unique string. Generate an alert for any device reporting a user agent string with a frequency below 0.5%, as this may indicate non-standard or malicious software. 3. (Machine Learning) Use an unsupervised clustering algorithm (e.g., DBSCAN) on 24-hour network profiles for each device. Features should be engineered from Zeek logs and include: count of unique destination ports, TCP/UDP ratio, average connection duration, and total data transfer volume. Devices classified as noise or belonging to very small clusters are considered anomalous. Automatically cross-reference these devices with MDM compliance data to confirm a jailbroken/rooted status."
          },
          {
            "description": "An event is logged by the Mobile Device Management (MDM) platform indicating that an application has been granted Device Administrator privileges on an Android device, or a new configuration profile has been installed on an iOS device, and the application or profile signer is not on a pre-defined enterprise allowlist.",
            "data_sources": [
              "MDM Logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Mobile Device Management (MDM) platform, Enterprise Mobility Management (EMM) server logs.",
            "action": "1. (Symbolic) Configure the MDM platform to forward logs to the SIEM. Create a rule that generates a critical alert for any 'Device Administrator Granted' event (Android) or 'Profile Installed' event (iOS) where the application name or profile identifier does not match an entry in an enterprise allowlist. 2. (Statistical) For each device, establish a 90-day baseline of the rate of new application installations and profile modifications from MDM logs. Trigger an alert if the daily rate for a device exceeds its own 99th percentile, which could indicate unauthorized or automated activity. 3. (Machine Learning) Develop a Decision Tree classification model to assign a risk score to every newly installed application reported by the MDM. Features should include: permissions requested (e.g., Device Administrator), application source (e.g., Google Play Store, Sideloaded), its prevalence across the device fleet, and age. An application receiving a high risk score triggers an automated workflow to query the device for more forensic data or restrict its network access."
          }
        ]
      }
    ],
    "version": "1.3",
    "date_created": "2025-09-26",
    "last_updated": "2025-09-29",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]