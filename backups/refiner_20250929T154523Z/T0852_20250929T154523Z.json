[
  {
    "information_requirement": "Is an adversary capturing screen data from Human-Machine Interfaces (HMIs) or Engineering Workstations (EWS)? (PIR)",
    "tactic_id": "TA0100",
    "tactic_name": "Collection",
    "indicators": [
      {
        "technique_id": "T0852",
        "name": "Screen Capture",
        "evidence": [
          {
            "description": "Execution of screen capture processes, including legitimate Windows utilities (e.g., psr.exe, SnippingTool.exe), or scripting interpreters (e.g., powershell.exe, cmd.exe) observed with command-line arguments indicative of screen capture activity (e.g., PowerShell commands invoking System.Windows.Forms, BitBlt API calls, or similar functions), particularly when initiated by an unapproved parent process, from an unusual directory, or by a user account not authorized for such activity on an HMI or EWS.",
            "data_sources": [
              "Windows Event ID 4688",
              "Sysmon Event ID 1"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Human-Machine Interfaces (HMIs), Engineering Workstations (EWS), Operator Stations, Jump Servers within ICS network.",
            "action": "1. Symbolic Logic (IOC/Whitelist): Monitor Windows Event ID 4688 (Process Creation) and Sysmon Event ID 1 on HMIs and EWS. Establish a baseline of legitimate processes, their expected parent-child relationships, authorized execution paths, and authorized user accounts for these critical assets. Generate an alert for the execution of any process not on this baseline. Specifically, prioritize alerts for: a. Execution of 'psr.exe' or 'SnippingTool.exe' by a non-whitelisted parent process or user. b. Execution of 'powershell.exe' or 'cmd.exe' containing known screen capture command-line arguments such as '-Command Add-Type -AssemblyName System.Windows.Forms', '-Command [System.Windows.Forms.SendKeys]::SendWait(\"{PRTSC}\")', or specific script content that performs screen capture (e.g., invoking `CopyFromScreen`, `BitBlt`). c. Execution of any unrecognized executable (not on the baseline) with names that mimic screen capture tools (e.g., 'screenshot.exe', 'capture.exe'). d. Any process creation event where the parent process or user account is not whitelisted for the specific HMI/EWS. 2. Statistical Method (Rarity/Frequency): For each unique process path observed on HMIs/EWS, calculate its daily execution count. Establish a 14-day rolling baseline for each process's average daily execution count and standard deviation. Alert when a process's daily execution count exceeds 3 standard deviations above its historical mean. Additionally, calculate the frequency of each unique process name across all HMIs/EWS; flag any process with an execution frequency below the 5th percentile for the asset group, indicating extreme rarity. 3. Machine Learning (Classification): Utilize a pre-trained supervised classification model (e.g., Random Forest or XGBoost), trained on historical legitimate process execution data (including process name, parent process, command-line arguments, user context, and execution path), to evaluate new process creation events. Review model-generated alerts for events classified as 'anomalous' or 'malicious' on ICS assets, focusing on events with a high confidence score (e.g., >0.8) that deviate from established operational baselines."
          },
          {
            "description": "Creation of image files (e.g., .png, .jpg, .bmp, .tiff, .gif) on an HMI or EWS, specifically when observed in common temporary directories (%TEMP%, %APPDATA%, C:\\Windows\\Temp), user download folders, or by processes not authorized for image generation (e.g., 'cmd.exe', 'powershell.exe', or unapproved executables) or when the file creation rate deviates significantly from established baselines.",
            "data_sources": [
              "Sysmon Event ID 11",
              "Sysmon Event ID 1"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "HMI/EWS local file systems, particularly temporary directories, user profile folders, and shared network drives accessible by HMIs.",
            "action": "1. Symbolic Logic (IOC/Whitelist): Monitor Sysmon Event ID 11 (File Creation) on HMI and EWS endpoints for files with extensions '.png', '.jpg', '.jpeg', '.bmp', '.tiff', '.gif'. Establish a whitelist of legitimate processes (e.g., HMI reporting tools, SCADA applications) and specific directories (e.g., designated report output folders, approved user document directories) authorized to create such files. Generate an alert when: a. An image file is created in a temporary directory (%TEMP%, %APPDATA%, C:\\Windows\\Temp, or other common non-standard locations). b. An image file is created by a process not on the established whitelist for image generation (e.g., 'cmd.exe', 'powershell.exe', or any unapproved executable). c. An authorized process creates an image file in a directory for which it is not whitelisted to write. 2. Statistical Method (Entropy/Volume): For each HMI/EWS, establish a 30-day rolling baseline for the average daily count of image file creations. Alert if the daily count exceeds 3 standard deviations above this historical mean. Additionally, calculate the Shannon entropy for filenames of newly created image files; flag filenames with an entropy score exceeding the 95th percentile, as high-entropy (random-looking) filenames can indicate automated tool output. 3. Machine Learning (Anomaly Detection): Deploy a time-series anomaly detection model (e.g., Isolation Forest or Prophet) to monitor the rate of image file creation events per HMI/EWS. Train the model on historical data to predict expected creation rates and review model-generated alerts when actual rates deviate significantly (e.g., a sudden, sustained spike or unusual frequency pattern) from predictions, considering factors like file size and creation time."
          },
          {
            "description": "Outbound network connections originating from HMIs or EWS that exhibit statistically anomalous data transfer volumes (e.g., 'orig_bytes' exceeding the 99th percentile of historical traffic for that host and destination port), connections to unapproved external IP addresses or domains, or communication over non-standard ports, indicating potential exfiltration of captured screen data.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek http.log",
              "Zeek ssl.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "ICS Network Segments, OT/IT Network Boundary, Purdue Model Level 2/3 systems, ICS DMZ, Internet Gateway.",
            "action": "1. Symbolic Logic (IOC/Whitelist): Analyze Zeek conn.log data for all outbound connections originating from HMI and EWS source IPs. Establish a whitelist of approved destination IP addresses, destination domains (resolved using Zeek dns.log), and destination ports for these critical assets, based on operational requirements. Generate an alert for: a. Any connection from an HMI/EWS to an unapproved external IP address or domain (IOC match). b. Any connection from an HMI/EWS to an unapproved internal IP address or domain outside of established OT communication patterns. c. Any connection utilizing a non-whitelisted destination port. Additionally, monitor Zeek http.log for HTTP POST requests originating from HMIs/EWS with a 'resp_body_len' or 'orig_bytes' value exceeding a defined threshold (e.g., 5MB or 10MB) to non-whitelisted destinations, which could indicate large file uploads. 2. Statistical Method (Percentile/Standard Deviation): For each HMI/EWS source IP, establish a rolling 7-day baseline for the 'orig_bytes' field across all outbound connections, calculating the mean, standard deviation, and 99th percentile. Trigger an alert for any new connection where the 'orig_bytes' value exceeds the 99th percentile of this baseline, or if the average 'orig_bytes' for a 15-minute window exceeds 3 standard deviations above the historical mean for that host. Enrich alerts with destination IP reputation data to prioritize connections to unknown or suspicious external addresses. 3. Machine Learning (Clustering/Behavioral Anomaly): Apply a clustering algorithm (e.g., K-means or DBSCAN) to group network connections from HMIs/EWS based on features such as 'orig_bytes', 'resp_bytes', destination port, protocol, and time of day. Review alerts for connections that fall into small, isolated clusters and significantly deviate from established normal communication patterns for each HMI/EWS (e.g., large outbound data transfers to a new external IP or domain), indicating possible exfiltration. Prioritize clusters with high 'orig_bytes' and low frequency."
          }
        ]
      }
    ],
    "last_updated": "2025-09-29",
    "version": "1.3",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]