[
  {
    "information_requirement": "Is an adversary attempting to destroy critical operational data or system files to inhibit response functions in the ICS environment? (PIR)",
    "tactic_id": "TA0107",
    "tactic_name": "Inhibit Response Function",
    "indicators": [
      {
        "technique_id": "T0809",
        "name": "Data Destruction",
        "evidence": [
          {
            "description": "Detection of process creation events (Windows Event ID 4688) on critical ICS assets where the CommandLine field contains specific data destruction utility keywords (e.g., 'sdelete', 'killdisk', 'cipher /w') or exhibits a CommandLine length or character entropy score exceeding 3 standard deviations from the 30-day rolling average for the specific `NewProcessName` or `ParentProcessName`.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Servers (PCS), Operator Workstations",
            "action": "1. Symbolic Logic (IOC Match): Configure SIEM rule to alert on Windows Event ID 4688 where `NewProcessName` or `CommandLine` contains case-insensitive matches for 'sdelete.exe', 'killdisk.exe', 'cipher.exe /w', 'format c:', or other known data destruction commands. Exclude specific whitelisted processes/users if legitimate use is identified. 2. Statistical Method: For each unique `NewProcessName` and `CommandLine` combination observed on an NAI, calculate a 30-day rolling average and standard deviation of its hourly execution frequency. Alert if the current hourly count of a `NewProcessName` or `CommandLine` exceeds its 99th percentile or 3 standard deviations from its rolling average. Additionally, alert if a `NewProcessName` or `CommandLine` that has not been observed in the last 30 days is executed. Calculate the Shannon entropy of the `CommandLine` string for each `NewProcessName`. Establish a 30-day rolling baseline for the average and standard deviation of `CommandLine` entropy for each `NewProcessName`. Alert if a `CommandLine`'s entropy deviates by more than 3 standard deviations from its baseline. 3. Machine Learning (Anomaly Detection): Deploy an unsupervised anomaly detection model (e.g., Isolation Forest, One-Class SVM) trained on a 90-day historical dataset of Windows Event ID 4688 logs from each NAI. Feature engineering should include `NewProcessName` (one-hot encoded), `ParentProcessName` (one-hot encoded), `CommandLine` string length, `CommandLine` character set entropy, `SubjectUserName`, and `LogonId`. Continuously feed new `Windows Event ID 4688` events into the trained model. Generate a high-priority alert for events classified as outliers with an anomaly score exceeding a dynamically adjusted threshold (e.g., top 0.1% of scores), indicating anomalous process execution on a critical ICS asset."
          },
          {
            "description": "Detection of more than 50 file deletion events (Windows Event ID 4663, `Accesses` field contains 'DELETE') from a single `SubjectUserName` or `ProcessName` within a 60-second window, specifically targeting folders or files associated with critical ICS configurations (e.g., `C:\\ProgramData\\Rockwell Automation`, `D:\\HistorianData`), project files (e.g., SCADA project files), or backup directories.",
            "data_sources": [
              "Windows Event ID 4663"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "ICS File Servers, Data Historians, ICS Backup Servers, Engineering Workstations (EWS) local storage, Process Control Servers (PCS)",
            "action": "1. Symbolic Logic (Rule-based): Configure Group Policy to enable 'Audit object access' for 'Delete' on critical ICS directories and files (e.g., `C:\\SCADA_Projects`, `D:\\HistorianArchives`, `E:\\ICS_Backups`). Create a SIEM rule to alert when `Windows Event ID 4663` with `Accesses` containing 'DELETE' is observed, and the count for a unique `SubjectUserName` or `ProcessName` exceeds 50 events within a 60-second sliding window, specifically where `ObjectName` matches a predefined list of critical ICS data paths. Exclude known legitimate backup/archiving processes. 2. Statistical Method: For each `SubjectUserName` and `ProcessName` on critical NAIs, calculate a 30-day rolling baseline of the average and standard deviation for `DELETE` event counts in 5-minute intervals. Alert if the current 5-minute `DELETE` event count for any user or process exceeds 3 standard deviations above its rolling average or is above the 99.5th percentile of its historical distribution. Additionally, calculate the average and standard deviation of `ObjectName` path depth and unique `ObjectName` count per 5-minute interval. Alert if these metrics deviate by more than 3 standard deviations from their baselines, indicating widespread deletion activity. 3. Machine Learning (Time Series Anomaly Detection): Deploy a time-series anomaly detection model (e.g., ARIMA, Prophet, or a deep learning seq2seq autoencoder) trained on 90-day historical 5-minute aggregated `DELETE` event counts for each `SubjectUserName` and `ProcessName` combination on critical NAIs. The model should learn normal deletion patterns and predict expected volumes. Generate a high-priority alert when the actual 5-minute `DELETE` count falls outside the 99.5th percentile prediction interval, indicating a statistically significant and anomalous surge in deletions."
          },
          {
            "description": "Detection of `Windows Event ID 4663` (`Accesses` field contains 'DELETE') where the `ObjectName` corresponds to a file with a specific, high-value ICS extension (e.g., `.ACD` for Rockwell Studio 5000, `.S7P` for Siemens TIA Portal, `.PCV` for GE Proficy iFIX, `.HMI`, `.SCADA`, `.PLC`, `.DBF_HIST`, `.BAK_PLC`, `.MDB`) on critical ICS Engineering Workstations, File Servers, Data Historians, or backup repositories.",
            "data_sources": [
              "Windows Event ID 4663"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Engineering Workstations (EWS), File servers hosting ICS project files and backups, Data Historians, Process Control Servers (PCS), ICS Backup Servers",
            "action": "1. Symbolic Logic (IOC Match): Configure a high-priority SIEM rule to alert on `Windows Event ID 4663` where `Accesses` contains 'DELETE' and the `ObjectName` field ends with any extension from a predefined list of critical ICS file types (e.g., `.ACD`, `.S7P`, `.PCV`, `.HMI`, `.SCADA`, `.PLC`, `.DBF_HIST`, `.BAK_PLC`, `.MDB`). Implement a strict whitelist for `SubjectUserName` and `ProcessName` combinations authorized to perform these deletions, and optionally restrict to specific time windows or source workstations. Any deviation generates an immediate alert. 2. Statistical Method: Establish a 90-day rolling baseline for `Windows Event ID 4663` deletions of critical ICS file types, recording `SubjectUserName`, `Source Workstation` (extracted from `IpAddress` or `WorkstationName`), and `Time of Day`. For each critical file type, calculate the frequency distribution of `SubjectUserName` and `Source Workstation`. Alert if a deletion of a critical ICS file type occurs by a `SubjectUserName` or from a `Source Workstation` that has not been observed performing such deletions in the past 90 days (0th percentile). Additionally, calculate the average and standard deviation of deletion times for each user/file type. Alert if a deletion occurs outside 3 standard deviations from the historical average time window for that user/file type, or outside of predefined scheduled maintenance windows. 3. Machine Learning (Classification): Develop a supervised classification model (e.g., Random Forest, XGBoost) trained on labeled historical `Windows Event ID 4663` data, distinguishing between legitimate and malicious deletions of critical ICS file types. Feature engineering should include: `SubjectUserName` (one-hot encoded), `ProcessName` (one-hot encoded), `ObjectName` extension (one-hot encoded), `Source Workstation` (extracted from `IpAddress` or `WorkstationName` and one-hot encoded), `TimeOfDay` (hour of day), `DayOfWeek`, `DeletionRateInLastMinute` for the user, `PathDepth` of `ObjectName`, and `IsCriticalICSPath` (boolean based on `ObjectName`). Continuously feed new `DELETE` events into the model. Generate a high-priority alert for events classified as 'malicious deletion' with a confidence score exceeding 0.9, and provide the top contributing features to the classification."
          },
          {
            "description": "Detection of `Zeek files.log` entries indicating file transfer from IT to OT/ICS networks where the file is identified as an executable (e.g., `mime_type` contains 'executable', `file_type` from `Zeek pe.log` is 'PE32'), and the file's content exhibits a Shannon entropy score exceeding 7.5 bits per byte, or PE header fields (`linker_time`, `num_sections`, `num_imports`) deviate by more than 3 standard deviations from established baselines for legitimate ICS executables, or the file's hash matches known malicious hashes from threat intelligence.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek files.log",
              "Zeek pe.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network boundary between IT and OT networks (e.g., ICS DMZ), Core ICS network segments, SCADA network segments, Process Control Network (PCN)",
            "action": "1. Symbolic Logic (IOC Match): Configure a SIEM rule to alert on `Zeek files.log` entries where `mime_type` contains 'application/x-dosexec', 'application/x-msdownload', or similar executable indicators, or if the `extracted_file` field correlates with `Zeek pe.log` and `file_type` is 'PE32'. Filter these alerts to focus on transfers where `resp_h` (destination IP) or `orig_h` (source IP) fall within defined OT/ICS network segments (e.g., 10.10.0.0/16, 192.168.100.0/24) and are not part of a whitelisted file transfer process (e.g., patching server, legitimate software deployment). Integrate `Zeek files.log` `sha256` hashes with external threat intelligence feeds (e.g., VirusTotal, CISA ICS Advisories) to generate high-priority alerts on known malicious executables, specifically data destruction tools. 2. Statistical Method: For all identified executable files in `Zeek files.log` transferred to OT/ICS networks, calculate the Shannon entropy of the `file_contents` (if available, otherwise use `size`). Establish a 60-day rolling baseline for the average and standard deviation of entropy values for legitimate ICS executables observed. Alert if a transferred executable's entropy value exceeds the 99th percentile or 3 standard deviations above this baseline (e.g., >7.5 bits/byte). Correlate with `Zeek pe.log` for PE header details (`num_sections`, `num_imports`, `linker_time`, `virtual_size`, `raw_data_size`). Establish 60-day rolling baselines for these PE header fields for legitimate ICS executables. Alert if any of these values for a new executable fall outside 3 standard deviations of their respective historical means or if a significantly low `linker_time` (e.g., less than 2000-01-01) is observed, indicating potential packing or obfuscation. 3. Machine Learning (Classification): Deploy a supervised binary classification model (e.g., Gradient Boosting, LightGBM) trained on a labeled dataset of legitimate ICS software deployments and known malicious file transfers (e.g., malware, unauthorized tools) to OT/ICS networks. Features should include: `Zeek files.log` fields (`size`, `mime_type` (one-hot), `is_orig`, `is_resp`, `md5`, `sha1`, `sha256`, Shannon entropy of content), and `Zeek pe.log` fields (`num_sections`, `num_imports`, `num_exports`, `linker_time`, `virtual_size`, `raw_data_size`, `entry_point`). Enrich with `Zeek conn.log` data for `orig_bytes`, `resp_bytes`, and `orig_h`/`resp_h` (IP reputation scores). Continuously feed new executable file transfer events from `Zeek files.log` and `Zeek pe.log` into the model. Generate a high-priority alert for any transfer classified as 'malicious' with a confidence score exceeding 0.9, providing feature importance for analyst investigation."
          }
        ]
      }
    ],
    "version": "1.3",
    "date_created": "2025-09-25",
    "last_updated": "2025-09-29",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]