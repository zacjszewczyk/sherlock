[
  {
    "information_requirement": "Is the adversary attempting to gain credential access using credential stuffing? (PIR)",
    "tactic_id": "TA0006",
    "tactic_name": "Credential Access",
    "indicators": [
      {
        "technique_id": "T1110.004",
        "name": "Credential Stuffing",
        "evidence": [
          {
            "description": "Multiple authentication attempts, regardless of success, originate from a source IP address or contain a User-Agent string that matches an entry on a high-confidence threat intelligence feed for credential stuffing campaigns.",
            "data_sources": [
              "Windows Event ID 4624",
              "Windows Event ID 4625",
              "Zeek conn.log",
              "Zeek http.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Externally-facing authentication services (e.g., VPN, OWA, M365), Internet Gateway/Firewall, Web Proxies",
            "action": [
              "Symbolic Logic: Continuously join authentication logs (Windows Event IDs 4624, 4625) and web logs (Zeek http.log) on source IP address and User-Agent string. Compare these fields against a threat intelligence feed of known malicious IPs and User-Agents associated with credential stuffing. Generate a high-severity alert for any direct match.",
              "Statistical Method: For each source IP, calculate the percentage of its login attempts that match an indicator from the threat intelligence feed. Establish a baseline for this percentage across all source IPs. Flag any IP whose match percentage exceeds the 99th percentile, indicating a high concentration of known-bad activity.",
              "Machine Learning: Train a classification model (e.g., Random Forest) using labeled historical data where features include source IP, User-Agent, ASN, and a binary flag indicating if the IP/UA is on a threat list. Use the model to predict the probability that a new login attempt is part of a malicious campaign. Alert on attempts with a probability score above a defined threshold (e.g., 0.9)."
            ]
          },
          {
            "description": "A single source IP address generates a statistically anomalous number of failed authentication events (Windows Event ID 4625) against a high number of distinct user accounts, and may exhibit a low success-to-failure ratio but with successful logins for multiple accounts.",
            "data_sources": [
              "Windows Event ID 4624",
              "Windows Event ID 4625",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Authentication Servers (RADIUS, LDAP), Cloud Identity Provider (e.g., Azure AD)",
            "action": [
              "Symbolic Logic: Create a rule that triggers when a single source IP generates more than 100 failed logins (Event ID 4625) to more than 20 unique user accounts within a 5-minute window. Increase severity if the same IP also has >1 successful logins (Event ID 4624) to different accounts in the same window with a success ratio <5%.",
              "Statistical Method: For each source IP, aggregate failed logins over a 5-minute window and calculate the count of unique target usernames. Generate an alert when any IP exceeds the 98th percentile for this metric. Additionally, calculate the Shannon entropy of the target usernames per source IP; a high entropy value indicates the IP is cycling through a diverse list of names, which is characteristic of stuffing.",
              "Machine Learning: Use a clustering algorithm (e.g., DBSCAN) on features such as (Total Attempts, Failure Count, Success Count, Unique User Count) per source IP over a 1-hour period. The algorithm will group IPs with similar behavior. Automatically flag clusters that are separate from the main 'normal user' cluster and are characterized by high attempt counts and low-but-multiple successes."
            ]
          },
          {
            "description": "A successful authentication (Windows Event ID 4624) for a user account occurs from a geographic location that is physically impossible to have traveled to since the user's last successful login.",
            "data_sources": [
              "Windows Event ID 4624",
              "Windows Event ID 4625",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "VPN Concentrators, Cloud Identity Provider (e.g., Azure AD), Internet Gateway/Firewall",
            "action": [
              "Symbolic Logic: For each successful login (Event ID 4624), retrieve the source IP and timestamp. Look up the previous successful login for the same user. Geocode both IPs. If the calculated travel velocity between the two points exceeds 600 mph, generate an impossible travel alert. Increase severity if the successful login was preceded by failures (Event ID 4625) for the same user.",
              "Statistical Method: For each user, maintain a historical baseline of login geolocations. For each new login, calculate the Mahalanobis distance from the new location to the centroid of the user's historical login locations. A distance score exceeding a percentile threshold (e.g., 98th percentile) indicates a geographically anomalous login.",
              "Machine Learning: Train a one-class SVM (Support Vector Machine) model for each user based on their historical login features (geolocation, time of day, ASN). This model learns a boundary around 'normal' login behavior for that user. Any new login that falls outside this boundary is flagged as an anomaly, detecting more subtle deviations than simple impossible travel logic."
            ]
          },
          {
            "description": "Web requests to authentication endpoints contain artifacts of automation, such as non-standard User-Agent strings, a lack of expected HTTP headers (e.g., Referer), or machine-like request timing.",
            "data_sources": [
              "Zeek http.log",
              "Zeek conn.log",
              "Windows Event ID 4625"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Web Servers hosting login pages, Web Application Firewalls (WAFs), Reverse Proxies",
            "action": [
              "Symbolic Logic: Scan Zeek http.log for requests to login pages. Flag requests that have a User-Agent matching an automation tool (e.g., 'curl', 'python-requests') OR are missing a 'Referer' header. Correlate with failed logins (Event ID 4625) from the same source IP within one minute.",
              "Statistical Method: Analyze the time between consecutive login attempts from a single source IP (inter-arrival time, or IAT). Flag source IPs where the standard deviation of IAT over 20+ requests is below a threshold (e.g., < 100ms), indicating robotic precision inconsistent with human behavior.",
              "Machine Learning: Use natural language processing (NLP) to analyze User-Agent strings. Train a model to distinguish between legitimate browser User-Agents and those generated by bots or scripts based on features like string length and token presence. Classify each login request's User-Agent as 'human' or 'bot' and alert on a high volume of 'bot' classifications from a single source."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]