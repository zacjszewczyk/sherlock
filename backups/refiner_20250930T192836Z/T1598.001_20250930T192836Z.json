[
  {
    "information_requirement": "Is the adversary performing reconnaissance using spearphishing services against the enterprise?",
    "tactic_id": "TA0043",
    "tactic_name": "Reconnaissance",
    "indicators": [
      {
        "technique_id": "T1598.001",
        "name": "Spearphishing Service",
        "evidence": [
          {
            "description": "An inbound email's sender IP (from Zeek conn.log), sender domain, or SMTP HELO string (from Zeek smtp.log) matches an entry on a high-confidence threat intelligence feed with a 'phishing' or 'reconnaissance' tag.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek smtp.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Email Gateway, Network Egress/Ingress Points",
            "action": [
              "Symbolic: Continuously query Zeek logs where `smtp.log.helo`, the domain part of `smtp.log.from`, or the associated `conn.log.id.orig_h` matches a list of known malicious indicators from an imported threat intelligence feed. Generate an alert for any match.",
              "Statistical: For each sender IP address, calculate the historical ratio of emails with threat intelligence hits versus clean emails. Alert on IPs where this ratio suddenly deviates by more than 3 standard deviations from its established baseline, suggesting a previously benign source has been compromised.",
              "Machine Learning: Employ a supervised classification model (e.g., Logistic Regression) trained on features from Zeek logs (HELO string length/entropy, sender TLD, IP ASN) and labeled CTI data to predict the probability that a new, unseen email is malicious. Alert on any email with a predicted probability score above a 0.85 confidence threshold."
            ]
          },
          {
            "description": "An inbound email's 'From' header display name matches a known internal executive or key employee, but the sender's actual email domain belongs to a public webmail provider (e.g., gmail.com, outlook.com, proton.me).",
            "data_sources": [
              "Zeek smtp.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Email Gateway, Corporate Directory Service",
            "action": [
              "Symbolic: Maintain a list of key personnel display names and a list of public webmail domains. Run a recurring query against Zeek `smtp.log` to find emails where the `from` field display name matches a key person, but the sender's domain is on the public webmail list. Flag for review.",
              "Statistical: Calculate the Jaro-Winkler or Levenshtein distance between all inbound sender display names and the list of key personnel. Flag emails with a high similarity score (e.g., >0.90) that also originate from a public webmail domain and have no prior email history with the organization.",
              "Machine Learning: Train a classification model to detect impersonation. Use features such as: display name similarity to internal directory, sender domain category (public vs. corporate), presence of urgency keywords in the subject, and historical communication frequency. The model should output a 'Business Email Compromise Risk Score' for each incoming email."
            ]
          },
          {
            "description": "The subject line of an inbound email contains a statistically significant combination of keywords associated with information gathering (e.g., 'urgent', 'request', 'chart', 'directory', 'confirm', 'details').",
            "data_sources": [
              "Zeek smtp.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Email Gateway",
            "action": [
              "Symbolic: Scan the `subject` field in Zeek `smtp.log` for a curated list of regular expressions matching reconnaissance themes (e.g., `/(urgent|confirm).*(request|details)/i`). Alert on any match, especially if sent from an external domain.",
              "Statistical: Calculate the Term Frequency-Inverse Document Frequency (TF-IDF) score for words in all inbound email subjects over a 30-day window to establish a baseline. Alert on emails containing low-frequency, high-impact words from a reconnaissance lexicon, particularly if multiple employees receive such emails in a short time frame.",
              "Machine Learning: Apply a pre-trained Natural Language Processing (NLP) topic modeling algorithm (e.g., Latent Dirichlet Allocation) to inbound email subjects. Identify and alert on clusters of emails that the model classifies into a 'Reconnaissance & Information Gathering' topic, as defined by its characteristic keywords."
            ]
          },
          {
            "description": "A new or rarely seen external domain sends a volume of emails to multiple internal recipients that exceeds a statistically defined baseline for new senders within a short time frame (e.g., 30 minutes).",
            "data_sources": [
              "Zeek smtp.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Email Gateway, DNS Servers",
            "action": [
              "Symbolic: For sending domains not seen in the last 90 days, generate an alert if they send emails to more than 20 unique internal recipients within one hour. Enrich the alert with WHOIS data to flag domains registered within the last 30 days.",
              "Statistical: Establish a baseline for 'new sender' behavior by calculating the 99th percentile of recipient count and email frequency for all domains in their first day of sending to the organization. Alert when any new sender exceeds this established percentile threshold.",
              "Machine Learning: Use a time-series anomaly detection model (e.g., ARIMA) on the total email volume per minute. If an anomaly is detected, apply a clustering algorithm (e.g., DBSCAN) to the emails within that time window, using features like sender domain, subject similarity, and recipient count to group and identify potential campaigns."
            ]
          },
          {
            "description": "Multiple distinct endpoints execute a browser process that subsequently resolves and connects to the same non-categorized or newly-registered domain within a 5-minute window.",
            "data_sources": [
              "Zeek http.log",
              "Zeek dns.log",
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Employee Workstations, DNS Resolvers, Network Egress/Ingress Points",
            "action": [
              "Symbolic: Correlate Windows Event ID 4688 (Process Creation) where `NewProcessName` is a browser with subsequent Zeek `dns.log` lookups from the same host. Alert if 10 or more distinct hosts query for the same domain that is not on an enterprise 'allow list' within a 5-minute window.",
              "Statistical: For each DNS query, check if the domain has been seen before. Track the count of unique hosts querying for 'first-seen' domains per minute. Alert when this count exceeds the 99th percentile of its historical baseline, indicating a coordinated click event.",
              "Machine Learning: Use a graph-based analysis where nodes are users, processes, and domains. Create edges for 'user launched process' and 'process connected to domain'. Apply a community detection algorithm to find dense subgraphs representing multiple users connecting to a single, uncommon domain, which signifies a coordinated campaign."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]