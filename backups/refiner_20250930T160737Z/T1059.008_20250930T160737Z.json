[
  {
    "information_requirement": "Has an adversary gained execution on a network device by abusing its command-line interface (CLI)?",
    "tactic_id": "TA0002",
    "tactic_name": "Execution",
    "indicators": [
      {
        "technique_id": "T1059.008",
        "name": "Network Device CLI",
        "evidence": [
          {
            "description": "A network management session (e.g., SSH, Telnet) originates from an IP address on a threat intelligence feed, or a command executed within a session contains a string matching a known malicious signature.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek ssh.log",
              "Zeek telnet.log",
              "Zeek syslog.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Edge firewalls, core routers, distribution/access layer switches, VPN concentrators",
            "action": [
              "Symbolic: Continuously correlate source IPs in Zeek conn.log (where `id.resp_p` is 22 or 23) against a threat intelligence feed of known malicious IPs. Generate an alert for any match.",
              "Statistical: Analyze commands logged via syslog. Calculate the Term Frequency-Inverse Document Frequency (TF-IDF) score for each command token across all devices over a 30-day period. Flag commands containing tokens with anomalously high TF-IDF scores (e.g., top 1%), as these may represent rare or suspicious commands not seen in normal operations.",
              "Machine Learning: Use a pre-trained regular expression classifier (e.g., a model trained on public exploit-db entries) to scan command strings from syslog data for patterns indicative of command injection or exploitation attempts. Alert on high-confidence classifications."
            ]
          },
          {
            "description": "A sequence of two or more commands is executed within a single session that matches a known malicious pattern, such as disabling security logging followed by creating a new administrative account.",
            "data_sources": [
              "Zeek syslog.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Centralized syslog servers, TACACS+/RADIUS authentication servers, core network infrastructure",
            "action": [
              "Symbolic: Define and monitor for stateful sequences in syslog data, grouped by session (e.g., source IP and device name). Trigger an alert if a command to disable logging (e.g., `no logging <target>`) is followed by a command to create a privileged user (e.g., `username <new_user> privilege 15`) within a 5-minute window.",
              "Statistical: Model command sequences as n-grams (e.g., bi-grams, tri-grams) from a 30-day baseline of syslog data. Calculate the probability of each observed n-gram. Flag any session containing n-grams with a probability below a set threshold (e.g., less than 0.01%), indicating a rare sequence of actions.",
              "Machine Learning: Train a Long Short-Term Memory (LSTM) autoencoder on sequences of benign administrative commands. Process new command sequences through the model and alert on any sequence with a reconstruction error exceeding a dynamically calculated threshold (e.g., 99th percentile of baseline errors), indicating a deviation from normal command patterns."
            ]
          },
          {
            "description": "An administrative session on a network device exhibits multiple anomalous properties simultaneously, such as a source IP from a new country, occurring outside the user's baselined active hours, or a session duration greater than 3 standard deviations from the user's average.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek ssh.log",
              "Zeek telnet.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "VPN concentrators, jump boxes/bastion hosts, network management subnets, authentication servers",
            "action": [
              "Symbolic: Create an allow-list of authorized administrative subnets and user accounts. Alert on any successful SSH/Telnet connection (from Zeek conn.log) to a network device that originates from an IP not on the allow-list or uses an unauthorized account.",
              "Statistical: For each user, establish a baseline of normal activity including: (1) typical login hours, (2) source geolocation (country/ASN), and (3) session duration (mean and standard deviation from Zeek conn.log). Use a scoring system where deviations (e.g., login at 2 AM, new ASN, duration > 3 std dev) increment a risk score. Alert when a session's cumulative score exceeds a predefined threshold.",
              "Machine Learning: Use a clustering algorithm (e.g., DBSCAN) on session metadata vectors (source_ASN, hour_of_day, log10(duration), log10(bytes_transferred)). Identify clusters of normal behavior and flag any session that is classified as a noise point by the algorithm, indicating it does not fit any established pattern of activity."
            ]
          },
          {
            "description": "A change is detected in a network device's running or startup configuration that does not correlate with an approved change request ticket within a 1-hour window.",
            "data_sources": [
              "Zeek syslog.log",
              "Network device configuration backups",
              "Configuration Management Database (CMDB) data"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Configuration backup repositories, change management system (e.g., ServiceNow, Jira), centralized syslog servers",
            "action": [
              "Symbolic: For every configuration change log (e.g., Cisco's `%SYS-5-CONFIG_I`) from syslog, query the CMDB/ticketing system API for an approved change request associated with the device and user within the last hour. Alert if no matching, approved ticket is found.",
              "Statistical: Perform a text-based diff between the current device configuration and the last known-good baseline. Calculate the Levenshtein distance or a similar text similarity score. Alert if the distance exceeds a threshold (e.g., > 50 characters changed for a minor version), indicating a significant modification that warrants review.",
              "Machine Learning: Apply time series analysis to the frequency of configuration change events per device. Use a model like SARIMA to forecast the expected number of changes for a given time period. Alert when the observed number of changes significantly exceeds the forecasted upper confidence bound, indicating an anomalous burst of configuration activity."
            ]
          },
          {
            "description": "A network infrastructure device (e.g., router, switch) initiates an outbound connection to a destination IP and port that is not on its pre-approved list of management and operations destinations (e.g., NTP, syslog, TACACS+).",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network device management VLANs, core and edge routers, internet gateways",
            "action": [
              "Symbolic: Maintain an explicit allow-list of destination IP/port combinations for all network devices (e.g., `<syslog_server>:514`, `<ntp_server>:123`). Filter Zeek conn.log for all traffic where `id.orig_h` is a network device IP. Alert on any connection where the destination (`id.resp_h`, `id.resp_p`) is not on the allow-list.",
              "Statistical: For each network device, calculate the Shannon entropy of the set of unique destination ports it connects to over a 24-hour sliding window. A sudden spike in entropy indicates the device is connecting to a wider variety of ports than usual. Alert if entropy exceeds the 98th percentile of its historical values.",
              "Machine Learning: Train a One-Class Support Vector Machine (OC-SVM) on tuples of (`protocol`, `destination_port`, `bytes_out`) from benign outbound connections from network devices. Use the trained model to classify new connections. Any connection classified as an anomaly/outlier indicates a deviation from the established profile of normal network traffic."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]