[
  {
    "information_requirement": "Is the adversary attempting to capture credentials by spoofing legitimate GUI prompts?",
    "tactic_id": "TA0006",
    "tactic_name": "Credential Access",
    "indicators": [
      {
        "technique_id": "T1056.002",
        "name": "GUI Input Capture",
        "evidence": [
          {
            "description": "A process is created whose file hash (SHA256, MD5) matches a known hash for a tool capable of GUI-based credential capture (e.g., a PowerSploit module).",
            "data_sources": [
              "Windows Event ID 4688",
              "Sysmon Event ID 1"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, Remote Desktop servers, Citrix servers",
            "action": [
              "Symbolic: Continuously monitor process creation events (Windows Event ID 4688, Sysmon Event ID 1) and compare the file hash of each new process against a threat intelligence feed of known malicious hashes associated with GUI-based credential theft tools. Generate a high-severity alert upon any match.",
              "Statistical: For processes not matching known hashes, analyze process metadata. Calculate the prevalence of each process hash across the enterprise. Flag processes whose hash appears on fewer than a threshold number of endpoints (e.g., < 5) and is spawned by a common user application (e.g., OUTLOOK.EXE, WINWORD.EXE) as statistically rare and potentially suspicious.",
              "Machine Learning: Develop a supervised classification model (e.g., Random Forest) trained on features from process creation events (parent process, command-line length, entropy, file path, user context). Use the model to predict the probability of a process being a credential phisher. Alert on processes classified with high confidence (>0.9) as malicious."
            ]
          },
          {
            "description": "A scripting interpreter (e.g., powershell.exe, cscript.exe) is executed with command-line arguments containing strings indicative of GUI form creation, such as 'System.Windows.Forms', 'Add-Type', 'Show-Dialog', or 'Out-GridView -PassThru'.",
            "data_sources": [
              "Windows Event ID 4688",
              "Sysmon Event ID 1"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, Domain Controllers, Application servers",
            "action": [
              "Symbolic: Create a detection rule that scans command-line arguments from process creation events (Windows Event ID 4688, Sysmon Event ID 1) for case-insensitive regular expression matches on keywords like 'System.Windows.Forms', 'Add-Type', 'Show-Dialog', or 'Out-GridView -PassThru'. Alert when these keywords appear in scripts launched by non-standard parent processes.",
              "Statistical: For all scripting interpreter executions, calculate the character entropy and length of the command line. Establish a baseline distribution for these metrics. Flag executions where the entropy or length exceeds a high percentile (e.g., 95th percentile) of the established baseline, as this indicates potential obfuscation or embedded scripts.",
              "Machine Learning: Use a Natural Language Processing (NLP) model to classify the intent of script command lines. Train the model on a labeled dataset of benign and malicious scripts (including GUI-spoofing examples). Deploy the model to score all new script executions in real-time and alert on those classified as having a high probability of malicious intent."
            ]
          },
          {
            "description": "A parent-child process relationship is observed where a non-interactive or document-centric application (e.g., WINWORD.EXE, OUTLOOK.EXE, AcroRd32.exe) spawns a scripting interpreter (e.g., powershell.exe, cmd.exe, wscript.exe), which is anomalous compared to a historical baseline.",
            "data_sources": [
              "Windows Event ID 4688",
              "Sysmon Event ID 1"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, File servers hosting Office documents, Mail servers",
            "action": [
              "Symbolic: Define a list of disallowed parent-child process relationships (e.g., parent: WINWORD.EXE, child: powershell.exe). Create a rule that generates an alert whenever one of these specific relationships is observed via process creation logs (Windows Event ID 4688, Sysmon Event ID 1).",
              "Statistical: Build a frequency table of all parent-child process pairs observed over a 30-day period. Calculate the rarity of each pair. Trigger an alert for any new pair that has never been seen before or whose frequency is in the bottom 1% of all observed pairs, particularly when the child is a scripting interpreter.",
              "Machine Learning: Use an unsupervised learning model, such as an isolation forest, trained on a graph representation of parent-child process relationships. The model learns the normal process execution patterns. Flag any new process creation event that results in a high anomaly score, indicating it deviates significantly from learned normal behavior."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  },
  {
    "information_requirement": "Is the adversary exfiltrating credentials collected via a spoofed GUI prompt?",
    "tactic_id": "TA0009",
    "tactic_name": "Collection",
    "indicators": [
      {
        "technique_id": "T1056.002",
        "name": "GUI Input Capture",
        "evidence": [
          {
            "description": "An outbound network connection is initiated from a host to a destination IP, domain, or URI matching a known command-and-control (C2) or data exfiltration endpoint, within a short time window (e.g., < 5 minutes) following a suspected GUI credential capture event.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek http.log",
              "Zeek dns.log",
              "Windows Event ID 4688",
              "Sysmon Event ID 1"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network egress points (firewalls, proxies), DNS servers, Endpoints",
            "action": [
              "Symbolic: Correlate alerts from the Credential Access PIR (e.g., suspicious process creation) with network logs (Zeek conn.log, dns.log). If the source host of the suspicious process makes an outbound connection within 5 minutes to a destination IP or domain on a threat intelligence blocklist, escalate to a high-severity incident.",
              "Statistical: Analyze destination domains in DNS logs (Zeek dns.log). Calculate the age and reputation score of requested domains. Flag connections to domains that are statistically rare across the enterprise, newly registered (e.g., < 30 days old), and have a low reputation score, especially when originating from a host with a recent suspicious process alert.",
              "Machine Learning: Use a Domain Generation Algorithm (DGA) detection model to classify requested domains in real-time. The model, trained on features like domain length, character entropy, and n-gram frequencies, can identify algorithmically generated domains used for C2. Alert when a host, shortly after a suspicious GUI process event, attempts to resolve a domain classified as likely DGA-generated."
            ]
          },
          {
            "description": "An outbound HTTP/S POST request contains data in its body that matches patterns for common credential field names (e.g., 'username=', 'password=') and originates from a process not typically associated with authentication (e.g., powershell.exe, rundll32.exe).",
            "data_sources": [
              "Zeek http.log",
              "Zeek ssl.log",
              "Windows Event ID 4688",
              "Sysmon Event ID 1"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Web proxies, Network TAPs at egress points, Endpoints",
            "action": [
              "Symbolic: Scan the 'request_body' field in HTTP logs (Zeek http.log) for regular expressions matching key-value pairs of credential data (e.g., /(user|pass|login|cred)(name|word)?=/i). Correlate the source IP/timestamp with process logs to identify the originating process. Alert if the process is not a whitelisted browser or known application.",
              "Statistical: For all HTTP POST requests, calculate the size of the request body. Establish a baseline of POST request sizes for each process on each host. Flag requests from non-browser processes where the request body size is small (e.g., < 1 KB), as this is characteristic of credential exfiltration, and the size is a statistical outlier for that process.",
              "Machine Learning: Train a classifier to distinguish between legitimate and malicious HTTP POST requests. Use features such as the originating process name, destination server name indicator (from Zeek ssl.log), and URI path structure. Alert on POST requests that are classified as malicious with high confidence, particularly when the source process is a scripting interpreter."
            ]
          },
          {
            "description": "A small volume of data is exfiltrated from a host using a covert or non-standard protocol, such as DNS queries with large subdomains or ICMP packets with data payloads, within minutes of a suspected GUI credential capture event.",
            "data_sources": [
              "Zeek dns.log",
              "Zeek conn.log",
              "Zeek icmp.log",
              "Windows Event ID 4688",
              "Sysmon Event ID 1"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "DNS resolvers, Network egress points, Endpoints",
            "action": [
              "Symbolic: Monitor DNS logs (Zeek dns.log) for queries where the query length exceeds a fixed threshold (e.g., 100 characters) or contains non-standard characters (e.g., not A-Z, 0-9, -). Correlate the source host with recent suspicious process alerts and flag as potential DNS tunneling.",
              "Statistical: For each host, calculate a baseline for the average number and size of DNS queries per hour. Using time series analysis, flag any host that exhibits a sudden spike in the number of unique subdomains requested from a single parent domain or a significant increase in average query length (e.g., > 3 standard deviations from the mean).",
              "Machine Learning: Develop an anomaly detection model for DNS traffic features per host, including query/response sizes, query entropy, and query type distribution (A, AAAA, TXT). The model learns the normal DNS behavior for each host. Alert when a host's DNS traffic generates a high anomaly score, indicating a deviation like that seen in DNS-based data exfiltration."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]