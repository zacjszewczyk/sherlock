[
  {
    "information_requirement": "Is the adversary exfiltrating data over an unauthorized Bluetooth channel?",
    "tactic_id": "TA0010",
    "tactic_name": "Exfiltration",
    "indicators": [
      {
        "technique_id": "T1011.001",
        "name": "Exfiltration Over Bluetooth",
        "evidence": [
          {
            "description": "Execution of a known malicious tool or script, identified by its file hash or name, that is capable of Bluetooth data transfer.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User Workstations and Laptops",
            "action": [
              "Symbolic: Continuously monitor process creation events (Windows Event ID 4688) with command-line logging enabled. Cross-reference the file hash of newly executed processes against a threat intelligence feed of known Bluetooth-capable malware. Alert on any confirmed matches.",
              "Statistical: Establish a baseline of all processes executed on endpoints. Calculate the prevalence (percentage of hosts a process runs on) for each process hash. Flag any process with a prevalence below a 1% threshold that also interacts with Bluetooth APIs or drivers for investigation.",
              "Machine Learning: Use a supervised classification model (e.g., Random Forest) trained on process metadata (PE header info, entropy, string imports, parent process) to predict if a newly observed process is malicious. Prioritize alerts for predicted-malicious processes that are observed in conjunction with Bluetooth device activity."
            ]
          },
          {
            "description": "Use of legitimate system utilities, such as fsquirt.exe or PowerShell, with command-line arguments indicating non-interactive or scripted file transfer over Bluetooth.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User Workstations and Laptops",
            "action": [
              "Symbolic: Monitor process creation events (Windows Event ID 4688) for the execution of `fsquirt.exe` or `powershell.exe`. Create a rule to alert on `fsquirt.exe` executions with the `-send` flag, or PowerShell executions containing Bluetooth-related cmdlets (e.g., `Send-BluetoothFile`), especially when the parent process is non-interactive (e.g., `svchost.exe`, `wscript.exe`).",
              "Statistical: For each user, baseline the frequency and command-line argument patterns of `fsquirt.exe` and PowerShell execution. Calculate the entropy of the command-line arguments. Alert when a user's execution of these utilities deviates more than 3 standard deviations from their historical norm, or when command-line entropy is unusually high.",
              "Machine Learning: Apply time series analysis to the frequency of `fsquirt.exe` or PowerShell Bluetooth-related commands per host. Use an anomaly detection model (e.g., ARIMA) to flag sudden, unexplained spikes in activity that do not correlate with known software updates or administrative tasks."
            ]
          },
          {
            "description": "Anomalous creation of large archives or encrypted files in temporary or user profile directories, exceeding a baseline size or frequency, indicating data staging.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 4663"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "File Servers and User Workstations",
            "action": [
              "Symbolic: Monitor process creation events (Windows Event ID 4688) for the execution of common archiving tools (e.g., `7z.exe`, `rar.exe`, `tar.exe`). Alert if these processes are executed by a system account or from a non-standard directory (e.g., not Program Files).",
              "Statistical: Using Windows Event ID 4663 (Object Access), monitor the creation of files with extensions like `.zip`, `.rar`, `.7z`. For each host, establish a baseline of the average size and count of archive files created per hour. Alert when the count or total size of created archives in a 10-minute window exceeds the 99th percentile of the host's historical baseline.",
              "Machine Learning: Use a clustering algorithm (e.g., DBSCAN) on file creation events, using features such as file extension, creation directory, file size, and parent process. Identify clusters of anomalous file creation activity that represent potential data staging, distinct from normal user or software behavior."
            ]
          },
          {
            "description": "Activation of a Bluetooth service or connection of a new Bluetooth adapter on a host where it is normally disabled by policy or historically unused.",
            "data_sources": [
              "Windows Event ID 7036",
              "Microsoft-Windows-Kernel-PnP/Configuration Event ID 400",
              "Microsoft-Windows-Kernel-PnP/Configuration Event ID 410"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Servers in Datacenters and Critical Workstations",
            "action": [
              "Symbolic: Create an alert rule that triggers on Windows Event ID 7036 for the 'bthserv' (Bluetooth Support Service) entering the 'running' state on any host designated as a server or a device where Bluetooth is prohibited by policy.",
              "Statistical: For all endpoints, track the daily frequency of Kernel-PnP Event IDs 400 and 410 related to Bluetooth devices. Maintain a list of hosts that have a zero-count baseline over the last 90 days. Any new Bluetooth device connection event on these hosts should be flagged as a high-priority anomaly.",
              "Machine Learning: Develop a host-level state change model. Use a time series forecasting model to predict the state of Bluetooth services for each host. An unpredicted state change from 'stopped' to 'running' would be flagged as an anomaly, with the model's confidence score indicating the severity of the deviation."
            ]
          },
          {
            "description": "A sequence of events where data aggregation (e.g., large archive creation) is followed within a 15-minute window by Bluetooth activity (e.g., service start, file transfer process execution) on the same host.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 7036",
              "Windows Event ID 4663"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Executive Laptops and User Workstations",
            "action": [
              "Symbolic: Create a SIEM correlation rule that triggers when a 'Data Staging' event (e.g., `rar.exe` execution) is followed by a 'Bluetooth Activity' event (e.g., `fsquirt.exe` execution) on the same host within a 15-minute window. This sequence constitutes a high-confidence alert.",
              "Statistical: Develop a risk scoring model for hosts. Increment a host's risk score when events related to this technique occur (e.g., +10 for archive creation, +50 for Bluetooth service start on a server). Use a moving average of the risk score over a 1-hour window. Alert when a host's risk score exceeds a statistically determined threshold (e.g., 95th percentile of all host scores).",
              "Machine Learning: Use a sequence analysis model (e.g., Hidden Markov Model) trained on event logs. Define a 'Bluetooth Exfiltration' state sequence (e.g., 'archive tool execution' -> 'Bluetooth service start' -> 'fsquirt.exe execution'). The model calculates the probability of observing this sequence, and a high probability score triggers an alert."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]