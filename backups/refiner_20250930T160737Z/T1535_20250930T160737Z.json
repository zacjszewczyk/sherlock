[
  {
    "information_requirement": "Is the adversary evading defenses by operating in unused or unsupported cloud regions? (PIR)",
    "tactic_id": "TA0005",
    "tactic_name": "Defense Evasion",
    "indicators": [
      {
        "technique_id": "T1535",
        "name": "Unused-Unsupported Cloud Regions",
        "evidence": [
          {
            "description": "An API call (e.g., AWS `RunInstances`) is initiated from an IP address present on a threat intelligence feed, or an API call creates a resource (e.g., an EC2 instance) using a public image ID (AMI) known to be malicious.",
            "data_sources": [
              "AWS CloudTrail logs",
              "Azure Activity Logs",
              "GCP Audit Logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Cloud Provider Management Console/API Endpoints, Threat Intelligence Platform",
            "action": [
              "Symbolic: Continuously correlate the `sourceIPAddress` field from cloud audit logs against a high-confidence threat intelligence feed of malicious IPs. Alert on any match originating from a non-standard or unapproved region.",
              "Statistical: For each `sourceIPAddress`, calculate the historical frequency of its usage across all API calls within the last 90 days. An IP address with a frequency below the 5th percentile that successfully authenticates and performs a high-privilege action (e.g., `RunInstances`) in an unapproved region should be flagged for review.",
              "Machine Learning: Train a classification model (e.g., Random Forest) using features such as `sourceIPAddress` reputation, ASN, geolocation, time of day, and the type of API call. Use the model to predict the probability of a given API call being malicious and alert on high-probability events, especially those in unapproved regions."
            ]
          },
          {
            "description": "A sequence of API calls associated with new user or resource setup (e.g., `CreateUser`, `CreateAccessKey`, `RunInstances`) occurs in an unapproved region within a time window of less than 15 minutes, executed by a single user identity.",
            "data_sources": [
              "AWS CloudTrail logs",
              "Azure Activity Logs",
              "GCP Audit Logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Cloud Provider Management Console/API Endpoints, IAM Service Endpoints",
            "action": [
              "Symbolic: Create a rule in a SIEM to detect the specific event sequence: `CreateUser` -> `CreateAccessKey` -> `RunInstances`, all from the same `userIdentity.arn` and `awsRegion` within a 15-minute window. Trigger an alert if the `awsRegion` is not on the organization's approved list.",
              "Statistical: For each user, calculate the entropy of API call types made within a 1-hour rolling window in each region. A sudden, significant increase in entropy in an unused region, especially if it includes high-risk API calls (`*User`, `*Policy`, `*Instance`), indicates reconnaissance or setup activity and should be alerted on.",
              "Machine Learning: Use a sequence analysis model (e.g., Hidden Markov Model or an LSTM-based autoencoder) trained on legitimate sequences of API calls from developers and administrators. Flag any sequence of calls in an unapproved region that has a low probability of being generated by the learned legitimate behavior patterns."
            ]
          },
          {
            "description": "A resource creation API call (e.g., AWS `RunInstances`, Azure `Microsoft.Compute/virtualMachines/write`) is logged with a `region` or `location` parameter that is not on the organization's explicit allow-list of approved regions.",
            "data_sources": [
              "AWS CloudTrail logs",
              "Azure Activity Logs",
              "GCP Audit Logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Organization's list of approved/disapproved cloud regions, Cloud Provider Management Console/API Endpoints",
            "action": [
              "Symbolic: Maintain an explicit allow-list of approved cloud regions. Ingest all cloud audit logs and create a high-severity alert for any resource creation event (e.g., `RunInstances`, `CreateBucket`, `CreateDBInstance`) where the event's region field is not on the allow-list.",
              "Statistical: Periodically query all cloud regions for active resources. For each region, calculate the count of active resources. If the count for a historically unused region (mean count over 90 days is zero) becomes greater than zero, trigger an alert.",
              "Machine Learning: Apply time series forecasting (e.g., ARIMA or Prophet) to the number of active resources per region. An alert is triggered if the actual resource count in a non-primary region exceeds the forecasted upper confidence interval, indicating an anomalous and unexpected increase in activity."
            ]
          },
          {
            "description": "An API call in an unapproved region modifies a security control (e.g., `StopLogging`, `UpdateSecurityGroup` to allow 0.0.0.0/0) or creates a resource type (e.g., a high-CPU compute instance) that has a historical usage frequency of less than 1% in approved regions.",
            "data_sources": [
              "AWS CloudTrail logs",
              "Azure Activity Logs",
              "GCP Audit Logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Cloud Security Configuration Management Database, Cloud Provider Management Console/API Endpoints",
            "action": [
              "Symbolic: Create a detection rule that triggers on specific API calls that degrade security posture (e.g., `StopLogging`, `DeleteTrail`, `PutGroupPolicy`, `UpdateSecurityGroup` with inbound CIDR 0.0.0.0/0) when the event occurs in an unapproved region.",
              "Statistical: Establish a baseline of normal resource instance types (e.g., t2.micro, m5.large) used in approved regions. For any resource created in an unapproved region, compare its type to the baseline. If the instance type has a frequency of less than 1% in the baseline, flag it as anomalous. Calculate the daily rate of security-modifying API calls per region; an increase of over 3 standard deviations from the mean in an unapproved region should trigger an alert.",
              "Machine Learning: Use an anomaly detection algorithm (e.g., Isolation Forest) on API call events from unapproved regions. Features should include the user identity, source IP, API call name, and resource parameters. The model will score events, and those with a high anomaly score will be flagged for investigation."
            ]
          },
          {
            "description": "The total volume of network egress traffic from a resource in an unapproved region exceeds the 95th percentile of daily egress volume for similar resources in approved regions, or the destination IP of an outbound connection matches a known C2 or cryptomining pool address.",
            "data_sources": [
              "AWS VPC Flow Logs",
              "Azure NSG Flow Logs",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Virtual Private Cloud (VPC) Egress/Ingress points, Cloud Network Flow Log Aggregation Point, DNS Resolvers",
            "action": [
              "Symbolic: Ingest network flow logs (e.g., VPC Flow Logs, Zeek `conn.log`) from all cloud regions. Correlate all destination IP addresses against a threat intelligence feed of known C2 servers and cryptomining pools. Alert on any match originating from an unapproved region.",
              "Statistical: For resources in unapproved regions, analyze `Zeek conn.log` to establish a baseline for outbound connection duration and bytes sent (`orig_bytes`). Alert if any new connection's metrics exceed 3 standard deviations from the established baseline, or if the total daily egress volume exceeds the 95th percentile of egress from all other regions combined.",
              "Machine Learning: Apply time series analysis (e.g., Seasonal-ARIMA) to the total egress data volume per hour for each unapproved region. An alert is triggered if the observed volume significantly deviates from the forecasted volume. Additionally, use a clustering algorithm (e.g., K-Means) on connection metadata (port, protocol, duration, bytes) to identify groups of beaconing-like activity."
            ]
          }
        ]
      }
    ],
    "version": "2.2",
    "date_created": "2025-05-04",
    "last_updated": "2025-09-30",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]