[
  {
    "information_requirement": "Has the adversary gained initial access to the network by exploiting a public-facing application? (PIR)",
    "tactic_id": "TA0001",
    "tactic_name": "Initial Access",
    "indicators": [
      {
        "technique_id": "T1190",
        "name": "Exploit Public-Facing Application",
        "evidence": [
          {
            "description": "Observed network connection attempts to public-facing application ports from IP addresses present on a high-confidence threat intelligence feed, or network traffic that triggers a specific, high-fidelity intrusion detection signature for a known vulnerability (e.g., CVE-2021-44228).",
            "data_sources": [
              "Zeek conn.log",
              "Zeek signatures.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network perimeter firewalls, DMZ network segments, Cloud security group flow logs",
            "action": [
              "Symbolic: Join Zeek conn.log with a threat intelligence feed of known malicious IP addresses. Alert on any successful or attempted connection from a matched IP to a public-facing web server port (e.g., 80, 443).",
              "Statistical: Monitor Zeek signatures.log for specific CVE-related signature IDs. Calculate the rate of triggering for each signature per source IP over a 1-hour window. Alert on source IPs whose trigger rate for a specific high-severity CVE signature exceeds 3 standard deviations above the mean rate for that signature across all IPs, indicating targeted scanning.",
              "Machine Learning: Use a supervised classification model (e.g., Random Forest) trained on labeled historical data (Zeek conn.log features and threat intel labels) to classify new, incoming connections in near real-time as 'benign' or 'suspicious-exploit-attempt'. Prioritize connections classified as suspicious for analyst review."
            ]
          },
          {
            "description": "Observed HTTP requests containing URI patterns, headers, or body content matching signatures of common exploits (e.g., SQLi, LFI), or containing User-Agent strings of known scanning tools. Alternatively, observed file transfers via HTTP containing filenames or extensions typical of webshells.",
            "data_sources": [
              "Zeek http.log",
              "Zeek files.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Web Application Firewalls (WAFs), Public-facing web servers, Load balancers",
            "action": [
              "Symbolic: Apply regular expression matching on the `uri` and `http_user_agent` fields in Zeek http.log to detect patterns associated with scanners (e.g., 'sqlmap', 'nmap', 'nuclei') or common attack payloads (e.g., '../', 'SELECT', '<script>').",
              "Statistical: For each source IP, calculate the Shannon entropy of the URI query parameters in Zeek http.log over a 5-minute window. A sustained entropy score exceeding the 98th percentile of the historical distribution for the target application can indicate fuzzing or parameter brute-forcing attempts.",
              "Machine Learning: Train an unsupervised anomaly detection model (e.g., an autoencoder) on the sequence of HTTP requests from single client sessions (IP + User-Agent). Flag sessions with a high reconstruction error, which may indicate a deviation from normal browsing behavior consistent with vulnerability probing."
            ]
          },
          {
            "description": "A web server process (e.g., w3wp.exe, httpd.exe) spawning a child process that is a command-line interpreter (e.g., cmd.exe, powershell.exe, /bin/bash), a network utility (e.g., whoami.exe, curl), or any process not on a pre-defined allowlist of expected child processes.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Public-facing web servers, Application servers in the DMZ, Container hosts running public applications",
            "action": [
              "Symbolic: Monitor Windows Event ID 4688 where the Creator Process Name is a known web server process (e.g., 'w3wp.exe', 'httpd.exe') and the New Process Name is a command interpreter ('cmd.exe', 'powershell.exe', 'bash', 'sh') or a known reconnaissance tool ('whoami.exe', 'net.exe', 'ipconfig.exe').",
              "Statistical: Build a baseline of all unique parent-child process relationships observed on public-facing servers over a 30-day period and calculate their frequency. Alert on the creation of a new, never-before-seen parent-child pair, or a pair whose occurrence frequency is in the bottom 1st percentile (extremely rare).",
              "Machine Learning: Use a graph-based anomaly detection algorithm to model process creation events. Analyze subgraphs originating from web server processes and flag any anomalous structures or sequences that deviate from learned 'normal' process trees, indicating a potential post-exploitation activity chain."
            ]
          },
          {
            "description": "An outbound network connection initiated from a public-facing server's IP address to an external destination IP that is either on a non-standard port, has a low reputation score, or is a newly observed destination for that server, often coupled with a significant increase in outbound data volume.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "DMZ network segments, Egress points of the network, DNS resolvers serving the DMZ",
            "action": [
              "Symbolic: Monitor Zeek dns.log for requests originating from public-facing servers to known dynamic DNS or C2 domains. Correlate the timestamp and source IP with Zeek conn.log to identify the subsequent outbound connection and alert.",
              "Statistical: For each public-facing server, baseline the set of normal outbound destination ports and countries over 30 days. Alert when a new connection is made to a port or country not in the baseline. Additionally, calculate the 99th percentile for outbound bytes transferred (`orig_ip_bytes`) in a single connection and alert on any connection exceeding this threshold.",
              "Machine Learning: Use time-series analysis (e.g., Holt-Winters) on the total volume of outbound data per server, aggregated in 10-minute intervals. Alert if the observed volume significantly exceeds the forecasted volume, indicating a potential data exfiltration event."
            ]
          },
          {
            "description": "A statistically significant increase in the ratio of server-side error responses (HTTP 5xx) to total requests, a sharp deviation in the distribution of HTTP request methods, or a sustained period of high-entropy URI parameters from a single source, compared to an established baseline.",
            "data_sources": [
              "Zeek http.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Public-facing web servers, Web Application Firewalls (WAFs), Load balancers",
            "action": [
              "Symbolic: Create a rule to alert if the count of HTTP 500-level status codes from a single web server exceeds a fixed threshold (e.g., 50 errors in 1 minute), which could indicate an exploit crashing an application component.",
              "Statistical: Calculate a rolling 7-day baseline of the distribution of HTTP request methods (GET, POST, etc.) for each application. Alert if the distribution in any given hour deviates from the baseline by more than a set Chi-squared distance, indicating a shift in application interaction.",
              "Machine Learning: Apply a DBSCAN clustering algorithm to the feature space of HTTP requests (e.g., request size, response size, URI length). Benign traffic should form dense clusters. Flag requests that are labeled as noise by the algorithm, as these represent anomalous outliers that could be part of an exploit attempt."
            ]
          }
        ]
      }
    ],
    "version": "2.2",
    "date_created": "2025-05-04",
    "last_updated": "2025-09-30",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]