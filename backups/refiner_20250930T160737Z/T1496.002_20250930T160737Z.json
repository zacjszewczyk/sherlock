[
  {
    "information_requirement": "Is the adversary causing network impact through bandwidth hijacking?",
    "tactic_id": "TA0040",
    "tactic_name": "Impact",
    "indicators": [
      {
        "technique_id": "T1496.002",
        "name": "Bandwidth Hijacking",
        "evidence": [
          {
            "description": "Connections from internal hosts to external IP addresses or domains known to be associated with botnet C2 infrastructure, proxyware services, or malicious scanners.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internet Gateway, DNS Resolvers, Web Proxies",
            "action": [
              "Symbolic: Continuously inner join destination IP addresses from Zeek conn.log and queried domains from Zeek dns.log against high-confidence, regularly updated threat intelligence feeds specializing in botnet C2s, public proxyware services (e.g., Honeygain, Pawns.app), TOR exit nodes, and known malicious scanning infrastructure. Alert on any matches.",
              "Statistical: For each internal host, calculate the percentage of total outbound connections directed to IP addresses present on a lower-confidence, broader threat intelligence list. Flag hosts where this percentage exceeds the 95th percentile of the host's own 30-day rolling average or the 95th percentile of its peer group (e.g., all workstations).",
              "Machine Learning: Train a classification model (e.g., Random Forest) using features from Zeek conn.log and dns.log (e.g., connection duration, bytes sent/received, query type, domain length, domain entropy). The model should be trained on labeled historical data of known malicious and benign traffic to predict the likelihood that a new connection is associated with bandwidth hijacking. Alert when the predicted probability exceeds a defined risk threshold."
            ]
          },
          {
            "description": "Execution of processes with names or command-line arguments known to be associated with proxyware, botnet clients, or cryptocurrency mining software.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Workstations, Servers, Virtual Desktop Infrastructure (VDI) fleet",
            "action": [
              "Symbolic: Monitor Windows Event ID 4688 (Process Creation) logs for process names (e.g., 'xmrig.exe', 'proxy.exe', 'pawn.exe', 'honeygain.exe') or command-line arguments (e.g., '--donate-level', '--pool', '-o stratum+tcp://', '-service') that match a maintained list of patterns for known proxyware, miners, and botnet malware. Alert on any matches.",
              "Statistical: For each host, profile the command-line arguments of common processes (e.g., 'powershell.exe', 'rundll32.exe'). Calculate the historical frequency of argument combinations. Alert on the execution of a common process with a statistically rare or never-before-seen combination of arguments, especially if correlated with high network output.",
              "Machine Learning: Use an unsupervised learning model, such as an autoencoder, on process execution data (parent process, process name, command-line arguments, user context). The model learns a baseline of normal process activity. Flag executions with a high reconstruction error, indicating a significant deviation from the norm, which could signify novel or obfuscated malware."
            ]
          },
          {
            "description": "Anomalous DNS query patterns, including high-frequency requests for domains associated with known cryptocurrency mining pools, proxyware services, or dynamic DNS providers used by botnets.",
            "data_sources": [
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internal DNS Resolvers, Domain Controllers, Network Egress Points",
            "action": [
              "Symbolic: Cross-reference all queried domains from Zeek dns.log against regularly updated lists of known cryptocurrency mining pools, proxyware command-and-control (C2) domains, and botnet-related dynamic DNS providers. Generate an immediate alert upon a match.",
              "Statistical: For each client IP, calculate the entropy of the requested second-level domains over a 5-minute window. Establish a baseline entropy level for each host. Alert when a host's DNS query entropy drops significantly below its baseline (e.g., > 2 standard deviations), suggesting it is repeatedly querying a small set of domains.",
              "Machine Learning: Apply a time series forecasting model (e.g., ARIMA) to the volume of DNS requests per host to learn typical daily and weekly query patterns. An alert is generated when the observed query volume significantly exceeds the model's predicted upper confidence bound, indicating a potential burst of automated C2 or P2P-related DNS activity."
            ]
          },
          {
            "description": "Sustained, anomalous outgoing network traffic from an internal host that is inconsistent with its established role-based baseline.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network Firewalls, Internet Gateway, Core Switches, Cloud VPC Flow Logs",
            "action": [
              "Symbolic: Create a rule to alert when an internal host's total outbound traffic (`orig_bytes` in Zeek conn.log) to a single destination IP address over a high-bandwidth port (e.g., 443, 80) exceeds a static threshold (e.g., 10GB in 1 hour) that is considered abnormal for any single session in the environment.",
              "Statistical: Aggregate total outbound bytes (`orig_bytes`) per internal host over 10-minute intervals. Establish a dynamic baseline of normal outbound bandwidth usage for each host using a 30-day rolling average and standard deviation. Alert when a host's current usage exceeds its baseline by more than 3 standard deviations for three consecutive intervals.",
              "Machine Learning: Utilize a time series anomaly detection model (e.g., Holt-Winters) on the total outbound bytes per host. This model will account for seasonality and trends in network usage. An alert is triggered when an observation is flagged as an anomaly, indicating a deviation from the learned normal traffic pattern that is not explained by typical cyclical behavior."
            ]
          },
          {
            "description": "An internal host exhibiting network traffic patterns consistent with participation in a Distributed Denial of Service (DDoS) attack, such as high-volume, repetitive connections using specific protocols to a small number of external targets.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internet Gateway, Edge Routers, External-facing Firewalls",
            "action": [
              "Symbolic: Create a rule to detect a high rate of TCP SYN packets without a corresponding response (conn_state 'S0' in Zeek conn.log) originating from a single internal host. Alert if the rate exceeds a predefined threshold (e.g., >100 'S0' connections per minute) to a single destination.",
              "Statistical: For each internal host, calculate the ratio of outbound packets to inbound packets (`orig_pkts` / `resp_pkts` in Zeek conn.log) per 1-minute window. Establish a baseline for this ratio across all hosts. Alert on hosts where this ratio is a significant outlier, exceeding the 99th percentile of all hosts.",
              "Machine Learning: Train a K-Means clustering algorithm on connection metadata from Zeek conn.log (e.g., protocol, duration, packet counts, byte counts, connection state). The goal is to cluster network flows into groups. Investigate any internal hosts whose traffic predominantly falls into a cluster characterized by short durations, high packet counts, and low byte counts, consistent with DDoS activity."
            ]
          },
          {
            "description": "An internal host making outbound connections to an anomalously large number of unique external IP addresses or destination ports over a short time frame, indicative of internet-wide scanning or peer-to-peer (P2P) traffic.",
            "data_sources": [
              "Zeek conn.log",
              "Windows Event ID 5156"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Workstation and Server Subnets, Internet Gateway, Core Switches",
            "action": [
              "Symbolic: Create a rule that triggers when a single process (identified via correlation with Windows Event ID 5156) on a host initiates connections to more than a set number of unique destination IP addresses on a common scanning port (e.g., 23, 445, 3389) within one minute.",
              "Statistical: Using Zeek conn.log, calculate the count of distinct destination IPs (`id.resp_h`) per source IP (`id.orig_h`) within a 5-minute window. Identify hosts whose distinct destination count exceeds the 98th percentile for their peer group (e.g., servers vs. workstations) or deviates from their own historical baseline using the Inter-Quartile Range (IQR) method.",
              "Machine Learning: Calculate the Shannon entropy of destination IP addresses and destination ports on a per-source-host basis over rolling time windows. Use a classifier model trained on these entropy scores and other features (e.g., protocol) to distinguish between normal traffic, targeted scanning (low IP entropy, high port entropy), and internet-wide scanning (high IP entropy). Alert when a host is classified as performing scanning."
            ]
          }
        ]
      }
    ],
    "version": "2.2",
    "date_created": "2025-05-04",
    "last_updated": "2025-09-30",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]