[
  {
    "information_requirement": "Is the adversary maintaining persistence by creating new domain accounts?",
    "tactic_id": "TA0003",
    "tactic_name": "Persistence",
    "indicators": [
      {
        "technique_id": "T1136.002",
        "name": "Domain Account",
        "evidence": [
          {
            "description": "A domain account creation event (Windows Event ID 4720) is initiated by a process whose file hash matches a known malicious signature, or originates from a host with an active, high-priority security alert.",
            "data_sources": [
              "Windows Event ID 4720",
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Log Aggregation Platform (SIEM)",
            "action": [
              "Symbolic: Correlate each domain account creation event (Windows Event ID 4720) with the parent process creation event (Windows Event ID 4688) by process ID and time. Compare the file hash of the parent process against a threat intelligence feed of known malicious indicators. Alert on any match.",
              "Statistical: Maintain a risk score for each host based on the volume and severity of security alerts over a rolling 7-day window. Calculate the 95th percentile for host risk scores across the enterprise. Flag any account creation event originating from a host whose risk score exceeds this percentile.",
              "Machine Learning: Use a trained classification model (e.g., Random Forest) that takes features from the account creation event and parent process as input (e.g., parent process name, command line, user context, source host). The model should be trained on historical legitimate and known malicious account creation events to predict the likelihood that a new creation event is malicious. Alert on predictions with a high confidence score."
            ]
          },
          {
            "description": "The command-line arguments of a process creation event (Windows Event ID 4688) on a Domain Controller contain substrings indicative of domain account creation, such as `net user /add /domain` or `New-ADUser`.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Administrative Workstations",
            "action": [
              "Symbolic: Create a detection rule that searches process creation logs (Windows Event ID 4688) on Domain Controllers for command lines containing the literal strings 'net user', '/add', and '/domain' in combination, or the string 'New-ADUser'. Alert on any match.",
              "Statistical: Calculate the Shannon entropy of the command-line arguments for all process creation events on Domain Controllers. Establish a baseline entropy score for legitimate administrative commands. Flag any command containing account creation keywords where the command-line entropy is anomalously high (e.g., > 3 standard deviations from the mean), which could indicate obfuscation or randomized parameters.",
              "Machine Learning: Apply Natural Language Processing (NLP) techniques to cluster historical command-line arguments from Domain Controllers. Identify clusters corresponding to normal administrative activity. Classify new command-line events in real-time and flag any account creation command that is assigned to a low-density or anomalous cluster."
            ]
          },
          {
            "description": "A domain account creation event (Windows Event ID 4720) exhibits one or more anomalous metadata attributes when compared to a historical baseline, such as creation time, source workstation, or the creating user account.",
            "data_sources": [
              "Windows Event ID 4720"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Human Resources Systems, Help Desk Ticketing Systems",
            "action": [
              "Symbolic: Define a list of authorized administrative accounts and designated administrative workstations. Create a rule to alert on any domain account creation event (Windows Event ID 4720) where the 'Subject User Name' is not on the authorized list OR the 'Source Network Address' is not on the designated workstation list.",
              "Statistical: For each administrator, build a statistical profile of their account creation activity, including the hour-of-day and day-of-week distribution. For each new creation event, calculate the rarity of the creation time based on that user's historical profile (e.g., occurs in the bottom 5th percentile of frequency). Flag events that are statistically rare for the specific user performing the action.",
              "Machine Learning: Use an Isolation Forest model trained on the attributes of legitimate account creation events (e.g., creator account ID, source workstation IP, hour of day). The model will learn the boundary of 'normal' activity. Flag any new account creation event that the model classifies as an anomaly or outlier."
            ]
          },
          {
            "description": "Within 24 hours of creation, a new domain account's activity, observed via logon events (Windows Event ID 4624) and network logs (Zeek conn.log), deviates significantly from the established baseline behavior for new accounts.",
            "data_sources": [
              "Windows Event ID 4720",
              "Windows Event ID 4624",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Critical Servers, Network Gateway/Egress Points",
            "action": [
              "Symbolic: For any new account created (Windows Event ID 4720), monitor for subsequent logon events (Windows Event ID 4624) within the first 24 hours. If the new account successfully logs into a host on a predefined 'Critical Asset' list (e.g., Domain Controllers, core financial servers), generate an alert.",
              "Statistical: Establish a baseline for the number of distinct hosts a new user logs into during their first 24 hours. For each new account, count the number of unique destination hosts in logon events (Windows Event ID 4624). Flag any new account that exceeds the 99th percentile of this count, indicating potential lateral movement.",
              "Machine Learning: Develop a time-series model of expected network connection volume (e.g., bytes out, distinct destination IPs) for new user accounts. Monitor network traffic (Zeek conn.log) associated with a new account's source IP. Use the time-series model to forecast expected traffic and flag any observed activity that falls outside the prediction interval."
            ]
          },
          {
            "description": "Following an account creation event (Windows Event ID 4720), subsequent events indicate rapid privilege escalation (e.g., Windows Event ID 4732) or the setting of suspicious account attributes (e.g., Windows Event ID 4738), or the new account name has a high string similarity to a privileged account.",
            "data_sources": [
              "Windows Event ID 4720",
              "Windows Event ID 4738",
              "Windows Event ID 4728",
              "Windows Event ID 4732"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Active Directory Database",
            "action": [
              "Symbolic: Create a rule that triggers when an account is created (Event ID 4720) and then, within 5 minutes, is added to a privileged group like 'Domain Admins' or 'Enterprise Admins' (Event ID 4728 or 4732). Alert immediately on this sequence.",
              "Statistical: For all newly created usernames, calculate the Levenshtein distance to all existing usernames in privileged groups. Establish a threshold for similarity (e.g., a distance of 1 or 2 for names longer than 8 characters). Flag any new username that is highly similar to a privileged account name, suggesting typosquatting or impersonation.",
              "Machine Learning: Use a clustering algorithm (e.g., K-Means) on the sequence of management events (Event IDs 4738, 4728, 4732) that occur within the first hour of an account's life. Identify clusters representing normal provisioning workflows. Flag any new account whose event sequence falls into a new, anomalous cluster, such as one characterized by immediate addition to multiple high-privilege groups."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]