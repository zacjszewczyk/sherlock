[
  {
    "information_requirement": "Is an adversary attempting to gather employee names for targeting?",
    "tactic_id": "TA0043",
    "tactic_name": "Reconnaissance",
    "indicators": [
      {
        "technique_id": "T1589.003",
        "name": "Employee Names",
        "evidence": [
          {
            "description": "External network scanning or web crawling targeting public-facing web servers, where requests originate from IP addresses or contain User-Agents associated with known reconnaissance services or malicious actors.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek http.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internet-facing web servers, Network perimeter firewalls/gateways, Web Application Firewalls (WAFs)",
            "action": [
              "Symbolic: Join Zeek http.log and conn.log on UID. Filter for traffic to public-facing web servers. Compare id.orig_h (source IP) and user_agent against threat intelligence feeds of known malicious IPs, TOR exit nodes, and reconnaissance scanner user agents. Alert on any match.",
              "Statistical: For each source IP, calculate the request rate to pages containing potential employee data (e.g., '/about', '/team', '/contact'). Calculate the 95th percentile of request rates for all external IPs over a 24-hour baseline. Alert on any source IP whose request rate to these pages exceeds this percentile.",
              "Machine Learning: Train a time-series forecasting model (e.g., ARIMA) on the volume of requests to sensitive pages (like 'about us' or 'team' pages) from external IPs. Alert when the observed volume significantly deviates from the forecasted volume, indicating a potential anomalous scraping event."
            ]
          },
          {
            "description": "Automated enumeration attempts against public-facing applications, such as login portals or directory search functions, using sequential, dictionary-based, or name-permutation patterns for usernames.",
            "data_sources": [
              "Zeek http.log",
              "Windows Event ID 4625"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Authentication servers (e.g., ADFS), Public-facing application servers, Web Application Firewalls (WAFs)",
            "action": [
              "Symbolic: Correlate Zeek http.log (POST requests to login URIs) with Windows Event ID 4625 (failed logins) on the authentication server. Create a rule that alerts when a single source IP generates more than 20 failed logins for more than 10 distinct user accounts within 5 minutes.",
              "Statistical: For each attempted username in a failed login event, calculate the Levenshtein distance to other usernames attempted from the same source IP in a 1-hour window. A low average distance suggests sequential or dictionary-based enumeration. Additionally, calculate the entropy of the character set for usernames attempted from a single source IP; unusually low entropy can indicate automated, non-random username generation.",
              "Machine Learning: Use a one-class SVM or isolation forest to model normal login attempt behavior from a single source IP based on features like request frequency, user-agent consistency, and time between attempts. Classify sessions that deviate from this model as anomalous enumeration attempts."
            ]
          },
          {
            "description": "A password spraying attack pattern characterized by a low-and-slow rate of failed login attempts from one or more external IP addresses across a large number of valid or likely-valid usernames.",
            "data_sources": [
              "Windows Event ID 4625",
              "Windows Event ID 4624"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, Authentication servers (e.g., ADFS, RADIUS), Cloud identity providers (e.g., Azure AD)",
            "action": [
              "Symbolic: Create a rule that triggers when a single account has a successful login (Windows Event ID 4624) from a source IP that was responsible for failed logins (Windows Event ID 4625) against multiple other accounts in the preceding 24 hours.",
              "Statistical: Over a 1-hour rolling window, aggregate Windows Event ID 4625 by source IP. Calculate two metrics per IP: unique_failed_usernames and total_failed_logins. Alert on any source IP where unique_failed_usernames is above the 99th percentile for all IPs and the ratio of total_failed_logins to unique_failed_usernames is low (e.g., < 3).",
              "Machine Learning: Develop a peer group analysis model for user login failures. Group users by department or role. Train a model to identify when a user account experiences a login failure that is anomalous compared to their own baseline but part of a wider pattern of failures affecting their peer group simultaneously from a common set of source IPs."
            ]
          },
          {
            "description": "A session from a single external IP exhibiting web scraping behavior, characterized by a high request rate, systematic traversal of directories, or an unusually high volume of data transferred from pages known to contain employee information.",
            "data_sources": [
              "Zeek http.log",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internet-facing web servers, Public API gateways, Web Application Firewalls (WAFs)",
            "action": [
              "Symbolic: Search Zeek http.log for sessions where the user_agent matches common scraping tools (e.g., 'Scrapy', 'BeautifulSoup', 'python-requests'). Alert if such a user agent is seen accessing pages like '/team' or '/about'.",
              "Statistical: For each session identified by its UID in Zeek logs, calculate the number of requests and total bytes transferred. Establish a baseline distribution for these metrics. Alert on sessions where both the request count and byte count exceed the 98th percentile, especially if the URI in http.log consistently targets a specific directory.",
              "Machine Learning: Train a classifier (e.g., Random Forest) on session-based features from Zeek logs (e.g., request rate, user-agent, request method distribution, URI path entropy, time between requests). Use the trained model to classify new, unknown sessions as 'benign', 'benign-crawler', or 'malicious-scraping'."
            ]
          },
          {
            "description": "Anomalous internal user activity involving high-volume access to internal resources containing employee data, such as the intranet, internal directories, or HR application front-ends, inconsistent with the user's role or typical behavior.",
            "data_sources": [
              "Zeek http.log",
              "Zeek conn.log",
              "Windows Event ID 4663",
              "Windows Event ID 4624"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internal SharePoint/intranet sites, Human Resources application servers, File servers hosting employee records, Domain Controllers",
            "action": [
              "Symbolic: Create a watchlist of sensitive files and directories related to employee data (e.g., '\\\\fileserver\\hr\\employee_lists.xlsx'). Configure SACLs and monitor Windows Event ID 4663. Alert when a user not in the 'HR' or 'Management' Active Directory groups accesses these resources.",
              "Statistical: For each user, establish a baseline of daily access counts to internal web resources (from Zeek http.log) and file shares (from Windows Event ID 4663). Use a moving average and standard deviation to model normal behavior. Alert when a user's access count to employee data repositories exceeds 3 standard deviations above their personal baseline.",
              "Machine Learning: Employ a User and Entity Behavior Analytics (UEBA) platform. Model each user's typical behavior based on logon times (Event ID 4624), accessed resources (Event ID 4663, Zeek logs), and data transfer volumes (Zeek conn.log). Use an autoencoder or clustering algorithm to assign a risk score based on deviations from this learned behavior. A sudden spike in accessing employee data would significantly increase the risk score."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]