[
  {
    "information_requirement": "Is the adversary attempting to discover information about Wi-Fi networks on compromised systems?",
    "tactic_id": "TA0007",
    "tactic_name": "Discovery",
    "indicators": [
      {
        "technique_id": "T1016.002",
        "name": "Wi-Fi Discovery",
        "evidence": [
          {
            "description": "Execution of a process where the file hash matches a known malicious signature associated with Wi-Fi discovery tools (e.g., Agent Tesla variants, specific enumeration scripts).",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate endpoints (laptops, desktops), Domain Controllers",
            "action": [
              "Symbolic: Continuously monitor process creation events (Windows Event ID 4688), calculate the SHA256 hash of the executable file, and join against a threat intelligence feed of known malicious file hashes associated with Wi-Fi discovery tools. Generate a high-severity alert upon a match.",
              "Statistical: For all executed hashes not on an allowlist, calculate the prevalence of each hash across the enterprise over a 30-day rolling window. Flag any hash that appears on a statistically insignificant number of endpoints (e.g., in the bottom 1st percentile of prevalence) for manual review, as this may indicate a newly introduced or targeted tool.",
              "Machine Learning: Develop a file hash reputation score using a supervised learning model (e.g., Logistic Regression) trained on features like hash prevalence, first-seen/last-seen timestamps, and association with known malicious command-line arguments. Classify newly observed hashes as benign, suspicious, or malicious to prioritize analyst review."
            ]
          },
          {
            "description": "Execution of native Windows utilities (netsh.exe, powershell.exe) with command-line arguments specifically used for enumerating Wi-Fi profiles or retrieving cleartext keys, such as 'netsh wlan show profiles' or 'netsh wlan show profile <name> key=clear'.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate endpoints (laptops, desktops), Helpdesk and IT administrator workstations",
            "action": [
              "Symbolic: Create a high-fidelity detection rule to monitor process command lines (Windows Event ID 4688) for regular expressions matching known Wi-Fi discovery patterns, such as `/(netsh|powershell).*wlan.*(show|get).*(profile|key=clear)/i`. Alert on any match originating from a non-IT user account.",
              "Statistical: For each user, establish a baseline of their `netsh.exe` command-line execution frequency over a 30-day period. Calculate the entropy of the command-line arguments. An alert should be triggered if a user executes a Wi-Fi discovery command and the execution frequency exceeds the 95th percentile of their historical baseline, or if the command argument entropy is a significant outlier.",
              "Machine Learning: Use a sequence analysis model (e.g., Hidden Markov Model) to learn common sequences of command-line executions for different user roles. Flag command sequences where Wi-Fi discovery commands appear in an anomalous order, such as immediately following a document download or preceding a connection to a rare external IP address."
            ]
          },
          {
            "description": "A non-administrative or non-interactive process (e.g., WINWORD.EXE, CHROME.EXE, svchost.exe) spawning a command shell (cmd.exe, powershell.exe) that subsequently executes Wi-Fi discovery commands.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate endpoints (laptops, desktops), Servers running user-facing applications",
            "action": [
              "Symbolic: Create a detection rule that triggers when a process creation event (Windows Event ID 4688) shows a parent process from a list of non-typical parents (e.g., WINWORD.EXE, EXCEL.EXE, OUTLOOK.EXE) spawning a child process that executes `netsh wlan` commands.",
              "Statistical: Build a frequency table of all parent-child process relationships observed in the environment over 30 days. Calculate the rarity of each observed relationship. Alert on any `netsh wlan` execution where the parent-child pair falls into the bottom 1st percentile of frequency, indicating a highly unusual execution chain.",
              "Machine Learning: Train a classification model (e.g., a Random Forest) on features derived from process creation events, including parent process name, child process name, and command-line arguments. Use the model to classify each process creation event involving `netsh.exe` as either 'benign administrative activity' or 'suspicious discovery activity' based on the learned patterns of anomalous lineage."
            ]
          },
          {
            "description": "Execution of Wi-Fi discovery commands on a host, immediately followed within a short time window (e.g., 5 minutes) by data staging (e.g., output redirection to a file) or a network connection to an external, non-corporate destination.",
            "data_sources": [
              "Windows Event ID 4688",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate endpoints (laptops, desktops), Network egress points (e.g., firewalls, proxies), DNS servers",
            "action": [
              "Symbolic: Correlate process execution logs (Windows Event ID 4688) with network connection logs (Zeek conn.log). Trigger an alert if a process executing a Wi-Fi discovery command is followed within 5 minutes by a network connection from the same host to an IP address on a known C2 blocklist.",
              "Statistical: For any host executing Wi-Fi discovery commands, monitor its subsequent network activity. Calculate a baseline of outbound data volume and destination domain rarity for that host. Trigger an alert if, within 10 minutes of a discovery command, the host's outbound data transfer to a single destination exceeds the 99th percentile of its baseline, or if it resolves a domain (Zeek dns.log) with a low global prevalence score.",
              "Machine Learning: Implement a time-series anomaly detection model (e.g., ARIMA) on key network metrics per host (e.g., bytes out, connection count). When a Wi-Fi discovery event is detected, feed this as an exogenous variable into the model. An alert is generated if the model flags a significant anomaly in network behavior immediately following the discovery event, indicating probable exfiltration."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]