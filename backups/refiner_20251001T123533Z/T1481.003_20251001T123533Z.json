[
  {
    "information_requirement": "Is an adversary leveraging legitimate external web services for one-way command and control against corporate mobile devices? (PIR)",
    "tactic_id": "TA0037",
    "tactic_name": "Command and Control",
    "indicators": [
      {
        "technique_id": "T1481.003",
        "name": "One-Way Communication",
        "evidence": [
          {
            "description": "A corporate mobile device exhibits C2-like network beaconing behavior: connections to a single web service domain show extremely low timing jitter (standard deviation of inter-arrival time is less than 5 seconds), consistently small outbound data payloads (95th percentile of orig_bytes is less than 1KB), and a high outbound-to-inbound byte ratio (greater than 10:1). This pattern of automated, non-interactive communication is distinct from normal user browsing.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek ssl.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate Wi-Fi access points, VPN concentrators handling mobile device traffic, forward proxy servers, and network egress points (Internet gateways) where mobile device traffic is logged.",
            "action": [
              "Join Zeek dns.log ('query' field) with ssl.log ('server_name' field) on the 'uid' field to correlate DNS queries with TLS handshakes. Generate an alert if the queried domain or SNI server_name from a mobile device's IP address matches a threat intelligence feed of known one-way C2 endpoints hosted on legitimate services, such as specific GitHub repositories, Pastebin user accounts, or Telegram channels.",
              "For each source mobile IP, aggregate Zeek conn.log data in 1-hour windows, grouping by destination server name and destination port. Calculate the standard deviation of inter-arrival time, the 95th percentile of outbound bytes ('orig_bytes'), and the ratio of total outbound to inbound bytes ('SUM(orig_bytes) / SUM(resp_bytes)'). Generate an alert if the standard deviation is less than 5 seconds, the outbound byte percentile is less than 1024, the byte ratio is greater than 10, the number of distinct destination ports is 1, and the total connection count is greater than 10 for the window.",
              "Deploy a per-device time-series anomaly detection model, such as an Isolation Forest or LSTM autoencoder, on features aggregated from Zeek conn.log into 5-minute intervals. Engineer features including connection count, total 'orig_bytes', total 'resp_bytes', 'orig_bytes'/'resp_bytes' ratio, standard deviation of inter-arrival times, entropy of destination IPs, and entropy of destination ports. Trigger an alert when the model's anomaly score for a time window exceeds a dynamic threshold, such as 3 standard deviations above the mean reconstruction error, indicating a significant deviation from the device's established communication baseline."
            ]
          },
          {
            "description": "A mobile device sends an HTTP/S request to a legitimate web service, such as a code repository or paste site, with characteristics of C2 data retrieval. These characteristics include a URI path with high Shannon entropy (greater than 3.5) or containing raw content keywords like '/raw/' or '/blob/', an unusual HTTP method for the site, an absent Referer header, and a server response Content-Type (e.g., 'text/plain') inconsistent with the site's typical interactive content (e.g., 'text/html').",
            "data_sources": [
              "Zeek http.log",
              "Zeek files.log",
              "Zeek ssl.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate Wi-Fi access points, VPN concentrators, and forward proxy servers that perform TLS inspection, providing visibility into HTTP headers and content for mobile device traffic.",
            "action": [
              "Using TLS-inspected Zeek http.log data, create a rule to flag requests from the mobile IP range to domains on a high-risk watchlist (e.g., 'pastebin.com', 'raw.githubusercontent.com', 'gist.github.com') where the URI path contains '/raw/', '/blob/', or matches a regular expression for long encoded strings (e.g., '[A-Za-z0-9+/]{20,}=*') and the HTTP method is GET.",
              "For each mobile user or device, establish a baseline of normal activity per destination domain. Calculate the Shannon entropy of the 'uri' field and flag requests in the 99th percentile. Concurrently, track the frequency of User-Agent strings and HTTP methods. Generate a high-risk alert if a high-entropy URI request is accompanied by a rare User-Agent (less than 1% frequency), an unusual HTTP method for that user-destination pair, and a missing Referer header.",
              "Implement a supervised classification model, such as Gradient Boosting or Random Forest, to score each HTTP/S request from mobile devices. Train the model on labeled data using features from Zeek http.log and ssl.log, including URI length, URI Shannon entropy, number of query parameters, presence of raw content keywords in the URI, User-Agent string entropy, JA3/JA3S hash, one-hot encoded 'resp_mime_types', one-hot encoded HTTP method, and a binary feature for the presence or absence of a Referer header. Use the model's output probability score for 'malicious C2' to prioritize alerts for analyst review."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-10-01",
    "version": "1.4",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]