[
  {
    "information_requirement": "Is a compromised mobile device being used to perform network service discovery on the internal network? (TA0032 - Discovery)",
    "tactic_id": "TA0032",
    "tactic_name": "Discovery",
    "indicators": [
      {
        "technique_id": "T1423",
        "name": "Network Service Scanning",
        "evidence": [
          {
            "description": "A single source IP, associated with a mobile device (e.g., from a DHCP range for BYOD Wi-Fi or a VPN address pool), initiates connections to a large number of distinct internal IP addresses or a wide range of ports on a small number of internal IP addresses within a short time frame.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internal network segments accessible by mobile devices, including corporate Wi-Fi subnets and VPN address pools.",
            "action": "Filter Zeek conn.log for source IPs within the NAI (corporate Wi-Fi and VPN subnets). For each source IP, aggregate connection data over a rolling 5-minute window. Calculate two key metrics: (1) the count of unique destination IP addresses and (2) the count of unique destination ports. Establish a baseline for these metrics across all devices in the NAI by calculating the 95th percentile for both counts. Generate an alert for any source IP where either the unique destination IP count or unique destination port count exceeds this baseline threshold. Further enrich alerts by analyzing the distribution of connection states ('conn_state' field); a high ratio of incomplete handshakes (e.g., 'S0', 'REJ') for the connections dramatically increases the confidence that the activity is a network scan."
          }
        ]
      }
    ],
    "version": "1.0",
    "date_created": "2025-09-26",
    "last_updated": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]