[
  {
    "information_requirement": "Is the adversary attempting to wipe or corrupt data to impact availability? (PIR)",
    "tactic_id": "TA0040",
    "tactic_name": "Impact",
    "indicators": [
      {
        "technique_id": "T1561",
        "name": "Disk Wipe",
        "evidence": [
          {
            "description": "Execution of a process where the file hash matches a known disk-wiping malware signature from threat intelligence sources.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 1 (Sysmon)"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "All Windows endpoints and servers, particularly Domain Controllers, file servers, and database servers.",
            "action": [
              "Symbolic: Continuously monitor process creation events (Sysmon EID 1, Windows EID 4688) with process hash logging enabled. Correlate the logged file hashes against a threat intelligence feed of known disk-wiping malware (e.g., WhisperGate, NotPetya). Trigger a high-severity alert on any match.",
              "Statistical: For any process that matches a known wiper hash, calculate the historical prevalence of its parent process across the enterprise. A wiper process spawned by a statistically rare parent process (e.g., a wiper spawned by winword.exe, which falls in the 1st percentile of parent-child relationships) should have its risk score significantly increased.",
              "Machine Learning: Augment threat intelligence matching by using a pre-trained machine learning classifier on process metadata (e.g., file path, parent process, signature status, entropy). Assign a 'wiper-like' probability score to all new processes and alert when a score exceeds a high-confidence threshold (e.g., probability > 0.9), especially when combined with other weak signals."
            ]
          },
          {
            "description": "Execution of built-in system utilities with command-line arguments known to perform destructive data wiping or overwrite operations.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 1 (Sysmon)"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Critical infrastructure servers (e.g., virtualization hosts, backup servers), domain controllers, and standard user workstations.",
            "action": [
              "Symbolic: Monitor process creation events (Sysmon EID 1, Windows EID 4688) for command-line arguments using a list of high-fidelity regular expressions for destructive operations, such as `vssadmin.exe\\s+delete\\s+shadows\\s+/all`, `cipher.exe\\s+/w:`, or `format.exe\\s+[A-Z]:\\\\s+/p:`. Trigger a high-severity alert on any match.",
              "Statistical: For each command matching a destructive pattern, calculate the historical execution frequency for the specific user and host combination. Flag executions where the user or host has a zero or near-zero historical frequency (i.e., first-time execution). Additionally, calculate the command-line string entropy and alert if it deviates more than two standard deviations from the established baseline for that specific utility.",
              "Machine Learning: Employ a time-series anomaly detection model on the execution frequency of these specific utilities network-wide. A sudden, coordinated spike across multiple hosts, detected as a collective anomaly exceeding the forecasted volume's confidence interval, indicates a probable large-scale attack."
            ]
          },
          {
            "description": "An unauthorized process, not on an established allow-list, performs raw disk access operations by attempting to read from a physical drive handle.",
            "data_sources": [
              "Windows Event ID 9 (Sysmon)"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Boot drives of all Windows servers and endpoints, especially Domain Controllers and critical application servers.",
            "action": [
              "Symbolic: Monitor Sysmon Event ID 9 (RawAccessRead) for any process accessing a device with the `\\\\.\\PhysicalDrive` prefix. Maintain an explicit allow-list of legitimate process executables (by hash and path) known to perform raw disk access (e.g., specific disk imaging, forensics, or backup tools). Alert on any process performing a raw disk access that is not on this allow-list.",
              "Statistical: For any process triggering a RawAccessRead event not on the allow-list, analyze its prevalence across the enterprise via a stack count. A process that is rare (e.g., present on less than 1% of endpoints) and performs this action is highly suspicious. Calculate this prevalence score and alert if it falls below a defined threshold (e.g., < 5 hosts).",
              "Machine Learning: Train a classification model (e.g., Random Forest) on features of the process initiating the raw access, including file path, signature status, parent process, and file entropy. Use the model's output, a probability of the process being malicious, to trigger an alert if it exceeds a high-confidence threshold (e.g., probability > 0.9)."
            ]
          },
          {
            "description": "A single process performs file deletion or modification operations at a rate or volume that significantly exceeds a dynamically established baseline for the host or user.",
            "data_sources": [
              "Windows Event ID 11 (Sysmon)",
              "Windows Event ID 23 (Sysmon)",
              "Windows Event ID 26 (Sysmon)"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "File servers, document management systems, and developer workstations with access to source code repositories.",
            "action": [
              "Symbolic: Monitor for processes that generate file delete events (Sysmon EID 23, 26) in critical system directories (e.g., C:\\Windows\\System32) or for files with specific extensions (e.g., .bak, .vhd, .db) that are not typically altered by standard processes. Maintain a watchlist of critical file paths and alert on any deletion by a process not on an allow-list.",
              "Statistical: For each host, establish a baseline of file operation counts (writes via EID 11, deletes via EID 23/26) per process per minute. Use a percentile-based threshold to detect spikes, alerting if operations exceed the 99th percentile of the historical baseline. Also, calculate the entropy of file extensions being modified or deleted by a process; a sudden drop in entropy (e.g., targeting only .docx) or change in entropy can indicate anomalous activity.",
              "Machine Learning: Implement a time-series forecasting model (e.g., ARIMA, Prophet) for file deletion volume on critical servers. Trigger an alert when the observed volume significantly deviates from the forecasted volume by exceeding the model's prediction confidence interval, which can detect both rapid 'smash and grab' and 'low-and-slow' wiping activity."
            ]
          },
          {
            "description": "A host, after exhibiting other potential wiping indicators, initiates an anomalously high number of new SMB connections to administrative shares on other network hosts, indicating propagation.",
            "data_sources": [
              "Zeek smb_mapping.log",
              "Zeek conn.log",
              "Windows Event ID 5140"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internal network segments, monitoring East-West traffic between workstations and servers.",
            "action": [
              "Symbolic: Create a SIEM correlation rule that triggers if a host, within 10 minutes of generating any other disk-wipe-related alert, is observed in Zeek smb_mapping.log or Windows Event ID 5140 logs accessing an administrative share (e.g., ADMIN$, C$) on more than 5 other hosts.",
              "Statistical: For every host, calculate an 'SMB fan-out' score over a 5-minute rolling window, defined as the number of unique destination IPs connected to on TCP port 445. Establish a baseline for this score for each host. Trigger an alert if a host's fan-out score exceeds its own 99.9th percentile, indicating abnormal worm-like propagation behavior.",
              "Machine Learning: Model the network as a graph where hosts are nodes and SMB connections are edges. Use a community detection or graph outlier algorithm to find anomalous nodes. A node that suddenly creates a large number of new, short-lived edges to nodes it has not previously communicated with represents a behavioral anomaly indicative of a spreading threat."
            ]
          },
          {
            "description": "Execution of destructive CLI commands on network infrastructure devices targeting the device configuration or stored firmware images.",
            "data_sources": [
              "Network Device Syslog",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Core network switches, routers, firewalls, and security appliances.",
            "action": [
              "Symbolic: Ingest network device syslog into a SIEM and create a watchlist of destructive command strings (e.g., `erase startup-config`, `write erase`, `delete flash:`, `format slot0:`). Trigger a high-severity alert on any exact or partial match found in the command logs.",
              "Statistical: Establish a baseline of administrative command types and their frequency per user account. Alert when an account executes destructive commands at a rate exceeding two standard deviations above their personal baseline. Correlate the source IP of the administrative session (from Zeek conn.log or syslog) and flag commands originating from geographically anomalous or non-corporate IP space.",
              "Machine Learning: Use a Markov chain model to learn normal sequences of administrative commands for each user role. Flag an observed command sequence containing a destructive command that has a very low transition probability from the preceding commands as a sequential anomaly, indicating a deviation from trained administrative patterns."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.3",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]