[
  {
    "information_requirement": "Has an adversary exfiltrated data from a corporate mobile device by using a non-standard or alternative network protocol? (PIR)",
    "tactic_id": "TA0036",
    "tactic_name": "Exfiltration",
    "indicators": [
      {
        "technique_id": "T1639",
        "name": "Exfiltration Over Alternative Protocol",
        "evidence": [
          {
            "description": "A mobile device's network traffic exhibits a statistically significant volume of outbound data over a protocol (e.g., FTP, IRC, SMB) that is anomalous compared to its own historical baseline and the baseline of its peer group.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate Wi-Fi network segments, guest networks, VPN concentrators, and Mobile Device Management (MDM) platform logs.",
            "action": "1. (Symbolic) Continuously screen destination IP addresses and ports against threat intelligence feeds of known command-and-control (C2) servers and malicious infrastructure. Alert on any match originating from a mobile device. 2. (Statistical) For each mobile device, establish a 30-day rolling baseline of used protocols and the 95th percentile of outbound bytes ('orig_bytes') for each protocol using Zeek conn.log. Generate a medium-severity alert if a device uses a protocol not seen in its baseline. Generate a high-severity alert if the outbound data volume for any connection exceeds 5 times its protocol-specific 95th percentile. 3. (Machine Learning) Implement a time-series forecasting model (e.g., ARIMA) for each device's daily outbound data volume, segmented by protocol. An alert is triggered when the observed volume significantly deviates from the forecasted range. Additionally, use unsupervised clustering (e.g., K-Means) on connection features (protocol, port, duration, bytes) to identify outlier connections that do not belong to established 'normal' traffic clusters."
          },
          {
            "description": "A mobile device generates DNS queries with characteristics indicative of data tunneling, such as a statistically anomalous query rate, abnormally long query labels, or high Shannon entropy in the subdomain portion of the query.",
            "data_sources": [
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internal DNS resolvers, network egress points, and Cloud Access Security Broker (CASB) logs.",
            "action": "1. (Symbolic) Compare requested domains in dns.log against a blocklist of known DNS tunneling C2 domains and services. Alert on any match from the mobile device network segment. 2. (Statistical) For each device, calculate a 30-day rolling baseline for: a) daily DNS query count, b) average query label length, and c) average Shannon entropy of the query label. Generate an alert if the daily query count or average length exceeds 3 standard deviations from its historical mean. Generate a separate, higher-severity alert if the average entropy score is consistently above a threshold (e.g., > 3.5), suggesting non-linguistic, encoded data. 3. (Machine Learning) Train a classification model (e.g., Random Forest) using features like query length, label count, entropy, and character distribution to distinguish between legitimate DNS queries and those generated by tunneling tools. Apply this model in real-time to DNS traffic from mobile devices to flag queries with a high probability of being malicious."
          },
          {
            "description": "A mobile device executes HTTP/S POST requests with an anomalously large payload size to a single destination, or a sustained series of smaller POSTs, directed at a domain that is not an approved corporate or known-good public service.",
            "data_sources": [
              "Zeek http.log",
              "Zeek ssl.log",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Web proxies, internet gateways, and VPN concentrators with SSL/TLS inspection capabilities.",
            "action": "1. (Symbolic) Correlate the 'host' field from http.log and 'server_name' from ssl.log against threat intelligence feeds for malicious domains and newly registered domains (NRDs). Any POST request to a categorized malicious domain or an NRD with a payload over 1MB should be an immediate high-severity alert. 2. (Statistical) For all mobile devices, calculate the 99th percentile of outbound data volume ('orig_bytes' from conn.log) for HTTP/S POST requests. Alert when any single POST from a mobile device exceeds this network-wide threshold. Also, track beaconing behavior by calculating the standard deviation of time deltas between connections to the same host; a very low standard deviation suggests automated communication. 3. (Machine Learning) Use JA3/JA3S hashes from ssl.log to cluster TLS clients and identify anomalous clients that do not match common mobile browsers or applications. Use a time-series analysis to model the expected volume of POST data to various categories of websites (e.g., 'File Sharing', 'Social Media', 'Uncategorized'). A sudden, sustained spike in data sent to 'Uncategorized' or low-reputation domains would trigger an alert."
          }
        ]
      }
    ],
    "last_updated": "2025-09-29",
    "version": "1.1",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]