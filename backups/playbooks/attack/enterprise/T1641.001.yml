name: T1641.001: Transmitted Data Manipulation
id: f8d2c1b0-6a9e-4f3b-8e7d-9c0a1b2c3d4e
description: This playbook helps to determine if an adversary is manipulating transmitted data on mobile devices to cause an impact. This involves detecting HTTP POST requests containing sensitive data patterns (like cryptocurrency wallet addresses or IBANs) sent to malicious, low-reputation, or statistically anomalous domains. It also covers identifying network connections from mobile devices to destinations flagged by threat intelligence or exhibiting anomalous metadata, such as unusual domain names or TLS fingerprints. Finally, it looks for applications on managed mobile devices that use clipboard listener APIs without a clear justification, especially when they also have network communication permissions.
type: technique
related:
  - TA0034: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
investigative_questions:
  - question: How can I detect if mobile devices are sending HTTP POST requests with sensitive data to known malicious or suspicious domains?
    context: This question aims to identify classic data exfiltration or manipulation where malware on a mobile device intercepts sensitive data (like financial information) and sends it to an attacker-controlled server. By correlating device IP addresses with network logs and checking destination domains against threat intelligence, analysts can uncover direct evidence of compromise.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Zeek dns.log
      - Threat Intelligence Platform Data
      - DHCP Server Logs
      - VPN Server Logs
      - Corporate and guest Wi-Fi network access points
      - VPN concentrators
      - Perimeter firewalls
      - Web proxies
      - Cloud Access Security Broker (CASB)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          - Correlate DHCP/VPN logs with Zeek conn.log for mobile device IPs.
          - Join with Zeek http.log on IP for POST requests.
          - Regex scan post_body for sensitive patterns (e.g., crypto addresses, IBANs).
          - For matches, enrich destination host against threat intelligence.
          - Alert if domain is malicious, has a low reputation (<40), was recently registered (<60 days), and is not on an established allowlist.
  - question: Are mobile devices sending sensitive data to domains that are statistically rare for them?
    context: This question focuses on behavioral anomaly detection. Even if a destination domain isn't on a known blocklist, a sudden change in behavior—such as sending sensitive information to a new or rarely used domain—can indicate a compromise. This helps catch emerging threats that haven't yet been flagged by threat intelligence.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Zeek dns.log
      - Threat Intelligence Platform Data
      - DHCP Server Logs
      - VPN Server Logs
      - Corporate and guest Wi-Fi network access points
      - VPN concentrators
      - Perimeter firewalls
      - Web proxies
      - Cloud Access Security Broker (CASB)
    range: last 30 days
    queries:
      - technology: pseudocode
        query: |
          - For each mobile device:
          -   Create a 30-day baseline of destination domains for POSTs with sensitive data.
          -   Calculate frequency of each destination.
          -   Alert if data is sent to a destination in the bottom 5% of frequency.
          -   For new/rare domains, calculate post_body Shannon entropy and alert on deviations > 3 standard deviations from the historical baseline.
  - question: Can a machine learning model identify high-risk HTTP POST transactions indicative of data manipulation?
    context: This question proposes a more advanced, proactive detection method using machine learning. By training a model on various features of an HTTP transaction (geolocation, user-agent, domain reputation, etc.), analysts can create a system that scores new transactions in real-time, allowing for the automatic flagging of suspicious activity that might be missed by rule-based alerts.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Zeek dns.log
      - Threat Intelligence Platform Data
      - DHCP Server Logs
      - VPN Server Logs
      - Corporate and guest Wi-Fi network access points
      - VPN concentrators
      - Perimeter firewalls
      - Web proxies
      - Cloud Access Security Broker (CASB)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          - For each HTTP POST transaction:
          -   Extract features (source IP geolocation, User-Agent, destination domain reputation, domain age, destination ASN, POST body entropy, request size, hour of day, day of week).
          -   Input features into a pre-trained supervised classification model.
          -   Alert if the resulting risk score exceeds a defined threshold (e.g., > 0.85).
  - question: Are mobile devices connecting to known malicious infrastructure or using TLS fingerprints associated with malware?
    context: This question targets the command and control (C2) or data exfiltration channel itself. By checking destination IPs, domains, and TLS fingerprints (JA3/JA3S) against threat intelligence, analysts can detect connections to known malicious servers, even if the specific payload is encrypted.
    answer_sources:
      - Zeek dns.log
      - Zeek conn.log
      - Zeek ssl.log
      - Threat Intelligence Platform Data
      - DHCP Server Logs
      - VPN Server Logs
      - Corporate DNS resolvers
      - Internet gateway
      - Wi-Fi network sensors
      - Cloud Access Security Broker (CASB)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          - Identify mobile device IPs from DHCP/VPN logs and Zeek conn.log.
          - Enrich destination IP/domain (from Zeek dns.log) and JA3/JA3S hashes (from Zeek ssl.log) against threat intelligence.
          - Alert if destination is a known C2 domain or if JA3/JA3S hash matches known malware and is not on an allowlist.
  - question: Is there an unusual spike in new domains being contacted by a mobile device, or is it using new TLS fingerprints?
    context: This question uses behavioral baselining to spot anomalies. A sudden increase in connections to 'first-time-seen' domains or the use of a new TLS fingerprint can be an indicator of malware activity, such as domain generation algorithms (DGAs) or communication with a new C2 server.
    answer_sources:
      - Zeek dns.log
      - Zeek conn.log
      - Zeek ssl.log
      - Threat Intelligence Platform Data
      - DHCP Server Logs
      - VPN Server Logs
      - Corporate DNS resolvers
      - Internet gateway
      - Wi-Fi network sensors
      - Cloud Access Security Broker (CASB)
    range: last 30 days
    queries:
      - technology: pseudocode
        query: |
          - For each mobile device:
          -   Maintain a 30-day rolling baseline of contacted domains and JA3/JA3S hashes.
          -   Calculate the rate of 'first-time-seen' domains per hour.
          -   Alert if this rate exceeds the 98th percentile of the device's historical norm.
          -   Alert if the device initiates a connection using a JA3/JA3S hash not present in its historical set.
  - question: Can an unsupervised machine learning model detect anomalous network connections from mobile devices based on their typical behavior?
    context: This question aims to build a comprehensive behavioral profile for each device's network activity. An unsupervised model can learn what is 'normal' across multiple dimensions (domain entropy, connection duration, data volume, etc.) and flag any connection that significantly deviates from this learned baseline, without needing prior labels of 'good' or 'bad'.
    answer_sources:
      - Zeek dns.log
      - Zeek conn.log
      - Zeek ssl.log
      - Threat Intelligence Platform Data
      - DHCP Server Logs
      - VPN Server Logs
      - Corporate DNS resolvers
      - Internet gateway
      - Wi-Fi network sensors
      - Cloud Access Security Broker (CASB)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          - For each mobile device connection:
          -   Extract features (domain name length, domain name entropy, DNS query type, connection duration, total bytes transferred, JA3 hash, destination port).
          -   Input features into a pre-trained unsupervised anomaly detection model (e.g., Isolation Forest).
          -   Alert if the connection receives a high anomaly score.
  - question: Are there any non-standard applications on managed mobile devices that are using clipboard APIs and also have internet permissions?
    context: This question addresses a specific malware technique where an application monitors the clipboard to steal sensitive information (like passwords or crypto wallet addresses) that the user copies. The risk is significantly higher when the same application can also send that data over the network. This query seeks to find this dangerous combination of permissions and API usage.
    answer_sources:
      - MDM/EDR application_manifest.xml
      - MDM/EDR api_monitoring.log
      - MDM/EDR application_inventory.csv
      - Public App Store Scraped Data
      - Managed mobile devices (corporate-owned or BYOD enrolled in MDM)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          - Using MDM/EDR, inventory all installed applications on managed devices.
          - Parse each app's manifest to detect clipboard listener API usage.
          - Cross-reference with granted permissions for internet access.
          - Alert if a non-system, non-allowlisted application possesses both capabilities.
  - question: Are any installed applications using clipboard listeners in a way that is statistically rare for their application category?
    context: This question adds a layer of contextual intelligence. An app using a clipboard listener might be benign (e.g., a password manager). By comparing its behavior to other apps in the same category (e.g., 'Games', 'Productivity'), we can identify outliers where the use of this API is suspicious and not standard for that type of application.
    answer_sources:
      - MDM/EDR application_manifest.xml
      - MDM/EDR api_monitoring.log
      - MDM/EDR application_inventory.csv
      - Public App Store Scraped Data
      - Managed mobile devices (corporate-owned or BYOD enrolled in MDM)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          - Build a statistical baseline of API usage per application category from public app store data.
          - For each application on a managed device, determine its category and check for clipboard listener usage.
          - Alert if an application uses a clipboard listener and its usage prevalence is below the 10th percentile for that category.
  - question: Can a machine learning model identify Potentially Unwanted Applications (PUAs) where clipboard listener usage is a key risk factor?
    context: This question proposes using a supervised model to calculate a holistic risk score for each application. Instead of just looking at one or two attributes, the model considers a wide range of features (permissions, API calls, user ratings, developer reputation) to determine if an app is likely a PUA. This allows analysts to focus on apps where the clipboard listener is a significant contributor to a high risk score.
    answer_sources:
      - MDM/EDR application_manifest.xml
      - MDM/EDR api_monitoring.log
      - MDM/EDR application_inventory.csv
      - Public App Store Scraped Data
      - Managed mobile devices (corporate-owned or BYOD enrolled in MDM)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          - For each application, construct a feature vector (e.g., permission count, sensitive API calls, app category, user ratings, install count, developer reputation).
          - Input features into a pre-trained supervised classification model to generate a PUA risk score.
          - Trigger an analyst review for applications that receive a high PUA score where the clipboard listener feature is a primary contributing factor.