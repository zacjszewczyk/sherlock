name: 'T1484.001: Group Policy Modification'
id: 'f47ac10b-58cc-4372-a567-0e02b2c3d479'
description: This playbook helps investigate whether an adversary has modified Group Policy Objects (GPOs) for privilege escalation or defense evasion. It focuses on detecting malicious file modifications on SYSVOL shares, suspicious processes spawned by GPO scripts, unauthorized changes to GPO security permissions, and the correlation of GPO changes with subsequent malicious activities like user rights assignments, new scheduled tasks, or the disabling of security controls. The goal is to identify unauthorized GPO changes that could grant attackers elevated permissions or help them evade detection across a network.
type: technique
related:
  - 'TA0004: Privilege Escalation'
  - 'TA0005: Defense Evasion'
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: none
questions:
  - question: Has a file been written to a GPO policy directory on the SYSVOL share that matches a known-bad threat intelligence hash?
    context: Adversaries may place malicious scripts or executables in SYSVOL policy folders to have them distributed and executed across domain-joined machines. Comparing the hash of newly written files against a threat intelligence feed is a high-fidelity method to detect the introduction of known malware via GPO.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 5145
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH file writes (EventID 4663) where object_name contains "\\SYSVOL\\Policies\\"
          FOR each file, COMPUTE its hash
          LOOKUP hash in threat intelligence feed
          ALERT if hash is found
  - question: Does a file recently written to the SYSVOL share have an abnormally high entropy score compared to a baseline of legitimate policy files?
    context: To evade signature-based detection, adversaries often pack or obfuscate their malicious scripts. This process typically increases the file's Shannon entropy. Monitoring for files with unusually high entropy can help detect obfuscated malware placed in GPO policy paths, even if the malware is unknown to threat intelligence feeds.
    answer_sources:
      - Windows Event ID 4663
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH file writes (EventID 4663) where object_name contains "\\SYSVOL\\Policies\\"
          FOR each file, CALCULATE its Shannon entropy
          COMPARE entropy to pre-calculated baseline distribution for SYSVOL files
          ALERT if entropy exceeds 95th percentile of baseline
  - question: Has a file written to the SYSVOL share been classified as an unexpected or suspicious file type?
    context: GPO policy directories in SYSVOL typically contain specific file types like policy files (.pol), scripts (.bat, .ps1), and administrative templates. An adversary might place an executable (.exe) or a DLL (.dll) in these directories. Applying a classification model can automatically flag files that do not conform to expected types, indicating a potential compromise.
    answer_sources:
      - Windows Event ID 4663
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH file writes (EventID 4663) where object_name contains "\\SYSVOL\\Policies\\"
          FOR each file, APPLY file-type classification model (based on extension, entropy, string patterns)
          ALERT if file is classified as 'executable', 'obfuscated script', or other unexpected type
  - question: Has a process been created by a GPO script (`gpscript.exe` or `gpupdate.exe`) with a command line indicative of local privilege escalation?
    context: A common objective for adversaries who gain control of a GPO is to escalate privileges on endpoints. GPO scripts can be used to execute commands that add users to the local 'Administrators' group or create new services running with SYSTEM privileges. Monitoring for these specific command patterns in processes spawned by GPO is a direct way to detect this activity.
    answer_sources:
      - Windows Event ID 4688
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH process creations (EventID 4688) where parent_process is 'gpscript.exe' or 'gpupdate.exe'
          FILTER where command_line contains 'net localgroup administrators /add' or 'sc.exe create'
          ALERT on any matches
  - question: Has a GPO script executed a command line that is statistically rare or has never been seen before in the environment?
    context: Legitimate GPO scripts typically execute a predictable and repetitive set of commands across the enterprise. Adversarial commands, by contrast, are often unique or rare. By baselining the frequency of all command lines executed by GPO scripts, you can use anomaly detection to spot novel commands that warrant investigation for malicious intent.
    answer_sources:
      - Windows Event ID 4688
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH process creations (EventID 4688) where parent_process is 'gpscript.exe' or 'gpupdate.exe'
          CALCULATE historical frequency of each unique command_line
          ALERT if a command_line's frequency is in the bottom 1st percentile or is new
  - question: Has a command line executed by a GPO script been classified by an NLP model as having a high probability of 'Privilege Escalation' intent?
    context: Adversaries may use novel or obfuscated syntax to achieve privilege escalation, which can evade simple pattern matching. A natural language processing (NLP) model trained on a large corpus of malicious and benign command lines can identify the likely *intent* of a command, providing a more robust detection method for suspicious GPO script activity.
    answer_sources:
      - Windows Event ID 4688
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH process creations (EventID 4688) where parent_process is 'gpscript.exe' or 'gpupdate.exe'
          FOR each event, APPLY NLP classification model to the command_line
          ALERT if command_line is classified with high probability of 'Privilege Escalation'
  - question: Have write permissions for a GPO been granted to a non-administrative user or group?
    context: To modify a GPO, an adversary first needs permission to do so. A key step in this attack chain is modifying the GPO's security descriptor (`nTSecurityDescriptor`) to grant a compromised non-admin account write access. Monitoring for these permission changes and comparing them against an allowlist of GPO administrators is crucial for detecting the initial setup for a GPO-based attack.
    answer_sources:
      - Windows Event ID 5136
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH directory service modifications (EventID 5136) where object_class is 'groupPolicyContainer'
          PARSE security descriptor for write permissions (e.g., WriteDacl, GenericAll)
          ALERT if permissions are granted to a user/group NOT in the GPO admin allowlist
  - question: Has a user modified a GPO that they do not typically manage?
    context: System administrators and other privileged users often have specific roles and responsibilities, which translates to a predictable pattern of GPO modifications. An adversary using a compromised account may not know these patterns and might modify a GPO outside the account's normal scope of activity. Baselining which users modify which GPOs can reveal this anomalous behavior.
    answer_sources:
      - Windows Event ID 5136
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          MAINTAIN baseline of historical (User, GPO) modification pairs
          ON new modification event (EventID 5136), calculate rarity score for the (User, GPO) pair
          ALERT if rarity score exceeds a dynamic threshold
  - question: Has a user's GPO modification activity caused their behavior to shift into a different peer group or become an outlier?
    context: User behavior analytics can group users into clusters based on their GPO management habits (e.g., 'Helpdesk', 'Server Admins', 'Domain Admins'). If a compromised standard user account is used to modify high-impact GPOs, its behavior pattern will change drastically. Detecting this shift from a 'standard user' cluster to an 'admin' cluster, or its emergence as a new outlier, can signal an account compromise.
    answer_sources:
      - Windows Event ID 5136
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          CLUSTER users based on GPO modification behavior (frequency, GPO types, etc.)
          ON new modification event (EventID 5136), re-evaluate user's activity
          ALERT if user's cluster assignment changes anomalously (e.g., standard user moves to admin cluster)
  - question: Was a GPO modification shortly followed by the assignment of a sensitive user right (e.g., SeTcbPrivilege) on endpoints via that same GPO?
    context: Adversaries may modify a GPO specifically to grant themselves powerful user rights on target systems. This query correlates the GPO modification event with the subsequent user rights assignment event on endpoints, directly linking the administrative change to its malicious outcome. This provides strong evidence of GPO being used for privilege escalation.
    answer_sources:
      - Windows Event ID 5136
      - Windows Event ID 4704
      - Windows Event ID 4672
      - Active Directory Domain Controllers
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          CORRELATE GPO modifications (EventID 5136) with user right assignments (EventID 4704) within 2 hours
          FILTER where assigned privilege is on a watchlist of sensitive privileges
          AND GPO name from Event 4704 matches the modified GPO in Event 5136
          ALERT on matches
  - question: Did a GPO assign a sensitive privilege to an unusually large number of endpoints, or was the GPO not authorized to assign that privilege at all?
    context: Legitimate assignments of sensitive privileges are typically targeted and well-defined. An adversary, however, might use a GPO to broadly deploy a privilege for widespread access. This can be detected by baselining which GPOs are authorized to grant specific privileges and by monitoring for anomalous spikes in the number of endpoints receiving a privilege from any single GPO.
    answer_sources:
      - Windows Event ID 4704
      - Active Directory Domain Controllers
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          MAINTAIN baseline of (GPO, Privilege) authorization pairs
          SEARCH user right assignments (EventID 4704)
          ALERT if an unauthorized (GPO, Privilege) pair is observed
          OR if endpoint count for an assignment exceeds 3 standard deviations above the mean
  - question: Did the network-wide rate of sensitive privilege assignments spike significantly after a GPO was modified?
    context: While individual privilege assignments might not seem anomalous, a sudden, widespread increase in these assignments across the network can indicate a large-scale attack. Using a time-series model to forecast the expected number of assignments allows you to detect a statistically significant spike and correlate it back to a recent GPO change, suggesting the GPO was the delivery mechanism.
    answer_sources:
      - Windows Event ID 5136
      - Windows Event ID 4704
      - Active Directory Domain Controllers
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          FORECAST expected count of sensitive privilege assignments (EventID 4704) using a time-series model
          ALERT if observed count significantly exceeds the model's prediction
          ENRICH alert if spike is temporally correlated with a GPO modification (EventID 5136)
  - question: After a new GPO was created, was a new scheduled task or service created on endpoints that runs as SYSTEM from a suspicious directory?
    context: A common persistence and privilege escalation technique is to use a new GPO to create a scheduled task or service on many machines. This becomes highly suspicious if the task/service is configured to run with the highest privileges (SYSTEM) and executes a payload from a non-standard, user-writable directory like %TEMP% or %APPDATA%.
    answer_sources:
      - Windows Event ID 5137
      - Windows Event ID 4698
      - Windows Event ID 7045
      - Active Directory Domain Controllers
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          CORRELATE GPO creations (EventID 5137) with subsequent task (EventID 4698) or service (EventID 7045) creations
          FILTER where task/service runs as 'NT AUTHORITY\SYSTEM'
          AND executable path is in '%APPDATA%' or '%TEMP%'
          ALERT on matches
  - question: Following a new GPO's creation, did the rate of new scheduled tasks or services increase anomalously within the OUs affected by that GPO?
    context: A GPO created by an adversary to deploy persistence is likely to cause a sudden burst of new task or service creations on all machines in the targeted Organizational Unit (OU). By baselining the normal rate of these creations per OU, you can detect a statistically significant spike that is localized to the GPO's scope, strongly indicating the GPO was the cause.
    answer_sources:
      - Windows Event ID 5137
      - Windows Event ID 4698
      - Windows Event ID 7045
      - Active Directory Domain Controllers
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          BASELINE rate of new task/service creation per OU
          ON GPO creation (EventID 5137), identify affected OUs
          MONITOR for a spike in task/service creations in those OUs (>99th percentile of historical rate)
          ALERT on significant spikes
  - question: Has a newly created scheduled task or service been flagged as an anomaly, especially if it appeared on multiple machines after a GPO update?
    context: Adversaries often create malicious scheduled tasks or services with unusual combinations of properties (e.g., no description, strange trigger, obfuscated command). Anomaly detection algorithms can automatically flag these outliers without prior knowledge of the specific attack. When such an anomaly appears on many systems shortly after a GPO update, it's a strong signal of malicious GPO deployment.
    answer_sources:
      - Windows Event ID 4698
      - Windows Event ID 7045
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          APPLY anomaly detection (e.g., Isolation Forest) to properties of new tasks/services
          ALERT on any task/service flagged as an outlier
          INCREASE severity if the same anomaly appears on multiple hosts after a GPO update
  - question: Has a GPO policy file (`registry.pol` or `GptTmpl.inf`) been modified to include strings that are known to disable security tools?
    context: An adversary can use GPO to centrally disable security controls across the network, such as turning off Windows Defender or stopping security-related auditing. This can be achieved by pushing specific registry keys or security settings. This query directly scans the content of modified GPO policy files for these known malicious strings, providing a high-fidelity alert for defense evasion attempts.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 5136
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH file modifications (EventID 4663) for 'registry.pol' or 'GptTmpl.inf' in SYSVOL
          SCAN file content for strings like 'DisableAntiSpyware' or 'EnableLsaAuditing'
          ALERT on any match
  - question: Has a critical security GPO been modified in a way that deviates significantly from its 'golden image' baseline?
    context: Critical GPOs that configure security settings should change infrequently and predictably. By maintaining a 'golden image' or secure baseline of these policies, you can programmatically compare any new version against the baseline. An alert can be triggered if the number of changes is unusually high or if the frequency of changes for that specific GPO becomes anomalous, suggesting unauthorized tampering.
    answer_sources:
      - Windows Event ID 5136
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          MAINTAIN 'golden image' for critical security GPOs
          ON GPO modification (EventID 5136), perform a diff between the new policy file and the baseline
          ALERT if the number of changed settings exceeds a threshold or if modification frequency is anomalous
  - question: Has a recent GPO file change been scored by a classification model as having a high risk of being malicious?
    context: Evaluating the risk of a GPO change can be complex, as it depends on who made the change, what setting was altered, and the context of other activities. A trained machine learning model can automate this assessment by scoring each modification based on these features. This provides a more nuanced detection capability than simple rule-based alerts.
    answer_sources:
      - Windows Event ID 5136
      - Windows Event ID 4663
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          ON GPO file modification (EventID 5136 or 4663)
          APPLY trained classification model to score the change for maliciousness (features: setting, user, etc.)
          ALERT if the event receives a high-risk score
  - question: Has a GPO script (`gpscript.exe`) executed a command designed for defense evasion, such as clearing event logs or disabling the firewall?
    context: Adversaries can use GPO startup or logon scripts to execute commands that weaken security on endpoints. This query looks for the execution of specific utilities and commands known to be used for defense evasion, such as `wevtutil.exe cl` (clear log), `netsh advfirewall set` (modify firewall), or `Set-MpPreference -Disable` (disable Defender). This directly detects the use of GPO for defense evasion.
    answer_sources:
      - Windows Event ID 4688
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH process creations (EventID 4688) where parent_process is 'gpscript.exe'
          FILTER where command_line contains 'wevtutil.exe cl', 'netsh advfirewall', or 'Set-MpPreference -Disable'
          ALERT on any matches
  - question: Has a GPO script executed a command-line utility that is rarely used for legitimate GPO-based administration?
    context: Normal GPO scripts tend to use a common and limited set of command-line tools. Adversaries, however, might use less common utilities for defense evasion (e.g., `wevtutil.exe`, `auditpol.exe`). By baselining the frequency of utilities executed by GPO scripts, you can flag the anomalous use of a rare tool, which could indicate malicious activity.
    answer_sources:
      - Windows Event ID 4688
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          BASELINE historical frequency of command-line utilities used by GPO scripts
          ON new process creation from 'gpscript.exe' (EventID 4688)
          ALERT if the utility is rarely used (e.g., usage spikes above 95th percentile)
  - question: Has a GPO-spawned process been flagged as a behavioral outlier based on its command-line arguments?
    context: Adversaries may use legitimate tools with novel or strange combinations of arguments to perform defense evasion. An unsupervised learning model can identify clusters of normal administrative commands and flag any new command that doesn't fit into these clusters. This can detect novel attack techniques without relying on predefined signatures or patterns.
    answer_sources:
      - Windows Event ID 4688
      - All Domain-joined Endpoints and Servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          APPLY unsupervised learning model (e.g., DBSCAN) to command-line arguments of GPO-spawned processes
          ALERT when a new process is flagged as a noise point or forms a new, small cluster
  - question: Has a critical security GPO been modified in a way that deviates from a 'Golden GPO' template, resulting in a security downgrade?
    context: This is a high-precision detection method that involves defining an ideal, secure template for your most important GPOs. After any modification to one of these GPOs, the new settings are programmatically compared to the template. Any change that represents a security downgrade, such as the firewall being disabled (`EnableFirewall` changing from `1` to `0`), triggers an immediate alert.
    answer_sources:
      - Windows Event ID 5136
      - Windows Event ID 4663
      - Active Directory Domain Controllers
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          DEFINE 'Golden GPO' template for critical security policies
          ON GPO file modification (EventID 4663), compare the new settings against the template
          ALERT on any deviation that is a security downgrade (e.g., EnableFirewall: 1 -> 0)
  - question: Has a GPO modification changed a critical security setting to a value that is historically rare or known to be insecure?
    context: For any given security setting (like UAC behavior), there is a historical pattern of acceptable values within your environment. An adversary might change a setting to a less secure value that is rarely or never used legitimately. By tracking the historical distribution of values for critical settings, you can alert when a GPO modification introduces a statistically unusual and insecure value.
    answer_sources:
      - Windows Event ID 5136
      - Windows Event ID 4663
      - Active Directory Domain Controllers
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          TRACK historical value distribution for critical security settings
          ON GPO modification, check the new value of any changed critical setting
          ALERT if the new value is statistically rare or known to be insecure
  - question: Did a GPO's calculated 'security score' drop significantly after it was modified?
    context: Rather than tracking individual settings, a regression model can be trained to produce a holistic 'security score' for an entire GPO based on all its settings. This allows you to quantify the overall security posture of a policy. After any modification, the GPO can be re-scored, and a statistically significant drop in its score would indicate a security degradation that warrants investigation.
    answer_sources:
      - Windows Event ID 5136
      - Active Directory Domain Controllers
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          TRAIN regression model to predict a 'security score' for GPOs
          ON GPO modification (EventID 5136), re-calculate the GPO's score
          ALERT if the score drops by a statistically significant amount
  - question: After a GPO was modified, did a group of hosts affected by that GPO stop sending logs?
    context: A potent defense evasion technique is to use GPO to disable security logging or break the log forwarding agent on endpoints. This query directly links a GPO modification to a 'log source silent' condition for the hosts managed by that GPO. This correlation is a strong indicator that the GPO was used to intentionally blind security monitoring.
    answer_sources:
      - Windows Event ID 5136
      - SIEM Log Ingestion Metrics
      - SIEM / Log Aggregator Platform
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          CORRELATE GPO modification (EventID 5136) with a subsequent 'log source silent' alert
          FILTER where the silent hosts are in an OU affected by the modified GPO
          ALERT on a confirmed correlation
  - question: Following a GPO modification, did the log volume from an affected Organizational Unit drop significantly below its established baseline?
    context: Instead of logs stopping entirely, an adversary might use GPO to selectively disable certain noisy but important event IDs. This would result in a drop in log volume rather than a complete stoppage. By baselining the expected log volume per OU, you can detect a statistically significant drop (e.g., more than 3 standard deviations below the mean) and correlate it with a recent GPO change affecting that OU.
    answer_sources:
      - Windows Event ID 5136
      - SIEM Log Ingestion Metrics
      - SIEM / Log Aggregator Platform
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          BASELINE log volume per hour for each critical log source and OU
          ON GPO modification (EventID 5136), monitor affected OUs
          ALERT if log volume from an affected OU drops > 3 standard deviations below baseline for a sustained period
  - question: Did the actual log ingestion volume fall significantly below the forecasted volume immediately after a GPO modification event?
    context: Time-series forecasting can create a sophisticated model of expected log flow, accounting for time-of-day and day-of-week patterns. A GPO modification used for defense evasion can be treated as an event that might impact this forecast. An alert is triggered if the actual log volume falls significantly outside the model's predicted range right after a GPO change, indicating a high probability of malicious tampering.
    answer_sources:
      - Windows Event ID 5136
      - SIEM Log Ingestion Metrics
      - SIEM / Log Aggregator Platform
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          USE time-series model (e.g., ARIMA) to forecast log ingestion volume
          USE GPO modifications (EventID 5136) as an external regressor in the model
          ALERT if actual volume falls significantly below the forecasted lower confidence bound after a modification
  - question: Was a file on the SYSVOL share modified by a non-standard process or from a non-approved source host?
    context: Legitimate GPO edits are typically performed by administrators using the Group Policy Management Console (`mmc.exe`) from designated administrative workstations. File replication is handled by `dfsrcs.exe`. A write to a policy file from a different process (like `powershell.exe` or a custom tool) or from a non-admin host or unapproved network zone is highly suspicious and could indicate direct tampering with policy files on a domain controller.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 5145
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\)
      - Administrator Workstations
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH file writes (EventID 4663) on SYSVOL paths
          CORRELATE with share access (EventID 5145) to get source process and IP
          ALERT if process name is NOT in allowlist ('mmc.exe', 'dfsrcs.exe')
          OR if source IP is NOT in approved admin network zone
  - question: Has a highly unusual combination of user, source host, and process been observed modifying a file in SYSVOL?
    context: Over time, a clear pattern emerges of which users, from which hosts, using which processes, legitimately modify GPO files. By profiling these legitimate (Process, Host, User) tuples and their frequency, you can use anomaly detection to spot a highly unusual combination. An alert on a very rare tuple performing a write operation can uncover an adversary operating outside of normal administrative patterns.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 5145
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\)
      - Administrator Workstations
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          PROFILE the frequency of (Process, Source Host, User) tuples that write to SYSVOL
          ON new write event, calculate the frequency of the observed tuple
          ALERT if the tuple's frequency is in the bottom 1st percentile
  - question: Has a machine learning model flagged a SYSVOL file write event as an anomaly?
    context: A one-class SVM or similar anomaly detection model can be trained on the features of legitimate SYSVOL write events (e.g., process name, source subnet, user account properties, time of day). The trained model creates a complex boundary of normal behavior. Any new write event that falls outside this boundary is flagged as an anomaly, allowing for the detection of novel or sophisticated attempts to tamper with GPO files.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 5145
      - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\)
      - Administrator Workstations
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          TRAIN one-class SVM model on features of legitimate SYSVOL write events
          SCORE new write events in real-time against the model
          ALERT on any event flagged as an anomaly