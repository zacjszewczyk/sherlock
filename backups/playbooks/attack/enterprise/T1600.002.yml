name: T1600.002: Disable Crypto Hardware
id: 2c3f8a1e-1b7d-4b8a-9c0d-5e6f7a8b9c0d
description: This playbook helps investigate whether an adversary is attempting to evade defenses by disabling cryptographic hardware on network devices. This involves detecting anomalous administrative connections from unauthorized or rare sources, identifying specific CLI commands used to disable crypto engines, flagging suspicious login behavior based on deviations from user baselines, and monitoring for significant decreases in the overall proportion of encrypted network traffic.
type: technique
related:
  - TA0005: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has an administrative connection to a network device originated from an unauthorized or known-malicious IP address?
    context: This question aims to identify administrative access (like SSH or Telnet) from IPs that are not on the pre-approved list of management sources or that are flagged by threat intelligence. Such connections are a strong indicator of unauthorized access attempts, potentially as a precursor to disabling security functions like crypto hardware.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4624
      - Network device management interfaces
      - management subnets
      - jump boxes
      - log aggregation platforms (SIEM)
      - internet gateways
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH Zeek conn.log WHERE destination_port IN (22, 23) AND source_ip NOT IN (authorized_management_ips) OR source_ip IN (threat_intelligence_feed) | ALERT
  - question: Has an administrative connection to a network device originated from a statistically rare or never-before-seen Autonomous System Number (ASN) or country?
    context: This question looks for administrative connections coming from unusual network locations. An adversary might use compromised systems in atypical geographic or network regions. By baselining normal source locations (by ASN and country) and alerting on rare occurrences, we can detect potential threats that might bypass simple IP-based allow-lists.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4624
      - Network device management interfaces
      - management subnets
      - jump boxes
      - log aggregation platforms (SIEM)
      - internet gateways
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: BASELINE administrative connection source ASN and country over 30 days. SEARCH new connections and ALERT if source ASN or country frequency is below 5th percentile.
  - question: Does a new administrative connection to a network device exhibit anomalous characteristics when compared to a machine learning model of normal behavior?
    context: This question uses an unsupervised machine learning model (Isolation Forest) to detect anomalous administrative connections based on a combination of features like source network, time, and day. This approach can identify sophisticated attacks that might not trigger simpler rule-based or statistical checks by finding subtle deviations from established patterns of legitimate activity.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4624
      - Network device management interfaces
      - management subnets
      - jump boxes
      - log aggregation platforms (SIEM)
      - internet gateways
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: TRAIN Isolation Forest model on historical legitimate admin connections (source subnet, ASN, time, day). APPLY model to new connections. ALERT on 'outlier' classification.
  - question: Has a command been executed on a network device to explicitly disable or alter hardware-based cryptographic functions?
    context: This question directly searches for known commands used to disable or downgrade hardware-based cryptography on network devices. Detecting commands like 'no crypto engine' is a high-fidelity indicator that an attacker, having gained administrative access, is actively trying to weaken the device's security posture to evade detection or facilitate further attacks.
    answer_sources:
      - Device Syslog
      - Windows Event ID 4688
      - Network devices (routers, switches, firewalls)
      - centralized syslog servers
      - TACACS+/RADIUS servers
      - management servers/jump boxes
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH device syslog and command logs for REGEX `/(no\s+crypto\s+engine|crypto\s+engine\s+software)/i`. ALERT on match.
  - question: Has an administrative user's command-line session shown a statistically unusual level of command complexity or randomness?
    context: This question attempts to identify anomalous user behavior by measuring the complexity (Shannon entropy) of the commands they execute. A sudden spike in command entropy for a specific user could indicate exploratory behavior, use of obfuscated commands, or script execution, which might be associated with an attacker unfamiliar with the environment or trying to hide their actions.
    answer_sources:
      - Device Syslog
      - Windows Event ID 4688
      - Network devices (routers, switches, firewalls)
      - centralized syslog servers
      - TACACS+/RADIUS servers
      - management servers/jump boxes
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: BASELINE command entropy per user session. For new sessions, CALCULATE entropy. ALERT if entropy > (historical_average + 2 * standard_deviation).
  - question: Does a user's command-line session fall outside the normal 'topics' of administrative activity identified by a machine learning model?
    context: This question uses NLP topic modeling to understand the intent behind command-line sessions. By clustering historical commands into topics like 'routing' or 'interface setup', the model learns what normal administrative work looks like. A session that doesn't fit into any of these topics is anomalous and could represent malicious activity, such as an adversary attempting to disable security features.
    answer_sources:
      - Device Syslog
      - Windows Event ID 4688
      - Network devices (routers, switches, firewalls)
      - centralized syslog servers
      - TACACS+/RADIUS servers
      - management servers/jump boxes
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: TRAIN LDA topic model on historical command logs to create topics. For new command sessions, CLASSIFY against topics. ALERT if session has low probability for all known topics.
  - question: Has a successful administrative login to a network device occurred from an unexpected geographical location or at an unusual time?
    context: This question sets up clear, rule-based boundaries for normal user behavior. By defining allowed countries (geofencing) and typical work hours, it creates a simple but effective way to flag logins that are clear outliers. A login from a foreign country at 3 AM for a user who always works locally during business hours is a significant red flag for account compromise.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Authentication servers (Active Directory, RADIUS, TACACS+)
      - management servers/jump boxes
      - network gateway (for geolocation)
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH successful admin logins (e.g., Event ID 4624). ALERT if source_country NOT IN (geofence_list) OR login_time NOT IN (business_hours_window).
  - question: Has an administrative login session accumulated a high-risk score based on multiple statistical deviations from the user's normal behavior?
    context: This question moves beyond single indicators to a risk-scoring model. Instead of alerting on one anomaly, it aggregates risk from several factors (new country, unusual time, abnormal duration). This approach reduces false positives from single behavioral quirks and increases confidence that an alert is meaningful, as it points to a login that is abnormal in multiple ways.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Authentication servers (Active Directory, RADIUS, TACACS+)
      - management servers/jump boxes
      - network gateway (for geolocation)
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: For each login, CALCULATE risk_score. risk_score += 2 if new country; risk_score += 1 if time deviates > 2 std dev; risk_score += 1 if duration deviates > 3 std dev. ALERT if risk_score > 3.
  - question: Does a new administrative login fall outside the normal clusters of historical login behavior as determined by a machine learning model?
    context: This question uses K-Means clustering to define "normal" patterns of login activity. The algorithm groups historical logins into clusters based on features like time, source, and duration. A new login that doesn't fit well into any of these clusters is an outlier. This can detect novel attack patterns that don't match any single pre-defined rule but are holistically different from all established normal behaviors.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Authentication servers (Active Directory, RADIUS, TACACS+)
      - management servers/jump boxes
      - network gateway (for geolocation)
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: TRAIN K-Means model on historical login data (time, day, ASN, duration) to find clusters. For new logins, CALCULATE distance to cluster centroids. ALERT if distance is large (outlier).
  - question: Has an unencrypted management protocol, such as Telnet or FTP, been used to connect to a network device?
    context: This question looks for the direct evidence of insecure management practices. The use of unencrypted protocols like Telnet for device administration is inherently risky and often forbidden by policy. An alert on such activity could indicate a misconfiguration, a policy violation, or an adversary forcing a downgrade to an insecure protocol to capture credentials or commands.
    answer_sources:
      - Zeek conn.log
      - Zeek ssl.log
      - Zeek ipsec.log
      - Network backbone switches
      - internet gateways
      - datacenter core routers
      - VPN concentrators
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH Zeek conn.log WHERE destination_ip IN (network_device_ips) AND service IN ('telnet', 'ftp'). ALERT on match.
  - question: Has there been a statistically significant drop in the proportion of encrypted traffic (TLS/IPsec) compared to the historical baseline?
    context: This question monitors the overall health of encrypted communications on the network. A sudden, sharp decrease in the ratio of encrypted to total traffic can be a macro-level indicator that a core network device's cryptographic functions have been disabled or are failing. This provides a broad view that complements more specific, host-based detections.
    answer_sources:
      - Zeek conn.log
      - Zeek ssl.log
      - Zeek ipsec.log
      - Network backbone switches
      - internet gateways
      - datacenter core routers
      - VPN concentrators
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: BASELINE ratio of (TLS+IPsec sessions / total TCP sessions) over 30 days. In 10-min intervals, CALCULATE current ratio. ALERT if current ratio < (baseline_mean - 3 * std_dev) for 2+ consecutive intervals.
  - question: Is the observed volume of encrypted traffic significantly lower than the volume forecasted by a time series prediction model?
    context: This question uses a predictive model (like ARIMA or Prophet) to forecast what the encrypted traffic volume should be, accounting for trends and seasonality (e.g., time of day, day of week). When the actual traffic volume falls significantly and consistently below this forecast, it signals a strong anomaly that simple statistical thresholds might miss, pointing to a potential cryptographic disruption.
    answer_sources:
      - Zeek conn.log
      - Zeek ssl.log
      - Zeek ipsec.log
      - Network backbone switches
      - internet gateways
      - datacenter core routers
      - VPN concentrators
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: TRAIN time series model (ARIMA/Prophet) on historical encrypted traffic volume. FORECAST expected volume and confidence interval. ALERT if actual volume is consistently below the lower bound of the confidence interval.