name: T1636.004: SMS Messages
id: 3c1a9f0b-7d2e-4b8c-9a1f-5e6d7c8b9a0d
description: Investigates whether an adversary is collecting and exfiltrating sensitive data from corporate mobile devices by accessing SMS messages. This can involve an application with SMS read permissions exfiltrating data over the network to a malicious destination, or using a connected workstation as a staging point for data collected from the mobile device via synchronization software.
type: technique
related:
  - TA0035: Collection
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is a mobile device making DNS requests for known malicious C2 domains and subsequently transferring data to them?
    context: This question aims to identify the most direct evidence of compromise. If a mobile device with access to sensitive data (like SMS messages) connects to a known command-and-control server, it's a strong indicator of malicious activity. By checking DNS requests first and then confirming the connection and data transfer, analysts can quickly validate a high-fidelity alert.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek ssl.log
      - Mobile Device Management (MDM) logs
      - Corporate Wi-Fi network egress points, VPN concentrators, and the Mobile Device Management (MDM) platform.
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: |
          SEARCH Zeek_dns.log
          WHERE source_ip IN mobile_dhcp_range
          AND query IN malicious_c2_domain_feed
          PIVOT to Zeek_conn.log on source_ip, timestamp
          WHERE connection_established = true
          AND (orig_bytes > 0 OR resp_bytes > 0)
          RETURN source_ip, destination_ip, query, orig_bytes, resp_bytes
  - question: Has a mobile device exhibited anomalous outbound data transfer volume to a rare destination country or ASN?
    context: Adversaries may use previously unknown infrastructure, bypassing threat intelligence feeds. This question uses behavioral analysis to detect such activity. By establishing a baseline of normal outbound traffic for each device, we can spot significant deviations. An unusually large data transfer to a destination that the device rarely communicates with is a strong statistical indicator of potential data exfiltration.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek ssl.log
      - Mobile Device Management (MDM) logs
      - Corporate Wi-Fi network egress points, VPN concentrators, and the Mobile Device Management (MDM) platform.
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: |
          FOR each source_ip in mobile_dhcp_range:
            CALCULATE 30-day baseline of orig_bytes, destination_country, destination_asn
            CALCULATE 95th_percentile_volume
            CALCULATE rare_country_asn_list (<5% frequency)
          SEARCH Zeek_conn.log in last hour
          WHERE source_ip IN mobile_dhcp_range
          AND hourly_orig_bytes > 95th_percentile_volume
          AND destination_country OR destination_asn IN rare_country_asn_list
          RETURN source_ip, destination_ip, destination_country, destination_asn, hourly_orig_bytes
  - question: Does a mobile device's outbound network traffic pattern show a significant deviation from its learned normal behavior, as identified by a time-series anomaly detection model?
    context: This question employs advanced machine learning to detect sophisticated exfiltration attempts that might evade simpler statistical thresholds. A time-series model learns the complex, nuanced patterns of a device's normal network activity across multiple features (volume, duration, protocol, etc.). When a new pattern emerges that the model cannot accurately 'reconstruct,' it signals a high-probability anomaly that could represent malicious activity, such as C2 communication or data exfiltration disguised within legitimate-looking traffic.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek ssl.log
      - Mobile Device Management (MDM) logs
      - Corporate Wi-Fi network egress points, VPN concentrators, and the Mobile Device Management (MDM) platform.
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: |
          FOR each source_ip in mobile_dhcp_range:
            INPUT features (bytes, packets, duration, port, protocol, TLD, JA3/JA3S) into pre-trained LSTM Autoencoder model
            CALCULATE reconstruction_error
            IF reconstruction_error > dynamic_threshold:
              GENERATE alert
              RETURN source_ip, timestamp, features, reconstruction_error
  - question: Has a mobile device synchronization process on a Windows host spawned a suspicious child process known for file manipulation or network communication?
    context: This question investigates a common pivot point for adversaries; using a trusted, connected workstation to stage or exfiltrate data collected from a mobile device. By monitoring for known synchronization processes (like 'PhoneExperienceHost.exe') launching command-line utilities ('powershell.exe', 'curl.exe'), analysts can detect when this legitimate sync channel is being abused. Specific command-line arguments associated with data transfer or encoding provide high-confidence indicators of malicious intent.
    answer_sources:
      - Windows Event ID 4688
      - Windows PowerShell Event ID 4104
      - Employee workstations with mobile device syncing software installed and the centralized log aggregator/SIEM.
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: |
          SEARCH Windows_Event_ID_4688
          WHERE ParentProcessName IN ('PhoneExperienceHost.exe', 'iTunesHelper.exe')
          AND ProcessName IN ('powershell.exe', 'certutil.exe', 'bitsadmin.exe', 'curl.exe')
          AND CommandLine CONTAINS ('-encode', '-f', 'transfer', 'http://', 'https://')
          RETURN hostname, ParentProcessName, ProcessName, CommandLine
  - question: Has a statistically rare child process or command-line argument been executed by a mobile synchronization parent process?
    context: Adversaries may use less common or custom tools to avoid static detection rules. This question addresses that by using behavioral profiling. It establishes a baseline of normal process chains originating from mobile sync tools. When a rare combination of parent process, child process, and command-line arguments appears, it's flagged as a statistical anomaly. This helps uncover novel or evasive techniques that don't match predefined malicious patterns.
    answer_sources:
      - Windows Event ID 4688
      - Windows PowerShell Event ID 4104
      - Employee workstations with mobile device syncing software installed and the centralized log aggregator/SIEM.
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: |
          FOR each sync_parent_process:
            CALCULATE 30-day baseline of child_process and command_line frequency
            CALCULATE rarity_score for each combination
          SEARCH Windows_Event_ID_4688 in real-time
          WHERE ParentProcessName IN sync_parent_process_list
          AND calculated_rarity_score > 99th_percentile
          RETURN hostname, ParentProcessName, ProcessName, CommandLine, rarity_score
  - question: Has a machine learning model classified a process chain originating from a mobile sync tool as 'potential data staging'?
    context: This question leverages a supervised machine learning model for the most sophisticated level of detection. By training on a rich feature set from process and script block logs (e.g., command-line entropy, presence of encoded strings), the model can learn the subtle differences between benign synchronization and malicious data staging. This approach provides a risk score, allowing analysts to prioritize the most suspicious events and detect complex attack patterns that would be nearly impossible to define with manual rules or simple statistics.
    answer_sources:
      - Windows Event ID 4688
      - Windows PowerShell Event ID 4104
      - Employee workstations with mobile device syncing software installed and the centralized log aggregator/SIEM.
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: |
          FOR each event from Windows_Event_ID_4688 and 4104 where parent is a sync tool:
            EXTRACT features (process_names, cmd_length, cmd_entropy, IP_in_cmd, etc.)
            INPUT features into pre-trained Gradient Boosting model
            GET classification_result and risk_score
            IF classification_result == 'potential data staging':
              GENERATE alert
              RETURN hostname, ParentProcessName, ProcessName, CommandLine, risk_score