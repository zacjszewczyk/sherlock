name: T1585.002: Email Accounts
id: 6a82c188-7589-491b-9447-975d78701e18
description: This playbook addresses the adversary technique of acquiring or creating
  email accounts for use in targeting. It provides investigative steps to detect
  this activity by identifying inbound emails with indicators matching threat intelligence
  feeds, communications with potential typosquatted domains, high-volume email campaigns
  from newly registered domains targeting sensitive users, internal hosts connecting
  to multiple disposable email services, and suspicious authentication events such
  as those from anonymized IP addresses or involving impossible travel scenarios.
type: technique
related:
- TA0042: Resource Development
contributors:
- Zachary Szewczyk
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: none
questions:
- question: Has an inbound email been observed with a sender address, domain, source
    IP, URL, or file hash that matches a known malicious indicator from a threat intelligence
    feed?
  context: This question aims to identify direct threats entering the network via
    email by leveraging high-confidence threat intelligence. A match indicates a
    known malicious entity is attempting to communicate with an internal user, which
    could be the precursor to a phishing attack, malware delivery, or other malicious
    activity. A positive match requires immediate investigation as it represents
    a confirmed threat.
  answer_sources:
  - Zeek smtp.log
  - Zeek http.log
  - Zeek files.log
  - Threat Intelligence Feed
  - Email Gateway
  - Web Proxy
  - DNS Resolver
  - Network Egress Points
  range: last 90 days
  queries:
  - 'SEARCH email logs (smtp.log), web logs (http.log), and file analysis logs (files.log)
    FOR sender_address, source_ip, url, or file_hash IN threat_intelligence_feed.
    GENERATE alert on match.'
- question: Are there any inbound emails originating from sender domains with a reputation
    score in the bottom 5th percentile, suggesting they are statistically high-risk?
  context: This question seeks to proactively identify potentially malicious emails
    from senders that are not yet on a known-bad list but exhibit characteristics
    of untrustworthiness. A very low reputation score indicates the domain is statistically
    anomalous and poses a higher risk. Focusing on these emails, especially those
    with links or attachments, helps analysts uncover emerging threats before they
    are widely recognized.
  answer_sources:
  - Zeek smtp.log
  - Zeek http.log
  - Zeek files.log
  - Threat Intelligence Feed
  - Email Gateway
  - Web Proxy
  - DNS Resolver
  - Network Egress Points
  range: last 90 days
  queries:
  - 'FROM email logs, GET sender_domain. LOOKUP domain_reputation from CTI_feed.
    CALCULATE percentile_rank. IF percentile_rank < 5 AND (has_url OR has_attachment),
    FLAG for review.'
- question: Have any inbound emails been classified as having a high probability
    of being malicious by a machine learning model?
  context: This question leverages a machine learning model to detect complex malicious
    patterns that symbolic or simple statistical methods might miss. The model analyzes
    a wide range of features from email metadata, URLs, and attachments to make a
    holistic assessment. An email flagged with a high probability of being malicious
    (e.g., > 0.9) represents a significant threat that warrants automated action or
    priority analyst investigation.
  answer_sources:
  - Zeek smtp.log
  - Zeek http.log
  - Zeek files.log
  - Threat Intelligence Feed
  - Email Gateway
  - Web Proxy
  - DNS Resolver
  - Network Egress Points
  range: last 90 days
  queries:
  - 'INPUT email_features (metadata, url_properties, attachment_properties) into
    ML_classification_model. IF predicted_probability > 0.9, FLAG as malicious.'
- question: Has any network traffic been detected communicating with a pre-identified,
    potential typosquatted or combosquatted domain?
  context: This question aims to proactively detect impersonation attacks by pre-calculating
    likely typosquatted variations of the organization's and its partners' domains.
    Monitoring for traffic to these specific, high-risk domains allows for early
    detection of phishing attempts or user misdirection. An alert indicates a direct
    interaction with a domain created to deceive users.
  answer_sources:
  - Zeek dns.log
  - Zeek smtp.log
  - Internal DNS Resolvers
  - Email Gateway
  range: last 90 days
  queries:
  - 'GENERATE list of typosquatted_domains. SEARCH DNS logs (dns.log) and email logs
    (smtp.log) FOR any domain IN typosquatted_domains. GENERATE alert on match.'
- question: Have any newly observed domains been identified that are either visually
    similar (Levenshtein distance of 1 or 2) to our organization's domain or have
    an unusually high character entropy?
  context: This question uses statistical methods to find suspicious domains that
    aren't on a pre-defined list. It identifies two types of risky domains: those
    that are likely typosquatting attempts due to their close similarity to legitimate
    domains, and those that appear algorithmically generated (like DGA domains) due
    to their high character randomness (entropy). Flagging these helps catch novel
    and dynamic threats.
  answer_sources:
  - Zeek dns.log
  - Zeek smtp.log
  - Internal DNS Resolvers
  - Email Gateway
  range: last 90 days
  queries:
  - 'FOR new_domains in DNS/email logs: CALCULATE Levenshtein_distance to known_good_domains.
    CALCULATE Shannon_entropy. IF (Levenshtein_distance <= 2 AND not allowlisted)
    OR (entropy > 3_std_dev_from_mean), FLAG for review.'
- question: Has a machine learning model classified any newly observed domains as
    linguistically suspicious, potentially indicating typosquatting or combosquatting?
  context: This question applies Natural Language Processing (NLP) to domain name
    analysis, allowing for the detection of sophisticated impersonation techniques
    that simple string matching might miss. The model is trained to recognize subtle
    but meaningful patterns like homoglyphs (using visually similar characters) or
    combosquatting (adding words like 'support'). This provides a more intelligent
    and nuanced way to identify potentially malicious domains.
  answer_sources:
  - Zeek dns.log
  - Zeek smtp.log
  - Internal DNS Resolvers
  - Email Gateway
  range: last 90 days
  queries:
  - 'INPUT new_domain_name into NLP_domain_classifier_model. IF classification is
    ''suspicious'', SUBMIT for review.'
- question: Have any inbound emails been received from a domain created within the
    last 30 days that is not on an approved allowlist?
  context: This question seeks to identify emails from newly created domains, a common
    tactic used by adversaries to bypass reputation-based security controls. Since
    these domains have no history, they often aren't on blocklists. By flagging all
    non-allowlisted new domains, analysts can scrutinize this high-risk category
    of email for potential threats before they can establish a reputation.
  answer_sources:
  - Zeek smtp.log
  - WHOIS Lookup Data
  - HR Information System
  - Email Gateway
  - External Threat Intelligence Platforms
  - Identity and Access Management System
  range: last 90 days
  queries:
  - 'FOR each email in smtp.log: GET sender_domain. PERFORM WHOIS lookup. IF domain_creation_date
    < 30_days_ago AND domain NOT IN allowlist, FLAG for analysis.'
- question: Has a new sender domain (not seen in the last 90 days) sent emails to
    an anomalously large number of recipients, particularly high-value targets, within
    a 24-hour period?
  context: This question aims to detect the start of a targeted phishing or malware
    campaign by focusing on outlier behavior from new domains. A legitimate new sender
    is unlikely to email a large, diverse group of employees at once. Exceeding a
    statistical threshold (95th percentile) for recipient count from a new domain
    is a strong indicator of a broad-based attack, and the risk is amplified if high-value
    targets are included.
  answer_sources:
  - Zeek smtp.log
  - WHOIS Lookup Data
  - HR Information System
  - Email Gateway
  - External Threat Intelligence Platforms
  - Identity and Access Management System
  range: last 90 days
  queries:
  - 'FOR new_domains (not in 90-day baseline): COUNT unique_recipients per 24_hours.
    IF unique_recipients > 95th_percentile_for_new_domains, GENERATE alert.'
- question: Has a time-series anomaly detection model detected a sudden and significant
    spike in email volume from a single new domain?
  context: This question uses machine learning to monitor the *rate* of email communication
    from new domains over time. The model learns the normal, typically low-volume
    pattern of traffic from new senders. A sudden, sharp spike in volume from one
    of these domains is a strong deviation from the norm and indicates a potential
    automated or coordinated campaign launch, prompting an immediate alert.
  answer_sources:
  - Zeek smtp.log
  - WHOIS Lookup Data
  - HR Information System
  - Email Gateway
  - External Threat Intelligence Platforms
  - Identity and Access Management System
  range: last 90 days
  queries:
  - 'MONITOR time-series of email volume from new_domains. APPLY anomaly detection
    model (e.g., ARIMA). IF volume spike is detected as an anomaly, TRIGGER alert.'
- question: Has a host in a restricted network segment, such as a server, attempted
    to connect to a known disposable or free email service provider?
  context: This question enforces policy and detects suspicious activity by checking
    for connections from sensitive assets (like servers) to domains known to provide
    disposable email. Such activity is highly anomalous and forbidden by policy, as
    servers should not be creating email accounts. A match indicates a potential
    compromise or misconfiguration and warrants immediate blocking and investigation.
  answer_sources:
  - Zeek dns.log
  - Zeek http.log
  - Zeek conn.log
  - Web Proxy
  - DNS Resolver
  - Network Egress Points
  - Server Subnets
  range: last 90 days
  queries:
  - 'MAINTAIN blocklist of disposable_email_domains. SEARCH DNS/connection logs for
    traffic FROM server_subnets TO blocklist. ON match, BLOCK and GENERATE alert.'
- question: Has any internal host connected to a statistically unusual number of
    unique email provider domains in a short time frame (e.g., more than 5 in 10
    minutes)?
  context: This question aims to detect automated scripts used for creating or testing
    large numbers of email accounts. A normal user or system process would not connect
    to many different email providers in a short period. Exceeding a statistical baseline
    or a hard threshold indicates abnormal, machine-like behavior that is highly suspicious
    of an adversary preparing resources for a campaign.
  answer_sources:
  - Zeek dns.log
  - Zeek http.log
  - Zeek conn.log
  - Web Proxy
  - DNS Resolver
  - Network Egress Points
  - Server Subnets
  range: last 90 days
  queries:
  - 'FOR each host: BASELINE unique_email_domains_per_hour. In a 10-minute window,
    COUNT unique_email_domains. IF count > 3_std_dev_from_baseline OR count > 5, GENERATE
    alert.'
- question: Has a machine learning clustering model identified a new behavioral
    pattern of network traffic consistent with automated email account creation?
  context: This question uses unsupervised machine learning to find novel attack
    patterns without prior signatures. By clustering network connections based on
    their characteristics (duration, data volume, etc.), the model can distinguish
    normal behaviors like web browsing from anomalous ones. The emergence of a new
    cluster defined by short, repetitive, low-data connections to many different
    domains is a strong fingerprint for automated scripts creating email accounts.
  answer_sources:
  - Zeek dns.log
  - Zeek http.log
  - Zeek conn.log
  - Web Proxy
  - DNS Resolver
  - Network Egress Points
  - Server Subnets
  range: last 90 days
  queries:
  - 'CLUSTER network connections (conn.log) using features like duration, bytes,
    port. MONITOR for new clusters with characteristics of short, repetitive, low-volume
    connections to many domains. FLAG new cluster emergence.'
- question: Has a successful user authentication occurred from an IP address known
    to be malicious or associated with an anonymizing service like Tor or a public
    VPN?
  context: This question aims to detect account takeovers by identifying logins from
    high-risk IP addresses. Adversaries often use anonymizing services to hide their
    true location. A successful login from an IP on a threat intelligence feed is
    a strong indicator of compromise, warranting an immediate automated response (like
    session termination) and a high-priority investigation.
  answer_sources:
  - Windows Event ID 4624
  - Zeek conn.log
  - GeoIP Database
  - Authentication Servers (e.g., ADFS)
  - VPN Concentrators
  - Cloud Identity Provider Logs
  range: last 90 days
  queries:
  - 'FOR successful logins (Event ID 4624): GET source_ip. IF source_ip IN (malicious_ip_feed
    OR tor_exit_nodes OR public_vpn_list), TRIGGER alert and automated_response.'
- question: Has a user successfully authenticated from a geographic location that
    would be impossible to travel to from their previous login location, or from a
    very rare Autonomous System Number (ASN) for that user?
  context: This question uses statistical analysis to detect account compromise by
    identifying logically impossible or highly improbable user behavior. 'Impossible
    travel' detects simultaneous or near-simultaneous logins from distant locations.
    Analyzing the source ASN helps spot logins from unusual networks. Both are strong
    indicators that the legitimate user is not the one logging in.
  answer_sources:
  - Windows Event ID 4624
  - Zeek conn.log
  - GeoIP Database
  - Authentication Servers (e.g., ADFS)
  - VPN Concentrators
  - Cloud Identity Provider Logs
  range: last 90 days
  queries:
  - 'FOR each successful login: CALCULATE travel_speed from previous login. GET source_ASN.
    IF travel_speed > 1000kmh OR ASN is in <1% of user''s history, FLAG as impossible
    travel/rare ASN.'
- question: Has a machine learning model detected that a user's recent successful
    login is a significant deviation from their established normal login behavior?
  context: This question leverages a sophisticated behavioral model to build a unique
    'pattern of life' for each user's login activity (time, location, device, network,
    etc.). The model can then spot anomalies that might be missed by simpler rules.
    A login that is flagged as a behavioral anomaly, even if not from a known bad
    IP or an impossible location, is a high-risk event that could signify a subtle
    account takeover.
  answer_sources:
  - Windows Event ID 4624
  - Zeek conn.log
  - GeoIP Database
  - Authentication Servers (e.g., ADFS)
  - VPN Concentrators
  - Cloud Identity Provider Logs
  range: last 90 days
  queries:
  - 'FOR each successful login: EXTRACT features (time, geo, ASN, user-agent). SCORE
    against user''s behavioral anomaly model. IF score is anomalous, FLAG as high-risk.'