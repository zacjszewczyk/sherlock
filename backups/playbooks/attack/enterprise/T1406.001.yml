name: T1406.001: Steganography
id: f9a1b2c3-d4e5-4f6a-7b8c-9d0e1f2a3b4c
description: |
  This playbook addresses the threat of adversaries using steganography to exfiltrate data from or introduce malicious tools to managed mobile devices. It provides investigative steps to detect this activity by analyzing network traffic for media files with suspicious characteristics such as destinations on threat intelligence blocklists, unusually large file sizes, or high Shannon entropy. It also covers on-device detection by scanning mobile application binaries for known steganography libraries, checking local media files for anomalous entropy levels, and monitoring for processes that read media files before making unusual outbound network connections.
type: technique
related:
- TA0030: Defense Evasion
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Has a media file been transferred to or from a mobile device to a known malicious destination?
  context: |
    This question aims to identify steganographic activity by correlating file transfers with threat intelligence. If a media file (e.g., PNG, JPG) is sent to or received from an IP address or domain associated with malicious activity (like C2 servers or drop zones), it could be a channel for hidden data exfiltration or malware delivery.
  answer_sources:
  - Zeek files.log
  - Zeek conn.log
  - Zeek http.log
  - Zeek dns.log
  - Corporate Wi-Fi network egress points
  - Guest Wi-Fi network segments
  - VPN concentrators serving mobile devices
  - Cloud storage service gateways
  - Threat Intelligence Feeds
  range: Last 90 days
  queries:
  - pseudocode: JOIN files.log, conn.log, http.log, dns.log ON uid; WHERE file_mime_type IN (image/*, video/*) AND (destination_ip IN (threat_intel_list) OR resolved_domain IN (threat_intel_list));
- question: Has a transferred media file exhibited an unusually large size or high entropy suggestive of embedded data?
  context: |
    This question seeks to find statistical anomalies in media files. Steganography often increases a file's size and randomness (entropy). By establishing a baseline for normal file sizes and entropy per file type, we can flag outliers. A media file that is significantly larger than its peers or has an entropy level closer to that of encrypted data ($$ H(X) > 7.5 $$) is a strong candidate for containing a hidden payload.
  answer_sources:
  - Zeek files.log
  - Corporate Wi-Fi network egress points
  - Guest Wi-Fi network segments
  - VPN concentrators serving mobile devices
  - Cloud storage service gateways
  range: Last 90 days
  queries:
  - pseudocode: 1. BASELINE: For each mime_type in files.log, calculate 99th_percentile_size over last 30 days. 2. ALERT: For new_file in files.log, IF new_file.size > 99th_percentile_size(new_file.mime_type) OR shannon_entropy(new_file) > 7.5, THEN alert.
- question: Do network file transfers from mobile devices exhibit anomalous characteristics when analyzed by a machine learning model?
  context: |
    This question uses an unsupervised machine learning model (Isolation Forest) to detect unusual file transfer behavior that might not be caught by simple thresholding. The model learns what 'normal' traffic looks like based on multiple features (file size, type, destination, user agent, etc.). Transfers that the model flags as highly anomalous (outliers) warrant investigation as they may represent sophisticated steganographic techniques.
  answer_sources:
  - Zeek files.log
  - Zeek conn.log
  - Zeek http.log
  - Corporate Wi-Fi network egress points
  - Guest Wi-Fi network segments
  - VPN concentrators serving mobile devices
  - Cloud storage service gateways
  range: Last 90 days
  queries:
  - pseudocode: 1. TRAIN: model = IsolationForest.fit(benign_traffic_features); 2. PREDICT: anomaly_score = model.predict(new_traffic_features); 3. ALERT: IF anomaly_score IN top 1% of outliers, THEN investigate.
- question: Are any installed mobile applications known to contain steganography libraries or functions?
  context: |
    This question focuses on identifying the tools an adversary might use. By proactively scanning application binaries (.apk, .ipa) on managed devices with YARA rules, we can detect the presence of code libraries specifically designed for steganography. A match indicates that the application has the built-in capability to hide data, making it a high-risk application that requires immediate investigation.
  answer_sources:
  - MDM Application Inventory Logs
  - Mobile EDR File Creation Events
  - Mobile Application Sandbox Analysis Reports
  - Managed mobile device fleet
  - Enterprise application store and repository
  - Mobile device sandboxing environment
  range: Last 90 days
  queries:
  - pseudocode: For each app_binary in (MDM_inventory, EDR_file_events): SCAN app_binary with steganography_YARA_rules; IF match, THEN alert.
- question: Are there any media files on a mobile device's local storage with statistically significant high entropy?
  context: |
    This question looks for the product of steganography on the device itself. Unlike a fixed entropy threshold, this method is more adaptive. It establishes a 'normal' entropy range for each file type on the device and then looks for statistical outliers. A file with an entropy z-score $$ z = (x - \mu) / \sigma $$ greater than 3 is a significant deviation from the mean, suggesting it may have been modified to hide data.
  answer_sources:
  - Mobile EDR File Creation Events
  - Mobile EDR File Modification Events
  - Managed mobile device fleet
  range: Last 90 days
  queries:
  - pseudocode: 1. BASELINE: For each file_type, calculate mean_entropy (mu) and std_dev_entropy (sigma). 2. SCAN: For each new/modified_media_file, calculate entropy (x). 3. ALERT: IF (x - mu) / sigma > 3, THEN alert.
- question: Can a machine learning model identify mobile applications that are likely capable of steganography based on a combination of their characteristics?
  context: |
    This question employs a supervised machine learning model (Gradient Boosting) to proactively assess the risk of an application. The model is trained on known good and bad apps to learn the patterns of malicious steganographic tools. It considers a wide range of features, including permissions, code strings (from YARA), API calls, and origin, to assign a risk score. This allows for the identification of novel or sophisticated threats that might evade simpler detection methods.
  answer_sources:
  - MDM Application Inventory Logs
  - Mobile Application Sandbox Analysis Reports
  - Managed mobile device fleet
  - Enterprise application store and repository
  - Mobile device sandboxing environment
  range: Last 90 days
  queries:
  - pseudocode: 1. TRAIN: model = GradientBoostingClassifier.fit(labeled_app_features); 2. PREDICT: risk_score = model.predict(new_app_features); 3. ALERT: IF risk_score > threshold, THEN investigate.
- question: Has a non-media application read a media file and immediately connected to a known malicious IP address?
  context: |
    This question seeks to identify a classic steganography exfiltration pattern: an unexpected application reads a media file (to extract hidden data) and then 'phones home'. By correlating file access events with network connections within a short time window, and checking the destination against threat intelligence, we can detect this suspicious sequence of actions. An allowlist for legitimate media apps helps reduce false positives.
  answer_sources:
  - Mobile EDR Process Events
  - Mobile EDR File Access Events
  - Mobile EDR Network Flow Logs
  - Zeek conn.log
  - Managed mobile device fleet
  - Corporate Wi-Fi network egress points
  - VPN concentrators
  - Threat Intelligence Feeds
  range: Last 90 days
  queries:
  - pseudocode: CORRELATE (EDR_file_access, EDR_network_flow) by process_id; ALERT IF process_name NOT IN (media_app_allowlist) AND file_extension IN (media_types) AND time(network_flow) - time(file_access) < 5s AND destination_ip IN (threat_intel_list);
- question: Has a process, after reading a media file, connected to a network destination (ASN) that is rare for its normal behavior?
  context: |
    This question aims to detect anomalous network behavior without relying solely on blocklists. It establishes a profile of 'normal' for each application by tracking the network destinations (ASNs) it typically communicates with. An alert is triggered when an application reads a media file and then connects to an ASN it has rarely or never connected to before. This can uncover C2 communication to newly established or unconventional infrastructure.
  answer_sources:
  - Mobile EDR Process Events
  - Mobile EDR File Access Events
  - Mobile EDR Network Flow Logs
  - Managed mobile device fleet
  range: Last 90 days
  queries:
  - pseudocode: 1. BASELINE: For each process, create profile of historical destination_ASN_frequency. 2. ALERT: IF process reads media_file AND subsequently connects to destination_ASN where frequency < 5th_percentile for that process, THEN alert.
- question: Does the sequence of system events on a mobile device deviate from normal behavior in a way that suggests steganographic activity?
  context: |
    This question uses a sophisticated deep learning model (LSTM autoencoder) to understand the 'grammar' of normal system behavior. The model is trained on sequences of events from benign applications. When it encounters a new sequence of events (e.g., an unusual app reading a media file then making a network connection), it tries to reconstruct it. If the reconstruction error is high, it means the sequence is highly anomalous and does not fit the learned pattern of normal behavior, flagging it for investigation as a potential advanced attack.
  answer_sources:
  - Mobile EDR Process Events
  - Mobile EDR File Access Events
  - Mobile EDR Network Flow Logs
  - Managed mobile device fleet
  range: Last 90 days
  queries:
  - pseudocode: 1. TRAIN: model = LSTM_Autoencoder.fit(benign_event_sequences); 2. PREDICT: reconstruction_error = model.evaluate(new_event_sequence); 3. ALERT: IF reconstruction_error > anomaly_threshold, THEN investigate.