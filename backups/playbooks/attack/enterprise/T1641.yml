name: T1641: Data Manipulation
id: c5a1b8d0-e8f0-4c6b-8d1a-9e2f3a4b5c6d
description: This playbook investigates potential data manipulation on corporate mobile devices. It focuses on identifying adversaries who disrupt operations or decision-making by either intercepting sensitive data via clipboard access followed by suspicious network exfiltration, or by directly modifying files and databases outside of their intended application sandboxes. This includes detecting high-frequency or anomalous write patterns to sensitive files like contact or calendar databases.
type: technique
related:
- TA0034: Impact
contributors: Zachary Szewczyk, Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
investigative_questions:
- question: Has a non-corporate or known malicious application recently read clipboard data immediately after a corporate application wrote to it?
  context: This question aims to detect credential or sensitive data theft via clipboard monitoring. An adversary might use a malicious app to capture data (like passwords or session tokens) that a user copies from a trusted application (like a password manager or corporate email), which can lead to account compromise or further infiltration. Identifying this specific sequence of events is critical for early detection of such an attack.
  answer_sources:
  - Mobile EDR/MDM logs (capturing API calls, process activity, and clipboard access events)
  - Zeek conn.log
  - Zeek dns.log
  - Corporate-managed mobile devices
  - Corporate Wi-Fi and VPN network gateways
  - Cloud-hosted MDM/EDR platforms
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH Mobile EDR logs
      JOIN clipboard writes and reads by device ID
      WHERE read_timestamp is within 5 seconds of write_timestamp
      AND writer_app is in [corporate_app_list]
      AND reader_app is NOT in [corporate_app_list]
      ENRICH reader_app with threat intelligence
      RETURN results where threat_intel_match is true
- question: Is any mobile application accessing the clipboard with an unusually high frequency or interacting with other applications in a novel way?
  context: This question seeks to identify anomalous clipboard activity that deviates from established user or application behavior. A sudden spike in clipboard access by an app or an app reading data copied from an unusual source could indicate a compromised or malicious application attempting to harvest information over time without being detected by signature-based methods.
  answer_sources:
  - Mobile EDR/MDM logs (capturing API calls, process activity, and clipboard access events)
  - Zeek conn.log
  - Zeek dns.log
  - Corporate-managed mobile devices
  - Corporate Wi-Fi and VPN network gateways
  - Cloud-hosted MDM/EDR platforms
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      // Baseline creation (over 30 days)
      SEARCH Mobile EDR clipboard_read logs
      AGGREGATE read_count by app, per day
      CALCULATE 99th percentile of read_count for each app
      STORE baseline

      // Anomaly detection (daily)
      SEARCH Mobile EDR clipboard_read logs for the last 24 hours
      AGGREGATE daily_read_count by app
      COMPARE daily_read_count to stored 99th_percentile_baseline
      ALERT if daily_read_count > 99th_percentile_baseline
- question: Is there a spike in outbound network traffic from a mobile device shortly after a non-standard application accessed the clipboard?
  context: This question correlates clipboard access with network behavior to detect data exfiltration. After capturing sensitive data from the clipboard, an adversary's next step is often to send it to a command-and-control server. By linking an anomalous clipboard read to an unexpected burst of outbound data, we can more confidently identify a potential data breach in progress.
  answer_sources:
  - Mobile EDR/MDM logs (capturing API calls, process activity, and clipboard access events)
  - Zeek conn.log
  - Zeek dns.log
  - Corporate-managed mobile devices
  - Corporate Wi-Fi and VPN network gateways
  - Cloud-hosted MDM/EDR platforms
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      // Model training (historical data)
      TRAIN time-series model on Zeek conn.log orig_bytes per device per minute

      // Real-time monitoring
      FOR each 1-minute interval:
        PREDICT expected outbound data volume and confidence interval per device
        IF actual_volume > upper_confidence_bound + 3*std_dev:
          SEARCH Mobile EDR logs for clipboard_read by non-standard_app on same device in last 60 seconds
          IF match found:
            ALERT 'Suspicious Data Manipulation and Exfiltration'
- question: Has any application attempted to write to a file or database outside of its designated application sandbox?
  context: This question is designed to detect blatant violations of mobile OS security principles. Applications are typically restricted to their own 'sandbox' to prevent them from interfering with other apps or the OS. An app writing data outside its sandbox is a strong indicator of a malicious exploit or a deliberately harmful application attempting to corrupt data, plant malware, or access unauthorized information.
  answer_sources:
  - Mobile EDR/MDM logs (capturing file system and database modifications)
  - Zeek http.log
  - Zeek files.log
  - Corporate-managed mobile devices
  - Application servers receiving mobile data
  - Application data containers on mobile devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH Mobile EDR file_write logs
      WHERE process_sandbox_path is NOT a parent of target_file_path
      AND process_name is NOT in [os_process_allowlist]
      AND process_name is NOT in [inter_app_framework_allowlist]
      ALERT on any result
- question: Is any application modifying critical data files, like the contacts database, with an abnormal frequency or causing unusual changes in file size?
  context: This question helps identify subtle data manipulation tactics. Instead of a single, large change, an adversary might perform many small, rapid modifications to inject malicious data or corrupt records over time. By baselining normal write behavior for sensitive files, we can detect deviations that suggest automated or malicious activity, rather than normal user interaction.
  answer_sources:
  - Mobile EDR/MDM logs (capturing file system and database modifications)
  - Zeek http.log
  - Zeek files.log
  - Corporate-managed mobile devices
  - Application servers receiving mobile data
  - Application data containers on mobile devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      // Baseline creation (over 30 days)
      SEARCH Mobile EDR file_write logs for critical_files (e.g., contacts.db)
      AGGREGATE write_frequency, file_size_delta by app, per day
      CALCULATE 95th percentile for both metrics for each app
      STORE baseline

      // Anomaly detection (daily)
      SEARCH Mobile EDR file_write logs for the last 24 hours
      AGGREGATE daily metrics by app
      COMPARE daily metrics to stored 95th_percentile_baseline
      ALERT if daily_metric > 95th_percentile_baseline
- question: Do file-write events on mobile devices exhibit characteristics that a machine learning model identifies as malicious?
  context: This question leverages machine learning to detect complex patterns of malicious data manipulation that are difficult to define with simple rules. By training a model on known benign and malicious behaviors, it can learn to identify suspicious combinations of features (e.g., an unusual process writing to a specific file type at an odd hour) that, when combined, strongly indicate an attack. This provides a more sophisticated and adaptable detection method.
  answer_sources:
  - Mobile EDR/MDM logs (capturing file system and database modifications)
  - Zeek http.log
  - Zeek files.log
  - Corporate-managed mobile devices
  - Application servers receiving mobile data
  - Application data containers on mobile devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      // Model training (offline)
      COLLECT features from historical Mobile EDR file_write events
      LABEL data as 'malicious' (simulated attacks) or 'benign' (baseline)
      TRAIN Random Forest classifier model

      // Real-time scoring
      FOR each new file_write event:
        EXTRACT features (process_name, target_file_extension, etc.)
        SCORE event with trained model
        IF malicious_probability > 0.85:
          ALERT for analyst review