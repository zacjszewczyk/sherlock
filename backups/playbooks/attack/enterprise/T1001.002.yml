name: T1001.002: Steganography
id: a9b8c7d6-e5f4-4a3b-2c1d-0e9f8a7b6c5d
description: This playbook helps identify if an adversary is using steganography (T1001.002) for command and control (TA0011). It focuses on detecting steganographic activities by analyzing network traffic and endpoint data for indicators such as the presence of steganography tools, anomalous file characteristics (metadata, size, entropy), unusual network connections from unexpected processes, and statistical outliers in network traffic patterns.
type: technique
related:
- TA0011: Command and Control
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Are file hashes observed on the network or process hashes on endpoints matching known steganography tool executables, or are network connections being made to known steganography-based C2 infrastructure?
  context: This question aims to detect the presence of known steganography tools or connections to their associated command-and-control infrastructure. By continuously comparing file and process hashes against threat intelligence feeds, and monitoring network and DNS logs for connections to malicious IPs or domains, analysts can identify high-confidence indicators of steganographic activity. A match provides a direct link to a specific tool or threat actor.
  answer_sources:
  - Zeek files.log
  - Windows Event ID 4688
  - Zeek conn.log
  - Zeek dns.log
  - Internet Gateways
  - DNS Resolvers
  - Proxy Servers
  - Endpoints
  range: last 90 days
  queries:
  - pseudocode: SEARCH (file_hashes OR process_hashes OR destination_ips OR dns_queries) IN threat_intel_steganography_feed
- question: Are there any external network connections to destinations that are both rare for the organization and appear on suspicious activity watchlists?
  context: This question seeks to identify covert C2 channels by focusing on statistical anomalies. Adversaries may use domains or IPs that are not widely known as malicious but are also not typically accessed by the organization. By baselining connection frequency, analysts can flag rare destinations. When a rare destination also appears on a general threat intelligence watchlist, it significantly raises the suspicion level, suggesting a potential C2 channel.
  answer_sources:
  - Zeek conn.log
  - Internet Gateways
  - DNS Resolvers
  - Proxy Servers
  - Endpoints
  range: last 90 days
  queries:
  - pseudocode: 1. BASELINE connection frequency over 30 days. 2. FIND rare destinations (e.g., bottom 5th percentile). 3. CHECK if rare destinations are on CTI watchlists.
- question: Are any domains being requested that are classified as algorithmically generated (DGA) or malicious, especially if they are also receiving file uploads?
  context: This question leverages machine learning to identify suspicious domains that might be used for C2. A pre-trained model can classify domains as malicious based on characteristics like entropy and length. The rationale is that if a domain is flagged as malicious and is also observed receiving file uploads (correlated via network and file logs), it is a strong indicator of data exfiltration or C2 communication, potentially using steganography to hide the payload within the uploaded files.
  answer_sources:
  - Zeek dns.log
  - Zeek conn.log
  - Zeek files.log
  - Internet Gateways
  - DNS Resolvers
  - Proxy Servers
  - Endpoints
  range: last 90 days
  queries:
  - pseudocode: 1. CLASSIFY domains from dns.log with ML model. 2. IDENTIFY high-score malicious domains. 3. CORRELATE with file uploads to those domains.
- question: Do any transferred files contain byte sequences, metadata keywords, or header values that are known signatures of steganography tools?
  context: This question focuses on finding direct evidence of steganography within files themselves. Many steganography tools leave behind specific artifacts, such as keywords (e.g., 'Steg') in metadata or unique byte patterns (magic numbers) in the file structure. Using signature-based scanning tools like YARA on extracted file content allows for the direct detection of these known tool-specific watermarks, providing strong evidence of their use.
  answer_sources:
  - Zeek files.log
  - Network Security Monitoring (NSM) Sensor Grid
  - Internet Gateways
  - File Servers
  range: last 90 days
  queries:
  - pseudocode: SCAN extracted_file_content AND extracted_file_metadata WITH YARA_rules_for_steganography_tools.
- question: Are there any files with metadata fields that are statistical outliers in size compared to a baseline for their file type?
  context: This question aims to uncover steganography by looking for anomalies in file metadata. Adversaries can abuse legitimate metadata fields (e.g., 'comment' fields in images) to hide data, causing these fields to become unusually large. By establishing a baseline for normal metadata field sizes for various file types (like JPEG, PNG), analysts can flag files with outlier field lengths, which may indicate the presence of a hidden payload.
  answer_sources:
  - Zeek files.log
  - Network Security Monitoring (NSM) Sensor Grid
  - Internet Gateways
  - File Servers
  range: last 90 days
  queries:
  - pseudocode: 1. BASELINE metadata field lengths per file type. 2. FIND files where a metadata field's length is a statistical outlier (e.g., >99th percentile).
- question: Can a machine learning model classify any files as likely containing steganographic content based on their internal structure?
  context: This question applies machine learning to detect the subtle structural changes that steganographic algorithms introduce into files. A trained classifier can analyze features like the size and entropy of different data segments within a file (e.g., EXIF chunks in JPEGs). The model learns to distinguish between the complex patterns of benign files and those altered to hide data, providing a probabilistic assessment of whether a file contains a steganographic payload.
  answer_sources:
  - Zeek files.log
  - Network Security Monitoring (NSM) Sensor Grid
  - Internet Gateways
  - File Servers
  range: last 90 days
  queries:
  - pseudocode: 1. EXTRACT structural features from files. 2. FEED features into a trained steganalysis classifier. 3. ALERT on high-probability classifications.
- question: Are any highly standardized files, like icons, exceeding a pre-defined static size threshold?
  context: This question uses a simple but effective rule-based approach for specific file types. Some files, such as website favicons or application UI icons, have a highly predictable and small size. Any significant deviation from this expected size is extremely anomalous. Setting a hard-coded size limit (e.g., 100KB for a favicon) can be a high-fidelity method for detecting when these file types are being used as containers for steganographic data.
  answer_sources:
  - Zeek files.log
  - Internet Gateways
  - Web Application Servers
  - Content Delivery Networks (CDNs)
  range: last 90 days
  queries:
  - pseudocode: ALERT IF file_type = 'favicon.ico' AND file_size > 100KB.
- question: Are any transferred files statistical outliers in size when compared to a dynamic baseline for their specific MIME type?
  context: This question seeks to identify files that are anomalously large, which could indicate they are carrying a hidden steganographic payload. By maintaining a rolling 30-day baseline of file sizes for each MIME type, this method can statistically identify outliers. Using measures like Z-score or the Interquartile Range (IQR), any file that is significantly larger than its peers (e.g., Z-score > 3) is flagged for investigation.
  answer_sources:
  - Zeek files.log
  - Internet Gateways
  - Web Application Servers
  - Content Delivery Networks (CDNs)
  range: last 90 days
  queries:
  - pseudocode: 1. MAINTAIN rolling 30-day baseline of file sizes per MIME type. 2. CALCULATE Z-score for each new file. 3. ALERT if Z-score > 3.
- question: Is there an anomalous spike in the total data volume for a specific file type that cannot be explained by normal activity?
  context: This question looks for large-scale steganographic activity by analyzing aggregate traffic patterns. Instead of inspecting individual files, it models the total volume of data for specific file types (e.g., 'image/png') as a time series. A forecasting model predicts the expected volume with a confidence band. A significant, unexplained spike in traffic that exceeds this prediction could indicate a mass exfiltration or C2 campaign using steganography.
  answer_sources:
  - Zeek files.log
  - Internet Gateways
  - Web Application Servers
  - Content Delivery Networks (CDNs)
  range: last 90 days
  queries:
  - pseudocode: 1. MODEL aggregate data volume per file type. 2. FORECAST expected volume. 3. ALERT if actual volume significantly exceeds forecast.
- question: Is a process that is not on an approved whitelist making an outbound network connection?
  context: This question aims to detect when legitimate but unexpected processes are used for network communication, a common tactic for hiding C2 activity. By maintaining a whitelist of approved network-aware applications (e.g., web browsers, email clients), any connection from a process not on this list (e.g., mspaint.exe, notepad.exe) is flagged as highly suspicious and requires immediate investigation.
  answer_sources:
  - Windows Event ID 4688
  - Windows Event ID 5156
  - Sysmon Event ID 3
  - Zeek conn.log
  - User Workstations
  - Terminal Servers
  - Virtual Desktop Infrastructure (VDI) Environments
  range: last 90 days
  queries:
  - pseudocode: 1. CORRELATE process creation with network connection events. 2. CHECK if process path is in network_connection_whitelist. 3. ALERT if not in whitelist.
- question: Is an unusually rare process observed making a network connection, especially one involving a file transfer?
  context: This question provides a dynamic alternative to a static whitelist by focusing on statistical rarity. It involves baselining all processes that make network connections across the enterprise to determine their frequency. Network activity from a process that is very rarely seen making connections (e.g., 'calculator.exe') is inherently suspicious. This is especially true if the connection involves a file transfer, suggesting abuse of a legitimate tool for C2 or exfiltration.
  answer_sources:
  - Windows Event ID 4688
  - Windows Event ID 5156
  - Sysmon Event ID 3
  - Zeek conn.log
  - User Workstations
  - Terminal Servers
  - Virtual Desktop Infrastructure (VDI) Environments
  range: last 90 days
  queries:
  - pseudocode: 1. BASELINE frequency of network-connecting processes. 2. IDENTIFY rare processes (e.g., bottom 1st percentile). 3. ALERT on network activity from rare processes.
- question: Has an endpoint's behavior profile changed to an anomalous cluster characterized by unusual process-to-network activity?
  context: This question uses unsupervised machine learning to detect behavioral changes on an endpoint that may indicate compromise. Endpoints are clustered based on their typical process and network activity. If an endpoint suddenly moves from a 'normal' cluster to a new, sparsely populated one (e.g., a cluster where text editors make network connections), it signifies a significant behavioral deviation that is a strong indicator of malicious activity.
  answer_sources:
  - Windows Event ID 4688
  - Windows Event ID 5156
  - Sysmon Event ID 3
  - Zeek conn.log
  - User Workstations
  - Terminal Servers
  - Virtual Desktop Infrastructure (VDI) Environments
  range: last 90 days
  queries:
  - pseudocode: 1. CLUSTER endpoints based on process/network behavior vectors. 2. MONITOR for endpoints moving to anomalous clusters. 3. ALERT on cluster change.
- question: Does the least-significant bit (LSB) plane of a transferred image file contain an embedded file header?
  context: This question seeks definitive proof of LSB steganography by looking for embedded files. The technique involves extracting the data from the least-significant bits of an image's pixel values and scanning this data stream for known file signatures (magic numbers), such as 'PK' for a ZIP file or 'MZ' for an executable. Finding a complete file header within the LSBs is a conclusive sign that a file has been hidden inside the image.
  answer_sources:
  - Zeek files.log
  - Network Security Monitoring (NSM) Sensor Grid
  - Data Loss Prevention (DLP) Systems
  range: last 90 days
  queries:
  - pseudocode: 1. EXTRACT LSB plane from image file. 2. SCAN LSB data for known file headers. 3. ALERT on match.
- question: Does the least-significant bit (LSB) plane of an image file appear to be random or encrypted, as determined by a chi-square test?
  context: This question uses statistical analysis to detect encrypted payloads hidden with LSB steganography. The LSBs of natural, unaltered images have some degree of correlation, while encrypted data appears random. A chi-square goodness-of-fit test can determine if the byte distribution of the LSB plane is uniform (i.e., random-like). If the LSBs appear random while higher-order bit planes do not, it is a strong statistical indicator of an embedded encrypted payload.
  answer_sources:
  - Zeek files.log
  - Network Security Monitoring (NSM) Sensor Grid
  - Data Loss Prevention (DLP) Systems
  range: last 90 days
  queries:
  - pseudocode: 1. EXTRACT LSB plane from image. 2. PERFORM chi-square test for randomness. 3. ALERT if LSB plane appears random.
- question: Can a specialized steganalysis Convolutional Neural Network (CNN) classify a transferred image as containing steganographic content?
  context: This question applies an advanced deep learning model to detect steganography. Specialized CNNs can be trained to recognize the subtle, complex statistical artifacts and distortions in the pixel domain that are introduced by steganographic embedding algorithms. These patterns are often invisible to the human eye and simpler statistical methods. A high-confidence classification from a dedicated steganalysis CNN is a very strong indicator of compromise.
  answer_sources:
  - Zeek files.log
  - Network Security Monitoring (NSM) Sensor Grid
  - Data Loss Prevention (DLP) Systems
  range: last 90 days
  queries:
  - pseudocode: 1. PREPROCESS extracted image. 2. FEED image into pre-trained steganalysis CNN. 3. ALERT on high-confidence 'steganographic' classification.