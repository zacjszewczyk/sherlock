name: T1626: Abuse Elevation Control Mechanism
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: "This playbook investigates whether an adversary is abusing elevation control mechanisms to escalate privileges on managed mobile devices. The investigation focuses on identifying instances where an application is granted device administrator privileges and then exhibits suspicious characteristics. These include the application not being on a corporate allowlist, being statistically rare across the device fleet, or initiating network traffic that matches known malicious indicators or displays anomalous patterns (such as high-entropy DNS queries or unusual data volumes) shortly after the privilege grant."
type: technique
related:
  - TA0029: Privilege Escalation
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
investigative_questions:
  - question: "Is a 'Device Administrator Granted' event associated with an application that is not on the corporate allowlist?"
    context: "Adversaries may install or sideload malicious applications and trick users into granting them device administrator privileges. Checking if the application is on a pre-approved allowlist is a primary, high-confidence method for detecting unauthorized privilege escalation. A grant to an unlisted application should be considered a significant security event."
    answer_sources:
      - MDM Device Administrator Event Log
      - MDM Application Inventory Report
      - Corporate App Store Metadata
      - Centralized MDM/EMM log platform
      - Corporate Application Store database
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          ON 'Device Administrator Granted' event
          EXTRACT application_package_id
          LOOKUP application_package_id in corporate_app_allowlist
          IF NOT FOUND:
            ALERT severity=high, reason='Unapproved application granted admin privileges'
  - question: "Is a 'Device Administrator Granted' event associated with a statistically rare application across the mobile device fleet?"
    context: "Legitimate applications requiring administrative rights are typically well-known and widely deployed. Conversely, malicious or targeted tools used by adversaries are often unique or have very low installation counts. Identifying privilege grants to applications with a low prevalence (e.g., in the bottom 5th percentile) serves as a strong statistical indicator of potentially suspicious activity that warrants investigation."
    answer_sources:
      - MDM Device Administrator Event Log
      - MDM Application Inventory Report
      - Corporate App Store Metadata
      - Centralized MDM/EMM log platform
      - Corporate Application Store database
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          // Scheduled Job (e.g., daily)
          CALCULATE installation_count for each application across all devices
          STORE results in app_prevalence_table

          // Real-time rule
          ON 'Device Administrator Granted' event
          GET app_prevalence_score for the application
          IF app_prevalence_score < 5th_percentile:
            ALERT severity=medium, reason='Statistically rare application granted admin privileges'
  - question: "Does a machine learning model predict that a device administrator privilege grant is likely to be malicious?"
    context: "While single indicators like allowlist status or prevalence are useful, a machine learning model can combine multiple weaker signals into a single, high-confidence score. By analyzing features like application prevalence, age, requested permissions, and certificate reputation, the model can identify complex patterns that are indicative of malicious intent, allowing for more accurate and automated threat detection."
    answer_sources:
      - MDM Device Administrator Event Log
      - MDM Application Inventory Report
      - Corporate App Store Metadata
      - Centralized MDM/EMM log platform
      - Corporate Application Store database
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          ON 'Device Administrator Granted' event
          GATHER features: prevalence, app_age, permissions, cert_reputation, install_source
          SCORE event with trained logistic regression model
          IF predicted_malicious_probability > 0.85:
            CREATE incident_ticket, priority=high, assignee=SOC_Tier2
  - question: "Following a 'Device Administrator Granted' event, does the associated device's network traffic match a known malicious indicator?"
    context: "A common post-escalation action for an adversary is to establish command and control (C2) communication. By correlating a privilege grant event with network logs in the immediate aftermath (e.g., within 5 minutes), we can look for connections to known malicious IPs or domains from threat intelligence feeds. A match provides a very strong signal that the device has been compromised."
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - MDM Device Administrator Event Log
      - Network TAPs or switch SPAN ports feeding Zeek sensors at the network egress
      - Centralized DNS server logs
      - Centralized MDM/EMM log platform
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          ON 'Device Administrator Granted' event
          GET device_ip, event_time
          SEARCH network_logs where src_ip = device_ip AND time BETWEEN event_time AND event_time + 5 minutes
          COMPARE destination_ip and dns_query against threat_intelligence_feed
          IF MATCH:
            ALERT severity=critical, reason='Post-privilege-grant communication to known malicious indicator'
  - question: "Following a 'Device Administrator Granted' event, does the device's network traffic exhibit statistical anomalies like high-entropy DNS queries or unusual data volumes?"
    context: "Adversaries may use techniques to evade IOC-based detection, such as Domain Generation Algorithms (DGA) for C2 or data exfiltration. High-entropy DNS queries are a hallmark of DGA. Similarly, a sudden spike in outbound data volume can indicate data theft. Monitoring for these statistical anomalies after a privilege grant can help detect malicious activity even when no known bad indicators are involved."
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - MDM Device Administrator Event Log
      - Network TAPs or switch SPAN ports feeding Zeek sensors at the network egress
      - Centralized DNS server logs
      - Centralized MDM/EMM log platform
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          ON 'Device Administrator Granted' event
          GET device_ip, event_time
          // Check for DGA
          CALCULATE Shannon_entropy for DNS queries from device_ip within 5 minutes post-event
          IF average_entropy > 4.5:
            ALERT severity=high, reason='Potential DGA activity detected post-privilege-grant'
          // Check for data exfil
          CALCULATE sum(outbound_bytes) from device_ip within 5 minutes post-event
          IF sum(outbound_bytes) > 99th_percentile_of_device_30day_baseline:
            ALERT severity=high, reason='Anomalous data volume detected post-privilege-grant'
  - question: "Following a 'Device Administrator Granted' event, does an ML-based anomaly detection model flag the device's network behavior as abnormal?"
    context: "Sophisticated adversaries may use novel C2 techniques that evade both IOC and simple statistical detection. A machine learning model, such as an LSTM autoencoder, can learn a device's normal network behavior baseline. After a privilege grant, the model can detect subtle deviations from this baseline across multiple metrics (e.g., connection rate, payload sizes), flagging the activity as anomalous with high confidence, indicating potential C2 activity."
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - MDM Device Administrator Event Log
      - Network TAPs or switch SPAN ports feeding Zeek sensors at the network egress
      - Centralized DNS server logs
      - Centralized MDM/EMM log platform
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          ON 'Device Administrator Granted' event
          GET device_ip, event_time
          COLLECT network_telemetry_timeseries for 10 minutes post-event
          FEED telemetry to device's trained LSTM autoencoder model
          CALCULATE reconstruction_error
          IF reconstruction_error > (mean_error + 3 * std_dev_error):
            ALERT severity=high, reason='ML model detected network anomaly post-privilege-grant'