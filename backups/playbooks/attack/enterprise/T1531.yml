name: T1531: Account Access Removal
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps investigate whether an adversary has attempted to remove user account access (MITRE ATT&CK T1531). It provides questions and queries to detect this activity by monitoring for account modifications from known malicious entities, suspicious command-line usage, anomalous volumes of account deletion or lockout events, behavioral deviations from established user or system baselines, and temporal correlations between account modifications and subsequent authentication failures.
type: technique
related:
- TA0040: Impact
contributors:
- Zachary Szewczyk
- Ask Sage, Inc.
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Are account modification events being initiated by known suspicious or compromised users or hosts?
  context: This question aims to detect if entities already identified as threats (e.g., users or IPs on a watchlist) are performing sensitive account modifications. A match provides a strong signal that an adversary is leveraging compromised access to disrupt or deny access to legitimate users.
  answer_sources:
  - Windows Event ID 4723
  - Windows Event ID 4724
  - Windows Event ID 4726
  - Windows Event ID 4738
  - Windows Event ID 4740
  - Domain Controllers
  - Active Directory Federation Services (ADFS) Servers
  - Member Servers
  - User Workstations
  range: last 90 days
  queries:
  - pseudocode: SEARCH account_modification_events WHERE (user IN watchlist OR source_ip IN watchlist)
- question: Can we risk-score account modification events from watchlisted entities to prioritize the most critical threats?
  context: This question focuses on prioritizing alerts by scoring them based on the type of action (e.g., deletion is higher risk than a password change) and the historical frequency of that action. It helps analysts focus on rare, high-impact events that are more likely to be malicious.
  answer_sources:
  - Windows Event ID 4723
  - Windows Event ID 4724
  - Windows Event ID 4726
  - Windows Event ID 4738
  - Windows Event ID 4740
  - Domain Controllers
  - Active Directory Federation Services (ADFS) Servers
  - Member Servers
  - User Workstations
  range: last 90 days
  queries:
  - pseudocode: SEARCH account_modification_events | JOIN watchlist | CALCULATE risk_score based on event_type, frequency | FILTER risk_score > threshold
- question: Can a machine learning model predict whether an account modification is malicious based on its attributes?
  context: This question explores using a predictive model to identify malicious account modifications. By training on features like whether the source is on a watchlist, the type of modification, and the target account's privilege level, the model can learn complex patterns and detect malicious activity with a high degree of confidence.
  answer_sources:
  - Windows Event ID 4723
  - Windows Event ID 4724
  - Windows Event ID 4726
  - Windows Event ID 4738
  - Windows Event ID 4740
  - Domain Controllers
  - Active Directory Federation Services (ADFS) Servers
  - Member Servers
  - User Workstations
  range: last 90 days
  queries:
  - pseudocode: INPUT account_modification_events | APPLY ML_model (features: source_on_watchlist, mod_type, target_privilege, time_of_day) | FILTER prediction_probability > 0.9
- question: Is an adversary using command-line tools or scripts to remove or disable accounts?
  context: This question seeks to directly detect the execution of commands commonly used for account access removal, such as `net user`, `dsmod`, `Remove-LocalUser`, and `Disable-ADAccount`. Monitoring for these specific command strings and patterns in process and script logs is a direct way to identify malicious intent.
  answer_sources:
  - Windows Event ID 4688
  - Windows PowerShell Event ID 4104
  - Domain Controllers
  - Privileged Access Workstations (PAWs)
  - Management Servers
  - User Workstations
  - Exchange Servers
  range: last 90 days
  queries:
  - pseudocode: SEARCH process_creation_events OR powershell_script_logs WHERE command_line MATCHES regex('net user .* /del', 'dsmod .* -disabled yes', etc.)
- question: Are account management commands being spawned by unusual parent processes?
  context: Legitimate administrative commands are typically spawned by predictable parent processes. This question aims to find anomalies where these commands are executed by unusual parents, such as a web server process (`w3wp.exe`), which is a strong indicator of lateral movement and malicious execution.
  answer_sources:
  - Windows Event ID 4688
  - Windows PowerShell Event ID 4104
  - Domain Controllers
  - Privileged Access Workstations (PAWs)
  - Management Servers
  - User Workstations
  - Exchange Servers
  range: last 90 days
  queries:
  - pseudocode: SEARCH process_creation_events with account_management_commands | CALCULATE parent_process_frequency | FILTER parent_process_frequency < 5th_percentile
- question: Can a machine learning model classify command-line intent to detect obfuscated or novel account removal commands?
  context: Adversaries may obfuscate commands to evade simple regex-based detection. This question proposes using Natural Language Processing (NLP) to analyze the command's structure and arguments, allowing the model to understand the intent of the command rather than just matching keywords, providing a more resilient detection method.
  answer_sources:
  - Windows Event ID 4688
  - Windows PowerShell Event ID 4104
  - Domain Controllers
  - Privileged Access Workstations (PAWs)
  - Management Servers
  - User Workstations
  - Exchange Servers
  range: last 90 days
  queries:
  - pseudocode: INPUT command_line_data | APPLY NLP_classifier_model | FILTER classification == 'Malicious Account Removal'
- question: Has there been a mass account deletion or lockout event within a short time frame?
  context: This question uses a simple, high-confidence threshold to detect brute-force or widespread impact attacks. A sudden spike in account deletions or lockouts affecting multiple distinct users in a small time window is a clear indicator of a coordinated, malicious campaign.
  answer_sources:
  - Windows Event ID 4726
  - Windows Event ID 4738
  - Windows Event ID 4740
  - Domain Controllers
  - Centralized Log Aggregator (SIEM)
  - Active Directory Servers
  range: last 90 days
  queries:
  - pseudocode: SEARCH events (4726, 4740) | COUNT distinct_users in 10_min_window | FILTER (event=4726 AND user_count > 5) OR (event=4740 AND user_count > 50)
- question: Does the current rate of account deletions, disablements, or lockouts significantly deviate from the statistical norm?
  context: This question moves beyond fixed thresholds to a dynamic, statistical approach. By calculating a rolling average and standard deviation, the system can automatically adjust to normal business rhythms. An alert is triggered only for statistically significant spikes, reducing false positives from normal fluctuations.
  answer_sources:
  - Windows Event ID 4726
  - Windows Event ID 4738
  - Windows Event ID 4740
  - Domain Controllers
  - Centralized Log Aggregator (SIEM)
  - Active Directory Servers
  range: last 90 days
  queries:
  - pseudocode: TIMESERIES event_counts (4726, 4738, 4740) | CALCULATE rolling_avg, rolling_stddev | FILTER current_count > (rolling_avg + 3 * rolling_stddev)
- question: Can a machine learning model detect anomalous spikes in account modification events by learning historical patterns?
  context: This question proposes a more sophisticated time-series model (like an LSTM Autoencoder) that can learn complex seasonal patterns in event volumes. The model predicts the 'expected' volume for any given time. When the actual observed volume significantly differs from the prediction, it signals an anomaly.
  answer_sources:
  - Windows Event ID 4726
  - Windows Event ID 4738
  - Windows Event ID 4740
  - Domain Controllers
  - Centralized Log Aggregator (SIEM)
  - Active Directory Servers
  range: last 90 days
  queries:
  - pseudocode: INPUT time_series_event_counts | APPLY LSTM_autoencoder_model | CALCULATE reconstruction_error | FILTER error > anomaly_threshold
- question: Was a sensitive account modification performed by an unauthorized user or from an unapproved location?
  context: This question enforces policy-based rules. Certain powerful actions should only be performed by specific, authorized administrator accounts from designated management workstations. Any deviation is a high-fidelity indicator of a policy violation or compromise.
  answer_sources:
  - Windows Event ID 4723
  - Windows Event ID 4724
  - Windows Event ID 4726
  - Windows Event ID 4738
  - Zeek conn.log
  - Domain Controllers
  - VPN Concentrators
  - Management Servers
  - Cloud Identity and Access Management (IAM) Systems
  - DNS Servers
  range: last 90 days
  queries:
  - pseudocode: SEARCH account_modification_events WHERE (user NOT IN admin_list) OR (user IN service_account_list) OR (source_ip NOT IN management_subnets)
- question: Does a recent account modification event deviate from the performing user's established behavioral profile?
  context: This question focuses on user-specific behavioral analytics. It establishes a baseline of 'normal' for each user. An action that deviates significantly from this personal baseline (e.g., an admin working at 3 AM from a new country) is highly suspicious.
  answer_sources:
  - Windows Event ID 4723
  - Windows Event ID 4724
  - Windows Event ID 4726
  - Windows Event ID 4738
  - Zeek conn.log
  - Domain Controllers
  - VPN Concentrators
  - Management Servers
  - Cloud Identity and Access Management (IAM) Systems
  - DNS Servers
  range: last 90 days
  queries:
  - pseudocode: SEARCH account_modification_events | COMPARE_with user_profile (hours, subnets, ASN) | CALCULATE deviation_score | FILTER score > threshold
- question: Can an unsupervised machine learning model identify anomalous account modification events that don't fit normal patterns?
  context: This question uses clustering algorithms to find 'outliers' without pre-defined rules. The model groups historical events, and legitimate activities form dense clusters. Any event that falls outside of these clusters is flagged as an anomaly, potentially representing a novel attack technique.
  answer_sources:
  - Windows Event ID 4723
  - Windows Event ID 4724
  - Windows Event ID 4726
  - Windows Event ID 4738
  - Zeek conn.log
  - Domain Controllers
  - VPN Concentrators
  - Management Servers
  - Cloud Identity and Access Management (IAM) Systems
  - DNS Servers
  range: last 90 days
  queries:
  - pseudocode: INPUT historical_account_modification_events | APPLY clustering_model (DBSCAN, Isolation Forest) | IDENTIFY outliers/noise_points
- question: Is there a spike in authentication failures for a specific user immediately after their account was modified or deleted?
  context: This question looks for the immediate impact of an account modification. A malicious password reset would logically be followed by the legitimate user being unable to log in. Correlating the modification event with subsequent failures for the same user provides strong evidence of malicious impact.
  answer_sources:
  - Windows Event ID 4625
  - Windows Event ID 4771
  - Windows Event ID 4724
  - Windows Event ID 4726
  - Zeek conn.log
  - Zeek rdp.log
  - Zeek smb_mapping.log
  - Domain Controllers
  - Network TAPs/SPANs monitoring server segments
  - Application Servers
  - File Servers
  - VPN Gateways
  range: last 90 days
  queries:
  - pseudocode: ON event (4726 or 4724) for user X, START_MONITORING | COUNT auth_failures (4625, 4771) for user X in next 15_mins | ALERT if count > 3
- question: Is there a widespread pattern of users having their accounts modified and then immediately experiencing login failures?
  context: This question scales the previous one to detect large-scale attacks. It looks for the number of users who fit the 'modification followed by failure' pattern across the enterprise. A high count of such users within a short interval would indicate a coordinated, widespread campaign.
  answer_sources:
  - Windows Event ID 4625
  - Windows Event ID 4771
  - Windows Event ID 4724
  - Windows Event ID 4726
  - Zeek conn.log
  - Zeek rdp.log
  - Zeek smb_mapping.log
  - Domain Controllers
  - Network TAPs/SPANs monitoring server segments
  - Application Servers
  - File Servers
  - VPN Gateways
  range: last 90 days
  queries:
  - pseudocode: SEARCH for users with (event 4724/4726/4738) AND (event 4625/4771) in 1_min_interval | COUNT distinct_users | ALERT if count > 99th_percentile_of_baseline
- question: Can we automatically discover suspicious sequences of events, such as account modification followed by authentication failure, that indicate an attack?
  context: This question proposes using advanced analytics to automatically discover common event sequences. The system can learn that the pattern `(Event 4724: User A) -> (Event 4625: User A)` is a frequent, suspicious sequence, allowing for the creation of dynamic, data-driven detection rules for multi-step attacks.
  answer_sources:
  - Windows Event ID 4625
  - Windows Event ID 4771
  - Windows Event ID 4724
  - Windows Event ID 4726
  - Zeek conn.log
  - Zeek rdp.log
  - Zeek smb_mapping.log
  - Domain Controllers
  - Network TAPs/SPANs monitoring server segments
  - Application Servers
  - File Servers
  - VPN Gateways
  range: last 90 days
  queries:
  - pseudocode: INPUT event_logs | APPLY sequence_pattern_mining_algorithm | IDENTIFY frequent_patterns like '(mod_event)->(fail_event)'