name: T1642: Endpoint Denial of Service
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: |
  This playbook addresses the threat of an adversary performing an Endpoint Denial of Service (DoS) attack against a mobile device. It provides investigative steps to detect such attacks by monitoring for various indicators of compromise. These include observing network connections from mobile devices to known malware C2 infrastructure with DoS capabilities; detecting bursts of DGA-like DNS queries followed by a sudden cessation of all network traffic; identifying connections to known rooting or jailbreaking sites or the use of statistically rare User-Agent strings; and analyzing Mobile Device Management (MDM) logs for unauthorized granting of Device Administrator privileges or the installation of unexpected configuration profiles. The goal is to identify compromised or vulnerable devices before, during, or after a DoS event.
type: technique
related:
- TA0034: Impact
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Have any mobile devices connected to known malicious infrastructure associated with Endpoint DoS malware?
  context: |
    This question aims to detect direct communication from a managed mobile device to command-and-control (C2) servers known to be part of malware campaigns with Endpoint Denial of Service capabilities, like KeyRaider. By correlating network connection logs with threat intelligence, we can identify compromised devices before they are fully disabled or used in an attack. A positive match is a high-fidelity indicator of a severe compromise.
  answer_sources:
  - Zeek intel.log
  - Zeek conn.log
  - MDM Logs
  - Corporate and Guest Wi-Fi network gateways
  - VPN concentrators
  - DNS resolvers
  - Mobile Device Management (MDM) platform
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      SEARCH Zeek intel.log AND conn.log WHERE intel.log.seen_where IN ('Conn::IN_ORIG', 'DNS::IN_QUERY') AND conn.log.src_ip IN (mobile_ip_range) AND intel.log.meta_source CONTAINS ('mobile_malware', 'KeyRaider', 'T1642')
- question: Are mobile devices connecting to new or unusual Autonomous System Numbers (ASNs) that deviate from their normal behavior?
  context: |
    This question seeks to identify anomalous network behavior by baselining the typical ASNs a device connects to. A connection to a completely new ASN for that device could indicate a compromise, redirection to a malicious server, or the initial stages of a DoS attack. Enriching this with reputation data and comparing connection volume to peer groups helps prioritize potentially malicious deviations over benign new connections.
  answer_sources:
  - Zeek intel.log
  - Zeek conn.log
  - MDM Logs
  - Corporate and Guest Wi-Fi network gateways
  - VPN concentrators
  - DNS resolvers
  - Mobile Device Management (MDM) platform
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      BASELINE device connections over 30 days by destination ASN. ALERT when new connection has an ASN not in baseline. ENRICH ASN with reputation. ELEVATE if malicious and connection count > 99th percentile of peer group.
- question: Can a machine learning model identify high-risk network connections from mobile devices indicative of a potential DoS attack in real-time?
  context: |
    This question involves using a supervised machine learning model to proactively score the risk of individual network connections. By analyzing a rich set of features like connection duration, bytes transferred, protocol, and enriched data like destination reputation, the model can detect subtle patterns of malicious activity that might be missed by simple rule-based alerts. A sustained high-risk score can trigger automated responses, such as querying the MDM for device details, enabling a faster incident response cycle.
  answer_sources:
  - Zeek intel.log
  - Zeek conn.log
  - MDM Logs
  - Corporate and Guest Wi-Fi network gateways
  - VPN concentrators
  - DNS resolvers
  - Mobile Device Management (MDM) platform
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      FOR each mobile device connection in Zeek conn.log, CALCULATE risk_score using ML model. IF risk_score > 0.9 for > 3 consecutive connections, TRIGGER SOAR playbook to query MDM for device info.
- question: Have any mobile devices attempted to resolve a newly registered domain and then subsequently ceased all network activity?
  context: |
    This question aims to detect a common pattern in DoS attacks where a compromised device communicates with a newly created, disposable domain (often used for C2) and is then instructed to disable its networking capabilities or is remotely bricked. The combination of a "newly seen" domain and a sudden stop in traffic is a strong indicator of a successful Endpoint DoS attack.
  answer_sources:
  - Zeek dns.log
  - Zeek conn.log
  - Internal DNS resolvers
  - network traffic monitoring points at internet gateways
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      SEARCH Zeek dns.log for queries from mobile IPs. IF domain_registration_age < 3 days AND no traffic from source IP in conn.log for next 15 minutes, ALERT.
- question: Are mobile devices exhibiting bursts of DGA-like DNS activity followed by an unusually long period of network silence?
  context: |
    This question looks for two related indicators of compromise. First, a high volume of DNS queries with high entropy suggests the use of a Domain Generation Algorithm (DGA) to locate a C2 server. Second, an abnormally long offline period immediately following this activity suggests the device may have been disabled as part of an Endpoint DoS attack. Correlating these two events provides a strong signal of malicious activity.
  answer_sources:
  - Zeek dns.log
  - Zeek conn.log
  - Internal DNS resolvers
  - network traffic monitoring points at internet gateways
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      STREAM Zeek dns.log. For each mobile IP, IF count(queries with entropy > 3.5) in 5 min > 5, FLAG 'Potential DGA'. THEN check conn.log. IF time since last connection > 95th percentile for device, ALERT 'Potential Endpoint DoS'.
- question: Can a time-series anomaly detection model detect significant deviations in a mobile device's network behavior, such as a sudden cessation of traffic, that might indicate an Endpoint DoS event?
  context: |
    This question leverages advanced anomaly detection to identify when a device's network traffic pattern abruptly and significantly changes from its learned baseline. A sudden drop to zero activity, represented by a high reconstruction error in an LSTM autoencoder model, is a key indicator of an Endpoint DoS. Correlating this network anomaly with preceding suspicious activity, like DGA queries, greatly increases the confidence that the event is malicious.
  answer_sources:
  - Zeek dns.log
  - Zeek conn.log
  - Internal DNS resolvers
  - network traffic monitoring points at internet gateways
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      MODEL network traffic metrics (count, bytes, unique IPs) per device using LSTM. ALERT if reconstruction error > 3 std dev. ELEVATE if anomaly is drop to zero AND preceded by 'Potential DGA Activity' flag in last 30 mins.
- question: Are any mobile devices communicating with infrastructure known to be associated with rooting or jailbreaking tools?
  context: |
    This question aims to detect if a device is attempting to or has already been jailbroken or rooted, which is often a prerequisite for installing malware capable of causing an Endpoint DoS. By monitoring for connections to known rooting/jailbreaking sites and automatically checking the device's compliance status in the MDM, security teams can quickly identify devices that have had their security controls bypassed.
  answer_sources:
  - Zeek dns.log
  - Zeek http.log
  - Zeek intel.log
  - MDM Logs
  - Corporate Wi-Fi access points
  - VPN concentrators
  - web proxies
  - Mobile Device Management (MDM) platform
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      SEARCH Zeek intel.log for matches to jailbreak/rooting threat intel from mobile IP range. ON a match, ALERT and trigger automated query to MDM API for device compliance status.
- question: Are any mobile devices using rare or anomalous User-Agent strings compared to their peers?
  context: |
    This question seeks to identify outlier devices based on their HTTP User-Agent string. A User-Agent that is statistically rare (<1% prevalence) among devices with the same operating system can indicate the use of non-standard browsers, custom applications used for malicious purposes (like jailbreaking), or malware attempting to impersonate legitimate traffic. This provides a valuable clue for identifying compromised or non-compliant devices.
  answer_sources:
  - Zeek dns.log
  - Zeek http.log
  - Zeek intel.log
  - MDM Logs
  - Corporate Wi-Fi access points
  - VPN concentrators
  - web proxies
  - Mobile Device Management (MDM) platform
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      BATCH JOB daily: Aggregate User-Agent strings from Zeek http.log by OS. Calculate frequency for each string. ALERT if a device reports a User-Agent with < 1% frequency within its OS group.
- question: Can unsupervised machine learning identify mobile devices with anomalous 24-hour network behavior profiles that might indicate compromise?
  context: |
    This question uses unsupervised clustering (like DBSCAN) to find devices that "don't look like the others" based on a full day's worth of network activity. By creating a multi-dimensional profile (e.g., ports used, protocol ratios, data volume), the algorithm can flag outliers that deviate from established clusters of normal behavior. Cross-referencing these anomalous devices with their MDM compliance status (e.g., 'rooted' or 'jailbroken') helps to confirm if the anomaly is security-relevant.
  answer_sources:
  - Zeek dns.log
  - Zeek http.log
  - Zeek intel.log
  - MDM Logs
  - Corporate Wi-Fi access points
  - VPN concentrators
  - web proxies
  - Mobile Device Management (MDM) platform
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      CLUSTER 24-hour device network profiles (ports, protocol ratio, data volume) using DBSCAN. IDENTIFY outliers. CROSS-REFERENCE outliers with MDM data for jailbroken/rooted status. ALERT on match.
- question: Has an unapproved application been granted Device Administrator privileges or has an unexpected configuration profile been installed on a mobile device?
  context: |
    This question directly queries MDM logs for high-risk configuration changes that could enable an Endpoint DoS attack. Gaining Device Administrator rights on Android or installing a malicious profile on iOS gives an application deep control over the device. Alerting when such an event occurs for an application or profile that is not on the enterprise allowlist is a critical, high-fidelity detection for a potential compromise.
  answer_sources:
  - MDM Logs
  - SIEM Logs
  - Mobile Device Management (MDM) platform
  - Enterprise Mobility Management (EMM) server logs
  - SIEM
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      SEARCH MDM logs in SIEM for 'Device Administrator Granted' or 'Profile Installed' events. IF app_name or profile_signer NOT IN allowlist, trigger high-priority ALERT with device details.
- question: Is any mobile device experiencing an abnormally high rate of application installations or profile modifications compared to its own history and its peer group?
  context: |
    This question aims to detect an unusual velocity of configuration changes on a device, which could be indicative of an automated malicious script or a user rapidly installing unauthorized software. By comparing the rate of change to both the device's own baseline and the baseline of its peer group, the system can more accurately distinguish between a "power user" and a genuinely anomalous, potentially malicious, event.
  answer_sources:
  - MDM Logs
  - SIEM Logs
  - Mobile Device Management (MDM) platform
  - Enterprise Mobility Management (EMM) server logs
  - SIEM
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      BASELINE daily rate of app installs/profile changes per device and per peer group. ALERT if a device's daily rate > 99th percentile of its own history AND > 99th percentile of its peer group.
- question: Can a machine learning model assess the risk of newly installed mobile applications and trigger an automated response for high-risk installations?
  context: |
    This question focuses on proactively assessing the risk of new software on mobile devices using a classification model. By analyzing features like permissions requested, application source, and developer reputation, the model can identify potentially malicious apps at the time of installation. A 'high risk' score can automatically trigger a SOAR playbook to quarantine the device via the MDM, preventing a potential threat from being realized.
  answer_sources:
  - MDM Logs
  - SIEM Logs
  - Mobile Device Management (MDM) platform
  - Enterprise Mobility Management (EMM) server logs
  - SIEM
  range: Last 90 days
  queries:
  - search_technology: Pseudocode
    query: |
      FOR each new app install in MDM logs, CALCULATE risk score with ML model. IF score is 'high risk', TRIGGER automated device quarantine via MDM API and create incident ticket.