name: T1629: Impair Defenses
id: a6f5e7b1-2c3d-4e5f-b6a7-8c9d0e1f2a3b
description: This playbook helps investigate whether an adversary is attempting to impair or disable security defenses on mobile devices. This is achieved by looking for three main categories of evidence: 1) Managed devices failing to check in with the Mobile Device Management (MDM) server, which may indicate the agent has been disabled. 2) Network traffic analysis showing connections to known malicious infrastructure or downloads of known mobile malware, suggesting the device has been compromised. 3) Direct alerts from MDM or Mobile Threat Defense (MTD) platforms indicating explicit tampering, such as terminating security processes, modifying security configurations, or granting high-risk permissions without authorization.
type: technique
related:
  - TA0030: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has a managed mobile device failed its expected MDM check-in without a corresponding authorized administrative action?
    context: This question aims to detect devices that have unexpectedly stopped communicating with the Mobile Device Management (MDM) server. A missed check-in could indicate that the device has been powered off, lost connectivity, or, more critically, that the MDM agent has been tampered with or disabled by an adversary to evade monitoring and control. By cross-referencing with administrative logs for authorized actions like 'unenroll' or 'wipe', we can filter out legitimate events and focus on potentially compromised devices.
    answer_sources:
      - Zeek conn.log
      - MDM Server Logs
      - MTD Server Logs
      - Organization's internet gateway, Wi-Fi network infrastructure, and MDM/MTD Management Servers
    range: Last 90 days
    queries:
      - technology: Pseudocode
        query: |
          Search: SIEM
          Query: IF (device_id NOT IN mdm_checkin_logs within expected_interval) AND (device_id NOT IN mdm_audit_logs with event IN ['unenroll', 'wipe', 'decommission'] within +/- 15 mins of missed checkin) THEN ALERT.
  - question: Is any managed device's time since last MDM check-in significantly longer than its historical baseline?
    context: This question identifies anomalous delays in MDM check-ins by establishing a unique, dynamic baseline for each device. Rather than a static threshold for all devices, this approach calculates the 99th percentile of check-in intervals for each specific device over a 30-day period. Exceeding this personal baseline is a strong indicator of a deviation from normal behavior, warranting investigation for potential agent tampering or connectivity issues.
    answer_sources:
      - Zeek conn.log
      - MDM Server Logs
      - MTD Server Logs
      - Organization's internet gateway, Wi-Fi network infrastructure, and MDM/MTD Management Servers
    range: Last 90 days
    queries:
      - technology: Pseudocode
        query: |
          Search: SIEM/Data Lake
          Query: FOR EACH device_id, CALCULATE baseline = 99th_percentile(checkin_interval) over last 30 days. IF (current_time - last_checkin_time > baseline) THEN ALERT.
  - question: Has a device failed to check in within the time frame predicted by a forecasting model?
    context: This question uses a more sophisticated, predictive approach to detect missed check-ins. A time-series forecasting model (like ARIMA) learns the specific rhythm and pattern of each device's check-in history. It then predicts a window for the next expected check-in. A failure to check in within this predicted window (e.g., a 95% prediction interval) is a high-fidelity anomaly signal, suggesting a significant and unexpected disruption that could be malicious.
    answer_sources:
      - Zeek conn.log
      - MDM Server Logs
      - MTD Server Logs
      - Organization's internet gateway, Wi-Fi network infrastructure, and MDM/MTD Management Servers
    range: Last 90 days
    queries:
      - technology: Pseudocode
        query: |
          Search: Machine Learning Platform
          Query: FOR EACH device_id, TRAIN model on historical checkin_timestamps. PREDICT next_checkin_window. IF (actual_checkin NOT IN next_checkin_window) THEN ALERT.
  - question: Is a mobile device communicating with known malicious domains or downloading known malware?
    context: This question seeks to identify direct evidence of compromise by matching network activity against curated threat intelligence. By monitoring DNS queries, TLS SNI values, and file hashes from network traffic (via Zeek logs) and comparing them to a list of known indicators associated with mobile malware, spyware, and rooting kits, we can quickly detect high-confidence threats.
    answer_sources:
      - Zeek dns.log
      - Zeek ssl.log
      - Zeek http.log
      - Zeek files.log
      - Organization's internet gateway and Wi-Fi network infrastructure
    range: Last 90 days
    queries:
      - technology: Pseudocode
        query: |
          Search: SIEM
          Query: JOIN (zeek_dns.query, zeek_ssl.server_name, zeek_files.hash) WITH mobile_threat_intel_list.indicator. IF match THEN ALERT.
  - question: Is a mobile device exhibiting a rare User-Agent string combined with high-entropy DNS queries?
    context: This question looks for a combination of two suspicious, but not definitively malicious, network behaviors. A rare User-Agent can indicate custom, non-standard client software, which is common for malware. High-entropy DNS queries are often used by malware employing Domain Generation Algorithms (DGAs) to find C2 servers. The combination of both behaviors within a short time frame for a single device provides a stronger signal of potential malicious activity than either indicator alone.
    answer_sources:
      - Zeek dns.log
      - Zeek ssl.log
      - Zeek http.log
      - Zeek files.log
      - Organization's internet gateway and Wi-Fi network infrastructure
    range: Last 90 days
    queries:
      - technology: Pseudocode
        query: |
          Search: SIEM/Data Lake
          Query: CALCULATE user_agent_rarity < 1% AND CALCULATE shannon_entropy(dns_query) > 4.0. IF both conditions true for same device_ip within 5 mins THEN ALERT.
  - question: Does a mobile device's network connection score as highly malicious based on a machine learning model?
    context: This question leverages a supervised machine learning model to provide a holistic assessment of a network connection's likelihood of being malicious. By training a model (e.g., Random Forest) on a rich set of features from Zeek logs—such as connection duration, bytes transferred, JA3/JA3S hashes, and domain name entropy—the system can identify complex patterns indicative of malicious behavior that might be missed by simple rules. A score exceeding a calibrated threshold indicates a high-probability threat that requires immediate investigation.
    answer_sources:
      - Zeek dns.log
      - Zeek ssl.log
      - Zeek http.log
      - Zeek files.log
      - Organization's internet gateway and Wi-Fi network infrastructure
    range: Last 90 days
    queries:
      - technology: Pseudocode
        query: |
          Search: Machine Learning Platform
          Query: FOR EACH network_connection, GENERATE features (duration, bytes, JA3, etc.). SCORE connection with trained_model. IF score > 0.90 THEN ALERT.
  - question: Has an MDM or MTD platform logged a critical security event without an associated authorized change request?
    context: This question focuses on explicit, high-severity events reported directly by endpoint security agents, such as the termination of a security process, disabling of a key protection feature like Google Play Protect, or the granting of Device Administrator rights. To reduce false positives, the playbook requires checking against the IT change management system. An alert is only generated if no corresponding authorized change ticket exists, indicating a likely unauthorized and malicious action.
    answer_sources:
      - Mobile Threat Defense (MTD) Agent Logs
      - Mobile Device Management (MDM) Compliance Logs
      - IT Change Management System Logs
      - Managed mobile device endpoints and MDM/MTD Management Servers
    range: Last 90 days
    queries:
      - technology: Pseudocode
        query: |
          Search: SIEM
          Query: ON critical_mdm_mtd_event (e.g., 'Agent Terminated'), QUERY change_management_system for authorizing ticket for device_id in last 24h. IF no ticket found THEN ALERT.
  - question: Is a user or device generating a statistically anomalous number of security or compliance alerts compared to their peers?
    context: This question aims to identify outliers by comparing the behavior of a user or device against their peer group. By establishing a baseline rate of security events (like compliance violations) for different roles (e.g., Developers, Sales), we can detect when an individual's activity deviates significantly (e.g., exceeds three standard deviations) from their group's norm. This can surface compromised accounts or users engaging in unusually risky behavior that might otherwise go unnoticed.
    answer_sources:
      - Mobile Threat Defense (MTD) Agent Logs
      - Mobile Device Management (MDM) Compliance Logs
      - IT Change Management System Logs
      - Managed mobile device endpoints and MDM/MTD Management Servers
    range: Last 90 days
    queries:
      - technology: Pseudocode
        query: |
          Search: SIEM/Data Lake
          Query: FOR EACH user_role, CALCULATE baseline = mean + 3*stddev of event_count over last 30 days. FOR EACH user, IF event_count in last 24h > baseline for their role THEN ALERT.
  - question: Has a UEBA platform detected an anomalous sequence of events for a user or device?
    context: This question uses advanced sequence analysis to detect suspicious chains of events that, in isolation, might not be alarming. A UEBA platform with a model like an LSTM autoencoder can learn the 'normal' sequences of activity for users and devices. It can then flag unusual sequences—such as a login from a new country, followed by an app install from an unknown source, culminating in a grant of high-risk permissions—as highly anomalous and likely malicious, even if each individual step wasn't a critical alert on its own.
    answer_sources:
      - Mobile Threat Defense (MTD) Agent Logs
      - Mobile Device Management (MDM) Compliance Logs
      - IT Change Management System Logs
      - Managed mobile device endpoints and MDM/MTD Management Servers
    range: Last 90 days
    queries:
      - technology: Pseudocode
        query: |
          Search: UEBA Platform
          Query: MODEL learns normal event sequences. IF observed_sequence (e.g., [VPN from new geo -> install from unknown source -> admin rights granted]) has high reconstruction_error THEN ALERT.