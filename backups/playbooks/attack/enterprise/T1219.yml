name: T1219: Remote Access Software
id: 0a1b2c3d-4e5f-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps investigate whether an adversary is using legitimate
  remote access software for command and control. It focuses on identifying suspicious
  network connections to known remote access C2 infrastructure, unusual persistence
  mechanisms like new services or registry modifications following an installation,
  execution from atypical file paths or by unusual parent processes, anomalous network
  traffic patterns such as large data egress or beaconing, and suspicious execution
  chains where a tool is downloaded and run immediately after an initial compromise
  vector.
type: technique
related:
- TA0011: Command and Control
contributors:
- Zachary Szewczyk
- Ask Sage
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: none
questions:
- question: Are outbound network connections matching known malicious Remote Access
    Software C2 indicators?
  context: This question seeks to identify direct communication from internal assets
    to known command and control (C2) infrastructure associated with remote access
    tools. Matching against a threat intelligence feed for destination IPs, queried
    DNS domains, or SSL/TLS server names provides a high-fidelity signal that a compromised
    host is communicating with an adversary-controlled server.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Zeek ssl.log
  - Network egress points (e.g., firewalls, proxies)
  - DNS resolvers
  range: last 90 days
  queries:
  - 'SEARCH outbound_network_logs WHERE destination_ip IN (threat_intel_feed) OR destination_domain
    IN (threat_intel_feed) OR server_name IN (threat_intel_feed)'
- question: Are there outbound TLS connections to domains that appear to be typosquatting
    legitimate remote access service domains?
  context: This question aims to detect typosquatting, a technique where adversaries
    register domains with names very similar to legitimate ones (e.g., 'anydesl.com'
    instead of 'anydesk.com'). By calculating the Levenshtein distance between observed
    Server Name Indications (SNI) in TLS traffic and a list of known-good domains,
    we can flag suspicious connections that are close but not exact matches, which
    might otherwise evade simple blocklists.
  answer_sources:
  - Zeek ssl.log
  - Network egress points (e.g., firewalls, proxies)
  - DNS resolvers
  range: last 90 days
  queries:
  - 'FOR each outbound_tls_connection, CALCULATE levenshtein_distance(sni, known_good_domains).
    ALERT if distance <= 2 AND sni NOT IN known_good_domains.'
- question: Are hosts querying for domains that are likely generated by a Domain Generation
    Algorithm (DGA)?
  context: This question attempts to identify malware that uses DGAs to create a large
    number of potential C2 domains, making them difficult to block. By feeding newly
    seen domains from DNS logs into a pre-trained machine learning model, we can detect
    the non-random, algorithmic patterns characteristic of DGA domains and identify
    potentially infected hosts.
  answer_sources:
  - Zeek dns.log
  - Network egress points (e.g., firewalls, proxies)
  - DNS resolvers
  range: last 90 days
  queries:
  - 'FOR each new_domain in dns_logs, SCORE with dga_detection_model. ALERT if score
    > confidence_threshold.'
- question: Is remote access software being installed with persistence mechanisms
    like a new service or Run key modification?
  context: This question looks for a common adversary TTP where legitimate remote
    access software is installed silently and configured to persist across reboots.
    Correlating a process execution for a remote access tool (especially with silent
    install flags) with the nearly simultaneous creation of a Windows Service or a
    registry Run key for that same tool is a strong indicator of malicious intent,
    as opposed to legitimate, interactive use.
  answer_sources:
  - Windows Event ID 4688
  - Windows Event ID 7045
  - Windows Event ID 4657
  - Endpoint devices (workstations, servers)
  - Domain Controllers (for Group Policy changes)
  range: last 90 days
  queries:
  - 'CORRELATE process_creation(remote_access_tool, silent_args) with (service_creation
    OR registry_run_key_modification) for same_executable within 5 minutes.'
- question: Is an authorized remote access tool being executed in a statistically
    unusual manner?
  context: This question seeks to find abuse of legitimate, already-installed remote
    access tools. By baselining normal execution patterns (i.e., common parent processes
    and command-line arguments), we can flag executions that deviate significantly
    from established norms. An execution with a rare parent process or argument set
    (e.g., in the bottom 5% of historical frequency) could indicate an adversary is
    using the tool for purposes outside of its intended administrative function.
  answer_sources:
  - Windows Event ID 4688
  - Endpoint devices (workstations, servers)
  - Domain Controllers (for Group Policy changes)
  range: last 90 days
  queries:
  - 'FOR each remote_access_tool_execution, CALCULATE frequency of (parent_process,
    command_line). ALERT if frequency < 5th_percentile.'
- question: Can we classify remote access software executions as malicious based on
    their process characteristics?
  context: This question uses a machine learning approach to proactively score the
    likelihood of a remote access tool's execution being malicious. By training a
    model on features like the process name, parent process, command-line entropy
    (to detect obfuscation), and keywords, the system can automatically flag high-risk
    events that warrant immediate investigation, moving beyond simple rule-based
    detection.
  answer_sources:
  - Windows Event ID 4688
  - Endpoint devices (workstations, servers)
  - Domain Controllers (for Group Policy changes)
  range: last 90 days
  queries:
  - 'FOR each remote_access_tool_execution, SCORE with classification_model(features).
    ALERT if score > 0.90.'
- question: Is remote access software being launched by an unusual parent process
    or from an atypical file path?
  context: This question aims to detect when remote access software is executed as
    part of an initial access or lateral movement chain. Legitimate installations
    typically run from 'Program Files' and are not spawned by productivity software
    like Word or a browser. Alerting when a remote access tool is launched by an Office
    app, browser, or script interpreter, or when it's run from a temporary or user-writable
    directory, can reveal malicious activity.
  answer_sources:
  - Windows Event ID 4688
  - Endpoint devices (workstations, servers)
  range: last 90 days
  queries:
  - 'SEARCH process_creation WHERE child_process IS remote_access_tool AND (parent_process
    IN [office_apps, browsers, script_interpreters] OR child_path NOT IN [''C:\Program
    Files\'', ''C:\Program Files (x86)\'']).'
- question: Are there statistically anomalous parent-child process relationships
    or file path characteristics associated with remote access tool execution?
  context: This question employs statistical modeling to find outliers in process
    execution data. It flags remote access tool executions spawned by a parent process
    with which it has a very low historical probability of co-occurrence. It also
    looks for high entropy in file paths within system directories, which can indicate
    an adversary has placed a randomly named malicious payload in a location where
    it might blend in.
  answer_sources:
  - Windows Event ID 4688
  - Endpoint devices (workstations, servers)
  range: last 90 days
  queries:
  - 'ALERT on remote_access_tool_execution IF parent_child_probability < 0.01% OR
    shannon_entropy(file_path) > threshold.'
- question: Can we identify outlier clusters of remote access tool activity that differ
    from normal administrative behavior?
  context: This question uses unsupervised machine learning (clustering) to automatically
    group all remote access tool executions based on their features (path, parent,
    command line). The assumption is that legitimate administrative activity will
    form large, dense clusters. Small, isolated clusters or individual outlier points
    likely represent non-standard, and therefore suspicious, activity that should
    be investigated.
  answer_sources:
  - Windows Event ID 4688
  - Endpoint devices (workstations, servers)
  range: last 90 days
  queries:
  - 'APPLY DBSCAN clustering on remote_access_tool_executions. INVESTIGATE points
    classified as noise/outliers and small clusters.'
- question: Are there network connections on default remote access ports that violate
    network policy or exhibit unusually long durations?
  context: This question provides a policy-based and duration-based check for suspicious
    remote access activity. It alerts on connections using common remote access ports
    if they originate from a network segment (like a server VLAN) where they are explicitly
    forbidden. It also flags connections that remain active for an exceptionally long
    time (e.g., multiple days), which could indicate a persistent C2 channel rather
    than a temporary administrative session.
  answer_sources:
  - Zeek conn.log
  - Network egress points
  - internal network sensor grid (e.g., core switch SPAN ports)
  range: last 90 days
  queries:
  - 'SEARCH network_connections ON remote_access_ports WHERE (source_vlan IS restricted_server_vlan)
    OR (duration > 48_hours).'
- question: Is any host exhibiting anomalous data exfiltration volumes to a remote
    access service destination?
  context: This question focuses on detecting data exfiltration over a remote access
    channel. By creating a baseline of normal network behavior for each host, it can
    automatically alert when a host's outbound data volume to a remote access service
    dramatically increases (exceeds the 99th percentile). It also checks the ratio
    of sent to received bytes; a high ratio suggests large data transfer out of the
    network, which is more indicative of exfiltration than interactive remote control.
  answer_sources:
  - Zeek conn.log
  - Network egress points
  - internal network sensor grid (e.g., core switch SPAN ports)
  range: last 90 days
  queries:
  - 'FOR each host, ALERT if outbound_bytes_to_rat_service > 99th_percentile_baseline
    OR (bytes_sent / bytes_received) > 20.'
- question: Are there enterprise-wide anomalies in the timing and volume of remote
    access tool activity?
  context: This question looks for macro-level anomalies by applying a time-series
    model to aggregated network data for all remote access services. The model learns
    the normal rhythm of the business (e.g., high activity during workdays, low activity
    at night and on weekends). It can then flag periods with unexpected spikes in
    connections or data volume, especially during non-business hours, which could
    indicate a widespread, coordinated attack.
  answer_sources:
  - Zeek conn.log
  - Network egress points
  - internal network sensor grid (e.g., core switch SPAN ports)
  range: last 90 days
  queries:
  - 'APPLY ARIMA model to hourly_aggregated_rat_traffic. ALERT on time_periods flagged
    as anomalous.'
- question: Is there a correlated sequence of events showing an initial compromise
    leading directly to the download and execution of a remote access tool?
  context: This question aims to detect a common attack chain in a short time window.
    It specifically looks for the sequence of: 1) a document or browser spawning
    a script, 2) that script downloading a file, and 3) that file being executed as
    a known remote access tool. Correlating these events from endpoint and network
    data sources provides strong evidence of a successful initial access payload
    delivery and execution.
  answer_sources:
  - Windows Event ID 4688
  - Zeek http.log
  - Zeek files.log
  - Endpoint devices (workstations, servers)
  - Web proxy/gateway
  range: last 90 days
  queries:
  - 'CORRELATE (office_app -> powershell) with (powershell -> network_download) with
    (process_creation_of_rat) on same_host within 2 minutes.'
- question: Are remote access tools being launched by scripts with an execution speed
    indicative of automation rather than manual user action?
  context: This question focuses on the timing between process executions to differentiate
    between automated and manual actions. A human operator takes a noticeable amount
    of time to type and execute commands. When a script interpreter launches a remote
    access tool almost instantaneously (e.g., in less than 500 milliseconds), it is
    highly indicative of automated execution from a malicious script, rather than
    a deliberate, manual action by an administrator.
  answer_sources:
  - Windows Event ID 4688
  - Endpoint devices (workstations, servers)
  - Web proxy/gateway
  range: last 90 days
  queries:
  - 'FOR (script_interpreter -> remote_access_tool) process_creation_sequence, CALCULATE
    time_delta. ALERT if time_delta < 500ms.'
- question: Can a sequence-based machine learning model identify malicious process
    execution chains that lead to remote access tool usage?
  context: This question applies a more advanced machine learning model (HMM) that
    is specifically designed to understand sequences of events. By training the model
    on known good and bad process chains, it can learn the probability of transitioning
    from one state to another (e.g., from 'Browser' to 'Scripting' to 'RAT'). It can
    then analyze new, real-time event streams and alert when it observes a sequence
    of state transitions that has a high probability of being malicious.
  answer_sources:
  - Windows Event ID 4688
  - Endpoint devices (workstations, servers)
  - Web proxy/gateway
  range: last 90 days
  queries:
  - 'FEED real-time process_event_streams into HMM. ALERT if sequence is classified
    as malicious with high probability.'