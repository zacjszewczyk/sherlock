name: T1125: Video Capture
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: Is the adversary capturing video from endpoint devices? This playbook helps identify adversarial video capture by looking for several key indicators. These include the execution of known video capture malware, the misuse of legitimate utilities (like PowerShell or ffmpeg) for video recording, unauthorized processes accessing video hardware, the creation of video or image files in suspicious staging directories, and subsequent exfiltration of this data over the network.
type: technique
related:
  - TA0009: Collection
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are there any process creation events that match known malicious indicators for video capture malware?
    context: This question aims to detect known video capture malware (e.g., FruitFly, Proton) by matching process names or file hashes from process creation events against a threat intelligence feed. A match provides a high-fidelity signal that a known malicious tool is active on the endpoint.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User workstations and laptops, particularly those assigned to executives, developers, and system administrators.
    range: last 90 days
    queries:
      - "SEARCH process_creation_events (EID 4688, EID 1) | JOIN with threat_intelligence_feed on process_name or file_hash | WHERE indicator_technique = 'T1125' | ALERT"
  - question: Is the parent process of a potentially malicious video capture process rare within the enterprise?
    context: Malware is often launched by unusual or temporary processes. This question provides supplementary evidence by analyzing the enterprise-wide prevalence of the parent process that launched a suspected malicious binary. A parent process with a very low prevalence (e.g., in the bottom 5th percentile) suggests an anomalous execution chain, increasing confidence in the detection.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User workstations and laptops, particularly those assigned to executives, developers, and system administrators.
    range: last 90 days
    queries:
      - "SEARCH process_creation_events WHERE child_process matches T1125_indicator | CALCULATE prevalence of parent_process across all hosts | FILTER where prevalence < 5th_percentile | ALERT"
  - question: Does a machine learning model classify any new process creation events as malicious video capture activity?
    context: This question leverages a machine learning classifier (e.g., Random Forest) to provide advanced, real-time detection. The model analyzes a rich set of features from process creation events (parent process, command-line arguments, file path, user context) to generate a maliciousness score, enabling the detection of novel or evasive threats that signature-based methods might miss.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User workstations and laptops, particularly those assigned to executives, developers, and system administrators.
    range: last 90 days
    queries:
      - "STREAM process_creation_events | APPLY ML_classifier_model using static and dynamic features | ALERT on high_maliciousness_score"
  - question: Are legitimate utilities like powershell.exe or ffmpeg.exe being used with command-line arguments indicative of scripted video capture?
    context: Adversaries often abuse legitimate, pre-installed tools to avoid detection (a 'living off the land' technique). This question looks for specific command-line patterns in the execution of tools like PowerShell or ffmpeg that indicate non-interactive, scripted video capture, such as PowerShell invoking .NET 'DirectShowLib' or ffmpeg using the '-f dshow' flag.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User workstations and laptops, particularly those belonging to high-value targets.
    range: last 90 days
    queries:
      - "SEARCH process_creation_events with command_line_auditing | FILTER process_name IN (powershell.exe, ffmpeg.exe) AND command_line MATCHES regex for malicious video capture arguments"
  - question: Are the command-line arguments used with video-capable utilities anomalous compared to historical benign usage for a given user and host?
    context: This question aims to detect misuse of legitimate tools by identifying anomalous command-line arguments. It calculates a Jaccard similarity score to compare a new command's arguments against a historical baseline of benign arguments for that specific user and host. A low similarity score flags the execution as unusual and potentially malicious, even if it doesn't match a known bad signature.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User workstations and laptops, particularly those belonging to high-value targets.
    range: last 90 days
    queries:
      - "SEARCH process_creation_events for video_capable_utilities | CALCULATE Jaccard_similarity of command_line_arguments against user_and_host_baseline | ALERT on similarity_score < 10th_percentile"
  - question: Does an NLP model classify the command-line arguments of video-capable utilities as malicious?
    context: This question applies a Natural Language Processing (NLP) model to understand the intent behind command-line arguments. By training a model on labeled benign and malicious commands, it can classify new, unseen command-line executions as malicious, providing a more sophisticated detection capability than simple pattern matching.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User workstations and laptops, particularly those belonging to high-value targets.
    range: last 90 days
    queries:
      - "STREAM process_creation_events with command_line_arguments | APPLY NLP_classification_model (e.g., TF-IDF with Logistic Regression) | ALERT on malicious_classification"
  - question: Is a process that is not on the approved video-conferencing application allowlist accessing a video capture device?
    context: This question provides a direct method for detecting unauthorized use of webcams. It monitors for any process accessing a video device (e.g., '\\Device\\Video0') and compares the process name against a predefined allowlist of approved applications (e.g., teams.exe, zoom.exe). Any process not on the list that accesses the camera is flagged as suspicious.
    answer_sources:
      - Sysmon Event ID 10
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - All endpoints equipped with integrated or peripheral webcams.
    range: last 90 days
    queries:
      - "SEARCH process_access_events (Sysmon EID 10) WHERE target_object ends with a video device identifier | FILTER source_process_name NOT IN approved_video_app_allowlist | ALERT"
  - question: Is a process accessing a video device unusually rare across the enterprise?
    context: This question helps hunt for unknown or custom malware by identifying rarity. It calculates the enterprise-wide prevalence of any process observed accessing a video device. A process that is active on only a very small number of hosts (e.g., in the bottom 5th percentile) is considered rare and warrants investigation as potentially unauthorized software.
    answer_sources:
      - Sysmon Event ID 10
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - All endpoints equipped with integrated or peripheral webcams.
    range: last 90 days
    queries:
      - "SEARCH process_access_events (Sysmon EID 10) for video devices | CALCULATE enterprise-wide prevalence of source_process | FILTER prevalence < 5th_percentile | ALERT"
  - question: Does an autoencoder model detect anomalous behavior for events involving video device access?
    context: This question uses an advanced anomaly detection technique. An autoencoder neural network is trained on the features of legitimate video access events. When a new event occurs, the model attempts to reconstruct it. A high reconstruction error signifies that the event does not conform to the learned pattern of normal activity, indicating an anomaly that should be investigated.
    answer_sources:
      - Sysmon Event ID 10
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - All endpoints equipped with integrated or peripheral webcams.
    range: last 90 days
    queries:
      - "STREAM video_device_access_events | APPLY autoencoder_neural_network_model | ALERT on high_reconstruction_error"
  - question: Is a non-approved application creating video or image files in a common staging directory?
    context: After capturing video or images, malware typically saves the files to a temporary or public location before exfiltration. This question monitors for file creation events (Sysmon EID 11) and alerts when a process not on the video application allowlist creates a file with a video/image extension in a common staging directory (e.g., %TEMP%, %PUBLIC%).
    answer_sources:
      - Sysmon Event ID 11
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Common staging directories on user endpoints, such as %APPDATA%, %TEMP%, C:\Users\Public, and temporary internet file locations.
    range: last 90 days
    queries:
      - "SEARCH file_create_events (Sysmon EID 11) | FILTER file_extension IN (.mp4, .avi, .jpg) AND target_directory IN (common_staging_dirs) AND creating_process NOT IN video_app_allowlist | ALERT"
  - question: Are video or image files being created with high-entropy (random-looking) filenames?
    context: Malware often uses algorithmically generated, random-looking filenames to avoid simple detection rules. This question analyzes the Shannon entropy of filenames for newly created video/image files. A filename with an unusually high entropy score (e.g., > 3.5) compared to a normal baseline suggests it was programmatically generated and is potentially malicious.
    answer_sources:
      - Sysmon Event ID 11
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Common staging directories on user endpoints, such as %APPDATA%, %TEMP%, C:\Users\Public, and temporary internet file locations.
    range: last 90 days
    queries:
      - "SEARCH file_create_events (Sysmon EID 11) for video/image files | CALCULATE Shannon_entropy of filename | ALERT on entropy_score > 3.5"
  - question: Are there unusual clusters of file creation events for video/image files that suggest automated capture activity?
    context: This question uses the DBSCAN clustering algorithm to find anomalous patterns of file creation. It groups events based on features like file size, directory, creating process, and the time between creations. A dense cluster of events that is separate from normal activity can represent a malware's periodic video capture and save routine, highlighting automated behavior.
    answer_sources:
      - Sysmon Event ID 11
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Common staging directories on user endpoints, such as %APPDATA%, %TEMP%, C:\Users\Public, and temporary internet file locations.
    range: last 90 days
    queries:
      - "SEARCH file_create_events | APPLY DBSCAN_clustering using features (file_size, path, process, time_delta) | INVESTIGATE anomalous clusters"
  - question: Following a suspected video capture event on a host, is there a corresponding outbound network transfer of video or image files to an unapproved destination?
    context: This question correlates endpoint detections with network data to confirm exfiltration. It creates a rule that, upon triggering a host-based video capture alert, searches network logs (e.g., from Zeek) for any outbound file transfers of video or image MIME types from that same host within a short time window. An alert is generated if the destination is not an approved corporate or cloud service.
    answer_sources:
      - Zeek conn.log
      - Zeek files.log
      - Sysmon Event ID 1
      - Sysmon Event ID 10
      - Sysmon Event ID 11
      - Network egress points (e.g., firewalls, proxies) and the network interfaces of individual endpoints.
    range: last 90 days
    queries:
      - "CORRELATE T1125_host_alert with network_file_transfers (Zeek) within 10_minutes | WHERE file_mime_type IS 'video/*' or 'image/*' AND destination_ip NOT IN approved_services_list | ALERT"
  - question: Does a host exhibit an anomalous spike in outbound network traffic that exceeds its own historical baseline?
    context: This question aims to detect large-scale data exfiltration by monitoring network volume. It establishes a historical baseline of hourly outbound traffic for each host. If a host's current outbound traffic significantly exceeds its own normal behavior (e.g., surpasses the 99th percentile), it is flagged as a potential exfiltration event, especially if it correlates with other T1125 indicators.
    answer_sources:
      - Zeek conn.log
      - Zeek files.log
      - Sysmon Event ID 1
      - Sysmon Event ID 10
      - Sysmon Event ID 11
      - Network egress points (e.g., firewalls, proxies) and the network interfaces of individual endpoints.
    range: last 90 days
    queries:
      - "SEARCH network_traffic_logs (Zeek conn.log) | CALCULATE hourly outbound_bytes per host | ALERT if current_hour_bytes > 99th_percentile of host's historical baseline"
  - question: Does a host's outbound network traffic significantly deviate from the volume predicted by a time series forecasting model?
    context: This question provides a more sophisticated method for detecting network exfiltration anomalies. It uses a time series forecasting model (e.g., SARIMA, LSTM) to predict a host's expected outbound traffic. If the actual observed traffic is significantly higher than the forecasted amount (i.e., the residual is large), it indicates an anomaly that is a strong signal of potential exfiltration.
    answer_sources:
      - Zeek conn.log
      - Zeek files.log
      - Sysmon Event ID 1
      - Sysmon Event ID 10
      - Sysmon Event ID 11
      - Network egress points (e.g., firewalls, proxies) and the network interfaces of individual endpoints.
    range: last 90 days
    queries:
      - "STREAM network_traffic_logs per host | APPLY time_series_forecasting_model (e.g., SARIMA) | ALERT if actual_traffic is significantly greater than forecasted_traffic"