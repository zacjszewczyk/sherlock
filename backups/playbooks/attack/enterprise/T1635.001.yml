name: T1635.001: URI Hijacking
id: 3c1a8a2d-4e94-4f51-9c8a-7b6e9f0d1b3e
description: This playbook helps to identify if an adversary is attempting to intercept credentials or access tokens by hijacking URI schemes on mobile devices. This threat often manifests in two ways: first, by identifying a mobile application that has registered a URI scheme identical to a legitimate, trusted application but possesses a different package ID or signing certificate. Second, by detecting when a mobile device generates an anomalous number of "application chooser" dialog events for a single, sensitive URI scheme within a short time frame, suggesting a malicious app is competing with a legitimate one.
type: technique
related:
- TA0031: Credential Access
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: How can I detect if a mobile application is illegitimately registering a URI scheme already used by a trusted application?
  context: This question aims to identify malicious applications masquerading as legitimate ones by hijacking their custom URI schemes. An attacker can register an identical URI scheme to intercept sensitive data, like authentication tokens, intended for a trusted app. Detecting discrepancies between the registered URI scheme and the application's package ID or signing certificate, compared to a known-good allowlist, is a primary method for uncovering this threat. The risk is higher if the application is sideloaded or comes from an unofficial source.
  answer_sources:
  - MDM Application Inventory Log
  - MTD Application Scan Log
  - Threat Intelligence Platform Reputation Feed
  - Managed Mobile Endpoints (iOS/Android)
  - Mobile Device Management (MDM) Server
  - Mobile Threat Defense (MTD) Platform
  - Application Vetting System
  range: last 90 days
  queries:
  - search: pseudocode
    query: |
      JOIN mobile_app_inventory ON uri_scheme WITH trusted_app_allowlist.
      WHERE app_inventory.package_id != allowlist.package_id OR app_inventory.signing_cert != allowlist.signing_cert.
      ALERT IF app_source is 'sideloaded' or 'unofficial-app-store'.
- question: Are there any anomalous registrations of multiple unique applications to a single sensitive URI scheme across the device fleet?
  context: This question seeks to identify URI hijacking attempts through statistical anomaly detection. A sudden spike in the number of unique applications (package IDs) registering for the same sensitive URI (e.g., for single sign-on) can indicate a coordinated attack or a widespread malicious app. Additionally, it's highly suspicious if a very rare application registers a URI scheme typically used by a very common, trusted application, as this suggests impersonation.
  answer_sources:
  - MDM Application Inventory Log
  - MTD Application Scan Log
  - Threat Intelligence Platform Reputation Feed
  - Managed Mobile Endpoints (iOS/Android)
  - Mobile Device Management (MDM) Server
  - Mobile Threat Defense (MTD) Platform
  - Application Vetting System
  range: last 90 days
  queries:
  - search: pseudocode
    query: |
      1. CALCULATE daily count of unique package_ids per sensitive_uri_scheme.
      ALERT if count > 3*stdev(30_day_moving_avg).
      2. CALCULATE prevalence_percentile for all package_ids.
      ALERT if low_prevalence_package.uri_scheme == high_prevalence_package.uri_scheme.
- question: Can a machine learning model proactively identify and score the risk of new application-URI registrations to flag potential hijacking?
  context: This question focuses on using a predictive approach to detect URI hijacking. By training a machine learning model on various features—such as application source, signer trust, permission count, and threat intelligence reputation—it's possible to assign a risk score to each new URI registration. This automates the detection of suspicious registrations that might be missed by simple rule-based checks, allowing analysts to focus on high-risk events.
  answer_sources:
  - MDM Application Inventory Log
  - MTD Application Scan Log
  - Threat Intelligence Platform Reputation Feed
  - Managed Mobile Endpoints (iOS/Android)
  - Mobile Device Management (MDM) Server
  - Mobile Threat Defense (MTD) Platform
  - Application Vetting System
  range: last 90 days
  queries:
  - search: pseudocode
    query: |
      FOR each new app-URI registration:
      GENERATE features (is_sideloaded, permission_count, threat_intel_score, etc.).
      APPLY trained risk model.
      ALERT if risk_score > 0.85.
- question: Is a user's device showing an unusual number of 'application chooser' dialogs for a sensitive URI in a short period?
  context: This question addresses the user-facing symptom of URI hijacking. When two or more apps are registered for the same URI, the operating system prompts the user with an 'app chooser' dialog. A sudden burst of these dialogs for a sensitive URI on a single device indicates that a malicious app is competing with a legitimate one to handle the URI, potentially confusing the user into selecting the malicious option. Correlating this with network data can help pinpoint the phishing attempt that initiated the event.
  answer_sources:
  - MTD Security Event Log
  - Android Logcat Data Stream
  - Zeek conn.log
  - Zeek http.log
  - Zeek dns.log
  - Managed Mobile Endpoints (iOS/Android)
  - Mobile Threat Defense (MTD) Platform
  - Network Gateways (VPN Concentrators, Proxies)
  range: last 90 days
  queries:
  - search: pseudocode
    query: |
      SIEM RULE: ON MTD logs with event_type='app_chooser_dialog_shown'.
      ALERT if count(device_id, sensitive_uri_scheme) > 2 in 5 minutes.
      ENRICH with Zeek conn/http logs for source IP and referring URL.
- question: Is a specific user experiencing an anomalously high rate of 'application chooser' dialogs compared to their own normal behavior?
  context: This question aims to detect subtle or targeted attacks by focusing on behavioral anomalies at the individual user level. A fleet-wide rule might miss an attack targeting a single user. By establishing a baseline of normal 'app chooser' activity for each user, a significant deviation from this personal baseline can signal a compromised device or a targeted phishing campaign, even if the activity level isn't high enough to trigger a global threshold.
  answer_sources:
  - MTD Security Event Log
  - Android Logcat Data Stream
  - Zeek conn.log
  - Zeek http.log
  - Zeek dns.log
  - Managed Mobile Endpoints (iOS/Android)
  - Mobile Threat Defense (MTD) Platform
  - Network Gateways (VPN Concentrators, Proxies)
  range: last 90 days
  queries:
  - search: pseudocode
    query: |
      FOR each user:
      CALCULATE hourly count of 'app_chooser_dialog_shown' events.
      ESTABLISH 30-day baseline (mean, stdev).
      ALERT if hourly_count > mean + 3*stdev.
- question: Is there a fleet-wide, statistically significant anomaly in the rate of 'application chooser' dialogs that could indicate a large-scale campaign?
  context: This question seeks to identify widespread URI hijacking campaigns by analyzing the aggregate event data for the entire mobile fleet. A sophisticated time-series model can account for normal daily and weekly patterns (e.g., higher activity during business hours) and detect significant deviations that point to a coordinated attack. This provides a macro-level view that complements device-specific and user-specific detections.
  answer_sources:
  - MTD Security Event Log
  - Android Logcat Data Stream
  - Zeek conn.log
  - Zeek http.log
  - Zeek dns.log
  - Managed Mobile Endpoints (iOS/Android)
  - Mobile Threat Defense (MTD) Platform
  - Network Gateways (VPN Concentrators, Proxies)
  range: last 90 days
  queries:
  - search: pseudocode
    query: |
      MODEL fleet-wide hourly 'app_chooser_dialog_shown' events using time-series (e.g., Prophet).
      ALERT if observed_count deviates significantly from predicted_forecast_band.
      ENRICH with top contributing schemes, packages, and devices.