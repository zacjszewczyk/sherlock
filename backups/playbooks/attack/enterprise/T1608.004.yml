name: T1608.004: Drive-by Target
id: f8a1b2c3-d4e5-4f6a-7b8c-9d0e1f2a3b4c
description: An adversary may be staging resources for a strategic web compromise (watering hole) targeting the organization's users. This can be identified by observing internal hosts connecting to domains or IPs known for drive-by-compromise or exploit kits, rapid automated HTTP redirection chains, connections to newly registered domains (especially those with privacy protection), downloads of high-entropy or unusual files followed by immediate process creation, or a significant increase in traffic to advertising networks followed by connections to suspicious domains.
type: technique
related:
  - TA0042: Resource Development
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has an internal host connected to a domain or IP address known for drive-by-compromise, watering holes, or exploit kits?
    context: This question aims to identify direct communication with known malicious infrastructure. A match against a high-confidence threat intelligence feed is a strong indicator of compromise or an attempted compromise via a strategic web attack. Early detection allows for rapid incident response to isolate the potentially affected host and prevent further malicious activity.
    answer_sources:
      - Zeek http.log
      - Zeek dns.log
      - Zeek conn.log
      - Enterprise DNS Resolvers
      - Egress Firewall/Proxy
      - Threat Intelligence Platform (TIP)
      - SIEM
    range: Last 90 days
    queries:
      - pseudocode: SEARCH Zeek dns.log OR conn.log | JOIN with threat_intel_watchlist ON destination_ip OR destination_domain | WHERE match_found | RETURN source_host, destination, threat_feed_name
  - question: Is any internal host exhibiting an unusually high frequency of connections to known malicious domains or IPs compared to its peers?
    context: This question seeks to uncover statistical anomalies that rule-based detections might miss. A host connecting to malicious infrastructure far more frequently than its peers could indicate a persistent infection, a system being used for reconnaissance, or a user who is being specifically targeted or has visited multiple compromised sites.
    answer_sources:
      - Zeek http.log
      - Zeek dns.log
      - Zeek conn.log
      - Enterprise DNS Resolvers
      - Egress Firewall/Proxy
      - Threat Intelligence Platform (TIP)
      - SIEM
    range: Last 90 days
    queries:
      - pseudocode: SEARCH connections to threat_intel_watchlist over 24h | GROUP BY source_host | CALCULATE connection_count | COMPARE count to 95th_percentile of all hosts | RETURN hosts_exceeding_threshold
  - question: Can outbound connections be scored for risk to proactively identify potential drive-by-compromise attempts?
    context: This question focuses on moving beyond simple blocklist matching to a more nuanced, risk-based approach. By combining multiple features like threat intelligence, domain reputation, ASN reputation, and historical data, a machine learning model can identify suspicious connections that may not involve known-bad indicators, providing a more robust and predictive defense.
    answer_sources:
      - Zeek http.log
      - Zeek dns.log
      - Zeek conn.log
      - Enterprise DNS Resolvers
      - Egress Firewall/Proxy
      - Threat Intelligence Platform (TIP)
      - SIEM
    range: Last 90 days
    queries:
      - pseudocode: FOR each outbound_connection | EXTRACT features (threat_intel_match, domain_reputation, ASN_reputation, data_volume, historical_frequency) | APPLY risk_model | RETURN connections with risk_score > threshold
  - question: Has a user's browsing session been involved in a rapid redirection chain that includes known malicious redirectors?
    context: Adversaries use redirection chains to obscure the final malicious payload's origin. This question aims to reconstruct these chains from network logs to identify sessions that pass through known malicious intermediaries, which is a strong indicator of a watering hole or malvertising attack.
    answer_sources:
      - Zeek http.log
      - Zeek dns.log
      - Zeek conn.log
      - Enterprise Web Proxy
      - Network Security Monitoring (NSM) sensors
      - DNS Resolvers
      - Endpoint Browsers
    range: Last 90 days
    queries:
      - pseudocode: SEARCH Zeek http.log | GROUP BY source_ip, user_agent over 10s window | RECONSTRUCT session using Referer_header | CHECK if any domain in chain is on malicious_redirector_list | RETURN suspicious_sessions
  - question: Are there any browsing sessions exhibiting statistically anomalous redirection behavior, such as unusually long or fast chains?
    context: Legitimate web browsing involves redirects, but malicious redirection chains often have distinct characteristics, such as being very long, very fast, or involving a series of unrelated domains. This question uses statistical analysis to identify outlier sessions that deviate from normal browsing patterns, even if no known-bad domains are involved.
    answer_sources:
      - Zeek http.log
      - Zeek dns.log
      - Zeek conn.log
      - Enterprise Web Proxy
      - Network Security Monitoring (NSM) sensors
      - DNS Resolvers
      - Endpoint Browsers
    range: Last 90 days
    queries:
      - pseudocode: FOR all browsing_sessions | CALCULATE chain_length, speed, Jaccard_similarity_to_legit_domains | IDENTIFY sessions with length/speed > 99th_percentile OR Jaccard_similarity < 0.1 | RETURN anomalous_sessions
  - question: Can browsing sessions be clustered to identify groups of anomalous activity indicative of a drive-by attack?
    context: This question applies unsupervised machine learning to group browsing sessions based on multiple features like length, duration, ASN diversity, and domain age. Outlier clusters that do not conform to typical user behavior can reveal novel or sophisticated attack patterns that are not easily defined by simple rules or statistics.
    answer_sources:
      - Zeek http.log
      - Zeek dns.log
      - Zeek conn.log
      - Enterprise Web Proxy
      - Network Security Monitoring (NSM) sensors
      - DNS Resolvers
      - Endpoint Browsers
    range: Last 90 days
    queries:
      - pseudocode: FOR each session | EXTRACT features (chain_length, duration, unique_ASNs, final_domain_age) | APPLY DBSCAN clustering | INVESTIGATE outlier_clusters
  - question: Has an internal host connected to a newly registered domain (NRD), particularly one with other high-risk attributes?
    context: Adversaries frequently use newly registered domains for malicious campaigns as they have not yet developed a negative reputation. This question aims to detect connections to these domains, with increased urgency if other risk factors like WHOIS privacy are present, as this is a common tactic in setting up watering hole attacks.
    answer_sources:
      - Zeek dns.log
      - Zeek http.log
      - Zeek conn.log
      - WHOIS Lookup Data
      - Passive DNS Data
      - Internal DNS Resolvers
      - Enterprise Web Proxy
      - Threat Intelligence Platforms (for NRD and WHOIS feeds)
    range: Last 90 days
    queries:
      - pseudocode: SEARCH Zeek dns.log OR http.log for destinations in NRD_watchlist | ENRICH with WHOIS data | ESCALATE if WHOIS_privacy_enabled OR registration_date < 7 days | RETURN alert
  - question: Is any host visiting domains that are statistically much newer than what is typical for the organization or for that specific host?
    context: This question establishes a behavioral baseline for domain age across the enterprise. A deviation from this baseline, such as a host suddenly visiting an unusually high number of very new domains, can indicate a compromised system or a user being targeted by a campaign leveraging NRDs.
    answer_sources:
      - Zeek dns.log
      - Zeek http.log
      - Zeek conn.log
      - WHOIS Lookup Data
      - Passive DNS Data
      - Internal DNS Resolvers
      - Enterprise Web Proxy
      - Threat Intelligence Platforms (for NRD and WHOIS feeds)
    range: Last 90 days
    queries:
      - pseudocode: FOR each visited_domain | GET domain_age | COMPARE age to 1st_percentile of all visited_domain_ages | ALERT if outlier | ALSO, for each host, TRACK NRD_visit_rate | ALERT if rate > 3_std_dev from baseline
  - question: Has there been an anomalous, enterprise-wide spike in visits to newly registered domains?
    context: A sudden, widespread increase in visits to NRDs across many hosts can signal a large-scale watering hole or malvertising campaign. This question uses time series forecasting to predict normal NRD traffic levels and alerts when observed activity significantly exceeds the forecast, allowing security teams to investigate the potential campaign and its scope.
    answer_sources:
      - Zeek dns.log
      - Zeek http.log
      - Zeek conn.log
      - WHOIS Lookup Data
      - Passive DNS Data
      - Internal DNS Resolvers
      - Enterprise Web Proxy
      - Threat Intelligence Platforms (for NRD and WHOIS feeds)
    range: Last 90 days
    queries:
      - pseudocode: MODEL enterprise_NRD_visits_per_hour using SARIMA/Prophet | FORECAST expected_count_with_confidence_interval | ALERT if observed_count > upper_confidence_bound | IDENTIFY contributing_hosts
  - question: Was a suspicious file (matching a YARA rule) downloaded and followed immediately by a new process creation from the browser?
    context: This question directly links a suspicious file download with post-exploitation behavior. The sequence of a browser downloading a file that is flagged by YARA (indicating obfuscation or known malware) and then spawning a new process is a classic "drive-by download" attack pattern. Correlating these network and endpoint events provides high-confidence evidence of a successful compromise.
    answer_sources:
      - Zeek http.log
      - Zeek files.log
      - Windows Event ID 4688
      - Windows Event ID 1
      - Endpoint workstations and servers
      - Enterprise Web Proxy
      - Network File Analysis Sandbox
      - SIEM for correlation
    range: Last 90 days
    queries:
      - pseudocode: ON file_download from Zeek files.log | SCAN file with YARA | IF YARA_match, SEARCH for process_creation (WinEvent 4688/1) from parent_browser_process on same_host within 1 minute | ALERT on correlation
  - question: Have any downloaded files, particularly scripts, exhibited unusually high entropy or been of a file type inconsistent with the source domain's profile?
    context: High entropy in a script or text-based file often indicates obfuscation or encryption used to hide malicious code. Additionally, a domain that normally serves news articles suddenly serving an executable is highly anomalous. This question seeks to identify these statistical red flags to uncover suspicious files that might otherwise evade signature-based detection.
    answer_sources:
      - Zeek http.log
      - Zeek files.log
      - Windows Event ID 4688
      - Windows Event ID 1
      - Endpoint workstations and servers
      - Enterprise Web Proxy
      - Network File Analysis Sandbox
      - SIEM for correlation
    range: Last 90 days
    queries:
      - pseudocode: FOR each downloaded_script | CALCULATE Shannon_entropy | ALERT if entropy > 95th_percentile | ALSO, for each download, COMPARE file_type to domain_profile | ALERT on statistical_deviation
  - question: Can a machine learning model be used to predict whether a file download is malicious based on its context and characteristics?
    context: This question aims to build a predictive model that synthesizes multiple weak signals into a strong indicator of a malicious download. By considering features like file entropy, source domain reputation, redirection chain presence, and parent process, the model can identify malicious downloads with greater accuracy than any single rule, improving detection of novel threats.
    answer_sources:
      - Zeek http.log
      - Zeek files.log
      - Windows Event ID 4688
      - Windows Event ID 1
      - Endpoint workstations and servers
      - Enterprise Web Proxy
      - Network File Analysis Sandbox
      - SIEM for correlation
    range: Last 90 days
    queries:
      - pseudocode: FOR each file_download | EXTRACT features (entropy, size, domain_rep, domain_age, in_redirect_chain, parent_process) | APPLY classifier_model | ALERT if prediction_probability is high
  - question: Has a host connected to a known malvertising domain and then quickly connected to a known malicious or newly registered domain?
    context: This question looks for the specific sequence of events associated with a malvertising attack - a visit to a site serving malicious ads, followed by a redirect to a malicious destination. Correlating a connection to a known malvertising network with a subsequent connection to a blacklisted or very new domain creates a high-fidelity alert for this attack vector.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Egress Firewalls/Proxies
      - DNS Resolvers
      - Threat Intelligence Platform
      - Ad-blocker logs
    range: Last 90 days
    queries:
      - pseudocode: SEARCH for connection to malvertising_watchlist | IF match, SEARCH for subsequent connection (within 2 mins) to threat_intel_blocklist OR NRD_list | ALERT on sequence
  - question: Has any host shown a sudden spike in traffic to advertising-related domains, and what suspicious activity followed?
    context: A sudden, anomalous increase in traffic to ad networks for a single host can indicate that the user has browsed to a site with an aggressive or malicious ad campaign. This question aims to detect this behavioral anomaly and then scrutinize the host's subsequent network activity for rare or suspicious connections that could indicate a successful compromise via malvertising.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Egress Firewalls/Proxies
      - DNS Resolvers
      - Threat Intelligence Platform
      - Ad-blocker logs
    range: Last 90 days
    queries:
      - pseudocode: FOR each host, BASELINE traffic to 'Advertising' domains | DETECT spikes > 3_std_dev from moving_average | ON spike, ANALYZE subsequent 5 mins of traffic for rare_events (e.g., first-time-seen domains)
  - question: Is there an anomalous, enterprise-wide pattern in traffic to ad networks that could indicate a large-scale malvertising campaign?
    context: This question scales up the previous one, looking for coordinated anomalies across the entire organization's traffic to ad networks. A multivariate model can detect subtle, correlated shifts in connection counts, data volume, and domain diversity that may signal a widespread campaign. Identifying the hosts contributing to the anomaly allows for targeted investigation.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Egress Firewalls/Proxies
      - DNS Resolvers
      - Threat Intelligence Platform
      - Ad-blocker logs
    range: Last 90 days
    queries:
      - pseudocode: MODEL enterprise traffic to ad_networks (connection_count, data_volume, unique_domains) with multivariate_anomaly_detection | ON anomaly, IDENTIFY contributing_hosts | APPLY risk_scoring to subsequent traffic from those hosts