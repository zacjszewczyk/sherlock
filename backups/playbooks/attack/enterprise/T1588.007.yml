name: "T1588.007: Artificial Intelligence"
id: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
description: "This playbook helps investigate if an adversary is developing resources using Artificial Intelligence to support future operations. This includes detecting communication with known AI-driven campaign infrastructure, identifying AI-generated phishing emails, finding AI-generated code or scripts, spotting algorithmically generated domains, detecting advanced script obfuscation, observing rapid/automated file creation, and identifying automated, non-human browsing behavior for reconnaissance."
type: "technique"
related:
  - "TA0042: Resource Development"
contributors:
  - "Zachary Szewczyk, Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Has an internal host communicated with a network indicator or received an email from a sender identified by threat intelligence as part of an AI-driven campaign?"
    context: "This question aims to detect initial contact with infrastructure known to be associated with adversaries leveraging AI. AI can be used to generate phishing content or create command and control (C2) infrastructure, and threat intelligence provides known indicators of this activity. A match could be an early warning of a targeted attack."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek smtp.log"
      - "Internet Gateway"
      - "Email Gateway"
      - "DNS Resolvers"
      - "Threat Intelligence Feed"
    range: "Last 90 days"
    queries:
      - "SEARCH Zeek logs (conn, dns, smtp) WHERE destination_ip OR dns_query OR sender_domain IN threat_intel_feed_of_AI_campaigns"
  - question: "Has there been an anomalous spike in connections to newly registered domains (less than 30 days old)?"
    context: "Adversaries often use newly registered domains for phishing or C2, as they have not yet been flagged by reputation services. AI can be used to automate the creation and registration of these domains. A sudden increase in traffic to such domains is a strong indicator of a potential campaign launch."
    answer_sources:
      - "Zeek dns.log"
      - "Internet Gateway"
      - "DNS Resolvers"
    range: "Last 90 days"
    queries:
      - "CALCULATE daily count of connections to domains with age < 30 days. COMPARE count to 90-day baseline. ALERT if count > 95th percentile."
  - question: "Have we received any emails that a machine learning model has classified as likely AI-generated phishing?"
    context: "Large Language Models (LLMs) can create highly convincing and personalized phishing emails at scale. Traditional signature-based detection can miss these. This question uses a dedicated classification model to identify the subtle linguistic and structural patterns of AI-generated text, providing a more advanced layer of defense."
    answer_sources:
      - "Zeek smtp.log"
      - "Email Gateway"
      - "AI/ML Classification Model"
    range: "Last 90 days"
    queries:
      - "SCAN incoming emails with AI-phishing-detection model. ALERT if score > 0.85."
  - question: "Has a script been executed or transferred that contains signatures of AI code generation tools?"
    context: "AI tools like Copilot can be used by adversaries to accelerate malware development. These tools often leave behind artifacts, such as comments or specific code structures. This question uses YARA rules to scan for these tell-tale signs, which could indicate that an adversary is deploying AI-generated malicious code."
    answer_sources:
      - "Windows Event ID 4104"
      - "Windows Event ID 4688"
      - "Zeek files.log"
      - "User Workstations"
      - "Application Servers"
      - "Development Environments"
    range: "Last 90 days"
    queries:
      - "SEARCH PowerShell logs (EID 4104) and network file transfers (Zeek files.log) with YARA rules for AI-code-generator artifacts. ALERT on match."
  - question: "Has a script been executed with abnormally high complexity and an unusual comment-to-code ratio, suggesting potential AI generation?"
    context: "AI-generated code can sometimes exhibit statistical properties different from human-written code, such as overly complex structures or a lack of meaningful comments. By baselining normal script metrics, this question helps identify outliers that warrant investigation as potentially machine-generated and malicious."
    answer_sources:
      - "Windows Event ID 4104"
      - "User Workstations"
      - "Application Servers"
      - "Development Environments"
    range: "Last 90 days"
    queries:
      - "FOR each PowerShell script (EID 4104), CALCULATE AST complexity and comment-to-code ratio. COMPARE to baseline. ALERT if both metrics > 98th percentile."
  - question: "Has an NLP model classified any executed scripts as having a high probability of being AI-generated malware?"
    context: "This question leverages a sophisticated NLP model to perform a deep analysis of script content, going beyond simple signatures. By training the model on known examples, it can learn to identify the nuanced patterns of AI-generated malicious code, providing a powerful detection capability against novel threats."
    answer_sources:
      - "Windows Event ID 4104"
      - "User Workstations"
      - "Application Servers"
      - "Development Environments"
      - "AI/ML Classification Model"
    range: "Last 90 days"
    queries:
      - "CLASSIFY PowerShell scripts (EID 4104) using NLP model. ALERT if probability_AI_malicious is high."
  - question: "Has a host attempted to resolve a newly registered domain belonging to a suspicious Top-Level Domain (TLD)?"
    context: "Adversaries often use low-cost, less-regulated TLDs in conjunction with newly registered domains for their campaigns. AI can automate the process of finding and registering these domains. This question combines TLD reputation with domain age to create a high-fidelity indicator of potentially malicious activity."
    answer_sources:
      - "Zeek dns.log"
      - "DNS Resolvers"
      - "Web Proxy"
      - "Internet Gateway"
    range: "Last 90 days"
    queries:
      - "SEARCH DNS logs (Zeek dns.log) WHERE TLD in suspicious_tld_list AND domain_age < 30 days. ALERT on match."
  - question: "Has a host resolved a domain with unusually high or low character entropy, suggesting it might be algorithmically generated?"
    context: "Domain Generation Algorithms (DGAs), which can be powered by AI, often produce domain names that are either pseudo-random (high entropy) or highly patterned (low entropy). This question seeks to identify these statistical outliers, which are a hallmark of automated C2 infrastructure."
    answer_sources:
      - "Zeek dns.log"
      - "Zeek conn.log"
      - "DNS Resolvers"
      - "Web Proxy"
      - "Internet Gateway"
    range: "Last 90 days"
    queries:
      - "FOR each new domain in DNS logs (Zeek dns.log), CALCULATE Shannon entropy. ALERT if entropy is in top 5% or bottom 5% of baseline."
  - question: "Have we observed any 'flash-in-the-pan' domains that received a sudden, anomalous burst of DNS queries before disappearing?"
    context: "Automated attack campaigns, potentially orchestrated by AI, may use a domain for a very short period to avoid detection. This creates a 'flash-in-the-pan' traffic pattern—a sharp spike followed by silence. This question uses time-series analysis to detect this specific anomaly, which is difficult to spot with simple volume thresholds."
    answer_sources:
      - "Zeek dns.log"
      - "DNS Resolvers"
      - "Web Proxy"
      - "Internet Gateway"
    range: "Last 90 days"
    queries:
      - "MODEL DNS query volume per domain over time. ALERT on domains with a sudden, short-lived spike in traffic."
  - question: "Has a PowerShell script been executed that uses common obfuscation techniques?"
    context: "Adversaries use obfuscation to hide the true intent of their scripts from analysts and security tools. AI can be used to generate complex, multi-layered obfuscation. This question looks for known keywords and patterns associated with obfuscation, which can indicate that a script is attempting to execute malicious commands covertly."
    answer_sources:
      - "Windows Event ID 4104"
      - "Windows Event ID 4688"
      - "User Workstations"
      - "Domain Controllers"
      - "Critical Servers"
    range: "Last 90 days"
    queries:
      - "SEARCH PowerShell logs (EID 4104) for obfuscation keywords (e.g., 'IEX', 'FromBase64String'). ALERT if multiple indicators are found."
  - question: "Has a script been executed that exhibits an unusually low compression ratio, suggesting high entropy due to obfuscation or packing?"
    context: "Obfuscated or encrypted code is statistically similar to random data, which does not compress well. This question leverages that property by measuring the compressibility of a script. A script that is significantly less compressible than normal scripts is a strong candidate for being malicious and packed or obfuscated."
    answer_sources:
      - "Windows Event ID 4104"
      - "Windows Event ID 4688"
      - "User Workstations"
      - "Domain Controllers"
      - "Critical Servers"
    range: "Last 90 days"
    queries:
      - "FOR each PowerShell script (EID 4104), CALCULATE Gzip compression ratio. ALERT if ratio is below 5th percentile of baseline."
  - question: "Has a machine learning model flagged any executed scripts as being likely obfuscated and malicious?"
    context: "This question employs a powerful machine learning classifier to analyze a wide range of script features simultaneously. By training on known examples of benign and obfuscated malicious scripts, the model can learn to identify complex patterns of obfuscation that evade simpler rule-based methods, including novel techniques generated by AI."
    answer_sources:
      - "Windows Event ID 4104"
      - "Windows Event ID 4688"
      - "User Workstations"
      - "Domain Controllers"
      - "Critical Servers"
      - "AI/ML Classification Model"
    range: "Last 90 days"
    queries:
      - "SCORE PowerShell scripts (EID 4104) using obfuscation detection model. ALERT on high scores."
  - question: "Has a single process rapidly created an unusually high number of script or executable files?"
    context: "This behavior is characteristic of a 'dropper' or a self-propagating worm, which may use AI to generate polymorphic variants of itself. A legitimate process is unlikely to create many executables in a short time. This question sets a simple threshold to detect this suspicious burst of activity."
    answer_sources:
      - "Sysmon Event ID 1"
      - "Sysmon Event ID 11"
      - "Development Servers"
      - "User Workstations"
      - "Build Systems"
    range: "Last 90 days"
    queries:
      - "COUNT file creations (Sysmon EID 11) per parent process (Sysmon EID 1) in a 5-minute window. ALERT if count > 10 for script/executable files."
  - question: "Has there been an anomalous increase in the creation of files with high-entropy (random-looking) names on a host?"
    context: "Malware, especially variants generated by AI, may use randomized filenames to evade signature-based detection and make analysis more difficult. This question establishes a baseline for normal file creation activity and looks for a statistically significant increase in the creation of files with random-looking names, indicating a potential infection."
    answer_sources:
      - "Sysmon Event ID 11"
      - "Development Servers"
      - "User Workstations"
      - "Build Systems"
    range: "Last 90 days"
    queries:
      - "TRACK rate of file creations (Sysmon EID 11) with high-entropy filenames. ALERT if rate > 3 standard deviations above 30-day average."
  - question: "Has a clustering algorithm identified a dense group of file and process events involving high-entropy filenames and a suspicious parent process?"
    context: "This question uses an unsupervised learning approach to find hidden relationships in event data. A dense cluster of activity—multiple related events happening close together in time—involving random filenames and an unusual parent process (like a document reader creating executables) is a powerful indicator of a malicious payload being unpacked or executed."
    answer_sources:
      - "Sysmon Event ID 1"
      - "Sysmon Event ID 11"
      - "Development Servers"
      - "User Workstations"
      - "Build Systems"
    range: "Last 90 days"
    queries:
      - "CLUSTER file (Sysmon EID 11) and process (Sysmon EID 1) events by host and time. ALERT on dense clusters involving high-entropy filenames and suspicious parent processes."
  - question: "Is a host using a non-browser user-agent to make a high volume of requests to public information sources?"
    context: "Adversaries may use AI-powered scripts to automate the scraping of information from public sources like GitHub, Google, or Pastebin for reconnaissance. This activity is often performed using scripting tools (like Python or curl), not standard web browsers. This question detects this automated, high-volume scraping behavior."
    answer_sources:
      - "Zeek http.log"
      - "Zeek dns.log"
      - "Zeek conn.log"
      - "Zeek ssl.log"
      - "Internet Gateway"
      - "Web Proxy"
      - "User Subnets"
    range: "Last 90 days"
    queries:
      - "SEARCH HTTP logs (Zeek http.log) for non-browser user-agents. ALERT if request count from one IP to public info sites > 100 in one hour."
  - question: "Is a host exhibiting unusually high entropy in its web request parameters or requested server names?"
    context: "AI-driven reconnaissance tools might generate randomized or complex query parameters to search for vulnerabilities or gather specific data. This can lead to a statistical anomaly in the entropy of the URI. This question baselines normal browsing behavior and flags significant deviations, which could indicate automated or malicious activity."
    answer_sources:
      - "Zeek http.log"
      - "Zeek ssl.log"
      - "Internet Gateway"
      - "Web Proxy"
      - "User Subnets"
    range: "Last 90 days"
    queries:
      - "FOR each source IP, CALCULATE entropy of URI queries and SNI values. ALERT if average entropy in a 10-minute window > 99th percentile of 30-day baseline."
  - question: "Has a time-series model detected machine-like, periodic web browsing behavior from any internal host?"
    context: "Human browsing is typically bursty and irregular. Automated scripts, on the other hand, often make requests at fixed, regular intervals. This question uses a time-series model to learn the pattern of inter-request timings for each host and flags sessions that exhibit a machine-like periodicity, suggesting automated scraping or C2 communication."
    answer_sources:
      - "Zeek http.log"
      - "Zeek conn.log"
      - "Internet Gateway"
      - "Web Proxy"
      - "User Subnets"
    range: "Last 90 days"
    queries:
      - "MODEL inter-request timings per source IP. ALERT if timings become highly periodic and deviate from normal human browsing patterns."