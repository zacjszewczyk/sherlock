name: "T1011: Exfiltration Over Other Network Medium"
id: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
description: "This playbook helps investigate whether an adversary is attempting to exfiltrate data over an unusual or secondary network medium, such as Wi-Fi, Bluetooth, or a cellular connection. It covers various indicators of this activity, including: the execution of known malicious tools that initiate outbound connections over non-primary interfaces to known malicious IPs; the anomalous use of network configuration utilities to enable or modify secondary interfaces; a timed sequence of enabling an interface, archiving data, and then making a large outbound connection; statistical deviations in traffic patterns like data volume, connection duration, or protocol usage; and network connections originating from unexpected processes or non-standard file paths."
type: "technique"
related:
  - "TA0010: Exfiltration"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Has a process known to be associated with T1011 executed and initiated an outbound network connection over a secondary interface to a known malicious destination?"
    context: "This question seeks to identify a high-fidelity indicator of compromise. It correlates three distinct pieces of evidence: a known malicious tool (identified by its hash), communication over a less-monitored secondary network channel, and a connection to a known command-and-control or exfiltration server. A positive match strongly suggests an active and targeted exfiltration attempt."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 5156"
      - "Zeek conn.log"
      - "Endpoints with multiple network interfaces"
      - "Network egress points monitoring secondary channels"
      - "VPN concentrators"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "SEARCH process creation events (4688), network connection events (5156), and network flow logs (Zeek). JOIN 4688 and 5156 on ProcessID. JOIN result with Zeek on flow identifiers. FILTER where process_hash in T1011_IOC_list AND destination_ip in C2_IOC_list AND network_interface_type is not 'primary'."
  - question: "Is a rare or previously unseen process making a network connection over a secondary interface?"
    context: "This question uses a statistical approach to find anomalies. Adversaries may use legitimate but uncommon tools or custom malware. By baselining which processes normally use which network interfaces across the enterprise, this question helps identify outliers that could indicate a tool being repurposed for exfiltration over a secondary channel."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 5156"
      - "Zeek conn.log"
      - "Endpoints with multiple network interfaces"
      - "Network egress points monitoring secondary channels"
      - "VPN concentrators"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "AGGREGATE process_name, network_interface_type from network logs over 30 days to build frequency baseline. SEARCH current network logs. ALERT where (process_name, network_interface_type) pair frequency is in bottom 1st percentile or is previously unseen."
  - question: "Does a machine learning model classify a network connection from a secondary interface as a potential T1011 exfiltration attempt?"
    context: "This question leverages a trained machine learning model to detect complex patterns indicative of malicious exfiltration. The model considers a wide range of features (process info, network details, connection stats) to make a sophisticated judgment call, potentially identifying novel or evasive techniques that simpler rules might miss. A high-confidence alert from the model warrants immediate investigation."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 5156"
      - "Zeek conn.log"
      - "Endpoints with multiple network interfaces"
      - "Network egress points monitoring secondary channels"
      - "VPN concentrators"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "INPUT features (process_path, parent_process, cmdline, interface_type, dest_asn, dest_port, bytes_sent, duration) into trained classification model. ALERT where connection is on secondary interface AND model_prediction is 'T1011' AND confidence_score > 0.90."
  - question: "Has a secondary network interface been enabled or modified by a non-standard user account or from an unusual parent process?"
    context: "This question aims to detect preparatory actions for exfiltration. Adversaries often need to enable a secondary network interface before using it. If this action is performed by a user who doesn't typically perform network administration, or is initiated by an unrelated application like Microsoft Word, it is highly suspicious and could be a precursor to data theft."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 4104"
      - "Zeek conn.log"
      - "All Windows endpoints and servers"
      - "Domain Controllers"
      - "System management servers"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "SEARCH process (4688) and PowerShell (4104) logs for commands like 'netsh wlan', 'Enable-NetAdapter'. ALERT if user is not in 'Network Admins' group OR parent_process is in ('winword.exe', 'outlook.exe', 'excel.exe')."
  - question: "Has a user executed a network configuration command that is statistically rare for them, or that has unusually high command-line entropy?"
    context: "This question attempts to identify anomalous administrative behavior. Instead of looking for specific commands, it baselines a user's typical usage of network configuration tools. A deviation from this baseline, such as using a rare command or one with a complex, randomized-looking command line (high entropy), could indicate an adversary using a compromised account and attempting to obfuscate their actions."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 4104"
      - "Zeek conn.log"
      - "All Windows endpoints and servers"
      - "Domain Controllers"
      - "System management servers"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "BASELINE frequency and argument entropy for network config commands per user. SEARCH current command execution logs. ALERT where command is rare for that user OR command_line_entropy > (user_mean_entropy + 2 * user_std_dev)."
  - question: "Does an unsupervised machine learning model flag the execution of a network configuration command as a significant anomaly?"
    context: "This question uses machine learning to find outliers in administrative activity without pre-existing labels. The model learns what 'normal' command execution looks like across various dimensions (time, user, parent process, etc.) and flags any activity that deviates significantly. This is effective for catching novel adversary behavior that doesn't match any known patterns."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 4104"
      - "Zeek conn.log"
      - "All Windows endpoints and servers"
      - "Domain Controllers"
      - "System management servers"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "INPUT features (time_of_day, user_sid, parent_process, cmdline_length, contains_keyword) into Isolation Forest model. ALERT on events flagged as highly anomalous by the model."
  - question: "Has a host exhibited a sequence of enabling a secondary network interface, running a data archiving tool, and then sending a large amount of data over that interface within a short time frame?"
    context: "This question looks for a classic 'smash and grab' exfiltration pattern. It correlates a sequence of three distinct actions that, when viewed together, strongly indicate data staging and exfiltration. By looking for this specific chain of events (enable, archive, send) within a tight window (e.g., 15 minutes), the query provides a high-confidence alert for an active data theft attempt."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 5156"
      - "Zeek conn.log"
      - "Endpoints"
      - "File servers hosting sensitive data"
      - "Network egress points"
      - "Data Loss Prevention (DLP) sensor locations"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "CORRELATE events on a single host within a 15-minute window. TRIGGER on sequence: 1) process event for 'netsh wlan connect', THEN 2) process event for ('7z.exe', 'rar.exe'), THEN 3) network flow event with interface_type='secondary' and bytes_sent > 50MB. ALERT on sequence completion."
  - question: "Following the use of a data archiving tool, has the host initiated an outbound connection on a secondary interface that exceeds its statistically normal data volume?"
    context: "This question uses a statistical threshold to detect exfiltration. It first establishes a baseline for how much data a host typically sends over its secondary interfaces. It then looks for a trigger event (running an archiving tool) and checks if a subsequent network connection on a secondary interface violates the established high-water mark (98th percentile). This approach is more flexible than a fixed threshold and adapts to the normal behavior of each host."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 5156"
      - "Zeek conn.log"
      - "Endpoints"
      - "File servers hosting sensitive data"
      - "Network egress points"
      - "Data Loss Prevention (DLP) sensor locations"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "CALCULATE 98th percentile of daily outbound bytes for each host's secondary interfaces using 30 days of data. MONITOR for process chains where archiving_tool_process is followed by network_connection on secondary interface within 5 mins. ALERT if connection_bytes > host_98th_percentile_threshold."
  - question: "Does a time-series forecasting model detect a significant and unexpected spike in outbound data volume on a secondary network interface?"
    context: "This question applies time-series analysis to find anomalies in network traffic volume. An ARIMA model learns the regular rhythm and volume of a host's traffic and predicts the expected volume for the near future. An alert is generated when the actual observed traffic massively exceeds the prediction, indicating a sudden, anomalous burst of data transfer that could be exfiltration, especially if it coincides with other suspicious activity."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 5156"
      - "Zeek conn.log"
      - "Endpoints"
      - "File servers hosting sensitive data"
      - "Network egress points"
      - "Data Loss Prevention (DLP) sensor locations"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "MODEL outbound traffic volume on secondary interfaces using ARIMA. AGGREGATE traffic in 5-minute intervals. ALERT when observed_volume significantly exceeds model's predicted confidence interval. CORRELATE alert with recent archiving or network command events."
  - question: "Is traffic on a secondary network interface using a non-standard port for exfiltration or a User-Agent string associated with a known malicious tool?"
    context: "This question hunts for simple, signature-based indicators of malicious activity. Adversaries may use uncommon ports to bypass firewall rules or use tools with hardcoded User-Agent strings. By checking traffic against watchlists of known-bad ports and signatures, analysts can quickly identify common exfiltration tools and techniques."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek ssl.log"
      - "Network traffic sensors at egress points"
      - "Wireless Access Points"
      - "Endpoints with packet monitoring agents"
      - "Cloud Access Security Brokers (CASBs)"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "SEARCH network logs for traffic on secondary interfaces. ALERT where destination_port in (53, 6667, 8888, ...) AND protocol is not DNS OR where http_user_agent matches T1011_tool_signatures."
  - question: "Has a network connection on a secondary interface deviated from its established baseline in terms of data volume, duration, destination port, or TLS fingerprint (JA3)?"
    context: "This question performs multi-dimensional baselining of network connections for each host. It learns what is 'normal' for a host's secondary interface traffic across several metrics. An alert is triggered when a new connection is an outlier in any of these dimensions—for example, it lasts much longer, sends much more data, uses a port never seen before by that host, or uses a rare client-side TLS implementation (JA3 hash). This can detect novel or customized exfiltration tools."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek ssl.log"
      - "Network traffic sensors at egress points"
      - "Wireless Access Points"
      - "Endpoints with packet monitoring agents"
      - "Cloud Access Security Brokers (CASBs)"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "PROFILE normal behavior for each host's secondary interface (99th percentile for bytes/duration, common ports, common JA3 hashes) using 30 days of data. ALERT on new connections that exceed percentiles, use a new port, or present a rare JA3 hash."
  - question: "Does an unsupervised clustering model identify a network connection on a secondary interface as a 'noise' point, meaning it does not fit into any cluster of normal behavior?"
    context: "This question uses clustering to define 'normal' behavior in a data-driven way. The DBSCAN algorithm groups similar connections into clusters. Connections that are too dissimilar to belong to any group are labeled as 'noise' or anomalies. This is a powerful technique for identifying unique, outlier connections that represent a significant deviation from established patterns and may correspond to malicious activity."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek ssl.log"
      - "Network traffic sensors at egress points"
      - "Wireless Access Points"
      - "Endpoints with packet monitoring agents"
      - "Cloud Access Security Brokers (CASBs)"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "APPLY DBSCAN clustering to network logs from secondary interfaces using features like log(bytes), log(duration), port, protocol. ALERT on any new connection that is classified as a noise point by the algorithm."
  - question: "Has a network connection been initiated over a secondary interface by an application not on the network-capable allowlist, or by a legitimate application running from an unusual location?"
    context: "This question focuses on the origin of the network traffic. It operates on the principle of application allowlisting. Any network activity from an unexpected process (like notepad.exe) is suspicious. Furthermore, even legitimate tools like PowerShell are suspicious if they are running from a temporary or user-writable directory, a common tactic for adversaries to evade detection."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 5156"
      - "Zeek conn.log"
      - "All Windows endpoints and servers"
      - "Virtual Desktop Infrastructure (VDI) instances"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "MAINTAIN allowlist of process paths for network-aware apps. JOIN process (4688) and network (5156) events. ALERT when connection is on secondary interface AND (process_path is not in allowlist OR process_path contains 'C:\\Users\\', 'C:\\Temp\\')."
  - question: "Has a highly unusual or previously unseen combination of process, parent process, and network interface been observed making a network connection?"
    context: "This question analyzes the entire execution context to find anomalies. It establishes a baseline of normal process execution chains that lead to network activity. A triple (e.g., svchost.exe spawning powershell.exe which uses the Wi-Fi adapter) might be common. An alert on a rare or new triple (e.g., winword.exe spawning rundll32.exe which uses the Bluetooth adapter) points to a highly suspicious execution flow that warrants investigation."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 5156"
      - "Zeek conn.log"
      - "All Windows endpoints and servers"
      - "Virtual Desktop Infrastructure (VDI) instances"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "BASELINE frequency of all (Process Path, Parent Path, Interface Type) triples across the enterprise over 30 days. ALERT on the observation of any new triple with a frequency < 0.01% or that is previously unseen."
  - question: "Has a network connection been initiated by a process whose file path is scored as likely malicious by a machine learning model, in conjunction with other anomalous network indicators?"
    context: "This question uses a multi-stage machine learning approach. First, a model analyzes the lexical properties of a process's file path to determine if it looks suspicious (e.g., high entropy, located in a temp folder). This 'malicious path score' is then used as a feature in a larger anomaly detection system. A connection from a process with a high malicious path score that also exhibits unusual network behavior (e.g., large data transfer) would generate a high-confidence alert."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 5156"
      - "Zeek conn.log"
      - "All Windows endpoints and servers"
      - "Virtual Desktop Infrastructure (VDI) instances"
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "SCORE process path legitimacy using a lexical ML model. USE this score as a feature in a network anomaly detection system. ALERT when a connection on a secondary interface comes from a process with a high 'malicious path' score AND exhibits other network anomalies (e.g., high byte count, unusual port)."