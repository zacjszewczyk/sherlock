name: 'T1667: Email Bombing'
id: 'f4b1e5a0-1c8e-4a7b-8c9d-0e1f2a3b4c5d'
description: 'This playbook helps determine if an adversary is attempting to impact network or data availability and integrity using email bombing. It provides investigative steps to detect email bombing through several indicators, including: matching inbound SMTP traffic against threat intelligence; identifying when a single recipient receives a high volume of emails from numerous unique senders with similar subjects (a sign of subscription bombing); detecting internal hosts making anomalous numbers of HTTP POST requests containing corporate emails to unique domains; flagging when inbound email volume or SMTP connection rates exceed statistically derived thresholds; and identifying suspicious host activity immediately following an email bomb, which may indicate the bombing is a distraction for a concurrent attack.'
type: 'technique'
related: 'TA0040: Impact'
contributors: 'Zachary Szewczyk, Ask Sage'
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: 'none'
questions:
  - question: 'Is inbound SMTP traffic matching known email bombing indicators from threat intelligence feeds?'
    context: 'This question aims to perform a first-pass detection by checking inbound email metadata (sender IP, HELO domain, sender domain, subject) against a curated list of known malicious indicators associated with email bombing campaigns. A match provides a strong initial signal of a potential attack.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek smtp.log'
      - 'Mail Transfer Agent (MTA) servers'
      - 'Email security gateway'
      - 'Perimeter firewalls'
      - 'Threat Intelligence Platform (TIP)'
    range: 'last 90 days'
    queries:
      - 'SEARCH Zeek smtp.log AND conn.log JOIN threat_intelligence_feed ON sender_ip, helo_domain, from_domain, subject WHERE match_found'
  - question: 'Is a single recipient being targeted by a coordinated campaign from multiple malicious senders identified by threat intelligence?'
    context: 'This question builds upon the initial threat intelligence match. By aggregating the malicious indicators by recipient, it helps differentiate between random spam and a targeted, high-volume attack (email bomb) against a specific individual. Identifying more than 10 unique malicious senders targeting one person elevates the severity, as it suggests a concerted effort.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek smtp.log'
      - 'Mail Transfer Agent (MTA) servers'
      - 'Email security gateway'
      - 'Perimeter firewalls'
      - 'Threat Intelligence Platform (TIP)'
    range: 'last 90 days'
    queries:
      - 'SEARCH traffic_matching_ioc_rule | GROUP BY recipient | COUNT unique sender_ip, unique from_domain OVER 10_minute_window | WHERE unique_sender_count > 10'
  - question: 'Can we confirm the maliciousness of an email that matches a threat intelligence indicator using a machine learning model?'
    context: 'This question adds a layer of machine learning-based verification to reduce false positives from threat intelligence feeds. By scoring various features of an email (sender reputation, IP info, content), it provides a confidence score. An email that both matches a known bad indicator and receives a high maliciousness score is highly likely to be part of an attack, warranting an immediate, critical response.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek smtp.log'
      - 'Mail Transfer Agent (MTA) servers'
      - 'Email security gateway'
      - 'Perimeter firewalls'
      - 'Threat Intelligence Platform (TIP)'
    range: 'last 90 days'
    queries:
      - 'SEARCH traffic_matching_ioc_rule | INVOKE ml_classification_model | WHERE model_score > 0.8'
  - question: 'Is a single recipient receiving an unusually high volume of emails from many different senders with nearly identical subjects?'
    context: 'This question aims to detect subscription bombing, a common email bombing technique. Attackers often use automated scripts to sign a victim up for numerous newsletters or services, resulting in a flood of confirmation emails. This pattern is characterized by many unique senders (the services) but highly similar subject lines (e.g., "Confirm your subscription").'
    answer_sources:
      - 'Zeek smtp.log'
      - 'Zeek conn.log'
      - 'Mail Transfer Agent (MTA) servers'
      - 'Email security gateway'
    range: 'last 90 days'
    queries:
      - 'SEARCH Zeek smtp.log, conn.log | GROUP BY recipient OVER 5_minute_window | COUNT unique sender_ip | CALCULATE percentage_identical_subjects | WHERE unique_sender_ip_count > 20 AND identical_subject_percentage > 80'
  - question: 'Does the pattern of incoming emails for a recipient show high sender diversity combined with high subject similarity?'
    context: 'This is a more sophisticated statistical approach to detecting subscription bombs. High Shannon entropy in sender domains indicates a wide, random-seeming variety of sources, while high Jaccard similarity in subject lines indicates the content is very much the same. The combination of these two metrics is a powerful statistical fingerprint for a subscription bombing campaign.'
    answer_sources:
      - 'Zeek smtp.log'
      - 'Zeek conn.log'
      - 'Mail Transfer Agent (MTA) servers'
      - 'Email security gateway'
    range: 'last 90 days'
    queries:
      - 'SEARCH Zeek smtp.log, conn.log | GROUP BY recipient OVER 5_minute_window | CALCULATE shannon_entropy(from_domain), jaccard_similarity(subjects) | WHERE entropy > 4.0 AND similarity > 0.9'
  - question: 'Can we use clustering algorithms to identify dense groups of emails that point to an email bombing event?'
    context: 'This question uses unsupervised machine learning to find attacks without pre-defined rules. DBSCAN can identify "dense" regions in the data. By representing emails with features like recipient, subject hash, and sender domain, a dense cluster would represent a large group of emails sent to the same person with very similar subjects from different domainsâ€”the classic signature of an email bomb.'
    answer_sources:
      - 'Zeek smtp.log'
      - 'Zeek conn.log'
      - 'Mail Transfer Agent (MTA) servers'
      - 'Email security gateway'
    range: 'last 90 days'
    queries:
      - 'SEARCH Zeek smtp.log, conn.log IN 5_minute_batches | APPLY DBSCAN on features(recipient, fuzzy_hash(subject), sender_tld) | WHERE cluster_size > 20'
  - question: 'Is an internal host sending a high volume of sign-up requests containing a corporate email address to many different websites?'
    context: 'This question shifts focus from the victim (email recipient) to the source of a subscription bomb, which could be a compromised internal machine or a malicious script. By monitoring outbound HTTP POST requests that contain an internal email address in the body, we can detect a host that is being used to perpetrate a subscription bomb against a target.'
    answer_sources:
      - 'Zeek http.log'
      - 'Zeek dns.log'
      - 'Windows Event ID 4688'
      - 'Web proxies'
      - 'DNS resolvers'
      - 'Egress points of the network'
      - 'User workstations'
    range: 'last 90 days'
    queries:
      - 'SEARCH Zeek http.log WHERE http_method == "POST" AND post_body contains "@yourcompany.com" | GROUP BY source_ip OVER 10_minute_window | COUNT unique destination_host | WHERE unique_host_count > 15'
  - question: 'Is an internal host exhibiting anomalous sign-up behavior compared to its own historical baseline?'
    context: 'This question aims to improve detection accuracy by personalizing it for each host. Instead of a single static threshold for all hosts, this method creates a dynamic baseline of normal sign-up activity for each machine. An alert is triggered only when a host dramatically deviates from its own typical behavior, reducing false positives from, for example, a marketing team member who legitimately signs up for many services.'
    answer_sources:
      - 'Zeek http.log'
      - 'Zeek dns.log'
      - 'Windows Event ID 4688'
      - 'Web proxies'
      - 'DNS resolvers'
      - 'Egress points of the network'
      - 'User workstations'
    range: 'last 90 days'
    queries:
      - 'SEARCH Zeek http.log WHERE http_method == "POST" AND post_body contains "@yourcompany.com" | CALCULATE daily_unique_domain_count per source_ip | COMPARE count to 30-day_rolling_baseline(source_ip) | ALERT if count > 99th_percentile OR count > 3_std_dev'
  - question: 'Is the overall network-wide volume of sign-up activity anomalously high compared to a predictive time-series model?'
    context: 'This question provides a network-level view. It uses a time-series model to learn the normal "rhythm" of sign-up activity across the entire organization, accounting for time-of-day and day-of-week patterns. An alert is triggered when the total activity significantly surpasses the model''s prediction, which can indicate a large-scale, bot-driven campaign originating from one or more internal hosts.'
    answer_sources:
      - 'Zeek http.log'
      - 'Zeek dns.log'
      - 'Windows Event ID 4688'
      - 'Web proxies'
      - 'DNS resolvers'
      - 'Egress points of the network'
      - 'User workstations'
    range: 'last 90 days'
    queries:
      - 'AGGREGATE network_wide_signup_count per hour | APPLY time_series_model(Prophet) | ALERT if observed_count > predicted_upper_bound'
  - question: 'Is the volume of email to a single recipient or the connection rate to the mail server exceeding predefined static thresholds?'
    context: 'This question provides a simple, brute-force detection method based on fixed limits. While less sophisticated, it serves as a valuable first line of defense to catch egregious volumetric attacks. Tiered thresholds allow for a graduated response, distinguishing between a potential issue and a clear, server-impacting crisis.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek smtp.log'
      - 'Mail Transfer Agent (MTA) servers'
      - 'Email security gateway'
      - 'Network load balancers'
    range: 'last 90 days'
    queries:
      - 'SEARCH Zeek smtp.log, conn.log | COUNT emails per recipient per minute, connections per server per minute | ALERT on tiered_thresholds (e.g., recipient_count > 50, server_connections > 1000)'
  - question: 'Is the current email volume for a specific recipient or the server anomalous compared to its own historical baseline for this specific time?'
    context: 'This question improves upon static thresholds by using dynamic, entity-specific baselines. It learns what is "normal" for each user and for the server at different times (e.g., Tuesday afternoon vs. Sunday morning). An alert is triggered when traffic significantly exceeds this learned normal, making it highly effective at spotting unusual spikes while ignoring normal high-traffic periods.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek smtp.log'
      - 'Mail Transfer Agent (MTA) servers'
      - 'Email security gateway'
      - 'Network load balancers'
    range: 'last 90 days'
    queries:
      - 'SEARCH Zeek smtp.log, conn.log | CALCULATE volume per 5_min_interval for each entity (recipient, server) | COMPARE current volume to 30-day_baseline for that entity and time_window | ALERT if volume > 99th_percentile'
  - question: 'Does the current pattern of mail flow deviate from complex, non-linear patterns learned by a deep learning model?'
    context: 'This is the most advanced volumetric detection method. An LSTM Autoencoder learns the intricate, multi-variable patterns of normal mail flow. It doesn''t just look at volume, but the relationships between different metrics over time. An email bomb disrupts this normal pattern. The model will fail to "reconstruct" this abnormal pattern accurately from its learned knowledge, resulting in a high "reconstruction error" and a high-fidelity alert.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek smtp.log'
      - 'Mail Transfer Agent (MTA) servers'
      - 'Email security gateway'
      - 'Network load balancers'
    range: 'last 90 days'
    queries:
      - 'STREAM Zeek smtp.log, conn.log data to LSTM_Autoencoder_model | MONITOR reconstruction_error | ALERT if reconstruction_error > threshold'
  - question: 'Following an email bomb targeting a user, is that user''s host executing suspicious tools or connecting to known malicious IPs?'
    context: 'This question addresses the critical scenario where an email bomb is used as a distraction. The flood of emails is meant to overwhelm the security team while the real attack (e.g., remote access tool deployment) occurs. This rule directly links the email bomb event to subsequent high-risk host activity, such as running AnyDesk or connecting to a C2 server, to immediately flag the more dangerous underlying attack.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek dns.log'
      - 'Windows Event ID 5156'
      - 'Windows Event ID 4688'
      - 'User endpoints'
      - 'Domain Controllers'
      - 'Internal network segments'
      - 'DNS resolvers'
      - 'Egress firewalls'
    range: 'last 90 days'
    queries:
      - 'ON email_bomb_alert(user) | SEARCH host_activity(user.host) for next 60_mins | WHERE process_name IN (rat_watchlist) OR destination_ip IN (ti_blocklist)'
  - question: 'Following an email bomb, is the targeted user''s host making rare or first-time network connections?'
    context: 'This question looks for subtle indicators of a follow-on attack by baselining the user''s host network activity. An attacker''s C2 server domain is likely to be rare or new to the organization. By flagging connections to exceptionally unpopular domains or to Autonomous Systems the host has never contacted before, we can detect novel C2 channels that might be missed by signature-based rules.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek dns.log'
      - 'Windows Event ID 5156'
      - 'Windows Event ID 4688'
      - 'User endpoints'
      - 'Domain Controllers'
      - 'Internal network segments'
      - 'DNS resolvers'
      - 'Egress firewalls'
    range: 'last 90 days'
    queries:
      - 'ON email_bomb_alert(user) | ANALYZE user.host.network_traffic vs 30-day_baseline | ALERT if destination_domain_rarity < 1% OR destination_asn is new'
  - question: 'Does the overall behavior of the targeted user''s host (processes, network connections) appear anomalous to a machine learning model following an email bomb?'
    context: 'This question uses a holistic, model-based approach to detect follow-on attacks. An Isolation Forest or similar model is trained on the normal "behavior" of a user''s host (common processes, parent-child relationships, network patterns). Activity during or after an email bomb is then scored. If the new activity is "isolated" by the model as a significant outlier, it indicates a deviation from normal behavior that is likely malicious, even if no single action triggered a specific rule.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek dns.log'
      - 'Windows Event ID 5156'
      - 'Windows Event ID 4688'
      - 'User endpoints'
      - 'Domain Controllers'
      - 'Internal network segments'
      - 'DNS resolvers'
      - 'Egress firewalls'
    range: 'last 90 days'
    queries:
      - 'ON email_bomb_alert(user) | STREAM user.host.activity_data to Isolation_Forest_model | ALERT if activity is flagged as outlier'