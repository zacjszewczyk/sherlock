name: T1485: Data Destruction
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps investigate whether an adversary is actively destroying or overwriting data on critical systems to disrupt operations. It focuses on detecting known data destruction tools via hash matching, the misuse of legitimate system utilities for wiping data, anomalous high volumes of file deletions or modifications, files being overwritten with low-entropy content, and targeted deletion of critical system files or backups like Volume Shadow Copies.
type: technique
related:
  - TA0040: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
investigative_questions:
  - question: Has a process been executed whose file hash matches a known data destruction tool?
    context: This question aims to identify the most direct evidence of a data destruction attack by matching process hashes against a threat intelligence feed of known wiper malware like WhisperGate or NotPetya. A match is a high-confidence indicator of malicious activity.
    answer_sources:
      - Windows Event ID 4688
      - EDR Process Creation Logs
      - Applicable to NAI: Domain Controllers, File Servers, Database Servers, Critical Application Servers, User Workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH process_creation_logs | HASH process_image | LOOKUP against known_wiper_hashes | ALERT on match
  - question: Is a rare or new process executing that also matches YARA rules for destructive malware?
    context: This question focuses on identifying previously unseen or rare executables that exhibit characteristics of destructive malware. By combining hash prevalence analysis with YARA rule matching, it helps uncover novel or custom-compiled wipers that may not be in standard threat intelligence feeds.
    answer_sources:
      - Windows Event ID 4688
      - EDR Process Creation Logs
      - Applicable to NAI: Domain Controllers, File Servers, Database Servers, Critical Application Servers, User Workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH process_creation_logs | CALCULATE hash_prevalence | IF prevalence < 0.1% AND MATCHES_YARA_rule('destructive_malware') | ALERT
  - question: Has a machine learning model classified a new executable as a 'wiper' or 'destructive' tool with high confidence?
    context: This question leverages machine learning to proactively identify destructive executables based on their intrinsic features (like PE header info, entropy, etc.), rather than relying solely on known signatures. A high-confidence classification can provide an early warning of a potential attack.
    answer_sources:
      - Windows Event ID 4688
      - EDR Process Creation Logs
      - Applicable to NAI: Domain Controllers, File Servers, Database Servers, Critical Application Servers, User Workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: ON new_executable_observed | EXTRACT features (PE header, entropy) | CLASSIFY with ML_model | IF classification is 'wiper' AND confidence > 0.9 | TRIGGER_IR_WORKFLOW
  - question: Has a legitimate system utility been executed with command-line arguments known to perform irreversible data wiping?
    context: Adversaries often misuse legitimate tools ("living off the land") to avoid detection. This question looks for specific, unambiguous command-line patterns associated with tools like `sdelete`, `cipher`, and `format` that indicate an intent to destroy data, not perform routine administrative tasks.
    answer_sources:
      - Windows Event ID 4688
      - EDR Process Creation Logs
      - Applicable to NAI: Domain Controllers, File Servers, Critical System Partitions, User Workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH process_creation_logs | FILTER for process_name IN ('sdelete.exe', 'cipher.exe', 'format.com', 'wevtutil.exe') | REGEX_MATCH command_line against destructive_patterns | ALERT on match
  - question: Is a common system utility being used with an unusually rare combination of command-line arguments?
    context: This question aims to detect abuse of legitimate utilities by identifying statistically anomalous usage. While a tool might be common, a specific combination of its arguments might be extremely rare in a given environment and could indicate malicious use, especially when executed by an unusual user or process.
    answer_sources:
      - Windows Event ID 4688
      - EDR Process Creation Logs
      - Applicable to NAI: Domain Controllers, File Servers, Critical System Partitions, User Workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH process_creation_logs | CALCULATE argument_frequency | IF frequency < 1st_percentile | FLAG for review
  - question: Has a sequence of command-line executions been detected that deviates significantly from normal, learned behavior?
    context: This question moves beyond single commands to analyze the sequence of actions. An adversary's activity may appear as an anomalous sequence of commands, even if each individual command is benign. A sequence model can detect these unusual chains of events that signal malicious intent.
    answer_sources:
      - Windows Event ID 4688
      - EDR Process Creation Logs
      - Applicable to NAI: Domain Controllers, File Servers, Critical System Partitions, User Workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: STREAM command_line_history to LSTM_model | CALCULATE anomaly_score for new sequences | IF score > threshold | FLAG for investigation
  - question: Has a single process generated an extremely high number of file deletion events in a very short time frame?
    context: This question uses a simple, high-volume threshold to detect "smash and grab" data destruction. A legitimate process is unlikely to delete over a thousand files in one minute, making this a strong indicator of a ransomware or wiper payload executing.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Zeek files.log
      - File Integrity Monitoring (FIM) Agent Logs
      - Applicable to NAI: Network File Shares (SMB/NFS), Document Management Systems, User Profile Directories, Source Code Repositories
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH file_deletion_events (EventID 4663) | GROUP BY ProcessID over 60s window | IF count > 1000 | ALERT
  - question: Is a user or host exhibiting a rate of file modifications or deletions that is a statistical outlier compared to their own historical baseline?
    context: This question provides a more nuanced approach than a fixed threshold by creating a personalized baseline of activity for each user and host. It can detect slower, more methodical destruction that might not trigger a simple volume alert but is still highly abnormal for that specific entity.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Zeek files.log
      - File Integrity Monitoring (FIM) Agent Logs
      - Applicable to NAI: Network File Shares (SMB/NFS), Document Management Systems, User Profile Directories, Source Code Repositories
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR each user/host | CALCULATE baseline (mean, stddev) of file_ops/minute | CHECK current rate | IF rate > (mean + 4*stddev) for > 3 minutes | ALERT
  - question: Has a time-series model detected an anomalous spike in file operation activity that violates learned seasonal patterns?
    context: This question uses advanced time-series analysis to model the natural rhythm (e.g., daily, weekly cycles) of file activity on critical systems. This allows it to detect anomalous spikes with high precision, filtering out legitimate high-activity periods like backup windows.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Zeek files.log
      - File Integrity Monitoring (FIM) Agent Logs
      - Applicable to NAI: Network File Shares (SMB/NFS), Document Management Systems, User Profile Directories, Source Code Repositories
    range: last 90 days
    queries:
      - technology: pseudocode
        query: STREAM file_operation_counts to ARIMA_model | IF new_count is outside confidence_interval | ALERT
  - question: Following a mass file modification event, do the modified files contain content patterns indicative of wiping (e.g., all null bytes or a specific pattern)?
    context: This question provides a direct method for confirming data destruction. After a large number of files are changed, sampling a few and checking their contents for simple overwrite patterns (like all zeros) or known wiper signatures is a definitive way to verify malicious intent.
    answer_sources:
      - File Integrity Monitoring (FIM) Agent Logs
      - EDR Telemetry
      - Zeek files.log
      - Zeek file_entropy.log
      - Applicable to NAI: User Workstations, Web Servers, File Servers, Database Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: ON mass_file_write_event | SAMPLE modified_files | IF content == '0x00...' OR content matches wiper_pattern | ALERT
  - question: Do files modified during a mass-write event exhibit abnormally low or high Shannon entropy compared to their expected type?
    context: This question uses information theory to detect data destruction. Overwriting a file with null bytes or a simple repeating pattern results in very low entropy, while overwriting with random data results in very high entropy. Either extreme, when seen across many files of a known type, is a strong signal of wiping.
    answer_sources:
      - File Integrity Monitoring (FIM) Agent Logs
      - EDR Telemetry
      - Zeek files.log
      - Zeek file_entropy.log
      - Applicable to NAI: User Workstations, Web Servers, File Servers, Database Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: ON mass_file_write_event | SAMPLE modified_files | CALCULATE entropy | IF entropy < 2.0 OR entropy > 7.99 for known file types | ALERT
  - question: Has a clustering algorithm identified a new group of files, created in a burst, that are characterized by anomalous entropy?
    context: This question uses unsupervised machine learning to find "the unknown unknowns." By clustering files based on features like type, size, and entropy, it can automatically identify a new, anomalous group of files appearing suddenly, which often corresponds to a coordinated malicious event like data wiping.
    answer_sources:
      - File Integrity Monitoring (FIM) Agent Logs
      - EDR Telemetry
      - Zeek files.log
      - Zeek file_entropy.log
      - Applicable to NAI: User Workstations, Web Servers, File Servers, Database Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: CLUSTER files by features (type, size, entropy) | IF new_burst_of_files forms a new_cluster with anomalous_entropy | ALERT
  - question: Has a command been executed to delete Volume Shadow Copies, system backups, or critical OS files?
    context: This question targets a common adversary precursor to ransomware and wiper attacks: eliminating recovery options. Monitoring for specific commands like 'vssadmin delete shadows' or direct deletion attempts on files like ntds.dit is crucial for detecting an attacker's attempt to make their impact irreversible.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Applicable to NAI: System Boot Partitions (EFI), C:\Windows\System32\config\ (SAM, SYSTEM hives), Volume Shadow Copy Storage Areas
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH process_creation_logs for command_line CONTAINS ('vssadmin.exe delete shadows', 'wbadmin.exe delete catalog') OR SEARCH file_delete_events on critical_file_watchlist from non-system_process | ALERT
  - question: Is a utility known for deleting backups or critical files being executed by an unusual parent process?
    context: This question focuses on detecting illegitimate execution chains. System utilities have predictable parent processes (e.g., explorer.exe, cmd.exe). When a sensitive utility like 'vssadmin.exe' is spawned by a web server process ('w3wp.exe') or a Microsoft Office application, it's a strong indicator of compromise and malicious activity.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Applicable to NAI: System Boot Partitions (EFI), C:\Windows\System32\config\ (SAM, SYSTEM hives), Volume Shadow Copy Storage Areas
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH process_creation_logs WHERE process_name is 'vssadmin.exe' | CHECK parent_process_name | IF parent is NOT in whitelist (explorer.exe, cmd.exe, etc.) | ALERT
  - question: Has a user account with a non-administrative profile suddenly started executing a series of commands associated with system administration and data destruction?
    context: This question aims to detect privilege escalation and account compromise by monitoring for behavioral shifts. A standard user account that has been profiled as 'Business User' should never be executing commands to delete shadow copies. Such a shift is a high-fidelity indicator that the account is compromised and being used for destructive purposes.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Applicable to NAI: System Boot Partitions (EFI), C:\Windows\System32\config\ (SAM, SYSTEM hives), Volume Shadow Copy Storage Areas
    range: last 90 days
    queries:
      - technology: pseudocode
        query: MODEL user_behavior based on command history | IF user_profile is 'Standard' AND executes 'vssadmin.exe' | ALERT on behavioral_anomaly