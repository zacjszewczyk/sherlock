name: T1136.002: Domain Account
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: This playbook helps investigate whether an adversary is creating new domain accounts to maintain persistence. Indicators of this activity include domain account creation events linked to malicious parent processes or originating from high-risk hosts; command-line arguments on Domain Controllers containing keywords like "net user /add /domain" or "New-ADUser"; account creation events with statistically rare attributes (e.g., time of day, source workstation); anomalous behavior from a new account within its first 48 hours, such as logging into an excessive number of systems; and the immediate addition of a new account to a high-privilege group.
type: technique
related:
  - TA0003: Persistence
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Was a domain account created by a process with a known malicious hash?
    context: Adversaries may use malicious tools to create persistence accounts. Linking the account creation event (Windows Event ID 4720) to its parent process (Windows Event ID 4688) and checking the parent process's file hash against threat intelligence can directly identify known malicious activity.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4688
      - Threat Intelligence Feed
      - Domain Controllers
      - Log Aggregation Platform (SIEM)
      - Endpoint Detection and Response (EDR) Platform
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each event_4720, FIND parent_process_event_4688 by ProcessID. EXTRACT parent_process_hash. QUERY threat_intel_feed FOR hash. ALERT on match.
  - question: Was a domain account created from a host with an anomalously high risk score?
    context: Compromised systems often exhibit a pattern of suspicious activities, which can be aggregated into a risk score. An account creation originating from a high-risk host suggests the creation may be part of a broader attack chain rather than a legitimate administrative action.
    answer_sources:
      - Windows Event ID 4720
      - Security Alert Data (AV, IDS, etc.)
      - Domain Controllers
      - Log Aggregation Platform (SIEM)
      - Endpoint Detection and Response (EDR) Platform
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each event_4720, GET source_host. GET risk_score FOR source_host. IF risk_score > baseline_95th_percentile, ALERT.
  - question: Does a machine learning model classify a domain account creation event as malicious?
    context: Legitimate account creations often follow predictable patterns. A supervised machine learning model can learn these patterns from historical data (e.g., parent process, command line, time of day) and identify new account creations that deviate significantly, flagging them as potentially malicious with a high degree of confidence.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4688
      - Historical Incident Data
      - Domain Controllers
      - Log Aggregation Platform (SIEM)
      - Endpoint Detection and Response (EDR) Platform
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each event_4720, GATHER features (parent_process, command_line, user, host, time). INPUT to ML_model. IF model_score > 0.8, ALERT.
  - question: Was a domain account created using specific command-line utilities like 'net.exe' or 'New-ADUser' on a Domain Controller?
    context: Adversaries frequently use built-in Windows command-line tools (`net.exe`) or PowerShell cmdlets (`New-ADUser`) to create accounts. Directly monitoring for the execution of these commands with specific arguments on Domain Controllers is a high-fidelity way to detect account creation attempts.
    answer_sources:
      - Windows Event ID 4688
      - Domain Controllers
      - Administrative Workstations
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH event_4688 on Domain_Controllers WHERE (command_line CONTAINS "net user /add /domain") OR (command_line CONTAINS "New-ADUser"). ALERT on match.
  - question: Did a process creating a domain account on a Domain Controller have an unusually complex or obfuscated command line?
    context: To evade simple keyword-based detections, adversaries may obfuscate their commands. A high Shannon entropy score for a command-line string suggests a high degree of randomness, which can be an indicator of obfuscation or encoding, deviating from typical, human-readable administrative commands.
    answer_sources:
      - Windows Event ID 4688
      - Domain Controllers
      - Administrative Workstations
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each event_4688 on Domain_Controllers, CALCULATE entropy of command_line. IF entropy > (baseline_for_process + 3*std_dev), ALERT.
  - question: Does the command line used for account creation deviate from historically normal patterns of administrative commands?
    context: Legitimate administrative commands, even when varied, tend to fall into predictable thematic groups (topics). Using NLP topic modeling can establish a baseline of these normal command structures. A command line that doesn't fit into any known legitimate topic is anomalous and could represent a novel or malicious technique.
    answer_sources:
      - Windows Event ID 4688
      - Domain Controllers
      - Administrative Workstations
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each event_4688 on Domain_Controllers with account_creation_keywords, CLASSIFY command_line against NLP_topic_model. IF classification is low-confidence or forms new_low_volume_cluster, ALERT.
  - question: Was a domain account created by an unauthorized user or from an unauthorized workstation?
    context: Organizations typically restrict administrative actions like account creation to a specific set of privileged user accounts and designated secure administrative workstations. An account creation that violates this policy is a significant security concern and may indicate a compromised account or an insider threat.
    answer_sources:
      - Windows Event ID 4720
      - Active Directory
      - Domain Controllers
      - Human Resources Systems
      - Help Desk Ticketing Systems
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each event_4720, GET creator_user and source_workstation. IF creator_user NOT IN authorized_user_list OR source_workstation NOT IN authorized_workstation_list, ALERT.
  - question: Was a domain account created by a legitimate administrator at an unusual time (e.g., outside of normal business hours)?
    context: Even legitimate administrators have patterns of behavior. An account creation that occurs at a time that is statistically rare for a specific administrator (e.g., 3 AM on a Sunday) could indicate that their account has been compromised and is being used by an adversary.
    answer_sources:
      - Windows Event ID 4720
      - Active Directory
      - Domain Controllers
      - Human Resources Systems
      - Help Desk Ticketing Systems
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each event_4720, GET creator_user and event_time. LOOKUP historical_time_profile for creator_user. IF probability_of_event_time < 5th_percentile, ALERT.
  - question: Does an anomaly detection model flag the metadata of a domain account creation event as an outlier?
    context: Anomaly detection models can analyze multiple features of an event simultaneously (e.g., creating user, source host, time of day) to find unusual combinations that might not be obviously suspicious when viewed in isolation. This provides a powerful way to detect novel or subtle malicious activity that doesn't match predefined rules.
    answer_sources:
      - Windows Event ID 4720
      - Active Directory
      - Domain Controllers
      - Human Resources Systems
      - Help Desk Ticketing Systems
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each event_4720, GATHER features (creator, source_ip, time). INPUT to anomaly_detection_model. IF model flags as anomaly/outlier, ALERT.
  - question: Did a newly created domain account immediately perform a high-risk logon, such as an interactive logon to a 'Crown Jewel' asset?
    context: Legitimate new user accounts typically do not immediately log into highly sensitive systems like Domain Controllers or critical database servers. Such activity by a brand-new account is highly suspicious and could indicate that the account was created specifically for the purpose of accessing valuable assets.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek dns.log
      - Domain Controllers
      - Critical Servers
      - Network Gateway/Egress Points
      - Endpoint Devices
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: ON new account_creation (event_4720), MONITOR account_sid for 48h. IF first logon (event_4624) is to 'Crown_Jewel_Asset' AND logon_type is (2 OR 10), ALERT.
  - question: Did a newly created domain account log into an anomalously high number of distinct systems within its first 48 hours?
    context: After an adversary creates a new account, they may use it to move laterally across the network, logging into multiple systems to search for data or further access. A new account logging into an unusually large number of hosts is a strong indicator of this type of reconnaissance and lateral movement activity.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek dns.log
      - Domain Controllers
      - Critical Servers
      - Network Gateway/Egress Points
      - Endpoint Devices
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: ON new account_creation (event_4720), COUNT distinct logon destinations (event_4624) for 48h. IF count > 99th_percentile_baseline, ALERT.
  - question: Did the network traffic generated by a new account in its first 48 hours deviate significantly from the established baseline for normal new account activity?
    context: The initial network activity of a legitimate new user often follows a predictable pattern. Adversarial activity, such as C2 communication or large data exfiltration, will produce a network traffic signature that deviates significantly from this norm.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek dns.log
      - Domain Controllers
      - Critical Servers
      - Network Gateway/Egress Points
      - Endpoint Devices
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: ON new account_creation (event_4720), MONITOR network traffic for 48h. COMPARE to time-series forecast model for new accounts. IF traffic is outside 95% prediction interval, ALERT.
  - question: Was a newly created domain account immediately added to a high-privilege group like 'Domain Admins'?
    context: An adversary creates a standard user account and then immediately elevates its privileges by adding it to a powerful administrative group. Correlating a creation event (4720) with a group addition event (4728/4732/4756) in a short time window is a critical, high-fidelity detection for this behavior.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4738
      - Windows Event ID 4728
      - Windows Event ID 4732
      - Windows Event ID 4756
      - Domain Controllers
      - Active Directory Database
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: CORRELATE event_4720 with event_4728/4732/4756 on same user_sid within 10 minutes. IF group_name is in privileged_group_list, ALERT.
  - question: Was a new domain account created with a name that is a typosquat or very similar to an existing privileged account?
    context: Adversaries create accounts with names like "Adminlstrator" or "J0hn.Smith" to trick human analysts. Calculating the string similarity (e.g., Levenshtein distance) between new account names and existing privileged account names can detect these typosquatting attempts.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4738
      - Windows Event ID 4728
      - Windows Event ID 4732
      - Windows Event ID 4756
      - Domain Controllers
      - Active Directory Database
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: ON new account_creation (event_4720), GET new_account_name. GET list of privileged_account_names. FOR each privileged_name, CALCULATE Levenshtein_distance(new_account_name, privileged_name). IF distance <= 2, ALERT.
  - question: Did the sequence of management events following a new account's creation deviate from the normal, automated provisioning workflow?
    context: Legitimate account creation is often part of a standardized, automated workflow involving a predictable sequence of events. A manual, malicious provisioning process will likely follow a different, anomalous sequence of events. Modeling the normal sequence allows for the detection of these outliers.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4738
      - Windows Event ID 4728
      - Windows Event ID 4732
      - Windows Event ID 4756
      - Domain Controllers
      - Active Directory Database
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: ON new account_creation (event_4720), CAPTURE sequence of AD management events for 1 hour. SCORE sequence probability using Markov/LSTM model. IF probability is low, ALERT.