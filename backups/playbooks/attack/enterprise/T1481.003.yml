name: "T1481.003: One-Way Communication"
id: "c1b9a8f0-8e1a-4b7c-9d6e-5a7b8c4d3f2e"
description: "This playbook helps investigate whether an adversary is using legitimate external web services for one-way command and control (C2) against corporate mobile devices. It focuses on identifying two main patterns: 1) C2-like network beaconing behavior from non-browser applications, characterized by low timing jitter, small, consistent outbound payloads, and high outbound-to-inbound byte ratios. 2) HTTP/S requests to legitimate services (like paste sites or code repositories) that exhibit malicious traits, such as high-entropy URIs, unusual User-Agents, non-standard TLS signatures (JA3), and mismatched content types, indicating the retrieval of C2 instructions."
type: "technique"
related:
  - "TA0037: Command and Control"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Is a corporate mobile device connecting to a known one-way C2 domain from a non-browser application?"
    context: "This question aims to identify high-confidence C2 activity by correlating network traffic with application data. If a mobile device's non-standard application (identified via MDM logs) is communicating with a domain known for malicious C2, it strongly suggests a compromise. This check bypasses the noise of regular user browsing by focusing on specific application behavior and known threat intelligence."
    answer_sources:
      - "Zeek dns.log"
      - "Zeek ssl.log"
      - "MDM Application Logs"
      - "Threat Intelligence Feeds"
      - "Data from: Corporate Wi-Fi access points, VPN concentrators, network egress points (Internet gateways), and the corporate Mobile Device Management (MDM) platform."
    range: "last 90 days"
    queries:
      - splunk: "JOIN Zeek DNS/SSL logs with MDM logs ON IP address; WHERE destination IN threat_intel_feed AND application NOT IN browser_allowlist; ALERT"
  - question: "Is a mobile device exhibiting automated, non-interactive network beaconing behavior indicative of C2 communication?"
    context: "This question seeks to uncover covert C2 channels that masquerade as legitimate traffic by analyzing their statistical properties. Automated malware beacons often have very regular timing (low jitter), send small 'heartbeat' packets, and receive little data in return. By aggregating connection data and looking for this specific combination of metrics (low timing deviation, small outbound payloads, high outbound/inbound ratio), analysts can identify suspicious, machine-like communication patterns that stand out from normal, interactive user activity."
    answer_sources:
      - "Zeek conn.log"
      - "Data from: Corporate Wi-Fi access points, VPN concentrators, and network egress points (Internet gateways)."
    range: "last 90 days"
    queries:
      - splunk: "AGGREGATE Zeek conn.log by source_ip, destination, dest_port over 1hr; CALCULATE stddev(time), percentile(out_bytes, 95), sum(out_bytes)/sum(in_bytes); ALERT WHERE stddev < 5 AND percentile < 1024 AND ratio > 10 AND count > 10"
  - question: "Has a mobile device's network traffic pattern deviated significantly from its established baseline, suggesting a new C2-like behavior?"
    context: "This question uses machine learning to detect subtle or novel C2 activity that may not match predefined rules. By creating a baseline of normal network behavior for each device (e.g., connection frequency, data volumes, port usage), an anomaly detection model can flag any significant deviations. A high reconstruction error indicates the current traffic is unlike anything seen before for that device, which could be caused by the activation of a previously dormant implant or a new infection."
    answer_sources:
      - "Zeek conn.log"
      - "Data from: Corporate Wi-Fi access points, VPN concentrators, and network egress points (Internet gateways)."
    range: "last 90 days"
    queries:
      - python: "TRAIN LSTM autoencoder on historical per-device Zeek conn.log features; FOR new 5-min windows, CALCULATE reconstruction_error; ALERT IF error > (rolling_avg_error + 3*stddev_error)"
  - question: "Is a mobile device making suspicious requests to high-risk web services (like paste sites) using a non-standard browser agent?"
    context: "This question targets a common TTP where malware fetches C2 instructions from legitimate content hosting sites. The query looks for a combination of red flags: traffic to a high-risk domain (e.g., pastebin), a URI pattern associated with raw content retrieval (e.g., '/raw/'), and a User-Agent that doesn't belong to a typical mobile browser. This combination is highly indicative of a script or implant, not a user, accessing the content."
    answer_sources:
      - "Zeek http.log"
      - "Data from: Corporate Wi-Fi access points, VPN concentrators, and forward proxy servers that perform TLS inspection."
    range: "last 90 days"
    queries:
      - splunk: "SEARCH Zeek http.log WHERE source_ip in mobile_range AND destination in high_risk_domains AND (uri CONTAINS '/raw/' OR uri CONTAINS '/blob/') AND user_agent NOT IN mobile_browser_list; ALERT"
  - question: "Is a mobile device's HTTP/S request anomalous when compared to its own historical activity, based on URI entropy, User-Agent, JA3 hash, and other headers?"
    context: "This question aims to detect malicious requests by identifying multiple deviations from a device's established behavioral baseline. A single anomaly might be benign, but the combination of several—such as a highly random-looking URI (high entropy), an infrequently used User-Agent and TLS client fingerprint (JA3), and a missing Referer header—creates a high-confidence signal for C2 activity. This method is effective at finding malware that tries to blend in but fails to perfectly mimic normal application behavior."
    answer_sources:
      - "Zeek http.log"
      - "Zeek ssl.log"
      - "Data from: Corporate Wi-Fi access points, VPN concentrators, and forward proxy servers that perform TLS inspection."
    range: "last 90 days"
    queries:
      - splunk: "FOR each device, BASELINE URI entropy, User-Agent, JA3, HTTP method frequency; SCORE new requests based on rarity of these features; ALERT on high composite score"
  - question: "Can a machine learning model classify an HTTP/S request from a mobile device as having a high probability of being malicious C2 traffic?"
    context: "This question leverages a supervised machine learning model, trained on previously identified good and bad traffic, to score new, unseen HTTP/S requests. By analyzing a rich set of features (URI characteristics, headers, TLS fingerprints, etc.), the model can learn complex patterns that define malicious C2 communication. This provides analysts with a probabilistic score, allowing them to prioritize the most suspicious requests for investigation."
    answer_sources:
      - "Zeek http.log"
      - "Zeek ssl.log"
      - "Labeled historical network data"
      - "Data from: Corporate Wi-Fi access points, VPN concentrators, and forward proxy servers that perform TLS inspection."
    range: "last 90 days"
    queries:
      - python: "TRAIN Random Forest classifier on labeled Zeek http/ssl logs; PREDICT 'malicious_probability' for new requests; ALERT on requests with high probability scores"