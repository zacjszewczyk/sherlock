name: "T1430.002: Impersonate SS7 Nodes"
id: "c1d8e2f0-a3b4-4c5d-8e6f-7a8b9c0d1e2f"
description: "This playbook helps identify if an adversary is attempting to discover subscriber locations or collect location data by impersonating legitimate SS7 nodes. This involves detecting unauthorized SS7 Mobile Application Part (MAP) location queries (such as SRI-SM or PSI) originating from external Global Titles (GTs) not on an approved roaming partner whitelist. The playbook also addresses methods for detecting large-scale scanning attempts, targeted tracking of individual subscribers, and confirmed exfiltration of location data to unauthorized destinations."
type: "technique"
related:
  - "TA0032: Discovery"
  - "TA0035: Collection"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: "1.0"
tags: "none"
questions:
  - question: "Are we observing location queries from Global Titles that are not on our approved roaming partner whitelist?"
    context: "This question aims to identify the most direct evidence of an impersonation attempt. An adversary may send SS7 MAP location queries (like SRI-SM or PSI) from an unauthorized source GT. By comparing the source GT of incoming location queries against a known-good whitelist of roaming partners, we can immediately flag suspicious or malicious activity. A positive match is a strong indicator of an attempt to illicitly discover subscriber locations."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways), subscriber databases (HLR/HSS), and network security monitoring platforms."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          SEARCH SGW logs and HLR logs for location query OpCodes (45, 70).
          JOIN source GT with roaming partner whitelist.
          ALERT where source GT IS NOT IN whitelist.
  - question: "Are any source Global Titles exhibiting an anomalously high ratio of location queries compared to other message types?"
    context: "Legitimate roaming partners typically engage in a variety of SS7 message exchanges. An adversary focused solely on location discovery may exhibit a skewed traffic profile, with a disproportionately high number of location queries. This question seeks to identify such statistical outliers by comparing the behavior of each source GT against a baseline of normal partner traffic. A GT that overwhelmingly sends location queries is suspicious and warrants investigation."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways), subscriber databases (HLR/HSS), and network security monitoring platforms."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          FOR each source GT, CALCULATE ratio of location queries to all messages in 24h.
          COMPARE ratio to 30-day baseline of legitimate partners.
          ALERT if ratio > 99th percentile of baseline.
  - question: "Can we use a machine learning model to classify SS7 transactions as 'suspicious' based on multiple features?"
    context: "Simple rule-based detection can be evaded. This question proposes a more sophisticated, multi-faceted approach using machine learning. By training a model on features like source GT, message type, time of day, and query frequency, we can identify complex patterns of malicious behavior that might not trigger individual rules. This allows for the detection of novel or subtle impersonation techniques, especially when prioritizing alerts for transactions from non-whitelisted GTs."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways), subscriber databases (HLR/HSS), and network security monitoring platforms."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          SCORE new SS7 transactions using trained ML model.
          ALERT if transaction is classified as 'suspicious' with confidence > 0.90.
          PRIORITIZE alerts from non-whitelisted GTs.
  - question: "Is any single source Global Title attempting to query a large number of unique subscribers in a short time frame?"
    context: "This question aims to detect large-scale scanning or reconnaissance activity. A legitimate partner is unlikely to query hundreds of unique subscribers in a single hour. An adversary, however, might perform a broad sweep to identify valid MSISDNs or map a large set of subscribers. A fixed threshold (e.g., 500 unique MSISDNs per hour) provides a clear, high-confidence indicator of this type of brute-force discovery attempt."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways) and subscriber databases (HLR/HSS)."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          FOR each source GT, COUNT distinct MSISDNs in 1-hour sliding window from HLR logs.
          ALERT if count > 500.
  - question: "Is any source Global Title querying a statistically significant, anomalous number of unique subscribers compared to its own historical behavior?"
    context: "While fixed thresholds are useful, a more adaptive approach can detect subtler attacks. This question uses statistical analysis (Z-score) to identify when a source GT deviates from its own established baseline behavior. A sudden spike in the number of unique subscribers queried, even if below a hard threshold, can be a strong indicator that the GT has been compromised or is being used for a targeted scanning campaign. A Z-score greater than 3.0 suggests a rare event that warrants investigation."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways) and subscriber databases (HLR/HSS)."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          FOR each source GT, CALCULATE hourly count of unique MSISDNs.
          COMPUTE Z-score against GT's 30-day rolling average using the formula Z = (x - μ) / σ.
          ALERT if Z-score > 3.0.
  - question: "Can we use clustering algorithms to identify anomalous source Global Titles based on their scanning behavior?"
    context: "This question leverages unsupervised machine learning to find outliers that don't fit into normal behavioral clusters. By creating a feature set that includes query volume and ratios, a density-based algorithm like DBSCAN can group legitimate partners into dense clusters. Adversarial GTs, with their unique and anomalous scanning patterns, will likely be classified as noise or outliers, providing a powerful method for discovering previously unknown threat actors without relying on pre-defined rules or signatures."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways) and subscriber databases (HLR/HSS)."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          CLUSTER source GTs using DBSCAN on features (unique MSISDN count/hr, location query ratio).
          INVESTIGATE GTs classified as noise/outliers.
  - question: "Is any non-whitelisted Global Title repeatedly querying the location of a single subscriber in a short time frame?"
    context: "This question focuses on detecting targeted tracking of a specific individual. While a single location query might be incidental, multiple queries for the same person from the same unauthorized source in a short period (e.g., 15 minutes) strongly suggests a deliberate attempt to monitor their movements. This stateful rule is designed to catch this specific, high-risk pattern of behavior."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "VLR_event_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Subscriber location databases (HLR/HSS, VLR) and the signaling gateways (SGW) that route queries to them."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          GROUP HLR logs by MSISDN and source GT.
          COUNT location queries in 15-minute sliding window.
          ALERT if count >= 3 AND source GT is non-whitelisted.
  - question: "Are certain subscribers being disproportionately queried for location by a very small number of source Global Titles?"
    context: "A typical subscriber might receive location queries from various legitimate sources over time, resulting in high entropy. This question uses information theory to detect the opposite: when a subscriber's location queries are dominated by one or very few sources, resulting in low entropy. A low entropy score for an MSISDN, calculated with the formula H(X) = -Σ p(xi) log2 p(xi), suggests that a specific actor is fixated on that individual, which is a strong indicator of targeted surveillance."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "VLR_event_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Subscriber location databases (HLR/HSS, VLR) and the signaling gateways (SGW) that route queries to them."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          FOR each MSISDN, CALCULATE Shannon entropy of source GTs over 24h.
          FLAG MSISDNs in bottom 5th percentile of entropy scores for review.
  - question: "Can a sequence-aware machine learning model identify anomalous patterns of SS7 events that indicate subscriber tracking?"
    context: "Adversarial tracking may involve more complex sequences of events than just repeated queries. This question proposes using a model like an RNN or LSTM, which excels at understanding temporal sequences. The model can learn the patterns of normal subscriber activity and flag deviations, such as a series of location queries without any subsequent legitimate activity (like a call or SMS), which could indicate an adversary is tracking a user without their knowledge."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "VLR_event_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Subscriber location databases (HLR/HSS, VLR) and the signaling gateways (SGW) that route queries to them."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          FEED sequence of SS7 events per MSISDN into RNN/LSTM model.
          INVESTIGATE MSISDNs where model flags an 'anomalous tracking pattern'.
  - question: "Are we sending successful location data responses to any destination Global Titles that are not on our approved roaming partner whitelist?"
    context: "This question is critical as it seeks to confirm the actual exfiltration of subscriber location data. While detecting suspicious queries is important, confirming that the network responded with sensitive information to an unauthorized entity is a severe security incident. This requires correlating an inbound query with its successful outbound response and verifying the destination GT against the whitelist. A match constitutes a confirmed data breach."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "roaming_partner_gt_whitelist.csv"
      - "Egress points of the core network's signaling plane, specifically the Signaling Gateways (SGWs) responsible for forwarding responses to external networks."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          CORRELATE inbound location queries with outbound responses via transaction ID.
          ALERT CRITICAL if response is successful AND destination GT is not in whitelist.
  - question: "Are any non-whitelisted Global Titles achieving an unusually high success rate for their location queries?"
    context: "An adversary performing reconnaissance may have a low success rate as they probe for valid numbers. However, an attacker who has identified valid targets and refined their methods may achieve a very high success rate. This question aims to identify such adversaries by flagging non-whitelisted GTs whose query success rate is anomalously high, both in absolute terms (e.g., >90%) and relative to the baseline of legitimate partners. This could indicate a mature, successful attack campaign."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "roaming_partner_gt_whitelist.csv"
      - "Egress points of the core network's signaling plane, specifically the Signaling Gateways (SGWs) responsible for forwarding responses to external networks."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          FOR each non-whitelisted GT, CALCULATE hourly query success rate.
          ALERT if rate > 90% AND rate > 95th percentile of legitimate partner baseline.
  - question: "Using a graph model of our SS7 network, can we identify non-whitelisted nodes that are acting as central collectors of subscriber location data?"
    context: "This question applies graph theory to visualize and analyze data exfiltration at a network level. By modeling GTs and MSISDNs as nodes, a non-whitelisted GT that successfully queries many different subscribers will become a 'hub' or a node with high centrality in the graph. Graph-based anomaly detection can automatically surface these 'high-centrality collectors,' providing a powerful, visual way to identify the most impactful threat actors exfiltrating data from the network."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "roaming_partner_gt_whitelist.csv"
      - "Egress points of the core network's signaling plane, specifically the Signaling Gateways (SGWs) responsible for forwarding responses to external networks."
    range: "Last 90 days"
    queries:
      - technology: "Pseudocode"
        query: |
          MODEL SS7 network as a graph (nodes=GTs/MSISDNs, edges=successful queries).
          APPLY graph anomaly detection.
          FLAG non-whitelisted GT nodes with anomalously high centrality.