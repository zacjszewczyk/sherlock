name: T1625: Hijack Execution Flow
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: 'This playbook addresses the question: Has an adversary established persistence on a mobile device by hijacking its execution flow? It focuses on detecting evidence of failed device integrity checks and anomalous network traffic. Evidence of integrity failure may be present in Mobile Device Management (MDM) or Mobile Threat Defense (MTD) logs, indicated by explicit failure flags (e.g., attestation_result: ''FAIL'') or mismatches in system component cryptographic hashes. Anomalous network traffic from a mobile device can be identified in network logs (e.g., Zeek) through connections to known malicious IPs, rare SSL/TLS client fingerprints (JA3 hashes), or statistical outliers in connection metadata like DNS query patterns or data volume.'
type: technique
related:
  - TA0028: Persistence
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is there an explicit integrity or attestation failure reported by MDM or MTD for any mobile device?
    context: This question aims to find direct evidence of a compromised device. An explicit failure reported by a security tool like MDM or MTD is a high-confidence indicator that a device's security posture has been degraded (e.g., through rooting, jailbreaking, or system file modification), which is a common prerequisite for hijacking execution flow. A high-severity alert is warranted as it points to a successful bypass of security controls.
    answer_sources:
      - Mobile Device Management (MDM) attestation logs
      - Mobile Threat Defense (MTD) integrity scan logs
      - MDM/MTD management console, managed mobile endpoints (iOS, Android), and centralized log aggregator (SIEM) ingesting events from the MDM/MTD cloud infrastructure.
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH MDM/MTD logs WHERE (attestation_result = 'FAIL' OR root_status = 'detected' OR integrity_status = 'failed' OR bootloader_hash_match = 'false'). ALERT with device ID, user, and failure reason.
  - question: Has there been an anomalous increase in the rate of attestation failures for a specific device profile (model and OS version)?
    context: This question seeks to identify targeted attacks. A sudden spike in integrity failures for a specific group of devices (e.g., same model and OS) can indicate a newly discovered vulnerability or a targeted campaign against that device profile. By comparing the current failure rate to a historical baseline, analysts can detect subtle attacks that might be missed when looking at individual failure events.
    answer_sources:
      - Mobile Device Management (MDM) attestation logs
      - Mobile Threat Defense (MTD) integrity scan logs
      - MDM/MTD management console, managed mobile endpoints (iOS, Android), and centralized log aggregator (SIEM) ingesting events from the MDM/MTD cloud infrastructure.
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: CALCULATE hourly failure rate per device profile. COMPARE rate to 99th percentile of 30-day baseline. ALERT if current rate > baseline threshold.
  - question: Is there a fleet-wide anomaly in the overall count of attestation failures?
    context: This question is designed to detect widespread campaigns or systemic issues. A time-series anomaly detection model can identify significant, sustained increases in the total number of integrity failures across all mobile devices. Such a trend could signal a large-scale attack, a widespread malware distribution, or a critical issue with a security update that weakens the fleet's defenses.
    answer_sources:
      - Mobile Device Management (MDM) attestation logs
      - Mobile Threat Defense (MTD) integrity scan logs
      - MDM/MTD management console, managed mobile endpoints (iOS, Android), and centralized log aggregator (SIEM) ingesting events from the MDM/MTD cloud infrastructure.
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: MONITOR hourly aggregate of attestation failures. APPLY time-series model. ALERT if observed count > forecasted upper bound for 3 consecutive hours.
  - question: Is a mobile device communicating with a known malicious entity based on threat intelligence feeds?
    context: This question looks for high-confidence indicators of compromise using external intelligence. If a mobile device's IP address is seen communicating with an IP or domain on a threat intelligence list, it strongly suggests malicious activity, such as command-and-control (C2) communication or connecting to a malware distribution point. This is often a direct consequence of a successful execution flow hijack.
    answer_sources:
      - Zeek intel.log
      - Zeek conn.log
      - Zeek dns.log
      - Network sensors (e.g., Zeek) deployed at key egress points, including corporate Wi-Fi network gateways, VPN concentrators serving mobile devices, and DNS resolvers used by mobile clients.
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH Zeek intel.log WHERE originator_ip IN mobile_ip_range AND threat_source indicates malicious. ALERT on match.
  - question: Is a mobile device exhibiting anomalous network behavior compared to its historical baseline?
    context: This question aims to detect malicious activity through behavioral deviations, even without known-bad indicators. Adversaries often use custom tools or techniques that generate unique network artifacts. Monitoring for new JA3 hashes (new client software), DNS queries for domains with high entropy (common in DGAs), or abnormal data transfer volumes can uncover stealthy C2 channels or data exfiltration that would otherwise go unnoticed.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek ssl.log
      - Zeek ja3.log
      - Network sensors (e.g., Zeek) deployed at key egress points, including corporate Wi-Fi network gateways, VPN concentrators serving mobile devices, and DNS resolvers used by mobile clients.
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: FOR each device, CHECK for new JA3 hashes, high Shannon entropy in DNS queries, or outbound data volume > 98th percentile of 30-day baseline. ALERT on deviation.
  - question: Does a mobile device's network connection exhibit characteristics of malicious traffic as determined by a machine learning model?
    context: This question leverages advanced analytics to identify complex malicious patterns that are difficult to define with simple rules. A machine learning model can analyze dozens of features from connection, DNS, and TLS logs simultaneously to score the likelihood of a connection being malicious. This is effective for detecting novel or polymorphic threats that evade signature-based and simple anomaly detection.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek ssl.log
      - Network sensors (e.g., Zeek) deployed at key egress points, including corporate Wi-Fi network gateways, VPN concentrators serving mobile devices, and DNS resolvers used by mobile clients.
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: EXTRACT features from Zeek logs (duration, bytes, proto, conn_state, domain entropy, etc.). APPLY trained classifier (e.g., Random Forest). ALERT if malicious probability > 0.90.