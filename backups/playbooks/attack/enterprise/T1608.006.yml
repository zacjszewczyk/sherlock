name: T1608.006: SEO Poisoning
id: f8c3b5d2-0a1b-4e6c-8f9a-7d9e0b1c2d3e
description: This playbook helps identify if an adversary is using Search Engine Optimization (SEO) poisoning to stage malicious websites. The goal of such a campaign is to manipulate search engine results to lure internal users into visiting attacker-controlled sites, which can lead to drive-by-compromise or supply chain attacks. The playbook focuses on detecting evidence of this activity by monitoring for communications with known malicious domains, analyzing HTTP redirect chains, identifying downloads of high-risk files following search engine referrals, and detecting anomalous "flocking" behavior where multiple hosts visit a new or low-reputation domain in a short period.
type: technique
related:
  - TA0042: Resource Development
contributors:
  - Zachary Szewczyk
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has an internal host communicated with a domain or IP address known to be associated with active SEO poisoning or Gootloader campaigns?
    context: This question seeks to identify direct communication with known malicious infrastructure. A match against a high-confidence threat intelligence feed provides a strong signal that an internal host has been exposed to or compromised by an SEO poisoning campaign. This is often the most direct evidence of a potential threat.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Internet gateway/proxy servers
      - Corporate DNS resolvers
      - Threat Intelligence Platform
    range: last 90 days
    queries:
      - "SEARCH Zeek DNS logs and Connection logs. JOIN destination IPs and query domains against a Threat Intelligence feed of known SEO poisoning indicators. ALERT on match."
  - question: Are multiple internal hosts accessing a rare, suspicious domain within a short time frame?
    context: This question looks for 'flocking' behavior towards a suspicious domain. SEO poisoning campaigns often lead multiple users to the same malicious site in a short period. Identifying domains with low overall prevalence but a sudden burst of activity from multiple hosts, especially those with unusual TLDs, can uncover newly staged malicious sites.
    answer_sources:
      - Zeek dns.log
      - Internet gateway/proxy servers
      - Corporate DNS resolvers
    range: last 90 days
    queries:
      - "SEARCH Zeek DNS logs. CALCULATE domain prevalence. FIND domains with prevalence < 0.1% accessed by > 3 hosts in 1 hour with suspicious TLDs. ALERT on findings."
  - question: Are internal hosts being referred from search engines to domains that appear to be algorithmically generated (DGA)?
    context: Adversaries may use Domain Generation Algorithms (DGAs) to create a large number of domains for their campaigns. This question aims to detect traffic to such domains, specifically when the user was referred by a search engine. A positive finding suggests a user's search query led them to a potentially malicious, programmatically generated domain, a common tactic in SEO poisoning.
    answer_sources:
      - Zeek dns.log
      - Zeek http.log
      - Internet gateway/proxy servers
      - Corporate DNS resolvers
    range: last 90 days
    queries:
      - "SEARCH Zeek DNS logs for new domains. APPLY DGA detection model. IF DGA detected, CHECK Zeek HTTP logs for search engine referrer. ALERT on match."
  - question: Is a user's browser being rapidly redirected through multiple domains after clicking a search engine result?
    context: This question targets the use of redirection chains, a technique used by adversaries to obscure the final malicious destination from both users and security tools. A quick succession of redirects originating from a search engine is highly suspicious and can indicate an attempt to land the user on a compromised or attacker-controlled site.
    answer_sources:
      - Zeek http.log
      - Web content filters
      - Internet gateway/proxy servers
    range: last 90 days
    queries:
      - "SEARCH Zeek HTTP logs. FIND sessions with a major search engine referrer. IF a source IP experiences >= 3 redirects (HTTP 3xx) to different hosts in 5 seconds, ALERT."
  - question: Is a user's browsing session from a search engine exhibiting an anomalously long chain of redirects compared to normal behavior?
    context: This question uses behavioral analytics to detect suspicious redirection chains. By establishing a baseline of normal redirect behavior, we can identify sessions that are statistical outliers. A session originating from a search engine with an unusually high number of redirects is a strong indicator of a potential SEO poisoning attempt.
    answer_sources:
      - Zeek http.log
      - Web content filters
      - Internet gateway/proxy servers
    range: last 90 days
    queries:
      - "SEARCH Zeek HTTP logs. BASELINE redirect chain length per session. IF session has a search engine referrer AND redirect chain > 99th percentile of the 30-day baseline, ALERT."
  - question: Does a user's browsing session from a search engine match the characteristics of a malicious redirection chain based on a machine learning model?
    context: This question leverages machine learning to make a more sophisticated determination about the nature of a redirection chain. By considering multiple features (e.g., redirect length, timing, user-agent changes, destination reputation), the model can identify complex patterns indicative of malicious activity that simpler rules might miss, providing a higher-fidelity signal for investigation.
    answer_sources:
      - Zeek http.log
      - Web content filters
      - Internet gateway/proxy servers
    range: last 90 days
    queries:
      - "APPLY ML model to real-time HTTP sessions from search engines. FEATURES include redirect count, timing, user-agent changes, destination reputation. ALERT on 'malicious' classification."
  - question: Did a user, after being referred from a search engine, download a high-risk file type from a recently registered domain?
    context: This question connects the user's search activity to the download of a potentially malicious payload. Adversaries often trick users into downloading trojanized files like ZIPs or ISOs. Correlating this download with a search engine origin and a newly created domain (a common characteristic of malicious infrastructure) creates a high-confidence alert for a potential drive-by-compromise.
    answer_sources:
      - Zeek files.log
      - Zeek http.log
      - Windows Event ID 4688
      - Endpoint devices (workstations, laptops)
      - Internet gateway/proxy servers
      - EDR Platform
    range: last 90 days
    queries:
      - "SEARCH Zeek HTTP logs with a search engine referrer. JOIN with Zeek file logs by session. IF file MIME is 'application/zip', 'application/x-iso9660-image', or 'application/javascript' AND source domain is < 90 days old, ALERT."
  - question: Did a browser process spawn a rare or suspicious child process with a high-entropy command line following a web visit?
    context: This question looks for post-exploitation activity on the endpoint immediately following web browsing. Browsers should not typically spawn processes like 'wscript.exe' or 'powershell.exe'. Detecting such an unusual parent-child relationship is a strong indicator of compromise. Additionally, high command-line entropy often points to obfuscated or encoded commands, further increasing the likelihood of malicious activity.
    answer_sources:
      - Windows Event ID 4688
      - Endpoint devices (workstations, laptops)
      - EDR Platform
    range: last 90 days
    queries:
      - "SEARCH process creation logs (EID 4688). BASELINE child processes of browsers. IF browser spawns a rare child process (e.g., wscript.exe) OR child process has high command-line entropy (>98th percentile), ALERT."
  - question: Did a browser spawn a child process that a machine learning model has classified as likely malicious?
    context: This question uses a machine learning model to analyze process creation events for signs of malice. By examining features like command-line arguments, length, and character entropy, the model can detect sophisticated and obfuscated commands that might be missed by simple rules. A high-scoring event where the parent is a browser is a critical alert, suggesting successful code execution on the endpoint.
    answer_sources:
      - Windows Event ID 4688
      - Endpoint devices (workstations, laptops)
      - EDR Platform
    range: last 90 days
    queries:
      - "APPLY ML model to process creation events (EID 4688). FEATURES include command-line length, entropy, and keywords. IF model score is high AND parent process is a browser, ALERT."
  - question: Are an unusual number of internal hosts being referred from a search engine to the same newly observed domain?
    context: This question aims to detect a successful 'flocking' event, where an SEO poisoning campaign has successfully lured many users to a new malicious domain. A sudden convergence of more than 10 distinct hosts to a domain that was only recently observed, all coming from search engines, is a strong indicator of a widespread and active campaign.
    answer_sources:
      - Zeek http.log
      - Zeek dns.log
      - Zeek conn.log
      - Corporate DNS resolvers
      - Internet gateway/proxy servers
      - Centralized SIEM/Log Aggregator
    range: last 90 days
    queries:
      - "SEARCH Zeek DNS logs for new domains (<30 days old). IF > 10 distinct internal IPs access the new domain from a search engine referrer in 24 hours, ALERT."
  - question: Is any external domain, accessed from a search engine, experiencing a statistically significant spike in traffic from internal hosts?
    context: This question uses anomaly detection to find unusual flocking behavior. Even if a domain is not new, a sudden, statistically significant spike in visitors from search engine referrals can indicate that the domain has been successfully poisoned for a popular search term. Using a Z-score helps to mathematically identify traffic patterns that deviate significantly from the established norm.
    answer_sources:
      - Zeek http.log
      - Zeek dns.log
      - Zeek conn.log
      - Corporate DNS resolvers
      - Internet gateway/proxy servers
      - Centralized SIEM/Log Aggregator
    range: last 90 days
    queries:
      - "FOR each external domain accessed via a search engine referrer, CALCULATE a 30-day rolling baseline of unique daily visitors. CALCULATE Z-score for the current day's visitor count. IF Z-score > 3.5, ALERT."
  - question: Can we identify a cluster of external domains that share a 'sudden burst' traffic pattern, characteristic of SEO poisoning campaigns?
    context: This question employs unsupervised machine learning to discover groups of domains with similar traffic patterns without pre-defined rules. By clustering domains based on their daily visitor time-series data, we can isolate a group that exhibits a sudden spike in activity. This 'sudden burst' cluster is highly likely to contain domains being used in an active SEO poisoning campaign, allowing for proactive discovery.
    answer_sources:
      - Zeek http.log
      - Zeek dns.log
      - Zeek conn.log
      - Corporate DNS resolvers
      - Internet gateway/proxy servers
      - Centralized SIEM/Log Aggregator
    range: last 90 days
    queries:
      - "CLUSTER daily unique visitor counts for all external domains using a time-series algorithm (e.g., k-shape). ISOLATE and INVESTIGATE the 'sudden burst' cluster, prioritizing new or low-reputation domains."