name: T1630: Indicator Removal on Host
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps identify if an adversary is removing indicators of compromise from mobile devices to evade detection. This includes actions such as programmatically clearing application data or cache, deleting sensitive files outside an application's sandbox, rapidly installing and uninstalling malicious applications, or attempting to disable or terminate mobile security agents.
type: technique
related:
  - TA0030: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
investigative_questions:
  - question: Is an application that is clearing its data or cache a known piece of malware?
    context: Malware often attempts to clear its operational data to erase evidence of its activity. This question aims to directly identify such behavior by cross-referencing applications that trigger data-clearing API calls against a threat intelligence feed of known malware hashes or package names. A match provides a high-confidence indicator of compromise.
    answer_sources:
      - MDM Application Activity Log
      - Mobile EDR/MTP Agent Log
      - Zeek conn.log
      - Zeek dns.log
      - Managed mobile devices (iOS, Android)
      - Corporate Wi-Fi access points
      - VPN concentrators
      - Cloud-based MDM/UEM management consoles
    range: Last 90 days
    queries:
      - pseudocode: SEARCH Mobile EDR logs WHERE api_name IN ('clearApplicationUserData', 'FileManager.removeItem') AND app_hash IN (threat_intel_feed) | ALERT
  - question: Is an application clearing its data or cache at an anomalously high frequency?
    context: While some applications clear data as part of normal operations, a sudden, anomalous spike in non-user-initiated data clearing can indicate a malicious script or process attempting to cover its tracks. This question focuses on establishing a behavioral baseline for each application and alerting on deviations, which can help detect unknown or zero-day malware.
    answer_sources:
      - MDM Application Activity Log
      - Mobile EDR/MTP Agent Log
      - Zeek conn.log
      - Zeek dns.log
      - Managed mobile devices (iOS, Android)
      - Corporate Wi-Fi access points
      - VPN concentrators
      - Cloud-based MDM/UEM management consoles
    range: Last 90 days
    queries:
      - pseudocode: SEARCH Mobile EDR logs WHERE event_type = 'data_clearing' AND is_user_initiated = false | GROUP BY app_package_name, device | COMPARE hourly_count to 30-day baseline | ALERT if hourly_count > 99th_percentile
  - question: Can we predict if a data-clearing event is malicious based on contextual features like time of day and recent network activity?
    context: A single data-clearing event may be benign, but when combined with other contextual signals—such as occurring after business hours or immediately following a connection to a low-reputation domain—it becomes highly suspicious. This question leverages a machine learning model to synthesize these weak signals into a strong, actionable alert, enabling automated responses like device isolation.
    answer_sources:
      - MDM Application Activity Log
      - Mobile EDR/MTP Agent Log
      - Zeek conn.log
      - Zeek dns.log
      - Managed mobile devices (iOS, Android)
      - Corporate Wi-Fi access points
      - VPN concentrators
      - Cloud-based MDM/UEM management consoles
    range: Last 90 days
    queries:
      - pseudocode: TRAIN RandomForestClassifier ON (app_category, is_user_initiated, time_of_day, network_bytes) | PREDICT is_malicious ON new data_clearing_events | ALERT if probability > 0.9
  - question: Is a non-allowlisted process deleting files in sensitive system or user data directories?
    context: Mobile operating systems enforce sandboxing to prevent applications from accessing or modifying data outside their designated containers. A non-allowlisted process that deletes files in protected user data folders (like photos) or system log directories is a strong indicator of malicious activity, as it is violating fundamental security principles to destroy evidence or cause harm.
    answer_sources:
      - MDM File Integrity Monitoring Log
      - Mobile EDR/MTP Agent Log
      - Zeek files.log
      - Zeek conn.log
      - Managed mobile devices (iOS, Android)
      - MDM/UEM servers
      - Network egress points with file transfer monitoring
    range: Last 90 days
    queries:
      - pseudocode: SEARCH EDR/FIM logs WHERE event.type = 'deletion' AND file.path IN (protected_dirs) AND process.name NOT IN (allowlist) | ALERT
  - question: Is an application exhibiting anomalous file deletion behavior, such as deleting an unusually high number of files or a wide variety of file types?
    context: Wiper malware often performs indiscriminate deletion of many files with different types, a pattern distinct from a legitimate application clearing its own cache. This question seeks to detect such behavior by baselining an application's normal file deletion count and the variety (entropy) of file extensions it deletes. A significant deviation from this baseline suggests malicious wiping activity.
    answer_sources:
      - MDM File Integrity Monitoring Log
      - Mobile EDR/MTP Agent Log
      - Zeek files.log
      - Zeek conn.log
      - Managed mobile devices (iOS, Android)
      - MDM/UEM servers
      - Network egress points with file transfer monitoring
    range: Last 90 days
    queries:
      - pseudocode: SEARCH FIM logs WHERE event.type = 'deletion' | GROUP BY app.package_name | CALCULATE file_count, extension_entropy | COMPARE to 30-day baseline | ALERT if file_count > 3*stddev OR entropy_increase > 50%
  - question: Can anomalous file deletion patterns be identified by clustering activity based on deletion count, volume, and directory depth?
    context: Adversaries may use novel techniques that don't match predefined rules. This question uses an unsupervised machine learning model (DBSCAN) to group file deletion events into clusters based on their characteristics. Outlier clusters represent anomalous activity that does not fit any normal pattern, enabling the discovery of new or unusual threats that can then be correlated with network logs to check for data exfiltration.
    answer_sources:
      - MDM File Integrity Monitoring Log
      - Mobile EDR/MTP Agent Log
      - Zeek files.log
      - Zeek conn.log
      - Managed mobile devices (iOS, Android)
      - MDM/UEM servers
      - Network egress points with file transfer monitoring
    range: Last 90 days
    queries:
      - pseudocode: TRAIN DBSCAN ON (deletion_count, bytes_deleted, directory_depth) from FIM logs | IDENTIFY outliers | CORRELATE outlier device/timestamps with Zeek logs for preceding exfiltration
  - question: Was an application uninstalled shortly after installation, and is it a known piece of short-lived malware?
    context: Dropper malware is designed to install a payload and then remove itself quickly to evade detection. This question aims to identify this specific behavior by checking if a rapidly uninstalled application is listed on a threat intelligence feed for "short-lived malware," providing a direct and high-confidence detection method.
    answer_sources:
      - MDM Application Inventory Log
      - Mobile EDR/MTP Agent Log
      - Zeek dns.log
      - Zeek conn.log
      - Managed mobile devices (iOS, Android)
      - MDM/UEM servers
      - Enterprise DNS resolvers
    range: Last 90 days
    queries:
      - pseudocode: SEARCH MDM logs WHERE event.type = 'app_uninstall' AND app.hash IN (short_lived_malware_feed) | ALERT
  - question: Is an application being uninstalled with an anomalously short lifetime, and does this correlate with suspicious DNS activity?
    context: Even if malware is not on a known threat feed, it may exhibit the behavioral trait of a very short lifespan. This question identifies statistically anomalous short-lived applications. The signal is strengthened by correlating this with a high rate of failed DNS lookups (NXDOMAINs), a common indicator of command-and-control beaconing where a malware tries to contact multiple non-existent domains.
    answer_sources:
      - MDM Application Inventory Log
      - Mobile EDR/MTP Agent Log
      - Zeek dns.log
      - Zeek conn.log
      - Managed mobile devices (iOS, Android)
      - MDM/UEM servers
      - Enterprise DNS resolvers
    range: Last 90 days
    queries:
      - pseudocode: JOIN install_logs, uninstall_logs | CALCULATE app_lifetime_seconds | ALERT if app_lifetime_seconds < 5th_percentile | ENRICH alert by querying Zeek dns.log for high NXDOMAIN ratio from device
  - question: Can we assign a risk score to an application uninstallation event based on its lifetime, install source, and network behavior?
    context: This question moves beyond binary alerts to a more nuanced risk score. By training a logistic regression model with features like application lifetime, whether it was sideloaded, and its network traffic volume, we can more accurately assess the likelihood that an uninstallation is malicious. This allows for a tiered response, where high-risk events are automatically escalated for analyst review.
    answer_sources:
      - MDM Application Inventory Log
      - Mobile EDR/MTP Agent Log
      - Zeek dns.log
      - Zeek conn.log
      - Managed mobile devices (iOS, Android)
      - MDM/UEM servers
      - Enterprise DNS resolvers
    range: Last 90 days
    queries:
      - pseudocode: TRAIN LogisticRegression ON (app_lifetime, install_source, dns_contacts, bytes_transferred) | PREDICT risk_score for uninstall_events | CREATE incident if score > 0.85
  - question: Has a process, other than a legitimate system or MDM process, revoked the Device Administrator permissions of the mobile security agent?
    context: Disabling security software is a primary objective for an adversary. Revoking Device Administrator permissions is a direct method to neutralize a security agent on Android. This question creates a critical alert for such an event, filtering out legitimate changes made by MDM policies to focus on unauthorized and highly suspicious actions.
    answer_sources:
      - Mobile EDR/MTP Agent Log
      - MDM Policy Compliance Log
      - Zeek conn.log
      - Managed mobile devices
      - MDM/UEM management consoles
      - Centralized mobile log aggregation platform
    range: Last 90 days
    queries:
      - pseudocode: SEARCH MDM logs WHERE event.type = 'device_admin_revoked' AND target.process.name = 'enterprise_security_agent' AND initiator.process.name NOT IN (mdm_agent, system_process) | ALERT
  - question: Has the mobile security agent stopped checking in, despite the device remaining online?
    context: If an adversary successfully terminates a security agent, it will stop sending 'heartbeat' status updates. This question detects this condition by alerting when a device's agent misses its scheduled check-in. To reduce false positives from offline devices, the alert is cross-referenced with network logs (Zeek) to confirm the device is still active on the network.
    answer_sources:
      - Mobile EDR/MTP Agent Log
      - MDM Policy Compliance Log
      - Zeek conn.log
      - Managed mobile devices
      - MDM/UEM management consoles
      - Centralized mobile log aggregation platform
    range: Last 90 days
    queries:
      - pseudocode: ESTABLISH baseline for agent heartbeat delta per device | ALERT if time since last heartbeat > 95th_percentile_threshold AND device has recent network traffic in conn.log
  - question: Is the mobile security agent exhibiting anomalous resource usage (CPU, memory, network) indicative of tampering or termination?
    context: Before an adversary successfully terminates a security agent, they may attempt to tamper with it, causing it to crash or behave erratically. This can manifest as anomalous spikes or drops in resource consumption. This question uses an Isolation Forest model to learn the agent's normal operating profile and detect any significant deviations, providing an early warning of potential compromise.
    answer_sources:
      - Mobile EDR/MTP Agent Log
      - MDM Policy Compliance Log
      - Zeek conn.log
      - Managed mobile devices
      - MDM/UEM management consoles
      - Centralized mobile log aggregation platform
    range: Last 90 days
    queries:
      - pseudocode: TRAIN IsolationForest model on time-series data (cpu_usage, memory_usage) from security agent | PREDICT on new data | ALERT if anomaly_score is -1