name: "T1556.004: Network Device Authentication"
id: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
description: "This playbook helps investigate whether an adversary is modifying network device authentication to maintain persistence, evade defenses, or access credentials. This involves detecting anomalous file transfers of firmware or configurations, unauthorized outbound authentication attempts to non-standard servers, administrative activity occurring outside of maintenance windows or from unapproved IP addresses, and login patterns indicative of credential abuse or authentication bypass exploits. The goal is to identify compromised network devices that could be used for persistence, lateral movement, or data exfiltration."
type: "technique"
related:
  - "TA0003: Persistence"
  - "TA0005: Defense Evasion"
  - "TA0006: Credential Access"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Are file transfers to network devices using known malicious firmware?"
    context: "Adversaries may replace legitimate firmware or configuration files on network devices with malicious versions to establish persistence. This action checks if a file transferred to a network device has a hash that matches a known malicious signature from a threat intelligence feed. A match is a strong indicator of compromise."
    answer_sources:
      - "Zeek files.log"
      - "Zeek conn.log"
      - "Zeek tftp.log"
      - "Zeek ftp.log"
      - "Network management subnet, data center core switches, internet-facing routers and firewalls, configuration management servers"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH zeek_files_log WHERE destination_ip IN network_devices AND file_hash IN malicious_firmware_hashes | ALERT on match"
  - question: "Is a file transferred to a network device potentially packed or encrypted to hide malicious content?"
    context: "To evade signature-based detection, adversaries often pack or encrypt their malicious payloads. This results in a higher Shannon entropy score compared to normal text-based configuration files or uncompressed firmware. This action checks for files with anomalously high entropy, which could indicate an attempt to conceal malicious code."
    answer_sources:
      - "Zeek files.log"
      - "Zeek conn.log"
      - "Zeek tftp.log"
      - "Zeek ftp.log"
      - "Network management subnet, data center core switches, internet-facing routers and firewalls, configuration management servers"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "FOR EACH file_transfer to network_device | CALCULATE shannon_entropy(file) | IF entropy > 95th_percentile_baseline THEN ALERT"
  - question: "Is there an anomalous spike in the volume of file transfers to network devices?"
    context: "A sudden increase in file transfers to network devices, especially outside of scheduled maintenance, could indicate an adversary attempting to modify multiple devices at once. This action uses a time-series model to detect unusual spikes in transfer volume that are not associated with legitimate, documented activities."
    answer_sources:
      - "Zeek files.log"
      - "Zeek conn.log"
      - "Zeek tftp.log"
      - "Zeek ftp.log"
      - "Network management subnet, data center core switches, internet-facing routers and firewalls, configuration management servers"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "MODEL hourly_count(file_transfers) by device_type | IF count_spike NOT IN maintenance_windows THEN ALERT"
  - question: "Are network devices attempting to authenticate to unapproved central authentication servers?"
    context: "An adversary may reconfigure a network device to use a rogue authentication server (e.g., RADIUS, TACACS+) to harvest credentials or bypass legitimate controls. This action checks for any authentication traffic from a network device to a destination IP that is not on the pre-approved list of authentication servers."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek radius.log"
      - "Windows Event ID 5156"
      - "Authentication servers (RADIUS, TACACS+), network device management interfaces, domain controllers"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH zeek_conn_log WHERE source_ip IN network_devices AND dest_port IN (49, 1812, 1813) AND dest_ip NOT IN approved_auth_servers | ALERT on match"
  - question: "Is a network device connecting to a historically rare authentication server?"
    context: "Even if an adversary uses a server within the organization's IP space, it may be an unusual or rarely used destination for a specific device. This action identifies connections to authentication servers that are statistical outliers based on the device's 30-day connection history, highlighting potentially unauthorized reconfigurations."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek radius.log"
      - "Windows Event ID 5156"
      - "Authentication servers (RADIUS, TACACS+), network device management interfaces, domain controllers"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "PROFILE auth_server_frequency per device over 30d | FOR EACH new_connection | IF dest_ip_frequency < 5th_percentile THEN ALERT"
  - question: "Does a network device's authentication traffic deviate from its normal cluster of activity?"
    context: "Legitimate authentication traffic typically forms a consistent pattern (e.g., same destination IPs, ports, and protocols). This action uses a clustering algorithm like DBSCAN to define 'normal' behavior. Any connection that doesn't fit into a normal cluster is flagged as a noise point or a new, small cluster, indicating a potential anomaly that warrants investigation."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek radius.log"
      - "Windows Event ID 5156"
      - "Authentication servers (RADIUS, TACACS+), network device management interfaces, domain controllers"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "CLUSTER conn_metadata from network_devices using DBSCAN | IF connection IS noise_point OR new_small_cluster THEN ALERT"
  - question: "Are configuration changes happening outside of approved maintenance windows or from unauthorized source IPs?"
    context: "Strict change control is crucial for network security. This action enforces time- and source-based policies by alerting on any configuration session (TFTP, FTP, SCP) that either occurs outside a predefined maintenance window or originates from an IP not on the authorized administrator list."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ftp.log"
      - "Zeek tftp.log"
      - "Zeek ssh.log"
      - "Windows Event ID 4624"
      - "Network management jump boxes, network device management interfaces, configuration management servers"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH config_protocols_log WHERE (time NOT IN maintenance_windows) OR (source_ip NOT IN admin_ips) | ALERT on match"
  - question: "Is an administrator logging into a network device at a time that is highly unusual for their specific work patterns?"
    context: "An adversary who has compromised an administrator's account may use it at odd hours. This action establishes a baseline of normal login times for each user. It then uses a z-score to detect logins that are statistically significant deviations from that user's established time-of-day and day-of-week patterns, indicating potential account misuse."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ftp.log"
      - "Zeek tftp.log"
      - "Zeek ssh.log"
      - "Windows Event ID 4624"
      - "Network management jump boxes, network device management interfaces, configuration management servers"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "MODEL login_time_distribution per user | FOR EACH new_login | CALCULATE z_score(login_time) | IF z_score > 3 THEN ALERT"
  - question: "Is a new administrative session an outlier compared to historically legitimate sessions?"
    context: "This action uses a machine learning model (one-class SVM) to create a comprehensive profile of what a 'normal' administrative session looks like, considering features like source IP, protocol, time of day, and duration. The model can then identify new sessions that do not conform to this profile, flagging them as potential security events even if they don't trigger a specific rule."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ftp.log"
      - "Zeek tftp.log"
      - "Zeek ssh.log"
      - "Windows Event ID 4624"
      - "Network management jump boxes, network device management interfaces, configuration management servers"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "TRAIN one_class_svm on legitimate_session_features | CLASSIFY new_sessions in real-time | IF session IS outlier THEN ALERT"
  - question: "Is a network device being accessed from a suspicious or unapproved geographic location?"
    context: "If administrators are known to operate only from specific countries, a successful login from a different country is highly suspicious. This action enriches login events with geolocation data and alerts on any successful access from a country not on the approved list, potentially indicating a compromised account or remote adversary."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Zeek conn.log"
      - "VPN concentrators, network management jump boxes, perimeter firewalls"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH successful_logins | ENRICH source_ip with geo_data | IF source_country NOT IN approved_countries THEN ALERT"
  - question: "Is an administrator logging in from a network (ASN) that is rare for that specific user?"
    context: "Beyond just IP addresses, the Autonomous System Number (ASN) can reveal the network provider of the source. An administrator typically connects from a few known networks (office, home ISP, VPN). A successful login from a very rare or never-before-seen ASN for that user is a strong indicator of anomalous activity, such as access from a compromised machine on a different network."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Zeek conn.log"
      - "VPN concentrators, network management jump boxes, perimeter firewalls"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "MAINTAIN baseline of source_ASN_frequency per user | FOR EACH new_login | IF source_ASN_frequency < 1st_percentile THEN ALERT"
  - question: "Does a new administrative session exhibit characteristics that deviate significantly from a learned model of normal behavior?"
    context: "This action uses a sophisticated anomaly detection model (autoencoder neural network) to learn the deep patterns of normal administrative sessions. When a new session occurs, the model attempts to reconstruct it. A high reconstruction error means the session is very different from anything seen before and is therefore highly anomalous, suggesting a potential compromise."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Zeek conn.log"
      - "VPN concentrators, network management jump boxes, perimeter firewalls"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "TRAIN autoencoder on normal_session_features | FOR EACH new_session | CALCULATE reconstruction_error | IF error IS high THEN ALERT"
  - question: "Has a known malicious IP address successfully connected to a network device's management port?"
    context: "This action checks for a direct failure of perimeter defenses. A successful connection to a sensitive management port from an IP address on a high-confidence threat intelligence feed indicates that firewall rules or other blocking mechanisms have failed, and the device may be under direct attack or already compromised."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Windows Event ID 4624"
      - "Perimeter firewalls, internet gateway, network device management interfaces"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH zeek_conn_log to mgmt_port WHERE source_ip IN cti_feed AND source_ip NOT IN allow_list | ALERT on match"
  - question: "Is there a statistical increase in successful connections from known-bad IPs, suggesting a systematic failure of blocking controls?"
    context: "A single connection from a bad IP might be missed, but a rising trend indicates a larger problem. This action monitors the rate of successful connections from CTI-flagged IPs that should have been blocked. A statistically significant increase in this rate suggests a firewall misconfiguration, a rule failure, or a widespread, unmitigated attack campaign."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Windows Event ID 4624"
      - "Perimeter firewalls, internet gateway, network device management interfaces"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "MONITOR daily_count of successful_connections from known_bad_ips | IF rate > 99th_percentile_baseline THEN ALERT"
  - question: "Is a machine learning model identifying connections as malicious that were not blocked by perimeter controls?"
    context: "This provides a safety net for when signature- or list-based defenses fail. A classification model is trained to recognize the characteristics of malicious connections. If the model flags a live connection as likely malicious but it was not blocked by the firewall, it indicates a potential defense evasion that requires immediate attention."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Windows Event ID 4624"
      - "Perimeter firewalls, internet gateway, network device management interfaces"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "TRAIN classifier on conn_features | FOR EACH live_connection | PREDICT is_malicious | IF prediction > threshold AND was_not_blocked THEN ALERT"
  - question: "Is a network device being accessed using an SSH client associated with attack tools?"
    context: "The SSH client string exchanged during connection setup can reveal the software being used. This action checks this string against a watchlist of clients known to be part of offensive security tools (e.g., Metasploit, Nmap). A match indicates that the device is likely being targeted by an attacker."
    answer_sources:
      - "Zeek ssh.log"
      - "Network management subnet, jump boxes, core network devices"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH zeek_ssh_log for successful_auth | IF client_string IN attack_tool_watchlist THEN ALERT"
  - question: "Is a network device being accessed by a statistically rare or never-before-seen SSH client?"
    context: "An organization typically uses a small, standardized set of SSH clients for administration. The appearance of a new, unknown, or very rarely used client string for a successful connection is a strong anomaly. It could indicate an adversary using a custom tool or a compromised non-standard workstation to access the device."
    answer_sources:
      - "Zeek ssh.log"
      - "Network management subnet, jump boxes, core network devices"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "CALCULATE frequency of ssh_client_strings over 30d | IF successful_connection uses client_string with frequency < 0.1% THEN ALERT"
  - question: "Is a machine learning model flagging a new SSH client string as an outlier compared to legitimate clients?"
    context: "This action uses NLP techniques and a one-class SVM to 'learn' the characteristics of legitimate SSH client strings. It can then identify new client strings that don't fit the established pattern, allowing for the detection of novel or custom attack tools that would not be on a static watchlist."
    answer_sources:
      - "Zeek ssh.log"
      - "Network management subnet, jump boxes, core network devices"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "VECTORIZE ssh_client_strings | TRAIN one_class_svm on vectors of legit clients | IF new_client_vector IS outlier THEN ALERT"
  - question: "Is an administrative session originating from a network segment other than the designated management subnet?"
    context: "Network segmentation is a key security control. Administrative access to network devices should only be allowed from specific, hardened bastion hosts or management subnets. This action detects and alerts on any successful connection that violates this policy, indicating a potential lateral movement attempt or a misconfiguration."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Network device management interfaces, bastion hosts, internal network segments"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH successful_mgmt_connection | IF source_ip NOT IN authorized_mgmt_subnets THEN ALERT"
  - question: "Is a successful administrative connection coming from a statistically rare source subnet?"
    context: "Even within an organization, administrative traffic should originate from predictable network segments. A successful connection from a subnet that has rarely or never been the source of administrative traffic before is anomalous. This could indicate an adversary pivoting from a compromised machine in an unexpected part of the network (e.g., a user workstation in the finance department)."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Network device management interfaces, bastion hosts, internal network segments"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "BASELINE source_subnet_frequency for admin_traffic | IF successful_connection from subnet in bottom_5th_percentile THEN ALERT"
  - question: "Is an administrative session being established via an anomalous network path?"
    context: "The path that packets take to reach a network device should be relatively stable. An adversary might manipulate routing to intercept or initiate traffic from a compromised device. This action models legitimate network paths and alerts when a new session is established via a path that is a statistical outlier, suggesting potential routing manipulation or pivoting."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Network device management interfaces, bastion hosts, internal network segments"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "MODEL legitimate_network_paths with LSTM | IF new_session_path IS anomalous THEN ALERT"
  - question: "Shortly after a successful admin login, is the network device making suspicious outbound connections?"
    context: "A common adversary tactic is to log into a device and then use it to establish a command-and-control (C2) channel. This correlation rule looks for this specific pattern: a successful login immediately followed by the device itself initiating an outbound connection to an external IP on a non-standard port, which is highly indicative of post-compromise C2 activity."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Network device interfaces (all), internet gateway, internal scanning targets"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "CORRELATE (successful_login to device_X) FOLLOWED BY (outbound_conn from device_X to external_ip on non-standard_port) within 5_mins | ALERT"
  - question: "Following a login, does the network device's outbound data volume spike anomalously?"
    context: "After gaining access, an adversary might exfiltrate data (like a configuration file) or download additional tools. This action baselines the normal hourly outbound traffic volume for each device. It then alerts if the volume in the hour following a login exceeds the 99th percentile of that baseline, indicating a potential data transfer event."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Network device interfaces (all), internet gateway, internal scanning targets"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "FOR EACH device, BASELINE hourly_bytes_out | IF bytes_out in hour_after_login > 99th_percentile_baseline THEN ALERT"
  - question: "Does a device's outbound connection pattern change anomalously right after a login?"
    context: "This action uses a time-series model to learn the fine-grained, normal outbound behavior of a network device (e.g., bytes per second, new connections per minute). A significant deviation from this learned norm immediately following a login event is a strong signal that the logged-in user (or adversary) is performing an action that causes the device to behave in an uncharacteristic way, such as initiating scanning or C2."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Network device interfaces (all), internet gateway, internal scanning targets"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "MODEL outbound_conn_pattern per device | IF anomaly_detected immediately_after_login THEN ALERT"
  - question: "Is traffic to a network device matching the signature of a known authentication bypass vulnerability?"
    context: "Adversaries exploit known vulnerabilities to bypass authentication entirely. This action relies on an Intrusion Detection System (IDS) having the appropriate signatures for these exploits. It creates a high-severity alert whenever the IDS detects traffic matching a known auth bypass vulnerability directed at a network device."
    answer_sources:
      - "Zeek conn.log"
      - "IDS/IPS alert logs"
      - "Perimeter firewalls, network device management interfaces, IDS/IPS sensors"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH ids_alerts WHERE signature matches 'auth_bypass_vuln' AND destination_ip IN network_devices | ALERT"
  - question: "Is there a sudden spike in IDS alerts for network device exploits?"
    context: "While a single IDS alert is important, a sudden increase in the volume of alerts against a specific device or subnet is a stronger indicator of a targeted campaign. This action baselines the normal rate of such alerts and flags any statistically significant spike, which could represent an adversary's scanning or active exploitation phase."
    answer_sources:
      - "Zeek conn.log"
      - "IDS/IPS alert logs"
      - "Perimeter firewalls, network device management interfaces, IDS/IPS sensors"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "MONITOR hourly_rate(ids_exploit_alerts) | IF rate > 3_std_dev_above_mean THEN ALERT"
  - question: "Can a machine learning model detect a zero-day or polymorphic authentication bypass exploit?"
    context: "Signature-based IDS can miss novel or modified (polymorphic) exploits. This action involves training a machine learning model on the raw traffic patterns of known exploits. The goal is to enable the model to identify the fundamental characteristics of an exploit, allowing it to detect new variations that signatures would miss."
    answer_sources:
      - "Zeek conn.log"
      - "IDS/IPS alert logs"
      - "Perimeter firewalls, network device management interfaces, IDS/IPS sensors"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "TRAIN classifier on labeled_pcap_data of exploits | DEPLOY model on live_traffic | IF model_predicts_exploit THEN ALERT"
  - question: "Is a successful login to a network device using a default, hardcoded, or known-compromised username?"
    context: "Using default or weak credentials is a common entry point. This action maintains a watchlist of forbidden usernames (like 'cisco', 'admin', or any credential found in a previous breach). It then generates an alert for any successful login to a network device that uses one of these forbidden usernames."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Windows Event ID 4624"
      - "Network device management interfaces, authentication servers (RADIUS/TACACS+), configuration backups"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH successful_logins to network_devices | IF username IN forbidden_username_watchlist THEN ALERT"
  - question: "Has a username that has never been seen on a specific device before successfully authenticated?"
    context: "The set of users who can access a particular network device is typically small and static. A successful login by a brand-new user for that device is highly anomalous and could indicate that a user's credentials have been stolen and are being used to probe for lateral movement opportunities."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Windows Event ID 4624"
      - "Network device management interfaces, authentication servers (RADIUS/TACACS+), configuration backups"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "MAINTAIN list of known_users per device | IF successful_login by user NOT IN known_users_for_device THEN ALERT"
  - question: "Is a successful login bridging two otherwise disconnected communities of users and devices?"
    context: "This action uses graph analysis to model access patterns. It groups users and devices into 'communities' based on who accesses what. A login that creates a link between two previously separate communities (e.g., a web developer logging into a core network switch) is a powerful anomaly indicator, suggesting significant credential misuse or lateral movement."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Windows Event ID 4624"
      - "Network device management interfaces, authentication servers (RADIUS/TACACS+), configuration backups"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "CREATE graph of user-device_access | RUN community_detection | IF login_event bridges two_communities THEN ALERT"
  - question: "Has a session been established without a successful authentication event, following one or more failures?"
    context: "This pattern is highly indicative of an authentication bypass exploit. The adversary tries and fails to log in normally, then uses an exploit which grants them a session without generating a 'success' log. This stateful rule specifically looks for this sequence: failed login(s), no successful login, but an established, long-lived session from the same source."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Zeek conn.log"
      - "Network device management interfaces, log aggregation server/SIEM"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "CORRELATE (auth_fail) AND NOT (auth_success) AND (long_duration_session) from same_ip within 2_mins | ALERT"
  - question: "Is a source IP generating many sessions to a device but has a very low authentication success ratio?"
    context: "Legitimate administrative workstations should have a high ratio of successful logins to total sessions. An attacker's machine, however, might be used for scanning or repeated failed brute-force attempts, resulting in many sessions but few successes. A low success ratio for a source IP is therefore a strong indicator of malicious activity."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Zeek conn.log"
      - "Network device management interfaces, log aggregation server/SIEM"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "FOR EACH source_ip, CALCULATE success_ratio = (auth_success_count / session_count) over 1hr | IF ratio < 0.5 THEN ALERT"
  - question: "Is an observed sequence of login events (e.g., fail, fail, success) highly improbable based on historical patterns?"
    context: "This action models the entire login process as a sequence of events. Using a model like a Hidden Markov Model (HMM), it learns the probability of transitioning between states (e.g., from a failed attempt to a successful one). A sequence of events that the model deems highly unlikely, such as the pattern indicative of an auth bypass, can be flagged as anomalous."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Zeek conn.log"
      - "Network device management interfaces, log aggregation server/SIEM"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "TRAIN HMM on sequences of login_events | FOR EACH new_sequence | CALCULATE probability | IF probability is low THEN ALERT"
  - question: "Has a successful login occurred from a brand-new source IP with no preceding failed attempts?"
    context: "A legitimate user logging in from a new location for the first time might mistype their password. However, an adversary using a hardcoded backdoor password or a stolen credential will likely get it right on the first try. This combination of a new source IP and a 'first-try' success is suspicious and could indicate the use of a backdoor."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Zeek conn.log"
      - "Network device management interfaces, VPN concentrators"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH successful_login WHERE source_ip is new AND no_preceding_failures from source_ip in last 24h | ALERT"
  - question: "Is a user's 'first-try' success pattern an outlier for that specific user?"
    context: "This action adds user-specific context to the 'first-try' success detection. It baselines the normal login behavior for each user, including how often they fail before succeeding. If a user who consistently fumbles their password once or twice suddenly has a perfect first-try login from a new location, it's an outlier for *that user* and thus more suspicious."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Zeek conn.log"
      - "Network device management interfaces, VPN concentrators"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "BASELINE num_failed_attempts_before_success per user | IF new_login has outlier_num_fails (e.g., 0 for a user who always fails once) THEN ALERT"
  - question: "Does a Bayesian model calculate a low probability of a login being legitimate, given it's from a new IP with zero failures?"
    context: "This action formalizes the logic of the previous questions using Bayesian inference. It calculates the probability of a login being legitimate given the evidence (e.g., the source is new, the number of failures is zero). By training on prior data of known good and bad logins, the model can provide a probabilistic score for how suspicious an event is, allowing for more nuanced alerting."
    answer_sources:
      - "Zeek ssh.log"
      - "Zeek telnet.log"
      - "Zeek conn.log"
      - "Network device management interfaces, VPN concentrators"
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "CALCULATE P(Legit | Source_Is_New, Num_Fails=0) using Bayesian model | IF probability < threshold THEN ALERT"