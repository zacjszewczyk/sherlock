name: T1529: System Shutdown-Reboot
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps investigate if an adversary is attempting to impact system availability or recovery using shutdown and reboot commands. It covers various methods including the execution of known malicious binaries, the use of scripting interpreters and remote administration tools to issue shutdown commands, suspicious logon-shutdown sequences, anomalous widespread shutdown events across the network, and sudden drops in network traffic from critical subnets indicating a mass outage.
type: technique
related:
  - TA0040: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is a known malicious binary attempting to shut down or reboot the system?
    context: This question investigates if a process creation event, such as Windows Event ID 4688 or Sysmon Event ID 1, is associated with a binary known for destructive activities like ransomware or wipers. The detection focuses on correlating the file hash of the new process with a threat intelligence feed of malicious hashes, specifically looking for command-line arguments that explicitly trigger a system shutdown or reboot (e.g., 'shutdown /s', 'shutdown /r'). A positive match provides a high-confidence indicator of an adversary's attempt to disrupt system availability.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Critical infrastructure servers (Domain Controllers, Database Servers), application servers, and general user endpoints.
    range: last 90 days
    queries:
      - pseudocode: SEARCH process creation events (EID 4688, Sysmon EID 1). FILTER for command line containing 'shutdown' AND ('/s' OR '/r' OR '/g'). LOOKUP file hash against threat intelligence feed. ALERT if hash is found.
  - question: Is a process with a suspicious or randomized name initiating a system shutdown?
    context: Adversaries often use packed or randomly named executables to evade signature-based detection. This question aims to identify such malware by analyzing the entropy of the process name that initiates a shutdown. By calculating the Shannon entropy of the process name and comparing it to a historical baseline of legitimate executables that perform shutdowns, we can flag outliers. An unusually high entropy score (e.g., in the 95th percentile) suggests the process name is not a standard, human-readable name and is likely an attempt to obfuscate a malicious tool.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Critical infrastructure servers (Domain Controllers, Database Servers), application servers, and general user endpoints.
    range: last 90 days
    queries:
      - pseudocode: FOR each process creation event with a shutdown command, CALCULATE Shannon entropy of process name. COMPARE to historical baseline of shutdown-initiating process name entropies. ALERT if entropy is in the top 5th percentile.
  - question: Can a machine learning model classify a process initiating a shutdown as malicious based on its execution context?
    context: This question leverages a machine learning classification model to provide a more nuanced detection than simple rules. The model is trained on features from process creation events, such as the parent process, user context, command-line arguments, and process name entropy. By learning the characteristics of both benign and malicious shutdown events, the model can classify new, unseen events. An alert is generated when a shutdown-initiating process is classified as 'malicious' with a high confidence score, indicating a strong likelihood of adversarial activity.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Critical infrastructure servers (Domain Controllers, Database Servers), application servers, and general user endpoints.
    range: last 90 days
    queries:
      - pseudocode: FOR each process creation event with a shutdown command, EXTRACT features (parent process, user, command line, entropy). INPUT features into trained classification model. ALERT if classification is 'malicious' with confidence > 0.85.
  - question: Is a scripting interpreter being used to forcefully or immediately shut down a system?
    context: Legitimate shutdowns are typically initiated by users or scheduled tasks, not forcefully via scripts. This question focuses on detecting when scripting interpreters like `powershell.exe` or `cmd.exe` are used to spawn `shutdown.exe` with flags indicating force (`/f`) or a very short timeout (`/t <60`). It also checks for the direct use of forceful PowerShell cmdlets like `Restart-Computer -Force`. This behavior is a strong indicator of an automated, and likely malicious, script designed to bypass user prompts and disrupt operations quickly.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Windows PowerShell Logging Event ID 4104
      - All Windows Endpoints and Servers, with heightened scrutiny on administrative jump boxes and domain controllers.
    range: last 90 days
    queries:
      - pseudocode: SEARCH process creation events for `shutdown.exe` with parent `powershell.exe`, `cmd.exe`, or `wscript.exe`. FILTER for command line containing '/f' or '/t <value_less_than_60>'. ALSO SEARCH PowerShell logs (EID 4104) for `Restart-Computer -Force` or `Stop-Computer -Force`. ALERT on match.
  - question: Has an unusually rare combination of command-line arguments been used to initiate a system shutdown?
    context: Administrators and automated systems tend to use consistent, predictable command-line patterns for shutdowns. This question seeks to identify anomalies by baselining the frequency of all `shutdown.exe` and `Restart-Computer` command-line combinations across the environment. An alert on a rare combination (e.g., seen in less than 1% of all historical executions) can reveal a novel or manually crafted command used by an adversary. This is especially suspicious if initiated by a non-administrative user or if it includes unusual parameters like a shutdown comment (`/c`).
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Windows PowerShell Logging Event ID 4104
      - All Windows Endpoints and Servers, with heightened scrutiny on administrative jump boxes and domain controllers.
    range: last 90 days
    queries:
      - pseudocode: FOR each shutdown command, CALCULATE frequency of its command-line argument combination against historical data. ALERT if frequency is < 1% of all observed combinations.
  - question: Does a shutdown command appear as a statistical outlier when compared to clusters of normal shutdown behavior?
    context: This question applies unsupervised machine learning to find anomalous shutdown commands without pre-defined rules. By vectorizing the features of shutdown commands (e.g., flags used, timeout value, comment length) and applying a clustering algorithm like DBSCAN, we can group routine administrative activities into distinct clusters. Any command that does not fit into these established clusters is flagged as an outlier or 'noise'. Such an outlier represents a deviation from normal behavior and warrants investigation as a potentially malicious command.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Windows PowerShell Logging Event ID 4104
      - All Windows Endpoints and Servers, with heightened scrutiny on administrative jump boxes and domain controllers.
    range: last 90 days
    queries:
      - pseudocode: VECTORIZE features from all shutdown commands. APPLY clustering algorithm (e.g., DBSCAN). ALERT on any command classified as a noise point/outlier.
  - question: Is a remote shutdown command being issued from a non-standard administrative host?
    context: Remote administration, including shutdowns, should originate from designated management servers or administrator workstations. This question aims to detect when tools like `wmic.exe` or PowerShell's `Invoke-Command` are used to issue a remote shutdown from an unauthorized source. By maintaining a list of approved administrative sources, we can alert on any remote shutdown command that originates from a host not on this list, which could indicate a compromised machine being used for lateral movement and impact.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Zeek conn.log
      - Windows PowerShell Logging Event ID 4104
      - Administrative Workstations, Jump Servers, Management Network Segments, and Domain Controllers.
    range: last 90 days
    queries:
      - pseudocode: SEARCH for `wmic ... os call shutdown` OR `Invoke-Command ... Restart-Computer`. CHECK if source host is on the approved list of administrative servers. ALERT if source host is not on the list.
  - question: Is an administrator account rebooting an abnormally high number of systems?
    context: A sudden, drastic increase in the number of remote reboots initiated by a single account can be a sign of compromise or malicious insider activity. This question establishes a statistical profile for each administrator's remote reboot activity (e.g., average systems rebooted per hour). An alert is triggered if an account's activity significantly deviates from its own baseline, such as exceeding 3 standard deviations from their mean, indicating a potential mass-shutdown script being run under their credentials.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Zeek conn.log
      - Windows PowerShell Logging Event ID 4104
      - Administrative Workstations, Jump Servers, Management Network Segments, and Domain Controllers.
    range: last 90 days
    queries:
      - pseudocode: FOR each admin account, TRACK remote reboot activity over time to build a baseline. ALERT if current activity (e.g., reboots per hour) exceeds 3 standard deviations above the account's historical mean.
  - question: Does a remote shutdown command represent an anomalous connection in the network's administrative activity graph?
    context: This question models the relationships between users, source hosts, and target hosts as a graph to identify anomalous administrative actions. Normal activity forms predictable communities within this graph (e.g., server admins rebooting servers). A remote shutdown command that creates an edge bridging disparate communities (e.g., a user from marketing rebooting a finance server) is highly anomalous. Using graph-based anomaly detection, we can flag these unusual connections that violate the established patterns of administrative trust and function.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Zeek conn.log
      - Windows PowerShell Logging Event ID 4104
      - Administrative Workstations, Jump Servers, Management Network Segments, and Domain Controllers.
    range: last 90 days
    queries:
      - pseudocode: CONSTRUCT a graph of users, hosts, and remote commands. USE a graph anomaly detection algorithm. ALERT on new edges that bridge distinct communities or have a high anomaly score.
  - question: Did a system shut down immediately after a remote logon?
    context: Adversaries may automate the process of logging into a machine just to issue a shutdown command. This question looks for a specific, timed sequence of events: a successful remote logon (Event ID 4624, Type 3 or 10) followed very quickly by a system shutdown initiation (Event ID 1074) attributed to the same logon session. A stateful rule that correlates these two events within a short window (e.g., 5 minutes) can effectively detect this 'logon-and-shutdown' tactic.
    answer_sources:
      - Windows Event ID 4624
      - Windows Event ID 1074
      - High-value assets such as Domain Controllers, Database Servers, Certificate Authorities, and critical application servers.
    range: last 90 days
    queries:
      - pseudocode: CORRELATE remote logon events (EID 4624, Type 3/10) with shutdown events (EID 1074) by Logon ID. ALERT if a shutdown event occurs within 5 minutes of a logon on the same host with the same Logon ID.
  - question: Was a remote session that preceded a shutdown unusually short compared to the user's typical session duration?
    context: This question adds a layer of user-specific behavioral analysis to the 'logon-and-shutdown' scenario. For each user, we can establish a baseline of their typical remote session durations. A session that is a statistical outlier in its shortness (e.g., in the bottom 5th percentile) and is immediately followed by a system shutdown is highly suspicious. This suggests that the session's only purpose was to issue the shutdown command, which is indicative of an automated, malicious script.
    answer_sources:
      - Windows Event ID 4624
      - Windows Event ID 1074
      - High-value assets such as Domain Controllers, Database Servers, Certificate Authorities, and critical application servers.
    range: last 90 days
    queries:
      - pseudocode: FOR each user, CALCULATE a baseline of remote logon session durations. ON a new session that precedes a shutdown, COMPARE its duration to the user's baseline. ALERT if the duration is a statistical outlier (e.g., bottom 5th percentile).
  - question: Does a sequence analysis model identify a direct 'Remote Logon' to 'System Shutdown' transition as anomalous?
    context: This question uses a sophisticated sequence analysis model like an LSTM to learn the normal flow of events within a user session. A direct transition from a 'Remote Logon' event to a 'System Shutdown' event, without any intervening activity, would be a highly improbable and anomalous sequence for most legitimate user behavior. The model can flag this sequence as a deviation from the learned norm, indicating potential malicious automation.
    answer_sources:
      - Windows Event ID 4624
      - Windows Event ID 1074
      - High-value assets such as Domain Controllers, Database Servers, Certificate Authorities, and critical application servers.
    range: last 90 days
    queries:
      - pseudocode: INPUT sequences of user session events into a trained LSTM model. ALERT if the model flags the sequence 'Remote Logon -> System Shutdown' as having a high anomaly score or low probability.
  - question: Is there an abnormally high number of systems shutting down across an asset group outside of a maintenance window?
    context: A widespread, coordinated shutdown of multiple systems is a hallmark of a major impact event. This question aims to detect such an event by counting the number of distinct hosts reporting shutdown events within a short time frame. This count is compared against a static threshold (e.g., more than 2% of assets). To reduce false positives, the rule also checks against a predefined calendar of scheduled maintenance windows. An alert under these conditions points to a potential widespread, unscheduled, and likely malicious outage.
    answer_sources:
      - Windows Event ID 1074
      - Windows Event ID 6006
      - The entire enterprise network, logically segmented by asset groups (e.g., Workstations, VDI, Web Servers, Database Servers) for more granular analysis.
    range: last 90 days
    queries:
      - pseudocode: EVERY 5 minutes, COUNT distinct hosts with shutdown events (EID 1074, 6006) in the last 15 minutes. CHECK if current time is within a maintenance window. ALERT if count exceeds a static threshold (e.g., >2% of assets) AND it is not a maintenance window.
  - question: Is the current rate of shutdown events a statistical anomaly compared to the historical baseline for this time of day?
    context: This question provides a more dynamic approach than a static threshold by accounting for normal fluctuations in system activity. It establishes a historical baseline of shutdown event counts for each asset group, specific to the time of day and day of the week. Using a Z-score or similar statistical measure on a sliding time window, it can detect a sudden spike in shutdowns that is abnormal for that particular time. An alert is triggered if the count is significantly above the mean (e.g., >4 standard deviations).
    answer_sources:
      - Windows Event ID 1074
      - Windows Event ID 6006
      - The entire enterprise network, logically segmented by asset groups (e.g., Workstations, VDI, Web Servers, Database Servers) for more granular analysis.
    range: last 90 days
    queries:
      - pseudocode: FOR each asset group, COMPARE the count of shutdowns in a 15-minute window to the historical baseline for that time/day. CALCULATE the Z-score. ALERT if Z-score > 4.
  - question: Does a multivariate time-series model detect a system-wide shutdown anomaly that violates learned correlations between asset groups?
    context: This question employs an advanced model that understands the relationships between different parts of the network. A multivariate model analyzes the time-series of shutdown counts from all asset groups at once. It can then detect an anomalous event that violates these learned inter-group patterns, providing a high-fidelity alert for a sophisticated, widespread attack that a single-group analysis might miss.
    answer_sources:
      - Windows Event ID 1074
      - Windows Event ID 6006
      - The entire enterprise network, logically segmented by asset groups (e.g., Workstations, VDI, Web Servers, Database Servers) for more granular analysis.
    range: last 90 days
    queries:
      - pseudocode: INPUT time-series data of shutdown counts from all asset groups into a multivariate anomaly detection model (e.g., LSTM autoencoder). ALERT if the model flags a time window with a high reconstruction error/anomaly score.
  - question: Has network traffic from a critical subnet dropped suddenly and dramatically?
    context: A mass shutdown or network isolation of critical systems will manifest as a sudden disappearance of their network traffic. By monitoring the volume of connections from critical subnets (like those for domain controllers or databases), a simple rule can alert if the traffic drops by a drastic amount (e.g., >90%) in a short period. This serves as a powerful, high-level indicator that a group of critical assets has gone offline simultaneously.
    answer_sources:
      - Zeek conn.log
      - Network Choke Points (Core Switches, Subnet Aggregation Points, Internet Gateway, VPN Concentrators).
    range: last 90 days
    queries:
      - pseudocode: FOR each critical subnet, MONITOR active connection count in `conn.log`. ALERT if count drops by >90% in a 5-minute window compared to the previous hour's average.
  - question: Has network traffic volume from a critical segment fallen to a historically unprecedented low for this time of day?
    context: This question refines network traffic analysis by comparing current volume to a detailed historical baseline. It calculates the normal distribution of traffic metrics for each network segment for every minute of the day based on long-term data. An alert is triggered if the current traffic volume falls to an extreme low (e.g., below the 1st percentile of its historical range for that specific time). This method is more robust than a simple percentage drop as it can detect a significant outage even if traffic doesn't drop to absolute zero.
    answer_sources:
      - Zeek conn.log
      - Network Choke Points (Core Switches, Subnet Aggregation Points, Internet Gateway, VPN Concentrators).
    range: last 90 days
    queries:
      - pseudocode: FOR each network segment, COMPARE current traffic volume to the historical distribution for the current time of day. ALERT if the current volume falls below the 1st percentile of the historical data.
  - question: Is the observed network traffic volume from a critical segment significantly lower than what a time-series forecasting model predicted?
    context: This approach uses a forecasting model (like Prophet) that understands seasonality in network traffic. The model continuously predicts the expected traffic volume along with a confidence interval (e.g., a 99% confidence band). An alert is generated only if the actual, observed traffic volume falls below the lower bound of this predicted range for a sustained period. This method effectively filters out expected fluctuations and provides very high-confidence alerts for true network segment outages.
    answer_sources:
      - Zeek conn.log
      - Network Choke Points (Core Switches, Subnet Aggregation Points, Internet Gateway, VPN Concentrators).
    range: last 90 days
    queries:
      - pseudocode: FOR each network segment, USE a forecasting model to predict expected traffic volume with confidence intervals. ALERT if observed volume falls below the lower confidence bound for a sustained period (e.g., >3 minutes).