[
  {
    "Is the adversary establishing persistence by modifying account properties for reversible encryption? (TA0003 - Persistence)": {
      "Indicators": {
        "T1556.005 - Reversible Encryption": {
          "Changes detected enabling the 'Store passwords using reversible encryption' setting in Group Policy or FGPP.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4662",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event logs (Event ID 4657, 4662) on Domain Controllers for modifications to security policy settings, specifically looking for changes enabling reversible password encryption (e.g., modification of msDS-SupportedEncryptionTypes or policy related attributes). Investigate source account and machine. Analyze time series of policy changes to identify outliers or unexpected modifications."
          },
          "Execution of PowerShell or command-line tools modifying Active Directory user/account settings to enable reversible encryption.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4662",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) on Domain Controllers or administration workstations for execution of PowerShell (powershell.exe) or other scripting/command-line tools containing suspicious arguments like '-AllowReversiblePasswordEncryption $true', 'Set-ADUser', 'Set-ADAccountControl'. Use correlation analysis to link command execution events with subsequent Active Directory modification events (Event ID 4662) on targeted user accounts."
          },
          "Direct modification of user account properties (`userParameters`) to enable or store reversible encryption related data (`G$RADIUSCHAP`, `G$RADIUSCHAPKEY`).": {
            "Data": "Windows Event ID 4662",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4662 on Domain Controllers. Filter for `objectClass` being 'user' and the `attributeLDAPDisplayName` being 'userParameters'. Analyze the `Old and New Value` fields to identify changes that store reversible encryption data (`G$RADIUSCHAP`, `G$RADIUSCHAPKEY`). Correlate with account names and source IPs to identify potentially compromised accounts or systems making unauthorized changes. Use frequency analysis to baseline normal attribute modifications."
          },
          "Access attempts or suspicious operations targeting LSA secrets (`G$MSRADIUSCHAPKEY`) or the RASSFM.DLL file on a Domain Controller after reversible encryption is enabled.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4663; Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4656 and 4663 on Domain Controllers for read/access attempts on the LSA secrets or `RASSFM.DLL` file path. Correlate these access attempts with recent policy/attribute changes detected in Event IDs 4657/4662 related to reversible encryption. Monitor Windows Event ID 4688 for execution of known credential dumping tools or processes attempting to load `RASSFM.DLL` or access LSA secrets from unusual locations or via non-standard methods. Use correlation analysis to link these activities to the enabling of reversible encryption."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary attempting to evade defenses by enabling reversible password encryption? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1556.005 - Reversible Encryption": {
          "Unexpected changes enabling the 'Store passwords using reversible encryption' setting in Group Policy or FGPP, potentially bypassing defenses.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4662",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event logs (Event ID 4657, 4662) on Domain Controllers for modifications to security policy settings, specifically looking for changes enabling reversible password encryption (e.g., modification of msDS-SupportedEncryptionTypes or policy related attributes). Investigate source account and machine. Analyze time series of policy changes to identify outliers or unexpected modifications."
          },
          "Command-line or PowerShell activity unexpectedly enabling reversible encryption on user accounts, potentially for defense evasion.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4662",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) on Domain Controllers or administration workstations for execution of PowerShell (powershell.exe) or other scripting/command-line tools containing suspicious arguments like '-AllowReversiblePasswordEncryption $true', 'Set-ADUser', 'Set-ADAccountControl'. Use correlation analysis to link command execution events with subsequent Active Directory modification events (Event ID 4662) on targeted user accounts."
          },
          "Direct modification of user account properties (`userParameters`) to enable or store reversible encryption related data (`G$RADIUSCHAP`, `G$RADIUSCHAPKEY`).": {
            "Data": "Windows Event ID 4662",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4662 on Domain Controllers. Filter for `objectClass` being 'user' and the `attributeLDAPDisplayName` being 'userParameters'. Analyze the `Old and New Value` fields to identify changes that store reversible encryption data (`G$RADIUSCHAP`, `G$RADIUSCHAPKEY`). Correlate with account names and source IPs to identify potentially compromised accounts or systems making unauthorized changes. Use frequency analysis to baseline normal attribute modifications."
          },
          "Access attempts or suspicious operations targeting LSA secrets (`G$MSRADIUSCHAPKEY`) or the RASSFM.DLL file on a Domain Controller after reversible encryption is enabled.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4663; Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4656 and 4663 on Domain Controllers for read/access attempts on the LSA secrets or `RASSFM.DLL` file path. Correlate these access attempts with recent policy/attribute changes detected in Event IDs 4657/4662 related to reversible encryption. Monitor Windows Event ID 4688 for execution of known credential dumping tools or processes attempting to load `RASSFM.DLL` or access LSA secrets from unusual locations or via non-standard methods. Use correlation analysis to link these activities to the enabling of reversible encryption."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary attempting credential access by enabling reversible password encryption? (TA0006 - Credential-Access)": {
      "Indicators": {
        "T1556.005 - Reversible Encryption": {
          "Policy changes detected enabling reversible password encryption, potentially preceding credential dumping.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4662",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event logs (Event ID 4657, 4662) on Domain Controllers for modifications to security policy settings, specifically looking for changes enabling reversible password encryption (e.g., modification of msDS-SupportedEncryptionTypes or policy related attributes). Investigate source account and machine. Analyze time series of policy changes to identify outliers or unexpected modifications."
          },
          "Suspicious command-line or PowerShell activity enabling reversible password encryption on accounts, indicative of credential access attempts.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4662",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) on Domain Controllers or administration workstations for execution of PowerShell (powershell.exe) or other scripting/command-line tools containing suspicious arguments like '-AllowReversiblePasswordEncryption $true', 'Set-ADUser', 'Set-ADAccountControl'. Use correlation analysis to link command execution events with subsequent Active Directory modification events (Event ID 4662) on targeted user accounts."
          },
          "Direct modification of user account properties (`userParameters`) to enable or store reversible encryption related data (`G$RADIUSCHAP`, `G$RADIUSCHAPKEY`).": {
            "Data": "Windows Event ID 4662",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4662 on Domain Controllers. Filter for `objectClass` being 'user' and the `attributeLDAPDisplayName` being 'userParameters'. Analyze the `Old and New Value` fields to identify changes that store reversible encryption data (`G$RADIUSCHAP`, `G$RADIUSCHAPKEY`). Correlate with account names and source IPs to identify potentially compromised accounts or systems making unauthorized changes. Use frequency analysis to baseline normal attribute modifications."
          },
          "Access attempts or suspicious operations targeting LSA secrets (`G$MSRADIUSCHAPKEY`) or the RASSFM.DLL file on a Domain Controller after reversible encryption is enabled.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4663; Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4656 and 4663 on Domain Controllers for read/access attempts on the LSA secrets or `RASSFM.DLL` file path. Correlate these access attempts with recent policy/attribute changes detected in Event IDs 4657/4662 related to reversible encryption. Monitor Windows Event ID 4688 for execution of known credential dumping tools or processes attempting to load `RASSFM.DLL` or access LSA secrets from unusual locations or via non-standard methods. Use correlation analysis to link these activities to the enabling of reversible encryption."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]