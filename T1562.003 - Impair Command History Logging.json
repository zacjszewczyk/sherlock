[
  {
    "Has the adversary attempted to impair command history logging? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1562.003 - Impair Command History Logging": {
          "Modification or unsetting of command history environment variables (HISTFILE, HISTSIZE, HISTCONTROL) on systems running bash or similar shells.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation logs (Windows Event ID 4688 capturing command line) for commands attempting to modify or unset shell history environment variables (e.g., `unset HISTFILE`, `export HISTSIZE=0`, `export HISTCONTROL=ignorespace`). Correlate with user and parent process to detect unexpected execution."
          },
          "Execution of PowerShell commands to disable history logging or change history file path.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation logs (Windows Event ID 4688 capturing command line) for PowerShell command lines containing `Set-PSReadLineOption -HistorySaveStyle SaveNothing` or `Set-PSReadLineOption -HistorySavePath`. Identify the user executing the command and analyze for anomalous or unauthorized activity using frequency analysis on command arguments."
          }
        }
      }
    }
  }
]