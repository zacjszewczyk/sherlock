[
  {
    "Is the adversary attempting to evade defenses using trusted tools? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1216.002 - SyncAppvPublishingServer": {
          "Execution of SyncAppvPublishingServer.vbs by wscript.exe from an unusual location or with unusual parameters.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) for instances where 'wscript.exe' is the parent process executing 'SyncAppvPublishingServer.vbs'. Note the full command line, parent process path, and execution path of the script. Flag executions where the script is not run from '\\System32' or has unusual parent processes. Use frequency analysis on script paths and parent processes to identify rare occurrences."
          },
          "Execution of SyncAppvPublishingServer.vbs with arguments containing PowerShell syntax or commands (e.g., containing 'n; {PowerShell}').": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) for instances where 'wscript.exe' executes 'SyncAppvPublishingServer.vbs'. Extract the full command line arguments. Scan command line arguments for suspicious patterns, keywords, or syntax indicative of embedded PowerShell commands (e.g., 'n; {', 'Get-Process', 'Invoke-Expression'). Use string matching and potentially entropy analysis on the command line arguments to detect obfuscated commands."
          },
          "Network connections originating from 'wscript.exe' or its child processes to unusual or external destinations.": {
            "Data": "Windows Event ID 5156; Zeek conn.log",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 5156 for network connections where the initiating process is 'wscript.exe' or processes spawned by 'wscript.exe'. Correlate these with Zeek conn.log data. Identify connections to external IPs or IPs not on approved lists. Use frequency analysis of destination IPs and ports for 'wscript.exe' to identify rare connections compared to baseline. Correlate with threat intelligence feeds."
          },
          "Creation of unusual or malicious child processes directly or indirectly by 'wscript.exe'.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations where the parent process is 'wscript.exe' or where a process spawned by 'wscript.exe' is the parent. Analyze the created processes (e.g., cmd.exe, powershell.exe with unusual arguments, other suspicious executables) and their command lines. Use frequency analysis to identify rare child processes spawned by 'wscript.exe' or its descendants. Establish baseline child processes for 'wscript.exe' in the environment and flag significant deviations."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]