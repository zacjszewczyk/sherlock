[
  {
    "Is the adversary evading defenses using embedded payloads? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1027.009 - Embedded Payloads": {
          "Execution of files with unusual properties (e.g., unexpected overlays, self-nesting) or suspicious execution behavior.": {
            "Data": "Windows Event ID 4688, Zeek file.log, Zeek pe.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation logs (Event ID 4688) and file metadata logs (Zeek file.log, pe.log). Identify files executed with unusual section structures (from pe.log) or atypical file sizes relative to their type. Use statistical analysis on file metadata or byte patterns to flag outliers that might indicate embedded payloads or overlays. Investigate executions of files flagged by this analysis for suspicious parent-child relationships or network connections."
          },
          "Process injection attempts where the source of injected code appears to originate from data loaded or embedded in a seemingly benign process.": {
            "Data": "Windows Event ID 8, Windows Event ID 10",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process injection events (Sysmon Event IDs 8, 10). Analyze the source process, target process, and characteristics of the injected code/memory region. Use correlation analysis to link injection events to prior file operations (creation, modification) or network events, looking for patterns where the injected payload source aligns with data potentially embedded or loaded from an external source."
          }
        }
      }
    }
  }
]