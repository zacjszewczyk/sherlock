[
  {
    "Is the adversary attempting to obfuscate command and control traffic using data encoding? (TA0011 - Command and Control)": {
      "Indicators": {
        "T1132 - Data Encoding": {
          "Network traffic flows exhibiting unusual asymmetry (e.g., significantly more data uploaded than downloaded) from internal hosts.": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log, http.log, and dns.log to identify asymmetric data flows, particularly where upload volume significantly exceeds download volume or where traffic originates from processes/hosts not typically associated with large uploads. Calculate descriptive statistics (mean, median, ratios) for bytes transferred (orig_bytes/resp_bytes) per connection, service, or host, and flag significant outliers using IQR or percentiles."
          },
          "Network traffic containing data consistent with standard encoding (like Base64) on ports/protocols where it is not expected, or exhibiting non-standard protocol behavior.": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek dns.log; Zeek ssl.log; Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Examine packet data (e.g., via Zeek extracted content or packet captures) associated with suspicious connections flagged by unusual patterns or suspicious destinations. Look for patterns indicative of data encoding (e.g., Base64 character sets in unexpected locations) or protocol deviations (e.g., non-standard HTTP requests, unexpected data within DNS queries/responses). Use entropy analysis on payload data to identify potentially encrypted or encoded streams."
          },
          "Network connections originating from unusual or never-before-seen processes on endpoints or servers.": {
            "Data": "Zeek conn.log; Windows Event ID 4688; Windows Event ID 5156",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify network connections in Zeek conn.log originating from internal hosts. Correlate with Windows Event ID 5156 to identify the initiating process name and path. Analyze Windows Event ID 4688 logs to identify when the process was created and its parent process. Maintain a baseline of common network-connecting processes on endpoints/servers using frequency analysis. Flag connections originating from processes with low frequency, those seen for the first time (novelty detection), or those with suspicious parent-child relationships."
          },
          "Processes exhibiting asymmetric network traffic patterns or sending data containing suspicious encoding indicators.": {
            "Data": "Zeek conn.log; Windows Event ID 4688; Zeek http.log; Zeek dns.log",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify processes (using Windows Event ID 4688 or 5156 correlated with Zeek conn.log) that exhibit unusual asymmetric traffic flows (e.g., high upload/download ratio calculated from Zeek conn.log) or whose associated network traffic (Zeek conn.log, http.log, dns.log) contains potential indicators of encoding (e.g., high entropy, Base64-like strings). Prioritize investigation of processes flagged by both network characteristics (asymmetry, encoding indicators) and process anomalies (e.g., unusual process path, parent process)."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]