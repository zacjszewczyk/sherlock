[
  {
    "Is the adversary executing code or scripts on endpoints? (TA0002 - Execution)": {
      "Indicators": {
        "T1059.002 - AppleScript": {
          "Creation of suspicious processes or command-line arguments potentially initiated by scripting activity.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations with command-line arguments indicative of scripting languages calling other utilities or executing encoded commands. Identify unusual parent-child process relationships (e.g., common system processes launching interpreters or network tools). Use descriptive statistics and time series analysis to identify abnormal frequency or timing of process creations by specific users or on critical systems."
          },
          "Unusual network connections or data access patterns potentially resulting from script execution.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for connections to unusual or unknown external IP addresses/domains, especially from internal endpoints or servers. Correlate Zeek sessions with Windows Event ID 4688 entries based on timestamp and source IP/host to link network activity to suspicious process creation. Use frequency analysis and entropy measures on destination IPs/ports/domains to identify rare connections potentially used for C2 or exfiltration."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]