[
  {
    "Is the adversary using external web services for command and control (one-way communication)? (TA0011 - Command-And-Control)": {
      "Indicators": {
        "T1102.003 - One-Way Communication": {
          "Network connections from internal hosts to legitimate popular websites or social media platforms associated with known C2 activity or exhibiting unusual patterns (e.g., non-browser user-agents, high frequency).": {
            "Data": "Zeek conn.log, Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections to high-traffic web domains (e.g., social media, popular search engines). Filter for connections from non-browser user-agents in http.log or connections with unusual destination ports/protocols for these domains. Correlate identified connections with threat intelligence feeds for known C2 domains/IPs. Use descriptive statistics to identify users/hosts with abnormally high or unusual connection patterns to these sites."
          },
          "Outbound network connections to external web services (especially on common web ports like 80/443) with little to no return traffic volume or unexpected protocol behavior.": {
            "Data": "Zeek conn.log, Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log entries, specifically comparing \"orig_bytes\" and \"resp_bytes\" for connections to common web ports (80, 443) with external destinations. Identify sessions where \"orig_bytes\" is significantly larger than \"resp_bytes\" (indicating potential one-way outbound data) or where \"resp_bytes\" is zero or minimal for typical request types. Calculate byte ratios (orig/resp) and use outlier detection (e.g., box plots or IQR) to flag sessions with extreme imbalances."
          }
        }
      }
    }
  }
]