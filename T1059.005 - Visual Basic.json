[
  {
    "Has the adversary executed code or commands using Visual Basic? (TA0002 - Execution)": {
      "Indicators": {
        "T1059.005 - Visual Basic": {
          "Execution of script host processes (wscript.exe, cscript.exe) or Office applications spawning unexpected processes.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations where ParentProcessName is an Office application (winword.exe, excel.exe, powerpnt.exe, outlook.exe) and NewProcessName is a script host (wscript.exe, cscript.exe, powershell.exe) or other suspicious executables. Analyze command-line arguments (CommandLine in 4688) for suspicious script execution patterns. Identify rare or unusual parent-child process combinations using frequency analysis."
          },
          "Creation or modification of Visual Basic script files (.vbs, .hta with vbscript) or loading of vbscript.dll in unusual processes.": {
            "Data": "Windows Event ID 4656, Windows Event ID 4663, Sysmon Event ID 7",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4656/4663 for file write/create operations targeting locations typically used for temporary or user files with '.vbs' or '.hta' extensions. Monitor Sysmon Event ID 7 for 'vbscript.dll' loading in processes other than expected browsers or system processes. Use correlation analysis to link file creation events to subsequent process execution."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]