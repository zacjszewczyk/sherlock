[
  {
    "Is the adversary executing malicious code on the network using PowerShell? (TA0002 - Execution)": {
      "Indicators": {
        "T1059.001 - PowerShell": {
          "Suspicious PowerShell script block or command execution logs detected on endpoints or servers.": {
            "Data": "Windows Event ID 4104, Windows Event ID 4103, Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect Windows Event ID 4104 (PowerShell Script Block Logging) and 4103 (Module Logging) from endpoints/servers. Analyze script block content and commands for known malicious patterns, obfuscation techniques, or suspicious cmdlets (e.g., 'Invoke-Expression', 'Invoke-Command', 'DownloadFile'). Use frequency analysis to identify rarely seen command-line arguments or script block hashes."
          },
          "Detection of System.Management.Automation.dll loading into unusual or non-standard processes.": {
            "Data": "Windows Event ID 7, Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 7 (Sysmon) for ImageLoad events where 'Image Loaded' is 'System.Management.Automation.dll'. Correlate these events with Process Creation events (Windows Event ID 4688). Use statistical analysis (e.g., frequency distribution) to identify processes or parent processes that rarely or never load this DLL under normal circumstances, flagging them as potentially suspicious."
          }
        }
      }
    }
  }
]