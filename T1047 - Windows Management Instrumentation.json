[
  {
    "Is the adversary executing commands or payloads using WMI? (TA0002 - Execution)": {
      "Indicators": {
        "T1047 - Windows Management Instrumentation": {
          "Unusual WMI network traffic (ports 135, 5985, 5986) in segments or between systems not typically using WMI.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections on ports 135, 5985, 5986. Identify source/destination pairs. Use correlation analysis to identify connection patterns between systems not typically communicating via WMI or in unusual network segments. Use time series analysis to detect spikes in WMI traffic volume."
          },
          "Execution of 'wmic.exe' or related PowerShell/COM objects with suspicious command-line arguments or from unusual processes.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4104",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation events (Windows Event ID 4688) for 'wmic.exe' or PowerShell/cmd.exe executing commands often associated with WMI abuse (e.g., interacting with WMI classes like Win32_Process, Win32_Shadowcopy). Analyze command-line arguments for suspicious keywords or patterns. Monitor PowerShell script block logging (Event ID 4104) for WMI related methods/cmdlets. Use frequency analysis or outlier detection to flag processes launching wmic.exe or WMI-related commands from unusual parent processes or directories."
          },
          "Remote WMI execution (via DCOM or WinRM) originating from an unusual source system or targeting an unusual destination system within the network.": {
            "Data": "Zeek conn.log; Windows Event ID 4624; Windows Event ID 4688",
            "Data Platform": "Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for traffic on WMI ports (135, 5985, 5986) originating from or destined to unexpected internal systems. Correlate with successful network logons (Windows Event ID 4624, Logon Type 3) on target servers. Establish a baseline of legitimate remote WMI usage (source/destination pairs, frequency) using descriptive statistics. Flag new or infrequent WMI connections. Analyze processes created via remote WMI (e.g., logged in Windows Event ID 4688 if configuration allows) for malicious indicators."
          },
          "WMI activity consistent with malicious discovery or execution patterns, such as querying for antivirus products, creating/modifying WMI event subscriptions, or deleting shadow copies using WMI methods.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4104",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation (Windows Event ID 4688) for 'wmic.exe' with arguments like 'Shadowcopy Delete', 'Process Call Create', or queries for sensitive system information. Monitor PowerShell script block logging (Event ID 4104) for cmdlets like 'Get-WmiObject', 'Invoke-WmiMethod', 'Register-WmiEvent' used with suspicious parameters (e.g., querying 'AntiVirusProduct', creating persistence via event filters/consumers, executing encoded commands). Use correlation analysis to link suspicious WMI commands to parent processes or user accounts and analyze their typical behavior using frequency analysis of commands."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]