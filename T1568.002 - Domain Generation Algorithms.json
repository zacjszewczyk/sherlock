[
  {
    "Is the adversary communicating with command and control infrastructure using Domain Generation Algorithms? (TA0011 - Command And Control)": {
      "Indicators": {
        "T1568.002 - Domain Generation Algorithms": {
          "Detection of domain names exhibiting high entropy or low dictionary word proportion indicative of DGA.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek dns.log for outbound DNS queries. For each queried domain name, calculate its entropy score and ratio of non-dictionary characters/n-grams. Flag domains exceeding a predefined entropy threshold or those with a high non-dictionary character/n-gram ratio. Exclude known legitimate high-entropy domains (e.g., CDNs) via a whitelist."
          },
          "Outbound connections to recently registered or rarely visited domains.": {
            "Data": "Zeek dns.log; Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek dns.log and conn.log. Identify unique destination domains/IPs for outbound connections. Correlate queried domains with available registration data (e.g., WHOIS lookups via external service if possible, or internal lists of recently seen domains). Flag connections to domains registered very recently or domains seen very infrequently across the network using frequency analysis."
          },
          "Detection of domain names with unusual character distributions (e.g., low vowel/consonant ratio, repetitive character patterns) characteristic of specific DGA families.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek dns.log for outbound DNS queries. For each queried domain name, calculate metrics such as vowel/consonant ratio, digit ratio, and specific N-gram frequencies (e.g., trigrams). Compare these metrics to baselines of legitimate domains using descriptive statistics. Flag domains that significantly deviate from normal distributions or match known DGA family patterns. Exclude whitelisted domains."
          },
          "High volume of unique, failed DNS lookups for non-existent domains from a single host in a short period.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek dns.log for DNS queries resulting in NXDOMAIN (Non-Existent Domain) responses. Group these failed queries by source IP address (originating host) and time window (e.g., 5-minute intervals). Count the number of unique destination domains queried by each host that result in NXDOMAINs within the time window. Flag hosts exhibiting an unusually high rate or volume of unique NXDOMAIN queries using descriptive statistics (e.g., mean + 2*stdev) or thresholding."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]