[
  {
    "Is the adversary attempting to discover cloud infrastructure? (TA0007 - Discovery)": {
      "Indicators": {
        "T1580 - Cloud Infrastructure Discovery": {
          "Discovery API calls (e.g., DescribeInstances, ListBuckets, az vm list, gcloud compute instances list) originating from IP addresses or users not typically associated with infrastructure management.": {
            "Data": "Windows Event ID 4688, Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations involving cloud CLI commands ('aws', 'az', 'gcloud'). Correlate these events with Zeek conn.log to identify outbound connections to known cloud provider API endpoints from the host. Investigate executions from unusual users or source IPs not typically associated with infrastructure management based on statistical analysis of historical data."
          },
          "High volume or unusual sequence of cloud discovery API/CLI calls (e.g., rapid enumeration of multiple resource types) by a single user or entity.": {
            "Data": "Windows Event ID 4688, Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze command line arguments in Windows Event ID 4688 for cloud CLI processes ('aws', 'az', 'gcloud') to identify discovery commands (e.g., 'list', 'describe', 'get'). Look for unusual sequences or high frequency of these commands from a single host or user using frequency analysis or time series analysis on event timestamps to detect bursts or deviations from normal activity."
          }
        }
      }
    }
  }
]