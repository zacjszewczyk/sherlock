[
  {
    "Is the adversary attempting to discover cloud infrastructure? (TA0007 - Discovery)": {
      "Indicators": {
        "T1580 - Cloud Infrastructure Discovery": {
          "Discovery API calls (e.g., DescribeInstances, ListBuckets, az vm list, gcloud compute instances list) originating from IP addresses or users not typically associated with infrastructure management.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations involving cloud CLI commands ('aws', 'az', 'gcloud'). Correlate these events with Zeek conn.log to identify outbound connections to known cloud provider API endpoints from the host. Investigate executions from unusual users or source IPs not typically associated with infrastructure management based on statistical analysis (e.g., frequency distribution) of historical data."
          },
          "High volume or unusual sequence of cloud discovery API/CLI calls (e.g., rapid enumeration of multiple resource types) by a single user or entity.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze command line arguments in Windows Event ID 4688 for cloud CLI processes ('aws', 'az', 'gcloud') to identify discovery commands (e.g., 'list', 'describe', 'get'). Look for unusual sequences or high frequency of these commands from a single host or user using frequency analysis or time series analysis on event timestamps to detect bursts or deviations from normal activity."
          },
          "Discovery API calls from a user identity that has not previously performed such actions, or a user identity with limited scope accessing a broad range of resource types.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) for cloud CLI commands ('aws', 'az', 'gcloud'). Identify the user associated with the process. Use frequency analysis or historical baselining to flag users executing discovery commands for the first time, or users executing commands that enumerate resource types outside their typical activity profile. Calculate the diversity of resource types accessed per user over time; a sudden increase in diversity could be anomalous and flagged using statistical measures like standard deviation or variance compared to baseline."
          },
          "External connections to cloud provider API endpoints originating from known malicious or suspicious IP addresses.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek conn.log for connections to known cloud provider API endpoints (e.g., AWS, Azure, GCP API endpoints). Cross-reference external source IP addresses against a threat intelligence feed of known malicious or suspicious IPs. Flag and investigate connections originating from IPs present in threat intel feeds. Use correlation analysis to see if these IPs are also linked to other suspicious network traffic patterns."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]