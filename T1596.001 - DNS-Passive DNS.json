[
  {
    "Is the adversary conducting reconnaissance against the organization using passive DNS? (TA0043 - Reconnaissance)": {
      "Indicators": {
        "T1596.001 - DNS-Passive DNS": {
          "External DNS queries targeting multiple obscure or internal-facing subdomains of the organization observed in network logs.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek dns.log for queries originating from external IP addresses targeting multiple distinct organizational subdomains or hosts. Use clustering or graph analysis on source IP and queried host pairs to identify potential reconnaissance scanning patterns. Identify rare subdomain queries using frequency analysis or percentile ranking."
          },
          "External DNS queries attempting to enumerate organizational mail servers, services, or discover network structure through excessive queries or querying for unusual record types.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek dns.log for high-frequency DNS query patterns from external sources, specifically looking for repeated queries for MX, SRV, or TXT records, or a large volume of queries resulting in NXDOMAIN responses (potential subdomain bruteforcing). Use time series analysis (e.g., rate calculation) to detect bursts of such queries exceeding a historical baseline."
          },
          "External DNS queries for unusual or potentially sensitive record types (e.g., PTR, SPF, DMARC, CAA, specific TXT records) or attempts at zone transfers (ANY, AXFR).": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek dns.log for queries from external source IPs containing unusual `qtype` values (e.g., PTR, SPF, DMARC, CAA, specific TXT) or attempts for ANY/AXFR records. Maintain a frequency distribution of `qtype` values observed from external sources and flag queries for types with low frequency or those known to be sensitive. Investigate source IPs repeatedly querying such record types or attempting zone transfers."
          },
          "High volume of external DNS queries over a short period targeting organizational domains from a single source, potentially indicative of automated scanning or bruteforcing.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek dns.log for bursts of DNS queries from single external source IPs targeting organizational domains. Use time series analysis (e.g., sliding window count or CUSUM) on query volume per source IP/destination domain pair to detect sudden spikes exceeding a calculated baseline derived from historical data."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]