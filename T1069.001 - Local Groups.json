[
  {
    "Is the adversary performing host discovery to identify local groups and permissions? (TA0007 - Discovery)": {
      "Indicators": {
        "T1069.001 - Local Groups": {
          "Execution of system commands (e.g., net localgroup, groups) to list local groups.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation logs (Windows Event ID 4688) for command-line arguments containing 'net localgroup', 'groups', or similar commands used for local group discovery. Filter for executions originating from unusual processes, user accounts, or hosts. Use frequency analysis to identify hosts or users executing these commands unusually often compared to a baseline."
          },
          "Usage of scripting or system administration tools (e.g., PowerShell, WMI) to query local group membership or permissions.": {
            "Data": "Windows Event ID 4104; Windows Event ID 5858; Zeek dce_rpc.log",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Review PowerShell script block logs (Windows Event ID 4104) for cmdlets related to local groups or permissions (e.g., 'Get-LocalGroup', 'Get-ADGroup'). Monitor WMI activity logs (Windows Event ID 5858) or Zeek dce_rpc.log for relevant calls. Identify activity originating from non-standard user accounts or hosts. Correlate usage with other potential discovery or lateral movement activity using time series analysis or correlation analysis."
          },
          "Direct Windows API calls logged as events indicating local group enumeration by unusual processes or accounts.": {
            "Data": "Windows Event ID 4798",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4798 ('A user's local group membership was enumerated'). Filter events by source process name and calling user account. Identify and investigate enumerations originating from processes other than expected system/administration tools or from user accounts without administrative privileges. Use frequency analysis to establish a baseline of normal 4798 activity per host/user and flag significant deviations or spikes."
          },
          "Local group discovery activity correlated with network scanning from the same host within a short timeframe.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4798; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate occurrences of local group enumeration events (Windows Event ID 4798 or command execution in 4688 like `net localgroup`) with network scanning activity detected via Zeek conn.log (high volume of connections to multiple ports/hosts) or process creation (4688 for scanning tools). Use time-windowed analysis (e.g., 5-15 minutes) to identify instances where these activities originate from the same source (host/user) and occur within the defined window. Use correlation analysis to identify hosts frequently exhibiting this combined behavior."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]