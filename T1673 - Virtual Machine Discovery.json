[
  {
    "Is the adversary attempting to discover virtual machines within the environment? (TA0007 - Discovery)": {
      "Indicators": {
        "T1673 - Virtual Machine Discovery": {
          "Execution of hypervisor CLI commands (e.g., esxcli, vim-cmd) known to enumerate VMs on a host or hypervisor.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 on jump boxes or management servers for process creations involving command-line tools like 'esxcli', 'vim-cmd', or similar hypervisor CLI utilities. Analyze command-line arguments for patterns indicating VM enumeration (e.g., 'list', 'getallvms'). Calculate the frequency of such commands and flag rare executions or executions by unusual users/processes."
          },
          "Unusual network connections or activity patterns directed at hypervisor management interfaces (e.g., vCenter, ESXi web interface).": {
            "Data": "Zeek conn.log, Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and http.log for connections originating from potentially compromised internal hosts to known hypervisor management ports or web interfaces (e.g., ESXi, vCenter). Identify connections with unusual source IPs, unusual timing (e.g., outside maintenance windows), or suspicious HTTP request patterns. Use frequency analysis or time series analysis to identify anomalous connection volume or patterns."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]