[
  {
    "Has the adversary gained initial access to the network via drive-by compromise? (TA0001 - Initial Access)": {
      "Indicators": {
        "T1189 - Drive-by Compromise": {
          "Network traffic to websites with low reputation, known malicious scripts, or signs of content injection.": {
            "Data": "Zeek http.log, Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek http.log and conn.log for connections to websites. Integrate with URL/domain reputation services. Identify connections to sites with low reputation, short domain lifespan, or that match patterns of known malvertising/watering hole sites. Use statistical analysis (e.g., correlation) to identify clusters of users visiting the same suspicious sites."
          },
          "Anomalous process execution, file writes, or network connections originating from a browser process or recently executed processes on an endpoint after visiting a suspicious website.": {
            "Data": "Windows Event ID 4688, Windows Event ID 4656, Zeek conn.log",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for child processes spawned by web browsers (e.g., chrome.exe, firefox.exe, msedge.exe) that are not typical browser helper processes. Monitor Windows Event ID 4656/4663 for unusual file writes or object access by browser processes. Analyze Zeek conn.log for unusual outbound connections from the compromised host immediately following website visits. Use behavioral analysis to flag deviations from typical browser process activity."
          }
        }
      }
    }
  }
]