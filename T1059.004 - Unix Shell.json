[
  {
    "Is the adversary executing commands or payloads via Unix shells? (TA0002 - Execution)": {
      "Indicators": {
        "T1059.004 - Unix Shell": {
          "Detection of unusual shell script execution, particularly in unexpected locations or outside normal administrative cycles.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for outbound connections originating from servers or endpoints running shell scripts. Analyze connection destinations and protocols. Use statistical analysis (e.g., frequency analysis, entropy) on destination IPs, ports, or data volume to identify anomalous script-initiated network activity, particularly connections to rare or known malicious external endpoints."
          },
          "Execution of uncommon or suspicious commands via interactive shell sessions (e.g., commands related to discovery, collection, or data exfiltration).": {
            "Data": "Zeek conn.log, Zeek ssh.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and ssh.log for interactive SSH sessions to Unix systems, especially from unusual source IPs or accounts. Examine Zeek logs for patterns indicative of data transfer (e.g., large outgoing connections following login). Use time series analysis on login times and session durations to identify access outside normal working hours or unusually long/short interactive sessions."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]