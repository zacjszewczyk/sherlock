[
  {
    "Is the adversary executing commands or programs using launchctl? (TA0002 - Execution)": {
      "Indicators": {
        "Recently created or modified launchd plist files (.plist) in standard Launch Agent or Daemon directories.": {
          "Data": "Windows Event ID 4688",
          "Data Platform": "Endpoints",
          "NAI": "Insert site-specific NAI here",
          "Action": "Monitor Windows Event ID 4688 for process execution that involves writing or modifying files in typical user or system configuration directories. Analyze command lines and new process hashes for known malicious patterns. Use descriptive statistics to identify processes with anomalous file write activity volume or locations."
        },
        "Execution of the 'launchctl' command followed immediately by anomalous network connections or execution of suspicious binaries.": {
          "Data": "Windows Event ID 4688, Zeek conn.log",
          "Data Platform": "Endpoints, Network devices",
          "NAI": "Insert site-specific NAI here",
          "Action": "Monitor Windows Event ID 4688 for command lines containing 'launchctl' followed by 'load', 'start', or 'unload'. Identify the PID of the process executing 'launchctl'. Correlate this PID with network connections captured in Zeek conn.log occurring immediately after the 'launchctl' execution. Analyze destination IPs and ports for connections to known malicious C2 or unusual destinations. Use time series analysis or correlation to link 'launchctl' execution events with subsequent network activity."
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]