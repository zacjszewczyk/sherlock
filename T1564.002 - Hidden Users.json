[
  {
    "Is the adversary attempting to evade defenses by creating hidden user accounts? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1564.002 - Hidden Users": {
          "Modification of Windows Registry key \"SpecialAccounts\\UserList\" to hide a user account.": {
            "Data": "Windows Event ID 4657, Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 (Registry Value Set) and 4688 (Process Creation) on Endpoints and Servers. Filter for modifications to the key `HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList`. Investigate any entries created or modified with a value of `0`. Analyze the process that made the change (Event ID 4688) for anomalous behavior."
          },
          "Command execution or file modification to hide a user account on macOS or Linux systems (e.g., dscl command, plist modification, gsettings).": {
            "Data": "Windows Event ID 4688, Zeek fileinfo.log, Zeek command.log",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Process Creation logs (Windows Event ID 4688, or equivalent forwarded events) and file modification/command logs (Zeek fileinfo.log, Zeek command.log, or equivalent forwarded events). Look for execution of commands like `dscl`, `chflags`, `gsettings`. Monitor file modifications to `/Library/Preferences/com.apple.loginwindow.plist` looking for `Hide500Users` set to TRUE or changes to files/directories indicating hidden flags. Use correlation analysis between process execution and file modifications."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]