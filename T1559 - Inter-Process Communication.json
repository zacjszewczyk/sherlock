[
  {
    "Is the adversary executing code using inter-process communication mechanisms? (TA0002 - Execution)": {
      "Indicators": {
        "T1559 - Inter-Process Communication": {
          "Suspicious process creation or module loading associated with IPC abuse (e.g., DDE/COM-related DLLs or commands).": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 logs for suspicious command-line arguments or process relationships indicative of IPC abuse (e.g., commands invoking DDE/COM interfaces). Use pattern matching or string analysis to identify known suspicious strings. Perform frequency analysis on observed command-lines or parent-child process pairs to identify rare executions."
          },
          "Network activity indicative of remote IPC abuse (e.g., DCOM traffic to unusual destinations or ports).": {
            "Data": "Zeek conn.log; Zeek dce_rpc.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Examine Zeek conn.log and dce_rpc.log for connections to ports commonly used by DCOM or other remote IPC mechanisms (e.g., TCP 135/RPC Endpoint Mapper, dynamic ports). Analyze source/destination IPs, ports, and RPC method calls. Use correlation analysis to link suspicious network activity with known malicious IPs or internal hosts exhibiting unusual behavior. Apply time series analysis to detect spikes in DCOM/RPC traffic volumes or connections to unusual endpoints."
          },
          "Suspicious process command-line arguments or parent-child relationships indicating use of pipes or sockets for inter-process communication.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 logs. Search command-line arguments for patterns indicative of pipe creation (e.g., `\\\\.\\pipe\\`, `[pipe]`), socket binding/connecting commands, or use of tools specifically designed for IPC manipulation. Analyze parent-child relationships to identify unusual processes launching or being launched by known command interpreters (cmd.exe, powershell.exe) with these types of arguments. Use frequency analysis on observed command-line patterns or parent-child process pairs to identify rare occurrences."
          },
          "Anomalous high-frequency, low-volume network connections between internal hosts on non-standard ports, potentially used for custom IPC channels.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for connections between internal source and destination IPs. Filter for connections on ports outside the list of well-known or authorized ports. For these anomalous ports, identify sessions with a high frequency of connection attempts or packets, but low total bytes transferred, over a specific time period (e.g., per hour/day). Use statistical methods like calculating the ratio of connections to bytes transferred, or using IQR on session duration/data volume, to identify outliers indicative of persistent, low-bandwidth control/IPC channels."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]