[
  {
    "Is the adversary attempting to discover network configuration information? (TA0007 - Discovery)": {
      "Indicators": {
        "T1016 - System Network Configuration Discovery": {
          "Execution of network configuration discovery commands (ipconfig, route, arp, nbtstat) via command line or script on host systems.": {
            "Data": "Windows Event ID 4688, Zeek dce_rpc.log",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations containing common network discovery commands (ipconfig, route, arp, nbtstat) and their variations. Identify executions from unusual user accounts, directories, or sequences of commands. Use frequency analysis to detect sudden spikes in these command executions across multiple hosts."
          },
          "Attempts to gather network configuration via WMI, PowerShell, or network device CLIs from unusual sources or targeting critical infrastructure.": {
            "Data": "Windows Event ID 4104, Zeek dce_rpc.log, Zeek ssh.log, Zeek telnet.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4104 for PowerShell scripts containing WMI calls or commands to query network configuration. Monitor Zeek dce_rpc.log for remote calls potentially linked to WMI/RPC network discovery. Monitor Zeek ssh.log/telnet.log for CLI command execution patterns (if relevant NAI/device type). Correlate network device access logs or Zeek logs with host event logs to identify discovery activity originating from suspicious sources or accounts using correlation analysis."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]