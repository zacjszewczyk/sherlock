[
  {
    "Is the adversary attempting to evade defenses using VBA stomping? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1564.007 - VBA Stomping": {
          "Detection of discrepancies between VBA source code and compiled p-code in an MS Office document.": {
            "Data": "Zeek file.log, Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek file.log for Office documents transferred over the network. Monitor Windows Event ID 4688 on endpoints for the creation of Office application processes. Search Windows Event logs or network logs (Zeek) for custom event IDs/signatures generated by security tools indicating VBA source/p-code mismatch detected during file transfer or execution. Correlate file events with detection alerts using common fields."
          },
          "Detection of modifications to the PROJECT stream in an MS Office document designed to hide VBA source code viewing.": {
            "Data": "Zeek file.log, Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek file.log for Office documents. Monitor Windows Event ID 4688 for Office process launches on endpoints. Search Windows Event logs or network logs (Zeek) for custom event IDs/signatures generated by security tools indicating detection of modified VBA PROJECT streams designed to obscure content. Use correlation analysis to link file activity with detection alerts."
          }
        }
      }
    }
  }
]