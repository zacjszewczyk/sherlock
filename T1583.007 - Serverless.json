[
  {
    "Is the adversary developing resources using serverless functions? (TA0042 - Resource Development)": {
      "Indicators": {
        "T1583.007 - Serverless": {
          "Internal systems communicating with suspicious or newly observed serverless endpoint domains/IPs known to host C2 infrastructure.": {
            "Data": "Zeek conn.log; Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log and dns.log for connections or DNS queries to domains or subdomains associated with known serverless platforms (e.g., cloudflareworkers.com, lambda-url.*.on.aws). Cross-reference destination IPs/domains with threat intelligence feeds for suspected C2 infrastructure. Flag internal systems communicating with these flagged destinations. Use correlation analysis to link DNS queries and subsequent connections."
          },
          "Network connections from internal systems to serverless endpoints exhibiting unusual data volumes or patterns inconsistent with legitimate cloud service usage.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for connections from internal systems to domains/IPs identified as serverless endpoints. Calculate data volume per session/host/destination. Identify connections with high data transfer volumes or unusual timing patterns using descriptive statistics and time series analysis, comparing against baseline legitimate cloud service traffic."
          },
          "Anomalous access from internal systems to serverless platform management consoles or APIs, potentially followed by deployment or testing of serverless functions.": {
            "Data": "Zeek conn.log; Zeek dns.log; Windows Event ID 4688; Windows Event ID 4624",
            "Data Platform": "Endpoints, Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek dns.log for queries to serverless provider management domains (e.g., console.aws.amazon.com, cloud.google.com, dash.cloudflare.com). Correlate with Zeek conn.log for connections from internal IPs to these management interfaces. If command-line tools are used (detectable via Windows Event ID 4688 for processes like `aws.exe`, `gcloud.cmd`, `wrangler.exe`), analyze command parameters for function creation/modification, and correlate with logon events (Windows Event ID 4624). Subsequently, monitor for connections from the same internal IP or related systems to newly active serverless function URLs (e.g., *.lambda-url.*.on.aws, *.workers.dev) exhibiting beaconing or data upload patterns using time series analysis and descriptive statistics on data volume."
          },
          "Consistent, low-volume, periodic outbound connections from internal systems to a common set of serverless endpoints, indicative of C2 beaconing via serverless infrastructure.": {
            "Data": "Zeek conn.log; Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and dns.log for outbound connections to serverless platform domains (e.g., *.workers.dev, *.lambda-url.*.on.aws, script.google.com). Identify internal systems communicating with the same serverless endpoint(s). For these endpoints, use time series analysis to detect periodic, 'heartbeat-like' connections (e.g., connections every X minutes/hours with similar byte counts). Calculate entropy of destination serverless endpoints per internal host and connection intervals; low entropy with regular timing could suggest C2 beaconing. Correlate findings with known threat intelligence on malicious serverless infrastructure."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]