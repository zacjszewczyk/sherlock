[
  {
    "Is the adversary relocating malware to evade defenses? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1070.010 - Relocate Malware": {
          "Creation of executable files in unusual directories, potentially with names matching legitimate files, followed by deletion of the original file.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4663; Windows Event ID 4660; Sysmon Event ID 11; Sysmon Event ID 23",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor file creation events (Sysmon Event ID 11, Windows Event ID 4663) for executable types (.exe, .dll, .scr, etc.) in unusual system or user directories (not standard OS or application install paths). Correlate file creation with process creation (Sysmon Event ID 1, Windows Event ID 4688) originating from potentially suspicious parent processes. Analyze file names for patterns of matching legitimate executables but located in incorrect paths (e.g., svchost.exe in user temp). Check for corresponding file deletion events (Sysmon Event ID 23, Windows Event ID 4660) shortly after creation or execution."
          },
          "Creation of executable files in directories often targeted for exclusions by security software or unexpected system locations.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4663; Sysmon Event ID 1; Sysmon Event ID 11",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor file creation events (Sysmon Event ID 11, Windows Event ID 4663) for executable types in directories commonly excluded by security software or known persistence locations (e.g., AppData, Startup folders, specific temporary directories). Use statistical analysis (e.g., frequency analysis) to identify rarely written-to executable directories or sudden spikes in executable creation in these paths."
          },
          "Execution of executable files from temporary, user profile, or other non-standard system directories.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation events (Windows Event ID 4688). Filter for processes running from known temporary directories (e.g., %TEMP%), user profile directories (e.g., %APPDATA%, Downloads), or other locations not typically used for program execution (e.g., Recycle Bin). Establish a baseline of legitimate processes running from these locations using frequency analysis over time. Flag new or rare executable processes (low frequency) observed executing from these paths."
          },
          "Outbound network connections initiated by processes running from temporary, user profile, or other non-standard system directories.": {
            "Data": "Windows Event ID 4688; Windows Event ID 5156; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify processes running from temporary, user profile, or other non-standard directories using Windows Event ID 4688. Correlate these process executions with outbound network connections (Windows Event ID 5156 on the host or Zeek conn.log matching the host IP and connection time). Filter connections by destination (external, suspicious, or not part of normal communication patterns). Use correlation analysis to link suspicious process execution paths to network activity, flagging connections to destinations not typically accessed by processes in those locations. Prioritize connections to known bad IPs/domains using threat intelligence."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]