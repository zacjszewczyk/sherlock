[
  {
    "Is the adversary developing resources for exploitation via drive-by target? (TA0042 - Resource Development)": {
      "Indicators": {
        "T1608.004 - Drive-by Target": {
          "Connections from internal systems to known or suspected malicious/compromised websites often used for drive-by staging.": {
            "Data": "Zeek http.log; Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek http.log and conn.log for connections to domains/IPs identified in threat intelligence feeds as hosting drive-by content or being part of watering hole attacks. Use frequency analysis to identify visited domains that are rare or outliers within the organization's browsing history. Correlate external connections to known compromised sites."
          },
          "Network traffic patterns showing connections to suspicious advertising domains or infrastructure known to host malicious content.": {
            "Data": "Zeek http.log; Zeek dns.log; Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek http.log and dns.log for connections to domains known for malvertising or associated with adversary infrastructure. Use clustering analysis on connection patterns (e.g., high volume of connections to specific advertising domains followed by suspicious activity) or time series analysis to detect anomalous spikes in traffic to suspicious ad/hosting domains."
          },
          "Connections to domains with indicators of temporary or suspicious registration characteristic of staging infrastructure.": {
            "Data": "Zeek http.log; Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek dns.log and http.log. Enrich domain data with domain age and WHOIS info (e.g., registration date, registrar). Calculate the median domain age for visited domains. Flag connections to domains significantly younger than the median or exhibiting other suspicious WHOIS characteristics using descriptive statistics."
          },
          "HTTP requests from internal clients for potentially malicious file types or content from unexpected external web locations.": {
            "Data": "Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek http.log for GET/POST requests. Identify requests for common exploit/payload file types (.exe, .dll, .js, .hta, .vbs, etc.). Analyze the 'Referer' header and requested URL path. Flag requests where the requested file type/location is statistically uncommon for that domain or referer (e.g., using frequency analysis or clustering based on referer/requested path/file type). Prioritize requests originating from connections to suspicious advertising domains or known-bad sites identified in other evidence."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]