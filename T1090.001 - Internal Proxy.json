[
  {
    "Is the adversary using an internal proxy for Command and Control? (TA0011 - Command and Control)": {
      "Indicators": {
        "T1090.001 - Internal Proxy": {
          "Network traffic between internal hosts that do not normally communicate.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log to identify internal host-to-host connections. Build a matrix or graph of historical communication patterns between internal hosts. Identify statistically significant deviations or new connections between hosts that historically show low or no communication frequency (e.g., using correlation analysis or frequency distribution analysis)."
          },
          "Unusual process network connections or network traffic not conforming to expected protocols on standard ports.": {
            "Data": "Zeek conn.log; Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for connections on common ports (e.g., 445, 139) where the protocol determined by Zeek does not match the expected protocol (e.g., non-SMB traffic on port 445). Correlate Zeek connections with Windows Event ID 4688 to identify processes initiating suspicious network connections. Analyze entropy of packet payloads or connection characteristics for further anomaly detection."
          },
          "Execution of known or suspicious internal proxy or port forwarding tools.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 on endpoints and servers for the creation of processes with names or command-line arguments matching known internal proxy or port forwarding tools (e.g., htran.exe, zxproxy.exe, nc.exe used for relaying). Correlate identified process executions with Zeek conn.log entries showing new or unusual internal-to-internal or internal-to-external connections originating from the host where the process was run. Use frequency analysis to establish baseline process execution patterns."
          },
          "An internal host acting as a central point for internal connections followed by outbound connections, or exhibiting a high fan-out of internal connections.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log to identify internal hosts that receive connections from multiple other internal hosts and subsequently initiate outbound connections, potentially reducing the total number of external connections from internal systems. Identify hosts with a high number of distinct internal destination IPs connected to within a time period (fan-out). Calculate network flow statistics (e.g., total bytes in/out, number of unique connections) for internal hosts and use correlation analysis or outlier detection to identify hosts with traffic patterns indicative of proxying activity."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]