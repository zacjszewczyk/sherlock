[
  {
    "Is the adversary inhibiting system recovery capabilities? (TA0040 - Impact)": {
      "Indicators": {
        "T1490 - Inhibit System Recovery": {
          "Execution of commands or processes targeting volume shadow copies, backup catalogs, or boot configuration related to recovery.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4657",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for creation of processes like \"vssadmin.exe\", \"wmic.exe\", \"wbadmin.exe\", \"bcdedit.exe\", \"REAgentC.exe\", \"diskshadow.exe\". Filter for command-line arguments associated with deletion or disabling (e.g., \"delete shadows\", \"delete catalog\", \"ignoreallfailures\", \"recoveryenabled no\", \"disable\"). Calculate frequency of execution for these binaries and flag rare occurrences or executions with specific arguments. Monitor Windows Event ID 4657 for changes to registry keys associated with system recovery features (e.g., keys under HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\VSS)."
          },
          "Connections and activity targeting management interfaces of network devices or hypervisors potentially used to delete or disable backups/snapshots.": {
            "Data": "Zeek conn.log; Zeek ssh.log; Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log, ssh.log, and http.log for connections originating from potentially compromised internal hosts to known management ports/protocols of network devices or hypervisors (e.g., SSH, HTTP/S to network device/hypervisor IPs). Calculate frequency and volume of connections from these sources to critical infrastructure management interfaces. Use correlation analysis between connections to these interfaces and subsequent disruptive events (e.g., system reboots, network outages) or deletion/modification events (if detailed logs are available from the target devices) to identify potential recovery inhibition activity."
          },
          "Anomalous file deletion events targeting volume shadow copy storage locations or backup files.": {
            "Data": "Windows Event ID 11; Windows Event ID 4663",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 11 (Kernel-General - file deletion) and 4663 (Object Access - specifically successful deletion attempts) for file deletion events targeting known locations of volume shadow copy files (e.g., paths within 'System Volume Information' directory) or critical backup files/directories. Filter events by process names observed executing recovery inhibition commands (vssadmin, diskshadow, etc.) and source user accounts. Use frequency analysis to identify sudden spikes in deletions or deletions of critical recovery-related files across multiple systems."
          },
          "Network connections from internal systems to external backup or cloud storage endpoints exhibiting deletion or modification activity.": {
            "Data": "Zeek conn.log; Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections from internal hosts to known IP ranges or domain names associated with external backup providers or cloud storage services. Analyze Zeek http.log for HTTP/S traffic to these endpoints. Look for high volume of requests or specific request methods/URLs indicative of deleting snapshots, backups, or disabling versioning (e.g., DELETE requests, API calls for removing versions/snapshots, disabling versioning). Use frequency analysis or statistical process control (SPC) charts on request counts or data volume per internal source or target endpoint to detect anomalies."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]