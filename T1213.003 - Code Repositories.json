[
  {
    "Is the adversary collecting sensitive data from code repositories? (TA0009 - Collection)": {
      "Indicators": {
        "T1213.003 - Code Repositories": {
          "Access to internal or third-party code repositories by privileged user accounts (e.g., Domain Admins).": {
            "Data": "Windows Event ID 4624",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor code repository access logs for successful logins and data access events by privileged accounts (e.g., matching usernames/groups from Windows Event ID 4624 of known privileged users). Compare this access to historical access patterns using descriptive statistics (e.g., frequency, timing)."
          },
          "Unusual volume or pattern of data transfer from code repositories by a single user or system.": {
            "Data": "Zeek conn.log; Zeek http.log",
            "Data Platform": "Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and http.log for connections to/from internal code repositories. Calculate the total bytes transferred per user/host over time. Identify users/hosts exhibiting unusually high data transfer volumes (e.g., using IQR or percentile analysis on byte counts) or sudden changes in activity patterns (time series analysis)."
          },
          "Execution of command-line Git client (`git.exe`) with suspicious arguments or data transfer sizes on endpoints or servers not typically used for development.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation events where `New Process Name` contains `git.exe` or other Git client executables. Filter for execution on systems not baselined as development machines using frequency analysis. Correlate with Zeek conn.log for connections to known code repository ports/hosts (e.g., SSH/HTTPS to git servers). Analyze command line arguments in 4688 (`CommandLine` field) for suspicious actions (e.g., cloning large repositories) and correlate with byte counts in Zeek logs."
          },
          "Access or modification of files commonly used for storing credentials (e.g., config files, `.git-credentials`, `.bash_history`) on systems that have recently interacted with code repositories, especially from non-development systems.": {
            "Data": "Windows Event ID 4663; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4663 for access attempts (read or write) to files with names or paths indicative of credentials (e.g., `*.config`, `.git-credentials`, `.bash_history`, `*.env`, `id_rsa`) on endpoints or servers. Correlate these events with recent Windows Event ID 4688 entries showing Git client execution or Zeek conn.log entries showing repository connections on the same host. Flag access to such files on non-development systems or by non-standard users using correlation analysis."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]