[
  {
    "Is the adversary causing impact via SMS pumping? (TA0040 - Impact)": {
      "Indicators": {
        "T1496.003 - SMS Pumping": {
          "High volume of outbound SMS message requests originating from web forms or messaging service APIs.": {
            "Data": "Zeek conn.log; Web application logs; Messaging Service API logs",
            "Data Platform": "Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor messaging service API logs and web application logs for outbound SMS requests. Calculate the rate of SMS requests over time per source IP, user session, or form submission point. Identify significant outliers or sudden increases in request volume using time series analysis or thresholding. Examine Zeek conn.log for unusual connection patterns to known messaging service API endpoints."
          },
          "Increased messaging service API calls or costs associated with SMS delivery, potentially targeting suspicious phone number sets.": {
            "Data": "Zeek conn.log; Messaging Service API logs; Billing/Cost data",
            "Data Platform": "Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect messaging service API logs. Extract destination phone numbers or associated identifiers. Analyze billing data for unexpected spikes in SMS costs. Use descriptive statistics (e.g., frequency distribution, mean, standard deviation) to identify phone numbers or number ranges receiving an unusually high volume of messages. Correlate high-cost periods with specific API call volumes or targeted forms."
          },
          "Anomalous volume or rate of outbound network connections from web servers or other hosts to known messaging service API endpoints.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek conn.log for connections originating from internal web/application servers or endpoints connecting to known IP addresses or domains of messaging service providers (e.g., Twilio API, AWS SNS API). Calculate the volume and rate of these connections over time per source host. Use time series analysis or correlation analysis against baseline traffic patterns to identify statistically significant deviations or sudden spikes."
          },
          "Suspicious process activity (e.g., execution of unusual scripts or tools) observed on hosts making a high volume of connections to messaging service API endpoints.": {
            "Data": "Windows Event ID 4688; Zeek conn.log; Windows Event ID 5156",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify internal hosts exhibiting high volume/rate connections to messaging service API endpoints using Zeek conn.log or Windows Event ID 5156. On these flagged hosts, analyze Windows Event ID 4688 (Process Creation) logs for processes executing immediately before or during the period of high outbound connections. Look for suspicious parent/child process relationships, unusual command line arguments, or execution of scripts/tools not part of the standard image. Correlate spikes in outbound connections with specific process executions."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]