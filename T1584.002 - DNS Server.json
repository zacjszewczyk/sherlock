[
  {
    "Is the adversary developing resources, such as compromised DNS servers, for use in operations? (TA0042 - Resource Development)": {
      "Indicators": {
        "T1584.002 - DNS Server": {
          "Internal systems resolving legitimate external domains to unexpected or suspicious IP addresses.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek dns.log for queries to critical external domains. Compare resolved IP addresses against expected values or whitelists. Identify deviations and perform correlation analysis between source IPs (internal clients), destination IPs (resolved external addresses), and query timestamps to find clusters of anomalous resolutions."
          },
          "Detection of DNS queries/responses characteristic of C2 traffic (e.g., unusually long hostnames, specific query patterns) resolving to suspicious IPs.": {
            "Data": "Zeek dns.log; Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek dns.log for anomalies in query structure (e.g., entropy calculation on query names for detecting DGA or unusually long subdomains). Filter DNS queries/responses to known suspicious IP addresses or patterns. Correlate suspicious DNS activity (Zeek dns.log) with follow-on connections (Zeek conn.log) to the resolved IPs using time series analysis to identify potential C2 sessions."
          },
          "Consistent resolution of legitimate, frequently accessed external domains to the same anomalous IP address across multiple internal clients.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek dns.log. Identify clusters of internal clients (source IPs) that are resolving the same set of common external domains (e.g., major websites, update servers) to the same unexpected or suspicious destination IP address. Use frequency analysis to identify destination IPs that are rarely seen as resolution results for these domains within the environment. Flag destination IPs that are known malicious or geographically inconsistent with the service being resolved."
          },
          "Detection of DNS queries for newly observed or suspicious subdomains of legitimate external domains resolving to unexpected or suspicious IP addresses.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek dns.log. Maintain a historical record of resolved subdomains for frequently queried external domains. Identify newly observed subdomains (those not seen in a defined historical period) or subdomains matching suspicious patterns (high entropy, unusual naming conventions). Use descriptive statistics (counts, timestamps) and frequency analysis on subdomain observations. Check the resolved IP addresses for these subdomains against threat intelligence feeds and correlate with other suspicious activity."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]