[
  {
    "Is the adversary establishing persistence using container services? (TA0003 - Persistence)": {
      "Indicators": {
        "T1543.005 - Container Service": {
          "Process creation events showing container run commands with persistence options or network traffic patterns consistent with DaemonSet deployment.": {
            "Data": "Windows Event ID 4688, Zeek conn.log, Zeek http.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) for command lines containing container run/create commands (`docker run`, `podman run`, etc.) along with persistence flags (`restart=always`) or volume mounts indicative of host access. Monitor Zeek logs (conn, http) for network traffic patterns associated with Kubernetes DaemonSet deployment API calls (e.g., PUT requests to /apis/apps/v1/namespaces/*/daemonsets). Use frequency analysis to identify rare or newly occurring command line arguments or network communication patterns."
          },
          "Process creation events indicating new container deployment or modifications to existing container configurations on hosts.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) for commands used to create, start, or modify containers (e.g., `docker create`, `docker start`, `docker update`, `podman create`, `podman start`). Establish a baseline of normal container management activity and flag deviations using time series analysis or statistical process control."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  },
  {
    "Is the adversary escalating privileges using container services? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1543.005 - Container Service": {
          "Process creation events showing privileged container commands or Zeek logs showing connections to unsecured container APIs.": {
            "Data": "Windows Event ID 4688, Zeek conn.log, Zeek http.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) for command lines executing container run/exec commands with privileged options (`--privileged`, `-v /:/host`), or executing commands inside privileged containers. Monitor Zeek logs (conn, http) for connections to known unsecured container API ports (e.g., Docker 2375) from unexpected sources. Use correlation analysis to link privileged command execution with network connections to internal resources."
          },
          "Unexpected process creation (Windows Event ID 4688) or network connections (Zeek conn.log) originating from processes known to be running inside containers.": {
            "Data": "Windows Event ID 4688, Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4688 (Process Creation) events originating from within a container process with processes or network connections that are not expected from that container's normal function. Use entropy analysis or frequency distribution on spawned processes/network destinations from container origins to detect anomalous host activity indicative of container escape."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]