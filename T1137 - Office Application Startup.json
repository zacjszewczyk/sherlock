[
  {
    "Is the adversary maintaining persistence using Office application startup mechanisms? (TA0003 - Persistence)": {
      "Indicators": {
        "T1137 - Office Application Startup": {
          "Suspicious child processes spawned by Microsoft Office applications (winword.exe, excel.exe, outlook.exe) with unusual parent-child relationships.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation events where ParentProcessName is an Office application (winword.exe, excel.exe, outlook.exe). Analyze the command line of child processes. Use correlation analysis to identify unusual parent-child process chains that deviate from normal application behavior or spawn known malicious binaries/scripts."
          },
          "Registry modifications or file creation/modification events related to Office persistence mechanisms (e.g., Outlook rules, forms, add-ins, templates).": {
            "Data": "Windows Event ID 4656; Windows Event ID 4657; Windows Event ID 4658; Windows Event ID 4663",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4656, 4657, 4658, 4663 for attempts or successful modifications to registry keys or files associated with Office persistence (e.g., Outlook rules keys, Office startup folders, template locations). Use frequency analysis or time series analysis to detect sudden spikes or patterns of modifications targeting these sensitive areas."
          },
          "Creation or modification of suspicious Outlook rules or custom forms that automatically execute code or forward mail.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for registry value modifications within Outlook-specific keys known to be used for rules (e.g., `Software\\Microsoft\\Office\\*\\Outlook\\Rules`) or forms. Correlate these modifications with the user account context. Flag changes made outside normal user activity hours or by unexpected processes. If possible, correlate with subsequent suspicious process creation (Event ID 4688) initiated by Outlook."
          },
          "Creation or modification of executable files, scripts, or templates in Office startup directories or add-in locations.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4663; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4656/4663 for file creation or modification events targeting known Office startup folders (e.g., `%APPDATA%\\Microsoft\\Word\\STARTUP`, `%APPDATA%\\Microsoft\\Excel\\XLSTART`, `%APPDATA%\\Microsoft\\Templates`) or add-in directories. Filter for suspicious file extensions (e.g., `.exe`, `.dll`, `.vbs`, `.ps1`, `.docm`, `.xlsm`, `.dotm`). Correlate these events with process creation (Event ID 4688) to identify the process responsible for the write operation. Use frequency analysis to identify rare or unusual write operations to these directories."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]