[
  {
    "Is the adversary exfiltrating sensitive data from the network? (TA0010 - Exfiltration)": {
      "Indicators": {
        "T1048.001 - Exfiltration Over Symmetric Encrypted Non-C2 Protocol": {
          "Network traffic showing internal hosts sending significantly more data than receiving, particularly to external destinations not associated with normal business operations.": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek ftp.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and protocol logs (http.log, ftp.log) to calculate byte ratios (bytes_sent / bytes_received) for internal-to-external connections. Identify sessions where this ratio exceeds a statistically determined threshold (e.g., using IQR or percentile analysis on byte ratios) or where bytes_sent is significantly larger than bytes_received. Filter for traffic to destinations not on an approved list."
          },
          "Presence of symmetrically encrypted data within non-standard network protocols (like HTTP or FTP) or network connections initiated by processes not typically involved in external communication.": {
            "Data": "Zeek conn.log; Zeek ssl.log; Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for connections on non-standard ports for encrypted traffic (e.g., encrypted traffic on HTTP port 80 or FTP ports 20/21). Analyze Zeek ssl.log for connections using older/deprecated symmetric ciphers if possible, or look for connections that fail standard TLS/SSL handshakes but still transfer data. Correlate network connections with process information from Windows Event ID 4688 to identify suspicious processes initiating outbound connections with large data transfers."
          },
          "Outbound network connections initiated by processes known not to typically perform external communication, especially those showing high data transfer volume.": {
            "Data": "Windows Event ID 4688; Windows Event ID 5156; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate process creation events (Windows Event ID 4688) with outbound network connection events (Windows Event ID 5156) and Zeek conn.log. Identify processes that are not on an approved list of applications allowed to make external connections or have no prior history of external connections. Analyze associated Zeek conn.log entries for large 'bytes_sent' values using descriptive statistics. Flag connections from unusual processes exhibiting high outbound data volume."
          },
          "External network connections over common unencrypted ports (like HTTP/80 or FTP/21) that exhibit characteristics of high volume data transfer inconsistent with standard protocol usage.": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek ftp.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log, http.log, and ftp.log for connections on ports typically associated with unencrypted protocols (e.g., 80, 21). For sessions with significant 'bytes_sent' from internal hosts, analyze the structure or timing of data flows. Look for patterns like a lack of standard HTTP/FTP commands followed by large data transfers. Use time series analysis on bytes sent/received over these ports to identify non-standard periodic or bursty transfers inconsistent with typical web browsing or file transfer activity."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]