{
  "Is the adversary bypassing defenses using XSL Script Processing? (TA0005 - Defense-Evasion)": {
    "Indicators": {
      "T1220 - XSL Script Processing": {
        "Execution of msxsl.exe with suspicious command-line arguments or loading external XSL/XML files.": {
          "Data": "Windows Event ID 4688, Zeek conn.log",
          "Data Platform": "Endpoints, Servers, Network devices",
          "NAI": "Insert site-specific NAI here",
          "Action": "Monitor Windows Event ID 4688 for creations of 'msxsl.exe' processes. Analyze the 'CommandLine' field for suspicious arguments, specifically file paths or URLs. Cross-reference destination IPs from Zeek conn.log for connections initiated by msxsl.exe processes to identify external XSL/XML retrieval or outbound C2 traffic."
        },
        "Execution of wmic.exe with the /FORMAT switch pointing to an XSL file (local or remote URL).": {
          "Data": "Windows Event ID 4688, Zeek conn.log",
          "Data Platform": "Endpoints, Servers, Network devices",
          "NAI": "Insert site-specific NAI here",
          "Action": "Monitor Windows Event ID 4688 for creations of 'wmic.exe' processes. Analyze the 'CommandLine' field for the presence of '/FORMAT:' followed by paths ending in '.xsl' or URLs. For URLs, cross-reference destination IPs from Zeek conn.log for connections initiated by wmic.exe processes to identify remote XSL file retrieval."
        }
      }
    }
  }
}