[
  {
    "Is the adversary bypassing defenses using XSL Script Processing? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1220 - XSL Script Processing": {
          "Execution of msxsl.exe with suspicious command-line arguments or loading external XSL/XML files.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for creations of 'msxsl.exe' processes. Analyze the 'CommandLine' field for suspicious arguments, specifically file paths or URLs. Cross-reference destination IPs from Zeek conn.log for connections initiated by msxsl.exe processes to identify external XSL/XML retrieval or outbound C2 traffic."
          },
          "Execution of wmic.exe with the /FORMAT switch pointing to an XSL file (local or remote URL).": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for creations of 'wmic.exe' processes. Analyze the 'CommandLine' field for the presence of '/FORMAT:' followed by paths ending in '.xsl' or URLs. For URLs, cross-reference destination IPs from Zeek conn.log for connections initiated by wmic.exe processes to identify remote XSL file retrieval."
          },
          "Appearance or execution of msxsl.exe on endpoints where it is not typically installed or executed based on baseline analysis.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Establish a baseline of endpoints where 'msxsl.exe' is typically executed using historical Windows Event ID 4688 data. Flag any execution of 'msxsl.exe' on endpoints outside this baseline using frequency analysis or simple set comparison. Investigate flagged executions and analyze the 'CommandLine' for context."
          },
          "Network connections initiated by msxsl.exe or wmic.exe processes, particularly to unusual destinations or immediately following suspicious command-line arguments.": {
            "Data": "Zeek conn.log; Windows Event ID 5156",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log and Windows Event ID 5156. Correlate network connections originating from 'msxsl.exe' or 'wmic.exe' processes. Identify connections to external IPs or unusual ports. Use frequency analysis of destination IPs and ports contacted by these processes compared to known legitimate uses. Investigate connections immediately following detections based on suspicious command lines (Existing Evidence 1 & 2)."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]