[
  {
    "Is the adversary maintaining persistence by modifying or adding LSASS drivers? (TA0003 - Persistence)": {
      "Indicators": {
        "T1547.008 - LSASS Driver": {
          "Repeated failed attempts to load LSA plug-ins or drivers.": {
            "Data": "Windows Event ID 3033; Windows Event ID 3063",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 3033 and 3063. Identify repeated occurrences of these events within a short timeframe from the same source or targeting the same host. Calculate the frequency of these events per host and alert on significant deviations from historical norms (e.g., using time series analysis or statistical process control)."
          },
          "Unusual activity or errors logged related to LSASS modules or operations.": {
            "Data": "Windows Event ID 3033; Windows Event ID 3063",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs related to LSASS (e.g., 3033, 3063, and search for others if available) for errors or warnings indicating module load issues or unexpected behavior. Analyze patterns in the event data; for example, use correlation analysis to link these events to other system changes or process activity (e.g., process creation Event ID 4688)."
          },
          "Suspicious or unauthorized dynamic-link libraries (DLLs) loaded by the LSASS process (lsass.exe).": {
            "Data": "Sysmon Event ID 7",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 7 where `Image` is `C:\\Windows\\System32\\lsass.exe`. Establish a baseline of normal DLLs loaded by lsass.exe. Flag or alert on any DLLs loaded that are not part of the established baseline or known Windows system components. Use frequency analysis or set-based comparisons to identify deviations from the norm."
          },
          "Unauthorized modification of registry keys or system files related to LSASS drivers.": {
            "Data": "Windows Event ID 4657; Sysmon Event ID 11; Sysmon Event ID 23",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for modifications to registry keys under `HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa` where `ObjectName` contains `*.dll` or driver names. Monitor Sysmon Event ID 11 (FileCreate) and Event ID 23 (FileDelete) in `C:\\Windows\\System32\\` or `C:\\Windows\\System32\\drivers\\` where the `Image` is an unusual process modifying files related to LSASS drivers. Correlate these events with process execution (Event ID 4688) and user activity."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary attempting to escalate privileges by modifying or adding LSASS drivers? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1547.008 - LSASS Driver": {
          "Failed attempts to load LSA plug-ins or drivers occurring alongside other privilege escalation behaviors.": {
            "Data": "Windows Event ID 3033; Windows Event ID 3063; Windows Event ID 4624; Windows Event ID 4625",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event IDs 3033 and 3063 with successful (4624) or failed (4625) authentication events and process creation (4688) events occurring around the same time on the same server. Analyze the timing and frequency of these correlated events during suspected privilege escalation windows."
          },
          "Unusual LSASS activity correlated with privilege escalation attempts.": {
            "Data": "Windows Event ID 3033; Windows Event ID 3063; Windows Event ID 4624; Windows Event ID 4625",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 3033 and 3063. Use descriptive statistics to baseline the occurrence of these events. Look for patterns or anomalies in the frequency or source of these events during periods of suspected privilege escalation. Correlate with authentication and process activity logs (Event ID 4624, 4625, 4688)."
          },
          "Suspicious or unauthorized dynamic-link libraries (DLLs) loaded by the LSASS process (lsass.exe).": {
            "Data": "Sysmon Event ID 7",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 7 where `Image` is `C:\\Windows\\System32\\lsass.exe`. Establish a baseline of normal DLLs loaded by lsass.exe. Flag or alert on any DLLs loaded that are not part of the established baseline or known Windows system components. Use frequency analysis or set-based comparisons to identify deviations from the norm."
          },
          "Unauthorized modification of registry keys or system files related to LSASS drivers.": {
            "Data": "Windows Event ID 4657; Sysmon Event ID 11; Sysmon Event ID 23",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for modifications to registry keys under `HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa` where `ObjectName` contains `*.dll` or driver names. Monitor Sysmon Event ID 11 (FileCreate) and Event ID 23 (FileDelete) in `C:\\Windows\\System32\\` or `C:\\Windows\\System32\\drivers\\` where the `Image` is an unusual process modifying files related to LSASS drivers. Correlate these events with process execution (Event ID 4688) and user activity."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]