[
  {
    "Has the adversary gained initial access using compromised domain accounts? (TA0001 - Initial Access)": {
      "Indicators": {
        "T1078.002 - Domain Accounts": {
          "Same domain account logged into multiple systems simultaneously.": {
            "Data": "Windows Event ID 4624",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4624 logs across all systems. Group events by Account Name. Identify instances where the same Account Name has successful logins (Logon Type 2 or 10) originating from different Source Workstation/IP Addresses within a short time frame (e.g., using time series analysis or correlation to detect overlapping sessions)."
          },
          "Domain account login from an unusual geographic location or outside normal business hours.": {
            "Data": "Windows Event ID 4624; Zeek conn.log",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4624 logs for logins. Extract Account Name, Source IP, and Timestamp. Geolocate Source IPs. Calculate frequency and distribution of login times per account. Flag logins from rare/never-seen source locations or occurring outside established business hours (e.g., using descriptive statistics, IQR for login times, or clustering anomalous locations)."
          },
          "Multiple domain accounts logged into the same host interactively or executing processes concurrently.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4624 (Logon Type 2, 10) and 4688 (Process Creation). For each host, identify instances where multiple distinct Account Names have overlapping login sessions or are identified as the SubjectAccountName for concurrently running processes. Use time series analysis to identify periods of high concurrent account activity on single hosts. Flag hosts exhibiting a statistically unusual number of concurrent accounts compared to their baseline using statistical methods like descriptive statistics or percentile analysis."
          },
          "Domain account activity (logon, process execution) that conflicts with user location or known authorized remote access status.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4624 (Logon Type 2, 10) and 4688 (SubjectAccountName) with external data sources like physical access badge swipes, VPN logs (from Zeek conn.log or dedicated VPN logs), or VDI session logs. Identify instances where a domain account is active on the network (interactive login or process execution) without corresponding physical presence or established authorized remote access. Use correlation analysis to link internal activity with external access logs. Flag accounts showing such conflicting activity."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary maintaining persistence using compromised domain accounts? (TA0003 - Persistence)": {
      "Indicators": {
        "T1078.002 - Domain Accounts": {
          "Creation of a new domain account with administrative privileges or unusual naming convention.": {
            "Data": "Windows Event ID 4720; Windows Event ID 4728; Windows Event ID 4732; Windows Event ID 4756; Windows Event ID 4764",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4720 (User Account Created), 4728 (A member was added to a security-enabled global group), 4732 (A member was added to a security-enabled local group), 4756 (A member was added to a security-enabled universal group), 4764 (A group's type was changed). Alert on the creation of new user accounts, especially those added to high-privilege groups. Use entropy measures on new account names to detect potentially algorithmically generated names or simple word lists."
          },
          "Consistent use of a domain account to log in or execute processes at unusual times or from unusual locations over an extended period.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify accounts exhibiting repeated successful logins (Event ID 4624) or process execution (Event ID 4688 SubjectAccountName) during unusual hours or from unusual source IPs over multiple days/weeks. Use time series analysis or correlation analysis to identify persistent patterns deviating from established user baselines. Flag accounts showing consistent deviations from their established baseline behavior using statistical anomaly detection."
          },
          "Multiple domain accounts logged into the same host interactively or executing processes concurrently.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4624 (Logon Type 2, 10) and 4688 (Process Creation). For each host, identify instances where multiple distinct Account Names have overlapping login sessions or are identified as the SubjectAccountName for concurrently running processes. Use time series analysis to identify periods of high concurrent account activity on single hosts. Flag hosts exhibiting a statistically unusual number of concurrent accounts compared to their baseline using statistical methods like descriptive statistics or percentile analysis."
          },
          "Domain account activity (logon, process execution) that conflicts with user location or known authorized remote access status.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4624 (Logon Type 2, 10) and 4688 (SubjectAccountName) with external data sources like physical access badge swipes, VPN logs (from Zeek conn.log or dedicated VPN logs), or VDI session logs. Identify instances where a domain account is active on the network (interactive login or process execution) without corresponding physical presence or established authorized remote access. Use correlation analysis to link internal activity with external access logs. Flag accounts showing such conflicting activity."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Has the adversary elevated privileges using compromised domain accounts? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1078.002 - Domain Accounts": {
          "A domain account accessing resources or performing actions outside its typical user/role scope.": {
            "Data": "Windows Event ID 4663; Windows Event ID 4624",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4663 (An attempt was made to access an object) for attempts to access sensitive objects/files. Filter these events by Account Name. Compare the resources accessed with the typical access patterns for that account's role/group using historical data (e.g., statistical comparison or anomaly detection based on access patterns)."
          },
          "Activity observed from highly privileged domain accounts (e.g., Domain Admins, Enterprise Admins) that is not part of scheduled maintenance or expected administrative tasks.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Windows Event ID 4624 (Logon Type 2, 10), 4688 (SubjectAccountName), and other relevant audit logs for activity by well-known high-privilege accounts (e.g., Administrator, service accounts, custom admin groups). Correlate activity timestamps with known maintenance windows or administrator schedules. Investigate activity outside these expected periods using time series analysis to identify unusual activity windows."
          },
          "Multiple domain accounts logged into the same host interactively or executing processes concurrently.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4624 (Logon Type 2, 10) and 4688 (Process Creation). For each host, identify instances where multiple distinct Account Names have overlapping login sessions or are identified as the SubjectAccountName for concurrently running processes. Use time series analysis to identify periods of high concurrent account activity on single hosts. Flag hosts exhibiting a statistically unusual number of concurrent accounts compared to their baseline using statistical methods like descriptive statistics or percentile analysis."
          },
          "Domain account activity (logon, process execution) that conflicts with user location or known authorized remote access status.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4624 (Logon Type 2, 10) and 4688 (SubjectAccountName) with external data sources like physical access badge swipes, VPN logs (from Zeek conn.log or dedicated VPN logs), or VDI session logs. Identify instances where a domain account is active on the network (interactive login or process execution) without corresponding physical presence or established authorized remote access. Use correlation analysis to link internal activity with external access logs. Flag accounts showing such conflicting activity."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary evading defenses using compromised domain accounts? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1078.002 - Domain Accounts": {
          "Domain account login or activity occurring while the user is not physically present at a corporate location and is not connected via authorized remote access (VPN, VDI, etc.).": {
            "Data": "Windows Event ID 4624; Zeek conn.log",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4624 (Logon Type 2, 10) and Zeek conn.log data for remote logins with physical access logs or authorized remote access logs (VPN, VDI). Flag logins where an account is active remotely or interactively on the network without a corresponding physical presence or authorized remote connection. Use correlation analysis to link activity across disparate log sources."
          },
          "Execution of unusual processes or use of unusual logon types under a standard user domain account.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4624",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 (Process Creation) and Event ID 4624 (Logon Type) events. Filter by Account Name. Identify instances where standard user accounts are used for unusual logon types (e.g., Service logon - Type 5) or execute processes/commands not typically associated with their role using correlation analysis or frequency analysis of process execution per account compared to baseline."
          },
          "Multiple domain accounts logged into the same host interactively or executing processes concurrently.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4624 (Logon Type 2, 10) and 4688 (Process Creation). For each host, identify instances where multiple distinct Account Names have overlapping login sessions or are identified as the SubjectAccountName for concurrently running processes. Use time series analysis to identify periods of high concurrent account activity on single hosts. Flag hosts exhibiting a statistically unusual number of concurrent accounts compared to their baseline using statistical methods like descriptive statistics or percentile analysis."
          },
          "Domain account activity (logon, process execution) that conflicts with user location or known authorized remote access status.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4624 (Logon Type 2, 10) and 4688 (SubjectAccountName) with external data sources like physical access badge swipes, VPN logs (from Zeek conn.log or dedicated VPN logs), or VDI session logs. Identify instances where a domain account is active on the network (interactive login or process execution) without corresponding physical presence or established authorized remote access. Use correlation analysis to link internal activity with external access logs. Flag accounts showing such conflicting activity."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]