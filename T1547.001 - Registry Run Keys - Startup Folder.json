[
  {
    "Is the adversary maintaining persistence using Registry Run Keys or Startup Folder items? (TA0003 - Persistence)": {
      "Indicators": {
        "T1547.001 - Registry Run Keys - Startup Folder": {
          "Creation or modification of suspicious entries in Windows Registry Run/RunOnce/RunOnceEx keys.": {
            "Data": "Windows Event ID 4657",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for changes to Registry keys HKLM\\*Run*, HKCU\\*Run*, HKLM\\*RunOnce*, HKCU\\*RunOnce*, HKLM\\*RunServices*, HKCU\\*RunServices*, HKLM\\*Policies\\Explorer\\Run*, HKCU\\*Policies\\Explorer\\Run*, HKCU\\*Windows\\load*. Compare new/modified entries against a baseline of known legitimate applications. Flag entries referencing unknown executables or unusual file paths. Calculate the frequency of modifications to these keys across the environment and investigate outliers."
          },
          "Creation or modification of suspicious files or shortcuts in user or all-user Startup Folders.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for processes launched with Parent Process originating from or paths matching common Startup Folders (C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup, C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp). Identify newly observed process names or paths relative to historical data using frequency analysis or entropy measures on process names/paths."
          }
        }
      }
    }
  },
  {
    "Is the adversary attempting to elevate privileges using Registry Run Keys or Startup Folder items? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1547.001 - Registry Run Keys - Startup Folder": {
          "Outlier processes executed at user login or system boot that originate from Registry Run keys or Startup Folder paths.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 logs specifically for processes starting shortly after user login or system boot. Correlate with known startup items (legitimate run keys, startup folders). Use descriptive statistics and outlier detection (e.g., box plots on process start times relative to user logon event) to identify processes starting unexpectedly or from suspicious locations. Evaluate correlation between process start and subsequent network connections (requires cross-referencing with Zeek conn.log)."
          },
          "Unauthorized modification of HKLM Registry Run keys or BootExecute key.": {
            "Data": "Windows Event ID 4657",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for SetValue operations specifically targeting HKEY_LOCAL_MACHINE Run* keys or HKLM\\System\\CurrentControlSet\\Control\\Session Manager\\BootExecute. Investigate modifications performed by non-system or non-trusted installer accounts. Use correlation analysis to link these registry changes to parent processes or preceding events like successful exploitation or credential use."
          }
        }
      }
    }
  }
]