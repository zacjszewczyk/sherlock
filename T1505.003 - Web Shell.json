[
  {
    "Is the adversary maintaining persistence via web shell? (TA0003 - Persistence)": {
      "Indicators": {
        "T1505.003 - Web Shell": {
          "Creation or modification of suspicious files in web server directories.": {
            "Data": "Windows Event ID 4663",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4663 logs on web servers for file creations or modifications within web root directories by unexpected user accounts or processes. Calculate baseline file modification rates for web directories and flag statistically significant deviations (e.g., using time series analysis or outlier detection)."
          },
          "Web server process (e.g., w3wp.exe, httpd) spawning unusual child processes or initiating outbound network connections to internal/external hosts.": {
            "Data": "Windows Event ID 4688, Zeek conn.log, Zeek http.log",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 logs on web servers for the web server process spawning unexpected child processes (e.g., cmd.exe, powershell.exe). Analyze Zeek conn.log and http.log for unusual outbound connections initiated by the web server, particularly to internal hosts or external non-web ports. Use correlation analysis to link suspicious process creation events with outbound network activity from the web server."
          }
        }
      }
    }
  }
]