[
  {
    "Is the adversary communicating with command and control infrastructure using encoded data? (TA0011 - Command and Control)": {
      "Indicators": {
        "T1132.001 - Standard Encoding": {
          "Unusual network traffic flow patterns, such as a client uploading significantly more data than it downloads from a server.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log to calculate byte ratios (sent/received) for network sessions. Use descriptive statistics or box-plots to identify sessions with unusually high or low byte ratios compared to typical traffic for the service/port. Flag sessions where client bytes sent vastly exceed server bytes received."
          },
          "Network sessions containing encoded data in unexpected protocols or with anomalous character sets/patterns.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Scan Zeek logs (conn.log, http.log, etc.) payload data for common encoding patterns (e.g., Base64 strings). Use entropy analysis on payload data within sessions to identify high-entropy data that might indicate encoding or encryption. Correlate findings with known C2 IP addresses or domains."
          }
        }
      }
    }
  }
]