[
  {
    "Is the adversary bypassing defenses using CMSTP? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1218.003 - CMSTP": {
          "Execution of CMSTP.exe with unusual command-line arguments or making external network connections.": {
            "Data": "Windows Event ID 4688, Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for CMSTP.exe execution. Identify instances where CMSTP.exe is the Parent Image or makes outgoing network connections (Zeek conn.log). Analyze command-line arguments (Event ID 4688) for unusual patterns or remote file references (.INF, .DLL, .SCT). Compare frequency of specific arguments over time using descriptive statistics to identify rare or new command lines."
          },
          "Process access or registry events related to CMSTP.exe involving auto-elevated COM interfaces (CMLUA.dll, CMSTPLUA, CMLUAUTIL).": {
            "Data": "Windows Event ID 10, Windows Event ID 12, Windows Event ID 13, Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 10, 12, 13 (Sysmon) for activity involving CMSTP.exe or its parent CMMGR32.exe, specifically looking for references to CMLUA.dll or COM interface GUIDs (3E5FC7F9-9A51-4367-9063-A120244FBEC7, 3E000D72-A845-4CD9-BD83-80C07C3B881F). Analyze correlating Windows Event ID 4688 events for CMSTP.exe launched with associated flags or child processes."
          }
        }
      }
    }
  }
]