[
  {
    "Is the adversary gathering information about the system time or time zone? (TA0007 - Discovery)": {
      "Indicators": {
        "T1124 - System Time Discovery": {
          "Execution of commands (e.g., net time, w32tm /tz, systemsetup) to query system time or time zone.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for command lines containing 'net time', 'w32tm /tz', 'systemsetup -gettimezone', or similar commands used for system time/timezone discovery. Correlate these events with user activity and look for executions by non-standard users or from unusual processes. Use frequency analysis to identify rare command executions."
          },
          "Unusual network traffic or commands related to time synchronization or time query on network devices.": {
            "Data": "Zeek conn.log; Zeek ntp.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek ntp.log and conn.log for connections to standard time synchronization ports (UDP 123 for NTP, etc.) originating from unexpected internal or external IPs. Look for spikes in NTP/time-sync traffic volume from specific hosts using time series analysis. Correlate with successful authentication/authorization events (if available) on network devices."
          },
          "Execution of system time/timezone query commands (e.g., net time, w32tm, systemsetup) from unusual processes or by atypical users.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations containing 'net time', 'w32tm', 'systemsetup', 'date', 'time', 'show clock' (if applicable to scripts). Analyze the ParentProcessName, ParentCommandLine, and SubjectUserName fields. Establish baselines for normal execution contexts (user, parent process) of these commands using frequency analysis and descriptive statistics. Flag executions by unusual users, from unexpected parent processes (e.g., temporary directories, non-standard services), or occurring at atypical times (using time series analysis/percentiles)."
          },
          "Network traffic patterns indicative of remote execution or enumeration of system time/timezone on network devices or servers (e.g., via remote administration tools).": {
            "Data": "Zeek conn.log; Windows Event ID 4624; Windows Event ID 4688",
            "Data Platform": "Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections to standard remote administration ports (e.g., SSH 22, RDP 3389, WinRM 5985/5986) from external or unusual internal source IPs. Correlate these network sessions with successful authentication logs (Windows Event ID 4624) and, if available, command execution logs (Windows Event ID 4688 or similar) on target servers to identify instances where time/timezone discovery commands were run remotely. Use correlation analysis to link network sessions to host events. Analyze frequency and volume of such remote queries per source/destination IP using descriptive statistics and identify outliers."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]