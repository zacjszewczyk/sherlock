[
  {
    "Is the adversary establishing persistence using accessibility features? (TA0003 - Persistence)": {
      "Indicators": {
        "T1546.008 - Accessibility Features": {
          "Unauthorized modification or replacement of accessibility feature binaries (sethc.exe, utilman.exe, etc.) with suspicious executables.": {
            "Data": "Windows Event ID 4663, Windows Event ID 4657",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4663 for write attempts on accessibility feature binaries (sethc.exe, utilman.exe, osk.exe, etc.) located in System32. Monitor Windows Event ID 4657 for changes to ImagePath values in accessibility feature registry keys. Flag any modifications not tied to patching or legitimate software installs by comparing against known good states or authorized change logs."
          },
          "Changes to Registry keys that control accessibility feature binary paths or pointers (e.g., under Image File Execution Options).": {
            "Data": "Windows Event ID 4657",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for changes to registry keys under HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility and HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options associated with accessibility features. Identify changes to keys like 'Configuration' or 'ApplicationName' or 'Debugger'. Use time series analysis to identify infrequent or anomalous write events to these specific keys."
          }
        }
      }
    }
  },
  {
    "Is the adversary attempting to escalate privileges using accessibility features? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1546.008 - Accessibility Features": {
          "Execution of accessibility feature binaries from unexpected locations or with unexpected parameters (potentially indicating replacement).": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation). Filter for processes where the Parent Process Name is an accessibility feature binary (sethc.exe, utilman.exe, osk.exe, etc.) and the New Process Name is a shell or command interpreter (cmd.exe, powershell.exe) or other unexpected process. Use frequency analysis to spot rare parent-child process combinations emanating from accessibility features."
          },
          "Modification of Image File Execution Options (IFEO) debugger registry keys for accessibility features.": {
            "Data": "Windows Event ID 4657",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for the creation or modification of 'Debugger' values under HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\ followed by the name of an accessibility feature binary (e.g., sethc.exe). Use correlation analysis to link these registry modifications to preceding or subsequent suspicious activity such as file modifications."
          }
        }
      }
    }
  }
]