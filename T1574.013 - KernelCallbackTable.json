[
  {
    "Is the adversary maintaining persistence by hijacking process execution flow? (TA0003 - Persistence)": {
      "Indicators": {
        "T1574.013 - KernelCallbackTable": {
          "Process access or modification attempts targeting the memory space of other GUI processes.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4690",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4656 and 4690 for handle requests/duplication targeting memory space (Object Type 'Process', Access Mask '0x1F0FFF', '0x1410', etc.) of common GUI processes (explorer.exe, outlook.exe, etc.) by unusual source processes. Use correlation analysis to identify sequences of handle requests/duplication that precede suspicious activity."
          },
          "Anomalous child processes, network connections, or file access originating from a GUI process that does not typically perform such actions.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for child processes spawned by common GUI processes. Monitor Zeek conn.log for unexpected outbound network connections originating from common GUI processes. Establish baseline process behavior for GUI applications using descriptive statistics (e.g., typical child processes, typical network endpoints/ports). Flag deviations from the baseline. Use entropy measures on child process names or destination IP/ports for a given GUI process to detect unusual variety."
          },
          "Sequence of process access/modification events targeting a GUI process followed by anomalous behavior (process creation, network connection) from that same GUI process.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4690; Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4656/4690 (Process Access/Handle Duplication) targeting known GUI processes (e.g., explorer.exe) with subsequent Windows Event ID 4688 (Process Creation) or Zeek conn.log entries originating from the target GUI process within a short time window (e.g., 30 seconds). Investigate sequences where the subsequent activity from the GUI process is unusual based on baselines (e.g., creating a command shell process, making an outbound connection to a rare IP/port). Use correlation analysis to link these events and time series analysis to detect recurring patterns."
          },
          "Process access/modification attempts targeting multiple different GUI processes within a short time frame.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4690",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor and group Windows Event ID 4656/4690 events targeting Object Type 'Process' with access masks indicative of memory read/write/query (e.g., 0x1F0FFF, 0x1410, 0x1000) within a rolling time window (e.g., 5 minutes). For each source process, count the number of unique target GUI processes being accessed. Flag source processes that access a statistically unusual number of unique target GUI processes in this timeframe (e.g., using IQR or standard deviation from a baseline of normal process behavior)."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary elevating privileges by hijacking process execution flow? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1574.013 - KernelCallbackTable": {
          "Process access or modification attempts targeting the memory space of other GUI processes.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4690",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4656 and 4690 for handle requests/duplication targeting memory space (Object Type 'Process', Access Mask '0x1F0FFF', '0x1410', etc.) of common GUI processes (explorer.exe, outlook.exe, etc.) by unusual source processes. Use correlation analysis to identify sequences of handle requests/duplication that precede suspicious activity."
          },
          "Anomalous child processes, network connections, or file access originating from a GUI process that does not typically perform such actions.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for child processes spawned by common GUI processes. Monitor Zeek conn.log for unexpected outbound network connections originating from common GUI processes. Establish baseline process behavior for GUI applications using descriptive statistics (e.g., typical child processes, typical network endpoints/ports). Flag deviations from the baseline. Use entropy measures on child process names or destination IP/ports for a given GUI process to detect unusual variety."
          },
          "Sequence of process access/modification events targeting a GUI process followed by anomalous behavior (process creation, network connection) from that same GUI process.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4690; Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4656/4690 (Process Access/Handle Duplication) targeting known GUI processes (e.g., explorer.exe) with subsequent Windows Event ID 4688 (Process Creation) or Zeek conn.log entries originating from the target GUI process within a short time window (e.g., 30 seconds). Investigate sequences where the subsequent activity from the GUI process is unusual based on baselines (e.g., creating a command shell process, making an outbound connection to a rare IP/port). Use correlation analysis to link these events and time series analysis to detect recurring patterns."
          },
          "Process access/modification attempts targeting multiple different GUI processes within a short time frame.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4690",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor and group Windows Event ID 4656/4690 events targeting Object Type 'Process' with access masks indicative of memory read/write/query (e.g., 0x1F0FFF, 0x1410, 0x1000) within a rolling time window (e.g., 5 minutes). For each source process, count the number of unique target GUI processes being accessed. Flag source processes that access a statistically unusual number of unique target GUI processes in this timeframe (e.g., using IQR or standard deviation from a baseline of normal process behavior)."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary evading defenses by hijacking process execution flow? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1574.013 - KernelCallbackTable": {
          "Process access or modification attempts targeting the memory space of other GUI processes.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4690",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4656 and 4690 for handle requests/duplication targeting memory space (Object Type 'Process', Access Mask '0x1F0FFF', '0x1410', etc.) of common GUI processes (explorer.exe, outlook.exe, etc.) by unusual source processes. Use correlation analysis to identify sequences of handle requests/duplication that precede suspicious activity."
          },
          "Anomalous child processes, network connections, or file access originating from a GUI process that does not typically perform such actions.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for child processes spawned by common GUI processes. Monitor Zeek conn.log for unexpected outbound network connections originating from common GUI processes. Establish baseline process behavior for GUI applications using descriptive statistics (e.g., typical child processes, typical network endpoints/ports). Flag deviations from the baseline. Use entropy measures on child process names or destination IP/ports for a given GUI process to detect unusual variety."
          },
          "Sequence of process access/modification events targeting a GUI process followed by anomalous behavior (process creation, network connection) from that same GUI process.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4690; Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4656/4690 (Process Access/Handle Duplication) targeting known GUI processes (e.g., explorer.exe) with subsequent Windows Event ID 4688 (Process Creation) or Zeek conn.log entries originating from the target GUI process within a short time window (e.g., 30 seconds). Investigate sequences where the subsequent activity from the GUI process is unusual based on baselines (e.g., creating a command shell process, making an outbound connection to a rare IP/port). Use correlation analysis to link these events and time series analysis to detect recurring patterns."
          },
          "Process access/modification attempts targeting multiple different GUI processes within a short time frame.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4690",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor and group Windows Event ID 4656/4690 events targeting Object Type 'Process' with access masks indicative of memory read/write/query (e.g., 0x1F0FFF, 0x1410, 0x1000) within a rolling time window (e.g., 5 minutes). For each source process, count the number of unique target GUI processes being accessed. Flag source processes that access a statistically unusual number of unique target GUI processes in this timeframe (e.g., using IQR or standard deviation from a baseline of normal process behavior)."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]