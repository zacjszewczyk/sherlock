[
  {
    "Is the adversary maintaining persistence by hijacking process execution flow? (TA0003 - Persistence)": {
      "Indicators": {
        "T1574.013 - KernelCallbackTable": {
          "Process access or modification attempts targeting the memory space of other GUI processes.": {
            "Data": "Windows Event ID 4656, Windows Event ID 4690",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4656 and 4690 for handle requests/duplication targeting memory space (Object Type 'Process', Access Mask '0x1F0FFF', '0x1410', etc.) of common GUI processes (explorer.exe, outlook.exe, etc.) by unusual source processes. Use correlation analysis to identify sequences of handle requests/duplication that precede suspicious activity."
          },
          "Anomalous child processes, network connections, or file access originating from a GUI process that does not typically perform such actions.": {
            "Data": "Windows Event ID 4688, Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for child processes spawned by common GUI processes. Monitor Zeek conn.log for unexpected outbound network connections originating from common GUI processes. Establish baseline process behavior for GUI applications using descriptive statistics (e.g., typical child processes, typical network endpoints/ports). Flag deviations from the baseline. Use entropy measures on child process names or destination IP/ports for a given GUI process to detect unusual variety."
          }
        }
      }
    }
  },
  {
    "Is the adversary elevating privileges by hijacking process execution flow? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1574.013 - KernelCallbackTable": {
          "Process access or modification attempts targeting the memory space of other GUI processes.": {
            "Data": "Windows Event ID 4656, Windows Event ID 4690",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4656 and 4690 for handle requests/duplication targeting memory space (Object Type 'Process', Access Mask '0x1F0FFF', '0x1410', etc.) of common GUI processes (explorer.exe, outlook.exe, etc.) by unusual source processes. Use correlation analysis to identify sequences of handle requests/duplication that precede suspicious activity."
          },
          "Anomalous child processes, network connections, or file access originating from a GUI process that does not typically perform such actions.": {
            "Data": "Windows Event ID 4688, Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for child processes spawned by common GUI processes. Monitor Zeek conn.log for unexpected outbound network connections originating from common GUI processes. Establish baseline process behavior for GUI applications using descriptive statistics (e.g., typical child processes, typical network endpoints/ports). Flag deviations from the baseline. Use entropy measures on child process names or destination IP/ports for a given GUI process to detect unusual variety."
          }
        }
      }
    }
  },
  {
    "Is the adversary evading defenses by hijacking process execution flow? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1574.013 - KernelCallbackTable": {
          "Process access or modification attempts targeting the memory space of other GUI processes.": {
            "Data": "Windows Event ID 4656, Windows Event ID 4690",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4656 and 4690 for handle requests/duplication targeting memory space (Object Type 'Process', Access Mask '0x1F0FFF', '0x1410', etc.) of common GUI processes (explorer.exe, outlook.exe, etc.) by unusual source processes. Use correlation analysis to identify sequences of handle requests/duplication that precede suspicious activity."
          },
          "Anomalous child processes, network connections, or file access originating from a GUI process that does not typically perform such actions.": {
            "Data": "Windows Event ID 4688, Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for child processes spawned by common GUI processes. Monitor Zeek conn.log for unexpected outbound network connections originating from common GUI processes. Establish baseline process behavior for GUI applications using descriptive statistics (e.g., typical child processes, typical network endpoints/ports). Flag deviations from the baseline. Use entropy measures on child process names or destination IP/ports for a given GUI process to detect unusual variety."
          }
        }
      }
    }
  }
]