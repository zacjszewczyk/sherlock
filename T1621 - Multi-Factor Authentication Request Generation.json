[
  {
    "Is the adversary attempting to bypass multi-factor authentication to gain access? (TA0006 - Credential-Access)": {
      "Indicators": {
        "T1621 - Multi-Factor Authentication Request Generation": {
          "Repeated MFA requests or failed logins from unusual geographic locations or IP addresses, potentially not matching the user's typical location or device location.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4625; Zeek conn.log; MFA/Authentication Service Logs",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze authentication logs (Event ID 4624/4625, MFA logs, Zeek conn.log for related traffic) for source IP addresses of login attempts and corresponding MFA requests. Compare source IP geolocation of login attempt vs. device receiving MFA request. Identify deviations. Identify login attempts or MFA requests from unusual geographic locations based on user history or overall organizational patterns (e.g., using descriptive statistics or percentiles)."
          },
          "High volume of MFA push notifications or SSPR requests associated with a single user account within a short time period, indicative of MFA fatigue attempts or SSPR abuse.": {
            "Data": "MFA/Authentication Service Logs; SSPR Logs; Windows Event ID 4625",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor MFA/Authentication service logs and SSPR logs for high-frequency events per user account within defined time windows. Implement a threshold based on statistical analysis (e.g., calculate the mean and standard deviation of MFA/SSPR request frequency per user over a baseline period and flag outliers exceeding a certain deviation or using IQR) to detect MFA fatigue or SSPR bombardment attempts."
          },
          "Mismatch between the source IP geolocation of a successful login attempt and the expected or previously observed location of the user's device receiving the MFA request.": {
            "Data": "Windows Event ID 4624; MFA/Authentication Service Logs; Zeek conn.log",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate successful login events (Event ID 4624) with corresponding MFA authentication logs for the same user and time. Geolocate the source IP of the login attempt (potentially using Zeek conn.log data if needed) and compare it to the reported/expected location of the device that approved or received the MFA request. Flag instances where the locations are geographically distant (e.g., different countries or states) or inconsistent with the user's established travel patterns using correlation analysis."
          },
          "Cluster of failed login attempts followed by a successful login and MFA approval from the same account and source IP within a limited time window, potentially indicating MFA fatigue.": {
            "Data": "Windows Event ID 4625; Windows Event ID 4624; MFA/Authentication Service Logs",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Aggregate Windows Event IDs 4625 (failed login) and 4624 (successful login) by user account and source IP. Identify clusters of failed attempts within a short period (e.g., 10 minutes) immediately preceding a successful login. Correlate these successful logins with MFA authentication logs to confirm the MFA approval timestamp. Use time series analysis on failed/successful login events per user/IP and look for patterns of high-frequency failed attempts ending in a successful login followed by prompt MFA approval. Calculate the average time-to-MFA-approval per user and flag significantly shorter approval times following a high-frequency failed attempt cluster."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]