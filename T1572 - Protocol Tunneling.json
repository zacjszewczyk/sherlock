[
  {
    "Is the adversary communicating with C2 infrastructure using protocol tunneling? (TA0011 - Command and Control)": {
      "Indicators": {
        "T1572 - Protocol Tunneling": {
          "External connections using ports/protocols commonly associated with tunneling (e.g., SSH on non-standard ports) or processes known for tunneling (e.g., Plink, OpenSSH client) establishing outbound connections.": {
            "Data": "Zeek conn.log, Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for outbound connections to common tunneling ports (e.g., 22) or ports not typically used for expected services. Monitor Windows Event ID 4688 for creation of processes like 'plink.exe' or 'ssh.exe' making external connections. Analyze connections to high-entropy destinations or those lacking typical service banners."
          },
          "Network traffic exhibiting uncommon data flows (e.g., high client-to-server data volume for protocols typically server-to-client) or anomalous packet contents.": {
            "Data": "Zeek conn.log, Zeek http.log, Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for sessions with asymmetric data flows (e.g., calculating client-to-server byte ratio and flagging significant deviations from historical averages or expected protocol behavior). Analyze Zeek http.log and dns.log for DoH traffic, correlating with known suspicious domains or IPs. Use entropy measures on packet contents to identify potentially encrypted or obfuscated traffic within expected plaintext protocols."
          }
        }
      }
    }
  }
]