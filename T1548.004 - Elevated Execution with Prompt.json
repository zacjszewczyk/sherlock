[
  {
    "Has the adversary successfully escalated privileges using elevated execution with prompt? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1548.004 - Elevated Execution with Prompt": {
          "Unusual network connections initiated by a macOS host following suspected privilege escalation event timeframe.": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify all connections originating from known macOS hosts within a specific timeframe after potential PE event. Analyze Zeek logs (conn, http, dns) for unusual destination IPs, ports, or domain names. Use correlation analysis to link these connections to potential C2 infrastructure or lateral movement attempts."
          },
          "Anomalous activity initiated from a macOS host targeting Windows systems, potentially facilitated by escalated privileges.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event Logs (4624, 4688) on target servers for successful logins or process creations originating from the suspected macOS host immediately following the potential PE timeframe. Identify anomalous process executions or object access patterns inconsistent with standard cross-platform management."
          },
          "Network traffic initiated by a macOS host involving downloading or uploading suspicious files immediately following a potential privilege escalation event timeframe.": {
            "Data": "Zeek http.log; Zeek ftp.log; Zeek file.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek http.log and ftp.log for file transfers (GET/PUT/POST requests, FTP commands) originating from known macOS hosts within a specific timeframe after potential PE event. Correlate with Zeek file.log if available to identify transferred file metadata. Analyze file names, sizes, and destinations for suspicious activity (e.g., downloads of executables, uploads to unusual external sites). Use time series analysis to detect sudden spikes in file transfer activity volume or frequency."
          },
          "Remote service connections (like RDP, SMB, WinRM) from the macOS host targeting internal Windows systems, especially using newly acquired or elevated credentials.": {
            "Data": "Zeek conn.log; Windows Event ID 4624",
            "Data Platform": "Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections from the macOS host to internal Windows systems on common remote service ports (e.g., TCP 445, 3389, 5985/5986) within the post-PE timeframe. Correlate with Windows Event ID 4624 on targeted servers, focusing on successful logons (Type 3, Type 10) originating from the macOS host's IP. Use correlation analysis to identify logins with elevated privileges or unusual logon types originating from the macOS host that match the timing of the PE event."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary evading defenses using elevated execution with prompt? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1548.004 - Elevated Execution with Prompt": {
          "Network traffic patterns originating from a macOS host that deviate significantly from baseline, potentially masked by elevated privileges.": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Establish baseline network traffic patterns (volume, destinations, protocols) for macOS hosts using historical Zeek data (conn, http, dns). Apply time series analysis to identify statistically significant deviations in traffic volume or entropy measures on protocols/destinations from a specific macOS host, indicative of defense evasion through altered communication."
          },
          "Creation or modification of persistence mechanisms on Windows systems initiated by a macOS host, potentially facilitated by elevated privileges to bypass standard controls.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4697",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event Logs (4624, 4697) for remote successful logins or service creation events originating from the suspected macOS host. Correlate these events with login times and account types, looking for service creation at unusual hours or by accounts not typically used for remote service management, potentially indicating persistence setup facilitated by elevated privileges and evasion."
          },
          "DNS requests from a macOS host for potentially malicious or rare domains immediately following a potential privilege escalation event timeframe.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek dns.log for queries originating from known macOS hosts within a specific timeframe after potential PE event. Compare queried domains against threat intelligence feeds for known malicious domains. Use frequency analysis or entropy measures on queried domain names to identify rare or unusual domains that deviate from the host's historical baseline or are not typically queried by macOS hosts."
          },
          "Execution of commands on Windows systems via remote services (like WinRM, SMB) originating from the macOS host that attempt to stop services, modify firewall rules, or delete logs.": {
            "Data": "Windows Event ID 4688; Windows Event ID 5156; Windows Event ID 7036; Windows Event ID 7045; Windows Event ID 1102",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event Logs on critical servers for specific event IDs (e.g., 4688, 5156, 7036, 7045, 1102) where the Source Network Address or Caller Workstation Name corresponds to the suspected macOS host IP. Analyze command lines (Event 4688) or event details for keywords related to stopping services (`net stop`, `sc stop`), modifying firewalls (`netsh advfirewall`), or clearing logs (`wevtutil cl`). Correlate with successful network logons from the macOS host (Event 4624) to link the evasion activity to potential access gained post-PE."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]