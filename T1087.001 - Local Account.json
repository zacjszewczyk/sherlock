[
  {
    "Is the adversary attempting to discover local accounts on a system? (TA0007 - Discovery)": {
      "Indicators": {
        "T1087.001 - Local Account": {
          "Execution of commands or scripts to list local user accounts (e.g., \"net user\", \"net localgroup\").": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations. Filter for `cmd.exe`, `powershell.exe`, `net.exe`, `net1.exe` with command-line arguments containing 'user', 'localgroup'. Identify execution on critical servers or multiple endpoints simultaneously."
          },
          "Rapid execution of multiple discovery commands/APIs, including attempts to list local accounts via non-standard methods (e.g., PowerShell, WMI calls).": {
            "Data": "Windows Event ID 4688, Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze sequences of Windows Event ID 4688 occurrences on endpoints/servers. Calculate the time difference between executions of known discovery commands (including account enumeration). Identify instances where multiple discovery commands are executed in rapid succession (e.g., using time series analysis or clustering based on execution timestamps and command types). Look for subsequent network connections via Zeek logs after enumeration activity."
          }
        }
      }
    }
  }
]