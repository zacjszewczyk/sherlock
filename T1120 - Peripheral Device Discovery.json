[
  {
    "Is the adversary attempting to discover peripheral devices? (TA0007 - Discovery)": {
      "Indicators": {
        "T1120 - Peripheral Device Discovery": {
          "Execution of commands or processes known to list peripheral devices (e.g., systeminfo, driverquery, specific PowerShell cmdlets).": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation events. Identify command-line arguments containing keywords related to device or hardware listing (e.g., 'driverquery', 'systeminfo', 'Get-PnpDevice', 'wmic logicaldisk'). Analyze frequency of these commands per host/user using descriptive statistics to identify outliers."
          },
          "Suspicious WMI or PowerShell activity querying device information, or anomalous API calls related to device enumeration.": {
            "Data": "Windows Event ID 4688, Zeek dce_rpc.log",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for PowerShell script blocks or command-line arguments related to WMI queries for device information (e.g., 'Get-WmiObject Win32_PnPEntity'). Monitor Zeek dce_rpc.log for DCOM/WMI activity originating from unusual processes or targeting multiple systems rapidly. Analyze the rate of WMI calls per host/user over time using time series analysis to detect spikes."
          }
        }
      }
    }
  }
]