[
  {
    "Has the adversary attempted to gain credentials using an Evil Twin attack? (TA0006 - Credential Access)": {
      "Indicators": {
        "Network traffic showing connection to untrusted SSID followed by HTTP/S access to login-like page URIs.": {
          "Network traffic showing connection to untrusted SSID followed by HTTP/S access to login-like page URIs.": {
            "Data": "Zeek http.log; Zeek ssl.log",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek http.log for connections originating from endpoints on public/unknown networks reaching URIs indicating login pages (e.g., containing 'login', 'signin', 'auth'). Analyze Zeek ssl.log for certificate issues on connections from these endpoints (invalid, self-signed). Identify patterns using descriptive statistics on requested URIs and domains."
          },
          "Network traffic showing credential submission attempts over insecure channels after connecting to untrusted SSID.": {
            "Data": "Zeek http.log; Zeek conn.log",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek http.log for POST requests to login-like pages from endpoints on public/unknown networks, especially if not using HTTPS. Analyze Zeek conn.log for connections using non-standard ports or protocols indicative of credential exfiltration or handshake attacks. Use entropy measures on destination IP/port pairs for connections originating from the untrusted network segment to detect anomalies."
          },
          "Probe requests for trusted SSIDs answered by unknown or untrusted BSSIDs/APs, followed by device connection.": {
            "Data": "Zeek wifi.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek wifi.log for probe requests from internal devices seeking trusted SSIDs. Correlate responses with unexpected or unknown BSSIDs/APs. Flag instances where devices subsequently connect to these anomalous BSSIDs. Use frequency analysis to identify rare BSSID/SSID combinations for specific devices or locations."
          },
          "Anomalous ARP or DNS activity immediately after connecting to an untrusted network, potentially redirecting traffic to fake login sites.": {
            "Data": "Zeek arp.log; Zeek dns.log; Zeek conn.log",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek arp.log for gratuitous or conflicting ARP responses from unexpected MAC addresses on the untrusted network segment. Monitor Zeek dns.log for unusual DNS query/response pairs (e.g., unexpected IP for common login sites) or high volume of queries to unusual domains. Correlate suspicious ARP/DNS events with Zeek conn.log showing connections to login-like pages. Use correlation analysis to link these events."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Has the adversary collected data using an Evil Twin attack? (TA0009 - Collection)": {
      "Indicators": {
        "Network traffic showing connection to untrusted SSID followed by unusual outbound data transfers or C2 communication.": {
          "Network traffic showing connection to untrusted SSID followed by unusual outbound data transfers or C2 communication.": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek dns.log; Zeek files.log",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for endpoints connected to public/unknown networks making connections to known C2 IPs/domains (cross-reference with threat intel). Analyze Zeek files.log for unexpected file transfers originating from these endpoints. Use correlation analysis between connection times/locations and data transfer events."
          },
          "Network traffic exhibiting unusual redirects, certificate warnings, or protocol manipulation after connecting to untrusted SSID.": {
            "Data": "Zeek http.log; Zeek ssl.log",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Examine Zeek http.log for multiple or unusual HTTP redirects (e.g., 302 responses) immediately following connection to a network. Analyze Zeek ssl.log for connections with invalid, self-signed, or unexpected certificates from endpoints on public/unknown networks. Use time series analysis to identify sudden increases in redirect or certificate warning events from specific endpoints."
          },
          "Anomalous traffic patterns indicative of internal reconnaissance or scanning originating from an endpoint on the untrusted network segment.": {
            "Data": "Zeek conn.log; Zeek dce_rpc.log; Zeek smb.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log, dce_rpc.log, and smb.log for connection attempts or enumeration activity targeting internal IP addresses or services (e.g., attempts to connect to internal shares, domain controllers) originating from endpoints connected to the untrusted network segment. Use frequency analysis or outlier detection to flag unusual volumes or types of internal connection attempts from these segments."
          },
          "Detection of suspicious SSL certificate usage or lack of expected encryption for sensitive network traffic after connecting to an untrusted SSID.": {
            "Data": "Zeek ssl.log; Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek ssl.log for connections originating from endpoints on untrusted/public networks that use untrusted CAs, self-signed certificates, or unexpected certificates for well-known internal or external sites. Examine Zeek http.log for sensitive information (e.g., credentials, session tokens) transmitted unencrypted over HTTP from these endpoints when HTTPS is expected. Correlate suspect certificate/protocol usage with visited sites or data transfer events."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]