[
  {
    "Has the adversary exploited software vulnerabilities to gain higher privileges? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1068 - Exploitation for Privilege Escalation": {
          "Unusual behavior or crashes in processes typically running at high privilege levels (e.g., system services, OS components).": {
            "Data": "Windows Event ID 4688; Windows Event ID 5038; System Logs",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations, especially from unexpected parent processes or with unusual command-line arguments, particularly for processes running with high integrity levels. Use descriptive statistics on process execution times or resource consumption (CPU/memory via performance logs if available, otherwise infer from crashes/hangs in system logs) for high-privilege processes to identify outliers indicative of instability or crashes. Analyze System Logs for application or system crashes involving high-privilege processes."
          },
          "Loading of known vulnerable kernel drivers or immediate follow-on activity typical of elevated privileges (e.g., attempts to access protected files, process injection).": {
            "Data": "Windows Event ID 6; Windows Event ID 4688; Windows Event ID 10; Windows Event ID 4656; Windows Event ID 4663",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 6 for loaded drivers. Compare loaded driver hashes and file paths against a list of known vulnerable drivers (BYOVD). Look for sequences of events immediately following driver loading, such as attempts to access sensitive files (Event ID 4656/4663) or suspicious process creation (Event ID 4688) or process injection attempts (Sysmon Event ID 10), using correlation analysis across different log sources."
          },
          "Suspicious files written to disk by high-privilege processes or processes exhibiting unusual behavior.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4656; Windows Event ID 4663; Windows Event ID 11",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate process creation events (Event ID 4688) or events from high-privilege processes with file creation events (Sysmon Event ID 11) or object access events (Event ID 4656/4663) writing to sensitive or unexpected locations (e.g., system directories, user temp directories from system processes). Analyze file size, entropy, or compare file hash against threat intelligence feeds for newly created executables or scripts in unusual locations. Identify processes with abnormal behavior (e.g., high resource usage, network connections to suspicious IPs from services that shouldn't connect externally based on baseline) and check for associated file writes."
          },
          "Execution of credential dumping tools or commands by a process that previously ran with lower privileges or exhibited suspicious activity.": {
            "Data": "Windows Event ID 4688; Windows Event ID 10; Windows Event ID 18",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation events (Windows Event ID 4688) for execution of known credential dumping tools (e.g., mimikatz, pypykatz) or command-line arguments indicative of built-in tools like `reg save` or `ntdsutil` targeting credential hives, especially if executed by processes that previously had lower privileges or showed suspicious activity (as identified by other evidence). Correlate these events with preceding events suggesting process access/injection (Sysmon Event ID 10/18) targeting lsass.exe or similar critical processes."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]