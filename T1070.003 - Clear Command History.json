[
  {
    "Is the adversary attempting to evade defenses by clearing command history? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1070.003 - Clear Command History": {
          "Absence of expected command history entries following user login or modification/deletion of user history files (~/.bash_history).": {
            "Data": "Windows Event ID 4688, Zeek exec.log",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) or Zeek exec.log for execution of commands associated with clearing or deleting history files (e.g., 'history -c', 'rm ~/.bash_history', 'del ConsoleHost_history.txt'). Correlate these events with successful remote login events (e.g., from Zeek conn.log for SSH) and analyze for unexpected sequences or timing."
          },
          "Suspicious modification or deletion of PowerShell history file (ConsoleHost_history.txt) or execution of the Clear-History command.": {
            "Data": "Windows Event ID 4104, Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4104 (PowerShell Script Block Logging) for the execution of 'Clear-History'. Monitor Windows Event ID 4688 (Process Creation) for command lines attempting to delete or modify files matching '*ConsoleHost_history.txt'. Use time series analysis or frequency analysis to detect anomalous occurrences of these events for specific users or systems."
          }
        }
      }
    }
  }
]