[
  {
    "Has the adversary utilized resources developed (e.g., serverless functions) against the network? (TA0042 - Resource Development)": {
      "Indicators": {
        "T1584.007 - Serverless": {
          "Network connections from internal hosts to known serverless/cloud function subdomains (e.g., *.lambda-url.us-east-1.on.aws, *.workers.dev) exhibiting C2-like traffic patterns.": {
            "Data": "Zeek conn.log; Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek logs (conn.log, dns.log) for outbound connections to cloud provider subdomains known to host serverless functions (*.lambda-url.us-east-1.on.aws, *.workers.dev, *.appspot.com etc.). Filter for unusual destinations or ports. Apply correlation analysis between internal hosts and suspicious external destinations. Use time series analysis or descriptive statistics on connection frequency, duration, and data volume to identify C2-like patterns (e.g., beaconing)."
          },
          "Unusual protocols, ports, or request patterns observed in traffic communicating with cloud provider subdomains commonly associated with serverless functions, potentially indicative of proxying or C2.": {
            "Data": "Zeek conn.log; Zeek weird.log; Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Examine Zeek logs (conn.log, weird.log, http.log) for traffic to cloud provider subdomains using non-standard ports or protocols, or exhibiting unusual request patterns (e.g., entropy analysis on HTTP request paths or headers, analysis of request method distributions). Use correlation analysis to link this traffic to specific internal hosts or processes."
          },
          "Outbound network connections to known serverless/cloud function subdomains originating from unusual or unauthorized internal processes.": {
            "Data": "Windows Event ID 5156; Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 5156 (Network Connection) for outbound connections to known serverless/cloud function subdomains (*.lambda-url.us-east-1.on.aws, *.workers.dev, *.appspot.com etc.). Correlate Event ID 5156 with Event ID 4688 (Process Creation) using Process ID and timestamps to identify the originating process on endpoints/servers. Establish a baseline of allowed processes that communicate with such services using frequency analysis. Flag connections originating from processes outside this baseline or from processes in unusual locations/parent processes."
          },
          "Sequence of network activity where connections to serverless cloud subdomains are immediately followed by suspicious internal network scanning, lateral movement attempts, or data staging/exfiltration activities from the same host.": {
            "Data": "Zeek conn.log; Zeek http.log; Windows Event ID 4624; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify outbound connections from internal hosts to known serverless/cloud function subdomains in Zeek conn.log. Analyze subsequent network (Zeek conn.log, http.log) and host activity (Windows Event ID 4624 - Logon Type 3 for network logon, 4688 - Process Creation) originating from the same internal host within a short time window (e.g., 60-120 seconds). Look for indicators like connections to internal systems on uncommon ports, failed login attempts, execution of suspicious commands (via 4688 command line), or large data transfers (via Zeek conn.log byte counts). Use correlation analysis to link the initial serverless connection to the follow-on suspicious activity."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]