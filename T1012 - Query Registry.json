[
  {
    "Is the adversary performing discovery using registry queries? (TA0007 - Discovery)": {
      "Indicators": {
        "T1012 - Query Registry": {
          "Execution of command-line utilities (Reg.exe) to query the Windows Registry.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation. Filter events where the process is 'reg.exe' or variants, and the command line contains 'query' or 'read' followed by specific registry paths (e.g., HKLM\\\\SOFTWARE). Identify unusual users, parent processes, or query patterns (e.g., queries for security software, RDP settings, installed applications). Use frequency analysis to spot rare registry queries."
          },
          "Execution of PowerShell or other scripting/management tools performing unusual registry queries or unusual processes interacting directly with the registry.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for execution of 'powershell.exe' or scripting engines. Analyze command lines for registry interactions (e.g., Get-ItemProperty, Get-ChildItem HKLM:\\\\...). Identify unusual scripts, users, or processes querying the registry. Perform correlation analysis between registry queries and subsequent suspicious activities (e.g., file writes, network connections) to establish a chain of behavior. Use time series analysis on frequency of such events per host to detect spikes."
          }
        }
      }
    }
  }
]