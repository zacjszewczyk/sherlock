[
  {
    "Is the adversary obfuscating command and control traffic? (TA0011 - Command and Control)": {
      "Indicators": {
        "T1001 - Data Obfuscation": {
          "Network traffic exhibiting unusual data flow characteristics (e.g., high client-to-server data volume asymmetry, unexpected communication from a process).": {
            "Data": "Zeek conn.log, Zeek stats.log, Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and stats.log to calculate the ratio of bytes_orig to bytes_resp (client-to-server vs server-to-client) per connection/host/process over time. Identify hosts/processes with statistically anomalous traffic asymmetry (e.g., using IQR or percentile analysis on the ratio). Correlate network activity with process creation (Windows Event ID 4688)."
          },
          "Network traffic showing data or patterns inconsistent with the expected behavior of the communication protocol being used on a given port.": {
            "Data": "Zeek conn.log, Zeek http.log, Zeek dns.log, Zeek ssl.log, Zeek weird.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek logs (conn.log, and protocol-specific logs like http.log, dns.log, ssl.log) for unusual or unexpected data patterns within legitimate protocols. Look for entries in Zeek weird.log. Identify traffic flows where the data or structure deviates significantly from the protocol standard (e.g., using correlation analysis between expected vs observed data patterns, or entropy measures on packet payload sections)."
          }
        }
      }
    }
  }
]