[
  {
    "Is the adversary communicating with external infrastructure using web protocols for command and control? (TA0011 - Command And Control)": {
      "Indicators": {
        "T1071.001 - Web Protocols": {
          "Network traffic exhibiting unusual client-server data flow ratios over web protocols (e.g., client sending more data than receiving).": {
            "Data": "Zeek http.log, Zeek conn.log, Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek http.log and conn.log to calculate byte ratios (orig_bytes / resp_bytes). Identify outlier sessions where the client sends significantly more data than it receives (e.g., using IQR, percentile analysis, or simple thresholds). Investigate processes associated with this traffic on endpoints by correlating session details with host logs like Windows Event ID 4688 for process creation and network connections."
          },
          "Network traffic to/from known malicious domains or non-standard web protocol syntax detected.": {
            "Data": "Zeek http.log, Zeek conn.log, Zeek ssl.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Cross-reference domains/IPs in Zeek http.log and conn.log against Threat Intelligence feeds for known malicious or suspicious indicators. Perform passive DNS lookups on suspicious destinations. Analyze HTTP request/response syntax and headers in Zeek http.log for deviations from standard protocol, unexpected user agents, or embedded data (e.g., using entropy measures on specific header fields or request bodies)."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]