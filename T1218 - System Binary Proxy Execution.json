[
  {
    "Is the adversary attempting to evade defenses using trusted system binaries? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1218 - System Binary Proxy Execution": {
          "Execution of known system binaries (e.g., rundll32.exe, regsvr32.exe, msiexec.exe) with suspicious command-line arguments.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation. Filter events where 'New Process Name' is a known proxy binary (e.g., rundll32.exe, regsvr32.exe, msiexec.exe, powershell.exe). Analyze 'Command Line' field for suspicious arguments or patterns (e.g., downloading files, executing DLLs from unusual paths). Compare current command lines to a baseline of normal usage patterns for these binaries (using descriptive statistics or correlation analysis) to flag outliers."
          },
          "File creation or download activity initiated by known system binaries used for proxy execution.": {
            "Data": "Windows Event ID 4656; Windows Event ID 4663; Windows Event ID 5145; Zeek file.log; Zeek http.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs (4656, 4663, 5145) for file creation/modification initiated by processes identified in other analysis steps related to T1218. Monitor Zeek file.log and http.log for network file transfers or downloads where the originating process is a known proxy binary. Identify files with unusual extensions or locations. Use frequency analysis to find rare file types or creation locations associated with these binaries and investigate based on correlation with other suspicious events."
          },
          "Network connections initiated by system binaries typically not expected to perform external network activity.": {
            "Data": "Windows Event ID 5156; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 5156 for outbound network connections where the initiating process is a known proxy binary (e.g., regsvr32.exe, rundll32.exe) that typically doesn't initiate external connections. Correlate these events with Zeek conn.log to confirm the connections and destination information. Create a baseline of expected network connections by these processes; flag connections that deviate from this baseline. Use frequency analysis or IQR to identify destination IPs or ports rarely contacted by these binaries."
          },
          "Unusual parent-child process relationships where a known system binary proxy is spawned by an unexpected parent process.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (which includes parent process ID and command line) for process creation events where 'New Process Name' is a known proxy binary (e.g., rundll32.exe, regsvr32.exe, msiexec.exe). Analyze the 'Parent Process Name' field. Establish a baseline of common parent processes for these binaries using frequency analysis. Flag instances where the parent process is unusual (e.g., a browser, email client, Office application, or uncommon script host). Investigate flagged process trees."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]