[
  {
    "Is the adversary bypassing security controls using PubPrn? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1216.001 - PubPrn": {
          "Execution of cscript.exe with pubprn.vbs containing suspicious command-line parameters (e.g., script: moniker, unusual network paths, or unexpected arguments).": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for `cscript.exe` executions with `pubprn.vbs` in the command line. Filter for parameters containing `script:` or URLs/network paths. Analyze frequency of `pubprn.vbs` execution across endpoints using descriptive statistics; investigate outliers with unusually high execution counts or execution on unexpected hosts."
          },
          "Network connection attempts originating from cscript.exe or wscript.exe to retrieve script files (.sct) or other code from external/unusual remote locations after executing pubprn.vbs.": {
            "Data": "Zeek conn.log; Zeek http.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and http.log for outbound connections originating from hosts where `cscript.exe` was recently executed with `pubprn.vbs`. Filter for connections to unusual remote IPs/domains, especially those attempting to download script files (.sct) or executable content. Use correlation analysis to link `cscript` execution events (from EID 4688) with subsequent outbound network connections."
          },
          "Execution of pubprn.vbs with the script: moniker pointing to non-LDAP protocols (e.g., HTTP, HTTPS, SMB) or suspicious domains/IPs, particularly on older Windows versions.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Windows Event ID 4688 for command lines containing `cscript.exe` and `pubprn.vbs` and the `script:` parameter. Extract the protocol and target location from the `script:` parameter. Identify instances where the protocol is not `LDAP://`. Correlate target domains/IPs with threat intelligence feeds. Use frequency analysis to identify rare or unique script locations being accessed."
          },
          "Anomalous child processes (e.g., PowerShell, cmd.exe, bitsadmin.exe, certutil.exe) spawned by cscript.exe shortly after an execution of pubprn.vbs that involved a script: moniker.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for parent-child process relationships. Identify `cscript.exe` processes that executed `pubprn.vbs` with a `script:` moniker. Analyze any child processes spawned by these `cscript.exe` instances. Flag common suspicious child processes (e.g., `powershell.exe`, `cmd.exe`, `bitsadmin.exe`, `certutil.exe`, `regsvr32.exe`) or processes with unusual command lines. Use correlation analysis to link the `pubprn.vbs` execution with subsequent child process activity within a short time window (e.g., 1-5 minutes)."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]