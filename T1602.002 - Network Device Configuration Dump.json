[
  {
    "Is the adversary collecting network configuration data? (TA0009 - Collection)": {
      "Indicators": {
        "T1602.002 - Network Device Configuration Dump": {
          "Detection of unusual Simple Network Management Protocol (SNMP) or Smart Install (SMI) traffic originating from suspicious hosts.": {
            "Data": "Zeek conn.log, Zeek dce_rpc.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections to standard SNMP ports (UDP 161/162) or SMI ports (TCP 4786) originating from non-management hosts or unusual external IPs. Analyze network device logs for SNMP queries or traps from unexpected sources. Use statistical analysis (e.g., time series) to identify spikes or deviations from baseline traffic patterns for these protocols."
          },
          "Network traffic containing strings or patterns commonly found in network device configurations being exfiltrated.": {
            "Data": "Zeek conn.log, Zeek file.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Inspect Zeek conn.log and potentially Zeek file.log for traffic involving network device configurations. Develop signatures or regular expressions to detect the presence of common configuration keywords (e.g., 'password', 'enable secret', 'community string', 'ip address', 'hostname') in exfiltrated data streams (e.g., via HTTP POSTs, DNS requests, or direct file transfers). Use correlation analysis to link detected content to specific network sessions or hosts."
          }
        }
      }
    }
  }
]