[
  {
    "Is the adversary maintaining persistence on web servers using malicious IIS components? (TA0003 - Persistence)": {
      "Indicators": {
        "T1505.004 - IIS Components": {
          "Creation or modification of suspicious DLL files or changes to the IIS configuration file (`applicationhost.config`) on web servers.": {
            "Data": "Windows Event ID 4688, Windows Event ID 4663",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4663 for access to `%windir%\\system32\\inetsrv\\config\\applicationhost.config` or directories containing ISAPI/IIS module DLLs by unexpected processes. Monitor Windows Event ID 4688 for processes writing to these locations. Use frequency analysis to identify rare process executions interacting with these sensitive IIS configuration/binary locations."
          },
          "Execution of `AppCmd.exe` with command-line arguments related to adding or modifying IIS modules/handlers.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for creations of `AppCmd.exe` processes. Analyze command-line arguments for keywords like 'add module', 'set config', 'add handler', or specific paths within `inetsrv`. Use time series analysis to detect execution spikes or executions outside of typical administrative maintenance windows."
          }
        }
      }
    }
  }
]