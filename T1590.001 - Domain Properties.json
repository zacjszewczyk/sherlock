[
  {
    "Is the adversary conducting reconnaissance to gather information about our domain properties? (TA0043 - Reconnaissance)": {
      "Indicators": {
        "T1590.001 - Domain Properties": {
          "Network traffic patterns consistent with active querying of domain properties (e.g., numerous DNS queries for subdomains, attempts to access cloud service APIs like GetUserRealm from external IPs).": {
            "Data": "Zeek dns.log, Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek dns.log for unusual volumes of DNS queries originating from external IPs targeting internal domains/subdomains. Analyze Zeek conn.log for connections from external IPs to known cloud provider API endpoints associated with user/domain enumeration. Identify external sources conducting rapid enumeration attempts using rate-limiting analysis or statistical profiling of query/connection frequency."
          },
          "Attempts to enumerate users or domains via cloud service APIs (e.g., Office 365 GetUserRealm/autodiscover) visible at network edge.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections originating from external IPs destined for known cloud provider authentication/API endpoints (e.g., login.microsoftonline.com, specific O365 API endpoints). Analyze connection frequency and volume from single source IPs to these endpoints. Use statistical analysis (e.g., frequency analysis, entropy) to identify sources exhibiting patterns consistent with automated enumeration attempts rather than normal user logins."
          }
        }
      }
    }
  }
]