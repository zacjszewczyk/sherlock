[
  {
    "Has the adversary gained initial access using valid accounts? (TA0001 - Initial Access)": {
      "Indicators": {
        "T1078 - Valid Accounts": {
          "Successful login to an internal resource using a valid account from an unusual geographic location or new/rare source IP address.": {
            "Data": "Windows Event ID 4624; Zeek conn.log",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect successful login events (WinEvent 4624) and network connections (Zeek conn.log) to internal resources. Extract source IP and destination resource. Geolocate source IPs. Identify logins from new or rare IPs/countries using frequency analysis or clustering of historical login locations. Investigate logins from flagged locations."
          },
          "Successful login to external services (VPN, OWA, RDP) using valid credentials from an untrusted source.": {
            "Data": "Windows Event ID 4624; Zeek conn.log",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor successful logins to externally facing services (WinEvent 4624 on access gateways, Zeek conn.log for sessions). Identify source IP addresses. Compare source IPs against threat intelligence feeds and lists of known proxies/TOR exit nodes. Calculate frequency distribution of source IPs per service and flag rare or new sources."
          },
          "Successful authentication attempt by a valid account to a system where the account has no prior login history (first-time access).": {
            "Data": "Windows Event ID 4624; Windows Event ID 4625",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Maintain historical login data per user and target system. For each new successful login (WinEvent 4624), check if the account has previously logged into that specific target system. Flag first-time successful logons to systems, especially critical assets or those outside the user's typical access pattern. Use frequency analysis on historical logon targets per user to establish baselines and identify new outliers."
          },
          "Successful authentication by a valid account that was recently created or had its privileges modified.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4720; Windows Event ID 4732; Windows Event ID 4728",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4624 for successful logins. Correlate successful logins with recent account creation (WinEvent 4720) or privilege modification events (WinEvent 4732, 4728) involving the same account. Flag successful logins by accounts that were created or had their privileges elevated within a short preceding timeframe (e.g., 24 hours). Investigate associated account and modification events."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary maintaining persistence using valid accounts? (TA0003 - Persistence)": {
      "Indicators": {
        "T1078 - Valid Accounts": {
          "Repeated successful logins by the same valid account at unusual times or from anomalous locations over an extended period.": {
            "Data": "Windows Event ID 4624; Zeek conn.log",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze successful login events (WinEvent 4624) over time per account. Extract login timestamps and source locations. Use time series analysis or statistical process control (SPC) charts to identify accounts exhibiting consistent login activity outside established normal patterns (e.g., persistent logins late at night, weekends, or from locations not historically used by the account)."
          },
          "Authentication or activity originating from an inactive or dormant account.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4648",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify accounts that have been disabled or marked inactive. Monitor WinEvent 4624 and 4648 logs for any authentication attempts or successful logins using these inactive accounts. Flag all activity associated with inactive accounts for immediate investigation."
          },
          "Scheduled tasks or services created or modified to run under a valid account's context that establish persistence.": {
            "Data": "Windows Event ID 4698; Windows Event ID 4702; Windows Event ID 7045; Windows Event ID 4624",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4698, 4702 (Scheduled Tasks) and 7045 (Service Install). Identify scheduled tasks or services created/modified/installed to run under the context of a valid user account. Correlate these events with WinEvent 4624 successful logons for the same account. Flag tasks/services created/modified outside of standard IT practices, especially those configured to run repeatedly or at unusual times, or those running under accounts without typical administrative duties for that system."
          },
          "Lateral movement activity initiated using a valid account that persists across multiple systems.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688; Zeek dce_rpc.log; Zeek rdp.log",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4624 (Logon Type 3) and 4688, and Zeek logs (dce_rpc.log for WMI/SMB, rdp.log for RDP). Identify successful remote authentications and process creations linked to lateral movement tools/techniques (PsExec, WMI, remote powershell via DCOM/WinRM) or RDP sessions originating from systems not typically used for administration by that account. Track accounts exhibiting repeated lateral movement across multiple systems using correlation analysis over time to identify persistent pivoting paths."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Has the adversary achieved privilege escalation using valid accounts? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1078 - Valid Accounts": {
          "Successful login or attempted login by a standard user account to a sensitive server or high-privilege system.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor successful login events (WinEvent 4624) on critical servers or systems designated as high-privilege targets. Filter for login attempts by accounts that do not belong to authorized administrative groups for that system. Correlate with process creation events (WinEvent 4688) initiated by these accounts on sensitive systems. Use correlation analysis to link unauthorized logins to subsequent suspicious activity."
          },
          "Multiple distinct valid accounts logged into the same system simultaneously or in quick succession.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4648",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze successful login events (WinEvent 4624) on endpoints and servers. Group events by target system and time window (e.g., 5 minutes). Count the number of distinct user accounts logging into the same system within the time window. Flag systems with an unusually high number of distinct simultaneous or near-simultaneous logins (e.g., using outlier detection based on historical login counts per system)."
          },
          "A valid account is added to a privileged security group.": {
            "Data": "Windows Event ID 4728; Windows Event ID 4732; Windows Event ID 4756",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4728, 4732, and 4756. Specifically filter for additions to known privileged groups (e.g., 'Domain Admins', 'Administrators'). Flag any event where a valid user account is added to one of these groups, especially if the account or the user performing the addition is not on an authorized list or the action occurs outside of approved change windows. Correlate these events with subsequent successful logins or activity by the newly privileged account."
          },
          "A valid account successfully authenticates to a system using credentials potentially obtained from another compromised system.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4648; Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4624 (Logon Type 10 or 3) and 4648. Identify successful logons or attempts using explicit credentials (4648) by accounts that are different from the account primarily logged into the source machine. Correlate these credential use events with process creation events (4688) indicating potential credential dumping tools or techniques used on the source machine prior to the new authentication. Analyze the destination system and account privileges in the 4624/4648 logs to determine if privilege escalation occurred."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary evading defenses using valid accounts? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1078 - Valid Accounts": {
          "A single valid account is authenticated on multiple distinct systems concurrently.": {
            "Data": "Windows Event ID 4624; Zeek conn.log",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor successful login events (WinEvent 4624) across the environment. For each account, track the systems being logged into. Identify accounts authenticated on multiple distinct systems within a short period. Flag accounts with concurrent sessions on an unusually high number of systems, potentially using a statistical threshold based on average concurrent sessions per user type."
          },
          "Account activity or login session detected for a user who is not physically present and does not have an active authorized remote access session.": {
            "Data": "Windows Event ID 4624; Zeek conn.log",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate successful login events (WinEvent 4624) and network activity (Zeek conn.log) for specific users. Identify successful internal logins or activity for accounts when no corresponding authorized external access or physical presence is expected. Flag such activity as anomalous."
          },
          "Network traffic or process execution by a valid account that indicates command and control (C2) activity disguised as legitimate traffic.": {
            "Data": "Zeek conn.log; Zeek dce_rpc.log; Zeek rdp.log; Windows Event ID 4624; Windows Event ID 4688",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek logs (conn, dce_rpc, rdp) and Windows Event IDs 4624/4688 for traffic patterns and process executions associated with valid accounts that resemble C2 behavior (e.g., beaconing, unusual destinations, encrypted traffic over common ports like 445, 3389, 5985). Use behavioral analysis to identify deviations from baseline network traffic and process execution for specific accounts. Apply correlation analysis to link suspicious network connections by a valid account to specific process executions or logon events on source/destination systems."
          },
          "File modifications or data transfer activity performed by a valid account that is inconsistent with its typical role or behavior.": {
            "Data": "Windows Event ID 4663; Zeek fileinfo.log; Zeek http.log; Zeek ftp.log; Zeek smtp.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor file access events (WinEvent 4663) for sensitive files/directories and file transfer logs (Zeek fileinfo, http, ftp, smtp) by valid accounts. Establish behavioral baselines for file access and network data transfer volumes for different user roles/accounts using descriptive statistics (mean, median, standard deviation, IQR). Flag accounts performing file operations (access, modification, deletion) or transferring data volumes significantly outside their normal pattern, or accessing sensitive data they wouldn't typically interact with. Use outlier detection on data transfer volumes per account per time period."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]