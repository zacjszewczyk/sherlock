[
  {
    "Is the adversary building malicious container images on hosts to evade defenses? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1612 - Build Image on Host": {
          "Unexpected or unauthorized container image build requests observed on hosts.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations related to container image builds (e.g., 'docker build'). Identify build processes originating from unexpected hosts or users. Use frequency analysis or statistical process control (SPC) to identify deviations from baseline build activity patterns."
          },
          "Network connections to anomalous or previously unseen external IPs during the image build process.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Zeek conn.log entries from hosts suspected of building images with known network activity baselines. Use entropy or correlation analysis to identify network connections during the build process to destination IPs that have low frequency of prior communication or are uncorrelated with typical host activity. Cross-reference identified IPs with threat intelligence feeds."
          },
          "Execution of a container image build process with parameters indicating the use of a specific Dockerfile or context path inconsistent with standard builds.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations related to container builds ('docker build'). Analyze command line arguments (e.g., `-f <Dockerfile path>`, context path `.`). Flag builds using non-standard Dockerfile paths or context paths that deviate from established build procedures. Maintain a baseline of standard build commands/paths and use frequency analysis to identify rare occurrences."
          },
          "Network connections to external, potentially non-registry IP addresses occurring concurrently with a container image build process on the host.": {
            "Data": "Zeek conn.log; Windows Event ID 4688",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4688 (docker build) on a host with Zeek conn.log entries from the same host within the timeframe of the build. Filter network connections to exclude known container registries (e.g., docker.io, internal registries). Flag connections to external IPs that are not known registries, especially if they transfer significant data volume during the build process. Use time series correlation to link build process start/end times with concurrent network activity to unusual destinations."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]