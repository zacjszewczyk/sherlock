
[
  {
    "Is the adversary attempting to impact system availability or recovery using shutdown/reboot? (TA0040 - Impact)": {
      "Indicators": {
        "T1529 - System Shutdown-Reboot": {
          "Execution of processes with file hashes or specific command-line arguments known to be associated with malware (e.g., ransomware, wipers) that performs a system shutdown or reboot.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Continuously monitor process creation events (Windows Event ID 4688) and analyze process file hashes and full command-line arguments. Correlate file hashes against a CTI feed of known malicious binaries. Use regular expression matching to detect command-line patterns specifically used by known malware families to issue shutdown commands (e.g., `shutdown.exe /s /f /t 0 /c 'Your files are encrypted'`). Immediately alert on any confirmed matches."
          },
          "Execution of shutdown or reboot commands via scripting interpreters or with unusual parameters indicative of malicious intent.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation events (Windows Event ID 4688) for `shutdown.exe`, `Restart-Computer`, or equivalent commands. Specifically, filter for events where the parent process is a scripting engine like `powershell.exe` or `cmd.exe`. Analyze command-line parameters for unusual combinations, such as extremely short timeouts (e.g., `/t 0`), forced closure of applications (`/f`), or the inclusion of a non-standard comment (`/c '...'`). Flag executions that deviate from documented administrative practices or baseline behavior."
          },
          "Use of remote administration tools from an endpoint or server to issue shutdown commands targeting network devices or other critical systems.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 on servers and endpoints for process creations associated with remote administration tools (e.g., `ssh`, `plink.exe`, `psexec.exe`, `wmic.exe`) or commands (`net rpc shutdown`). Correlate this activity with Zeek conn.log to confirm the target IP belongs to critical infrastructure. Flag executions originating from non-administrative workstations or those targeting a large number of devices in a short time frame."
          },
          "A remote login event immediately followed by a shutdown or reboot command on the same system.": {
            "Data": "Windows Event ID 4624; Windows Event ID 4688; Windows Event ID 1074",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate successful remote logons (Windows Event ID 4624, Logon Type 3 or 10) on a host with subsequent process creation events for shutdown/reboot commands (Windows Event ID 4688) or system shutdown initiation events (Windows Event ID 1074) on the same host. Define a short time window for correlation (e.g., 1-5 minutes). Use correlation analysis to automatically link these events and alert on any instance where a remote session immediately precedes a system shutdown, especially if the source of the remote login is untrusted or unusual."
          },
          "A widespread and synchronized issuance of shutdown or reboot commands across numerous systems, inconsistent with planned maintenance schedules.": {
            "Data": "Windows Event ID 1074; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Aggregate and centralize all system shutdown events (Windows Event ID 1074, 4688 with shutdown commands) across the environment. Establish a baseline of normal reboot activity for different system groups (e.g., workstations, web servers). Use time series analysis and statistical outlier detection (e.g., Z-score, IQR on event counts per hour) to identify anomalous spikes in the volume of shutdown events. Correlate event timestamps with change management records to filter out legitimate activity. Alert when a statistically significant number of systems are shut down simultaneously or in rapid succession outside of a planned maintenance window."
          },
          "A sudden, widespread cessation of network traffic from a large number of internal hosts or critical subnets, indicating mass outages.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Continuously monitor network traffic volume (e.g., total bytes, active connections) using Zeek conn.log, aggregated by subnet or critical asset groups. Establish a baseline of normal traffic patterns for different times of day and days of the week. Use time series analysis (e.g., ARIMA or Exponential Smoothing with confidence bands) to detect a sudden, statistically significant drop in traffic across multiple segments simultaneously. Investigate any such disruption as a potential indicator of a coordinated shutdown attack."
          }
        }
      },
      "version": "2.0",
      "last_updated": "2025-05-11"
    }
  }
]
