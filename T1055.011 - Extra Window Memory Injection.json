[
  {
    "Has the adversary leveraged Extra Window Memory Injection for privilege escalation? (TA0004 - Privilege Escalation)": {
      "Indicators": {
        "T1055.011 - Extra Window Memory Injection": {
          "Execution of code within the memory space of a high-privilege process (e.g., explorer.exe, svchost.exe) after unusual window memory modification API calls.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) for high-privilege processes (e.g., explorer.exe, svchost.exe). Look for unusual parent processes or command-line arguments initiating these processes. Identify instances where child processes of these high-privilege processes exhibit anomalous behavior (e.g., unexpected network connections captured in Zeek conn.log). Use correlation analysis to link source processes (if visible via Event 4688 parent process ID) with high-privilege target processes."
          },
          "Sequence of API calls related to Extra Window Memory (SetWindowLong, GetWindowLong) followed by execution in a process with higher privileges than the originating process.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Review Windows Event ID 4688 logs for process creation events involving processes known to register window classes. While direct API call detection is limited with these logs, identify sequences where a less privileged process creates or interacts with a process that subsequently gains higher privileges or performs actions indicative of privilege escalation. Analyze frequency distribution of processes targeted by potential injection activities."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  },
  {
    "Is the adversary using Extra Window Memory Injection to evade defenses? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1055.011 - Extra Window Memory Injection": {
          "Modification of Extra Window Memory (via SetWindowLong) and subsequent code execution within the memory of a common user-facing process (e.g., browser, office application) without typical process injection indicators.": {
            "Data": "Windows Event ID 4688, Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for processes like browsers or office applications exhibiting unusual child processes, command lines, or network connections (via Zeek conn.log) that deviate significantly from baseline behavior. Establish baseline network connection patterns for common processes using descriptive statistics and time series analysis, flagging outliers that connect to unusual destinations."
          },
          "Observed sequence of API calls including SetWindowLong and SendNotifyMessage targeting a process, deviating from its normal behavior.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze sequences of process creation (Event ID 4688). While direct API calls are not logged, look for instances where a process is created, immediately followed by another process exhibiting suspicious behavior or initiating unusual network connections (Zeek conn.log), potentially indicative of code execution within the second process. Use sequence analysis (basic correlation) to identify common but suspicious patterns."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]