[
  {
    "Is the adversary attempting to discover information about the system? (TA0007 - Discovery)": {
      "Indicators": {
        "T1614.001 - System Language Discovery": {
          "Suspicious process accessing the system language registry key.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4663",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4657 (Value Set) and 4663 (Object Access) on the registry key 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Language'. Filter by object name and identify suspicious process paths. Use statistical methods (e.g., frequency analysis, outliers) to find anomalous access patterns by time or process frequency."
          },
          "Execution of commands associated with system language discovery (e.g., 'locale' on Linux/macOS).": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for processes with command line arguments containing 'locale'. Identify source process paths and parent processes. Correlate command execution with user context and identify deviations from normal user behavior using descriptive statistics (e.g., baseline normal command execution per user/system)."
          },
          "Execution of Windows command-line utilities or PowerShell commands to retrieve system language or locale information.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for command line arguments containing keywords indicative of Windows language/locale checks (e.g., 'systeminfo', 'findstr locale', 'Get-Culture', 'Get-UICulture'). Identify the process executing the command and its parent. Baseline execution frequency and context (user, parent process, execution path) and flag anomalies using descriptive statistics and time series analysis."
          },
          "Suspicious process accessing multiple system configuration settings, including those related to language or keyboard layout.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4657; Windows Event ID 4663",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Windows Event ID 4688 (process execution) with Windows Event IDs 4657/4663 (registry access) for a given process or process tree. Look for processes executing commands or accessing registry keys associated with various system discovery techniques (including language via HKLM\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Language or HKLM\\SYSTEM\\CurrentControlSet\\Control\\Keyboard Layouts, hostname, user info, etc.) within a short timeframe. Flag processes running from unusual locations or without signed executables that exhibit this combined behavior using correlation analysis."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]