[
  {
    "Is the adversary communicating with command and control infrastructure using non-standard ports? (TA0011 - Command and Control)": {
      "Indicators": {
        "T1571 - Non-Standard Port": {
          "Network traffic showing protocol/port mismatches (e.g., HTTPS over port 8088, RDP over non-standard port).": {
            "Data": "Zeek conn.log, Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and protocol-specific logs (e.g., http.log) to identify connections where the detected protocol does not match the standard port. Use entropy analysis or correlation analysis on packet payloads or header information to flag potential protocol mismatches on unexpected ports."
          },
          "Unusual network data flow patterns (e.g., significant data upload from client to server, unexpected network connections from processes).": {
            "Data": "Zeek conn.log, Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log to identify sessions with highly asymmetric byte counts (e.g., client sending significantly more data than receiving). Identify the process associated with the connection by correlating connection times with process creation logs (Windows Event ID 4688). Flag processes initiating network connections over non-standard ports or with unusual data flows, especially if the process is unexpected or rare (e.g., using frequency analysis or outlier detection)."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]