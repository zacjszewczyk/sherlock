[
  {
    "Is the adversary using IDE tunneling for command and control? (TA0011 - Command and Control)": {
      "Indicators": {
        "T1219.001 - IDE Tunneling": {
          "Execution of IDE tunneling CLI tools or related processes/extensions with unusual parameters or from unexpected locations.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation events (Windows Event ID 4688) for execution of known IDE tunneling CLIs (e.g., 'code tunnel') or related executables. Look for executions with suspicious command-line arguments or unusual parent processes. Use frequency analysis on process names/paths to identify outliers."
          },
          "Outbound network connections from hosts to unusual external IP addresses or domains on non-standard ports, exhibiting characteristics of IDE tunneling traffic.": {
            "Data": "Zeek conn.log, Zeek ssl.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for outbound connections from internal hosts to external destinations on unusual ports (beyond standard web, mail, etc.). Correlate with Zeek ssl.log to identify encrypted connections. Investigate traffic patterns (e.g., connection duration, data volume) for anomalies compared to baseline network traffic. Use correlation analysis to link suspicious network traffic with host process execution."
          }
        }
      }
    }
  }
]