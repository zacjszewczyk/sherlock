[
  {
    "Is the adversary moving laterally within the network using DCOM? (TA0008 - Lateral Movement)": {
      "Indicators": {
        "T1021.003 - Distributed Component Object Model": {
          "Execution of unexpected processes or loading of unusual DLLs initiated via DCOM (e.g., by explr.exe, mmc.exe, or Office applications) particularly by a user different from the current logon session.": {
            "Data": "Windows Event ID 4688, Windows Event ID 4624, Windows Event ID 4625",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations associated with DCOM hosts like explr.exe, mmc.exe, or Office applications, originating from remote DCOM/RPC calls. Identify processes or loaded modules/DLLs not typically associated with that application or parent process. Compare the user context of the spawned process with the logged-on user using Event ID 4624/4625 on the target machine. Use frequency analysis to identify rare or anomalous process/DLL combinations or user discrepancies."
          },
          "Spikes or unusual patterns in DCOM/RPC traffic (port 135) between endpoints, particularly originating from or targeting potential victim machines or suspicious accounts.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for traffic on port 135 with the RPC service signature. Use time series analysis to detect sudden increases or unusual patterns in traffic volume between internal hosts. Identify source/destination pairs with high DCOM traffic volume or traffic patterns that deviate significantly from the historical baseline using statistical methods like z-score analysis or deviation from median."
          }
        }
      }
    }
  }
]