[
  {
    "Is the adversary attempting to evade defenses using safe mode boot? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1562.009 - Safe Mode Boot": {
          "Execution of bcdedit.exe or bootcfg.exe to modify boot settings.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations of 'bcdedit.exe' or 'bootcfg.exe'. Analyze command-line arguments for modifications related to 'safeboot' or boot options. Use frequency analysis to identify rare or unusual execution contexts for these binaries."
          },
          "Modification or addition of specific Registry keys related to safe mode startup (e.g., SafeBoot\\Minimal, Run with '*' prefix).": {
            "Data": "Windows Event ID 4657",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for modifications to Registry keys under 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal' or under 'HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\' where the value name starts with a '*'. Correlate with process creation events (4688) to identify the process responsible. Use correlation analysis to link suspicious registry modifications with other potentially malicious activity."
          },
          "Modification of Registry keys related to COM objects registered under SafeBoot keys.": {
            "Data": "Windows Event ID 4657",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for modifications to Registry keys under 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal' or 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Network' that relate to COM objects (e.g., adding new Class IDs or modifying existing ones within these branches). Investigate modifications that deviate from standard system configurations using baselining and frequency analysis."
          },
          "Network connections or process executions from unexpected processes running in a safe mode environment.": {
            "Data": "Windows Event ID 4688; Windows Event ID 5156; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 and 5156 on hosts where safe mode boot configuration changes have been detected via other evidence. Baseline expected process executions and network connections during a standard boot cycle. Flag processes or connections observed after a suspected safe mode boot that are not part of the minimal safe mode set or explicitly added persistence mechanisms, or that involve suspicious external destinations (using Zeek conn.log correlation). Use frequency analysis and correlation analysis to identify rare or anomalous process/network activity post-boot in potential safe mode."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]