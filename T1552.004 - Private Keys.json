[
  {
    "Has the adversary accessed private cryptographic keys or certificates? (TA0006 - Credential Access)": {
      "Indicators": {
        "T1552.004 - Private Keys": {
          "Access or modification of known private key/certificate file extensions or directories.": {
            "Data": "Windows Event ID 4663",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4663 for access attempts (read/write/delete) on files matching known private key/certificate extensions (.key, .pem, .pfx, etc.) or within common key directories (~/.ssh, C:\\Users\\*\\ .ssh). Identify access by unusual user accounts or processes. Calculate baseline access frequency for these files/directories and flag deviations using statistical methods (e.g., Z-score or IQR on access count per user/host)."
          },
          "Anomalous authentication activity using keys or certificates, or network traffic consistent with key misuse.": {
            "Data": "Windows Event ID 4624, Windows Event ID 4625, Zeek ssh.log, Zeek ssl.log",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4624 and 4625 logs for successful or failed logins from accounts or systems that typically use certificate-based authentication. Look for logins from unexpected source IPs or at unusual times. Analyze Zeek logs (ssh.log, ssl.log, conn.log) for connections authenticated via certificates/keys, identifying connections to unusual destinations or unusual traffic patterns (e.g., using entropy analysis on payloads or correlation analysis with other network events)."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]