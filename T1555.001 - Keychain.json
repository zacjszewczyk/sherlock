[
  {
    "Has the adversary compromised credentials? (TA0006 - Credential-Access)": {
      "Indicators": {
        "T1555.001 - Keychain": {
          "Creation of suspicious processes or command-line arguments on endpoints associated with credential access activity, potentially after macOS keychain compromise leveraged for further access.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation and command-line arguments on relevant endpoints/servers. Identify suspicious parent/child process relationships or command executions related to potential credential usage or follow-on activity (even if the initial Keychain access wasn't logged here). Use frequency analysis or anomaly detection on process names/command arguments."
          },
          "Network traffic originating from compromised hosts (identified potentially via credential reuse from Keychain) to unusual destinations or containing suspicious patterns.": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log, http.log, and dns.log for connections from identified potentially compromised hosts (e.g., via credential reuse from Keychain) to unknown or suspicious destinations. Look for unusual data transfer volumes (descriptive statistics on bytes transferred), unusual protocols/ports (frequency analysis), or suspicious DNS queries. Use correlation analysis to link network activity to hosts/users suspected of credential compromise."
          },
          "Successful network authentication attempts (e.g., SMB, Kerberos) using potentially compromised macOS user credentials from an IP address not typically associated with that user or system.": {
            "Data": "Zeek auth.log; Zeek kerberos.log; Zeek smb.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect Zeek auth.log, kerberos.log, and smb.log. Filter for successful authentication events using known macOS user accounts. Baseline typical source IP addresses for these accounts (potentially correlating with known Mac IP ranges or VPN IPs). Flag authentication events using these accounts from statistically unusual or previously unseen source IPs. Use frequency analysis to establish baseline IP usage per user account over time and flag instances from IPs with low historical frequency or zero history."
          },
          "Execution of remote administration tools or unusual network access commands on Windows machines following successful network authentication using credentials potentially acquired from Keychain.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4624",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation events on Windows servers and endpoints. Look for execution of remote administration tools (e.g., psexec.exe, Impacket tools, remote PowerShell) or commands used for network access/enumeration. Correlate these events with successful network logons (Windows Event ID 4624, Logon Type 3) originating from potentially compromised macOS hosts or other suspicious IPs, using the compromised user account. Use correlation analysis to link process execution to specific logon events and source IPs."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]