[
  {
    "Is the adversary using trusted utilities like mshta.exe for defense evasion? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1218.005 - Mshta": {
          "Execution of mshta.exe with suspicious or obfuscated command-line arguments.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for mshta.exe process creations. Extract the command-line arguments. Use string analysis (e.g., entropy measure on argument strings) or pattern matching to identify obfuscated or suspicious script content (e.g., vbscript:Execute, GetObject, script:http/https). Compare current arguments to historical baseline of mshta.exe usage."
          },
          "Execution of mshta.exe loading external content (URLs) or HTA files, particularly in environments where HTA usage is uncommon.": {
            "Data": "Windows Event ID 4688, Zeek http.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for mshta.exe process creations. Extract command-line arguments. Look for executions referencing .hta files or external URLs (http/https). Analyze frequency of mshta.exe executions across the environment. Use time series analysis or frequency distribution to identify unusual spikes or occurrences, especially if HTA usage is low in the environment. Analyze Zeek http.log for connections initiated by mshta.exe."
          }
        }
      }
    }
  }
]