[
  {
    "Is the adversary maintaining persistence using Office Test registry keys? (TA0003 - Persistence)": {
      "Indicators": {
        "T1137.002 - Office Test": {
          "Modification of 'Office test' Registry keys.": {
            "Data": "Windows Event ID 4657",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 on endpoints and servers for modifications to Registry keys matching `*\\Microsoft\\Office test\\Special\\Perf`. Filter for changes to the 'DLL' value. Investigate any such modifications, particularly if the new value points to a suspicious or unfamiliar DLL path."
          },
          "Writing of potentially malicious DLL to a system path commonly used for persistence.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 on endpoints for process creations where the command line indicates writing a file with a `.dll` extension to common system directories (e.g., C:\\Windows\\System32, C:\\Program Files\\Common Files\\), especially if the parent process is unusual or the action occurs shortly before or after an Office application launch. Use frequency analysis on copied file paths to identify rare or unique destinations."
          },
          "Anomalous network connections or child process creation originating from a Microsoft Office application process (e.g., WINWORD.exe, EXCEL.exe).": {
            "Data": "Windows Event ID 4688; Windows Event ID 5156; Zeek conn.log",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for child processes spawned by Office applications (WINWORD.exe, EXCEL.exe, POWERPNT.exe, etc.). Monitor Windows Event ID 5156 and Zeek conn.log for network connections originating from Office application processes, especially to external or unusual destinations. Establish a baseline of normal network activity and child processes for Office applications and use frequency analysis or statistical deviation (e.g., IQR) to flag anomalies."
          },
          "Creation of 'Office test' Registry key followed by execution of a Microsoft Office application.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for creations of the Registry key `*\\Microsoft\\Office test\\Special\\Perf` where the value name is 'DLL'. Correlate these creation events with subsequent Windows Event ID 4688 showing the launch of an Office application process (WINWORD.exe, EXCEL.exe, etc.) within a short time window (e.g., 60 seconds) on the same endpoint/server. Flag instances where this specific Registry key is created followed by an Office app launch."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]