[
  {
    "Is the adversary attempting to discover information about Wi-Fi networks on compromised systems? (TA0007 - Discovery)": {
      "Indicators": {
        "T1016.002 - Wi-Fi Discovery": {
          "Execution of commands to list Wi-Fi profiles or show Wi-Fi keys (e.g., netsh wlan show profiles, netsh wlan show profile * key=clear).": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for creation of `cmd.exe`, `powershell.exe`, or other shell processes containing command lines with `netsh wlan show profiles` or `netsh wlan show profile * key=clear`. Correlate execution with unusual user accounts or system processes. Use frequency analysis to identify rare command executions."
          },
          "Unusual process execution patterns involving Wi-Fi related commands or utilities not typically run by users.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 for process creation on endpoints. Establish baseline user activity patterns regarding command execution. Use statistical methods like frequency analysis or entropy measures on command line strings or process names to flag unusual or low-occurrence processes related to network/Wi-Fi enumeration that deviate significantly from the norm."
          },
          "Sequential execution of `netsh wlan show profiles` followed by `netsh wlan show profile * key=clear` within the same user session.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 logs. Group events by `LogonId`. Within each `LogonId`, identify processes (e.g., `cmd.exe`, `powershell.exe`) executing commands containing `netsh wlan show profiles`. Track these process IDs/sessions. Look for subsequent commands from the same process/session containing `netsh wlan show profile` and `key=clear` within a short time frame (e.g., 60 seconds). Flag such sequences. Use frequency analysis per user/endpoint to identify rare occurrences."
          },
          "Correlation of processes executing system/network enumeration commands with subsequent unusual network connections from those processes.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 logs for processes executing commands related to system or network enumeration (e.g., `netsh`, `ipconfig`, `route print`, systeminfo, etc.). Identify `ProcessId`, `LogonId`, and timestamps. Correlate these with Zeek conn.log entries from the same endpoint by timestamp and source IP (`id.orig_h`). Look for external connections originating shortly after suspicious command execution by that process or user session. Analyze connection characteristics (destination IP/port, volume, protocol) for anomalies using correlation analysis and descriptive statistics (e.g., identify connections to rare ports, non-RFC1918 destinations, or unusually small/large data transfers)."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]