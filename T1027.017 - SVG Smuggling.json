[
  {
    "Is the adversary attempting to evade defenses using SVG smuggling? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1027.017 - SVG Smuggling": {
          "Identification of SVG files containing embedded JavaScript or other executable code within <script> tags.": {
            "Data": "Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek http.log for files transferred, specifically checking for files identified as SVG. Analyze the content of suspect SVG files for the presence of '<script>' tags and potentially obfuscated code. Use entropy analysis on the script content to flag highly obfuscated or packed scripts."
          },
          "Network connections or browser redirects initiated from seemingly benign SVG files, potentially attempting to download malicious payloads or visit malicious sites.": {
            "Data": "Zeek http.log, Zeek conn.log, Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek http.log and conn.log for outgoing connections initiated shortly after an SVG file is accessed or downloaded by an endpoint. Identify source/destination IP addresses and URLs. Cross-reference destination IPs/URLs with threat intelligence feeds. Use time series analysis to identify sudden spikes in outbound connections from endpoints after receiving SVG files. Examine process creation events (Windows Event ID 4688) for suspicious processes spawned by browser applications after SVG interaction."
          }
        }
      }
    }
  }
]