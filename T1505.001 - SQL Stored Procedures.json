[
  {
    "Is the adversary maintaining persistence using SQL stored procedures? (TA0003 - Persistence)": {
      "Indicators": {
        "T1505.001 - SQL Stored Procedures": {
          "Execution of operating system commands via SQL stored procedures, specifically detecting xp_cmdshell usage.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) logs on SQL Servers. Identify processes created by the sqlservr.exe process, specifically looking for cmd.exe, powershell.exe, or other unusual executables. Analyze correlation between the creation of these processes and activity within the SQL server process."
          },
          "Creation or modification of SQL stored procedures or CLR assemblies that are configured for persistence (e.g., startup procedures or malicious CLR assemblies).": {
            "Data": "Windows Event ID 4663",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4663 (Object Access) logs on SQL Servers for access or modification of SQL Server configuration files, system tables related to stored procedures or CLR assemblies, or assembly files themselves (e.g., .dll files in SQL Server directories). Use correlation analysis to identify patterns of suspicious access or modification times that deviate from administrative norms."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]