[
  {
    "Is the adversary attempting to impact network availability or functionality using reflection amplification? (TA0040 - Impact)": {
      "Indicators": {
        "T1498.002 - Reflection Amplification": {
          "Sudden, significant surge in network traffic volume or service utilization, particularly targeting specific services or protocols.": {
            "Data": "Zeek conn.log; Zeek dns.log; Zeek ntp.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor network traffic volume (e.g., bytes/second or packets/second) aggregated by protocol and destination IP using Zeek logs. Apply time series analysis and statistical process control techniques (e.g., plotting moving averages, calculating standard deviations) to detect sudden deviations from baseline traffic patterns. Trigger alerts on volume exceeding statistical thresholds (e.g., Z-score > 3 or exceeding the upper bound of a box plot)."
          },
          "Presence of high-volume traffic with spoofed source IP addresses, often using specific amplification-prone protocols (DNS, NTP, Memcache, etc.).": {
            "Data": "Zeek conn.log; Zeek dns.log; Zeek ntp.log; Zeek datagram.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log, dns.log, ntp.log for large UDP responses relative to small requests targeting specific ports or services. Look for source IP addresses that are internal but appear on external interfaces (indicating spoofing) or source IPs that do not match typical client ranges. Use correlation analysis to link high-volume traffic spikes with specific amplification-prone protocols or unusual source IP patterns."
          },
          "Significant difference in bytes transferred between initiators and responders for amplification-prone protocols, indicating a high amplification factor.": {
            "Data": "Zeek conn.log; Zeek dns.log; Zeek ntp.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log entries for traffic on known amplification ports (e.g., UDP 53, 123, 11211). Calculate the ratio of \"resp_bytes\" to \"orig_bytes\" for connections involving external sources and internal destinations. Flag connections or source IPs exhibiting high amplification ratios compared to baseline traffic patterns established using percentiles or IQR analysis."
          },
          "High volume of incoming traffic on amplification-prone ports from a large, diverse, or unusual set of external source IP addresses.": {
            "Data": "Zeek conn.log; Zeek dns.log; Zeek ntp.log; Zeek datagram.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek conn.log for traffic hitting known amplification ports on internal services. For high-volume events identified, analyze the source IP addresses. Measure the entropy of source IP addresses connecting within a short time window. Flag events with high volume AND high source IP entropy (indicating many distinct sources, potentially spoofed) or IPs from unexpected geographic regions or networks based on geolocation data. Correlate volume and source diversity metrics with specific amplification-prone protocols using Zeek dns.log/ntp.log."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]