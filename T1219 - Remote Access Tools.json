[
  {
    "Is the adversary using remote access tools for command and control? (TA0011 - Command and Control)": {
      "Indicators": {
        "T1219 - Remote Access Tools": {
          "Presence or execution of known remote access tool executables or processes.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints; Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 logs for process creation events containing known remote access tool executable names or paths. Use frequency analysis to identify rare process creations across endpoints/servers. Correlate with other suspicious activities detected on the host (e.g., unusual network connections)."
          },
          "Network connections involving unusual traffic patterns (e.g., asymmetric data flow, unexpected protocols on standard ports) originating from or directed to systems potentially running remote access tools.": {
            "Data": "Zeek conn.log; Zeek dce_rpc.log; Zeek rdp.log; Zeek ssh.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for connections on common remote access ports (e.g., RDP 3389, VNC 5900-5902, SSH 22) exhibiting asymmetric data flow (e.g., significantly more data sent by the 'originator' than received). Use statistical analysis on byte counts (`orig_bytes` vs `resp_bytes`) to identify deviations from normal RDP/VNC/SSH session profiles. Examine application layer logs (Zeek dce_rpc.log, rdp.log, ssh.log) for unusual protocol behavior or commands."
          },
          "Execution of remote access tool processes from non-standard or unusual file paths, or initiated by unusual parent processes.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints; Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 logs for processes identified as remote access tools. Extract the `New Process Name` (full image path) and `Parent Process Name`. Establish a baseline of common execution paths and parent processes for legitimate remote tool usage. Identify execution from temporary directories (e.g., %TEMP%, %APPDATA%), user download folders, or arbitrary/suspicious paths. Flag execution where the `Parent Process Name` is unusual (e.g., script interpreters like powershell.exe, cmd.exe; compression tools) or non-existent. Use frequency analysis and correlation analysis between process path and parent process."
          },
          "Outbound network connections from internal hosts to external destinations on ports commonly used for inbound remote access services (e.g., RDP, VNC, SSH, or specific RAT ports).": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek conn.log for outbound connections (internal `id.orig_h` to external `id.resp_h`) on ports commonly used by remote access tools (e.g., 22, 3389, 5900-5902, 5631, 5500, or other known RAT ports). Use statistical analysis (e.g., connection duration, byte counts) and time series analysis to identify unusual patterns (e.g., long-duration connections, recurring connections to the same external IP, connections outside of normal business hours) for specific internal hosts. Use correlation analysis between source host and destination IP/port pairs to identify outliers."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]