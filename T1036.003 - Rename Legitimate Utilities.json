[
  {
    "Is the adversary attempting to evade defenses by modifying legitimate utilities? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1036.003 - Rename Legitimate Utilities": {
          "Executable binaries with mismatched filenames on disk and in PE metadata (e.g., OriginalFilename or InternalName differ from the disk name).": {
            "Data": "Windows Event ID 1",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Process Creation events (Windows Event ID 1 or Sysmon equivalent) for executable files. For processes associated with known legitimate utilities (e.g., rundll32.exe, psexec.exe), collect file path on disk and PE metadata (OriginalFilename, InternalName). Use correlation analysis or string matching to identify instances where the disk filename does not match the PE metadata filenames. Prioritize investigation of mismatches for commonly abused utilities."
          },
          "Execution of renamed legitimate utilities identified by distinctive command-line arguments typically associated with the original utility.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Process Creation events (Windows Event ID 4688 or Sysmon equivalent) including command-line arguments. Identify command lines containing arguments or patterns distinctive to known legitimate utilities (e.g., '/accepteula' for PSExec, specific DLL entry points for rundll32.exe). Group processes by command line patterns and identify executions where the executable file name is not the expected name for that command line (e.g., 'temp.exe /accepteula'). Use frequency analysis to identify rare executable names associated with common legitimate command-line argument patterns."
          }
        }
      }
    }
  }
]