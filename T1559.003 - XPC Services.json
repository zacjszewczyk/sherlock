[
  {
    "Is the adversary executing malicious code using XPC services? (TA0002 - Execution)": {
      "Indicators": {
        "T1559.003 - XPC Services": {
          "Unusual inter-process communication patterns or execution requests observed involving XPC services, particularly from non-standard or newly introduced processes.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for connections originating from macOS endpoints that exhibit unusual destination IPs, ports, or traffic volume. Identify rare destination connections using frequency analysis or compare against established baselines (descriptive statistics) for macOS endpoint network behavior. Flag outbound connections to suspicious destinations or unexpected inbound connections."
          },
          "Failed or suspicious attempts to leverage XPC services or their handling mechanisms in conjunction with privilege escalation attempts.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for outbound connections from macOS endpoints to known malicious C2 servers or unusual internal lateral movement attempts (e.g., RDP, SMB) initiated by a macOS host, particularly focusing on unexpected network protocols or ports for a macOS origin. Use correlation analysis to link unusual network activity to specific internal endpoints potentially engaged in privilege escalation."
          },
          "Outbound network connections from macOS endpoints to unusual or known malicious destinations occurring shortly after potential malicious execution activity.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for new outbound connections originating from macOS endpoints. Filter connections to known malicious IPs/domains from threat intelligence feeds. Identify anomalous destinations by comparing against historical connection logs from macOS endpoints (using frequency analysis or deviation from typical connection patterns using descriptive statistics). Correlate network activity with available endpoint data feeds if possible (outside the scope of current data sources) to tie connections to specific processes."
          },
          "Scanning activity (e.g., port scans) originating from a macOS endpoint, indicated by multiple connection attempts to various targets within a short time window.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for multiple distinct connection attempts (to different ports on the same host or different hosts) originating from a single macOS source IP within a defined time period (e.g., 60 seconds). Calculate connection rates per source IP per time window. Flag source IPs exhibiting rates significantly higher than the baseline for macOS endpoints (using statistical methods like Z-score or IQR). Investigate source IPs identified for unusual scanning behavior."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]