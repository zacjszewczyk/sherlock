[
  {
    "Is the adversary acquiring resources, specifically code signing certificates, for use in operations? (TA0042 - Resource Development)": {
      "Indicators": {
        "T1588.003 - Code Signing Certificates": {
          "Execution of binaries or scripts signed with suspicious or unusual code signing certificates (e.g., newly created, self-signed, unusual issuer, mismatch with expected signer).": {
            "Data": "Sysmon Event ID 1",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 1 (Process Creation) logs. For all signed processes, extract certificate details (issuer, subject, validity dates, thumbprint). Identify certificates with unusual characteristics such as recent creation dates, self-signed status, or unexpected issuer/subject names. Use descriptive statistics to profile commonly seen certificates and flag outliers."
          },
          "Execution of signed code where the signing certificate's characteristics (e.g., serial number, thumbprint, common name) match those previously associated with known adversary activities or found in threat intelligence feeds.": {
            "Data": "Sysmon Event ID 1",
            "Data Platform": "Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 1 (Process Creation) logs for signed processes. Extract certificate thumbprints or serial numbers. Inner join extracted certificate details with threat intelligence feeds containing known malicious certificate information. Investigate any matches."
          },
          "Addition of a new, unusual root or intermediate code signing certificate to trusted certificate stores on endpoints or servers.": {
            "Data": "Sysmon Event ID 12; Sysmon Event ID 13",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 12 (RegistryEvent (Value Set)) and 13 (RegistryEvent (Key Create)) targeting paths related to trusted root and intermediate certificate stores (`*Microsoft\\SystemCertificates\\Root\\*`, `*Microsoft\\SystemCertificates\\TrustedPeople\\*`, etc.). Identify events where new certificate values are added or created. Analyze the process name and command line associated with these events for suspicious activity. Establish a baseline of legitimate certificate store modifications and flag outliers using frequency analysis or rule-based detection for unusual processes/users performing the action."
          },
          "Network activity indicating attempts to validate suspicious certificates or connections to unusual certificate infrastructure (e.g., CRL/OCSP endpoints).": {
            "Data": "Zeek conn.log; Zeek ssl.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek ssl.log for connections involving certificates and analyze validation status. Identify connections to domains/IPs for Certificate Revocation Lists (CRLs) or Online Certificate Status Protocol (OCSP) checks using Zeek conn.log. Profile expected CRL/OCSP endpoints based on frequency and trusted CAs. Flag connections to unusual or rare CRL/OCSP endpoints, or SSL connections where certificate validation fails or involves untrusted certificates. Use frequency analysis and correlation with threat intelligence to identify suspicious network destinations for certificate validation."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]