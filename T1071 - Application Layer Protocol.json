[
  {
    "Is the adversary using application layer protocols for command and control? (TA0011 - Command-And-Control)": {
      "Indicators": {
        "T1071 - Application Layer Protocol": {
          "Network connections exhibiting highly asymmetric data flow (e.g., large client-to-server data volume for protocols typically receiving data).": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log. For common application protocols (HTTP, DNS, SMB), calculate the ratio of orig_bytes to resp_bytes. Identify connections with extreme ratios deviating significantly from the norm (e.g., using IQR or percentile analysis on the byte ratio distribution per protocol) to flag unusual data flows."
          },
          "Network traffic using standard application protocols (HTTP, DNS, SMB, etc.) but with unusual structure or content, or connections to ports/services typically not used by specific processes.": {
            "Data": "Zeek conn.log, Zeek http.log, Zeek dns.log, Zeek smb.log, Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek logs (conn.log, http.log, dns.log, smb.log, etc.). For connections using common application layer ports, investigate traffic exhibiting anomalous protocol behavior (e.g., non-standard HTTP methods, unusual DNS query types/sizes, SMB traffic from unexpected processes). Correlate Zeek connections with Windows Event ID 4688 (Process Creation) to identify processes initiating suspicious network connections that normally wouldn't communicate over the network or use that specific protocol."
          }
        }
      }
    }
  }
]