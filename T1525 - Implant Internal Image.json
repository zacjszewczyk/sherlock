[
  {
    "Is the adversary maintaining persistence by implanting internal images? (TA0003 - Persistence)": {
      "Indicators": {
        "T1525 - Implant Internal Image": {
          "Anomalous addition or modification of cloud/container images within internal registries by users/accounts with unusual activity patterns.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections to known internal image registry endpoints. Analyze connection volume, timing, and data transfer size. Flag large data uploads (image pushes) occurring outside of standard deployment windows or from unusual source IPs. Use time series analysis to detect spikes in traffic to the registry."
          },
          "Suspicious interactions with implanted or modified images via container runtime logs (e.g., Docker daemon, Kubernetes audit logs).": {
            "Data": "Zeek conn.log, Windows Event ID 4688",
            "Data Platform": "Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for outbound connections from hosts running container runtimes (Docker, Kubernetes nodes). Correlate Zeek connections with Windows Event ID 4688 on these hosts to identify processes originating connections. Analyze destination IPs/domains for connections originating from newly created or updated containers, cross-referencing against threat intelligence feeds. Identify unusual network behavior patterns (e.g., high entropy destination domains) using statistical methods."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]