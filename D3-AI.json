[
    {
        "information_requirement": "What is the current state of our asset inventory?",
        "tactic_id": "D3-AI",
        "tactic_name": "Asset Inventory",
        "indicators": [
            {
                "technique_id": "D3-HCI",
                "name": "Hardware Component Inventory",
                "evidence": [
                    {
                        "description": "An authoritative inventory of system hardware components is compiled from official system security authorization packages.",
                        "data_sources": [
                            "eMASS hardware inventory reports"
                        ],
                        "data_platforms": [
                            "eMASS (Enterprise Mission Assurance Support Service)"
                        ],
                        "nai": "Specific system authorization packages within eMASS.",
                        "action": "Periodically export the hardware inventory from the relevant system package in eMASS. Treat this list as the authoritative, compliant hardware baseline. Compare this baseline against assets discovered through active scanning (ACAS) and passive monitoring (Zeek) to identify undocumented or non-compliant hardware present on the network."
                    },
                    {
                        "description": "A comprehensive hardware inventory is generated from the asset discovery and enumeration results of an active vulnerability scan.",
                        "data_sources": [
                            "ACAS scan results"
                        ],
                        "data_platforms": [
                            "ACAS SecurityCenter"
                        ],
                        "nai": "All managed IP address spaces and subnets.",
                        "action": "Schedule and execute regular, authenticated ACAS discovery scans across all defined network segments. Parse the scan results to extract asset details such as IP address, MAC address, NetBIOS name, and detected operating system. Use this data as an authoritative source to populate and validate the master hardware asset inventory, cross-referencing with passive sources to identify discrepancies or unscanned assets."
                    },
                    {
                        "description": "Internet-facing hardware and edge devices are identified and inventoried using an external attack surface management (ASM) platform.",
                        "data_sources": [
                            "ASM platform discovery reports and asset inventory exports"
                        ],
                        "data_platforms": [
                            "External Attack Surface Management (EASM) Platform"
                        ],
                        "nai": "The organization's internet-facing perimeter and public IP address ranges.",
                        "action": "Configure the ASM platform with the organization's known domains, IP ranges, and subsidiaries. Continuously review the platform's discovered assets, focusing on identifying hardware devices like firewalls, VPN gateways, and load balancers. Correlate these externally discovered assets with internal inventory sources to validate ownership and ensure all edge devices are accounted for and monitored."
                    },
                    {
                        "description": "A baseline of active network hardware (e.g., NICs) and associated hosts is established by analyzing network and host logs.",
                        "data_sources": [
                            "Zeek conn.log",
                            "Windows Event ID 4624"
                        ],
                        "data_platforms": [
                            "TBD"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Aggregate all unique source and destination hardware MAC addresses and IP addresses from Zeek conn.log over a 30-day period. Correlate IP addresses with hostnames from Windows Event ID 4624 logon events. Create a master list of MAC-IP-Hostname tuples representing the hardware inventory. Calculate the frequency of each tuple's appearance to identify core infrastructure versus transient or unauthorized devices."
                    },
                    {
                        "description": "A new, previously unseen hardware device has connected to the network and requested a DHCP lease.",
                        "data_sources": [
                            "Zeek dhcp.log"
                        ],
                        "data_platforms": [
                            "TBD"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Establish a baseline of known MAC addresses and their associated OUIs from dhcp.log over a 30-day period. Continuously monitor for new MAC addresses not present in the baseline. For new MACs, enrich with vendor information and alert security personnel to verify the legitimacy of the new hardware."
                    }
                ]
            },
            {
                "technique_id": "D3-NNI",
                "name": "Network Node Inventory",
                "evidence": [
                    {
                        "description": "A comprehensive network hardware inventory is generated from the asset discovery and enumeration results of an active vulnerability scan.",
                        "data_sources": [
                            "ACAS scan results"
                        ],
                        "data_platforms": [
                            "ACAS SecurityCenter"
                        ],
                        "nai": "All managed IP address spaces and subnets.",
                        "action": "Schedule and execute regular, authenticated ACAS discovery scans across all defined network segments. Parse the scan results to extract asset details such as IP address, MAC address, NetBIOS name, and detected operating system for networking devices. Use this data as an authoritative source to populate and validate the master network hardware asset inventory, cross-referencing with passive sources to identify discrepancies or unscanned assets."
                    },
                    {
                        "description": "A comprehensive list of all active network nodes is generated by observing unique IP addresses communicating on the network.",
                        "data_sources": [
                            "Zeek conn.log",
                            "Zeek dhcp.log"
                        ],
                        "data_platforms": [
                            "TBD"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Extract all unique originating and responding IP addresses from Zeek conn.log over a 30-day baseline period. Cross-reference these IPs with lease information in Zeek dhcp.log to associate IP addresses with hostnames and MAC addresses. Use descriptive statistics to profile the address space, identifying the total number of active nodes and calculating the daily churn rate (new IPs seen / total IPs) to understand network stability."
                    }
                ]
            },
            {
                "technique_id": "D3-SWI",
                "name": "Software Inventory",
                "evidence": [
                    {
                        "description": "An authoritative inventory of approved system software is compiled from official system security authorization packages.",
                        "data_sources": [
                            "eMASS software inventory reports",
                            "System Security Plan (SSP) approved software lists"
                        ],
                        "data_platforms": [
                            "eMASS (Enterprise Mission Assurance Support Service)"
                        ],
                        "nai": "Specific system authorization packages within eMASS.",
                        "action": "Periodically export the approved software inventory from the relevant system package in eMASS. Use this list as an authoritative allowlist for system software. Compare this allowlist against software identified through endpoint monitoring (e.g., Windows Event ID 4688) to detect unauthorized or non-compliant applications running on production systems."
                    },
                    {
                        "description": "A comprehensive software inventory is generated from the asset discovery and enumeration results of an active vulnerability scan.",
                        "data_sources": [
                            "ACAS scan results"
                        ],
                        "data_platforms": [
                            "ACAS SecurityCenter"
                        ],
                        "nai": "All managed IP address spaces and subnets.",
                        "action": "Schedule and execute regular, authenticated ACAS discovery scans across all defined network segments. Parse the scan results to extract software details based on open ports, banners, and other identifying information. Use this data as an authoritative source to populate and validate the master software inventory, cross-referencing with passive sources to identify discrepancies or unscanned assets."
                    },
                    {
                        "description": "A baseline of installed and executed software on endpoints is created by monitoring process creation events.",
                        "data_sources": [
                            "Windows Event ID 4688"
                        ],
                        "data_platforms": [
                            "TBD"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Aggregate all unique process name fields from Windows Event ID 4688 across all hosts. For each unique executable path, calculate its prevalence (percentage of hosts it runs on). Then, calculate a rarity score for each executable (e.g., 1 / prevalence) to identify uncommon software. Establish a baseline of normal parent-child process relationships."
                    },
                    {
                        "description": "A software installation event is logged by the Windows Installer service.",
                        "data_sources": [
                            "Windows Event ID 11707"
                        ],
                        "data_platforms": [
                            "TBD"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Monitor endpoints for Windows Event ID 11707 (Installation of a product was completed successfully). Extract the 'Product Name' from the event and validate it against a centrally managed allowlist of approved software. Maintain statistics on the installation frequency of all software titles to identify applications that become anomalously popular, which could indicate a widespread, unapproved installation."
                    }
                ]
            },
            {
                "technique_id": "D3-AVE",
                "name": "Asset Vulnerability Enumeration",
                "evidence": [
                    {
                        "description": "A comprehensive vulnerability inventory is generated from the asset enumeration results of an active vulnerability scan.",
                        "data_sources": [
                            "ACAS scan results"
                        ],
                        "data_platforms": [
                            "ACAS SecurityCenter"
                        ],
                        "nai": "All managed IP address spaces and subnets.",
                        "action": "Schedule and execute regular, authenticated ACAS discovery scans across all defined network segments. Parse the scan results to identify vulnerabilities, particularly for hardware and software with known vulnerability disclosures. Use this data as an authoritative source to populate the list of known vulnerabilities in the environment, cross-referencing with passive sources to identify discrepancies or unscanned assets."
                    },
                    {
                        "description": "Potentially vulnerable software services are identified by mapping open ports and services observed on the network to specific software versions.",
                        "data_sources": [
                            "Zeek conn.log",
                            "Zeek software.log"
                        ],
                        "data_platforms": [
                            "TBD"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "From Zeek conn.log, identify all unique destination ports and the hosts listening on them. Correlate this with Zeek software.log to map service banners and software names/versions to the listening host and port. Create a summary table of Host-Port-Service-Version. This inventory can then be compared against an external vulnerability database to enumerate potential vulnerabilities."
                    },
                    {
                        "description": "Network traffic containing deprecated or insecure protocols (e.g., SSLv3, Telnet) is identified.",
                        "data_sources": [
                            "Zeek ssl.log",
                            "Zeek conn.log"
                        ],
                        "data_platforms": [
                            "TBD"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Scan Zeek ssl.log for connections where the 'version' field is 'SSLv3', 'TLSv1', or 'TLSv1.1'. Filter Zeek conn.log for traffic on unencrypted ports like 21 (FTP) and 23 (Telnet). Enrich these findings with asset criticality information. Calculate the percentage of total daily connections using these protocols to quantify risk, prioritize remediation for critical systems, and track progress."
                    }
                ]
            },
            {
                "technique_id": "D3-DI",
                "name": "Data Inventory",
                "evidence": [
                    {
                        "description": "High-volume data repositories and their general data types are identified by analyzing network flow and file access logs.",
                        "data_sources": [
                            "Zeek",
                            "Windows Event Logs",
                            "Network Appliance Logs"
                        ],
                        "data_platforms": [
                            "TBD"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Identify and record the schemas, formats, volumes, and locations of data stored and used on the organization's architecture. Analyze Zeek conn.log to identify internal hosts in the 99th percentile for total bytes transferred, flagging them as potential data stores. Correlate these IPs with Zeek files.log to analyze the MIME types and file extensions of data they transfer, inferring data types (e.g., .sql, .docx, .zip). For known file servers, monitor Windows Event ID 5145 ('ShareName', 'RelativeTargetName') to map the most frequently accessed data shares and file paths, thereby building an inventory of critical data locations."
                    }
                ]
            }
        ]
    }
]