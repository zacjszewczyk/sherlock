[
  {
    "Has the adversary executed code using JavaScript? (TA0002 - Execution)": {
      "Indicators": {
        "T1059.007 - JavaScript": {
          "Process creation events showing wscript.exe or cscript.exe executing .js or .jse files.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations where Parent Process Name or Process Name is 'wscript.exe' or 'cscript.exe' and Command Line contains '.js' or '.jse'. Analyze frequency of execution per user/host; flag statistically rare occurrences or executions outside baselined activity."
          },
          "Observation of obfuscated JavaScript files downloaded or executed, potentially via browser or network activity.": {
            "Data": "Zeek http.log, Zeek file.log, Windows Event ID 4688, Windows Event ID 4663",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek http.log for file downloads with '.js' extensions, especially those with low entropy file names or from suspicious sources. Analyze Zeek file.log for creation of '.js' or '.jse' files. Monitor Windows Event ID 4688 where the command line involves executing script files from unusual directories (e.g., temp folders, user profile downloads). Apply entropy measures to identify potentially obfuscated script content if file capture is available."
          }
        }
      }
    }
  }
]