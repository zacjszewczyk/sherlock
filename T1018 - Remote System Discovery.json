[
  {
    "Is the adversary performing remote system discovery? (TA0007 - Discovery)": {
      "Indicators": {
        "T1018 - Remote System Discovery": {
          "Execution of system discovery commands (e.g., ping, net view, esxcli network diag ping) on endpoints or servers.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation events containing command-line arguments associated with remote system discovery tools (e.g., 'ping ', 'net view', 'esxcli network diag ping', 'tracert '). Identify processes executing these commands in quick succession or from unusual user accounts. Calculate frequency and timing of such commands per host/user, flagging outliers using descriptive statistics."
          },
          "Suspicious network traffic patterns indicative of scanning or analysis of host files/ARP caches.": {
            "Data": "Zeek conn.log, Zeek dns.log, Windows Event ID 4663",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for patterns indicative of network scanning (e.g., connections to multiple destination IPs/ports from a single source in a short period, failed connection attempts across a range of IPs). Analyze Zeek dns.log for unusual volumes of DNS lookups from a single source. Monitor Windows Event ID 4663 for access attempts to host files (C:\\Windows\\System32\\Drivers\\etc\\hosts, /etc/hosts) from unexpected processes or users. Use correlation analysis to link discovery traffic/events to other suspicious activities."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]