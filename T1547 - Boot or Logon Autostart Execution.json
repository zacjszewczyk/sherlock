[
  {
    "Is the adversary maintaining persistence through boot or logon autostart execution? (TA0003 - Persistence)": {
      "Indicators": {
        "T1547 - Boot or Logon Autostart Execution": {
          "Modification or addition of entries in Registry Run keys, Startup folders, or other autostart locations that are not linked to legitimate software installation.": {
            "Data": "Windows Event ID 4657; Sysmon Event ID 12; Sysmon Event ID 13",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 and Sysmon Event ID 12/13 targeting Registry keys associated with autostart (e.g., Run, RunOnce, Startup folders). Baseline normal modifications. Flag changes not correlated with software installs or updates. Use time series analysis to identify sudden bursts of modifications across multiple endpoints."
          },
          "Execution of previously unseen or suspicious processes shortly after system boot or user logon.": {
            "Data": "Windows Event ID 4688; Sysmon Event ID 1",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688/Sysmon Event ID 1 for processes starting within a short time window after system boot or user logon. Establish a baseline of normal startup processes using descriptive statistics (frequency counts). Flag processes with low frequency or high entropy in process name/path relative to established baselines."
          },
          "Installation or modification of suspicious kernel modules or drivers configured for autostart.": {
            "Data": "Windows Event ID 4697; Windows Event ID 7045; Windows Event ID 4688; Sysmon Event ID 1",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4697, 7045, 4688, and Sysmon Event ID 1 for service installations or process execution related to driver or kernel module manipulation utilities. Flag services configured to start automatically ('Start Type: Auto' or 'Boot') with suspicious names, unsigned binaries, or installed from unusual paths. Correlate service installation events with subsequent process creation (4688/Sysmon 1) for signed/unsigned binaries related to the new service. Baseline normal driver/service installations using frequency counts and identify outliers."
          },
          "Processes started via autostart mechanisms initiating network connections to suspicious or unknown external destinations shortly after boot/logon.": {
            "Data": "Zeek conn.log; Windows Event ID 5156; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate process creation events (Windows Event ID 4688) for processes starting at boot/logon with outbound network connections observed in Zeek conn.log or Windows Event ID 5156 shortly thereafter. Filter for connections to external IP addresses. Cross-reference destination IPs against threat intelligence feeds. Use frequency analysis on destination IPs/ports for startup processes to identify rare or new connections."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary attempting privilege escalation via boot or logon autostart execution? (TA0004 - Privilege-Escalation)": {
      "Indicators": {
        "T1547 - Boot or Logon Autostart Execution": {
          "Modification of configuration or binaries for services or scheduled tasks configured to run with high privileges at boot or logon.": {
            "Data": "Windows Event ID 4674; Windows Event ID 4697; Windows Event ID 4700; Windows Event ID 4701; Windows Event ID 4702; Sysmon Event ID 1",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4674, 4697, 4700-4702 and Sysmon Event ID 1 for changes to service configurations or scheduled tasks set to run as SYSTEM or other privileged accounts, especially those configured for autostart. Correlate these events with known administrative actions or software deployments. Flag anomalous modifications or creations."
          },
          "Processes configured for boot or logon autostart loading suspicious or unknown DLLs.": {
            "Data": "Sysmon Event ID 7",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Sysmon Event ID 7 for DLL loads by processes identified as running at boot/logon. Maintain a baseline of normally loaded DLLs per process using frequency analysis. Flag processes loading DLLs with low frequency, unknown signers, or suspicious paths, particularly if the process itself is flagged as unusual."
          },
          "Processes starting via autostart mechanisms running with SYSTEM or other high privileges that have low frequency or high entropy relative to established baselines.": {
            "Data": "Windows Event ID 4688; Sysmon Event ID 1",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688/Sysmon Event ID 1 for processes started with elevated privileges (e.g., User='SYSTEM', or high integrity level) shortly after system boot or user logon. Establish a baseline of normal privileged startup processes using frequency analysis of process name, path, and associated user. Flag privileged processes with low frequency, suspicious command lines, or those originating from non-standard paths. Calculate entropy for process names/paths seen running with high privileges at startup to identify rare occurrences."
          },
          "Usage of utilities to modify service or scheduled task configurations for autostart/privileged execution shortly after successful logon by a non-privileged user.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4657; Windows Event ID 4700; Windows Event ID 4701; Windows Event ID 4697; Sysmon Event ID 1",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688/Sysmon Event ID 1 for execution of system utilities (`sc.exe`, `reg.exe`, `schtasks.exe`, `powershell.exe`, `wmic.exe`, etc.) with command-line arguments indicating modification or creation of autostart mechanisms (Registry Run keys, services configured to start automatically, scheduled tasks running at boot/logon). Correlate these events with user logon sessions (Event ID 4624). Flag execution by non-privileged users targeting privileged autostart locations. Use frequency analysis on command-line arguments for these utilities to identify unusual patterns."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]