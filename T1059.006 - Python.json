[
  {
    "Is the adversary executing code via Python? (TA0002 - Execution)": {
      "Indicators": {
        "T1059.006 - Python": {
          "Detection of python.exe executing with unusual command-line arguments or in unexpected locations/user contexts.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for executions of 'python.exe'. Analyze command-line arguments for obfuscation, encoded commands, or unusual parameters. Identify execution from non-standard user profiles, temporary directories, or locations outside of program files. Calculate frequency distribution of 'python.exe' execution paths and identify low-frequency occurrences or deviations from established baselines."
          },
          "Identification of Python scripts (.py) performing suspicious actions (e.g., network connections to unusual IPs, file modifications, process creation) or found in temporary/suspicious directories.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for command lines executing '.py' files. Capture the file path if possible. Look for subsequent events originating from the python.exe process (e.g., network connections in Zeek conn.log). Use correlation analysis to link Python script execution with follow-on suspicious activities like external connections."
          },
          "Outbound network connections initiated by 'python.exe' to unusual or unauthorized destinations.": {
            "Data": "Windows Event ID 5156; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 5156 for outbound network connections where the initiating process is 'python.exe'. Correlate these events with Zeek conn.log for more detail (destination IP, port, bytes transferred). Compare destination IPs against a baseline of allowed/expected Python network activity (e.g., package managers, specific internal services). Flag connections to external, unusual, or known malicious IPs using frequency analysis or comparison against threat intelligence feeds."
          },
          "Python processes spawning unusual child processes or interacting with system utilities in a suspicious manner.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688. Identify events where 'python.exe' is the parent process. Analyze the command line of the child process for suspicious executions of system utilities (e.g., `cmd.exe`, `powershell.exe`, `bitsadmin.exe`, `wmic.exe`) or attempts to execute dropped binaries. Build a baseline of typical child processes spawned by legitimate Python activity using frequency analysis and flag deviations using statistical methods like standard deviation or IQR."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]