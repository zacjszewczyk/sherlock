[
  {
    "Is the adversary gathering information about our organization via CDNs? (TA0043 - Reconnaissance)": {
      "Indicators": {
        "T1596.004 - CDNs": {
          "Attempts to access specific URLs on our CDN containing potentially sensitive data or misconfigurations, different from typical user access patterns.": {
            "Data": "Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek http.log for connections to URLs associated with sensitive data or known misconfigurations hosted on our CDN. Use frequency analysis or time series analysis to identify access patterns deviating significantly from baseline user traffic to the CDN. Flag requests with unusual user agents, referrers, or parameters."
          },
          "Unusual scanning or probing activity directed at infrastructure associated with our CDN deployment (e.g., specific ports, paths, or metadata endpoints).": {
            "Data": "Zeek conn.log; Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and Zeek http.log for connections targeting infrastructure endpoints associated with our CDN management or origin servers. Identify connection attempts to non-standard ports or with rapid sequencing/volume indicative of scanning (e.g., using entropy measures on destination ports or source IPs, or time series analysis on connection attempts)."
          },
          "Internal systems making unusual DNS queries related to CDN infrastructure or attempting to connect to potential internal origin servers.": {
            "Data": "Zeek dns.log; Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek dns.log for internal systems resolving uncommon hostnames potentially linked to CDN control planes, origin servers, or management interfaces. Analyze Zeek conn.log for corresponding connection attempts to these resolved IPs, focusing on non-standard ports or patterns indicative of probing. Use frequency analysis on queried hostnames and connection targets to identify outliers."
          },
          "Internal user accounts accessing or searching for documentation or configuration files related to CDN setup or origin servers.": {
            "Data": "Windows Event ID 4663; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Configure auditing for Windows Event ID 4663 on known locations of sensitive CDN documentation or configuration files to detect read access attempts by unusual users or from unexpected systems. Monitor Windows Event ID 4688 for process creation indicating searches (e.g., using command-line search tools) or access to specific document types with filenames potentially containing CDN/origin details. Establish baseline access patterns and flag deviations."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]