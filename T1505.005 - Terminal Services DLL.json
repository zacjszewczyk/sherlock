[
  {
    "Is the adversary maintaining persistence using Terminal Services DLL modification? (TA0003 - Persistence)": {
      "Indicators": {
        "T1505.005 - Terminal Services DLL": {
          "Modification of Terminal Services Registry keys, specifically ServiceDll.": {
            "Data": "Windows Event ID 4657, Windows Event ID 4688",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for changes to registry values under HKLM\\System\\CurrentControlSet\\services\\TermService\\Parameters\\, specifically 'ServiceDll'. Analyze the process (from Event ID 4688) responsible for the change and the new value of 'ServiceDll' for suspicious paths or file names. Baseline typical changes and identify deviations."
          },
          "Unexpected creation, modification, or loading of termsrv.dll or other DLLs by the Terminal Services process.": {
            "Data": "Windows Event ID 4688, Windows Event ID 4663",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations on servers running Terminal Services (e.g., 'svchost.exe -k termsvcs'). Investigate processes with command lines indicating interaction with %SystemRoot%\\System32\\termsrv.dll or attempts to modify relevant registry keys using tools like 'reg.exe'. Use Windows Event ID 4663 (if configured) to detect attempts to write/modify termsrv.dll. Identify rare or suspicious processes interacting with these critical files/keys using frequency analysis."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]