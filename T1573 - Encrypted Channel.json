[
  {
    "Is the adversary using encrypted channels for command and control? (TA0011 - Command and Control)": {
      "Indicators": {
        "T1573 - Encrypted Channel": {
          "SSL/TLS inspection findings indicating suspicious certificate details (e.g., self-signed, expired, unusual issuer) or non-standard protocol usage within encrypted traffic.": {
            "Data": "Zeek ssl.log; Zeek x509.log; Zeek weird.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek ssl.log and x509.log for connections using self-signed or expired certificates, or certificates from unusual/untrusted issuers. Correlate with Zeek conn.log for destination IPs. Identify connections exhibiting non-standard TLS handshake patterns or protocol violations (check Zeek weird.log). Focus analysis on external connections."
          },
          "Network traffic patterns exhibiting unusual data flows (e.g., high client upload/low download ratio) to external destinations over encrypted channels, or encrypted traffic from unexpected processes.": {
            "Data": "Zeek conn.log; Zeek weird.log; Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for traffic over standard encrypted ports (e.g., 443, 8443). Calculate the ratio of bytes sent vs. bytes received for external connections using descriptive statistics. Identify sessions with unusually high client-to-server ratios or consistently low data transfer rates. Correlate external network connections from Windows Event ID 4688 logs to identify processes making unexpected encrypted connections."
          },
          "Encrypted network traffic to uncommon ports or ports not typically associated with encrypted web traffic (e.g., 443, 8443), showing sustained communication.": {
            "Data": "Zeek conn.log; Zeek weird.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for connections with service 'ssl' or traffic on ports 443, 8443 etc. Filter for connections to external destinations on ports *other than* standard encrypted web ports. Identify connections with bytes transferred > 0 and duration > threshold for sustained communication. Use frequency analysis to identify ports with infrequent encrypted traffic and investigate connections to these ports."
          },
          "Execution of unusual processes initiating encrypted network connections to external destinations.": {
            "Data": "Windows Event ID 4688; Windows Event ID 5156; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) for processes with uncommon names or paths. Correlate these processes with external network connection events (Windows Event ID 5156) and Zeek conn.log entries showing encrypted connections (service 'ssl' or on standard encrypted ports). Establish baselines of typical processes making encrypted connections and flag outliers using frequency analysis or correlation analysis."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]