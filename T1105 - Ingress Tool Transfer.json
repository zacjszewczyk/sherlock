[
  {
    "Is the adversary transferring tools or files into the network? (TA0011 - Command-And-Control)": {
      "Indicators": {
        "T1105 - Ingress Tool Transfer": {
          "Creation of executable files or tools on endpoints originating from unusual or network-related processes (e.g., curl, wget, PowerShell Invoke-WebRequest).": {
            "Data": "Windows Event ID 4688, Zeek conn.log, Zeek http.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for processes like `curl`, `wget`, `powershell.exe` executing commands related to downloading files (e.g., `Invoke-WebRequest`, `IEX`). Correlate these events with network connections from these processes recorded in Zeek logs. Identify rare combinations of process, command line, and destination IP using frequency analysis."
          },
          "Detection of uncommon data flows (upload-heavy) or connections to unusual ports/services from internal hosts.": {
            "Data": "Zeek conn.log, Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for connections from internal hosts to external IPs on unusual ports or protocols (e.g., unexpected FTP connections, connections to known C2 ports). Use statistical analysis on Zeek conn.log byte counts (e.g., `orig_bytes`, `resp_bytes`) to identify sessions where the internal host (`id.orig_h`) receives significantly more data than it sends (`resp_bytes` is high relative to `orig_bytes`), particularly from external destinations (`id.resp_h` is external), potentially indicating ingress tool transfer. Use linear regression or correlation analysis to compare `orig_bytes` and `resp_bytes` for baselining and outlier detection."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]