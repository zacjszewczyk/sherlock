[
  {
    "Is the adversary evading detection by using extended attributes? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1564.014 - Extended Attributes": {
          "Execution of scripting interpreters or unusual processes commonly used as loaders for payloads hidden in extended attributes.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation. Identify instances where common scripting interpreters (powershell, cmd, wscript, cscript) or unusual processes are launched with command-line arguments indicative of decoding/executing embedded code. Use descriptive statistics on process launches per user/system to find outliers or use entropy analysis on command-line arguments to detect obfuscation."
          },
          "Network connections initiated by processes associated with potential xattr loaders to unusual or known malicious destinations.": {
            "Data": "Zeek conn.log; Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Zeek conn.log entries with process creation logs (Windows Event ID 4688) to identify network connections initiated by suspicious processes (potential loaders or their children). Filter connections to rare destination ports or IP addresses. Use correlation analysis to link specific process launches to network activity and compare against baseline network behavior or known threat intelligence feeds."
          },
          "Execution of commands or scripts referencing extended attribute utilities (xattr, getfattr, setfattr) or attempting to manipulate file metadata unusually.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation events where the command line contains strings like 'xattr', 'getfattr', 'setfattr', or other keywords related to unusual file metadata manipulation, particularly in conjunction with scripting interpreters or uncommon utilities. Analyze the context (parent process, user, file paths) for suspicious activity. Use frequency analysis to identify rare command line arguments or program executions related to file attributes."
          },
          "Unusual resource access or immediate follow-on network activity initiated by child processes spawned by known or suspected xattr loader processes.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify child processes spawned by processes previously flagged as potential xattr loaders (from other evidence) using Windows Event ID 4688 (parent/child relationship). Monitor these child processes for suspicious command line arguments (Windows Event ID 4688), attempts to access sensitive files or registry keys (if auditing is enabled), or immediate network connections via Zeek conn.log (correlating process info if available from EDR). Use correlation analysis to link parent loader process to child process activity and subsequent network connections. Flag children exhibiting high entropy command lines or connections to unusual/rare destinations using descriptive statistics."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]