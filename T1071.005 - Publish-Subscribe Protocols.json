[
  {
    "Is the adversary using publish-subscribe protocols for command and control? (TA0011 - Command and Control)": {
      "Indicators": {
        "T1071.005 - Publish-Subscribe Protocols": {
          "Unusual volume or pattern of network traffic using known pub/sub ports or protocols (MQTT, XMPP, AMQP, STOMP).": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections using known pub/sub ports (e.g., MQTT default 1883/8883, XMPP default 5222/5223) or identified via Zeek protocol detection. Use time series analysis to baseline normal traffic volume and frequency for these protocols and flag significant deviations."
          },
          "Communication to/from internal systems to external, untrusted servers acting as potential pub/sub brokers using these protocols.": {
            "Data": "Zeek conn.log, Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify internal systems communicating with external IPs using pub/sub protocols (via Zeek logs). Correlate destination IPs with DNS logs (Zeek dns.log) to identify domain names. Use threat intelligence feeds to check if destination IPs/domains are known malicious or suspicious brokers. Investigate communication patterns (e.g., correlation analysis of internal source IPs with external destinations)."
          }
        }
      }
    }
  }
]