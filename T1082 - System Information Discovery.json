[
  {
    "Is the adversary gathering system information about the network or hosts? (TA0007 - Discovery)": {
      "Indicators": {
        "T1082 - System Information Discovery": {
          "Execution of system information gathering commands (e.g., systeminfo, df -aH, show version) or API calls to query system details.": {
            "Data": "Windows Event ID 4688, Zeek dce_rpc.log, Zeek http.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creations with command lines containing system information gathering commands (e.g., 'systeminfo', 'cmd.exe /c systeminfo', 'powershell.exe -command Get-ComputerInfo', 'wmic cs product get name'). Identify and flag executions by suspicious processes or with unusual parameters. Monitor Zeek logs (dce_rpc.log, http.log) for patterns indicative of automated system queries, potentially using correlation analysis between source IPs and frequency of these queries."
          },
          "System information discovery commands or API calls originating from unexpected users, processes, or locations.": {
            "Data": "Windows Event ID 4688, Windows Event ID 4624, Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Windows Event ID 4688 events for system information commands (as in Evidence 1) and correlate them with user accounts (Event ID 4624) and source IPs (Zeek conn.log). Use descriptive statistics and entropy measures on the frequency and location of these commands across users and endpoints over time to identify outliers or unusual concentrations of activity."
          }
        }
      }
    }
  }
]