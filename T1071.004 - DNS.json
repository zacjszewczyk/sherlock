[
  {
    "Is the adversary communicating with external infrastructure using DNS tunneling? (TA0011 - Command-And-Control)": {
      "Indicators": {
        "T1071.004 - DNS": {
          "Client sending significantly more data than it receives via DNS queries.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek dns.log. For each client IP, compare the byte counts of DNS queries sent (client->server) vs. responses received (server->client). Identify clients with a high ratio of bytes sent to bytes received using descriptive statistics (mean, median, IQR) and flag outliers."
          },
          "DNS queries to known-bad or suspicious domains or with anomalous content/syntax.": {
            "Data": "Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek dns.log. Compare queried domain names against internal lists of known-bad domains (threat intelligence) using inner joins. Analyze query content (e.g., QNAME) for unusually long or complex structures, high entropy, or suspicious characters using entropy measures or correlation analysis with known bad patterns."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]