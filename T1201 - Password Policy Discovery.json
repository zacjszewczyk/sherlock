[
  {
    "Is the adversary attempting to discover network password policies? (TA0007 - Discovery)": {
      "Indicators": {
        "T1201 - Password Policy Discovery": {
          "Execution of command-line utilities (net accounts, Get-ADDefaultDomainPasswordPolicy, chage, cat /etc/pam.d/common-password, pwpolicy) associated with password policy discovery on hosts.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 logs for process creations containing command lines with `net accounts`, `Get-ADDefaultDomainPasswordPolicy`, `chage`, `cat /etc/pam.d/common-password`, or `pwpolicy`. Analyze frequency of execution per host/user. Flag executions from low-frequency users or hosts, or those occurring outside normal business hours using frequency analysis or time series analysis."
          },
          "Network traffic or process execution indicative of tools or scripts querying password policy via APIs or network device interactions.": {
            "Data": "Zeek http.log, Zeek syslog.log, Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek http.log for connections containing strings related to cloud password policy APIs (e.g., 'GetAccountPasswordPolicy'). Monitor Zeek syslog.log for messages originating from network devices containing password policy command strings (`show aaa`). Monitor Windows Event ID 4688 for execution of tools/scripts potentially used for API calls or network device interaction. Analyze source IPs/hosts and destination. Use correlation analysis to link this activity with other suspicious network flows or host events."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]