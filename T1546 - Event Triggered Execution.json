[
  {
    "Is the adversary establishing persistence via event triggered execution? (TA0003 - Persistence)": {
      "Indicators": {
        "T1546 - Event Triggered Execution": {
          "Creation or modification of persistence mechanisms like registry Run keys, Startup folders, or WMI event subscriptions.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 (Registry Value Set) for changes to common persistence keys (e.g., Run keys). Monitor WMI event-related logs for new consumers or filters. Use time series analysis to identify bursts of configuration changes inconsistent with normal administrative activity. Correlate configuration changes with initiating process (Event ID 4688) and subsequent network connections (Zeek conn.log)."
          },
          "Execution of unusual programs or scripts by event trigger processes (e.g., svchost.exe, winlogon.exe) or during logon events.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4624; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688. Filter for child processes spawned by common event-trigger parent processes (e.g., 'svchost.exe' with specific parameters) or processes starting around successful logon events (Event ID 4624). Analyze command lines, file paths, and hashes. Calculate the frequency of specific command lines or file paths per parent process; flag low-frequency occurrences using percentiles. Correlate execution with outbound network connections using Zeek conn.log."
          },
          "Addition of suspicious values to registry keys known for event-triggered execution outside of standard administrative processes.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for additions or modifications to registry paths associated with event-triggered execution (e.g., 'HKCU\\Environment', 'HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell'). Filter for changes where the 'NewValue' contains paths to unusual executables, scripts, or commands. Correlate with Windows Event ID 4688 to identify the process making the change. Establish a baseline of normal changes and flag deviations using frequency analysis."
          },
          "Suspicious process behavior (e.g., network connections, child process creation) originating from processes that typically load malicious DLLs via event triggers.": {
            "Data": "Windows Event ID 4688; Windows Event ID 5156; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for processes commonly targeted by DLL hijacking or that host malicious modules via event triggers (e.g., 'explorer.exe', 'svchost.exe'). Analyze child processes spawned by these processes or outbound network connections (Windows Event ID 5156, Zeek conn.log) originating from them, especially if unusual or unexpected. Correlate with registry modification events (Event ID 4657) that might indicate DLL registration for hijacking or COM hijacking. Use frequency analysis or baselining to identify deviations in child processes or network destinations."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary elevating privileges via event triggered execution? (TA0004 - Privilege-Escalation)": {
      "Indicators": {
        "T1546 - Event Triggered Execution": {
          "Processes with suspicious command lines or file paths executing under high-privilege accounts (SYSTEM, Service Accounts) via event triggers.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688. Filter for process creation events where the 'SubjectLogonId' or 'SubjectUserName' corresponds to SYSTEM or common service accounts. Review 'CommandLine' and 'NewProcessName' for suspicious patterns, known malicious tools, or activity inconsistent with the account's normal function. Use entropy analysis on command lines to identify potentially obfuscated code execution."
          },
          "Outbound network connections originating from processes that are normally passive or triggered by events, especially when running with high privileges.": {
            "Data": "Zeek conn.log; Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Zeek conn.log events with Windows Event ID 4688 using timestamps and source IP addresses. Identify network connections initiated by processes known to be used for event-triggered execution (e.g., svchost.exe hosting a WMI consumer, unusual processes started at logon). Focus investigation on connections from processes running under SYSTEM or service accounts. Join with threat intelligence feeds to identify connections to known malicious infrastructure."
          },
          "Modification of event trigger configurations (e.g., WMI subscriptions, Task Scheduler tasks, registry keys) by processes running as a lower-privileged user, followed by execution under a higher-privileged account.": {
            "Data": "Windows Event ID 4657; Windows Event ID 4688; Windows Event ID 4624",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4657 for changes to registry paths used for event triggers (Task Scheduler settings in registry, WMI persistence keys, etc.). Record the 'SubjectUserSid' or 'SubjectUserName' of the process making the change. Correlate these modification events with subsequent process creation events (Event ID 4688) where the process name/command line matches the trigger configuration and the 'SubjectLogonId' or 'SubjectUserName' corresponds to a high-privilege account (SYSTEM, Service Accounts). Use correlation analysis to link the low-priv modification with the high-priv execution."
          },
          "Execution of known discovery or system survey commands/tools (e.g., whoami, systeminfo, ipconfig, PowerShell scripts) by processes running under high-privilege accounts, originating from event triggers.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation events. Filter for events where the 'SubjectLogonId' or 'SubjectUserName' indicates a high-privilege account (SYSTEM, Service Accounts). Analyze the 'CommandLine' for execution of common Windows built-in commands or scripting tools often used for discovery ('whoami', 'systeminfo', 'tasklist', 'netstat', 'ipconfig', 'powershell.exe', 'cmd.exe'). Identify process call trees by correlating ParentProcessId and NewProcessId to determine if these commands were spawned by processes associated with event triggers. Use frequency analysis to identify rare command executions under these high-privilege accounts."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]