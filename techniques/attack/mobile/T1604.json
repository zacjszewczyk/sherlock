[
  {
    "information_requirement": "Is an adversary using a managed mobile device as a proxy to conceal C2 communications or other malicious activity, such as masquerading traffic to evade IP-based restrictions? (PIR) [1]",
    "tactic_id": "TA0030",
    "tactic_name": "Defense Evasion",
    "indicators": [
      {
        "technique_id": "T1604",
        "name": "Proxy Through Victim",
        "evidence": [
          {
            "description": "A managed mobile device exhibits a statistically significant increase in total outbound data volume over a defined time window (e.g., 1 hour, 24 hours) compared to its historical baseline or its peer group's baseline, suggesting its use as a data relay. This is particularly suspicious if the volume cannot be attributed to legitimate activities like OS updates, large application downloads, or cloud backups.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate Wi-Fi network segments, VPN gateways, and network egress points monitoring traffic from mobile device subnets.",
            "action": "1. (Symbolic) From Zeek conn.log, create a high-severity alert if a single mobile device's total outbound data transfer, as measured by the sum of `orig_bytes`, exceeds a tuned threshold (e.g., 10 GB in 1 hour) that is considered implausible for legitimate use. This threshold should be set after baselining and should exclude traffic to known corporate backup or OS update servers. 2. (Statistical) For each mobile device (`id.orig_h`), aggregate the sum of outbound bytes (`orig_bytes`) from Zeek conn.log over 1-hour and 24-hour windows. Establish a per-device baseline using a 30-day moving average and standard deviation. Generate an alert when a device's outbound traffic exceeds 3 standard deviations from its own mean, or exceeds the 99th percentile of its assigned user group (e.g., 'Sales Team Mobiles'). 3. (Machine Learning) Implement a time-series anomaly detection model (e.g., Seasonal-ARIMA, Prophet) for each device's outbound data volume (`orig_bytes`). Train the model on at least 90 days of historical data to learn individual user patterns and seasonality. Generate an alert when the actual observed volume significantly deviates from the model's predicted volume and falls outside its confidence interval."
          },
          {
            "description": "A mobile device resolves or connects to a statistically anomalous number of unique destination domains or IP addresses within a short time frame. The set of destinations exhibits high Shannon entropy, which is uncharacteristic of normal user activity and may indicate its use as a proxy for multiple disparate clients.",
            "data_sources": [
              "Zeek dns.log",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internal DNS servers, network firewalls, and web proxies that log DNS queries and outbound connections from mobile devices.",
            "action": "1. (Symbolic) From Zeek dns.log, maintain an allowlist of high-frequency domains (e.g., CDNs, OS updates, major social media). Create an alert for any mobile device that queries a high number of unique domains (e.g., >100) not on this list within a 5-minute window, especially if those domains are newly observed across the enterprise. 2. (Statistical) For each mobile device (`id.orig_h`), count the number of unique second-level domains (SLDs) queried in Zeek dns.log (`query` field) over a 1-hour window. Concurrently, calculate the Shannon entropy of the set of these SLDs. Generate an alert if a device's unique domain count exceeds the 98th percentile of its peer group AND its domain entropy score is also anomalously high (e.g., >2 standard deviations above its own 30-day baseline). 3. (Machine Learning) Train an Isolation Forest model using features derived from Zeek dns.log and conn.log for each device over a 1-hour window. Key features should include: unique destination IP count, unique DNS query count, Shannon entropy of destination SLDs, ratio of successful to failed DNS queries (`rcode` != 'NOERROR'), and ratio of successful to failed TCP connections (`conn_state` != 'SF'). Flag any device the model classifies as a significant outlier for analyst review."
          },
          {
            "description": "A mobile device initiates network connections using destination ports or protocols that are a) commonly associated with proxies (e.g., SOCKS on port 1080) or b) inconsistent with the device's established baseline behavior or its MDM/EMM-defined application profile.",
            "data_sources": [
              "Zeek conn.log",
              "MDM/EMM Application Inventory"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network flow collectors at egress points, firewall logs, and MDM/EMM management platforms.",
            "action": "1. (Symbolic) Create a high-priority alert for any traffic from the mobile device subnet (`id.orig_h` in Zeek conn.log) to common proxy-related destination ports, such as 1080 (SOCKS), 3128, 8080, or 8888. This rule should have exceptions for approved internal services or traffic associated with an approved application from an MDM inventory. 2. (Statistical) For each device, establish a baseline set of 'normal' destination ports (`id.resp_p` in Zeek conn.log) used over a 30-day period. In a 1-hour window, calculate the ratio of connections to 'rare' ports (ports not in the baseline set) versus 'common' ports. Generate an alert when this ratio exceeds the 95th percentile for the device's peer group, indicating a shift in traffic patterns. 3. (Machine Learning) Train a one-class SVM (Support Vector Machine) model on historical connection data tuples (destination port, protocol, `orig_bytes`) for each device or device group to learn the profile of 'normal' traffic. Apply the model to live traffic; connections classified as anomalies, especially those involving non-standard ports or protocols for that device, should be flagged for investigation."
          },
          {
            "description": "A mobile device maintains an anomalously high number of concurrent outbound connections or has individual connections with unusually long durations, which is characteristic of a device acting as a persistent relay or proxy for C2 traffic or other tunneled activity.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network flow collectors (e.g., Zeek sensors) at key chokepoints like the Wi-Fi access controller or VPN concentrator.",
            "action": "1. (Symbolic) From Zeek conn.log, generate an alert for any single TCP connection from a mobile device (`id.orig_h`) that has a `duration` greater than 24 hours, where the `conn_state` is 'SF' (Established), especially if the destination IP is not an established corporate service or known cloud provider and has a low reputation score. 2. (Statistical) In 5-minute intervals, for each device, calculate two metrics from Zeek conn.log: a) the count of concurrent outbound connections and b) the average `duration` of connections that terminated in that interval. Use a multivariate outlier detection method, like Mahalanobis distance, to identify devices that are anomalous in both metrics simultaneously (e.g., high count and long duration) compared to their own 30-day historical profile. 3. (Machine Learning) Apply a density-based clustering algorithm like DBSCAN to the population of mobile devices. Use features calculated over a 24-hour period from Zeek conn.log, such as 'average concurrent outbound connections,' '95th percentile of connection duration,' and 'total outbound bytes.' Devices that are classified as noise points (i.e., not belonging to any cluster) are strong candidates for investigation as they exhibit behavior distinct from the general population."
          }
        ]
      }
    ],
    "last_updated": "2025-09-29",
    "version": "1.3",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]