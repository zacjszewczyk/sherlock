[
  {
    "information_requirement": "Is an adversary attempting to discover the physical location of our managed mobile devices through anomalous administrative access? (PIR)",
    "tactic_id": "TA0032",
    "tactic_name": "Discovery",
    "indicators": [
      {
        "technique_id": "T1430.001",
        "name": "Remote Device Management Services",
        "evidence": [
          {
            "description": "A successful administrative authentication to an EMM/MDM console (e.g., Windows Event ID 4624 with Logon Type 3 or 10) is observed with multiple concurrent anomalies. These include: 1) The source IP address is present on a threat intelligence feed of known malicious hosts. 2) The source IP's geolocation (country/ASN) is new for that specific user based on a 90-day lookback profile. 3) The login time falls outside the user's typical 5th-95th percentile of activity hours. 4) The TLS client fingerprint (JA3 hash from Zeek ssl.log) is new or has a low prevalence score for the user account. 5) The HTTP user-agent string (from Zeek http.log or EMM/MDM logs) is anomalous or associated with known hacking tools.",
            "data_sources": [
              "Windows Event ID 4624",
              "EMM/MDM application logs",
              "Zeek conn.log",
              "Zeek ssl.log",
              "Zeek http.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "EMM/MDM web application servers, Authentication servers (e.g., Domain Controllers), Network egress points and web proxies, Administrative workstations and VDI environments",
            "action": "1. Symbolic Logic: Create a SIEM rule to generate a critical alert for any successful EMM/MDM administrative login (e.g., Windows Event ID 4624, Logon Type 3/10 to an MDM server) where the Source IP Address is present in an active threat intelligence list of malicious IPs. The correlation should be near real-time (within 5 minutes). 2. Statistical Analysis: For each EMM/MDM administrator, build and maintain a 90-day rolling baseline profile from authentication and Zeek logs. The profile must include: a) a set of known source countries/ASNs, b) a distribution of login hours (e.g., 5th-95th percentile), c) a set of known user-agent strings, and d) a set of known JA3 hashes. Trigger a medium-risk alert if a successful login deviates on one dimension (e.g., new country). Trigger a high-risk alert if the login deviates on two or more dimensions simultaneously. 3. Machine Learning: Train an unsupervised anomaly detection model (e.g., Isolation Forest) on historical successful EMM/MDM administrative logins. Engineer features including: source ASN, source country (one-hot encoded), time of day and day of week (using sin/cos transformations), user-agent string (using a hashing vectorizer), and JA3 hash. Score each new successful login in real-time; logins with an anomaly score in the top 1% (99th percentile) should be flagged for immediate investigation as a likely compromised account."
          }
        ]
      }
    ],
    "last_updated": "2025-09-29",
    "version": "1.3",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  },
  {
    "information_requirement": "Is an adversary actively collecting location data from our managed mobile devices via remote management services? (PIR)",
    "tactic_id": "TA0035",
    "tactic_name": "Collection",
    "indicators": [
      {
        "technique_id": "T1430.001",
        "name": "Remote Device Management Services",
        "evidence": [
          {
            "description": "An anomalous pattern of device location queries from a single administrative account is observed in EMM/MDM application logs. This is evidenced by: 1) The rate of location API calls from the account exceeds the 99th percentile for all admin users over a rolling 1-hour window. 2) The count of unique devices whose location is queried by the account exceeds its own 95th percentile baseline. 3) The time delta between consecutive location queries from the same source IP exhibits abnormally low entropy, suggesting scripted activity, such as $$ H(X) < 2.0 $$. 4) Location queries are disproportionately focused on high-value target groups (e.g., 'Executives', 'R&D').",
            "data_sources": [
              "EMM/MDM application logs",
              "Zeek http.log",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "EMM/MDM web application servers, Network egress points and web proxies, Cloud service access points (for iCloud/Google Find My)",
            "action": "1. Symbolic Logic: Using EMM/MDM application logs or Zeek http.log, create a rule that triggers a high-priority alert if a single user account or source IP makes more than a fixed threshold of requests (e.g., 50) to the device location API endpoint (e.g., POST /api/v2/devices/locate) within a 1-hour period. The rule should be expressed as: `COUNT(requests) WHERE uri_path='/api/v2/devices/locate' GROUP BY user, source_ip, WINDOW:1h HAVING COUNT > 50`. 2. Statistical Analysis: From EMM/MDM application logs, establish a 30-day rolling baseline for each admin user on: a) the number of unique devices located per hour, and b) the Shannon entropy of the time intervals between their location requests. Generate a medium-risk alert if a user exceeds the 98th percentile for unique devices located compared to their peers. Generate a high-risk alert if the time-interval entropy for a user's session drops below a statistically derived threshold (e.g., less than 2.0 for a session with >10 requests), indicating highly repetitive, automated querying. 3. Machine Learning: Implement a multivariate time-series anomaly detection model (e.g., VAR - Vector Autoregression) on minute-by-minute aggregations of EMM/MDM platform activity. The model should track multiple series simultaneously: a) total count of location API calls, b) number of unique users making calls, and c) number of unique devices being located. An alert should be generated when the observed state of the system deviates significantly from the model's forecast (e.g., Mahalanobis distance exceeds a 99% confidence threshold), which can detect both large-scale and distributed collection efforts."
          }
        ]
      }
    ],
    "last_updated": "2025-09-29",
    "version": "1.3",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]