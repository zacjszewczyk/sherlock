[
  {
    "information_requirement": "Has an adversary achieved persistence by modifying a client software binary on a mobile device? (PIR)",
    "tactic_id": "TA0028",
    "tactic_name": "Persistence",
    "indicators": [
      {
        "technique_id": "T1645",
        "name": "Compromise Client Software Binary",
        "evidence": [
          {
            "description": "A managed mobile device fails a remote integrity check, indicated by an explicit failure verdict in attestation logs. Observable artifacts include Google Play Integrity API responses where the `deviceIntegrity` verdict does not include `MEETS_DEVICE_INTEGRITY` or `MEETS_STRONG_INTEGRITY` [1], or a comparable failed result from the Samsung Knox Attestation API, directly indicating a compromised system partition or bootloader.",
            "data_sources": [
              "Mobile Device Management (MDM) logs",
              "Google Play Integrity API logs",
              "Samsung Knox Attestation logs",
              "Zeek conn.log",
              "Zeek ssl.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Managed mobile device fleet, Mobile Device Management (MDM) Platform, cloud-based attestation service endpoints (e.g., Google Cloud Platform, Samsung Knox services), and network egress points.",
            "action": [
              "Implement a high-severity detection rule in the SIEM to trigger upon ingestion of any attestation log where the Google Play Integrity `deviceIntegrity` verdict is not `MEETS_DEVICE_INTEGRITY` or `MEETS_STRONG_INTEGRITY`, or a comparable failure status is received from a Samsung Knox attestation.",
              "Using a scheduled query that runs every 6 hours, calculate the attestation failure rate as a percentage of total checks, segmented by device model, OS version, and geographic region. Generate a medium-severity alert if the failure rate for any segment exceeds the 99th percentile of its 30-day historical baseline.",
              "Upon a high-severity attestation failure alert, automatically execute a SOAR playbook to query all network connection logs (Zeek conn.log, ssl.log) from the failed device for the preceding 72 hours. Use a pre-trained gradient boosting classifier to score each destination FQDN/IP based on features including domain entropy, SSL certificate issuer rarity, JA3/JA3S hash prevalence, and threat intelligence reputation. Escalate the incident to critical if the device communicated with any destination having a model score greater than 0.9."
            ]
          },
          {
            "description": "A mobile device exhibits anomalous network behavior, evidenced by one or more of the following: connections to known malicious C2 infrastructure from threat intelligence feeds, DNS queries for domains with Shannon entropy scores indicative of Domain Generation Algorithms (DGAs), or statistically significant deviations in data transfer volumes or protocol distributions from its established baseline.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log",
              "Zeek ssl.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate Wi-Fi network gateways, VPN terminators, and Cloud Access Security Brokers (CASB).",
            "action": [
              "Create a SIEM detection rule to continuously match destination IP addresses (`id.resp_h` in Zeek conn.log) and Server Name Indication (`server_name` in Zeek ssl.log) against a high-fidelity threat intelligence feed of known C2 servers. Generate a high-severity alert on any match.",
              "For each DNS query in Zeek dns.log, calculate the Shannon entropy of the queried domain name. Generate a medium-severity alert for any device that issues a query with an entropy score above the 98th percentile of the mobile fleet's 30-day baseline. Additionally, monitor the ratio of outbound to inbound bytes (`orig_bytes` / `resp_bytes`) in Zeek conn.log; alert if this ratio exceeds 10:1 for connections lasting more than 60 seconds, which can indicate data exfiltration.",
              "For each mobile device, train a one-class SVM or isolation forest model on a feature set derived from its typical network behavior over a 30-day period. Features must include daily outbound data volume, count of unique destination IPs, distribution of destination ports, and average connection duration from Zeek conn.log. Score daily activity against the model; an anomaly score indicating an outlier should generate a medium-severity alert for analyst review and investigation."
            ]
          },
          {
            "description": "The presence of an anomalously high crash rate or unexpected error logs for a legitimate, high-privilege system application or a managed corporate application on a specific device, suggesting instability caused by unauthorized modification of the underlying binary.",
            "data_sources": [
              "Mobile Device Management (MDM) logs",
              "Mobile Application Management (MAM) logs",
              "Application crash reporting logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Centralized MDM/MAM platform and cloud-based application performance monitoring (APM) or crash reporting services.",
            "action": [
              "Configure a high-severity alert in the MDM or application monitoring platform to trigger immediately if any crash is reported for a critical, allow-listed system application (e.g., `com.android.settings`, `com.android.phone`) on any managed device.",
              "On a daily basis, calculate the crash rate (crashes per 1000 sessions) for each managed corporate application, segmented by app version and device model. Generate a medium-severity alert if an individual device's crash rate for a specific app exceeds the 99.5th percentile of the fleet's 30-day historical baseline for that same app and version.",
              "Implement a time series anomaly detection model (e.g., ARIMA or Prophet) to forecast the expected daily crash count for critical applications across the device fleet. Generate a medium-severity alert when the actual crash count significantly exceeds the model's forecasted upper confidence interval, indicating a fleet-wide deviation that could signify a widespread issue from a compromised binary update."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "1.4",
    "date_created": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]