[
  {
    "information_requirement": "Is an adversary attempting to discover Wi-Fi network information on our managed mobile devices? (PIR)",
    "tactic_id": "TA0032",
    "tactic_name": "Discovery",
    "indicators": [
      {
        "technique_id": "T1422.002",
        "name": "Wi-Fi Discovery",
        "evidence": [
          {
            "description": "An application on a mobile device is observed making an unusual number of API calls to retrieve saved Wi-Fi network configurations (SSIDs, BSSIDs, passwords), which is anomalous for the specific application or user.",
            "data_sources": [
              "Mobile Device Management (MDM) API monitoring logs",
              "Endpoint Detection and Response (EDR) for Mobile logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate-managed mobile devices (iOS, Android)",
            "action": "Establish a baseline of normal API calls related to Wi-Fi configuration access (e.g., WifiManager.getConfiguredNetworks() on Android) for approved corporate applications. Monitor for deviations, such as non-standard applications making these calls or approved apps making calls with unusually high frequency. Use a statistical model to flag apps whose call frequency exceeds the 99th percentile of their historical behavior. An alert should be triggered for any app attempting to enumerate and then exfiltrate a list of Wi-Fi profiles."
          },
          {
            "description": "A mobile device is observed performing active network scanning on a Wi-Fi network shortly after connecting. This activity is inconsistent with the device's normal traffic patterns and may indicate an adversary mapping the local network environment.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek notice.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate and guest Wi-Fi network segments",
            "action": "For each mobile device IP address, monitor connection logs (Zeek conn.log) to establish a baseline of typical network behavior (e.g., number of unique destination IPs and ports per minute). Use a sliding time window to detect sudden spikes in connection attempts to multiple IPs or ports on the local /24 subnet. Calculate the entropy of destination ports for a given source IP over a 1-minute interval; a high entropy score can indicate port scanning. Correlate scan detections (e.g., from Zeek notice.log) with device identity from DHCP or RADIUS logs to pinpoint the specific mobile device responsible."
          },
          {
            "description": "A process on a mobile device accesses local files known to store Wi-Fi credentials (e.g., wpa_supplicant.conf on Android, keychain on iOS) and is immediately followed by an outbound network connection to an unknown or suspicious destination.",
            "data_sources": [
              "Mobile EDR/MDM file integrity monitoring logs",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Corporate-managed mobile devices and Network Egress Points",
            "action": "Using a mobile EDR/MDM solution, create a rule to monitor for and alert on any unauthorized process attempting to read files or database entries storing Wi-Fi configurations. Correlate a file/keychain access alert with subsequent network connections (Zeek conn.log) from the same device within a 60-second window. Analyze the destination of the outbound connection; check the requested domain (Zeek dns.log) against a list of high-reputation domains and organizational baselines. A connection to a low-prevalence domain or a direct-to-IP connection following a critical file access is a high-confidence indicator of credential theft."
          }
        ]
      }
    ],
    "version": "1.0",
    "date_created": "2025-09-26",
    "last_updated": "2025-09-26",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]