[
  {
    "information_requirement": "Is an adversary using valid accounts to move laterally between ICS assets? (PIR)",
    "tactic_id": "TA0109",
    "tactic_name": "Lateral Movement",
    "indicators": [
      {
        "technique_id": "T0859",
        "name": "Valid Accounts",
        "evidence": [
          {
            "description": "Successful authentication event (Windows Event ID 4624) on a critical ICS host where the source IP address (from Zeek conn.log) is not part of the established, authorized origin-destination-account pairings for that specific ICS asset and user/service account.",
            "data_sources": [
              "Windows Event ID 4624",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Programmable Logic Controllers (PLCs), Remote Terminal Units (RTUs), Historian Servers, Active Directory/Authentication servers, Network switches/routers in critical OT segments, IT/OT DMZ gateways.",
            "action": "1. Symbolic Logic: Create an explicit allow-list of known, authorized (source_ip, destination_ip, account_name) tuples for successful Windows logins (Event ID 4624). For each successful login, correlate the source IP from Zeek conn.log (id.orig_h) with the login event. Generate a high-priority alert if the observed (id.orig_h, DestinationIP, TargetAccount) combination does not exist in the predefined allow-list. 2. Statistical Method: For each (Destination_IP, TargetAccount) pair from Windows Event ID 4624, calculate the historical frequency of unique Source_IP addresses (from Zeek conn.log id.orig_h) over the past 90 days. Identify login events where the Source_IP is new for that specific pair, or where its historical frequency for that pair is below the 5th percentile of all observed source IPs for that pair. Generate an alert for such statistically rare or novel login attempts. 3. Machine Learning: Develop a supervised classification model (e.g., Random Forest) using features like Source_IP (geohash, subnet), Destination_IP, TargetAccount, Time_of_Day, Day_of_Week, and historical login frequency for the Source_IP-Destination_IP-Account triplet. Train the model on labeled historical data (normal vs. anomalous logins). Score new login events for anomaly likelihood, prioritizing those exceeding a 0.7 anomaly score for immediate investigation."
          },
          {
            "description": "Network connections (Zeek conn.log) utilizing administrative protocols (e.g., RDP on port 3389, WinRM on ports 5985/5986, SSH on port 22, SMB on ports 445/139) between critical ICS hosts where the originating host, destination host, or associated user account (correlated via Windows Event ID 4624) is outside of explicitly defined administrative access policies or typical operational behavior.",
            "data_sources": [
              "Windows Event ID 4624",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network switches and routers in critical OT segments, Firewalls at network boundaries (e.g., IT/OT DMZ), Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Jump Servers, Remote Access Gateways.",
            "action": "1. Symbolic Logic: Identify Zeek conn.log entries where service is 'rdp', 'winrm', 'ssh', or 'smb' (or id.resp_p is 3389, 5985, 5986, 22, 445, 139) and both id.orig_h and id.resp_h are critical ICS assets. Correlate with Windows Event ID 4624 for the user account. Compare the (Source_IP, Destination_IP, User_Account, Protocol) against a predefined 'ICS Administrative Access Control Matrix'. Generate a critical alert for any connection violating this matrix. 2. Statistical Method: For each (Source_IP, Destination_IP, User_Account, Protocol) tuple involving administrative protocols, calculate the historical 7-day rolling average and standard deviation of connection counts (from Zeek conn.log) over the past 90 days. Generate a high-priority alert if the current connection count for a tuple exceeds 3 standard deviations above its rolling average or is above the 99th percentile of its historical distribution, indicating anomalous administrative activity. 3. Machine Learning: Employ a time-series anomaly detection model (e.g., Prophet or ARIMA with anomaly detection) on the hourly volume of administrative protocol connections (RDP, WinRM, SSH, SMB) between critical ICS hosts, segmented by (Source_IP, Destination_IP) and (User_Account, Destination_IP). Train the model on 90 days of historical data. Flag and alert on significant deviations (e.g., 95% prediction interval violation) from the predicted normal patterns, indicating unusual administrative activity."
          }
        ]
      }
    ],
    "version": "1.2",
    "date_created": "2025-09-26",
    "last_updated": "2025-09-29",
    "contributors": [
      "Zachary Szewczyk"
    ]
  },
  {
    "information_requirement": "Has an adversary created or compromised a valid account for persistent access to the ICS environment? (PIR)",
    "tactic_id": "TA0110",
    "tactic_name": "Persistence",
    "indicators": [
      {
        "technique_id": "T0859",
        "name": "Valid Accounts",
        "evidence": [
          {
            "description": "Successful creation of a new user account (Windows Event ID 4720) on a critical ICS asset (e.g., Engineering Workstation, HMI, Domain Controller, Historian Server) where the account name, creation time, or creating process is anomalous compared to established baselines, or which lacks correlation with an approved change management record.",
            "data_sources": [
              "Windows Event ID 4720"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Active Directory/LDAP servers, Local security logs on EWS/HMIs/Historian Servers, Configuration management systems for PLCs/RTUs (if applicable), Patch Management/Change Management systems.",
            "action": "1. Symbolic Logic: Immediately alert on any Windows Event ID 4720 (A user account was created) on critical ICS assets. Filter for account creations occurring outside of predefined maintenance windows. Enrich the alert with context from a configuration management database or change management system to verify if the account creation was authorized. Additionally, compare the TargetAccountName against a blacklist of unauthorized or default accounts and check for fuzzy matches (e.g., Levenshtein distance < 2) to existing legitimate accounts. 2. Statistical Method: Establish baselines for the normal frequency of user account creations (Windows Event ID 4720) per day/week, and for characteristics of created accounts (e.g., account name length, presence of special characters, creating process name) on critical ICS assets over the last 180 days. Generate an alert if the number of new accounts created within 24 hours exceeds the 99th percentile of historical frequency, or if characteristics of the new account (e.g., creating process is atypical, account name entropy is high) fall outside 3 standard deviations from the mean. 3. Machine Learning: Train a supervised classification model (e.g., Gradient Boosting Classifier) on historical Windows Event ID 4720 data. Use features such as TargetAccountName (entropy, length, similarity to existing accounts), CreatorProcessName, CreationTime (hour of day, day of week), and the destination host. Label known legitimate account creations (e.g., via change management integration) as 'normal'. Use the model to predict the likelihood of new account creations being anomalous, alerting on events with an anomaly score above a dynamic threshold (e.g., top 1% of scores)."
          },
          {
            "description": "Successful authentication event (Windows Event ID 4624) by a privileged OT user account to a critical ICS asset where the source IP address (from Zeek conn.log) is not within the predefined authorized IP ranges for remote access (e.g., VPN subnets, jump server IPs) or originates from an unauthorized network segment (e.g., direct IT to OT access bypassing DMZ).",
            "data_sources": [
              "Windows Event ID 4624",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "VPN concentrators, Jump servers, Firewalls (IT/OT boundary), Active Directory/Authentication servers, Network switches/routers in critical OT segments, Endpoint devices (EWS, HMIs, Historian Servers).",
            "action": "1. Symbolic Logic: Correlate successful login events (Windows Event ID 4624) on critical ICS assets with the source IP (id.orig_h) from Zeek conn.log. Maintain a strict allow-list of authorized source IP ranges (e.g., VPN subnets, jump server IP pools, designated OT management subnets) for privileged OT accounts accessing ICS assets. Generate a critical alert for any successful login by an OT-privileged account where the source IP address is not on this allow-list, indicating unauthorized external or internal access. 2. Statistical Method: For each OT-privileged user account, establish a baseline of typical login source IP subnets, login times (hour of day, day of week), and destination assets over the last 90 days using Windows Event ID 4624 and Zeek conn.log. Calculate a multi-factor deviation score for each new login event, considering factors like: Source_IP not observed before for the user (high score), login outside typical hours (medium score), or login to an unusual destination asset (medium score). Alert when the cumulative deviation score for a login event exceeds the 99th percentile of historical deviation scores for that user, indicating a statistically anomalous access attempt. 3. Machine Learning: Deploy an unsupervised anomaly detection model (e.g., Isolation Forest or Autoencoder) on a feature set derived from successful login events (Windows Event ID 4624 correlated with Zeek conn.log). Features should include: Source_IP (subnet, entropy of previous usage), User_Account, Destination_IP, Protocol, Time_of_Day (encoded), Day_of_Week (encoded), and historical frequency of the Source_IP-Destination_IP-User_Account tuple. Train the model on 180 days of historical data to establish normal behavior. Flag login events with an anomaly score exceeding the 99th percentile as high-priority, indicating potentially compromised credentials or unauthorized access."
          }
        ]
      }
    ],
    "version": "1.2",
    "date_created": "2025-09-26",
    "last_updated": "2025-09-29",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]