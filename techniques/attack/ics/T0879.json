[
  {
    "information_requirement": "Has an adversary successfully executed an action that has resulted in, or is intended to cause, physical damage to operational technology property? (PIR)",
    "tactic_id": "TA0105",
    "tactic_name": "Impact",
    "indicators": [
      {
        "technique_id": "T0832",
        "name": "Manipulation of Control",
        "evidence": [
          {
            "description": "A write command, observed in network traffic (e.g., Zeek ICS protocol logs), directs a PLC/RTU to set a critical process parameter to a value that either exceeds a pre-defined absolute safety limit or deviates significantly (e.g., >3 standard deviations) from its statistically-derived operational baseline. This includes physically implausible combinations of commands (e.g., commanding a motor to maximum RPM while a cooling system is commanded off), or a rapid succession of opposing commands (e.g., open/close/open) to an actuator, designed to induce mechanical stress and failure. The event is not correlated with any scheduled maintenance or testing procedure.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek modbus.log",
              "Zeek dnp3.log",
              "Zeek enip.log",
              "Zeek opc_ua.log",
              "Windows Event ID 4688",
              "Windows Event ID 4624"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Process Control Network (PCN) segments, Safety Instrumented System (SIS) network segments, PLC/RTU network interfaces, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), SCADA Servers, Data Historian servers.",
            "action": "1. **Symbolic Logic (IOC Match):** Monitor ICS protocol logs (`modbus.log`, `dnp3.log`) for write commands targeting critical PLC registers with values outside documented safe operating limits. Maintain a list of read-only registers and alert on any write attempt. Additionally, monitor for multiple, rapidly succeeding, and opposing write commands to the same register/point address (e.g., write value 1, then 0, then 1 within <1 second). Alert if the frequency of such oscillations for a single actuator exceeds a predefined threshold (e.g., >3 oscillations in 5 seconds). 2. **Statistical Method:** For a set of correlated critical process parameters (e.g., temperature, pressure, flow rate), continuously calculate the Mahalanobis distance of the current state vector from the centroid of a baseline distribution of normal operating states. Alert when the distance exceeds the 99.9th percentile of the historical distance distribution, indicating a state that is anomalous in a multi-dimensional sense, even if individual parameters are within their own univariate limits. 3. **Machine Learning Application:** Train a Variational Autoencoder (VAE) on time-series data of critical process parameters from the data historian or protocol logs. Feed live process data into the trained VAE and monitor the reconstruction error. A sharp, sustained spike in reconstruction error indicates that the current process behavior does not match any previously observed normal pattern, suggesting a novel manipulation. The latent space of the VAE can also be clustered to identify distinct operational modes and flag transitions to an unknown or unsafe mode. 4. **Correlation:** Upon an alert, correlate the timestamp of the anomalous write command with network connection logs (`Zeek conn.log`) and user authentication/process logs (`Windows Event ID 4624`, `4688`) on the source HMI/EWS within a 10-minute window prior to the event to attribute the action to a specific user, session, and parent process."
          }
        ]
      },
      {
        "technique_id": "T0816",
        "name": "Device Restart/Shutdown",
        "evidence": [
          {
            "description": "An unexpected shutdown or restart of a critical ICS asset (HMI, EWS, SCADA Server) is recorded (e.g., Windows Event ID 6008, 1074) without a corresponding authorized change request or scheduled maintenance entry. This includes 'soft' shutdowns initiated by a user/process and 'hard' shutdowns resulting from a loss of power or system crash. The event is preceded by anomalous user activity (e.g., logon from an unusual location/time) or is part of a cascading failure sequence where the shutdown of one device triggers alarms or failures on dependent systems.",
            "data_sources": [
              "Windows Event ID 1074",
              "Windows Event ID 6008",
              "Windows Event ID 4624",
              "Windows Event ID 4648",
              "Zeek conn.log",
              "Zeek rdp.log",
              "Zeek smb.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Human-Machine Interfaces (HMIs), Process Historians, SCADA Servers, Engineering Workstations, Domain Controllers within the ICS environment, Network boundary sensors for ICS segments, Remote Terminal Units (RTUs) with logging capabilities.",
            "action": "1. **Symbolic Logic (IOC Match):** Create an alert that triggers on `Windows Event ID 1074` if the initiating process is `shutdown.exe` and its parent process is not `explorer.exe` or `svchost.exe` (indicating a potentially non-interactive or scripted shutdown), or if the initiating user account is not a member of the designated local or domain administrators group for that asset. 2. **Statistical Method:** For each critical asset, calculate a baseline for the Shannon entropy of the 'Shutdown Type' and 'Reason Code' fields within `Windows Event ID 1074` over a 90-day period. An alert is generated if the entropy for the current 24-hour period drops significantly, which could indicate an adversary repeatedly using the same non-standard shutdown method. Additionally, establish a baseline for the number of simultaneously active RDP sessions (`Zeek rdp.log`) on critical servers. Alert if a shutdown event is preceded by a spike in RDP sessions exceeding the 95th percentile of the historical hourly maximum. 3. **Machine Learning Application:** Train a Random Forest classifier to predict whether a shutdown event (`Windows Event ID 1074`) is malicious. Features should include: (1) initiating user's group memberships, (2) time of day (categorical: business hours, after hours, weekend), (3) source IP of the user's session (enriched with GeoIP and ASN data), (4) parent process of the shutdown command, (5) logon type (e.g., interactive, remote interactive) from the preceding `Windows Event ID 4624`, and (6) a binary flag indicating if a change ticket was open for the asset at that time. Flag predictions with a confidence score > 0.9 as high-priority alerts. 4. **Correlation:** On alert for an anomalous shutdown, automatically query logs for the 60 minutes prior to the event. Correlate the initiating user and host with any remote access logs (`Zeek rdp.log`), file transfer logs (`Zeek smb.log`), and process creation events (`Windows Event ID 4688`) to build a timeline of potential pre-shutdown adversary activity, such as staging of tools or privilege escalation."
          }
        ]
      }
    ],
    "version": "1.2",
    "date_created": "2025-09-25",
    "last_updated": "2025-09-29",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]