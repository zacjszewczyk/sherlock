[
  {
    "information_requirement": "Is an adversary attempting to inhibit response functions by blocking serial COM ports in the ICS environment?",
    "tactic_id": "TA0107",
    "tactic_name": "Inhibit Response Function",
    "indicators": [
      {
        "technique_id": "T0805",
        "name": "Block Serial COM",
        "evidence": [
          {
            "description": "A TCP connection to a specific serial-to-Ethernet converter port (e.g., TCP/20001) persists for a duration exceeding the 99th percentile of established baselines (e.g., > 1200 seconds) while demonstrating minimal data transfer (e.g., less than 50 bytes total), indicating a potential port reservation without legitimate communication.",
            "data_sources": [
              "Zeek conn.log",
              "Firewall connection logs"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network perimeter of the Process Control Network (PCN), Industrial Demilitarized Zone (IDMZ) gateways, Level 2/3 SCADA/DCS network segments hosting serial-to-Ethernet converters, and network segments directly connected to control system devices.",
            "action": "1. Symbolic Logic: Establish and maintain an inventory of all serial-to-Ethernet converter IP addresses and their corresponding listening TCP ports (e.g., 10.0.0.1:20001). In your SIEM, query Zeek conn.log for all successful TCP connections (conn_state = 'SF') where id.resp_h and id.resp_p match any known converter port. Filter these connections for duration greater than 1200 seconds AND orig_bytes + resp_bytes less than 50 bytes. Generate an immediate alert for any matching connections, noting the source IP (id.orig_h), destination (id.resp_h, id.resp_p), and connection details.\n2. Statistical Method: For each identified serial-to-Ethernet converter port, establish a rolling 30-day baseline of connection duration and total_bytes (orig_bytes + resp_bytes) for all conn_state = 'SF' connections. Calculate the 99th percentile for duration and the 1st percentile for total_bytes. Monitor new connections in Zeek conn.log. Flag any connection where the duration exceeds its historical 99th percentile AND the total_bytes falls below its historical 1st percentile. Additionally, calculate a z-score for both duration and total_bytes for each connection; alert if both z-scores are outside 3 standard deviations from their respective means in the anomalous direction (e.g., high duration z-score, low bytes z-score).\n3. Machine Learning Application: Deploy a time-series anomaly detection model (e.g., Isolation Forest or an LSTM Autoencoder) trained on historical Zeek conn.log data for serial-to-Ethernet converter connections. The model should monitor duration, orig_bytes, and resp_bytes as key features. Continuously feed real-time Zeek conn.log data into the trained model. Generate an alert when a connection exhibits an anomoly score exceeding a predefined threshold (e.7), indicating a statistically significant deviation from normal connection patterns consistent with a blocked or held-open port."
          },
          {
            "description": "A TCP connection to a serial-to-Ethernet converter port originates from a source IP address not present in the established allowlist of authorized engineering workstations, HMIs, or other control system components, or from a source IP address with no prior connection history to that specific converter.",
            "data_sources": [
              "Zeek conn.log",
              "Windows Event ID 4688",
              "Firewall connection logs",
              "Windows Event ID 4624",
              "Windows Event ID 4625"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "IT/OT DMZ network boundary, Process Control Network (PCN) segments, supervisory control systems, engineering workstations, Human Machine Interfaces (HMIs), and network segments directly hosting serial-to-Ethernet converters.",
            "action": "1. Symbolic Logic: Create and regularly update a comprehensive allowlist of authorized source IP addresses (e.g., 192.168.10.x for engineering workstations, 172.16.1.x for HMIs) permitted to connect to each specific serial-to-Ethernet converter IP address and port. In your SIEM, query Zeek conn.log for all successful TCP connections (conn_state = 'SF') where id.resp_h and id.resp_p match a known converter. Compare the id.orig_h of each connection against the allowlist. If id.orig_h is not found in the allowlist for the given id.resp_h and id.resp_p, generate an alert. For alerts originating from Windows hosts, correlate the connection timestamp with Windows Event ID 4688 (Process Creation) logs to identify the New Process Name (e.g., telnet.exe, nc.exe, powershell.exe) and CommandLine responsible for initiating the connection.\n2. Statistical Method: For each serial-to-Ethernet converter, establish a historical baseline of unique id.orig_h connections over a 90-day period. Calculate the entropy score for id.orig_h values connecting to each converter. Trigger an alert if there is a sudden, significant decrease in entropy (e.g., a single new IP connecting frequently and exclusively) or a substantial increase in the number of unique, previously unseen id.orig_h values connecting to a converter (e.g., exceeding the 99th percentile of unique source IPs per hour/day). Use descriptive statistics (e.g., count of unique source IPs, frequency analysis) to identify sudden spikes or deviations from the established baseline of source IPs.\n3. Machine Learning Application: Implement a supervised machine learning classification model (e.g., Random Forest, XGBoost) trained on historical Zeek conn.log data. Label connections as 'authorized' or 'unauthorized' based on the allowlist and known benign/malicious activity. Features for the model should include id.orig_h, id.resp_h, id.resp_p, duration, orig_bytes, resp_bytes, time-of-day, and day-of-week. Continuously feed new connection data into the trained model. Alert when the model predicts an 'unauthorized' classification with high confidence (e.g., >0.9 probability score), indicating a connection from an anomalous or unapproved source not conforming to historical patterns."
          }
        ]
      }
    ],
    "last_updated": "2025-09-29",
    "version": "1.3",
    "date_created": "2025-09-25",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]