[
  {
    "information_requirement": "Is an adversary attempting to inhibit response functions by changing credentials on critical ICS devices? (PIR)",
    "tactic_id": "TA0107",
    "tactic_name": "Inhibit Response Function",
    "indicators": [
      {
        "technique_id": "T0892",
        "name": "Change Credential",
        "evidence": [
          {
            "description": "Process creation (Windows Event ID 4688) of specific ICS engineering software executables (e.g., TIA Portal.exe, Studio5000.exe, ControlBuilder.exe) on an Engineering Workstation (EWS) by a user account not present in an authorized whitelist for that specific software and EWS, or occurring outside of the established 95th percentile of normal execution times for that user and software.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 4624"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Engineering Workstations (EWS) and Human-Machine Interfaces (HMIs) within the Process Control Network (PCN) and DMZ.",
            "action": "1. Symbolic Logic: Maintain a whitelist of authorized user accounts and specific ICS engineering software executables (e.g., 'TIA Portal.exe', 'Studio5000.exe', 'ControlBuilder.exe') for each EWS. Generate an alert for Windows Event ID 4688 where a whitelisted executable is launched by a SubjectUserName not present in the authorized list for that specific EWS. This can be achieved with a SIEM rule joining event 4688 with an internal whitelist lookup table. 2. Statistical Method: For each EWS and authorized user, establish a baseline of typical execution times for ICS engineering software (Windows Event ID 4688, field CreationTime). Calculate the 95th percentile for these execution timestamps over the last 90 days. Alert when an execution occurs where the CreationTime falls outside of these established 95th percentile bounds for that user and software, particularly when combined with non-operational hours (e.g., between 10 PM and 6 AM local time for software typically used during business hours). 3. Machine Learning/Time Series: For each EWS, collect Windows Event ID 4688 data for ICS engineering software executions over a 30-day period. Apply a time-series anomaly detection algorithm (e.g., Exponentially Weighted Moving Average with a 3-sigma threshold) to identify significant deviations in execution frequency or duration from the established baseline, signaling unusual activity patterns. This model should be re-trained weekly."
          },
          {
            "description": "Network communication from an Engineering Workstation (EWS) or other management host to a Programmable Logic Controller (PLC), Remote Terminal Unit (RTU), or Intelligent Electronic Device (IED) containing specific ICS protocol function codes or commands (e.g., S7COMM 'Setup Communication' block, Modbus Function Code '0x10' Write Multiple Registers targeting known password/key registers, or EtherNet/IP 'Set Attribute Single' to security-related attributes) that are documented to modify or set device credentials, observed outside of documented and scheduled maintenance windows.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek s7comm.log",
              "Zeek modbus.log",
              "Zeek enip.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network segments within the Process Control Network (PCN) where Engineering Workstations (EWS) communicate with Programmable Logic Controllers (PLCs), Remote Terminal Units (RTUs), or Intelligent Electronic Devices (IEDs), including DMZs or firewalls separating these zones.",
            "action": "1. Symbolic Logic: Identify specific ICS protocol function codes or commands (e.g., S7COMM Function Code '0x00', Subfunction '0x04' for 'Setup Communication' with specific parameters indicating password change; Modbus Function Code '0x10' 'Write Multiple Registers' to known password/key registers; EtherNet/IP 'Set Attribute Single' to a security attribute) associated with credential modification. Configure SIEM rules to alert when these specific commands are observed in Zeek s7comm.log, modbus.log, or enip.log originating from an EWS or unauthorized host destined for a critical controller's IP address and port. 2. Statistical Method: For each EWS-to-controller communication pair, establish a historical baseline of observed ICS protocol function codes and their frequencies (e.g., from Zeek s7comm.log, modbus.log, or enip.log) over the last 90 days. Calculate the relative frequency of each function code over a 24-hour rolling window. Alert when a function code known for credential modification, which has a historical frequency below the 1st percentile for that specific communication pair, is observed. Additionally, correlate with known maintenance schedules to suppress false positives. 3. Machine Learning/Entropy: For each EWS-to-controller communication pair, calculate the Shannon entropy of observed ICS protocol function codes within a 1-hour sliding window from Zeek s7comm.log, modbus.log, or enip.log. Establish a baseline range for entropy scores for each pair over a 30-day period. Alert on significant drops in entropy (e.g., below the 5th percentile of historical entropy values), which could indicate a highly repetitive and potentially malicious sequence of commands, such as repeatedly attempting to change a credential or a very specific, unusual sequence of commands."
          },
          {
            "description": "A correlated sequence of events where an anomalous or unauthorized user logon (Windows Event ID 4624) to an Engineering Workstation (EWS) is immediately followed by the execution of ICS engineering software (Windows Event ID 4688) by that user, which then correlates with network communication from that EWS to a critical PLC/RTU/IED (Zeek conn.log) containing specific ICS protocol commands (Zeek s7comm.log, modbus.log, enip.log) indicative of a device credential modification, all occurring outside of scheduled maintenance.",
            "data_sources": [
              "Windows Event ID 4624",
              "Windows Event ID 4688",
              "Zeek conn.log",
              "Zeek s7comm.log",
              "Zeek modbus.log",
              "Zeek enip.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Engineering Workstations (EWS) within the Process Control Network (PCN), Active Directory/Authentication Servers, and network perimeter devices between the IT and OT networks.",
            "action": "1. Symbolic Logic (Rule-based correlation): Create a correlation rule in the SIEM that triggers when: (a) Windows Event ID 4624 (successful logon) on an EWS from a source IP not on an approved list for that user/EWS, OR the LogonType is indicative of remote access (e.g., '10 - RemoteInteractive') from an unusual source, OR the logon occurs outside of typical work hours for that user. (b) Followed within 5 minutes by Windows Event ID 4688 (process creation) on the same EWS, where NewProcessName matches a known ICS engineering software executable. (c) Followed within 10 minutes by Zeek conn.log entries from the EWS's IP to a critical controller's IP on a known ICS protocol port (e.g., 102/tcp, 502/tcp, 44818/tcp), AND Zeek s7comm.log, modbus.log, or enip.log entries showing credential modification commands. This chain of events should generate a high-priority alert with supporting evidence. 2. Statistical Method: Establish a baseline of typical login times, LogonType distributions, and source IP ranges for each authorized user on each EWS (Windows Event ID 4624) over the last 90 days. Calculate a deviation score (e.g., Mahalanobis distance or Z-score for multiple features) for each login event. Simultaneously, baseline the frequency and type of ICS software executions (Windows Event ID 4688) and controller communication from EWS (Zeek logs, including specific protocol commands). Alert when a login event with a deviation score exceeding the 99th percentile is observed, AND is followed within a defined time window (e.g., 15 minutes) by a sudden spike in ICS software execution or controller communication frequency/type that also exceeds a 99th percentile deviation threshold. 3. Machine Learning/Behavioral Anomaly Detection: Implement a multi-modal behavioral anomaly detection model (e.g., using a sequence model like a Hidden Markov Model or a deep learning approach like an autoencoder on combined features) that profiles normal user behavior on EWS hosts. Features should include login patterns (Windows Event ID 4624), process execution (Windows Event ID 4688, including executable names and parameters), and network communication to controllers (Zeek logs, including protocol, function codes, and destination IPs). Train the model on these multi-dimensional, time-series features over a 60-day period. Flag and alert on any new activity sequence that deviates significantly from established clusters of normal behavior, indicating a potential compromise and credential modification attempt. The model should provide an anomaly score and contributing features."
          }
        ]
      }
    ],
    "version": "1.2",
    "date_created": "2025-09-26",
    "last_updated": "2025-09-29",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]