[
  {
    "information_requirement": "Is an adversary attempting to gain initial access to the ICS network via external remote services? (PIR)",
    "tactic_id": "TA0108",
    "tactic_name": "Initial Access",
    "indicators": [
      {
        "technique_id": "T0822",
        "name": "External Remote Services",
        "evidence": [
          {
            "description": "A successful login event (Windows Event ID 4624, Logon_Type 10 for RDP, 2 for interactive, 3 for network logon for VPN/web portals) to an ICS-facing remote access service where the `Source_Network_Address` has no prior successful login history for that `Target_User_Name` in the last 90 days, or the geolocated country/ASN of `Source_Network_Address` (via Zeek geoip.log) is new for `Target_User_Name` within the last 90 days, or the `Logon_Time` falls outside the 95th percentile of typical login hours for that specific `Target_User_Name`.",
            "data_sources": [
              "Windows Event ID 4624",
              "Zeek conn.log",
              "Zeek geoip.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "ICS Network Demarcation Zone (DMZ), VPN Concentrators, Remote Access Gateways, Jump Boxes, Authentication Servers within ICS DMZ",
            "action": "1. (Symbolic Logic) Correlate `Windows Event ID 4624` (successful login, `Target_User_Name`, `Source_Network_Address`, `Logon_Time`) from remote access servers with `Zeek conn.log` (`id.orig_h`, `ts`). Alert if a `Source_Network_Address` from a successful login (4624) is observed to have generated more than 5 failed login attempts (`Windows Event ID 4625`, `Source_Network_Address`) within the preceding 60 seconds targeting the same `Target_Server_Name`, or if the `Source_Network_Address` is present on a known threat intelligence blacklist. 2. (Statistical Method) For each `Target_User_Name` from `Windows Event ID 4624`, establish a 90-day baseline of normal activity including typical login hours (`Logon_Time` mean and standard deviation), source countries/ASNs (from `Zeek geoip.log` correlated with `Source_Network_Address` of `Windows Event ID 4624`, top 95th percentile of distinct values), and login frequency. Trigger an alert when a successful login occurs from a new country/ASN not observed for that user in the baseline, or if the `Logon_Time` is more than 3 standard deviations from the user's established average `Logon_Time`. 3. (Machine Learning) Employ a supervised classification model (e.g., Random Forest) trained on historical successful `Windows Event ID 4624` login features for each `Target_User_Name` (e.g., `Logon_Time` and day of week, `Source_Network_Address` reputation, `Zeek geoip.log` country/ASN, login frequency, `User-Agent` string from `Zeek http.log` correlated by `id.orig_h` for web-based remote access portals). Predict the likelihood of an anomalous login; flag logins with an anomaly score above a learned threshold (e.g., top 1% of scores) for further investigation."
          },
          {
            "description": "A single `Source_Network_Address` (from `Windows Event ID 4625`) generating a high rate of failed login attempts (`Windows Event ID 4625`, `Failure_Reason`) exceeding a defined threshold (e.g., 10 attempts in 60 seconds) against a single `Target_User_Name`, or failed attempts against more than 15 distinct `Target_User_Name` accounts within a 10-minute window, indicative of brute force or password spraying against remote access services.",
            "data_sources": [
              "Windows Event ID 4625",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Authentication Servers for Remote Access, VPN Concentrators, Domain Controllers, Remote Access Gateways",
            "action": "1. (Symbolic Logic) From `Windows Event ID 4625` logs, count the number of failed login attempts (`Failure_Reason`) originating from a single `Source_Network_Address` over a 60-second sliding window. Alert if this count exceeds 10 for any single `Target_User_Name`. Additionally, identify when a single `Source_Network_Address` generates failed logins for more than 15 distinct `Target_User_Name` accounts within a 10-minute window, indicating password spraying. 2. (Statistical Method) From `Windows Event ID 4625`, calculate the hourly rate of failed login attempts per remote access server (`Target_Server_Name`). Alert if the current hourly rate exceeds the 99th percentile of historical rates for that server over the last 30 days. Furthermore, calculate the Z-score for failed login attempts originating from a given `Source_Network_Address`; alert if the Z-score exceeds 3.0, indicating a statistically significant deviation from its historical average. 3. (Machine Learning) Implement a time series anomaly detection model (e.g., ARIMA or Prophet) on the aggregated rate of `Windows Event ID 4625` failed login attempts per remote access server (based on `Target_Server_Name` or `Target_Logon_Id`), alerting on statistically significant deviations from predicted patterns. Additionally, use a clustering algorithm (e.g., K-Means or DBSCAN) on `Source_Network_Address` values (from `Windows Event ID 4625`) based on the number of failed login attempts and unique `Target_User_Name` accounts to identify clusters of suspicious activity that deviate from normal behavior, potentially indicating coordinated attacks."
          },
          {
            "description": "Following a successful remote access login (`Windows Event ID 4624`, `Source_Network_Address`), the associated `Source_Network_Address` (which maps to `Zeek conn.log`'s `id.orig_h`) initiates network connections to an unusually high number of distinct internal ICS hosts (`id.resp_h`) or ports (`id.resp_p`), or transfers an anomalous volume of data (`orig_bytes` + `resp_bytes`) that exceeds established baselines for typical remote maintenance sessions (from `Zeek conn.log`), or resolves/connects to known malicious external IPs/domains (from `Zeek dns.log`'s `query` or `Zeek http.log`'s `host` or `uri`).",
            "data_sources": [
              "Zeek conn.log",
              "Windows Event ID 4624",
              "Zeek dns.log",
              "Zeek http.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internal ICS Network Segments, ICS Engineering Workstations, Human-Machine Interfaces (HMIs) Servers, SCADA Servers, Data Historian Servers, Programmable Logic Controllers (PLCs)",
            "action": "1. (Symbolic Logic) After a successful remote login (`Windows Event ID 4624`, `Source_Network_Address`, `Target_User_Name`), monitor subsequent network activity originating from `id.orig_h` (matching `Source_Network_Address`) in `Zeek conn.log`. Alert if the `Target_User_Name` connects to known sensitive ICS assets (`id.resp_h`, `id.resp_p`) that are outside their established access baseline (e.g., a critical PLC that user has never accessed), or if `Zeek dns.log` entries show `query` for known C2 domains, or `Zeek http.log` entries show connections to `host` or `uri` values present on a known threat intelligence blacklist. 2. (Statistical Method) For each active remote session (identified by `Source_Network_Address` from `Windows Event ID 4624`), calculate the number of unique internal `id.resp_h` (destination IPs) contacted and the total data volume (`orig_bytes` + `resp_bytes` from `Zeek conn.log`). Establish baselines (e.g., 99th percentile or 3 standard deviations) for these metrics per `Target_User_Name`/role from historical data. Alert if current session metrics exceed the established baseline. Additionally, calculate the Shannon entropy of `id.resp_p` (destination ports) and `proto` (protocols) contacted by the `id.orig_h` in 10-minute windows; a sudden spike in entropy (e.g., 2 standard deviations above the mean for that user/source IP) indicates potential reconnaissance or scanning activity. 3. (Machine Learning) Train an unsupervised anomaly detection model (e.g., Isolation Forest or Autoencoder) on features extracted from `Zeek conn.log`, `dns.log`, and `http.log` post-login (e.g., count of unique `id.resp_h`, total `orig_bytes` + `resp_bytes`, distribution of `proto` and `id.resp_p`, `duration` of connections, entropy of destination ports/protocols, frequency of new internal connections from `id.orig_h`). Flag sessions with an anomaly score above a pre-defined threshold (e.g., top 0.5% of scores) as suspicious activity requiring further investigation."
          }
        ]
      }
    ],
    "version": "1.2",
    "date_created": "2025-09-25",
    "last_updated": "2025-09-29",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]