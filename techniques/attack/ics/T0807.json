[
  {
    "information_requirement": "Is an adversary executing commands on critical ICS assets via a command-line interface?",
    "tactic_id": "TA0104",
    "tactic_name": "Execution",
    "indicators": [
      {
        "technique_id": "T0807",
        "name": "Command-Line Interface",
        "evidence": [
          {
            "description": "Evidence of this indicator is observed when a parent process associated with a known ICS management shell (e.g., cmd.exe, powershell.exe, or vendor-specific CLIs like Rockwell's RSHelper.exe or Siemens' WinCCExplorer.exe) on a critical ICS asset spawns a child process (e.g., net.exe, ipconfig.exe, whoami.exe, certutil.exe, nmap.exe) that is either not on a pre-defined whitelist for that parent/host combination, has not been observed in the last 90 days, or represents a statistically rare occurrence (e.g., below the 0.01st percentile of all child processes for that parent over a 30-day period).",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Historian Servers, Process Control Servers (PCS), Data Gateways, Application Servers within the Process Control Network (PCN) and Manufacturing Zone (MZ).",
            "action": [
              "Create and maintain a strict whitelist of allowed parent-child process relationships for critical ICS assets, defined as a tuple of (hostname, parent_process_path, child_process_path). Implement a SIEM rule to generate a high-severity alert for any process creation event (Windows Event ID 4688) where the parent process is a known shell and the child process is not on the explicit whitelist for that parent-host pair.",
              "For each ICS host, create a 90-day rolling baseline of parent-child process relationships from Windows Event ID 4688 data. For each parent process, calculate the execution frequency of all its child processes. Generate a medium-severity alert when a child process is spawned that has not been observed in the 90-day baseline for that parent-host pair. Escalate to high-severity if the child process is also a known living-off-the-land binary (LOLBin) or is executed with reconnaissance parameters.",
              "For each critical host, model the hourly count of unique child processes spawned by each shell process (e.g., powershell.exe, cmd.exe) as a distinct time series. Apply a seasonal-hybrid anomaly detection algorithm (e.g., Seasonal-ARIMA or Prophet) to account for regular operational cycles like shift changes or automated batch jobs. Alert on any data point flagged as a statistical anomaly (e.g., a count exceeding 3 standard deviations from the forecast), suggesting an abnormal burst of diverse command executions indicative of enumeration or script execution."
            ]
          },
          {
            "description": "A successful remote interactive logon (e.g., RDP, SSH) to a critical ICS asset from an untrusted or unexpected network segment is followed within a short time window (e.g., 90 seconds) by command-line process creation under the same logon session. The activity is considered anomalous if the command has not been executed by that user from that source subnet in the last 90 days, or if the logon and execution occur outside of pre-defined operational hours or maintenance windows.",
            "data_sources": [
              "Windows Event ID 4624",
              "Windows Event ID 4688",
              "Zeek conn.log",
              "Zeek rdp.log",
              "Zeek ssh.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "ICS DMZ/Perimeter, Remote Access Gateways, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Jump Servers, and Terminal Servers within the ICS network.",
            "action": [
              "Create a SIEM correlation rule that links a successful remote logon (Windows Event ID 4624 with Logon Type 10 for RDP, or Zeek ssh.log with auth_success='true') with a subsequent Windows Event ID 4688 from the same Logon ID or user context within a 90-second window. The rule triggers if the source IP in the logon event is from a non-RFC1918 address or a subnet not on the approved remote access list AND the command line contains reconnaissance commands (e.g., whoami, net user, systeminfo, ipconfig, tasklist, quser).",
              "For each user account, build a 90-day baseline profile of remote access behavior. For a new remote session, calculate a risk score starting at 0. Add points for deviations: login from a new ASN (+2); login from a country not seen in 90 days (+3); login outside of defined maintenance windows (e.g., 22:00-06:00 local time) (+2); Jaccard similarity of executed commands to the user's historical command set is less than 0.2 (+5). Alert on any session with a cumulative score exceeding a defined threshold (e.g., 6).",
              "For each user, create a feature vector for each remote session summarizing its behavior. Features should include: session duration, number of processes spawned, average command-line entropy, ratio of read-only vs. modification commands (e.g., 'dir' vs. 'del'), count of network-related commands ('ping', 'net', 'ipconfig'), and the median time between commands. Train an unsupervised anomaly detection model like Isolation Forest or a Variational Autoencoder (VAE) on the historical session vectors for all users. Score each new session in real-time and alert on sessions identified as outliers."
            ]
          },
          {
            "description": "A command-line execution on an ICS asset contains indicators of obfuscation, defense evasion, or discovery. This includes the use of suspicious string patterns (e.g., 'powershell -enc', 'Invoke-Expression'), command-line arguments exhibiting high Shannon entropy (e.g., > 4.5) indicative of encoding, or the use of legitimate engineering software command-line utilities with unusual parameters to interact with field devices.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "All Windows-based ICS assets, including HMIs, EWS, Historian Servers, Process Control Servers (PCS), and Data Gateways within the Process Control Network (PCN) and higher zones.",
            "action": [
              "Deploy a SIEM rule that uses regular expressions to scan the command-line field of Windows Event ID 4688 events. The rule should alert on the presence of known malicious patterns, such as PowerShell encoding flags ('-e', '-enc'), download cradles ('IEX(New-Object Net.WebClient).DownloadString'), file transfer utilities used with remote URLs ('bitsadmin /transfer', 'certutil -urlcache'), or attempts to manipulate system state ('reg save', 'wevtutil cl').",
              "Continuously analyze all command lines from Windows Event ID 4688. For each command, calculate the Shannon entropy of the arguments. Alert when a command's entropy exceeds a high, fixed threshold (e.g., 4.5) or deviates more than 3 standard deviations from the historical baseline for that specific executable. Additionally, calculate the ratio of non-alphanumeric characters to total characters in the arguments and alert if this ratio exceeds the 99th percentile for that process, as it may indicate obfuscation.",
              "Train a supervised text classification model (e.g., a Long Short-Term Memory (LSTM) network) on a labeled dataset of benign and malicious command lines sourced from ICS-specific honeypots and incident reports. Features should include character-level n-grams, command line length, entropy, and special character ratios. Deploy the model to classify incoming command lines in real-time and alert on any command classified as malicious with a confidence score greater than 0.9."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "1.5",
    "date_created": "2025-09-25",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]