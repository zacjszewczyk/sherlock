[
  {
    "information_requirement": "Is an adversary attempting to gain initial access to the ICS network via wireless compromise? (PIR)",
    "tactic_id": "TA0108",
    "tactic_name": "Initial Access",
    "indicators": [
      {
        "technique_id": "T0860",
        "name": "Wireless Compromise",
        "evidence": [
          {
            "description": "A Zeek conn.log or wifi.log record shows a previously unobserved MAC address (e.g., id.orig_l2_addr, wifi.client_mac) connecting on an ICS wireless network segment, where the address is absent from the authorized ICS wireless asset inventory.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek wifi.log",
              "ICS Wireless Asset Inventory"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Wireless Access Points (WAPs) within the Process Control Network (PCN) and Manufacturing Zone, network taps or SPAN ports on wireless network infrastructure connecting to Level 1/2 devices, dedicated wireless sensor network gateways.",
            "action": [
              "Create a rule to continuously monitor Zeek conn.log and wifi.log on ICS wireless network segments (identified by SSID or subnet). Generate a high-severity alert for any connection where the source or destination MAC address is not present in the authorized ICS wireless asset inventory, especially if the connection targets Level 1 (e.g., PLCs, RTUs) or Level 2 (e.g., HMIs, Control Servers) devices.",
              "For connections involving an unknown MAC address, calculate the statistical rarity of the protocol (proto) and destination port (id.resp_p) combination against a 30-day historical baseline for that network segment. Alert if the combination's frequency falls below the 5th percentile. Separately, monitor the Shannon entropy of the 'service' field in conn.log over 10-minute windows; a sudden spike exceeding the 99th percentile of historical entropy values suggests a new device is performing service discovery.",
              "Deploy an unsupervised learning model, such as an Isolation Forest, on Zeek conn.log data from ICS wireless segments. Use features including orig_bytes, resp_bytes, duration, proto, and service. Train the model on at least 90 days of normal traffic. Generate a high-priority alert for any network flow classified as an outlier, especially if it involves an unknown MAC address or has characteristics like an extremely short duration with non-zero bytes transferred."
            ]
          },
          {
            "description": "A Zeek conn.log record shows an authorized ICS wireless device (identified by id.orig_h) exhibiting communication patterns outside its established baseline, such as connecting to a new destination IP (id.resp_h), using an unapproved port (id.resp_p) or protocol (proto), or transferring a data volume (orig_bytes + resp_bytes) that exceeds its historical 95th percentile for that specific communication channel.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek modbus.log",
              "Zeek dnp3.log",
              "Windows Event ID 4624",
              "Communication Baseline Policy"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Process Control Network (PCN) segments where HMIs, EWS, Historian Servers, and other wireless-connected ICS field devices reside; network taps on switch uplinks for these segments; ICS protocol deep packet inspection (DPI) sensors.",
            "action": [
              "For each authorized ICS wireless device, enforce a strict communication baseline policy. Create a rule to monitor Zeek conn.log and ICS protocol logs (e.g., modbus.log) and alert on any connection from an authorized device to a destination IP, port, or protocol not in its baseline. Additionally, alert on unexpected ICS function codes (e.g., Modbus function codes for writing coils/registers from a device that should only read).",
              "For each authorized wireless device, calculate the daily average and standard deviation of its total data sent/received (orig_bytes + resp_bytes) and connection count. Alert if the daily total for either metric exceeds 3 standard deviations from its 30-day moving average. Also, calculate the Shannon entropy of the destination port (id.resp_p) distribution for each device over 15-minute windows; an increase in entropy exceeding the 99th percentile of historical scores suggests scanning behavior.",
              "Implement a time-series anomaly detection model (e.g., Prophet or ARIMA) on the daily total data volume (orig_bytes + resp_bytes) for each critical ICS wireless device. Train the model on at least 90 days of historical data. Generate an alert when the actual observed volume falls outside the model's 99% confidence interval, which can detect both sudden spikes (e.g., C2 traffic) and drops (e.g., denial of service) in communication."
            ]
          },
          {
            "description": "A Windows Event ID 4688 (Process Creation) event is logged on a critical ICS host (e.g., HMI, EWS), where the NewProcessName is a high-risk executable (e.g., powershell.exe, cmd.exe) and the event is correlated within a 3-minute window to an anomalous wireless network connection (per Evidence 1 or 2) targeting that host.",
            "data_sources": [
              "Windows Event ID 4688",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Windows-based HMIs, EWS, and Control Servers within the Process Control Network (PCN) and DMZ; endpoint detection and response (EDR) agents or Windows Event Forwarding (WEF) infrastructure on these hosts.",
            "action": [
              "Create a correlation rule that triggers when an alert for anomalous wireless network activity is followed within a 3-minute window by a process creation event (Windows Event ID 4688) on the targeted Windows host. The rule must specifically check for NewProcessName values like powershell.exe, cmd.exe, wscript.exe, cscript.exe, mshta.exe, certutil.exe, or any process executing from a non-standard directory (e.g., %TEMP%, %APPDATA%) with an unexpected parent process.",
              "For all Windows Event ID 4688 events on critical ICS hosts, calculate the Shannon entropy of the CommandLine field. Maintain a rolling 30-day baseline of entropy scores for each unique NewProcessName. Alert if the entropy of a CommandLine for a high-risk process (as defined in the symbolic logic) exceeds the 99th percentile of its historical entropy distribution, indicating probable obfuscation or randomization.",
              "Implement a supervised machine learning classifier (e.g., Random Forest) trained on historical Windows Event ID 4688 data from ICS hosts, labeled with known malicious and benign events. Engineer features from NewProcessName, CommandLine (e.g., length, character distribution, n-grams), ParentProcessName, and ParentCommandLine. Alert on any new process creation event classified as malicious, especially when correlated with recent anomalous wireless network activity."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "1.5",
    "date_created": "2025-09-25",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]