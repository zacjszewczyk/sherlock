[
  {
    "information_requirement": "Is an adversary attempting to gain initial access to the ICS network via wireless compromise? (PIR)",
    "tactic_id": "TA0108",
    "tactic_name": "Initial Access",
    "indicators": [
      {
        "technique_id": "T0860",
        "name": "Wireless Compromise",
        "evidence": [
          {
            "description": "A Zeek conn.log or wifi.log record indicates a new, previously unobserved MAC address (e.g., id.orig_l2_addr, wifi.client_mac) establishing a connection on an ICS wireless network segment, where the address is not present in the pre-approved, authorized ICS wireless asset inventory.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek wifi.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Wireless Access Points (WAPs) within the Process Control Network (PCN) and Manufacturing Zone, network taps or SPAN ports on wireless network infrastructure connecting to Level 1/2 devices, dedicated wireless sensor network gateways.",
            "action": "Maintain an up-to-date allowlist of all authorized MAC addresses (id.orig_l2_addr, id.resp_l2_addr, wifi.client_mac) and IP addresses (id.orig_h, id.resp_h) for ICS wireless devices.\n1.  Symbolic Logic: Continuously monitor Zeek conn.log and wifi.log for connections on ICS wireless network segments (identified by SSID in wifi.log or subnet in conn.log). Generate a high-severity alert for any connection where the source or destination MAC/IP address is not present in the authorized asset allowlist, especially if communicating with Level 1 (e.g., PLCs, RTUs) or Level 2 (e.g., HMIs, Control Servers) devices.\n2.  Statistical Method: For connections involving unknown MAC/IP addresses, calculate the statistical rarity (e.g., Z-score) of the observed protocol (proto) and destination port (id.resp_p) combination against a 30-day historical baseline for that network segment. Alert if the combination's frequency is below the 5th percentile. Additionally, monitor the Shannon entropy of the 'service' field in conn.log over 10-minute windows; a sudden spike exceeding the 99th percentile of historical entropy values suggests a new device is attempting a wide range of services.\n3.  Machine Learning: Employ an unsupervised learning model (e.g., Isolation Forest) on Zeek conn.log to identify anomalous network flows. Use features such as orig_bytes, resp_bytes, duration, proto, and service for connections on ICS wireless segments. Train the model on 90 days of historical 'normal' ICS wireless traffic. Generate a high-priority alert for any flow classified as an outlier, particularly if it involves an unknown MAC/IP address or has unusual characteristics like an extremely short duration with non-zero bytes transferred."
          },
          {
            "description": "A Zeek conn.log record from an authorized ICS wireless device (id.orig_h) demonstrates communication patterns outside its established baseline, such as connecting to a new destination IP address (id.resp_h) not on a known allowlist, using an unapproved destination port (id.resp_p) or protocol (proto), or transferring a data volume (orig_bytes + resp_bytes) that exceeds its historical 95th percentile for a given communication tuple.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek modbus.log",
              "Zeek dnp3.log",
              "Windows Event ID 4624"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Process Control Network (PCN) segments where HMIs, EWS, Historian Servers, and other wireless-connected ICS field devices reside; network taps on switch uplinks for these segments; ICS protocol deep packet inspection (DPI) sensors.",
            "action": "For each authorized ICS wireless device, establish a detailed communication baseline using at least 60 days of Zeek conn.log and relevant ICS protocol logs (e.g., modbus.log, dnp3.log). This baseline must include: 1) an allowlist of normal destination IPs, 2) an allowlist of normal destination ports and protocols, and 3) the 95th percentile of total bytes (orig_bytes + resp_bytes) per connection for each unique (source, destination, port, protocol) tuple.\n1.  Symbolic Logic: Continuously monitor Zeek conn.log and ICS protocol logs. Create a rule to alert on any connection from an authorized wireless device to a destination IP or using a port/protocol that is not in its established baseline allowlist. If the destination is a Windows host, correlate this network alert with any successful login (Windows Event ID 4624) from the source IP within a 5-minute window.\n2.  Statistical Method: For each authorized wireless device, calculate the daily average and standard deviation of its total data sent/received (orig_bytes + resp_bytes) and total connection count. Alert if the daily total bytes or connection count exceeds 3 standard deviations from its 30-day moving average. Additionally, calculate the Shannon entropy of the destination port (id.resp_p) distribution for each device over 15-minute windows; a sudden increase in entropy (exceeding the 99th percentile of historical scores) suggests scanning or other non-standard behavior.\n3.  Machine Learning: Implement a time-series anomaly detection model (e.g., Prophet or ARIMA) on the daily total data volume (orig_bytes + resp_bytes) for each critical ICS wireless device. Train the model on at least 90 days of historical data. Generate an alert when the actual observed volume falls outside the model's 99% confidence interval, which can detect both sudden spikes (data exfiltration/C2) and drops (denial of service/tampering) in communication."
          },
          {
            "description": "A Windows Event ID 4688 (Process Creation) event is logged on a critical ICS host (e.g., HMI, EWS), where the NewProcessName is a high-risk executable (e.g., powershell.exe, cmd.exe, certutil.exe) and the event occurs within a 3-minute window following an anomalous network connection from an ICS wireless device targeting that host.",
            "data_sources": [
              "Windows Event ID 4688",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Windows-based HMIs, EWS, and Control Servers within the Process Control Network (PCN) and DMZ; endpoint detection and response (EDR) agents or Windows Event Forwarding (WEF) infrastructure on these hosts.",
            "action": "Establish a correlation rule that links anomalous wireless network activity to subsequent high-risk host behavior.\n1.  Symbolic Logic: Create a detection rule that triggers when an alert for anomalous wireless network activity (from Evidence 1 or 2) is followed within a 3-minute window by a process creation event (Windows Event ID 4688) on the targeted Windows HMI or EWS. The rule should specifically look for NewProcessName values such as powershell.exe, cmd.exe, wscript.exe, cscript.exe, mshta.exe, rundll32.exe, certutil.exe, bitsadmin.exe, or any process executing from a non-standard directory (e.g., %TEMP%, %APPDATA%).\n2.  Statistical Method: For all Windows Event ID 4688 events on critical ICS hosts, calculate the Shannon entropy of the CommandLine field. Maintain a rolling 30-day baseline of entropy scores for each unique NewProcessName. Alert if the entropy of a CommandLine for a high-risk process (as defined in the symbolic logic) exceeds the 99th percentile of its historical entropy distribution, as this often indicates obfuscation or randomized parameters.\n3.  Machine Learning: Implement a supervised machine learning classifier (e.g., Random Forest or Gradient Boosting) trained on historical Windows Event ID 4688 data from ICS hosts, labeled with known malicious and benign process execution events. Engineer features from the NewProcessName, CommandLine (e.g., length, character distribution, n-grams), ParentProcessName, and ParentCommandLine fields. Generate a high-priority alert for any new process creation event classified as malicious, especially when correlated with recent anomalous wireless network activity from Zeek conn.log."
          }
        ]
      }
    ],
    "last_updated": "2025-09-29",
    "version": "1.4",
    "date_created": "2025-09-25",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]