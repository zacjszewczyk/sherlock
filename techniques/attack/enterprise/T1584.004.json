[
  {
    "information_requirement": "Is the adversary developing resources by compromising external servers for use in operations against our organization?",
    "tactic_id": "TA0042",
    "tactic_name": "Resource Development",
    "indicators": [
      {
        "technique_id": "T1584.004",
        "name": "Server",
        "evidence": [
          {
            "description": "An outbound network connection from an internal host to an external destination (IP, domain) or secured by a certificate (serial, subject) matches an entry on a high-confidence threat intelligence feed for known adversary infrastructure.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log",
              "Zeek x509.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network Egress Points (Firewalls/Proxies), Corporate DNS Resolvers, Web Content Filters",
            "action": [
              "Symbolic: Continuously join network connection logs (Zeek conn.log `id.resp_h`, Zeek dns.log `query`, Zeek x509.log `certificate.serial`) against a threat intelligence database of known malicious IPs, domains, and certificate serials. Generate a high-severity alert for any match.",
              "Statistical: For domains not on a pre-defined allowlist, calculate a reputation score based on features like domain age, registration privacy, and prevalence in threat feeds. Flag connections to domains with scores below a statistically determined threshold (e.g., 10th percentile of scores for all observed domains).",
              "Machine Learning: Use a supervised classification model (e.g., a Gradient Boosting Machine) trained on labeled threat intelligence data to predict the probability of a given connection being malicious based on features like destination IP, port, ASN, domain, and certificate attributes. Alert when the predicted probability exceeds a defined risk threshold (e.g., 0.85)."
            ]
          },
          {
            "description": "An outbound connection from an internal host exhibits network artifacts (e.g., JA3/JA3S hash, HTTP User-Agent, URI path) that are uniquely characteristic of a known command-and-control (C2) framework.",
            "data_sources": [
              "Zeek ssl.log",
              "Zeek http.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network Egress Points (Firewalls/Proxies), Endpoints generating the traffic",
            "action": [
              "Symbolic: Create and maintain a watchlist of JA3/JA3S hashes, HTTP User-Agents, and URI patterns associated with common C2 frameworks (e.g., Cobalt Strike, Metasploit, Empire). Scan Zeek ssl.log and http.log in real-time and generate alerts on any exact matches.",
              "Statistical: Calculate the Shannon entropy of URI paths and query parameters in Zeek http.log. Establish a baseline for normal entropy values across the enterprise. Flag connections with unusually high entropy values (e.g., > 95th percentile), as this often indicates encoded C2 data.",
              "Machine Learning: Train a sequence-based model (e.g., an LSTM) on legitimate and malicious URI patterns. Use the model to classify outbound HTTP requests as benign or suspicious in real-time to detect variations of known C2 patterns that might evade simple signature matching."
            ]
          },
          {
            "description": "An internal host establishes a series of outbound connections to a single external destination with highly regular time intervals (beaconing) or transfers data volumes that are statistical outliers compared to its established baseline.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network Egress Points (Firewalls/Proxies), Endpoint devices and servers",
            "action": [
              "Symbolic: For a given source-destination IP pair, if the connection count is > 20 in a 1-hour period and the destination is not on an approved services list, flag for review.",
              "Statistical: For each source-destination IP pair over a rolling 24-hour window, calculate the time delta between consecutive connections. A standard deviation of these time deltas below a low threshold (e.g., < 1.5 seconds) indicates robotic, periodic beaconing. Alert on pairs that meet this criterion.",
              "Machine Learning: Apply a time-series decomposition model to the connection events for each internal host to external destinations. Analyze the periodic component to identify strong, repeating patterns indicative of C2 beaconing. A strong periodic signal with a frequency that is not a common application heartbeat (e.g., 17 minutes) is highly suspicious."
            ]
          },
          {
            "description": "An outbound SSL/TLS connection utilizes a server certificate with anomalous attributes, such as being self-signed, having an unusually short validity period, or containing a high-entropy subject/issuer name, when compared to a baseline of legitimate traffic.",
            "data_sources": [
              "Zeek ssl.log",
              "Zeek x509.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network Egress Points (Firewalls/Proxies), Public Certificate Transparency Logs",
            "action": [
              "Symbolic: Generate an alert for any outbound connection using an SSL/TLS certificate where the 'issuer' field matches the 'subject' field (self-signed) and the destination IP is not on an internal or approved partner IP list.",
              "Statistical: Calculate the distribution of certificate validity periods from x509.log. Flag any certificates with a validity period in the lowest percentile (e.g., < 5th percentile, typically < 90 days), as this is common for adversary-provisioned infrastructure.",
              "Machine Learning: Use an unsupervised clustering algorithm (e.g., DBSCAN) on certificate features (validity period, key length, public key algorithm, entropy of subject). Identify and investigate small clusters or outliers that represent anomalous certificates deviating from the large clusters of legitimate CAs."
            ]
          },
          {
            "description": "An internal host resolves and connects to a newly observed external domain, and within a short time window (e.g., < 5 minutes), a suspicious process (e.g., powershell.exe, wscript.exe) is executed on that same host.",
            "data_sources": [
              "Zeek dns.log",
              "Zeek conn.log",
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Endpoint devices, Domain Controllers, Corporate DNS Resolvers",
            "action": [
              "Symbolic: Create a rule that triggers when a host connects to a domain first seen in the last 24 hours (from Zeek dns.log) and, within 5 minutes, a process creation event (Windows Event ID 4688) for 'powershell.exe' with command-line arguments containing '-enc' or '-nop' is observed from the same host.",
              "Statistical: Maintain a list of 'least seen' domains for the last 30 days. For hosts connecting to a domain in the bottom 5% of prevalence, calculate the rate of subsequent child process creation. If this rate exceeds 3 standard deviations above the host's baseline process creation rate, flag for investigation.",
              "Machine Learning: Develop a 'suspicious sequence' model using a graph-based approach. Create nodes for hosts, domains, and processes. An edge is created from a host to a domain upon connection, and from a host to a process upon execution. Use a graph learning algorithm to identify and score rare and high-risk paths, such as [Host] -> [Rare Domain] -> [Suspicious Process]."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]