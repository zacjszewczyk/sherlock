[
  {
    "information_requirement": "Is the adversary conducting reconnaissance using spearphishing via voice? (PIR)",
    "tactic_id": "TA0043",
    "tactic_name": "Reconnaissance",
    "indicators": [
      {
        "technique_id": "T1598.004",
        "name": "Spearphishing Voice",
        "evidence": [
          {
            "description": "An internal host initiates a network connection to an external domain or IP address known to be part of a vishing or callback phishing campaign's infrastructure.",
            "data_sources": [
              "Zeek dns.log",
              "Zeek conn.log",
              "Zeek http.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network egress points, DNS resolvers",
            "action": [
              "Symbolic: Perform a join between network connection logs (Zeek conn.log destination IPs, dns.log queries, http.log host headers) and a threat intelligence feed of known vishing/callback phishing indicators (domains, IPs). Generate a high-priority alert for any match.",
              "Statistical: For domains not on a threat list, calculate the domain's age and historical prevalence in the organization. Flag connections to domains younger than 30 days that have been visited by fewer than 5 unique internal hosts. Calculate the entropy of the subdomain; a high entropy score (e.g., >3.5) can indicate algorithmically generated domains used in phishing.",
              "Machine Learning: Use a pre-trained classification model (e.g., a gradient boosting classifier) to score DNS queries and HTTP requests for maliciousness. Features for the model should include domain age, TLD, character distribution, query/response size, and presence of keywords like 'support', 'login', 'verify'. A high probability score from the model triggers an alert for analyst review."
            ]
          },
          {
            "description": "Installation or execution of a remote administration tool (e.g., AnyDesk, TeamViewer, ScreenConnect, Quick Assist) on a host where it is not standard, authorized software.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 11707",
              "Windows Event ID 4697"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, Help desk systems",
            "action": [
              "Symbolic: Create and maintain an explicit allow-list of approved remote administration tools and their corresponding process names and hashes. Monitor for process creation events (Windows Event ID 4688) or software/service installations (Windows Event ID 11707, 4697) of tools not on this list. Any execution or installation of a disallowed tool generates an alert.",
              "Statistical: Establish a baseline of remote administration tool usage per user and host. Calculate the prevalence of each tool across the environment. Flag any execution of a tool that is statistically rare for a specific user, their department, or the organization as a whole (e.g., prevalence < 1st percentile). Also, flag first-time executions of any remote admin tool on a given host.",
              "Machine Learning: Train a time-series anomaly detection model (e.g., LSTM) on the frequency and timing of remote administration tool executions per user. The model learns the normal 'rhythm' of legitimate use (e.g., IT staff using it during business hours). An execution that the model flags as a significant temporal anomaly (e.g., a marketing user running TeamViewer at 2 AM) should be alerted on."
            ]
          },
          {
            "description": "A user's host downloads a container file (e.g., ISO, ZIP, VHD) from an external source, followed by the execution of a script or LNK file from within the mounted or uncompressed file within a short time window.",
            "data_sources": [
              "Zeek files.log",
              "Windows Event ID 4688",
              "Windows Event ID 5156"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network egress points, User workstations, Email gateway",
            "action": [
              "Symbolic: Create a rule that triggers when a container file (.iso, .vhd, .zip) is downloaded (Zeek files.log mime_type or filename) and is followed within 5 minutes on the same host by a process creation event (Windows Event ID 4688) where the executable path is on a removable/mounted drive and the process is a scripting host (wscript.exe, powershell.exe, mshta.exe).",
              "Statistical: Profile the rarity of file MIME types downloaded per user from external sources. Alert when a user downloads a file type (e.g., 'application/x-iso9660-image') that is in the bottom 5th percentile of file types they normally download. Correlate this with the statistical rarity of the source domain or IP address to increase confidence.",
              "Machine Learning: Use a sequence analysis model to detect the chain of events: [Download ISO/ZIP] -> [Mount/Unpack] -> [Execute LNK/Script]. Train the model on labeled benign and malicious event sequences from endpoint logs. An observed sequence that the model classifies as malicious with high confidence should generate an alert."
            ]
          },
          {
            "description": "A user account performs a successful remote login (e.g., VPN, RDP) from a new or geographically anomalous location shortly after browsing to a suspicious website, such as a newly registered domain.",
            "data_sources": [
              "Zeek http.log",
              "Windows Event ID 4624",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network egress points, VPN concentrators, Domain Controllers, Cloud IAM services",
            "action": [
              "Symbolic: Correlate web browsing logs (Zeek http.log) to domains flagged by threat intelligence as phishing or suspicious with a subsequent successful remote logon (Windows Event ID 4624, Logon Type 3 or 10) from the same user account within a 15-minute window. This direct correlation indicates a potential credential compromise.",
              "Statistical: For each user, establish a baseline of common login attributes: source ASN, source country, time of day, and day of week. Use a scoring system where a login deviates from the norm (e.g., new country = +3, after-hours = +1). If the total score exceeds a statistically-derived threshold (e.g., 95th percentile of all user login scores), flag the login as anomalous, especially if preceded by browsing to a newly registered domain.",
              "Machine Learning: Implement a User and Entity Behavior Analytics (UEBA) platform or a custom peer-grouping model. The model clusters users with similar roles and behaviors. An alert is generated when a user's login behavior (geography, time, velocity) deviates significantly from both their own historical baseline and the baseline of their established peer group."
            ]
          },
          {
            "description": "A browser or office application process spawns a scripting host (e.g., PowerShell, Wscript) which subsequently establishes a new external network connection.",
            "data_sources": [
              "Windows Event ID 4688",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, Terminal servers",
            "action": [
              "Symbolic: Create a detection rule for a process creation event (Windows Event ID 4688 with command line logging enabled) where the Parent Process Name is a browser (chrome.exe, msedge.exe) or Office application (winword.exe, excel.exe) and the New Process Name is a scripting host (powershell.exe, wscript.exe, cscript.exe, mshta.exe). This is a highly suspicious parent-child relationship.",
              "Statistical: Analyze process command-line arguments for entropy and length. Calculate a baseline for normal command lines for processes like powershell.exe. Flag executions where the command line has unusually high entropy or length (e.g., exceeding the 99th percentile), which often indicates obfuscated or encoded commands common in malicious payloads.",
              "Machine Learning: Train a classification model to distinguish between benign and malicious PowerShell scripts based on abstracted syntax trees (AST) and token sequences. Feed the command-line arguments from powershell.exe executions (captured in Windows Event ID 4688) into the model. An execution classified as malicious with high probability triggers an alert."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]