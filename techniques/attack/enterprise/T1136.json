[
  {
    "information_requirement": "Has the adversary established persistence by creating unauthorized accounts?",
    "tactic_id": "TA0003",
    "tactic_name": "Persistence",
    "indicators": [
      {
        "technique_id": "T1136",
        "name": "Create Account",
        "evidence": [
          {
            "description": "A new local or domain user account is created (Windows Event ID 4720) where the 'Target Account Name' field matches a known malicious pattern, a value from a threat intelligence feed, or a default name generated by a known hacking tool.",
            "data_sources": [
              "Windows Event ID 4720"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": [
              "Domain Controllers",
              "Critical Application Servers",
              "Administrator Workstations"
            ],
            "action": [
              "Symbolic: Create a watch list of known malicious account usernames and suspicious naming conventions using regular expressions (e.g., '.*admin.*', '.*backup.*', 'support_[a-f0-9]{8}'). Ingest threat intelligence feeds for new adversary-related usernames. Configure a SIEM rule to generate a high-priority alert when the 'TargetUserName' field in a Windows Event ID 4720 matches any entry on this watch list.",
              "Statistical: Calculate the rate of account creations per hour across the enterprise. Establish a baseline using a 30-day moving average and standard deviation. Generate a medium-priority alert if the hourly account creation count exceeds 3 standard deviations above the baseline, indicating a potential mass account creation event.",
              "Machine Learning: Train a classification model (e.g., Random Forest) on historical account creation events, using features such as the creator account, time of day, day of week, and username string characteristics (length, character types). Label historical events as 'benign' or 'suspicious'. Use the trained model to score new account creation events in real-time for their probability of being malicious."
            ]
          },
          {
            "description": "Process creation (Windows Event ID 4688) for 'net.exe', 'net1.exe', 'wmic.exe', or 'powershell.exe' with command-line arguments indicative of account creation (e.g., '/add', 'New-LocalUser', 'useraccount create') where the parent process is not a standard administrative tool (e.g., 'explorer.exe', 'cmd.exe' run by an admin) but is instead a web server process ('w3wp.exe'), Office application, or a non-interactive shell.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 4720",
              "Windows Event ID 4722"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": [
              "Domain Controllers",
              "Web Servers",
              "User Endpoints"
            ],
            "action": [
              "Symbolic: Create a detection rule that triggers on Windows Event ID 4688 when the 'ProcessName' is 'net.exe', 'wmic.exe', or 'powershell.exe' AND the 'CommandLine' contains keywords like '/add', 'New-LocalUser', 'Enable-LocalUser', or 'useraccount create'. Raise the alert priority if the 'ParentProcessName' is on a list of suspicious parents, such as 'w3wp.exe', 'WINWORD.EXE', 'EXCEL.EXE', or 'svchost.exe'.",
              "Statistical: For each parent-child process relationship involving account creation utilities, build a frequency table of common parent processes. Calculate the rarity of each observed parent process for these specific child processes. Alert when a parent-child combination falls below a low percentile threshold (e.g., < 1st percentile), indicating a highly anomalous execution chain.",
              "Machine Learning: Use a time-series anomaly detection model (e.g., LSTM) on process creation events. Model the sequence of processes leading up to an account creation command to learn normal administrative workflows. Flag any sequence of process creations that significantly deviates from learned normal patterns before an account is created."
            ]
          },
          {
            "description": "An account creation event (Windows Event ID 4720) is followed within a short time window (e.g., < 5 minutes) by an event adding the new account to a privileged group (Windows Event ID 4728, 4732, 4756), where the creating user is not on an approved list of administrators or the event occurs outside of a pre-defined change management window.",
            "data_sources": [
              "Windows Event ID 4720",
              "Windows Event ID 4728",
              "Windows Event ID 4732",
              "Windows Event ID 4756"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": [
              "Domain Controllers",
              "Active Directory Federation Services (ADFS)",
              "Human Resources Systems"
            ],
            "action": [
              "Symbolic: Maintain an explicit allow-list of user accounts authorized to create new accounts and a list of highly privileged groups (e.g., 'Domain Admins', 'Administrators'). Create a correlation rule that triggers when an account creation event (4720) is initiated by a user not on the allow-list OR if a new account is added to a privileged group (4728, 4732, 4756) within 10 minutes of its creation (4720).",
              "Statistical: For each administrator, profile the distribution of days and times they typically create user accounts. For each new account creation event (4720), calculate the z-score for the time of creation based on the specific administrator's historical activity. Alert if the z-score exceeds a threshold (e.g., > 3), indicating creation at a highly unusual time for that specific admin.",
              "Machine Learning: Develop a sequence analysis model to learn the typical chain of events for provisioning a new user (e.g., HR ticket -> account creation -> group assignment). Ingest logs from HR systems, ITSM tools, and Active Directory. Use this model to identify account creations that occur without a preceding, corresponding authorization event in the ticketing or HR system, flagging them as policy violations."
            ]
          },
          {
            "description": "A new account is created (Windows Event ID 4720) where the username string exhibits a high character entropy, suggesting randomness, or has a low Levenshtein distance to an existing privileged account's username, suggesting typosquatting, when compared against the baseline of all existing usernames.",
            "data_sources": [
              "Windows Event ID 4720"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": [
              "Domain Controllers",
              "Member Servers"
            ],
            "action": [
              "Symbolic: Define a regular expression that codifies the standard corporate username format (e.g., '^[a-z]+\\.[a-z]+$'). Run this regex against the 'TargetUserName' field for every Windows Event ID 4720. Alert on any new username that does not match the established pattern.",
              "Statistical: Periodically calculate the character entropy for all existing usernames to establish a baseline distribution. For each new account creation (Event ID 4720), calculate the entropy of the new username. Alert if the entropy score is in the top 99th percentile of the baseline distribution. Additionally, calculate the Levenshtein distance between the new username and all existing privileged usernames; alert if the distance is 1 or 2.",
              "Machine Learning: Use a one-class SVM or an autoencoder trained on the character-level sequences of all legitimate existing usernames. This model will learn the 'shape' of a normal username. Feed each new username (from Event ID 4720) into the model. If the model flags the new name as an outlier or has a high reconstruction error, generate an alert for a potentially anomalous username."
            ]
          },
          {
            "description": "A new account creation (Windows Event ID 4720) is correlated with a subsequent interactive logon (Windows Event ID 4624, Logon Type 2 or 10) by that same account, or with anomalous network traffic (Zeek conn.log) originating from the host where the account was created, all within a short timeframe (e.g., < 15 minutes).",
            "data_sources": [
              "Windows Event ID 4720",
              "Windows Event ID 4624",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": [
              "Domain Controllers",
              "User Endpoints",
              "Network Egress Points"
            ],
            "action": [
              "Symbolic: Create a correlation rule that looks for a Windows Event ID 4720 (account created) followed within 15 minutes by a Windows Event ID 4624 (logon) where the 'TargetUserName' is the same in both events and the Logon Type is 2 (Interactive) or 10 (RemoteInteractive). Generate a high-priority alert on this sequence.",
              "Statistical: For each host, baseline the volume and destination port distribution of outbound network traffic using Zeek conn.log. After an account is created on a host (Event 4720), monitor its outbound traffic for the next hour. Alert if there is a statistically significant spike in traffic volume or if connections are made to ports that are rare for that host (e.g., outside the top 95% most common ports).",
              "Machine Learning: Use a graph-based analysis model where nodes are users and hosts. An account creation (4720) followed by a logon (4624) and network connections (Zeek conn.log) forms a subgraph. Apply anomaly scoring algorithms to find isolated subgraphs where a new user node is created and immediately becomes active, forming connections to unusual external nodes."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.2",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]