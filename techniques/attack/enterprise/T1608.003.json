[
  {
    "information_requirement": "Is the adversary developing resources by acquiring and installing digital certificates for their infrastructure? (PIR)",
    "tactic_id": "TA0042",
    "tactic_name": "Resource Development",
    "indicators": [
      {
        "technique_id": "T1608.003",
        "name": "Install Digital Certificate",
        "evidence": [
          {
            "description": "An outbound SSL/TLS connection is established with a remote server whose certificate hash (SHA1), serial number, or Subject Alternative Name (SAN) exactly matches an entry in a high-confidence threat intelligence feed of known malicious indicators.",
            "data_sources": [
              "Zeek ssl.log",
              "Zeek x509.log",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network Egress/Ingress Points",
            "action": [
              "Symbolic (IOC Match): Extract certificate SHA1 hash, serial number, and Subject/SAN from Zeek x509.log and ssl.log for all outbound connections. Cross-reference these values against a threat intelligence database of known malicious certificates. Generate a high-priority alert for any exact match.",
              "Statistical (Indicator Enrichment): For every IOC match, enrich the alert with statistical context. Calculate the historical frequency of connections to the matched IP/domain from Zeek conn.log over the last 90 days. An IOC match on a destination with zero or very low historical contact frequency (e.g., fewer than 5 connections) significantly increases the alert's severity.",
              "Machine Learning (Threat Feed Scoring): Develop or use a machine learning model to score the reliability of threat intelligence feeds. The model should consider features like the feed's age, the provider's reputation, historical true/false positive rates, and the TTPs associated with the indicator. Apply this score to IOC matches to dynamically prioritize alerts, flagging high-confidence matches for immediate investigation."
            ]
          },
          {
            "description": "An outbound SSL/TLS connection uses a certificate exhibiting one or more suspicious attributes, such as a subject domain with a Levenshtein distance of 1 or 2 from a known company domain, a certificate validity period of less than 90 days, or issuance from a free Certificate Authority (CA) for a recently registered domain (domain age < 30 days).",
            "data_sources": [
              "Zeek ssl.log",
              "Zeek x509.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network Egress Points",
            "action": [
              "Symbolic (Rule-Based): Create a rule that flags SSL/TLS sessions where: (1) the certificate issuer in x509.log is a known free CA (e.g., 'Let's Encrypt', 'ZeroSSL'), AND (2) the certificate subject domain has a WHOIS creation date less than 30 days old, AND (3) the subject does not match any registered corporate domains. Also, flag certificates where the subject common name (CN) in x509.log does not match the Server Name Indication (SNI) from ssl.log.",
              "Statistical (Typosquatting Detection): For each certificate subject domain from x509.log, calculate the Levenshtein distance against a list of the organization's legitimate domains and major partner domains. Profile the distribution of these distances. Flag any domain with a distance of 1 or 2, as these are highly indicative of typosquatting. Correlate with low domain reputation scores or recent registration dates to increase confidence.",
              "Machine Learning (Suspicious Certificate Classification): Train a classification model (e.g., Random Forest, Gradient Boosting) to predict if a certificate is suspicious. Use features from Zeek x509.log and ssl.log, such as: certificate validity duration, key length, signature algorithm, issuer (one-hot encoded), number of SANs, presence of generic subject fields (e.g., 'localhost'), and the statistical typosquatting score. Use a labeled dataset of known benign and malicious certificates for training."
            ]
          },
          {
            "description": "A statistically significant deviation from the established baseline of SSL/TLS certificate characteristics is observed across the enterprise, such as a sharp increase in the daily count of newly-observed certificate issuers or a cluster of certificates with unusually low entropy in their subject names.",
            "data_sources": [
              "Zeek x509.log",
              "Zeek ssl.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "SIEM/Data Lake",
            "action": [
              "Symbolic (New Certificate Alerting): Maintain a state table (lookup file) of all certificate SHA1 hashes and issuers seen in the last 90 days. Create a rule to alert every time a connection occurs to a server presenting a certificate with a hash or an issuer not present in the state table. Triage these alerts by cross-referencing with other suspicious indicators.",
              "Statistical (Entropy Analysis): For each new certificate subject (CN) and issuer (O) from x509.log, calculate the Shannon entropy of the string. Establish a baseline distribution of entropy scores for legitimate certificates. Flag certificates with entropy scores that fall in the bottom 5th percentile, as these often correspond to default configurations or randomly generated domains.",
              "Machine Learning (Time Series Anomaly Detection): Model the daily count of new, first-seen certificate issuers from x509.log as a time series (e.g., using SARIMA or Prophet). Configure the model to detect anomalies, defined as observations that fall outside the 99% prediction interval. An alert on a given day indicates a statistically unusual spike in new issuers being contacted, which could signify a widespread campaign."
            ]
          },
          {
            "description": "A single internal source IP address communicates with an anomalously high number of distinct external destinations, where each destination presents a certificate that is either self-signed, has a short validity period (<90 days), or was first observed within the last 24 hours.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek ssl.log",
              "Zeek x509.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Core Network Switches",
            "action": [
              "Symbolic (Beaconing Detection): For each internal source IP, count the number of connections to distinct destination IPs over a 1-hour window where the x509.log validation_status is 'self-signed'. Alert if this count exceeds a static threshold (e.g., 5), as this may indicate beaconing to adversary infrastructure.",
              "Statistical (Outlier Detection): Over a 24-hour period, for each internal source IP, calculate the count of distinct destination IPs contacted where the certificate was newly observed (first seen in the last 24 hours). Calculate the 99th percentile for this count across all internal source IPs. Any host exceeding this dynamic threshold is flagged as an outlier for investigation, potentially indicating C2 communication.",
              "Machine Learning (Community Detection/Clustering): Construct a bipartite graph where one set of nodes represents internal hosts and the other represents external certificate hashes. Create an edge if a host connects to a server with that certificate. Apply a community detection algorithm (e.g., Louvain Modularity) to this graph. A small, dense community of a few internal hosts connecting to a shared set of suspicious external certificates is a strong indicator of a targeted intrusion."
            ]
          }
        ]
      }
    ],
    "version": "2.2",
    "date_created": "2025-05-04",
    "last_updated": "2025-09-30",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]