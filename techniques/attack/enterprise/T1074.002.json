[
  {
    "information_requirement": "Is the adversary collecting and staging data from multiple systems for exfiltration?",
    "tactic_id": "TA0009",
    "tactic_name": "Collection",
    "indicators": [
      {
        "technique_id": "T1074.002",
        "name": "Remote Data Staging",
        "evidence": [
          {
            "description": "An archive file is created whose filename or SHA256 hash matches a known-bad indicator from an external threat intelligence source.",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 4663"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Common staging directories (%TEMP%, %PUBLIC%, C:\\Perflogs), file servers, and domain controllers.",
            "action": [
              "Symbolic: Continuously monitor file creation (Windows Event ID 4663) and process creation (Windows Event ID 4688) events. For any created file with an archive extension (.zip, .rar, .7z, .tar, .gz), compare its SHA256 hash and filename against threat intelligence feeds of known malicious indicators. Generate a high-severity alert on any match.",
              "Statistical: Establish a baseline for processes that legitimately create archive files (e.g., '7z.exe', 'WinRAR.exe', 'backup.exe'). For each process name, calculate the hourly frequency of archive file creation. Alert if a process not on the established allow-list creates an archive, or if any process's hourly creation count exceeds the 95th percentile of its historical activity.",
              "Machine Learning: Deploy a supervised classification model (e.g., Random Forest) trained on features from file creation and parent process events. Features should include: parent process name, process command-line entropy, file extension, and target directory reputation. Alert on any file creation event classified as malicious with a confidence score greater than 0.9."
            ]
          },
          {
            "description": "An archive file (e.g., .zip, .rar, .7z) is created in a directory not typically used for archiving (e.g., C:\\Users\\Public, %TEMP%) by a process not associated with standard backup or user archiving software (e.g., powershell.exe, cmd.exe).",
            "data_sources": [
              "Windows Event ID 4688",
              "Windows Event ID 4663"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, publicly writable network shares, and web server directories.",
            "action": [
              "Symbolic: Define a list of 'sensitive' staging directories (e.g., C:\\, %APPDATA%, C:\\Windows\\Temp, C:\\Perflogs) and an allow-list of 'standard' archiving processes (e.g., '7z.exe', 'WinRAR.exe'). Create a rule that alerts when any process not on the allow-list creates a file with an archive extension in a directory on the sensitive list.",
              "Statistical: For each host, profile parent-child process relationships that result in archive creation. Calculate the historical probability $$ P(\\text{archive creation} | \\text{parent process}) $$. Alert when an archive is created by a process whose parent results in a historically low probability (e.g., $$ P < 0.05 $$), indicating an anomalous chain of execution for this activity.",
              "Machine Learning: Implement a time-series anomaly detection model (e.g., ARIMA or Prophet) on the volume of archive files created per hour, segmented by directory type (e.g., user profile, system temp, public folders). Alert if the observed volume in a sensitive directory type significantly deviates from the forecasted volume, indicating a surge in staging activity."
            ]
          },
          {
            "description": "A host receives an anomalously high volume of inbound data or number of unique internal connections, and within a short time window, a large archive file is created on that host, suggesting it is being used as a collection point.",
            "data_sources": [
              "Zeek conn.log",
              "Windows Event ID 4663",
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internal network segments (core switches), critical servers (file servers, database servers), and the DMZ.",
            "action": [
              "Symbolic: Create a SIEM correlation rule that triggers when a host's 'id.dest_h' in Zeek conn.log receives connections from more than 10 unique internal source IPs ('id.orig_h') within a 5-minute window, AND a subsequent file creation event (Windows Event ID 4663) for a file >100MB with an archive extension occurs on that same host within the next 10 minutes.",
              "Statistical: Using Zeek conn.log, establish a per-host baseline for total inbound bytes ('resp_bytes') and the count of unique source IPs ('id.orig_h') over a 15-minute rolling window. Generate a medium-severity alert if either metric exceeds 3 standard deviations from the host's historical norm. If a subsequent file creation event (Windows Event ID 4663) for a large archive (>100MB) occurs on the same host within 10 minutes, automatically escalate the alert to high-severity.",
              "Machine Learning: Apply a clustering algorithm (e.g., DBSCAN) to Zeek conn.log data, using features such as destination host, count of unique source hosts, and sum of bytes transferred. Hosts identified as cluster centroids represent potential data aggregators. Correlate these network-identified aggregators with host-based process execution logs (Windows Event ID 4688) on those specific hosts to identify archiving or compression commands executed shortly after the aggregation activity."
            ]
          },
          {
            "description": "A single command-line execution (e.g., via cmd.exe, powershell.exe, robocopy) references multiple, distinct source directories and a single destination file, particularly one with an archive or temporary extension.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Domain Controllers, administrator workstations, and servers hosting development or source code repositories.",
            "action": [
              "Symbolic: Using regular expressions, parse command lines from process creation events (Windows Event ID 4688). Alert on commands executed by 'cmd.exe', 'powershell.exe', or 'robocopy.exe' that contain file copy verbs (e.g., 'copy', 'Copy-Item', 'robocopy') and reference more than two distinct parent directory paths as sources (e.g., 'C:\\\\Users\\\\*', 'D:\\\\Projects\\\\*') being copied to a single destination.",
              "Statistical: For each process execution (Windows Event ID 4688), calculate the Shannon entropy of its command-line string. Establish a per-process-name baseline for command-line entropy (e.g., for 'powershell.exe', 'cmd.exe'). Alert when the entropy score for a command involving file manipulation keywords exceeds the 98th percentile for that executable's baseline, indicating unusually high complexity or obfuscation.",
              "Machine Learning: Train a sequence-to-sequence autoencoder on a corpus of benign command-line argument sequences, stratified by process name. Feed new command-line events into the model and alert when the reconstruction error surpasses a dynamically adjusted threshold, indicating a significant structural deviation from normal command patterns."
            ]
          },
          {
            "description": "A single process or user context generates a high volume of file read events across many distinct directories within a short time frame, deviating from its established baseline of file access behavior.",
            "data_sources": [
              "Windows Event ID 4663"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "File shares containing PII, financial, or intellectual property data, user home directories, and code repositories.",
            "action": [
              "Symbolic: Prerequisite: Enable file/folder access auditing (SACL) on critical directories. Create a rule that alerts if a process typically associated with network services (e.g., 'svchost.exe', 'httpd.exe', 'w3wp.exe') is observed reading files (Windows Event ID 4663 with AccessList containing 'ReadData') from directories outside its expected scope, such as user profile folders ('C:\\\\Users\\\\*\\\\Documents\\\\*').",
              "Statistical: For each user and/or process context, build a baseline of the number of unique directories it reads from in a 1-hour window using Windows Event ID 4663. Use a percentile-based threshold (e.g., 99th percentile) to detect when a context suddenly reads from an anomalously high number of directories, suggesting a wide-ranging file gathering operation.",
              "Machine Learning: Model file access events as a bipartite graph where nodes represent processes and files/directories. Use a graph-based anomaly detection algorithm to identify the sudden formation of a 'star' or 'hub-and-spoke' pattern, where a single process node rapidly creates edges (reads) to a large number of previously unassociated file nodes. This pattern is a strong indicator of a mass-read event characteristic of data staging."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.3",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]