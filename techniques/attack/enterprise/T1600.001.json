[
  {
    "information_requirement": "Has the adversary attempted to evade defenses by weakening encryption on network devices?",
    "tactic_id": "TA0005",
    "tactic_name": "Defense Evasion",
    "indicators": [
      {
        "technique_id": "T1600.001",
        "name": "Reduce Key Space",
        "evidence": [
          {
            "description": "A file transfer event is observed where the destination is a managed network device and the file's hash (MD5, SHA1, or SHA256) is present on a threat intelligence feed of compromised firmware.",
            "data_sources": [
              "Zeek files.log",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network management VLANs, administrative jump boxes, core routers and switches, VPN concentrators",
            "action": [
              "Symbolic: Query Zeek files.log for file transfers where the destination IP is in the asset list of network devices and the file's MD5 or SHA1 hash matches a known-bad hash from a threat intelligence feed.",
              "Statistical: Analyze Zeek files.log to establish a baseline of typical file transfer sizes, types (MIME types), and protocols (e.g., TFTP, SCP, FTP) to network devices. Alert when a transfer's size exceeds the 95th percentile of historical transfers, or if an unusual protocol or MIME type is used, especially outside of a defined maintenance window.",
              "Machine Learning: Use a classification model (e.g., a decision tree) trained on historical file transfers to network devices. Features could include source/destination subnet, protocol, file size, MIME type, and time of day. The model should classify transfers as 'authorized' or 'suspicious', flagging those with characteristics similar to known malicious firmware pushes."
            ]
          },
          {
            "description": "A process creation event (Windows Event ID 4688) is logged on a designated administrative host, showing the execution of a network management utility (e.g., plink.exe, scp.exe) with command-line arguments containing keywords like 'copy', 'tftp', 'firmware', '.bin', or '.img', directed at a network device's IP address.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Designated network administration workstations, jump servers, and configuration management servers",
            "action": [
              "Symbolic: Create a detection rule that triggers on Windows Event ID 4688 where the 'ProcessName' is a known network CLI tool (e.g., 'plink.exe', 'tftp.exe', 'scp.exe') and the 'CommandLine' contains both an IP from the network device asset list and keywords such as 'copy', 'upgrade', '.bin', or '.pkg'.",
              "Statistical: For each administrative user, build a profile of normal command-line execution frequency and argument patterns. Calculate the entropy of command-line arguments for network management tools. An alert is generated if a command's argument entropy score is an outlier (e.g., > 3 standard deviations from the user's mean) or if the execution occurs at a time statistically rare for that user.",
              "Machine Learning: Employ a sequence analysis model (e.g., an LSTM) to learn typical sequences of commands executed by network administrators. Flag command sequences that deviate significantly from learned legitimate administrative workflows, such as an unexpected file transfer command following a series of reconnaissance commands."
            ]
          },
          {
            "description": "A measurable shift in the distribution of cryptographic protocols observed in traffic to or from a managed network device, characterized by a statistically significant increase in the proportion of connections using weak ciphers (e.g., RC4, 3DES), deprecated protocol versions (e.g., SSLv3, TLS 1.0), or short key lengths (e.g., < 2048-bit RSA).",
            "data_sources": [
              "Zeek ssl.log",
              "Zeek ssh.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network traffic inspection points monitoring connections to and from critical infrastructure like VPN gateways, external-facing firewalls, and core switches",
            "action": [
              "Symbolic: Create a watchlist of deprecated SSL/TLS versions (e.g., 'SSLv3', 'TLSv1'), weak ciphers (e.g., 'TLS_RSA_WITH_RC4_128_MD5', 'TLS_RSA_EXPORT_WITH_DES40_CBC_SHA'), and weak SSH algorithms. Alert on any connection in Zeek ssl.log or ssh.log to or from a network device IP that uses a watched item.",
              "Statistical: For each critical network device, establish a 30-day rolling baseline of the distribution of ciphers and TLS versions used in connections (from Zeek ssl.log). Generate an alert if the proportion of weak ciphers in a 1-hour window increases by more than 3 standard deviations above the baseline mean, or if the percentage of connections using deprecated protocols exceeds a predefined threshold (e.g., 5%).",
              "Machine Learning: Use time series analysis (e.g., ARIMA) to forecast the expected volume of connections for each cipher suite and TLS version. An alert is triggered when the observed volume of a weak cipher suite significantly exceeds the forecasted volume with its confidence interval, indicating an anomalous spike in weak crypto usage."
            ]
          },
          {
            "description": "A sequence of events is observed: 1) A file transfer to a network device with a size consistent with firmware (e.g., >10MB). 2) A subsequent period of unreachability for that device, inferred from a lack of traffic or connection state resets. 3) Upon restoration of connectivity, the device's traffic profile exhibits anomalous characteristics, such as new communication peers or different protocol distributions.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek files.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Core network taps, network device management subnets, and perimeter monitoring points",
            "action": [
              "Symbolic: Create a correlation rule that triggers when a 'file_transfer_to_network_device' event (from Zeek files.log) is followed within 15 minutes by a 'device_unreachable' event (inferred from ICMP failures or lack of syslog/SNMP), and then followed by a 'new_external_communication' event from the same device IP (from Zeek conn.log).",
              "Statistical: Identify large file transfers (>98th percentile of file sizes) to network devices. Then, for the 60 minutes following the transfer, monitor the device's traffic in Zeek conn.log. Calculate the Jaccard similarity index between the set of destination IPs/ports in the hour before the transfer and the hour after. An alert is generated if the similarity score drops below a threshold (e.g., 0.5).",
              "Machine Learning: Implement a multi-stage detection model. Stage 1: A classifier identifies suspicious file transfers. Stage 2: A time series anomaly detection model monitors device heartbeat/traffic volume to detect reboots. Stage 3: A clustering algorithm (e.g., DBSCAN) analyzes the post-reboot traffic features (destination IPs, ports, protocols). If the post-reboot traffic forms a new, distinct cluster from the device's historical baseline, flag the sequence."
            ]
          },
          {
            "description": "A network device, such as a router or firewall, initiates or receives connections with internal or external IP addresses not on its established list of management hosts, peers, or expected traffic sources/destinations. This includes the use of protocols outside its defined functional baseline (e.g., a core switch making DNS requests to a public resolver).",
            "data_sources": [
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Egress/ingress traffic points, DNS server logs, and intra-VLAN traffic monitoring points",
            "action": [
              "Symbolic: Maintain an asset-based allow-list of expected communication peers and protocols for each class of network device. Alert on any connection in Zeek conn.log where a network device's IP is the source or destination and the remote peer or protocol/port combination is not on the explicit allow-list.",
              "Statistical: For each network device, build a baseline of communication partners by calculating the frequency of connections to every remote IP over a 30-day period. Use a 'first-seen' model to identify connections to IPs in the bottom 5th percentile of frequency (rare connections) and flag them for review, especially if the connection uses a non-standard port.",
              "Machine Learning: Use a graph-based anomaly detection algorithm. Model the network as a graph where nodes are devices/IPs and edges are connections from Zeek conn.log. Train the model on historical data to score new connections based on their likelihood, flagging edges that are topologically surprising (e.g., a device connecting to a previously disconnected part of the graph)."
            ]
          }
        ]
      }
    ],
    "version": "2.2",
    "date_created": "2025-05-04",
    "last_updated": "2025-09-30",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]