[
  {
    "information_requirement": "Is the adversary attempting to cause a denial of service via direct network flooding? (PIR)",
    "tactic_id": "TA0040",
    "tactic_name": "Impact",
    "indicators": [
      {
        "technique_id": "T1498.001",
        "name": "Direct Network Flood",
        "evidence": [
          {
            "description": "An anomalous percentage of inbound traffic volume and/or connection count targeting a specific service originates from source IPs matching a known DDoS/botnet threat intelligence feed.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Internet gateways, Border routers and firewalls, External-facing web servers, DNS servers",
            "action": [
              "Symbolic: Query Zeek conn.log for connections where `id.orig_h` matches a threat intelligence feed of known botnet C2 or DDoS attack sources. Generate a high-severity alert for any match.",
              "Statistical: Over 1-minute windows, calculate the percentage of total inbound bytes (`orig_bytes`) and connection counts from source IPs on the threat intel list. Alert if this percentage exceeds the 99th percentile of the historical 30-day baseline for that specific destination service.",
              "Machine Learning: Utilize a time series forecasting model (e.g., ARIMA, Prophet) to predict the expected volume of traffic from threat intel-listed IPs. Trigger an alert when the observed volume significantly exceeds the forecasted volume's confidence interval, indicating an active, coordinated campaign."
            ]
          },
          {
            "description": "A high volume of network traffic exhibits packet-level characteristics (e.g., fixed packet size, unusual IP fragmentation, specific TCP flag combinations) that match signatures of known DDoS attack tools.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek notice.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network security monitoring sensors (e.g., Zeek sensors at network chokepoints), DMZ segments",
            "action": [
              "Symbolic: Deploy and monitor Zeek scripts or SIEM rules that check for static flood tool signatures, such as a fixed packet size of 1024 bytes in a UDP flood or unusual TCP flag combinations (e.g., SYN+FIN), and alert on a match.",
              "Statistical: For a given destination service, calculate the standard deviation of packet sizes for all inbound traffic within a 30-second window. Alert when the standard deviation approaches zero (e.g., falls below the 5th percentile of its baseline) while the packets-per-second (PPS) rate is anomalously high (e.g., above the 95th percentile).",
              "Machine Learning: Train a supervised classification model (e.g., Random Forest, Gradient Boosting) on labeled packet capture data to distinguish between benign traffic and various flood types. Apply this model in near-real-time to classify traffic flows based on features like protocol, packet length, inter-arrival time, and TCP flags."
            ]
          },
          {
            "description": "A sustained surge in packets-per-second (PPS) or bytes-per-second (BPS) targeting a specific host or service that exceeds the 99th percentile of the established 30-day baseline for that asset.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Critical application servers (e.g., authentication, database), Network load balancers, API Gateways",
            "action": [
              "Symbolic: Establish a static, high-watermark threshold for packets-per-second (e.g., 50,000 PPS) and bytes-per-second (e.g., 1 Gbps) for critical services. Generate a critical alert if this threshold is breached for more than 10 consecutive seconds.",
              "Statistical: For each critical service (destination IP/port), maintain a rolling 30-day baseline of PPS and BPS in 1-minute intervals. Alert when the current traffic rate exceeds the 99th percentile of this baseline for three consecutive intervals.",
              "Machine Learning: Implement a time series anomaly detection model (e.g., Seasonal-Hybrid ESD, Isolation Forest) on PPS and BPS data for key services to identify observations that are anomalous and not explained by normal cyclical patterns (e.g., time of day, day of week)."
            ]
          },
          {
            "description": "A sudden, statistically significant decrease in the Shannon entropy of source IPs, source ports, or protocols for traffic destined to a specific service, indicating a shift from diverse, legitimate traffic to a homogenous flood.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Public-facing DNS and NTP servers, API gateways, VoIP services",
            "action": [
              "Symbolic: Create a rule that alerts if the ratio of a single protocol (e.g., UDP or ICMP) to a service that typically receives diverse protocols (e.g., a web server on TCP/443) exceeds 75% of total traffic for more than one minute.",
              "Statistical: Calculate the Shannon entropy of source IPs, source ports, and protocols for traffic to each critical service over 1-minute windows. Alert if the entropy for any of these fields drops more than two standard deviations below its established baseline mean.",
              "Machine Learning: Use a clustering algorithm (e.g., DBSCAN) on traffic features (protocol, source port range, packet size). The emergence of a new, large, and dense cluster not present in the historical baseline indicates a coordinated, homogenous attack that would cause a drop in entropy."
            ]
          },
          {
            "description": "An anomalous ratio of a high unique source IP count to a low average data volume per source, targeting a single destination service.",
            "data_sources": [
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "VPN concentrators, User authentication services, Customer-facing web portals",
            "action": [
              "Symbolic: Trigger an alert if, within a 1-minute window, the count of unique source IPs (`id.orig_h`) connecting to a service exceeds a hard limit (e.g., 20,000) while the average bytes per connection (`orig_bytes` + `resp_bytes`) is less than a small threshold (e.g., 200 bytes).",
              "Statistical: For each service, calculate the count of unique source IPs and the average bytes transferred per source IP over 5-minute windows. Alert when the source IP count is above its 98th percentile and the average bytes per source is simultaneously below its 10th percentile compared to a 30-day baseline.",
              "Machine Learning: Use a multivariate anomaly detection model (e.g., Isolation Forest) on a feature set including unique source IP count, average bytes per source, and connection rate. This can detect deviations from the learned normal relationship between these metrics, identifying sophisticated low-and-slow floods."
            ]
          },
          {
            "description": "A sharp increase in the count of TCP sessions with a non-established final state (e.g., S0, S1, REJ, RSTR) targeting a specific port, indicating a potential SYN or TCP flood.",
            "data_sources": [
              "Zeek conn.log",
              "Zeek notice.log",
              "Windows Event ID 2004"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Any public-facing server offering TCP-based services (e.g., web, SSH, RDP), Authentication servers",
            "action": [
              "Symbolic: Monitor Zeek notice.log for `Scan::SYN_Flood` or similar notices and trigger a high-severity alert immediately. Correlate with Windows Event ID 2004 (Resource-Exhaustion-Detector) on the target host to confirm impact.",
              "Statistical: From Zeek conn.log, count connections per minute with a `conn_state` of 'S0', 'S1', or 'REJ'. Alert when this count for a specific destination port exceeds three standard deviations above its 30-day baseline mean.",
              "Machine Learning: Train a regression model to predict the expected ratio of established (SF) to non-established (S0, S1, REJ) connections based on time of day and day of week. A large residual error where the actual non-established count is far higher than predicted indicates an anomaly characteristic of a SYN flood."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.3",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk"
    ]
  }
]