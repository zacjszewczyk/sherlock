[
    {
        "information_requirement": "Is the adversary developing or acquiring resources for operations?",
        "tactic_id": "TA0042",
        "tactic_name": "Resource Development",
        "indicators": [
            {
                "technique_id": "T1588.001",
                "name": "Malware",
                "evidence": [
                    {
                        "description": "Detection of files on network shares or traversing the network that match hashes of known malware from threat intelligence feeds.",
                        "data_sources": [
                            "Zeek file.log"
                        ],
                        "data_platforms": [
                            "Network devices"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Continuously capture file hashes from network traffic using Zeek file.log. Correlate these hashes in near real-time against a comprehensive threat intelligence database (e.g., VirusTotal, commercial feeds) of known malware samples. Alert on any match, prioritizing based on malware family, tags, and prevalence."
                    },
                    {
                        "description": "Network connections from internal hosts to external IP addresses, domains, or URLs known to be used for malware distribution or command and control (C2).",
                        "data_sources": [
                            "Zeek conn.log",
                            "Zeek dns.log",
                            "Zeek http.log"
                        ],
                        "data_platforms": [
                            "Network devices"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Inner join network logs (Zeek conn.log destination IPs, Zeek dns.log queries, Zeek http.log host/URI fields) with a high-confidence, continuously updated list of malicious indicators from CTI. Alert on any connection attempts, both successful and blocked, to known malicious infrastructure."
                    },
                    {
                        "description": "Execution of a process with command-line arguments or process ancestry (parent/child relationship) that specifically matches the known signature of a malware family or commodity tool.",
                        "data_sources": [
                            "Windows Event ID 4688"
                        ],
                        "data_platforms": [
                            "Endpoints",
                            "Servers"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Monitor Windows Event ID 4688 for process creation events. Apply a library of rules (e.g., YARA-L, Sigma) that match specific, known command-line patterns or process trees of common malware (e.g., 'powershell.exe -enc ...' launched by winword.exe, specific arguments for Mimikatz, or command structures for Cobalt Strike beacons). Maintain and update this rule library based on threat intelligence reports on specific malware families."
                    },
                    {
                        "description": "A process is created from an unusual file path, has a mismatched name, or is unsigned, which then immediately initiates network communication to a new or rare external destination.",
                        "data_sources": [
                            "Windows Event ID 4688",
                            "Zeek conn.log"
                        ],
                        "data_platforms": [
                            "Endpoints",
                            "Servers",
                            "Network devices"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Correlate process creation events (Windows Event ID 4688) with subsequent network connections (Zeek conn.log) within a short time window (e.g., less than 60 seconds). Profile normal process execution locations, names, and parent processes. Flag deviations such as: execution from temporary directories (%TEMP%, %APPDATA%), process names masquerading as legitimate system processes (e.g., 'svchost.exe' not in System32), or an unsigned process making an outbound connection. Use frequency analysis and entropy measures on file paths and destination IPs to identify rare, anomalous events."
                    },
                    {
                        "description": "An internal host exhibits network communication patterns anomalous for its role, such as periodic 'beaconing' traffic, connections using non-standard ports, or connections to geographically unusual locations, suggesting malware C2 activity.",
                        "data_sources": [
                            "Zeek conn.log",
                            "Zeek ssl.log"
                        ],
                        "data_platforms": [
                            "Network devices"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Analyze Zeek conn.log data to baseline normal network traffic for hosts and subnets. Use time series analysis to detect periodic, fixed-interval connections (beacons) or connections with unusually low/high data transfer volumes. Calculate the entropy of destination ports per host to find those using a wide range of non-standard ports. Geolocate destination IPs and flag connections to countries with which the organization does not typically do business. Use correlation analysis to link these behaviors with anomalous JA3/JA3S hashes in Zeek ssl.log."
                    },
                    {
                        "description": "A file is transferred over the network or created on a host with characteristics suggesting obfuscation or evasion, such as a high-entropy name, double extension, or a mismatch between its extension and actual file type (magic number).",
                        "data_sources": [
                            "Zeek file.log",
                            "Windows Event ID 4663"
                        ],
                        "data_platforms": [
                            "Network devices",
                            "Endpoints",
                            "Servers"
                        ],
                        "nai": "Insert site-specific NAI here",
                        "action": "Analyze files transferred over the network (Zeek file.log) or created locally (e.g., Windows Event ID 4663 or other file auditing events). Calculate the Shannon entropy of filenames to detect randomized or obfuscated names. Use regular expressions to find double extensions (e.g., 'invoice.pdf.exe'). Compare file magic numbers (identified by Zeek or endpoint tools) with file extensions and flag mismatches (e.g., a file named '.jpg' that is actually an executable). Use linear regression to find correlations between these suspicious file characteristics and subsequent process or network anomalies."
                    }
                ]
            }
        ],
        "version": "2.1",
        "date_created": "2025-05-04",
        "last_updated": "2025-07-20",
        "contributors": [
            "Zachary Szewczyk"
        ]
    }
]
