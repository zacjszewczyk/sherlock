[
  {
    "information_requirement": "Has an adversary manipulated data integrity or availability on critical systems? (PIR)",
    "tactic_id": "TA0040",
    "tactic_name": "Impact",
    "indicators": [
      {
        "technique_id": "T1565",
        "name": "Data Manipulation",
        "evidence": [
          {
            "description": "A file write or creation event occurs for a file whose hash matches a known malicious tool associated with data manipulation (e.g., a wiper or ransomware payload).",
            "data_sources": [
              "Sysmon Event ID 11",
              "Windows Event ID 4663",
              "Sysmon Event ID 1"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Critical file servers, database servers, domain controllers, application servers, and user workstations.",
            "action": [
              "Upon a file creation event (Sysmon Event ID 11), calculate the file's hash (e.g., SHA256). Query a threat intelligence database or internal IOC list to check if the hash corresponds to a known data manipulation tool. Generate a high-severity alert upon a match.",
              "For file write events (Windows Event ID 4663) in monitored directories, calculate the Shannon entropy of the first 4KB of the file's content. Establish a baseline entropy score for common file types in these directories. Alert when a file's entropy deviates by more than 3 standard deviations from the baseline for its type, which may indicate encryption or obfuscation.",
              "Train a classification model (e.g., Random Forest) using features from file creation events, such as file extension, path, process context (parent process, user), and file entropy. Use the model to predict the probability that a new file is malicious. Alert on files classified as malicious with a high confidence score (>0.9)."
            ]
          },
          {
            "description": "A process is created using a native utility (e.g., cipher.exe, fsutil.exe) or scripting engine (e.g., powershell.exe) with command-line arguments intended to overwrite, corrupt, or delete data on disk.",
            "data_sources": [
              "Windows Event ID 4688",
              "Sysmon Event ID 1",
              "Zeek files.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "All enterprise endpoints and servers, particularly those hosting critical applications, databases, or file shares.",
            "action": [
              "Monitor process creation events (Windows Event ID 4688, Sysmon Event ID 1) for command lines matching specific regular expressions for data wiping, such as `cipher\\.exe /w:`, `fsutil\\.exe file setzerodata`, or PowerShell scripts containing `Set-Content -Value $null` on multiple files. Generate a critical alert on a regex match.",
              "For each command line executed, calculate the frequency of its parent process, user, and command arguments across the enterprise over a 30-day window. Identify and score commands that are statistically rare (e.g., in the bottom 5th percentile of frequency) for a given user, host, or system role. A rare combination, like a web server service account running `cipher.exe`, should be flagged for review.",
              "Develop a supervised learning model (e.g., Logistic Regression) trained on a labeled dataset of benign and malicious command lines. Use features like command length, special character count, n-grams, and presence of specific keywords (e.g., 'setzerodata', '/w:'). Use this model to score all new command lines in real-time, alerting on those exceeding a predetermined risk threshold."
            ]
          },
          {
            "description": "A user or process generates a volume of file modification or deletion events on a sensitive data repository that exceeds a predefined threshold or a statistically derived baseline within a short time window.",
            "data_sources": [
              "Windows Event ID 4663",
              "Windows Event ID 4659",
              "Sysmon Event ID 23",
              "Sysmon Event ID 26"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Sensitive data repositories, including network file shares, source code management systems, code repositories (e.g., Git servers), and SharePoint sites.",
            "action": [
              "Define a hard threshold rule: alert if any single user account or process generates more than 500 file deletion events (Sysmon Event ID 23/26) within a 5-minute window on a designated critical file server or repository.",
              "For each critical file path, establish a baseline of file modification/deletion events per hour for each user. Use a moving average and standard deviation to model normal activity. Generate an alert when the event count for a user exceeds the 99th percentile or 3 standard deviations above the moving average for that time of day and day of week.",
              "Apply a time-series anomaly detection algorithm (e.g., Seasonal-Hybrid ESD) to the stream of file modification and deletion events for critical servers. This model will learn seasonality (e.g., higher activity during business hours, lower on weekends) and trends, and will alert on spikes that are anomalous given the historical context."
            ]
          },
          {
            "description": "A single process executes a sequence of file read, external network connection, and file write events on the same sensitive file within a short time window, potentially indicating data tampering after exfiltration.",
            "data_sources": [
              "Windows Event ID 4663",
              "Zeek conn.log",
              "Sysmon Event ID 3",
              "Sysmon Event ID 11"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Endpoints of high-value users (e.g., developers, system administrators), servers hosting sensitive data, DMZ servers, and network egress points.",
            "action": [
              "Create a SIEM correlation rule that triggers when, for the same process GUID on the same host within 60 seconds: 1) A file read event (Windows Event ID 4663) on a critical file path is logged, followed by 2) A network connection to a non-local, non-whitelisted IP address (Zeek conn.log or Sysmon Event ID 3), followed by 3) A file write event (Windows Event ID 4663) on the same file path.",
              "Profile the network destinations for processes that typically access sensitive files. Calculate the frequency of destination IPs, ASNs, and countries. Alert when a process, after reading a sensitive file, connects to a destination that is statistically rare (e.g., never-before-seen ASN or a country in the bottom 1% of connection frequency for that process type).",
              "Use a sequence analysis model (e.g., Hidden Markov Model or LSTM) trained on sequences of event logs (file read, file write, network connect, process create). The model learns normal sequences of operations for specific processes. Alert when a new sequence of events has a low probability of occurring based on the trained model, indicating a deviation from normal behavior."
            ]
          },
          {
            "description": "A high volume of file rename operations occurs in a short period, identified by a rapid succession of file delete and file create events by the same process, often resulting in a uniform or randomized file extension pattern.",
            "data_sources": [
              "Sysmon Event ID 11",
              "Sysmon Event ID 23",
              "Windows Event ID 4663"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User workstations, file servers, and backup servers.",
            "action": [
              "Create a rule to alert when a single process generates more than 100 pairs of file delete (Sysmon Event ID 23) and file create (Sysmon Event ID 11) events within one minute, where the new file extension matches a known ransomware pattern (e.g., `.lockbit`, `.crypted`) or is a random string of a specific length.",
              "For each monitored directory, calculate the Shannon entropy of the file extensions present. Monitor for a sudden, sharp decrease in entropy, which indicates that many files are being renamed to the same extension. Concurrently, track the rate of create/delete operations per process per minute and alert if it exceeds the 99.5th percentile of its historical behavior.",
              "Train a clustering algorithm (e.g., DBSCAN) on features of file system activity per process, including the rate of creations, deletions, and file path patterns. Normal user activity and automated processes will form distinct clusters. A mass rename event driven by ransomware would appear as a new, anomalous cluster or as a noise point, triggering an alert."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.3",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]