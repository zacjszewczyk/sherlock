[
  {
    "information_requirement": "Has the adversary collected data from local system clipboards? (PIR)",
    "tactic_id": "TA0009",
    "tactic_name": "Collection",
    "indicators": [
      {
        "technique_id": "T1115",
        "name": "Clipboard Data",
        "evidence": [
          {
            "description": "A process creation event is logged where the executable's hash matches a known malicious signature associated with clipboard data collection tools.",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "All user workstations and remote access servers (RDP/Citrix).",
            "action": [
              "Symbolic: Query process creation logs (Windows Event ID 4688) and compare the process hash against a curated threat intelligence feed containing hashes of known clipboard-scraping malware. Generate a high-severity alert on any match.",
              "Statistical: For any hash match, calculate the prevalence of the parent process across the enterprise over the last 30 days. If the parent process is seen on fewer than 5% of endpoints, increase the alert's risk score.",
              "Machine Learning: Input process metadata (e.g., file path, parent process name, user context, signature status) into a pre-trained binary classification model (e.g., XGBoost, Random Forest) that outputs a risk score. Trigger an alert if the score exceeds a dynamic threshold, allowing detection of unknown variants exhibiting malicious characteristics."
            ]
          },
          {
            "description": "A command line is executed that uses a native clipboard utility (e.g., clip.exe, Get-Clipboard, pbpaste) to redirect or pipe its output to a file or a network utility [2][3].",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "All endpoints, particularly administrator workstations and developer jump boxes.",
            "action": [
              "Symbolic: Using regex, search process command-line logs (Windows Event ID 4688) for patterns indicating clipboard utility output redirection, such as `Get-Clipboard \\| Out-File`, `clip.exe > C:\\...`, or `pbpaste \\| nc [ip] [port]`. Alert on any match.",
              "Statistical: For all commands containing 'Get-Clipboard' or 'clip.exe', calculate the Shannon entropy of the command-line string. Establish a baseline entropy distribution for legitimate administrative scripts. Flag any command whose entropy score is in the top 5% (95th percentile) of the distribution, as this may indicate obfuscation.",
              "Machine Learning: Vectorize command-line arguments (e.g., using TF-IDF on n-grams) and apply a density-based clustering algorithm like DBSCAN. Isolate and investigate commands that are classified as noise or outliers, as they represent structurally unique commands not seen in established clusters of benign activity."
            ]
          },
          {
            "description": "A native clipboard utility (clip.exe, PowerShell's Get-Clipboard) is executed by a parent process not typically associated with interactive user sessions (e.g., explorer.exe, cmd.exe), such as a web server process (w3wp.exe) or system service (services.exe), potentially via programmatic API access [1].",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Application servers (e.g., IIS, Apache), Domain Controllers, and other critical infrastructure servers.",
            "action": [
              "Symbolic: Create and maintain an allow-list of common parent processes for `clip.exe` and `powershell.exe` (e.g., `explorer.exe`, `cmd.exe`, `pwsh.exe`, `powershell_ise.exe`). Alert whenever a clipboard utility is spawned by a parent process not on this list, such as `w3wp.exe`, `services.exe`, or `lsass.exe`.",
              "Statistical: For each unique parent-child process pair (e.g., `w3wp.exe` -> `powershell.exe`), establish a baseline frequency of command-line arguments over a 30-day period. If the argument 'Get-Clipboard' appears and its frequency is a statistical outlier (e.g., >3 standard deviations from the mean for that pair), flag it as anomalous.",
              "Machine Learning: Train a one-class SVM or isolation forest model on features of legitimate parent processes that spawn clipboard utilities (e.g., parent process name, path, user context, session ID). Apply the model to new events; processes flagged as anomalies by the model indicate a high likelihood of a non-standard or malicious parent."
            ]
          },
          {
            "description": "A high frequency of clipboard utility executions (clip.exe, Get-Clipboard) is observed from a single user, host, or process ID within a short time window, suggesting automated polling or scraping activity [4].",
            "data_sources": [
              "Windows Event ID 4688"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "All user workstations and shared terminal servers.",
            "action": [
              "Symbolic: Create a rule to count executions of `clip.exe` or `powershell.exe` with `Get-Clipboard` per user per host. Trigger an alert if the count exceeds a hard threshold within a sliding window (e.g., more than 10 executions in 1 minute).",
              "Statistical: For each user, calculate a baseline of clipboard utility execution frequency (e.g., executions per hour) over a 14-day period. Alert when the current execution count in a 1-hour window exceeds the user's established baseline by a significant margin (e.g., >3 standard deviations).",
              "Machine Learning: Model the time series of clipboard utility execution counts per user using a model like Seasonal-ARIMA or Prophet. The model will learn the normal daily/weekly rhythm of activity for each user. Flag any sudden, high-frequency bursts of activity that the model identifies as anomalous and cannot explain with seasonality."
            ]
          },
          {
            "description": "A process accesses the clipboard and, within a short time window (e.g., under 30 seconds), the same host initiates an outbound network connection to a destination that is rare, uncategorized, or known-malicious.",
            "data_sources": [
              "Windows Event ID 4688",
              "Zeek conn.log",
              "Zeek dns.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "Network egress points (firewalls/proxies) and all endpoints.",
            "action": [
              "Symbolic: In a SIEM, create a correlation rule that triggers when Event A (process creation for `clip.exe` or `Get-Clipboard` from EID 4688) is followed within 30 seconds by Event B (outbound network connection from `Zeek conn.log` on the same host) where the destination IP is on a threat intelligence blocklist. Alert on a successful correlation.",
              "Statistical: For the correlated sequence, use `Zeek dns.log` to find the domain associated with the destination IP. Calculate the prevalence of this domain across the enterprise over the last 90 days. If the domain is in the bottom 1% of least-frequently visited domains, significantly increase the event's risk score.",
              "Machine Learning: Train a sequence analysis model (e.g., Hidden Markov Model or LSTM) on typical user workflows (sequences of process events and network connections). An anomalous sequence, such as 'clipboard access -> network connection to a new IP,' will have a low probability under the trained model and should be flagged for investigation as potential data exfiltration."
            ]
          },
          {
            "description": "A suspicious process (e.g., unsigned, running from a temporary directory) is created, which is then followed by clipboard access and either file creation in a staging directory or an outbound network connection.",
            "data_sources": [
              "Windows Event ID 4688",
              "Sysmon Event ID 11",
              "Zeek conn.log"
            ],
            "data_platforms": [
              "TBD"
            ],
            "nai": "User profile directories (%APPDATA%, %TEMP%), endpoint file systems, and network egress points.",
            "action": [
              "Symbolic: Create a multi-event correlation rule: 1) A process is created (EID 4688) from an unusual path (e.g., `C:\\Users\\Public\\`, `%TEMP%`) and is unsigned. 2) Within 60 seconds, the same process PID spawns a clipboard utility. 3) Within 60 seconds of step 2, the same process either creates a file (Sysmon EID 11) or initiates an outbound network connection (`Zeek conn.log`). Alert if the full A->B->C chain is completed.",
              "Statistical: Develop a composite risk score for each new process based on statistical features: rarity of file path (prevalence <1%), parent process prevalence, and signature status (unsigned). If a process's initial risk score exceeds the 98th percentile of all scored processes, begin actively monitoring it for the subsequent behaviors in the chain (clipboard access, file/network write).",
              "Machine Learning: Construct a real-time activity graph where nodes are processes, files, and network connections, and edges represent interactions. Use a graph-based anomaly detection algorithm to identify suspicious subgraphs. A subgraph representing a low-prevalence process node that interacts with the clipboard, then creates a file node in `%APPDATA%`, and finally connects to an external IP address node would be flagged as a high-confidence T1115 indicator."
            ]
          }
        ]
      }
    ],
    "last_updated": "2025-09-30",
    "version": "2.3",
    "date_created": "2025-05-04",
    "contributors": [
      "Zachary Szewczyk",
      "Ask Sage"
    ]
  }
]