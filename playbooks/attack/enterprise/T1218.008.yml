name: T1218.008: Odbcconf
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: This playbook investigates whether an adversary is abusing the ODBC configuration utility (odbcconf.exe) to proxy the execution of malicious code, thereby evading application controls or other defenses. This is often achieved by loading malicious DLLs, using specific command-line arguments like '/A {REGSVR ...}', executing from unusual parent processes (e.g., Office applications), loading DLLs from temporary or user-writable locations, or initiating suspicious child processes and network connections after execution.
type: technique
related:
  - TA0005: Defense Evasion
contributors:
  - Zachary Szewczyk
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is odbcconf.exe loading a DLL module with a file hash known to be malicious?
    context: This question checks if odbcconf.exe is loading a DLL that matches a hash on a threat intelligence feed. A match is a strong indicator that an adversary is using a known malicious tool or payload and proxying its execution through the legitimate odbcconf.exe utility to bypass defenses.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Sysmon Event ID 7
      - User Workstations
      - Application Servers
      - Domain Controllers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: SEARCH module load events WHERE process_name is 'odbcconf.exe'. FOR EACH event, LOOKUP loaded_module_hash in threat_intel_feed. IF match, ALERT.
  - question: Is odbcconf.exe loading a DLL module that is unusually rare within the environment?
    context: This question identifies DLLs loaded by odbcconf.exe that have been seen on very few hosts. Adversary tools are often not widely distributed like legitimate software, so rarity can be a powerful indicator of suspicious or unauthorized activity, even if the file hash is not yet known to be malicious.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Sysmon Event ID 7
      - User Workstations
      - Application Servers
      - Domain Controllers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: SEARCH module load events WHERE process_name is 'odbcconf.exe' over last 90 days. GROUP BY loaded_module_hash, COUNT unique hosts. IF host_count < threshold, FLAG for investigation.
  - question: Does a DLL loaded by odbcconf.exe have characteristics indicative of malicious software according to a machine learning model?
    context: This question applies a machine learning model to analyze the features of a DLL loaded by odbcconf.exe, such as its file structure, entropy, and functions. The model scores the likelihood of the DLL being malicious, enabling the detection of novel or unknown threats that would be missed by signature-based or simple rarity checks.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Sysmon Event ID 7
      - User Workstations
      - Application Servers
      - Domain Controllers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: ON module load event WHERE process_name is 'odbcconf.exe', EXTRACT features from loaded_module. SCORE features with ML_model. IF score > malicious_threshold, ALERT.
  - question: Is odbcconf.exe being executed with the '/A {REGSVR ...}' command-line argument pattern?
    context: This question looks for a specific, high-fidelity command-line pattern used to make odbcconf.exe register and execute a DLL. This syntax is a known method for malicious execution proxying and is highly unlikely to be used in legitimate administration, making it a strong indicator of compromise.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User Workstations
      - Application Servers
      - Domain Controllers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: SEARCH process creation events WHERE process_name is 'odbcconf.exe' AND command_line matches regex '(?i)/A\s+\{REGSVR'. IF match, ALERT.
  - question: Does the command line used to execute odbcconf.exe have an unusually high entropy score?
    context: This question analyzes the complexity or randomness of the command-line string used to launch odbcconf.exe. Malicious commands, especially those containing encoded scripts or randomized paths, often have higher entropy than typical, legitimate commands. A high entropy score can indicate an attempt to obfuscate malicious activity.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User Workstations
      - Application Servers
      - Domain Controllers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: FOR EACH 'odbcconf.exe' process creation event, CALCULATE entropy of command_line. COMPARE to baseline. IF entropy > 99th_percentile, FLAG for investigation.
  - question: Does the command-line structure for an odbcconf.exe execution deviate from common, legitimate patterns?
    context: This question uses a clustering algorithm to group odbcconf.exe executions by their command-line structure. The goal is to identify and baseline normal usage patterns. Executions that do not fit into a common cluster are flagged as outliers, potentially representing unique or malicious commands that warrant further investigation.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User Workstations
      - Application Servers
      - Domain Controllers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: TOKENIZE 'odbcconf.exe' command lines into feature vectors. APPLY clustering model (e.g., DBSCAN). IF command is flagged as noise or small cluster, FLAG as anomalous.
  - question: Was odbcconf.exe launched by a suspicious parent process like an Office application, script host, or web browser?
    context: This question checks the parent process that launched odbcconf.exe. Legitimate execution is typically initiated by system processes or installers. A parent process like Microsoft Word, Outlook, or PowerShell is highly anomalous and suggests that an initial access vector, such as a malicious document or script, is attempting to use odbcconf.exe for defense evasion.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User Workstations
      - Application Servers
      - Email Servers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: SEARCH process creation events WHERE process_name is 'odbcconf.exe'. IF parent_process_name IN ('winword.exe', 'excel.exe', 'outlook.exe', 'powershell.exe', etc.), ALERT.
  - question: Is the parent-child relationship between the process that launched odbcconf.exe and odbcconf.exe itself rare or novel in the environment?
    context: This question establishes a baseline of normal parent-child process relationships across the enterprise. It then flags any odbcconf.exe execution where the parent process is either brand new or has been observed very infrequently. This statistical approach can uncover novel abuse patterns without relying on a predefined list of suspicious parents.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User Workstations
      - Application Servers
      - Email Servers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: BASELINE frequency of all parent-child pairs over 30 days. FOR NEW 'odbcconf.exe' executions, CHECK rarity of its parent-child pair. IF pair is new or below prevalence threshold, ALERT.
  - question: Is the parent process that launched odbcconf.exe considered an outlier by a machine learning model?
    context: This question uses an anomaly detection model, such as an Isolation Forest, trained on legitimate parent-child process data. The model learns what normal execution chains look like and can identify new executions that deviate significantly from this norm. This provides a robust way to detect anomalous parent processes even if they are not on a static watchlist.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User Workstations
      - Application Servers
      - Email Servers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: TRAIN Isolation Forest on legitimate parent-child pairs involving 'odbcconf.exe'. SCORE new executions in real-time. IF score indicates an outlier, FLAG for investigation.
  - question: Was a DLL written to a user-writable directory and then immediately loaded by odbcconf.exe?
    context: This question correlates two events: a DLL file being created in a non-standard location (like a temp folder or user profile) and that same DLL being loaded by odbcconf.exe within a short time frame. This sequence is a classic 'write-and-execute' pattern used by adversaries to drop and run their payloads, making it a high-confidence indicator of malicious activity.
    answer_sources:
      - Sysmon Event ID 11
      - Sysmon Event ID 7
      - Windows Event ID 4688
      - User Workstations
      - Download/Temp Directories on Servers
      - Publicly Writable Shares
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: CORRELATE file creation events (for DLLs in temp paths) with module load events (by 'odbcconf.exe' for the same DLL) on the same host within 5 minutes. IF match, ALERT.
  - question: Is the time between a DLL being written to a temporary directory and its execution by odbcconf.exe a statistical outlier?
    context: This question analyzes the time delta between when a DLL is created and when it's executed by odbcconf.exe. Adversaries often execute their payloads immediately after dropping them to disk. A very short time-to-live, especially one that is statistically rare compared to legitimate software installation behavior, can be a strong signal of malicious intent.
    answer_sources:
      - Sysmon Event ID 11
      - Sysmon Event ID 7
      - Windows Event ID 4688
      - User Workstations
      - Download/Temp Directories on Servers
      - Publicly Writable Shares
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: CALCULATE time delta between DLL file-write and 'odbcconf.exe' execution. IF delta is in the lowest 5th percentile (unusually fast), FLAG for investigation.
  - question: Does the sequence of events leading to odbcconf.exe loading a DLL from a temporary directory appear anomalous according to a sequence analysis model?
    context: This question uses a sophisticated model (like an LSTM) to learn normal sequences of system events (file writes, process creations, etc.) on a host. It can then identify when an observed sequence, such as a DLL being written to a temp folder followed immediately by an odbcconf.exe load, deviates from learned legitimate patterns, flagging it as a potential threat.
    answer_sources:
      - Sysmon Event ID 11
      - Sysmon Event ID 7
      - Windows Event ID 4688
      - User Workstations
      - Download/Temp Directories on Servers
      - Publicly Writable Shares
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: TRAIN sequence model (e.g., LSTM) on normal host event sequences. FEED real-time events to model. IF model flags 'DLL write to temp -> odbcconf load' as an improbable/anomalous sequence, ALERT.
  - question: Did odbcconf.exe spawn a suspicious child process (like cmd.exe or powershell.exe) or lead to network connections with known malicious indicators?
    context: This question looks for post-exploitation activity following an odbcconf.exe execution. The legitimate utility should not be spawning command shells or connecting to malicious IP addresses. Observing this behavior is a strong sign that a malicious payload executed via odbcconf.exe is now attempting to perform further actions, such as command and control or lateral movement.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Sysmon Event ID 3
      - Zeek conn.log
      - Zeek dns.log
      - User Workstations
      - Application Servers
      - Network Egress Points
      - DNS servers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: "RULE 1: ALERT if 'odbcconf.exe' is parent of ('cmd.exe', 'powershell.exe', etc.). RULE 2: CORRELATE 'odbcconf.exe' execution with subsequent network connections from same host to threat_intel_watchlist IPs/domains within 5 minutes. ALERT on match."
  - question: Following an odbcconf.exe execution, did the host exhibit anomalous network behavior, such as a spike in new connections or queries to high-entropy domains?
    context: This question identifies unusual network patterns immediately following an odbcconf.exe execution, even without known malicious indicators. A sudden increase in outbound connections, or DNS lookups for algorithmically generated or newly registered domains, can indicate that a malicious payload is establishing command and control channels or exfiltrating data.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Sysmon Event ID 3
      - Zeek conn.log
      - Zeek dns.log
      - User Workstations
      - Application Servers
      - Network Egress Points
      - DNS servers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: AFTER 'odbcconf.exe' execution, MONITOR host network traffic. IF spike in new destination IPs > 98th percentile OR DNS queries for high-entropy/newly-registered domains, FLAG for investigation.
  - question: Does a time-series model detect anomalous network activity on a host immediately after odbcconf.exe was executed?
    context: This question uses a time-series model to learn the normal rhythm and pattern of a host's network behavior. By feeding the network metrics from the period just after an odbcconf.exe execution into the model, it can detect subtle deviations from the established baseline that might indicate malicious C2 traffic, even if the traffic volume or destination is not overtly suspicious.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Sysmon Event ID 3
      - Zeek conn.log
      - Zeek dns.log
      - User Workstations
      - Application Servers
      - Network Egress Points
      - DNS servers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: AFTER 'odbcconf.exe' execution, FEED subsequent host network metrics (bytes, connections) into trained time-series model. IF model flags period as anomalous, ALERT.