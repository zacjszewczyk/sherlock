name: T1078.001: Default Accounts
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: >-
  This playbook helps investigate if an adversary has gained initial access, established persistence, escalated privileges, or evaded defenses by leveraging default accounts (T1078.001). The investigation focuses on identifying successful remote logons from non-standard IP addresses using default usernames, detecting scanning or brute-force activity against these accounts, and spotting the first-time use of dormant default credentials. It also covers monitoring for persistence mechanisms created by default accounts (e.g., scheduled tasks, services), tracking anomalous network connections from default account processes, identifying privilege escalation via credential theft tools or unauthorized group modifications, and detecting defense evasion techniques like clearing audit logs or disabling security services.
type: technique
related:
  - TA0001: Initial Access
  - TA0003: Persistence
  - TA0004: Privilege Escalation
  - TA0005: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are known default accounts (e.g., admin, root) successfully logging in remotely from external IP addresses?
    context: This question addresses the most direct form of default account abuse for initial access. A successful remote login (Logon Type 3 or 10) from an external, non-RFC1918 IP address using a known default username is a high-confidence indicator of a compromise. Analysts should investigate to confirm if the activity is legitimate or if an adversary has gained a foothold.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Application/Appliance Authentication Logs
      - Assets: DMZ-hosted application servers, VPN Concentrators, Internet-facing network appliances (firewalls, routers), Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH successful remote authentications (Logon Type 3 or 10)
          WHERE username IN default_account_watchlist
          AND source_ip is_not_RFC1918
  - question: Have any rarely used or dormant default accounts been used for a successful external authentication?
    context: This question uses statistical analysis to find anomalous behavior. Adversaries often use accounts that are overlooked or assumed to be inactive. By identifying a successful external login from an account with a historically very low login frequency (e.g., bottom 5th percentile), analysts can uncover stealthy initial access attempts that might otherwise be missed.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Application/Appliance Authentication Logs
      - Assets: DMZ-hosted application servers, VPN Concentrators, Internet-facing network appliances (firewalls, routers), Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          CALCULATE login frequency per username over 90 days.
          ALERT on successful external authentication
          WHERE username has a login frequency in the bottom 5th percentile.
  - question: Can machine learning models classify external login events as benign or suspicious based on features like geolocation, time of day, and account history?
    context: This question explores using a machine learning model to automate the detection of suspicious logins. By training a model on various contextual features (e.g., if the username is a default account, source IP geolocation, time of day), it can learn to distinguish between normal administrative access and malicious activity, providing a scalable method for identifying default account abuse.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Application/Appliance Authentication Logs
      - Assets: DMZ-hosted application servers, VPN Concentrators, Internet-facing network appliances (firewalls, routers), Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY classification model to external login events.
          FEATURES: is_default_account, source_ip_geo, time_of_day, historical_login_ratios.
          ALERT on 'suspicious' classification.
  - question: Are external IPs using common scanning tools (e.g., nmap, metasploit, hydra) against our web assets?
    context: This question aims to detect preparatory stages of an attack. Adversaries often scan for vulnerable services or login pages before attempting to use default credentials. Detecting User-Agent strings associated with common scanning tools in HTTP logs is a strong indicator of malicious reconnaissance activity.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Assets: Internet gateway/edge firewalls, Externally-facing web servers, DMZ network segments
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH http_logs from external_ips
          WHERE user_agent MATCHES scanner_tool_watchlist ('metasploit', 'nmap', 'hydra').
          ALERT on match.
  - question: Are any external IPs exhibiting scanning behavior by connecting to an unusually high number of hosts or ports in a short time frame?
    context: This question identifies scanning activity through statistical analysis of network connection logs. An external source IP attempting to connect to a large number of unique destination hosts or ports within a small time window (e.g., 5 minutes) is a classic sign of network or service scanning, often preceding a brute-force attack.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Assets: Internet gateway/edge firewalls, Externally-facing web servers, DMZ network segments
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          AGGREGATE connection_logs by source_ip in 5-minute windows.
          CALCULATE unique destination_hosts and destination_ports.
          ALERT if count exceeds 99th percentile baseline.
  - question: Can unsupervised clustering identify external IP addresses that are acting as scanners based on their connection patterns?
    context: This question applies machine learning to group network traffic and find outliers. By clustering external IP addresses based on features like connection diversity and success/failure ratios, a DBSCAN algorithm can isolate IPs that form a distinct 'scanner' cluster or are marked as anomalies, indicating behavior different from normal traffic.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Assets: Internet gateway/edge firewalls, Externally-facing web servers, DMZ network segments
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY DBSCAN clustering to external source IPs.
          FEATURES: unique_dest_ip_count, unique_dest_port_count, success_to_rejected_ratio.
          ALERT on IPs in 'scanner' cluster or marked as noise/outliers.
  - question: Has a built-in default account successfully authenticated to a host for the very first time?
    context: This question uses stateful tracking to detect highly anomalous events. In a mature environment, default accounts should either be disabled or have established usage patterns. A default account logging into a specific host for the first time in recorded history is extremely suspicious and could indicate an attacker successfully guessing credentials for an overlooked account.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Application/Appliance Authentication Logs
      - Assets: Domain Controllers, Member Servers, Endpoint workstations, Virtualization Hosts (ESXi)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MAINTAIN lookup of historical (hostname, username) successful logins.
          ON new successful login:
          ALERT if (hostname, username) is not in lookup AND username is a default account.
  - question: Is there a successful login by a default account that has a historical login count of zero for that specific asset?
    context: This is a statistical approach to the 'first time' detection. By creating a baseline of all user-host login pairs over a long period (e.g., 180 days), any new successful login by a default account to a host where it has never logged in before is flagged as a high-severity statistical anomaly.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Application/Appliance Authentication Logs
      - Assets: Domain Controllers, Member Servers, Endpoint workstations, Virtualization Hosts (ESXi)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          BASELINE successful logins per (host, user) over 180 days.
          ON new successful login:
          ALERT if login count for (host, user) is zero AND user is a default account.
  - question: Can unsupervised machine learning models identify anomalous login behaviors involving default accounts that don't fit any established patterns?
    context: This question leverages clustering algorithms to find logins that deviate from the norm without pre-defined rules. By grouping 'normal' login behaviors based on features like hostname, username, and source geolocation, any login involving a default account that is marked as an outlier by the algorithm should be investigated as it does not fit any established activity pattern.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Application/Appliance Authentication Logs
      - Assets: Domain Controllers, Member Servers, Endpoint workstations, Virtualization Hosts (ESXi)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY unsupervised clustering (DBSCAN) to login events.
          FEATURES: hostname, username, source_ip_geo, time_of_day.
          ALERT on logins involving default accounts marked as outliers.
  - question: Are we observing credential stuffing or password spraying attacks against default accounts?
    context: This question seeks to identify two common brute-force variants. Credential stuffing (many source IPs, one default username) and password spraying (one source IP, many usernames) are detected by counting failed logins (Windows Event ID 4625) within a short time window and checking if they cross a defined threshold.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - Assets: Authentication servers (Active Directory), Externally-facing services, VPN endpoints
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH failed_logins in a 15-min window.
          ALERT if (one_default_user from >10 source_ips) OR (>20 users from one_source_ip).
  - question: Are there statistical anomalies in failed login counts, such as a high number of source IPs for one user or a high number of users for one IP?
    context: This question provides a more dynamic way to detect brute-force attacks by comparing activity against a moving average. An alert is triggered if the count of distinct source IPs for a single default username, or the count of distinct usernames from a single source IP, exceeds 3 standard deviations above the baseline, indicating a statistical anomaly.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - Assets: Authentication servers (Active Directory), Externally-facing services, VPN endpoints
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          AGGREGATE failed_logins over 30-min window.
          ALERT if (distinct_source_ips_per_user > 3_std_dev) OR (distinct_users_per_source_ip > 3_std_dev).
  - question: Is a time-series anomaly detection model detecting significant spikes in the overall volume of failed authentications?
    context: This question uses machine learning to detect the start of a large-scale brute-force attack. By training a time-series model (like ARIMA or LSTM) on the normal rhythm of failed authentications, it can forecast the expected volume. A significant deviation between the observed volume and the forecast indicates an anomalous spike that could be an attack.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - Assets: Authentication servers (Active Directory), Externally-facing services, VPN endpoints
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY time-series anomaly detection (LSTM) to global failed login counts per minute.
          ALERT when observed volume significantly exceeds forecasted volume.
  - question: Is a process running under a default account context making network connections to known malicious C2 servers?
    context: This question looks for a strong indicator of compromise and persistence. It involves identifying processes running under a default account and checking if their network connections go to destinations listed in a threat intelligence feed of known command-and-control (C2) servers. A match is a high-fidelity alert.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek dns.log
      - Assets: Endpoint devices, Servers, Network egress points
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          JOIN process_creation_logs (for default accounts) with network_connection_logs.
          MATCH destination_ip against C2_threat_intelligence_feed.
          ALERT on match.
  - question: Is a process running under a default account connecting to statistically rare domains or IP addresses?
    context: This question helps find C2 infrastructure that is not yet on a threat intelligence list. By analyzing the network connections of processes run by default accounts, connections to destination IPs or domains that are very uncommon (e.g., in the bottom percentile of prevalence across the organization) can be flagged as suspicious.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek dns.log
      - Assets: Endpoint devices, Servers, Network egress points
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR processes run by default accounts:
          ANALYZE network destinations.
          ALERT if destination_ip or destination_domain is in the bottom 5th percentile of prevalence.
  - question: Can a machine learning model detect C2 beaconing behavior from network traffic originating from default account processes?
    context: This question aims to identify the rhythmic, automated traffic pattern characteristic of C2 beaconing. By training a classifier on network flow features like connection duration, bytes sent/received, and inter-arrival time, a model can learn to distinguish normal traffic from C2 callbacks, providing a powerful detection for active implants.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek dns.log
      - Assets: Endpoint devices, Servers, Network egress points
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          EXTRACT features (duration, bytes, inter-arrival time) from network flows of default account processes.
          APPLY beaconing classification model.
          ALERT if connection is classified as 'beaconing'.
  - question: Has a default account created a new persistence mechanism like a Scheduled Task, Service, or Registry Run Key?
    context: This is a critical question for detecting persistence. Adversaries often create these mechanisms to maintain access after a reboot. An alert that triggers whenever a built-in default account creates a scheduled task (Event ID 4698), service (Event ID 7045), or modifies a Run Key (Event ID 4657) is inherently suspicious and requires immediate investigation.
    answer_sources:
      - Windows Event ID 4698
      - Windows Event ID 4702
      - Windows Event ID 7045
      - Windows Event ID 4657
      - Assets: Endpoint workstations, Servers (especially Domain Controllers and critical application servers)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH for Event IDs 4698, 7045, or 4657.
          ALERT if Subject/Username is a known default account.
  - question: Are new persistence mechanisms created by default accounts using obfuscated commands or pointing to unusual file locations?
    context: This question looks for statistical red flags within persistence entries. An adversary might try to hide their payload by using an encoded command (high entropy) or placing their executable in a world-writable location (e.g., C:\Users\Public). Flagging these statistical anomalies helps prioritize which new persistence items are most suspicious.
    answer_sources:
      - Windows Event ID 4698
      - Windows Event ID 4702
      - Windows Event ID 7045
      - Windows Event ID 4657
      - Assets: Endpoint workstations, Servers (especially Domain Controllers and critical application servers)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR new persistence by default accounts:
          CALCULATE entropy of command line.
          ALERT if entropy > 2 standard deviations above baseline OR path is world-writable.
  - question: Can a machine learning model classify newly created scheduled tasks or services by default accounts as malicious?
    context: This question uses machine learning to assess the risk of new persistence. A model can be trained on features like the creating account, the executable path, suspicious arguments, and the file hash. This allows for automated classification of new persistence mechanisms as 'benign' or 'malicious', focusing analyst attention on the highest-risk items.
    answer_sources:
      - Windows Event ID 4698
      - Windows Event ID 4702
      - Windows Event ID 7045
      - Windows Event ID 4657
      - Assets: Endpoint workstations, Servers (especially Domain Controllers and critical application servers)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY classification model to new persistence objects.
          FEATURES: creating_account_is_default, exe_path, suspicious_args, file_hash_reputation.
          ALERT on 'malicious' classification.
  - question: Has a non-interactive default service account spawned an interactive shell like powershell.exe or cmd.exe?
    context: This question targets a common privilege escalation and lateral movement technique. Service accounts should not be used for interactive sessions. A service process (like services.exe) spawning an interactive shell is a very strong indicator that an attacker has compromised the service account and is using it to execute commands.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Assets: Application Servers, Database Servers, Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH process_creation_events (Event ID 4688).
          ALERT where parent_process is a service AND new_process is ('powershell.exe', 'cmd.exe').
  - question: Is a default service account exhibiting anomalous behavior, such as creating new child processes or making network connections to new destinations?
    context: This question establishes a behavioral baseline for service accounts and looks for deviations. Service accounts typically have very predictable activity. Flagging when a service account spawns a new type of child process or connects to a new destination IP, domain, or port for the first time can uncover misuse of the account.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Assets: Application Servers, Database Servers, Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          BASELINE parent-child process relationships and network destinations for each service account.
          ALERT on any deviation from the established baseline (e.g., new child process, new destination ASN).
  - question: Can a graph-based anomaly detection model identify when a default service account performs an action it has never been seen doing before, like spawning a shell?
    context: This question models system activity as a graph to find novel, suspicious behaviors. By representing accounts and processes as nodes and their interactions as edges, the model learns the normal graph structure. A new, previously unseen edge, such as a web service account node creating an edge to a powershell.exe node, would be a high-scoring anomaly.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Assets: Application Servers, Database Servers, Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL system activity as a graph (nodes: processes, accounts; edges: actions).
          TRAIN on baseline activity.
          ALERT on new, high-risk edges involving default accounts (e.g., service_account -> 'spawns' -> cmd.exe).
  - question: Has a default account been enabled and then immediately used for a successful login?
    context: This question uses event correlation to find a high-confidence attack pattern. An adversary may enable a disabled default account to use it for persistence. Chaining an 'Account Enabled' event (ID 4722) with a subsequent successful logon (ID 4624) by the same account within a few minutes creates a very reliable alert.
    answer_sources:
      - Windows Event ID 4624
      - Windows Event ID 4722
      - Windows Event ID 4725
      - Assets: Domain Controllers, Authentication Logs Archive
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          CORRELATE events:
          TRIGGER on Event ID 4722 (Account Enabled) for a default account.
          ALERT if followed by Event ID 4624 (Successful Logon) by same account within 5 minutes.
  - question: Has a dormant default account (inactive for >90 days) suddenly been used to log in, especially outside of business hours?
    context: This question focuses on the activation of long-dormant accounts, which is highly suspicious. By tracking the last login time for all default accounts, a successful login from an account that has been inactive for an extended period (e.g., > 90 days) is a significant statistical anomaly, with risk amplified if it occurs at an unusual time.
    answer_sources:
      - Windows Event ID 4624
      - Windows Event ID 4722
      - Windows Event ID 4725
      - Assets: Domain Controllers, Authentication Logs Archive
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          CALCULATE days_since_last_login for each default account.
          ALERT on successful login if days_since_last_login > 90.
          INCREASE severity if login is outside business hours.
  - question: Can a time-series model detect a sudden spike in login activity for a previously dormant default account?
    context: This question applies time-series forecasting to individual account activity. A model trained on the daily login counts for each default account can learn its normal pattern (which for a dormant account is zero). An alert is generated when the observed login count for a previously dormant account significantly deviates from the model's flat-line forecast.
    answer_sources:
      - Windows Event ID 4624
      - Windows Event ID 4722
      - Windows Event ID 4725
      - Assets: Domain Controllers, Authentication Logs Archive
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY time-series anomaly detection to daily login counts for each default account.
          ALERT when observed logins significantly exceed the forecast for a previously dormant account.
  - question: Has a default account executed a process with command-line arguments matching known credential dumping tools like Mimikatz?
    context: This question looks for the direct use of credential theft tools, a common privilege escalation step. Scanning command-line arguments in process creation events (Event ID 4688) for signatures of tools like Mimikatz (e.g., 'sekurlsa::logonpasswords') provides a high-confidence indicator of an active attack.
    answer_sources:
      - Windows Event ID 4688
      - Assets: All servers and endpoints, especially Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH process creation events where user is a default account.
          ALERT if command_line contains ('mimikatz', 'sekurlsa::logonpasswords', 'procdump -ma lsass.exe').
  - question: Are default accounts executing commands with unusually high length or character entropy, suggesting obfuscation?
    context: This question uses statistical properties of command lines to find hidden malicious activity. Attackers often use long, encoded, or obfuscated commands to bypass simple signature-based detections. Alerting when a command's length or entropy exceeds the established baseline for that account can uncover these hidden commands.
    answer_sources:
      - Windows Event ID 4688
      - Assets: All servers and endpoints, especially Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          CALCULATE baseline length and entropy for commands run by default accounts.
          ALERT if a new command's length or entropy > 3 standard deviations from the baseline.
  - question: Can a text classification model identify malicious command lines executed by default accounts?
    context: This question applies machine learning to understand the intent of command lines. By training a model on a labeled dataset of benign and malicious commands, it can learn to classify new, unseen command lines. This provides a more robust detection method that can catch novel or obfuscated attack strings that evade static signatures.
    answer_sources:
      - Windows Event ID 4688
      - Assets: All servers and endpoints, especially Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY text classification model to command lines from default accounts.
          ALERT if command is classified as 'malicious' with high confidence.
  - question: Has a default account added another user or group to a high-privilege group like Domain Admins?
    context: This question targets a critical privilege escalation action. The addition of a user to a privileged group (e.g., 'Domain Admins', 'Administrators') by a default account is an extremely high-risk event that should almost never occur in a managed environment. Monitoring for the relevant Windows Event IDs (4732, 4728, 4756) provides direct evidence of this activity.
    answer_sources:
      - Windows Event ID 4732
      - Windows Event ID 4728
      - Windows Event ID 4756
      - Assets: Domain Controllers, High-value servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH for Event IDs 4732, 4728, 4756.
          ALERT if a member is added to a privileged group AND the action was performed by a default account.
  - question: Has a default account that has never modified group memberships before suddenly added a user to a privileged group?
    context: This question uses statistical 'first-time' analysis to detect anomalous administrative actions. By maintaining a baseline of which accounts perform group modifications, an alert on a default account performing this action for the first time, especially to a privileged group, highlights a significant and suspicious deviation from normal behavior.
    answer_sources:
      - Windows Event ID 4732
      - Windows Event ID 4728
      - Windows Event ID 4756
      - Assets: Domain Controllers, High-value servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          BASELINE which accounts perform group modifications.
          ALERT if a default account adds a member to a privileged group for the first time.
  - question: Can a graph-based model of Active Directory detect high-risk group membership changes initiated by default accounts?
    context: This question visualizes Active Directory as a graph to score the risk of changes. In this model, users and groups are nodes. An action, like a default account node creating a 'member of' edge from a user node to a 'Domain Admins' group node, can be automatically scored as a high-risk event, providing immediate visibility into privilege escalation.
    answer_sources:
      - Windows Event ID 4732
      - Windows Event ID 4728
      - Windows Event ID 4756
      - Assets: Domain Controllers, High-value servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL Active Directory as a graph.
          SCORE risk of all graph modifications.
          ALERT on high-risk edge additions, like a default account adding a member to a privileged group.
  - question: Has a default account, not typically used for administration, performed a privileged action like creating a user for the first time?
    context: This question detects when an account is used outside of its expected role. By maintaining a state table of which accounts have performed which privileged actions (e.g., user creation - Event ID 4720), an alert can be generated the first time a non-administrative default account performs such an action, indicating a potential compromise or misuse.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 7045
      - Assets: Domain Controllers, Member Servers, Endpoint workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MAINTAIN state table of (account, privileged_event_id).
          ALERT if a privileged event occurs and the (account, event_id) pair is new AND the account is a default account.
  - question: Is there a sudden spike in privileged actions (user creation, service installation) from a default account that historically performs none?
    context: This question uses simple statistical counting to find anomalous behavior. For default accounts that should not be performing administrative tasks, the baseline rate of privileged actions is zero. Therefore, any day where the count of such actions (e.g., user creations) is greater than zero is a major statistical anomaly that requires investigation.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 7045
      - Assets: Domain Controllers, Member Servers, Endpoint workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRACK daily frequency of privileged events per default account.
          ALERT if the daily count for an account with a historical rate of zero is > 0.
  - question: Is a default account performing actions that are uncharacteristic of its peer group (e.g., a service account creating users)?
    context: This question applies peer group analysis to find outliers. By grouping accounts by role (e.g., virtualization service accounts, database service accounts), you can model the typical behavior of each group. If one account (e.g., 'vpxuser') starts performing actions (like creating local users) that are not characteristic of its peers, it is flagged as an anomaly.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 7045
      - Assets: Domain Controllers, Member Servers, Endpoint workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          GROUP default accounts by role to create peer groups.
          MODEL typical behavior for each peer group.
          ALERT if an account performs actions that are anomalous for its peer group.
  - question: Following a non-admin user login, was a process created under a high-privilege default account context like SYSTEM?
    context: This question targets a classic local privilege escalation exploit chain. An attacker logs in as a low-privilege user and then exploits a vulnerability to run code as a high-privilege account like 'SYSTEM'. Correlating a non-admin login with a subsequent process creation under a privileged context on the same host is a strong indicator of this attack.
    answer_sources:
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Windows Event ID 4648
      - Assets: Endpoint workstations, Jump Servers, Terminal Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          ON a single host, CORRELATE:
          1. Successful login by non-admin user (Event ID 4624).
          2. Followed within 2 mins by process creation (Event ID 4688) under 'SYSTEM' or 'Administrator' context.
          ALERT on this sequence.
  - question: Is a process being created under a default account's context but linked to a different, lower-privileged user's logon session?
    context: This question looks for a statistical link between a low-privilege session and high-privilege execution. Some privilege escalation techniques result in a process running as 'SYSTEM' but still associated with the original user's Logon ID. Identifying these rare associations, where a process's account context doesn't match the user tied to the logon session, can uncover exploits.
    answer_sources:
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Windows Event ID 4648
      - Assets: Endpoint workstations, Jump Servers, Terminal Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MAP Logon IDs to user accounts from login events.
          FOR new processes, check if the process account context (e.g. 'SYSTEM') differs from the user associated with its Logon ID.
          ALERT if this association is a statistical rarity.
  - question: Can a sequence-to-sequence autoencoder detect anomalous user sessions where a low-privilege login is followed by high-privilege process creation?
    context: This question uses a neural network to learn what a 'normal' user session looks like from start to finish. The model is trained on sequences of benign events (login, process creations, etc.). When a new session containing an anomalous sequence—like a low-privilege login followed by high-privilege process creation—is fed to the model, it will have a high reconstruction error, triggering an alert.
    answer_sources:
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Windows Event ID 4648
      - Assets: Endpoint workstations, Jump Servers, Terminal Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL user sessions as event sequences.
          TRAIN a sequence autoencoder on benign sessions.
          ALERT if a new session has a high reconstruction error, indicating an anomalous sequence.
  - question: Has a default account executed commands known to disable security services, clear logs, or modify firewall rules?
    context: This is a critical defense evasion question. It looks for direct evidence of an attacker trying to cover their tracks or disable defenses. Searching process command lines for specific strings like 'wevtutil.exe cl Security' or 'Set-MpPreference -DisableRealtimeMonitoring' run by a default account is a high-confidence indicator of malicious activity.
    answer_sources:
      - Windows Event ID 4688
      - Assets: All servers and endpoints
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH process creation events where user is a default account.
          ALERT if command_line contains ('wevtutil cl', 'netsh advfirewall set state off', 'DisableRealtimeMonitoring').
  - question: Are sensitive security-related commands (e.g., 'wevtutil', 'netsh') being executed by default accounts, where the normal frequency is zero?
    context: This question uses the simple statistical fact that in a stable environment, security tools should not be reconfigured by default accounts. The baseline frequency for commands like 'auditpol' or 'wevtutil' being run by these accounts is zero. Therefore, any execution (a count > 0) is a statistical anomaly that warrants an alert.
    answer_sources:
      - Windows Event ID 4688
      - Assets: All servers and endpoints
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRACK daily count of sensitive command executions ('wevtutil', 'auditpol') by default accounts.
          ALERT if count > 0.
  - question: Can an NLP model classify the intent of commands run by default accounts as 'security-tampering'?
    context: This question applies Natural Language Processing (NLP) to go beyond simple string matching. By training a model to understand the semantic meaning and intent of command-line arguments, it can classify a command's purpose (e.g., 'file-operation', 'security-tampering'). This allows for the detection of novel or obfuscated defense evasion commands.
    answer_sources:
      - Windows Event ID 4688
      - Assets: All servers and endpoints
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY NLP intent classification model to command lines from default accounts.
          ALERT if command intent is classified as 'security-tampering'.
  - question: Has a default account changed the system audit policy (Windows Event ID 4719)?
    context: This question targets a specific, high-impact defense evasion technique. Windows Event ID 4719 is generated whenever the system's audit policy is changed. An alert that triggers whenever this event occurs and the responsible account is a default account provides direct, unambiguous evidence of audit tampering.
    answer_sources:
      - Windows Event ID 4719
      - Windows Event ID 4688
      - Assets: Domain Controllers, Endpoint devices, Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH for Event ID 4719 (System audit policy was changed).
          ALERT if the Subject Account Name is a default account.
  - question: Have critical security settings (firewall rules, audit policies) deviated from a secure baseline, with logs indicating the change was made by a default account?
    context: This question focuses on detecting unauthorized configuration drift. By periodically snapshotting and polling critical security settings, you can compare the live configuration to a known-good baseline. If a deviation is found, and correlated logs show the change was made by a default account outside a change window, it signifies a suspicious modification.
    answer_sources:
      - Windows Event ID 4719
      - Windows Event ID 4688
      - Assets: Domain Controllers, Endpoint devices, Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          PERIODICALLY compare current security configuration to a secure baseline.
          ON deviation, check logs for the change event.
          ALERT if change was made by a default account outside a change window.
  - question: Is a time-series model detecting that a default account has made a configuration change that causes the system's security state to become anomalous?
    context: This question uses machine learning to understand the normal "state" of security configurations over time. A time-series model can learn this normal pattern. If a default account makes a change (e.g., disabling a firewall profile) that causes the system's state to significantly deviate from the model's prediction, it's flagged as an anomaly.
    answer_sources:
      - Windows Event ID 4719
      - Windows Event ID 4688
      - Assets: Domain Controllers, Endpoint devices, Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL security configuration states over time.
          ALERT if a change made by a default account causes the current state to be anomalous compared to the forecast.
  - question: Has a default account attempted to write to or delete sensitive security log files (.evtx)?
    context: This question targets the most direct form of log tampering. By enabling file system auditing (SACLs) on log directories, you can generate an event (Event ID 4663) for any access attempt. A rule that alerts when a default account attempts to write to or delete a sensitive log file (e.g., Security.evtx) is a critical detection for defense evasion.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Assets: Log servers, All endpoints and servers where logs are stored locally
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          ENABLE file system auditing on log directories.
          SEARCH for Event ID 4663 on sensitive files (e.g., *.evtx).
          ALERT if Account Name is a default account and Accesses include 'WriteData' or 'DELETE'.
  - question: Is a default account accessing an anomalously high number of files in a sensitive log directory, or accessing file types it has never accessed before?
    context: This question uses statistical baselining to detect suspicious file interaction that might precede tampering or exfiltration. An attacker might compress logs before clearing them. Alerting if a default account accesses an unusually high number of files in a log directory, or accesses a file type like '.zip' for the first time, can detect this preparatory behavior.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Assets: Log servers, All endpoints and servers where logs are stored locally
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          PROFILE normal file access patterns for default accounts in log directories.
          ALERT if an account accesses a number of files > 99th percentile OR accesses a new file type.
  - question: Can a one-class SVM model, trained on normal file access patterns, detect when a default account performs a suspicious file interaction?
    context: This question uses machine learning to create a boundary of "normal" behavior. A one-class SVM is trained only on benign file access events (features: path, process, access type). Any new file access by a default account that falls outside this learned boundary is automatically classified as an anomaly, providing a powerful way to detect novel suspicious activity.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Assets: Log servers, All endpoints and servers where logs are stored locally
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN a one-class SVM on benign file access patterns for default accounts.
          FEED new file access events into the model.
          ALERT if an event is classified as an outlier/anomaly.
  - question: Is a host with an active default account session making direct-to-internet connections, bypassing the corporate proxy?
    context: This question aims to detect policy violations that can hide malicious traffic. By correlating network logs (Zeek) with proxy logs, it's possible to identify direct-to-internet connections on ports 80/443 that did not go through the proxy. If this occurs from a host with an active default account session, it's a strong sign of a proxy bypass for C2 or exfiltration.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - Windows Event ID 4624
      - Assets: Network egress points, Proxy servers, Endpoint devices
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          IDENTIFY hosts with active default account sessions.
          FOR these hosts, find direct outbound connections on port 80/443 in firewall/Zeek logs.
          ALERT if no corresponding entry exists in proxy logs for that destination and time.
  - question: Has the ratio of proxied vs. direct-to-internet traffic for a host shifted anomalously after a default account logged in?
    context: This question uses statistical analysis to detect a change in a host's network behavior. For any given host, there is a normal baseline ratio of traffic that goes through the proxy versus directly to the internet. A dramatic shift toward direct connections after a default account logs in is a statistical anomaly that suggests a policy bypass is in effect.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - Windows Event ID 4624
      - Assets: Network egress points, Proxy servers, Endpoint devices
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          BASELINE the ratio of (proxied_traffic / direct_traffic) for each host.
          ALERT if this ratio shifts by > 3 standard deviations after a default account logs in.
  - question: Can a machine learning classifier identify network traffic from hosts with default account sessions as 'suspicious non-proxied' traffic?
    context: This question uses a classifier to find traffic that is attempting to evade inspection. The model is trained to distinguish between normal proxied web traffic and other types of traffic. When applied to flows from a host with an active default account session, it can flag traffic that looks like web browsing but is not in the proxy logs, indicating a potential covert channel.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - Windows Event ID 4624
      - Assets: Network egress points, Proxy servers, Endpoint devices
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN classifier on network flow features to distinguish proxied vs. non-proxied traffic.
          APPLY model to traffic from hosts with active default account sessions.
          ALERT on traffic classified as 'suspicious non-proxied'.