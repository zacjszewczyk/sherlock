name: T1530: Data from Cloud Storage
id: 19c8d4e5-7f6a-4b9c-8d1e-5a6f7b8c9d0e
description: This playbook helps to determine if an adversary is collecting data from cloud storage platforms. It focuses on identifying anomalous data access patterns, such as access from malicious IP addresses, use of known exfiltration tools, unusually large data transfers, out-of-character user behavior like impossible travel, and reconnaissance patterns like a high rate of access denied errors followed by a success. The goal is to detect unauthorized data siphoning from services like AWS S3, Azure Blob Storage, or Google Cloud Storage.
type: technique
related:
- TA0009: Collection
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Is cloud storage being accessed from a known malicious IP address or with a known malicious tool?
  context: This question aims to detect blatant signs of compromise by correlating cloud access logs with threat intelligence. Answering it helps identify attacks where adversaries use known malicious infrastructure (malicious IPs, TOR nodes) or common exfiltration tools (like Rclone) that leave distinct User-Agent signatures. A match provides a high-confidence indicator of malicious activity.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Storage Analytics logs
  - Google Cloud Audit Logs
  - Zeek conn.log
  - Zeek http.log
  - Cloud provider API gateways
  - Internet gateway proxy servers
  - Enterprise SIEM platform
  range: last 90 days
  queries:
  - technology: pseudocode
    query: Search cloud and network logs for source IPs matching threat intelligence feeds or User-Agents matching known malicious tool signatures.
- question: Has any principal's User-Agent string suddenly become less random, suggesting a switch to a programmatic tool?
  context: This question identifies subtle shifts in behavior. Legitimate users often access cloud resources through various browsers and clients, leading to diverse User-Agent strings and higher entropy. An adversary using a single script or tool for bulk download will produce a uniform User-Agent, causing a sharp drop in entropy. This detects automation that might otherwise be missed.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Storage Analytics logs
  - Google Cloud Audit Logs
  - Zeek http.log
  - Cloud provider API gateways
  - Enterprise SIEM platform
  range: last 90 days
  queries:
  - technology: pseudocode
    query: For each principal, calculate Shannon entropy of User-Agent strings over time and alert on sudden decreases below a historical baseline.
- question: Does a cloud storage access event exhibit characteristics (IP geolocation, ASN, User-Agent, time of day) consistent with previously observed malicious activity?
  context: This question leverages machine learning to score access events based on a combination of features. It moves beyond simple rules to identify complex patterns that, in aggregate, indicate a high probability of malicious intent. This is useful for detecting novel or sophisticated attacks that might not match known signatures.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Storage Analytics logs
  - Google Cloud Audit Logs
  - Zeek conn.log
  - Zeek http.log
  - Cloud provider API gateways
  - Enterprise SIEM platform
  range: last 90 days
  queries:
  - technology: pseudocode
    query: Score new cloud access events using a trained logistic regression model and flag events with a high probability score for maliciousness.
- question: Is a known cloud data siphoning tool (e.g., Rclone, S4cmd) being executed on an endpoint or detected in network traffic?
  context: This question focuses on detecting the presence and execution of specific tools commonly used for data exfiltration from cloud environments. Identifying the tool by its process name, command-line arguments (like 's3://'), or User-Agent string provides direct evidence of an adversary's intent to collect and exfiltrate data.
  answer_sources:
  - Windows Event ID 4688
  - AWS CloudTrail logs
  - Zeek http.log
  - Zeek conn.log
  - Critical asset endpoints (e.g., developer workstations, administrator servers)
  - Cloud provider API gateways
  - Network egress points
  range: last 90 days
  queries:
  - technology: pseudocode
    query: Search endpoint logs for process names/command lines and network/API logs for User-Agents matching a watchlist of known cloud siphoning tools.
- question: Is any principal performing an unusually high number of reconnaissance API calls (e.g., 'ListBuckets') compared to data retrieval calls?
  context: Adversaries often perform extensive enumeration of cloud storage resources before deciding what to steal. This question aims to detect this reconnaissance behavior by looking for an anomalous ratio of 'list' or 'describe' calls to 'get' calls. A spike in this ratio can be an early warning sign of an impending data collection attempt.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Storage Analytics logs
  - Google Cloud Audit Logs
  - Cloud provider API gateways
  - SIEM aggregation platform
  range: last 90 days
  queries:
  - technology: pseudocode
    query: For each principal, calculate the ratio of list/describe to get/read API calls and alert if the ratio exceeds the historical 99th percentile.
- question: Has a principal executed a sequence of API calls that is statistically unlikely based on their normal behavior patterns?
  context: This question uses sequence analysis to identify anomalous workflows. Legitimate users have predictable patterns of API calls based on their roles. A model trained on these patterns can detect when a user, or a compromised account, performs an unusual sequence of actions, such as rapidly listing and then downloading from multiple distinct storage locations, which is characteristic of data collection.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Storage Analytics logs
  - Google Cloud Audit Logs
  - Cloud provider API gateways
  - SIEM aggregation platform
  range: last 90 days
  queries:
  - technology: pseudocode
    query: Analyze real-time API call sequences using a trained sequence model (HMM/LSTM) and alert on sequences with a low probability of occurring.
- question: Has any principal downloaded an amount of data from a highly sensitive storage location that exceeds a predefined static limit?
  context: This question provides a simple, high-confidence detection for bulk data exfiltration from critical assets. For certain well-defined, highly sensitive data stores, any download activity exceeding a specific size (e.g., 1GB in an hour) is inherently suspicious and warrants an immediate alert, bypassing the need for complex baselining.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Storage Analytics logs
  - Zeek conn.log
  - Cloud storage services (e.g., S3 buckets, Azure Blobs)
  - Network flow data collectors at internet egress points
  - SIEM aggregation platform
  range: last 90 days
  queries:
  - technology: pseudocode
    query: Alert if the total data downloaded by a single principal from a sensitive storage location exceeds a static threshold (e.g., 1GB) in a 1-hour window.
- question: Has any principal's data download volume or API call count significantly deviated from their established historical baseline?
  context: This question aims to detect anomalous data access volumes on a per-user basis. Instead of a single static threshold for everyone, it establishes a personal baseline for each user's activity. An alert is triggered when a user's download volume or API call frequency exceeds their own normal pattern by a statistically significant amount (e.g., 3 standard deviations), catching outliers relative to their own behavior.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Storage Analytics logs
  - Zeek conn.log
  - Cloud storage services (e.g., S3 buckets, Azure Blobs)
  - Network flow data collectors at internet egress points
  - SIEM aggregation platform
  range: last 90 days
  queries:
  - technology: pseudocode
    query: For each principal, monitor hourly data download volume and API call counts; alert if activity exceeds 3 standard deviations above their 30-day rolling baseline.
- question: Is there a spike in a principal's data access volume that defies their normal historical rhythm and seasonality?
  context: This question uses time-series analysis to model the regular, often cyclical, patterns of a user's data access (e.g., higher activity during business hours, lower on weekends). This approach can detect anomalous spikes in data retrieval that might be missed by simple statistical methods, as it accounts for expected fluctuations. An alert is triggered when activity falls outside the model's predicted confidence interval.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Storage Analytics logs
  - Zeek conn.log
  - Cloud storage services (e.g., S3 buckets, Azure Blobs)
  - Network flow data collectors at internet egress points
  - SIEM aggregation platform
  range: last 90 days
  queries:
  - technology: pseudocode
    query: Use a time-series anomaly detection model (e.g., ARIMA) to monitor each principal's data access volume and alert on observations outside the predicted confidence interval.
- question: Did a principal log in and access data from a location that is physically impossible to have traveled to since their last login?
  context: This question seeks to identify 'impossible travel' scenarios, which are a strong indicator of account compromise. By geolocating login IP addresses and calculating the time and distance between them, this method can flag simultaneous or near-simultaneous access from geographically distant locations, suggesting that at least one of the sessions is malicious.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Active Directory sign-in logs
  - Windows Event ID 4624
  - Zeek conn.log
  - Identity and Access Management (IAM) systems
  - Enterprise Identity Provider (e.g., ADFS, Okta)
  - VPN concentrators
  - Endpoint devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: For each successful login, geolocate the source IP and compare it to the previous login's location and timestamp. Alert if the travel time is physically impossible.
- question: Did a recent data access event follow a login with a high-risk score based on multiple behavioral deviations?
  context: This question aggregates multiple weak signals into a stronger indicator of risk. A single anomaly (e.g., a new User-Agent) might be benign, but a combination of anomalies (e.g., unusual time, rare location, and new User-Agent) is highly suspicious. By scoring each deviation and summing them, this method can flag high-risk sessions that warrant investigation for potential data compromise.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Active Directory sign-in logs
  - Windows Event ID 4624
  - Zeek conn.log
  - Identity and Access Management (IAM) systems
  - Enterprise Identity Provider (e.g., ADFS, Okta)
  - VPN concentrators
  - Endpoint devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: Calculate a risk score for each login based on deviations from baseline (time, ASN, User-Agent). Alert if the aggregate score exceeds a set threshold.
- question: Does a principal's recent data access behavior represent a complex, multi-faceted deviation from their established 'pattern of life'?
  context: This question uses unsupervised machine learning to establish a holistic baseline of a user's normal activity, considering many features at once (time, location, device, etc.). It can detect sophisticated attacks where an adversary attempts to blend in, but their combined activity pattern is still subtly different from the legitimate user's. The model flags these complex deviations as anomalies.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Active Directory sign-in logs
  - Windows Event ID 4624
  - Zeek conn.log
  - Identity and Access Management (IAM) systems
  - Enterprise Identity Provider (e.g., ADFS, Okta)
  - VPN concentrators
  - Endpoint devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: Use an unsupervised anomaly detection model (e.g., Isolation Forest) on login/access features to identify events that deviate from a user's normal behavioral cluster.
- question: Has any non-public cloud storage object been accessed by an unauthenticated or anonymous principal?
  context: This question targets a critical security misconfiguration. Access to sensitive, non-public data by an anonymous user is almost always an indicator of a severe vulnerability being exploited. This is a high-fidelity, high-severity alert that requires immediate investigation to assess the scope of the data exposure.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Monitor logs
  - Google Cloud Audit Logs
  - Cloud provider IAM services
  - Cloud storage configuration panels
  - SIEM correlation engines
  range: last 90 days
  queries:
  - technology: pseudocode
    query: Alert immediately on any successful API call from an 'ANONYMOUS' principal to a resource not explicitly configured for public access.
- question: Did a principal successfully access a resource shortly after generating an unusually high number of 'Access Denied' errors for that or other resources?
  context: This question aims to detect privilege escalation or permission testing. An adversary may probe various resources, generating many access denied errors. A subsequent successful access to one of those resources could indicate they found a misconfiguration or successfully escalated their privileges. This pattern of 'fail, fail, fail, succeed' is highly suspicious.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Monitor logs
  - Google Cloud Audit Logs
  - Cloud provider IAM services
  - Cloud storage configuration panels
  - SIEM correlation engines
  range: last 90 days
  queries:
  - technology: pseudocode
    query: Monitor for principals exceeding their baseline 'AccessDenied' error rate; if a successful access to a previously denied resource follows, escalate an alert.
- question: Is a principal exhibiting a pattern of behavior characterized by a high ratio of failed-to-successful API calls and a wide variety of attempted actions?
  context: This question uses clustering to identify users whose overall session behavior is indicative of reconnaissance. Legitimate users typically have a low error rate and a focused set of API calls. Adversaries exploring an environment will have a high error rate as they test boundaries and will try a wide variety of actions. Clustering can group these outlier behaviors together for analyst review.
  answer_sources:
  - AWS CloudTrail logs
  - Azure Monitor logs
  - Google Cloud Audit Logs
  - Cloud provider IAM services
  - Cloud storage configuration panels
  - SIEM correlation engines
  range: last 90 days
  queries:
  - technology: pseudocode
    query: Use a clustering algorithm on API log session features to identify principals in clusters defined by high error rates and high action variety.