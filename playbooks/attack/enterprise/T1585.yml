name: "T1585: Establish Accounts"
id: "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
description: "Investigates whether an adversary has established accounts on external services for use in targeting the organization. This includes detecting inbound emails from known malicious infrastructure or from typosquatted/newly registered domains, identifying low-volume/high-recipient spray attacks, monitoring for anomalous traffic volumes from free webmail or dynamic DNS providers, and discovering the creation of accounts on external services (like social media or code repositories) using corporate email addresses or impersonating key employees."
type: "technique"
related:
  - "TA0042: Resource Development"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Are we receiving emails from source IPs or domains that are on a threat intelligence watchlist?"
    context: "This question aims to identify direct communication from known malicious infrastructure. Matching an inbound email's source IP or sender domain against a high-confidence threat intelligence feed provides a strong, early indicator that an adversary may be using pre-established malicious resources to target the organization."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek smtp.log"
      - "Cloud-based Email Security Service"
      - "On-premise Mail Transfer Agent (MTA)"
      - "Network Egress/Ingress Points (Firewalls/Proxies)"
      - "Threat Intelligence Feeds"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "FOR each new email event, GET sender_ip and sender_domain. CHECK IF sender_ip OR sender_domain IN threat_intel_watchlist. IF match, ALERT."
  - question: "Can we risk-score inbound emails based on threat intelligence to prioritize alerts?"
    context: "This question focuses on moving beyond simple blocklisting to a more nuanced, risk-based alerting system. By scoring Indicators of Compromise (IOCs) based on the threat feed's reliability and the IOC's age, security teams can dynamically prioritize the most relevant threats and reduce alert fatigue from stale or low-confidence intelligence."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek smtp.log"
      - "Cloud-based Email Security Service"
      - "On-premise Mail Transfer Agent (MTA)"
      - "Network Egress/Ingress Points (Firewalls/Proxies)"
      - "Threat Intelligence Feeds"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "FOR each threat_intel_match, CALCULATE risk_score = (feed_confidence * weight_1) - (ioc_age_in_days * weight_2). GET dynamic_threshold = 95th_percentile(risk_scores, last_7_days). IF risk_score > dynamic_threshold, ALERT."
  - question: "Can a machine learning model predict in real-time if an inbound email connection is malicious?"
    context: "This question explores the use of predictive analytics to proactively identify malicious activity that may not yet be present in threat intelligence feeds. By training a classification model on various network and sender features, the system can learn the characteristics of malicious connections and flag new, unseen activity with a high probability of being malicious, enabling detection of novel threats."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek smtp.log"
      - "Cloud-based Email Security Service"
      - "On-premise Mail Transfer Agent (MTA)"
      - "Network Egress/Ingress Points (Firewalls/Proxies)"
      - "Threat Intelligence Feeds"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "FOR each new inbound_connection, EXTRACT features (geolocation, ASN, protocol, port, domain_rep). PREDICT probability_malicious = ml_model(features). IF probability_malicious > 0.90, ALERT."
  - question: "Are we receiving emails from potential typosquatted domains or from very recently registered domains?"
    context: "This question addresses two common adversary techniques: impersonating the organization's domain to trick recipients (typosquatting) and using newly created domains for short-lived campaigns ('domain aging'). By actively checking against a list of look-alike domains and querying the registration date of all new sender domains, analysts can detect these high-risk indicators."
    answer_sources:
      - "Zeek smtp.log"
      - "External WHOIS Data"
      - "Email Gateway"
      - "Domain Registrar Data Feeds"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "FOR each new email, GET sender_domain. IF sender_domain IN typosquat_list, ALERT. ELSE, GET whois_creation_date(sender_domain). IF creation_date < 30_days_ago, ALERT."
  - question: "Are we receiving emails from domains that are anomalously new compared to our typical inbound traffic?"
    context: "This question aims to establish a dynamic baseline for 'normal' sender domain age and flag outliers. Instead of a fixed 30-day rule, this method adapts to the organization's specific email patterns. Domains that are significantly newer than 95% of all other inbound domains are statistically anomalous and warrant investigation, as they may be part of a targeted campaign."
    answer_sources:
      - "Zeek smtp.log"
      - "External WHOIS Data"
      - "Email Gateway"
      - "Domain Registrar Data Feeds"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "CALCULATE age_percentile_5 = 5th_percentile(all_inbound_domain_ages, last_90_days). FOR each new email, GET sender_domain_age. IF sender_domain_age < age_percentile_5, ALERT."
  - question: "Is there a statistically significant spike in the number of newly registered domains sending us email?"
    context: "This question uses time series analysis to detect unusual surges in campaign preparation activity. A sudden increase in the volume of emails from newly created domains, beyond what is historically expected for a given day, can indicate the start of a coordinated phishing or malware distribution campaign. This provides a macro-level view of potential threats."
    answer_sources:
      - "Zeek smtp.log"
      - "Zeek dns.log"
      - "External WHOIS Data"
      - "Email Gateway"
      - "Internal/External DNS Resolvers"
      - "Domain Registrar Data Feeds"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "GET daily_count_new_domains = COUNT(domains where age < 30_days) GROUP BY day. FORECAST upper_bound = prophet_model(historical_daily_counts). IF daily_count_new_domains > upper_bound, ALERT."
  - question: "Are any external senders engaging in low-and-slow, wide-net phishing or reconnaissance without receiving replies?"
    context: "This question targets a specific adversary pattern: sending a small number of emails to many different employees to probe for valid addresses or test delivery, while avoiding detection by volume-based security controls. The lack of replies is a key indicator that this is not legitimate business communication but rather unsolicited, one-way traffic."
    answer_sources:
      - "Zeek smtp.log"
      - "Zeek conn.log"
      - "Mail Exchange (MX) Servers"
      - "Email Gateway"
      - "Network Egress Points"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "IN 24h_window, GROUP BY sender. GET unique_recipient_count, total_email_count. CHECK FOR egress_traffic_to_sender. IF unique_recipient_count > 10 AND total_email_count < 20 AND egress_traffic_to_sender == FALSE, ALERT."
  - question: "Are any low-volume senders distributing emails to an unusually diverse and random set of recipients?"
    context: "This question uses information theory to quantify the randomness of a sender's recipient list. A high entropy value suggests the recipients are not part of a single department or logical group, which is characteristic of a phishing spray. Combining this with low email volume helps pinpoint adversaries trying to fly under the radar."
    answer_sources:
      - "Zeek smtp.log"
      - "Mail Exchange (MX) Servers"
      - "Email Gateway"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "FOR each sender in 24h_window, CALCULATE recipient_entropy. GET entropy_threshold = 95th_percentile(all_sender_entropies), volume_threshold = 10th_percentile(all_sender_volumes). IF sender.recipient_entropy > entropy_threshold AND sender.volume < volume_threshold, ALERT."
  - question: "Can we use graph analysis and clustering to identify anomalous senders who do not fit normal communication patterns?"
    context: "This question applies unsupervised machine learning to discover outlier senders. By representing email flows as a graph, clustering algorithms can group senders with similar behavior (e.g., sending to specific departments, similar volumes). Senders that don't fit into any cluster ('noise points') are, by definition, anomalous and may represent reconnaissance or phishing attempts that deviate from established communication norms."
    answer_sources:
      - "Zeek smtp.log"
      - "Mail Exchange (MX) Servers"
      - "Email Gateway"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "CREATE graph of sender-recipient interactions. FOR each sender, CREATE feature_vector (recipient_count, email_count, etc.). RUN DBSCAN(sender_feature_vectors). IF sender is classified as 'noise', ALERT."
  - question: "Are we seeing an unusually high number of unique source IPs from a single free webmail or dynamic DNS provider in a short time frame?"
    context: "This question aims to detect distributed attacks originating from large, shared infrastructure. An adversary might use many different accounts or compromised machines from a single provider (like a public cloud or dynamic DNS service) to launch a widespread attack. A sudden spike in the number of unique source IPs from one of these services, even if the per-IP volume is low, is a strong indicator of such a campaign."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek smtp.log"
      - "Zeek dns.log"
      - "Email Gateway"
      - "DNS Resolvers"
      - "Network Egress/Ingress Points (Firewalls/Proxies)"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "MAINTAIN categorized_domain_list. IN 1h_window, FOR each domain in list, COUNT unique source_ips. IF unique_source_ip_count > 100, ALERT."
  - question: "Is the daily volume of email or data from high-risk domain categories (like free webmail) statistically anomalous compared to the last 30 days?"
    context: "This question uses statistical process control (specifically, a Z-score or standard score) to detect significant deviations from a moving baseline. This method is effective for identifying sudden, large-scale changes in communication patterns from entire categories of services often abused by adversaries. An alert for exceeding three standard deviations indicates a highly improbable event under normal conditions."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek smtp.log"
      - "Email Gateway"
      - "Network Egress/Ingress Points (Firewalls/Proxies)"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "FOR each domain_category, CALCULATE 30d_moving_avg and 30d_std_dev for daily_volume. GET current_daily_volume. IF current_daily_volume > (30d_moving_avg + 3 * 30d_std_dev), ALERT."
  - question: "Can a machine learning model detect anomalous hourly connection patterns from high-risk domain categories, accounting for seasonality?"
    context: "This question leverages more advanced anomaly detection to identify subtle deviations that simple statistical methods might miss. A model like Isolation Forest can learn complex, multi-dimensional patterns, including time-of-day and day-of-week seasonality ('normal business hours'). It can then flag periods of activity that are abnormal for that specific context, providing a more sensitive and accurate detection capability."
    answer_sources:
      - "Zeek conn.log"
      - "Email Gateway"
      - "Network Egress/Ingress Points (Firewalls/Proxies)"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "FOR each high-risk_category, TRAIN anomaly_model on historical hourly connection counts. FOR each new hour's count, PREDICT is_anomaly = anomaly_model(current_hour_count). IF is_anomaly == TRUE, ALERT."
  - question: "Are corporate email addresses being used to sign up for unsanctioned services, or are new public profiles impersonating key employees being created?"
    context: "This question addresses two facets of account establishment: misuse of corporate assets and impersonation. A CASB can detect when a corporate email is used for a new account on a risky or unapproved platform, which could be a precursor to data exfiltration or brand abuse. Simultaneously, an OSINT service can scan the public internet for new profiles (e.g., on social media) that use the names and titles of key personnel, which is a common tactic for spearphishing."
    answer_sources:
      - "CASB Logs"
      - "OSINT Monitoring Service Data"
      - "Cloud Access Security Broker (CASB)"
      - "Public Internet (Social Media, Code Repositories)"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "CASB_RULE: ON new_account_creation IF platform NOT IN sanctioned_list AND email_domain == 'corporate.com', ALERT. OSINT_RULE: ON new_profile_detected IF profile_name IN key_employee_watchlist, ALERT."
  - question: "Are our users interacting with newly created, low-reputation social media profiles that are impersonating employees?"
    context: "This question seeks to correlate internal user activity with external threat intelligence about impersonation accounts. An adversary might create a fake profile of an employee and then try to lure other employees into visiting it. By detecting internal users browsing to these newly identified fake profiles, especially those with very few connections (a sign of a new, non-genuine account), security teams can spot the early stages of a social engineering attack."
    answer_sources:
      - "Web Proxy Logs"
      - "OSINT Monitoring Service Data"
      - "Secure Web Gateway"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "GET new_impersonation_profiles from OSINT. FOR each user_browsing_event, IF destination_url IN new_impersonation_profiles, ALERT."
  - question: "Can we use machine learning and NLP to automatically discover and classify potentially malicious impersonation profiles on the internet?"
    context: "This question describes an advanced, automated approach to discovering impersonation accounts. Instead of relying on a static watchlist of key employees, this method uses Natural Language Processing (NLP) to scan OSINT data for any mention of the company name associated with a person. A subsequent ML model can then analyze profile features (account age, post frequency, follower count) to determine if it's a legitimate employee or a suspicious persona, allowing for broader and more scalable discovery of threats."
    answer_sources:
      - "OSINT Monitoring Service Data"
      - "Public Internet (Social Media, Code Repositories)"
    range: "last 90 days"
    queries:
      - search: "pseudocode"
        query: "FROM OSINT_data, EXTRACT entities (person, company). IF company == 'our_company', CLASSIFY profile as 'legitimate' or 'suspicious' using ML_model. IF prediction is 'suspicious' with high confidence, ALERT."