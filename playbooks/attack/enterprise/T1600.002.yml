name: T1600.002: Disable Crypto Hardware
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: This playbook helps investigate whether an adversary is attempting to evade defenses by disabling cryptographic hardware on network devices. This can be detected by observing unauthorized administrative connections from untrusted IP addresses, specific CLI commands intended to disable crypto engines, anomalous login behaviors such as unusual geolocations or times, or a statistically significant decrease in the proportion of encrypted network traffic.
type: technique
related:
  - TA0005: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is an administrative connection to a network device originating from an unauthorized or known malicious IP address?
    context: This question is crucial for identifying initial unauthorized access attempts. An administrative connection (like SSH or Telnet) from an IP not on the pre-approved management allow-list, or one flagged by threat intelligence, is a strong indicator of a potential compromise or an external adversary attempting to gain a foothold.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4624
      - Network device management interfaces
      - Management subnets
      - Jump boxes
      - Log aggregation platforms (SIEM)
      - Internet gateways
    range: last 90 days
    queries:
      - search: Pseudocode
        query: JOIN (Zeek conn logs WHERE dest_port is 22 or 23) WITH (allow-list IPs, threat-intel IPs). ALERT IF source_ip NOT IN allow-list OR source_ip IN threat-intel.
  - question: Is an administrative connection to a network device originating from a geographically or network-topologically rare location?
    context: This question helps detect novel or unusual access patterns that might bypass simple allow-lists. By baselining the typical source Autonomous System Numbers (ASNs) and countries of origin for administrative connections, we can flag connections from statistically infrequent sources. This could indicate an adversary operating from an unusual location or network.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4624
      - Network device management interfaces
      - Management subnets
      - Jump boxes
      - Log aggregation platforms (SIEM)
      - Internet gateways
    range: last 90 days
    queries:
      - search: Pseudocode
        query: BASELINE frequency of source ASN/Country for admin connections over 30 days. ALERT IF new connection's source ASN/Country frequency is below 5th percentile.
  - question: Does a new administrative connection exhibit anomalous characteristics compared to historical, legitimate connections?
    context: This question uses machine learning to build a comprehensive model of 'normal' administrative behavior. By considering multiple features like source subnet, ASN, and time of day, an Isolation Forest model can identify subtle anomalies that might not trigger rule-based or simple statistical checks. Outlier connections flagged by this model are highly suspicious and warrant immediate investigation.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4624
      - Network device management interfaces
      - Management subnets
      - Jump boxes
      - Log aggregation platforms (SIEM)
      - Internet gateways
    range: last 90 days
    queries:
      - search: Pseudocode
        query: TRAIN Isolation Forest model on features (source_subnet, ASN, time_of_day) from historical admin connections. APPLY model to new connections. ALERT IF connection is classified as 'outlier'.
  - question: Has a command been executed on a network device to explicitly disable or alter hardware-based cryptographic functions?
    context: This question targets direct evidence of the 'Disable Crypto Hardware' technique. Adversaries may execute specific commands like 'no crypto engine' to downgrade security. Searching for these exact command strings in device logs provides a high-fidelity indicator of malicious activity aimed at evading encrypted communication monitoring.
    answer_sources:
      - Device Syslog
      - Windows Event ID 4688
      - Network devices (routers, switches, firewalls)
      - Centralized syslog servers
      - TACACS+/RADIUS servers
      - Management servers/jump boxes
    range: last 90 days
    queries:
      - search: Pseudocode
        query: SEARCH network device logs for regex `/(no\s+crypto\s+engine|crypto\s+engine\s+software)/i`. ALERT on match.
  - question: Is an administrative user executing an unusually complex or varied set of commands during a single session?
    context: This question aims to detect abnormal user behavior on the command line. By measuring the Shannon entropy of command strings per session, we can identify when a user's activity deviates from their normal pattern. A sudden spike in command entropy could indicate an adversary exploring the device's capabilities, or a compromised account being used for non-standard tasks.
    answer_sources:
      - Device Syslog
      - Windows Event ID 4688
      - Network devices (routers, switches, firewalls)
      - Centralized syslog servers
      - TACACS+/RADIUS servers
      - Management servers/jump boxes
    range: last 90 days
    queries:
      - search: Pseudocode
        query: BASELINE per-user command entropy per session. ALERT if new session's entropy is > 2 standard deviations from user's average.
  - question: Is a user's command-line session thematically inconsistent with their typical administrative duties?
    context: This question uses NLP to understand the intent behind command-line activity. By clustering historical commands into 'topics' (e.g., 'routing configuration', 'firewall rule changes'), we can identify sessions that don't fit any known topic. Such sessions may represent an adversary performing reconnaissance or executing malicious commands unrelated to normal system administration.
    answer_sources:
      - Device Syslog
      - Windows Event ID 4688
      - Network devices (routers, switches, firewalls)
      - Centralized syslog servers
      - TACACS+/RADIUS servers
      - Management servers/jump boxes
    range: last 90 days
    queries:
      - search: Pseudocode
        query: TRAIN LDA model on historical command logs to identify topics. CLASSIFY new command sessions. ALERT if a session has low probability for all known topics.
  - question: Did a successful administrative login to a network device occur from an unusual location or at an abnormal time?
    context: This question establishes a simple but effective behavioral baseline. Most administrative access occurs from specific geographic locations (e.g., corporate offices) and during regular business hours. A login that violates these predefined geofence or time-of-day rules is a strong signal of a potential account compromise or insider threat.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Authentication servers (Active Directory, RADIUS, TACACS+)
      - Management servers/jump boxes
      - Network gateway (for geolocation)
    range: last 90 days
    queries:
      - search: Pseudocode
        query: DEFINE per-user geofence and business hours. ALERT on successful login IF source_IP is outside geofence OR login_time is outside business hours.
  - question: Does a successful administrative login exhibit multiple behavioral anomalies simultaneously?
    context: This question moves beyond single indicators to a risk-based approach. By assigning scores to different types of anomalies (e.g., new country, unusual login hour, abnormal session duration) and summing them, we can identify logins that are suspicious across multiple dimensions. This helps prioritize alerts, focusing on events with the highest cumulative risk.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Authentication servers (Active Directory, RADIUS, TACACS+)
      - Management servers/jump boxes
      - Network gateway (for geolocation)
    range: last 90 days
    queries:
      - search: Pseudocode
        query: CALCULATE risk score for logins. +2 for new country, +1 for unusual time, +1 for unusual duration. ALERT if total_score > threshold.
  - question: Is a new administrative login a behavioral outlier compared to clusters of normal historical logins?
    context: This question uses unsupervised learning to automatically discover patterns of normal login behavior. The K-Means algorithm groups historical logins into clusters based on features like time, source, and duration. A new login that doesn't fit well into any existing cluster is considered a spatial outlier and a significant behavioral anomaly, potentially indicating a compromised account.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Authentication servers (Active Directory, RADIUS, TACACS+)
      - Management servers/jump boxes
      - Network gateway (for geolocation)
    range: last 90 days
    queries:
      - search: Pseudocode
        query: TRAIN K-Means model on historical login features (hour, day, ASN, duration). ALERT if a new login is far from all cluster centroids.
  - question: Was an unencrypted management protocol used to connect to a network device?
    context: This question looks for a blatant security misconfiguration or policy violation. The use of insecure, unencrypted protocols like Telnet or FTP for device management is a major security risk and should be strictly prohibited. An alert on such activity could indicate an adversary forcing a protocol downgrade or exploiting a legacy configuration.
    answer_sources:
      - Zeek conn.log
      - Zeek ssl.log
      - Zeek ipsec.log
      - Network backbone switches
      - Internet gateways
      - Datacenter core routers
      - VPN concentrators
    range: last 90 days
    queries:
      - search: Pseudocode
        query: SEARCH Zeek conn.log for connections to network devices WHERE service is 'telnet' or 'ftp'. ALERT on match.
  - question: Has there been a statistically significant drop in the proportion of encrypted traffic on the network?
    context: This question provides a macro-level view of the network's health and security posture. By monitoring the ratio of encrypted to total traffic over time, we can detect large-scale events, such as an adversary successfully disabling cryptographic hardware on a core device. A sudden, sustained drop below the historical baseline is a strong indicator that something is wrong.
    answer_sources:
      - Zeek conn.log
      - Zeek ssl.log
      - Zeek ipsec.log
      - Network backbone switches
      - Internet gateways
      - Datacenter core routers
      - VPN concentrators
    range: last 90 days
    queries:
      - search: Pseudocode
        query: CALCULATE ratio of (ssl_logs + ipsec_logs) / total_tcp_logs in 10-min intervals. BASELINE over 30 days. ALERT if ratio drops > 3 standard deviations from mean.
  - question: Is the current volume of encrypted network traffic significantly lower than forecasted expectations?
    context: This question uses predictive modeling to detect anomalies in traffic volume. Time series models like ARIMA or Prophet can learn the normal seasonal and trend patterns of encrypted traffic. If the actual observed volume falls consistently below the model's prediction, it suggests a non-random event is suppressing encrypted traffic, which could be the result of a defense evasion technique.
    answer_sources:
      - Zeek conn.log
      - Zeek ssl.log
      - Zeek ipsec.log
      - Network backbone switches
      - Internet gateways
      - Datacenter core routers
      - VPN concentrators
    range: last 90 days
    queries:
      - search: Pseudocode
        query: TRAIN time series model (e.g., Prophet) on historical encrypted traffic volume. FORECAST expected volume. ALERT if actual volume falls below the forecasted confidence interval.