name: "T1218.009: Regsvcs-Regasm"
id: "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
description: "Is the adversary bypassing application control or other defenses by proxying code execution through Regsvcs.exe or Regasm.exe? This can be investigated by checking if the executed library has a known malicious hash or is statistically rare; if it is being run from a non-standard or user-writable directory; if it is spawned by an unusual parent process like an Office application; or if its execution is followed by suspicious network activity, such as connections to known C2 servers or statistically anomalous destinations. These indicators can be combined to detect the full attack chain from payload drop to C2 communication."
type: "technique"
related:
  - "TA0005: Defense Evasion"
contributors:
  - "Zachary Szewczyk"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Is Regsvcs.exe or Regasm.exe being used to execute a library with a known malicious hash?"
    context: "This question aims to identify the most straightforward abuse of Regsvcs/Regasm, where the executed library is already known to be malicious. By creating a rule that triggers on the execution of these binaries, extracting the library's hash, and checking it against threat intelligence feeds, security teams can quickly detect known threats. A positive match is a high-confidence indicator of compromise."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "All managed Windows hosts (endpoints and servers)"
      - "Threat Intelligence Platform (TIP) data feeds"
    range: "last 90 days"
    queries:
      - "pseudocode: SEARCH process creation events for 'Regsvcs.exe' or 'Regasm.exe'. FOR each event, EXTRACT file path from command line. CALCULATE SHA256 hash of the file. QUERY TIP for the hash. ALERT on match."
  - question: "Is Regsvcs.exe or Regasm.exe executing a library that is unusually rare across the enterprise?"
    context: "This question helps uncover potentially new or targeted malware that is not yet present in threat intelligence feeds. Adversaries often use custom tools that will have a very low prevalence. By calculating the prevalence of every library executed by Regsvcs/Regasm and flagging those that are extremely rare (e.g., seen on only a few hosts), analysts can focus on statistically anomalous activity that might indicate a targeted attack."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "All managed Windows hosts (endpoints and servers)"
      - "Threat Intelligence Platform (TIP) data feeds"
    range: "last 90 days"
    queries:
      - "pseudocode: FOR each 'Regsvcs.exe' or 'Regasm.exe' execution, GET hash of target library. QUERY historical data for prevalence of hash across all hosts. IF prevalence < threshold, ALERT."
  - question: "Can we predict if a library being registered by Regsvcs.exe or Regasm.exe is malicious based on its binary features?"
    context: "This question leverages machine learning to proactively classify unknown binaries at the time of execution. Instead of relying on known-bad hashes or simple rarity, this approach analyzes intrinsic properties of the file itself, such as its structure, imported functions, and string patterns. A model trained on known good and bad files can assign a risk score, allowing for the detection of novel malicious payloads that share characteristics with other malware families."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "All managed Windows hosts (endpoints and servers)"
      - "Threat Intelligence Platform (TIP) data feeds"
    range: "last 90 days"
    queries:
      - "pseudocode: ON 'Regsvcs.exe'/'Regasm.exe' execution, EXTRACT features from the target library binary (PE header, imphash, entropy, signature). INPUT features into pre-trained classification model. IF malicious score > threshold, ESCALATE for analysis."
  - question: "Is Regsvcs.exe or Regasm.exe being executed with a library located in a suspicious or user-writable directory?"
    context: "Adversaries often place their payloads in non-standard locations like temporary directories, user profile folders, or the recycle bin to evade detection and operate in a space with lower integrity levels. This question checks for executions of Regsvcs/Regasm where the target library resides in one of these commonly abused locations, which is a strong indicator of malicious activity as legitimate software installations typically use standard paths like Program Files."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "File systems of all managed Windows hosts, specifically monitoring user-writable directories (e.g., C:\\Users\\), temporary locations, and other unusual paths for binary execution."
    range: "last 90 days"
    queries:
      - "pseudocode: SEARCH process creation events for 'Regsvcs.exe' or 'Regasm.exe'. IF command line contains a path matching regex for suspicious locations (e.g., /Users/Public, /AppData, /Temp), ALERT."
  - question: "Is Regsvcs.exe or Regasm.exe being invoked with a library from a directory that is historically uncommon for such executions?"
    context: "This question provides a data-driven way to define 'unusual' paths beyond a static list. By baselining all parent directories used in legitimate Regsvcs/Regasm executions, the system can flag any new execution from a path that has rarely or never been seen before. This statistical approach can adapt to an environment's specific software landscape and uncover adversary TTPs that use novel but suspicious locations."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "File systems of all managed Windows hosts, specifically monitoring user-writable directories (e.g., C:\\Users\\), temporary locations, and other unusual paths for binary execution."
    range: "last 90 days"
    queries:
      - "pseudocode: ON 'Regsvcs.exe'/'Regasm.exe' execution, EXTRACT parent directory from command line. QUERY historical data for frequency of this directory. IF frequency is in low percentile, ALERT."
  - question: "Can we identify anomalous Regsvcs.exe or Regasm.exe command-line invocations using clustering?"
    context: "This question uses unsupervised machine learning to find outliers in how Regsvcs/Regasm is being called. By clustering historical command-line data based on features like path tokens and arguments, the system learns what 'normal' invocations look like (e.g., from a specific installer with specific flags). Any new execution that doesn't fit into these normal clusters is flagged as an anomaly, potentially representing a malicious deviation from standard behavior."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "File systems of all managed Windows hosts, specifically monitoring user-writable directories (e.g., C:\\Users\\), temporary locations, and other unusual paths for binary execution."
    range: "last 90 days"
    queries:
      - "pseudocode: ON 'Regsvcs.exe'/'Regasm.exe' execution, TOKENIZE command line into features (path parts, arguments). INPUT features into clustering model (e.g., DBSCAN). IF invocation is classified as a noise point/outlier, ALERT."
  - question: "Is Regsvcs.exe or Regasm.exe being launched by a suspicious parent process like an Office application or script interpreter?"
    context: "Regsvcs.exe and Regasm.exe are typically launched by installers or developer tools. When they are spawned by common user applications like Microsoft Word, Outlook, or PowerShell, it is highly suspicious. This often indicates that an initial-access payload (e.g., a malicious macro or script) is attempting to use these utilities to execute a secondary payload. This question identifies these illegitimate parent-child relationships."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Process ancestry data on all managed Windows hosts; focus correlation on endpoints running common productivity software (e.g., Microsoft Office, web browsers, PDF readers)."
    range: "last 90 days"
    queries:
      - "pseudocode: SEARCH process creation events for 'Regsvcs.exe' or 'Regasm.exe'. IF parent process is in a list of suspicious parents (e.g., 'winword.exe', 'powershell.exe'), ALERT."
  - question: "Is a statistically improbable parent-child process relationship involving Regsvcs.exe or Regasm.exe occurring on a host?"
    context: "This question moves beyond a static list of bad parents and instead looks for parent-child relationships that are rare for a specific host or for the enterprise as a whole. By calculating the probability of a given parent spawning Regsvcs/Regasm, the system can flag executions that deviate from established baselines. This can detect an adversary using a legitimate but unusual process on a compromised machine to launch their tools."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Process ancestry data on all managed Windows hosts; focus correlation on endpoints running common productivity software (e.g., Microsoft Office, web browsers, PDF readers)."
    range: "last 90 days"
    queries:
      - "pseudocode: FOR each 'Regsvcs.exe'/'Regasm.exe' execution, IDENTIFY parent process. CALCULATE historical probability of this parent-child pair on the host. IF probability is below threshold, ALERT."
  - question: "Does the process execution chain leading to Regsvcs.exe or Regasm.exe represent an anomalous sequence?"
    context: "This question uses a sophisticated ML approach to analyze the entire chain of events (e.g., grandparent -> parent -> child) leading to the execution. By training a sequence model like an LSTM autoencoder on millions of benign process chains, the system learns the 'grammar' of normal system activity. A malicious chain, even if it uses legitimate process names, will likely have a structure that the model has not seen before, resulting in a high anomaly score and a high-fidelity alert."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Process ancestry data on all managed Windows hosts; focus correlation on endpoints running common productivity software (e.g., Microsoft Office, web browsers, PDF readers)."
    range: "last 90 days"
    queries:
      - "pseudocode: ON 'Regsvcs.exe'/'Regasm.exe' execution, CAPTURE the process execution chain (e.g., P1 -> P2 -> Regsvcs.exe). FEED sequence into a trained anomaly detection model (e.g., LSTM autoencoder). IF reconstruction error is high, ALERT."
  - question: "Does a Regsvcs.exe or Regasm.exe execution precede a network connection to a known malicious IP or domain?"
    context: "This question seeks to link the execution of a potential payload via Regsvcs/Regasm to subsequent command-and-control (C2) activity. By correlating the process execution with network logs within a short time window (e.g., 5 minutes), analysts can identify when the payload 'calls home' to an IP or domain listed in threat intelligence feeds. This provides strong, contextualized evidence of a successful compromise."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Sysmon Event ID 3"
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Network egress points, DNS resolvers, and individual host network stacks. Requires correlation within a SIEM or data lake."
    range: "last 90 days"
    queries:
      - "pseudocode: CORRELATE 'Regsvcs.exe'/'Regasm.exe' process events with subsequent network connection events from the same host within 5 minutes. IF destination IP or domain is on a blocklist, ALERT."
  - question: "Following a Regsvcs.exe or Regasm.exe execution, does the host make network connections to a statistically rare destination or use a high-entropy domain name?"
    context: "This question helps detect C2 activity even when the destination is not on a blocklist. It does this in two ways: first, by identifying connections to IPs, ASNs, or countries that are rare for the organization, and second, by analyzing the domain name itself for signs of algorithmic generation (DGA), which often results in high-entropy, random-looking strings. A combination of these statistical anomalies following a Regsvcs/Regasm execution is a strong signal of malicious behavior."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Sysmon Event ID 3"
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Network egress points, DNS resolvers, and individual host network stacks. Requires correlation within a SIEM or data lake."
    range: "last 90 days"
    queries:
      - "pseudocode: AFTER 'Regsvcs.exe'/'Regasm.exe' execution, ANALYZE subsequent network connections. CALCULATE rarity of destination IP/ASN. CALCULATE entropy of queried domain. IF rarity is high OR entropy is high, ALERT."
  - question: "Is there an anomalous change in a host's network behavior profile shortly after a Regsvcs.exe or Regasm.exe execution?"
    context: "This question uses time-series analysis to detect subtle changes in a host's network traffic patterns that might indicate C2 activity. A machine learning model is trained on the normal 'heartbeat' of a host's network metrics (e.g., bytes out, connection frequency). If, after a Regsvcs/Regasm execution, the model detects a significant deviation from this learned baseline, it signals an anomaly. This can catch C2 channels that don't use known-bad IPs or obviously random domain names."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Sysmon Event ID 3"
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Network egress points, DNS resolvers, and individual host network stacks. Requires correlation within a SIEM or data lake."
    range: "last 90 days"
    queries:
      - "pseudocode: AFTER 'Regsvcs.exe'/'Regasm.exe' execution, MONITOR host's network metrics (bytes sent, connection count). FEED metrics into a trained time-series anomaly detection model. IF model flags an anomaly within 10 minutes, ALERT."
  - question: "Has a sequence of 'file create -> Regsvcs/Regasm execution -> external network connection' occurred on a host within a short time window?"
    context: "This question looks for a classic attack chain associated with living-off-the-land techniques. It correlates three distinct events: the creation of a payload file in a user-writable directory, the execution of that file via Regsvcs/Regasm, and a subsequent network callout. Tying these events together provides a high-fidelity alert that describes the adversary's actions from payload delivery to C2 establishment, significantly reducing false positives."
    answer_sources:
      - "Sysmon Event ID 11"
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Zeek conn.log"
      - "Sysmon Event ID 3"
      - "SIEM/Data Lake containing correlated host telemetry (process, file system) and network telemetry (DNS, flow logs) from across the enterprise."
    range: "last 90 days"
    queries:
      - "pseudocode: CORRELATE events by host within 10 minutes: 1. FileCreate event for DLL/EXE in user path. 2. ProcessCreate event for 'Regsvcs.exe'/'Regasm.exe' with same file. 3. Network connection to external IP. IF chain is complete, ALERT."
  - question: "Does a sequence of events involving a file creation, Regsvcs/Regasm execution, and network connection accumulate a risk score that exceeds a high-risk threshold?"
    context: "This question provides a flexible way to score and prioritize suspicious event chains. Instead of a rigid rule, it assigns a risk score to each component of the chain (e.g., writing to %TEMP% is risky, executing from there is riskier, connecting to a rare ASN is riskier still). By summing these scores over a rolling time window, the system can dynamically identify and alert on the most dangerous combinations of activities, even if individual events are only moderately suspicious."
    answer_sources:
      - "Sysmon Event ID 11"
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Zeek conn.log"
      - "Sysmon Event ID 3"
      - "SIEM/Data Lake containing correlated host telemetry (process, file system) and network telemetry (DNS, flow logs) from across the enterprise."
    range: "last 90 days"
    queries:
      - "pseudocode: ASSIGN risk scores to individual events (e.g., FileCreate in %TEMP%, Regsvcs execution, external connection to rare ASN). SUM scores for events linked by host in a 10-minute window. IF total score > threshold, ALERT."
  - question: "Can we detect the malicious 'File -> Regsvcs -> Network' TTP chain as a structurally anomalous graph in our host activity data?"
    context: "This question applies graph-based machine learning to model all host activity as a complex network of entities and events. The algorithm learns the common structures and pathways that represent normal system behavior. A specific, rare subgraph pattern corresponding to 'File created -> executed by Regsvcs -> connected to IP' would be identified by the model as a structural anomaly, providing a powerful, context-aware method for detecting the entire adversary tactic in one go."
    answer_sources:
      - "Sysmon Event ID 11"
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Zeek conn.log"
      - "Sysmon Event ID 3"
      - "SIEM/Data Lake containing correlated host telemetry (process, file system) and network telemetry (DNS, flow logs) from across the enterprise."
    range: "last 90 days"
    queries:
      - "pseudocode: MODEL host activity as a graph (nodes=entities, edges=events). USE graph anomaly detection to find rare subgraphs. ALERT if a subgraph matches the 'File -> created -> Process -> executed -> Regsvcs -> connected_to -> IP' pattern."