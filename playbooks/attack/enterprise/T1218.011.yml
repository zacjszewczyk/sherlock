name: T1218.011: Rundll32
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps determine if an adversary is leveraging rundll32.exe to execute malicious code for defense evasion. Adversaries may use this legitimate Windows utility to proxy the execution of code, such as from a DLL, in order to bypass security controls that may not inspect rundll32.exe activity. Investigations should focus on identifying rundll32.exe processes that load known malicious DLLs, initiate suspicious network connections, have command lines with malicious patterns (like javascript protocol handlers or ordinal calls), execute from non-standard paths, have anomalous parent processes, or exhibit unusual execution frequency.
type: technique
related:
  - TA0005: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is a rundll32.exe process executing a known malicious DLL or connecting to a malicious network destination?
    context: This question aims to detect threats by correlating rundll32.exe process activity with external threat intelligence. By checking the file hash of the executed DLL and any subsequent network connections against known malicious indicators, analysts can quickly identify if rundll32.exe is being used as part of a known attack campaign or to communicate with command-and-control infrastructure.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 5156
      - Zeek conn.log
      - Zeek dns.log
      - All Windows Endpoints and Servers, Domain Controllers, Internet Gateway/Egress Points
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: FOR each process creation event WHERE process_name is 'rundll32.exe', extract the DLL path from the command line. Calculate the DLL's file hash and check it against threat intelligence feeds. Correlate the process ID with network events to find destination IPs and domains, and check those against reputation services. If any match is found, generate a high-severity alert.
  - question: Is a DLL being executed by rundll32.exe that is statistically rare within the environment?
    context: This question helps uncover targeted or novel threats by focusing on rarity. Adversaries often use custom or uncommon DLLs, whereas legitimate system DLLs are prevalent across an enterprise. By baselining DLL usage and filtering out known-good files, any DLL executed by rundll32.exe on a very small number of hosts becomes highly suspicious and warrants investigation as a potential intrusion.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 5156
      - Zeek conn.log
      - Zeek dns.log
      - All Windows Endpoints and Servers, Domain Controllers, Internet Gateway/Egress Points
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: Over a 30-day baseline, group all rundll32.exe executions by the file hash of the loaded DLL. Count the number of distinct hosts for each hash. After excluding hashes belonging to known-good software, alert on any DLL hash that is found on a statistically rare number of hosts (e.g., less than 5).
  - question: Does a rundll32.exe execution exhibit a combination of features that a machine learning model identifies as malicious?
    context: This question applies machine learning to detect complex, subtle patterns of malicious behavior that are difficult to capture with simple rules. By training a model on features like the DLL's location, the parent process, command-line properties, and associated network activity, the system can learn to distinguish between benign and malicious executions and flag new, suspicious events in real-time.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 5156
      - Zeek conn.log
      - Zeek dns.log
      - All Windows Endpoints and Servers, Domain Controllers, Internet Gateway/Egress Points
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: For each new rundll32.exe execution, extract a feature set (e.g., DLL directory, parent process name, command line length, network port, IP reputation). Input these features into a pre-trained classification model. If the model returns a high probability score for being malicious, generate an alert.
  - question: Does a rundll32.exe command line contain high-fidelity patterns known to be used for malicious proxy execution?
    context: Adversaries have developed specific, recognizable command-line patterns to abuse rundll32.exe for tasks like executing remote scripts or bypassing application controls. This question uses regular expressions to search for these known malicious signatures, such as invoking the 'javascript:' protocol handler or calling DLL functions by ordinal number, providing a high-confidence way to detect abuse.
    answer_sources:
      - Windows Event ID 4688
      - All Windows Endpoints and Servers, User Workstations
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: Scan all rundll32.exe process creation command lines (Event ID 4688) using regular expressions to detect patterns like 'javascript:', 'shell32.dll,Control_RunDLL', or ',#\\d+'. If a match is found, trigger a high-severity alert.
  - question: Is the command line of a rundll32.exe process unusually complex or obfuscated?
    context: To evade detection, adversaries may obfuscate the commands passed to rundll32.exe. This question uses Shannon entropy to measure the randomness or complexity of the command line arguments. A command line with an unusually high entropy score, when compared to a baseline of normal activity, can indicate the presence of packed or obfuscated code, which is a strong signal of malicious intent.
    answer_sources:
      - Windows Event ID 4688
      - All Windows Endpoints and Servers, User Workstations
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: For each rundll32.exe execution, calculate the Shannon entropy of its command line. Compare this score to an established baseline of legitimate command-line entropy scores. Alert if the score exceeds a high percentile threshold (e.g., 99th percentile), suggesting obfuscation.
  - question: Does the command line of a rundll32.exe process appear malicious based on a text classification model?
    context: This question uses natural language processing techniques to analyze the entire command line for suspicious characteristics. By training a model on a large dataset of both benign and malicious command lines, it can learn to identify suspicious combinations of arguments, paths, and function calls that may not be caught by simple pattern matching, thus detecting more nuanced or novel attack techniques.
    answer_sources:
      - Windows Event ID 4688
      - All Windows Endpoints and Servers, User Workstations
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: For each new rundll32.exe command line, use a trained text classification model (e.g., using TF-IDF or word embeddings) to classify it as benign or malicious. If the model classifies the command line as malicious with high confidence, generate an alert.
  - question: Is rundll32.exe executing from an unusual file path, loading a DLL from a user-writable directory, or being spawned by an anomalous parent process?
    context: This question seeks to identify rundll32.exe abuse by looking for deviations from its normal execution context. Legitimate instances of rundll32.exe reside in System32/SysWOW64 and are typically spawned by system processes. An alert on execution from a different path, loading a DLL from a temp or user folder, or being parented by an application like Microsoft Word can indicate a masquerading threat or process injection.
    answer_sources:
      - Windows Event ID 4688
      - All Windows Endpoints and Servers, File servers hosting user profiles or shared drives
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: Create rules to alert if 1) a process named 'rundll32.exe' runs from outside System32/SysWOW64, 2) a legitimate rundll32.exe loads a DLL from a user-writable path (e.g., C:\Users\), or 3) its parent process is unusual (e.g., winword.exe, wscript.exe).
  - question: Is rundll32.exe being spawned by a parent process that is statistically rare in the environment?
    context: While some parent processes are definitively suspicious (like winword.exe), other anomalous relationships can be more subtle. This question establishes a baseline of all parent-child process relationships involving rundll32.exe across the enterprise. It then flags any execution where the parent process is statistically infrequent, which can uncover novel or targeted execution chains used by adversaries.
    answer_sources:
      - Windows Event ID 4688
      - All Windows Endpoints and Servers, File servers hosting user profiles or shared drives
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: Aggregate all parent-child process pairs involving rundll32.exe over 30 days. Calculate the frequency of each unique parent process. Alert when rundll32.exe is spawned by a parent process that falls below a low-frequency threshold (e.g., 1st percentile).
  - question: Does a rundll32.exe execution event have features that an anomaly detection model flags as abnormal?
    context: This question uses unsupervised machine learning to find outliers without pre-existing labels of "good" or "bad." The model is trained on the features of normal, benign rundll32.exe executions (e.g., parent process, DLL location). It can then identify new events that deviate significantly from this learned norm, flagging them as potential threats even if they don't match any known malicious pattern.
    answer_sources:
      - Windows Event ID 4688
      - All Windows Endpoints and Servers, File servers hosting user profiles or shared drives
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: Train an anomaly detection model (e.g., Isolation Forest) on features from benign rundll32.exe executions. Score new events against this model. Alert on any event that the model identifies as an anomaly.
  - question: Has a single host generated a burst of multiple, distinct suspicious rundll32.exe alerts in a short time frame?
    context: A single suspicious rundll32.exe alert might be a false positive, but a cluster of different types of alerts (e.g., rare path, malicious pattern, anomalous parent) on the same host in a short period is a strong indicator of a multi-stage attack. This question correlates various weak signals into a high-confidence incident, allowing analysts to prioritize a potentially compromised host.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 5156
      - Zeek conn.log
      - Zeek dns.log
      - All Windows Endpoints and Servers, Network Egress Points, DNS Servers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: Create a correlation rule that counts distinct suspicious rundll32.exe alerts per host. If the count exceeds a threshold (e.g., 5 alerts) within a short window (e.g., 10 minutes), escalate the event to a high-severity incident.
  - question: Has the rate of rundll32.exe executions on a single host suddenly spiked above its normal baseline?
    context: Adversaries may use rundll32.exe in a loop or for multiple rapid actions, causing a sudden increase in its execution frequency on a compromised host. This question establishes a baseline of normal rundll32.exe execution volume for each host and alerts when there is a statistically significant spike, which could indicate automated or scripted malicious activity.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 5156
      - Zeek conn.log
      - Zeek dns.log
      - All Windows Endpoints and Servers, Network Egress Points, DNS Servers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: For each host, maintain a moving average and standard deviation of rundll32.exe executions. If the count within a small time interval (e.g., 5 minutes) exceeds a threshold (e.g., 3 standard deviations above the average), generate an alert.
  - question: Is the execution volume or network behavior of rundll32.exe anomalous based on advanced modeling?
    context: This question applies more sophisticated modeling to detect anomalies. For execution volume, a time-series model (like ARIMA) can predict the expected frequency and flag deviations. For network behavior, a clustering algorithm (like DBSCAN) can group all rundll32-initiated connections by their features (port, duration, etc.) and identify any connections that don't fit into a common pattern, flagging them as potential C2 channels or data exfiltration.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 5156
      - Zeek conn.log
      - Zeek dns.log
      - All Windows Endpoints and Servers, Network Egress Points, DNS Servers
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: Use a time-series model on per-host rundll32.exe execution counts to detect anomalous spikes. Separately, use a clustering algorithm on network connection features for rundll32.exe processes. Alert on time-series anomalies or on network connections classified as noise or belonging to sparse clusters.