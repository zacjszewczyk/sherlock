name: T1630.002: File Deletion
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: >-
  This playbook helps investigate whether an adversary is deleting files or wiping data on corporate mobile devices to evade detection or cause impact. It focuses on identifying several key indicators: the granting of device administrator privileges to unapproved applications, which could enable destructive actions; anomalously high rates of file deletion events from a single process or device, suggesting wiper malware or manual evidence removal; the specific deletion of critical file types from sensitive directories by unauthorized processes, indicating targeted data destruction; and the correlation of high-volume outbound network traffic with subsequent file deletions, which points to a data exfiltration-then-destruction attack chain.
type: technique
related:
  - TA0030: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are mobile applications that are not on the corporate allowlist being granted device administrator privileges?
    context: >-
      This question helps detect potentially malicious or unauthorized applications gaining high-level control over a mobile device. Granting administrator privileges to an unvetted application is a significant security risk, as it could allow the app to perform sensitive actions like wiping data, modifying settings, or installing other malicious software. Identifying these events is a critical first step in preventing a potential compromise.
    answer_sources:
      - MDM.PrivilegeGrantEvents
      - EDR.ApplicationInventoryLogs
      - Internal.CorporateAppAllowlist
      - Corporate-managed mobile devices (iOS, Android)
      - Mobile Device Management (MDM) Platform
      - Application Vetting System
      - Corporate App Store
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: SIEM
        query: SEARCH MDM.PrivilegeGrantEvents | JOIN app_package_name, app_cert_hash WITH Internal.CorporateAppAllowlist | WHERE allowlist_match IS NULL | ALERT high_severity
  - question: Is there an anomalous spike in the number of device administrator privilege grants across the mobile fleet?
    context: >-
      This question aims to identify widespread or coordinated malicious activity. A sudden increase in privilege grants across many devices, even if the apps are known, could indicate a compromised update, a vulnerability being exploited at scale, or a new attack campaign. Baselining normal activity and alerting on statistical deviations helps detect subtle but large-scale attacks that might otherwise go unnoticed.
    answer_sources:
      - MDM.PrivilegeGrantEvents
      - EDR.ApplicationInventoryLogs
      - Internal.CorporateAppAllowlist
      - Corporate-managed mobile devices (iOS, Android)
      - Mobile Device Management (MDM) Platform
      - Application Vetting System
      - Corporate App Store
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: Time-series Database / SIEM
        query: FROM MDM.PrivilegeGrantEvents | AGGREGATE count BY 24h | CALCULATE rolling_30d_mean, rolling_30d_stddev | ALERT medium_severity WHERE count > (mean + 3 * stddev)
  - question: Can we use machine learning to predictively identify high-risk device administrator privilege grants based on contextual features?
    context: >-
      This question explores a more advanced, proactive detection method. Instead of relying on static rules or simple statistical anomalies, a machine learning model can learn complex patterns from various data points (like app category, permissions, user role, time of day) to identify suspicious grants that may appear legitimate individually. This helps find novel threats and reduces false positives by considering a richer set of context.
    answer_sources:
      - MDM.PrivilegeGrantEvents
      - EDR.ApplicationInventoryLogs
      - Internal.CorporateAppAllowlist
      - Corporate-managed mobile devices (iOS, Android)
      - Mobile Device Management (MDM) Platform
      - Application Vetting System
      - Corporate App Store
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: Machine Learning Model
        query: INPUT MDM.PrivilegeGrantEvent | EXTRACT_FEATURES (app_category, permissions, user_role, time_of_day) | SCORE with RandomForestModel | ALERT analyst_review WHERE risk_score > 0.8
  - question: Are file deletions on mobile devices being initiated by known malicious processes or by processes not recognized as legitimate system utilities?
    context: >-
      This question focuses on identifying file deletions caused by explicitly malicious or unauthorized software. By checking the process initiating the deletion against a list of known malware indicators (IOCs) and an allowlist of legitimate system processes (like uninstallers or cache cleaners), analysts can quickly pinpoint suspicious activity and rule out benign system operations.
    answer_sources:
      - EDR.FileModificationEvents
      - Android.Logcat
      - Internal.SystemProcessAllowlist
      - User data partitions on corporate mobile devices
      - Application sandboxes on mobile devices
      - MDM/EDR management console
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: SIEM
        query: SEARCH EDR.FileModificationEvents WHERE event_type = 'deletion' | CHECK process_name AGAINST (MalwareIOCList, SystemProcessAllowlist) | ALERT high_severity IF process_name IN MalwareIOCList OR process_name NOT IN SystemProcessAllowlist
  - question: Is a specific user or mobile device exhibiting an unusually high rate of file deletions in a short time frame?
    context: >-
      This question helps detect rapid data destruction on a single endpoint, which is a hallmark of wiper malware or a panicked adversary trying to cover their tracks. By establishing a normal baseline for file deletion activity for each user/device and alerting on significant deviations (e.g., exceeding the 99th percentile), this can catch destructive actions that might be missed by signature-based rules.
    answer_sources:
      - EDR.FileModificationEvents
      - Android.Logcat
      - Internal.SystemProcessAllowlist
      - User data partitions on corporate mobile devices
      - Application sandboxes on mobile devices
      - MDM/EDR management console
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: Streaming Analytics / SIEM
        query: FROM EDR.FileModificationEvents | GROUP BY device_id, user_id | AGGREGATE count BY 5m | COMPARE count to historical_99th_percentile_for_group | ALERT medium_severity WHERE count > percentile
  - question: Can a time-series model detect anomalous patterns in file deletion activity that simple thresholding might miss?
    context: >-
      This question proposes a more sophisticated anomaly detection approach. A time-series model like ARIMA or LSTM can learn seasonal or complex temporal patterns in file deletion activity. This allows it to detect deviations that are not just simple spikes, but changes in the rhythm or pattern of deletions, potentially indicating more subtle or slow-moving malicious activity.
    answer_sources:
      - EDR.FileModificationEvents
      - Android.Logcat
      - Internal.SystemProcessAllowlist
      - User data partitions on corporate mobile devices
      - Application sandboxes on mobile devices
      - MDM/EDR management console
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: Time-series Anomaly Detection Model
        query: INPUT file_deletion_count_timeseries | PREDICT expected_range with ARIMA/LSTM_model | ALERT anomaly WHERE observed_count NOT IN predicted_range
  - question: Are unauthorized applications deleting critical files from sensitive directories on mobile devices?
    context: >-
      This question is highly specific and aims to detect the destruction of high-value data. By focusing on deletions of specific file types (e.g., .docx, .pdf) from known sensitive locations (e.g., /Documents) by unapproved applications, this rule can generate high-fidelity alerts that point directly to potential data destruction or intellectual property theft.
    answer_sources:
      - EDR.FileModificationEvents
      - Internal.CorporateAppAllowlist
      - Sensitive data storage locations on mobile devices
      - Endpoint devices of high-value targets (e.g., Executive and R&D department mobile devices)
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: SIEM
        query: SEARCH EDR.FileModificationEvents | WHERE file_path IN SensitiveDirectories AND file_extension IN CriticalExtensions AND process_name NOT IN CorporateAppAllowlist | ALERT high_severity
  - question: When a potentially malicious file deletion is detected, is the process name obfuscated or randomized?
    context: >-
      This question provides a method for enriching and prioritizing alerts. Malware often uses randomly generated process names to evade simple signature-based detection. Calculating the Shannon entropy of a process name can quantify its randomness. A high entropy score for a process that is deleting sensitive files is a strong indicator of malicious intent, justifying an immediate escalation to a critical priority.
    answer_sources:
      - EDR.FileModificationEvents
      - Internal.CorporateAppAllowlist
      - Sensitive data storage locations on mobile devices
      - Endpoint devices of high-value targets (e.g., Executive and R&D department mobile devices)
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: SIEM / SOAR
        query: ON alert from previous_rule | CALCULATE shannon_entropy(process_name) | IF entropy > 3.5 THEN ESCALATE alert_priority to critical
  - question: Is a user's file deletion activity inconsistent with their normal, established patterns of behavior?
    context: >-
      This question leverages user behavior analytics (UBA) to find anomalies. A clustering model can learn a user's "normal" file interaction patterns (e.g., 'Word processing in the morning', 'Compiling code in the afternoon'). A file deletion event that falls outside of these normal clusters—for instance, a text editor deleting a large number of photos at 3 AM—can be flagged as a behavioral outlier, even if the process itself is legitimate. This helps detect account takeovers or insider threats.
    answer_sources:
      - EDR.FileModificationEvents
      - Internal.CorporateAppAllowlist
      - Sensitive data storage locations on mobile devices
      - Endpoint devices of high-value targets (e.g., Executive and R&D department mobile devices)
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: User Behavior Analytics / ML
        query: INPUT file_deletion_event (process, file_type, time_of_day) | COMPARE to user's DBSCAN_behavioral_clusters | IF event is outlier THEN FLAG as anomalous
  - question: Is a high-volume file deletion event on a mobile device preceded by network communication with a known malicious C2 server or data exfiltration point?
    context: >-
      This question correlates network and endpoint activity to identify a classic attack chain: data exfiltration followed by evidence destruction. An adversary might first upload sensitive files to their server and then try to wipe the device to cover their tracks. By linking a connection to a malicious IP/domain with subsequent mass file deletions on the same device within a short time window, this rule provides strong, actionable evidence of a full-blown compromise.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - EDR.FileModificationEvents
      - MDM.DHCPLeaseLogs
      - Our organization's internet gateway
      - Corporate-managed mobile devices
      - DNS resolvers
      - DHCP servers
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: SIEM
        query: STATEFUL_SEARCH | a = SEARCH Zeek.conn.log WHERE dest_ip IN ThreatIntelBlocklist | b = SEARCH EDR.FileModificationEvents WHERE event_type = 'high-volume-deletion' | CORRELATE a, b ON device_id WHERE timestamp(b) - timestamp(a) < 15m | ALERT critical
  - question: Is there an anomalous amount of data being transferred outbound from a mobile device, potentially correlated with file deletion activity?
    context: >-
      This question focuses on detecting data exfiltration by looking for statistical anomalies in network traffic volume. A sudden, large spike in outbound data from a device that normally sends very little can be a sign of data theft. While this alone could be a false positive (e.g., a large cloud backup), enriching the alert with information about any subsequent file deletions on the same device adds crucial context and increases the likelihood that the activity is malicious.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - EDR.FileModificationEvents
      - MDM.DHCPLeaseLogs
      - Our organization's internet gateway
      - Corporate-managed mobile devices
      - DNS resolvers
      - DHCP servers
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: SIEM / Network Analytics
        query: FROM Zeek.conn.log | AGGREGATE sum(outbound_bytes) BY device_id, 24h | CALCULATE 30d_baseline | ALERT medium_severity IF outbound_bytes > (baseline_mean + 3 * stddev) | ENRICH alert with subsequent file_deletion_events within 1h
  - question: Can a sequence analysis model detect the specific attack pattern of 'large data exfiltration followed by file deletion' as a low-probability event sequence?
    context: >-
      This question proposes using an advanced ML model to understand the order of events. An RNN or similar model can learn the normal sequences of network and file activities for a user. It can then identify when a rare and suspicious sequence occurs, such as 'accessing sensitive files -> large outbound transfer to new domain -> mass file deletion'. This is more powerful than simple correlation because it understands the temporal relationship and context of the events as a cohesive narrative, allowing it to detect sophisticated attack chains with higher accuracy.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - EDR.FileModificationEvents
      - MDM.DHCPLeaseLogs
      - Our organization's internet gateway
      - Corporate-managed mobile devices
      - DNS resolvers
      - DHCP servers
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - technology: Machine Learning / Sequence Analysis Model
        query: INPUT event_stream (Zeek_logs, EDR_logs) | SCORE sequence_probability with RNN_model | ALERT if probability is low for sequence 'outbound_transfer -> file_deletion'