name: "T1636: Protected User Data"
id: "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
description: "This playbook helps answer the question: Is an adversary collecting protected user data from corporate mobile devices? It focuses on identifying threats by analyzing application permissions for anomalous or malicious signatures, monitoring for unusually large data exfiltration to suspicious network destinations, and detecting processes that access sensitive data stores before making unauthorized or first-seen network connections."
type: "technique"
related:
  - "TA0035: Collection"
contributors:
  - "Zachary Szewczyk, Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Is a known malicious application installed on any corporate mobile device?"
    context: "This question aims to identify known threats by cross-referencing installed applications against a mobile threat intelligence feed using identifiers like file hash, package name, and certificate hash. A match indicates a high-confidence compromise and an immediate threat to protected user data."
    answer_sources:
      - "MDM Application Inventory Export"
      - "Application Vetting Service Report"
      - "Mobile Threat Intelligence Feed"
      - "Mobile Device Management (MDM) platform"
      - "Corporate App Store"
      - "Application Vetting System"
      - "Corporate-managed mobile endpoints"
    range: "last 90 days"
    queries:
      - "FOR each app in MDM inventory, QUERY threat intel feed with app hash, package name, cert hash. IF match found, ALERT."
  - question: "Are any installed mobile applications requesting an anomalously high-risk set of permissions compared to their peers?"
    context: "This question seeks to uncover potentially malicious or over-privileged applications by statistically analyzing their requested permissions. Applications that request rare or unusual combinations of permissions for their category are flagged as suspicious, as this can be an indicator of data collection behavior not aligned with the app's purported function."
    answer_sources:
      - "MDM Application Inventory Export"
      - "Application Vetting Service Report"
      - "Mobile Threat Intelligence Feed"
      - "Mobile Device Management (MDM) platform"
      - "Corporate App Store"
      - "Application Vetting System"
      - "Corporate-managed mobile endpoints"
    range: "last 90 days"
    queries:
      - "FOR each app category, CALCULATE permission prevalence. FOR each app, CALCULATE anomaly score = sum(1/prevalence). IF score > 95th percentile for category, FLAG for review."
  - question: "Can a machine learning model identify and block potentially malicious applications based on their manifest files before or during installation?"
    context: "This question focuses on proactively identifying threats by using a supervised machine learning model (e.g., Random Forest). The model is trained on features from application manifests to classify new or updated apps as benign or malicious, preventing them from being installed on corporate devices if they are deemed a threat with high confidence."
    answer_sources:
      - "MDM Application Inventory Export"
      - "Application Vetting Service Report"
      - "Mobile Threat Intelligence Feed"
      - "Mobile Device Management (MDM) platform"
      - "Corporate App Store"
      - "Application Vetting System"
      - "Corporate-managed mobile endpoints"
    range: "last 90 days"
    queries:
      - "TRAIN classifier on labeled app manifests. DEPLOY model to score new apps. IF app is 'malicious' with confidence > 0.90, BLOCK and ALERT."
  - question: "Are any corporate mobile devices communicating with known malicious command-and-control or data exfiltration servers?"
    context: "This question aims to detect direct communication with known malicious infrastructure. By monitoring network traffic from mobile devices and comparing destination IPs and domains against threat intelligence feeds, we can identify high-confidence indicators of a compromise."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Threat Intelligence Feed"
      - "WHOIS Lookup Service"
      - "Network egress points"
      - "Corporate Wi-Fi access points"
      - "VPN concentrators"
      - "DNS resolvers"
    range: "last 90 days"
    queries:
      - "FROM mobile device network logs, JOIN with DNS logs. CHECK destination IP/domain against threat intel feed. IF match found, ALERT."
  - question: "Has any mobile device exfiltrated an anomalously large amount of data to a suspicious, newly-registered, or high-entropy domain?"
    context: "This question seeks to identify potential data exfiltration by detecting unusual spikes in outbound data volume from a device. The alert is enriched with context about the destination domain (age, entropy) to help distinguish between legitimate large transfers and suspicious activity indicative of data theft."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Threat Intelligence Feed"
      - "WHOIS Lookup Service"
      - "Network egress points"
      - "Corporate Wi-Fi access points"
      - "VPN concentrators"
      - "DNS resolvers"
    range: "last 90 days"
    queries:
      - "FOR each device, CREATE baseline of outbound data volume. IF connection volume > 3 standard deviations from mean, ALERT. ENRICH alert with domain age and entropy. IF domain age < 30 days AND entropy > 3.5, ESCALATE."
  - question: "Can a time-series machine learning model detect anomalous patterns in a mobile device's hourly outbound data volume?"
    context: "This question involves using a more advanced anomaly detection model (e.g., LSTM Autoencoder) to learn the normal 'rhythm' of a device's network traffic. The goal is to detect subtle deviations from this learned pattern that might indicate data exfiltration, and to correlate these anomalies with other indicators like DGA detection to improve accuracy."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Threat Intelligence Feed"
      - "WHOIS Lookup Service"
      - "Network egress points"
      - "Corporate Wi-Fi access points"
      - "VPN concentrators"
      - "DNS resolvers"
    range: "last 90 days"
    queries:
      - "TRAIN LSTM autoencoder on hourly outbound byte counts per device. IF reconstruction error > 99th percentile, GENERATE alert. CORRELATE with DGA detection alerts."
  - question: "Has a process on a mobile device accessed protected user data and then immediately made a network connection to an unapproved or known-malicious destination?"
    context: "This question focuses on correlating two distinct but related suspicious events: access to sensitive data (like contacts) followed closely by an outbound network connection. If the destination is not on a pre-defined allowlist for that application or is on a threat feed, it is a strong indicator of data theft."
    answer_sources:
      - "Mobile EDR API Monitoring Log"
      - "Mobile EDR Network Flow Log"
      - "Zeek conn.log"
      - "Application-to-Network Allowlist"
      - "Corporate-managed mobile endpoints"
      - "Network egress points"
    range: "last 90 days"
    queries:
      - "CORRELATE: EDR log shows protected data API access. WITHIN 10 seconds, same process makes network connection. IF destination is not on allowlist OR is on threat feed, ALERT."
  - question: "Has an application, after accessing protected data, connected to a network destination for the first time?"
    context: "This question aims to detect behavioral changes in applications. By baselining normal network activity for each app, we can flag when an app accesses sensitive data and then communicates with a 'first-seen' destination. This is particularly suspicious if the new destination is also newly registered or has characteristics of a DGA domain."
    answer_sources:
      - "Mobile EDR API Monitoring Log"
      - "Mobile EDR Network Flow Log"
      - "Zeek conn.log"
      - "Application-to-Network Allowlist"
      - "Corporate-managed mobile endpoints"
      - "Network egress points"
    range: "last 90 days"
    queries:
      - "FOR each app, BASELINE historical network destinations. IF (protected data access) THEN (within 10s, connection to 'first-seen' destination), ALERT. PRIORITIZE if destination is newly registered."
  - question: "Can a sequence-based machine learning model detect anomalous chains of events, such as protected data access followed by an unusual network connection?"
    context: "This question proposes a sophisticated detection method using sequence modeling (e.g., LSTMs, Transformers) to understand the 'grammar' of normal application behavior. An alert is triggered when an application executes a sequence of actions that deviates significantly from its learned benign patterns, indicating a potential compromise or malicious functionality."
    answer_sources:
      - "Mobile EDR API Monitoring Log"
      - "Mobile EDR Network Flow Log"
      - "Zeek conn.log"
      - "Application-to-Network Allowlist"
      - "Corporate-managed mobile endpoints"
      - "Network egress points"
    range: "last 90 days"
    queries:
      - "TRAIN sequence model on benign app event chains. SCORE new event sequences from monitored devices. IF (sequence with protected data access + unusual network connection) has high anomaly score, ALERT."