name: T1663: Remote Access Software
id: b0e9f2c1-d3a4-4b56-87c8-9a0b1c2d3e4f
description: This playbook helps investigate whether an adversary is leveraging legitimate remote access software for Command and Control on corporate mobile devices. It provides investigative questions and queries to detect this activity by identifying three key evidence patterns: 1) Network traffic from mobile devices matching Indicators of Compromise (IoCs) for unapproved remote access tools, correlated with device software inventories. 2) The use of standard remote access protocols (e.g., VNC, RDP) on non-standard ports, accompanied by behavioral anomalies like unusual connection durations or data volumes. 3) The presence of unsolicited inbound connections from external IP addresses to mobile devices, which constitutes a direct violation of 'default-deny' security policies and may indicate a backdoor.
type: technique
related:
  - TA0037: Command And Control
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are mobile devices making network connections to destinations associated with unapproved remote access software, and is that software installed on the device?
    context: This question aims to detect the most direct evidence of unauthorized remote access software usage. By correlating network traffic against a threat intelligence watchlist of known malicious domains/IPs and then verifying against the device's software inventory via UEM/MDM, we can confirm a policy violation with high confidence. A match indicates an active connection to a known C2 infrastructure using unapproved software.
    answer_sources:
      - Zeek dns.log
      - Zeek conn.log
      - Zeek ssl.log
      - UEM/MDM application inventory logs
      - Windows Event ID 5156
      - Network egress points (Internet gateway, VPN concentrators)
      - Corporate DNS resolvers
      - Forward web proxies (potentially Windows-based)
      - Unified Endpoint Management (UEM/MDM) platform API
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Search network logs (DNS, connection, SSL) for destination matching IoC watchlist. IF match from mobile IP, THEN query UEM/MDM API for device's installed apps. IF remote access app not in approved profile, THEN ALERT.
  - question: For connections to known unapproved remote access services, is the data volume or connection duration anomalously high compared to the user's historical baseline?
    context: This question helps identify suspicious usage patterns. An adversary might maintain a persistent connection or transfer large amounts of data, unlike a normal user. By baselining normal user activity over a 30-day period and alerting on deviations (e.g., exceeding the 95th or 99th percentile), we can detect potential C2 activity that might otherwise be lost in legitimate-looking traffic.
    answer_sources:
      - Zeek dns.log
      - Zeek conn.log
      - Zeek ssl.log
      - UEM/MDM application inventory logs
      - Windows Event ID 5156
      - Network egress points (Internet gateway, VPN concentrators)
      - Corporate DNS resolvers
      - Forward web proxies (potentially Windows-based)
      - Unified Endpoint Management (UEM/MDM) platform API
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR each connection from mobile IP to IoC watchlist destination, CALCULATE 30-day baseline for data volume & duration for that user/service. IF current volume/duration > 95th percentile of baseline, THEN ALERT.
  - question: Can a machine learning model classify network connections from mobile devices as malicious remote access activity with high confidence?
    context: This question moves beyond simple rules to a more sophisticated, model-driven detection approach. By training a classifier on rich network features (protocol, duration, bytes, etc.) and enrichment data (IoC match, approved software status), we can identify complex patterns indicative of malicious behavior that static rules might miss. A high-confidence prediction from the model can serve as a trigger for automated response, such as quarantining the device.
    answer_sources:
      - Zeek dns.log
      - Zeek conn.log
      - Zeek ssl.log
      - UEM/MDM application inventory logs
      - Windows Event ID 5156
      - Network egress points (Internet gateway, VPN concentrators)
      - Corporate DNS resolvers
      - Forward web proxies (potentially Windows-based)
      - Unified Endpoint Management (UEM/MDM) platform API
    range: last 90 days
    queries:
      - technology: pseudocode
        query: INPUT Zeek conn.log features (protocol, port, duration, bytes, state) + enrichment (IoC match, UEM/MDM approved app flag). APPLY pre-trained classification model. IF prediction is 'malicious-remote-access' AND confidence > 0.90, THEN trigger automated response.
  - question: Are mobile devices using standard remote access protocols (like VNC, RDP) on non-standard ports, potentially indicating evasion?
    context: Adversaries often run services on non-standard ports to evade simple port-based firewall rules and detection. This question seeks to identify such activity by using dynamic protocol detection (DPD) to identify the true protocol of a connection, regardless of the port. An alert is triggered when a known remote access protocol is found running on an unexpected port, with severity increased if other suspicious indicators (like a long-lived connection) are also present.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek dpd.log
      - Network TAPs or SPAN ports on Wi-Fi access point uplinks
      - Core network switches segmenting mobile device traffic
      - Network gateways
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH for Zeek logs where (dpd.log OR conn.log) shows service IN ('vnc', 'rdp', 'teamviewer') AND destination_port is NOT the standard port for that service. IF Zeek notice.log shows 'Long_Connection' for same UID, THEN increase alert severity.
  - question: Are there any mobile device connections exhibiting anomalously high interactivity and duration, or is a device suddenly contacting an unusually diverse range of destination ports?
    context: This question focuses on behavioral anomalies. The 'interactivity ratio' (packets to bytes) helps distinguish 'chatty' interactive sessions (like remote control) from bulk data transfers. When combined with a long duration, it is a strong indicator of a C2 channel. Separately, a sudden increase in the variety of ports being contacted (measured by Shannon entropy) can signal scanning or reconnaissance activity.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek dpd.log
      - Network TAPs or SPAN ports on Wi-Fi access point uplinks
      - Core network switches segmenting mobile device traffic
      - Network gateways
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR each mobile TCP connection, CALCULATE interactivity_ratio and duration. IF both > 98th percentile of device's 30-day baseline, THEN ALERT. SEPARATELY, CALCULATE Shannon entropy of destination ports per device over 1-hour window. IF entropy > 2 std dev above baseline, THEN ALERT.
  - question: Does a mobile device's overall network activity pattern significantly deviate from its own established historical baseline, as identified by a time-series anomaly detection model?
    context: This question uses an unsupervised machine learning model (like an LSTM autoencoder) to create a sophisticated, individualized baseline of normal network behavior for each device. The model learns what 'normal' looks like based on features like data volume, packet counts, and connection rates. An alert is triggered when the device's current behavior is so different from its past that the model cannot 'reconstruct' it accurately, indicating a significant and potentially malicious deviation.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek dpd.log
      - Network TAPs or SPAN ports on Wi-Fi access point uplinks
      - Core network switches segmenting mobile device traffic
      - Network gateways
    range: last 90 days
    queries:
      - technology: pseudocode
        query: INPUT time-series vectors of aggregated network telemetry per device. APPLY pre-trained LSTM autoencoder. IF reconstruction_error > dynamic_threshold, THEN ALERT as behavioral anomaly.
  - question: Has any mobile device accepted an unsolicited inbound connection from an external, non-internal IP address?
    context: This question enforces a fundamental security principle that mobile devices should not accept unsolicited connections from the public internet. Any successful inbound connection from an external source to a mobile device is a direct violation of a 'default-deny' firewall policy and represents a potential security breach. Such an event should be treated as a critical-priority incident, as it could indicate a successful connection to a backdoor.
    answer_sources:
      - Zeek conn.log
      - Zeek known_services.log
      - Firewall accept/deny logs
      - Perimeter firewall appliances
      - Network sensors at the internet gateway
      - Wi-Fi controllers
      - Mobile VPN concentrators
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH firewall or Zeek conn logs for successful connections WHERE source_ip is EXTERNAL (not RFC1918) AND destination_ip is in MOBILE_DEVICE_RANGE. IF found, THEN trigger CRITICAL alert.
  - question: Are any mobile devices listening on rare or non-standard ports not seen on peer devices?
    context: A malicious implant will often open a listening port to await commands. While some apps open legitimate ports, a malicious one might open a port that is not commonly used across the device fleet. This question aims to identify these outliers. By inventorying all listening services and flagging those that are statistically rare (e.g., running on <1% of devices) and not on an approved list, we can proactively hunt for potential backdoors.
    answer_sources:
      - Zeek conn.log
      - Zeek known_services.log
      - Firewall accept/deny logs
      - Perimeter firewall appliances
      - Network sensors at the internet gateway
      - Wi-Fi controllers
      - Mobile VPN concentrators
    range: last 90 days
    queries:
      - technology: pseudocode
        query: DAILY, query Zeek known_services.log to get all listening ports on mobile devices. CALCULATE prevalence of each port across the fleet. FOR each device, IF it is listening on a port with prevalence < 1% AND port is not on approved list, THEN ALERT.
  - question: Are there any mobile devices whose inbound connection profile makes them a statistical outlier compared to their peers?
    context: This question uses peer group analysis to find anomalous devices by comparing a device to its peers rather than its own history. By creating a feature vector for each device (e.g., listening ports, inbound/outbound connection ratio) and applying a clustering algorithm like DBSCAN, we can group devices with similar behavior. Devices that do not fit into any cluster are flagged as outliers and warrant investigation for potential compromise.
    answer_sources:
      - Zeek conn.log
      - Zeek known_services.log
      - Firewall accept/deny logs
      - Perimeter firewall appliances
      - Network sensors at the internet gateway
      - Wi-Fi controllers
      - Mobile VPN concentrators
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR each device, create feature vector from 24-hour inbound connection profile (listening ports, in/out ratio, unique external sources). APPLY DBSCAN/HDBSCAN clustering algorithm to all device vectors. IF a device is classified as a noise point (outlier), THEN ALERT.