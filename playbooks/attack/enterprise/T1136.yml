name: T1136: Create Account
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: |
  This playbook helps investigate whether an adversary has established persistence by creating unauthorized accounts on the enterprise network. It focuses on detecting newly created accounts that exhibit suspicious characteristics, such as usernames matching known-bad indicators or suspicious patterns; creation by an anomalous parent process (e.g., a web server spawning 'net.exe'); immediate post-creation privilege escalation to administrative groups; usernames with unusual statistical properties like high entropy or similarity to existing privileged accounts (typosquatting); and immediate post-creation activity like interactive logons or anomalous network traffic.
type: technique
related:
  - TA0003: Persistence
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has a new user account been created with a username that matches a known malicious indicator or a suspicious naming convention?
    context: |
      Adversaries often use predictable usernames from their toolkits or create names that mimic legitimate system or service accounts. This detection method leverages threat intelligence and regular expressions to identify these suspicious naming conventions (e.g., 'test', 'backup', 'svc-...') in account creation events (Windows Event ID 4720), providing a high-fidelity signal of potential compromise.
    answer_sources:
      - Windows Event ID 4720
      - Threat Intelligence Feed
      - Domain Controllers
      - Member Servers
      - Administrator Workstations
      - SIEM/Data Lake
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH logs WHERE event_id=4720 AND (target_username IN threat_intel_feed OR target_username MATCHES suspicious_regex_patterns)
  - question: Is there a statistically significant spike in the rate of user account creations?
    context: |
      A sudden increase in the number of account creations can indicate automated activity by an adversary, such as preparation for a ransomware or wiper attack where multiple accounts are created for redundancy or to deploy payloads. By baselining the normal rate of account creation and alerting on deviations (e.g., >3 standard deviations), security teams can detect these mass creation events early.
    answer_sources:
      - Windows Event ID 4720
      - Threat Intelligence Feed
      - Domain Controllers
      - Member Servers
      - Administrator Workstations
      - SIEM/Data Lake
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          CALCULATE hourly_creation_rate from event_id=4720. COMPARE rate to 30-day_baseline. ALERT if rate > (baseline_avg + 3 * baseline_stddev)
  - question: Does a new account creation event exhibit characteristics that a machine learning model identifies as malicious?
    context: |
      Legitimate account creations often follow predictable patterns related to the creator's role, time of day, and the structure of the new username. A machine learning classifier can be trained on historical data to learn these patterns. New events that deviate significantly—such as an account created by a non-admin user late at night with a random-looking username—can be scored and flagged as potentially malicious in real-time.
    answer_sources:
      - Windows Event ID 4720
      - Threat Intelligence Feed
      - Domain Controllers
      - Member Servers
      - Administrator Workstations
      - SIEM/Data Lake
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SCORE new_account_creation_event (event_id=4720) using trained_model. FEATURES include creator_role, time_of_day, username_characteristics. ALERT if score > malicious_threshold
  - question: Was a new user account created by a suspicious parent process, such as a web server or office application?
    context: |
      Legitimate account creation is typically performed by administrators through specific management tools. When processes like web servers ('w3wp.exe') or Microsoft Office applications ('WINWORD.EXE') spawn command-line utilities ('net.exe', 'powershell.exe') to create users, it is a strong indicator of compromise, often resulting from a web shell or a malicious macro. This question focuses on identifying these illegitimate process execution chains.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4720
      - Windows Event ID 4722
      - Domain Controllers
      - Web Servers
      - User Endpoints
      - Application Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH logs WHERE event_id=4688 AND process_name IN ('net.exe', 'powershell.exe') AND command_line CONTAINS ('/add', 'New-LocalUser') AND parent_process_name IN ('w3wp.exe', 'WINWORD.EXE')
  - question: Has an account creation utility been executed by a statistically rare parent process?
    context: |
      Over time, a baseline of normal parent-child process relationships can be established for the entire environment. For example, 'explorer.exe' might frequently be the parent of 'cmd.exe'. This question aims to identify highly unusual execution chains by calculating the frequency of the parent process for any account creation utility. An alert is generated when a rare parent is observed, suggesting an anomalous and potentially malicious action.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4720
      - Windows Event ID 4722
      - Domain Controllers
      - Web Servers
      - User Endpoints
      - Application Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each process_creation (event_id=4688) related to user_creation: CALCULATE frequency of parent_process. ALERT if frequency < 1st_percentile
  - question: Does the sequence of process creations leading to a new account deviate from learned normal patterns?
    context: |
      Legitimate administrative actions often follow a predictable sequence of process executions. A sequence anomaly detection model can learn this 'grammar' of normal operations. This question uses such a model to detect when an adversary deviates from the norm, for example, by using a web shell to spawn a command prompt which then runs PowerShell to create a user. This abnormal sequence is a high-confidence indicator of post-exploitation activity.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4720
      - Windows Event ID 4722
      - Domain Controllers
      - Web Servers
      - User Endpoints
      - Application Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL process_creation_sequences (event_id=4688) leading to user_creation. ANALYZE new sequences. ALERT if sequence deviates significantly from learned_normal_patterns
  - question: Was a newly created user account immediately added to a high-privilege administrative group?
    context: |
      Adversaries often create a new account and then immediately add it to a privileged group like 'Domain Admins' or 'Administrators' to ensure persistent, elevated access. This question focuses on correlating an account creation event (4720) with a subsequent group membership change event (4728, 4732, 4756) occurring within a short time window (e.g., 10 minutes). This behavior is highly suspicious, especially if it occurs outside of a change management window or is performed by an unauthorized user.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4728
      - Windows Event ID 4732
      - Windows Event ID 4756
      - Domain Controllers
      - Active Directory Federation Services (ADFS)
      - IT Service Management (ITSM) Platform
      - Human Resources Systems
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          CORRELATE event_id=4720 with event_id IN (4728, 4732, 4756) on target_username within 10 minutes. ALERT if the new user is added to a privileged_group
  - question: Did an administrator create an account and modify its privileges at a statistically unusual time for that specific admin?
    context: |
      Every administrator has their own work patterns and habits. By profiling the typical days and times each admin performs sensitive tasks like account creation, we can establish a behavioral baseline. This question aims to detect when an admin's account is used to create and elevate a new user at a time that is highly abnormal for that specific individual (e.g., 3 AM on a Sunday), which could indicate that the admin's credentials have been compromised.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4728
      - Windows Event ID 4732
      - Windows Event ID 4756
      - Domain Controllers
      - Active Directory Federation Services (ADFS)
      - IT Service Management (ITSM) Platform
      - Human Resources Systems
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each admin-driven user_creation/privilege_modification event: CALCULATE z-score of event_time based on that admin's historical activity. ALERT if z-score > 3
  - question: Was a new user account created and provisioned without a corresponding authorization event in an upstream system like HR or ITSM?
    context: |
      In mature environments, user provisioning follows a strict workflow: an HR action triggers an ITSM ticket, which, upon approval, leads to account creation in Active Directory. This question uses a sequence analysis model to learn this legitimate chain of events. By monitoring for account creations or privilege escalations that lack a preceding, approved ticket, the model can identify policy violations and potentially malicious out-of-band activity.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4728
      - Windows Event ID 4732
      - Windows Event ID 4756
      - Domain Controllers
      - Active Directory Federation Services (ADFS)
      - IT Service Management (ITSM) Platform
      - Human Resources Systems
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL legitimate user_provisioning_sequence (HR -> ITSM -> AD). SEARCH for AD account creations (4720) or privilege changes (4728) that are missing a corresponding authorized event in the sequence. ALERT on these orphans.
  - question: Was a new user account created with a username that does not conform to the established corporate naming standard?
    context: |
      Most organizations enforce a standard format for usernames (e.g., 'firstname.lastname'). This question involves creating a regular expression that defines this standard. By checking every new account creation event (4720) against this regex, any username that fails to match the pattern can be immediately flagged for review. This is a simple yet effective way to catch typos, non-standard service accounts, or adversary-created accounts.
    answer_sources:
      - Windows Event ID 4720
      - Active Directory User Object Export
      - Domain Controllers
      - Member Servers
      - SIEM/Data Lake
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH logs WHERE event_id=4720 AND target_username DOES NOT MATCH (corporate_username_regex)
  - question: Was a new user account created with a username that has unusually high randomness or is very similar to an existing privileged account name?
    context: |
      Adversaries may use algorithmically generated account names (which have high character entropy) or attempt to 'typosquat' by creating a name that is visually similar to a real administrator's account (e.g., 'j.smith' vs. 'j.sm1th'). This question uses statistical measures to detect both cases. It calculates the Shannon entropy of a new username to spot randomness and the Levenshtein distance to existing privileged accounts to spot typosquatting.
    answer_sources:
      - Windows Event ID 4720
      - Active Directory User Object Export
      - Domain Controllers
      - Member Servers
      - SIEM/Data Lake
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each new username (event_id=4720): CALCULATE shannon_entropy. ALERT if entropy > 99th_percentile. CALCULATE levenshtein_distance to all privileged_usernames. ALERT if distance <= 2.
  - question: Does a machine learning model classify a new username as an outlier compared to all existing legitimate usernames?
    context: |
      This approach uses unsupervised machine learning models like a one-class SVM or an autoencoder to learn the fundamental structure and patterns of all existing, legitimate usernames in an organization. When a new account is created, its username is fed to the model. If the model determines the new name is a significant outlier or has a high reconstruction error, it suggests the name was not generated by a human following normal conventions and could be algorithmically generated by an adversary.
    answer_sources:
      - Windows Event ID 4720
      - Active Directory User Object Export
      - Domain Controllers
      - Member Servers
      - SIEM/Data Lake
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN one-class_SVM or autoencoder on character n-grams of all existing usernames. FOR each new username (event_id=4720): PREDICT if outlier. ALERT if true.
  - question: Did a newly created account immediately perform an interactive or remote interactive logon?
    context: |
      When an adversary creates an account for persistence, they will often use it immediately to establish an interactive session. This question focuses on a simple, high-fidelity correlation: an account creation event (4720) followed within minutes by a logon event (4624) from that same account, especially a remote logon (Type 10). This sequence strongly suggests the account was created for immediate, active use by an attacker.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek dns.log
      - Domain Controllers
      - User Endpoints
      - Network Egress Points
      - DNS Resolvers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          CORRELATE event_id=4720 with event_id=4624 on target_username within 15 minutes. ALERT if logon_type is 2 (Interactive) or 10 (RemoteInteractive).
  - question: Did a newly created account immediately generate anomalous network traffic, such as a spike in volume, connections to rare ports, or high-entropy DNS requests?
    context: |
      After creating an account, an adversary may use it to exfiltrate data, download further tools, or establish command and control. This activity often manifests as anomalous network traffic. This question looks for statistical deviations in network behavior from the new account's host shortly after creation, including unusual traffic volume, connections to non-standard ports, or a sudden increase in the randomness of DNS queries, which can indicate the use of a Domain Generation Algorithm (DGA).
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek dns.log
      - Domain Controllers
      - User Endpoints
      - Network Egress Points
      - DNS Resolvers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          AFTER event_id=4720, monitor host network traffic. ALERT if traffic_volume spikes, destination_port is rare for host, or DNS_query_entropy increases significantly.
  - question: Does a graph-based anomaly detection model identify the creation and immediate activity of a new user as a suspicious subgraph?
    context: |
      This advanced technique models the enterprise environment as a graph of interconnected entities (users, hosts, IPs). Legitimate activity forms predictable patterns within this graph. This question uses a model to search for the sudden appearance of a new user node that immediately forms unusual connections, such as logging into a sensitive server and connecting to a rare external IP address. Such a subgraph pattern is a strong indicator of malicious behavior.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek dns.log
      - Domain Controllers
      - User Endpoints
      - Network Egress Points
      - DNS Resolvers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL entity relationships as a graph. SEARCH for subgraph patterns where a 'new_user' node is created and immediately connects to unusual or high-risk nodes (e.g., external IPs, sensitive servers).