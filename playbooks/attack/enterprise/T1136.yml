name: "T1136: Create Account"
id: "2d8c3f68-7b9c-4f8a-9a0b-1c2d3e4f5a6b"
description: "This playbook helps investigate whether an adversary has established persistence by creating unauthorized local or domain accounts. It focuses on detecting suspicious account creation events by analyzing usernames for matches against threat intelligence or anomalous patterns; identifying creations originating from unusual parent processes like web servers or productivity applications; correlating account creation with immediate privilege escalation; flagging usernames with statistical anomalies like high randomness or similarity to privileged accounts; and detecting immediate logon or network activity from a newly created account."
type: "technique"
related:
  - "TA0003: Persistence"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Has a new user account been created with a username that matches known malicious indicators or suspicious naming conventions?"
    context: "Adversaries often use specific, recognizable usernames for accounts created by their tools, or they may use names that mimic system or service accounts to blend in. This question aims to detect these by checking new usernames against a watchlist derived from threat intelligence feeds and regular expressions designed to catch suspicious formats (e.g., '.*admin.*', 'test', 'svc-.*'). A match provides a high-confidence indicator of malicious activity."
    answer_sources:
      - "Windows Event ID 4720"
      - "Threat Intelligence Feed"
      - "Domain Controllers, Member Servers, Administrator Workstations, SIEM/Data Lake"
    range: "last 90 days"
    queries:
      - "Search for account creation events (Event ID 4720) where the target username matches a watchlist of known-bad usernames or a regex for suspicious patterns."
  - question: "Is there a statistically significant spike in the rate of user account creations, suggesting a mass creation event?"
    context: "Certain attack types, such as ransomware or wiper campaigns, may involve the rapid creation of numerous accounts to ensure persistence or distribute malicious payloads. This question aims to detect such anomalies by establishing a baseline for normal account creation rates and then alerting when the current rate significantly exceeds this baseline (e.g., more than three standard deviations above the average). This can be an early indicator of a large-scale automated attack."
    answer_sources:
      - "Windows Event ID 4720"
      - "Domain Controllers, Member Servers, Administrator Workstations, SIEM/Data Lake"
    range: "last 90 days"
    queries:
      - "Calculate the hourly count of account creation events (Event ID 4720). Compare this count against a pre-computed baseline (e.g., 30-day moving average). Alert if the current count exceeds the baseline by a defined threshold (e.g., 3 standard deviations)."
  - question: "Does a newly created user account exhibit characteristics that a machine learning model, trained on historical data, identifies as suspicious?"
    context: "This question leverages a supervised machine learning model to perform a more nuanced detection of malicious account creations. The model is trained on features from past events, such as the creator's role, time of day, and username characteristics (length, character types). It learns the complex, subtle patterns that differentiate legitimate from malicious activity, allowing it to score new events and flag those that have a high probability of being malicious, even if they do not trigger simple rules."
    answer_sources:
      - "Windows Event ID 4720"
      - "Domain Controllers, Member Servers, Administrator Workstations, SIEM/Data Lake"
    range: "last 90 days"
    queries:
      - "For each new account creation event (Event ID 4720), extract features (e.g., creator, time, username length, character types). Input features into a pre-trained classification model and alert if the output score exceeds a 'suspicious' threshold."
  - question: "Was a user account created by a suspicious parent process, such as a web server or a user productivity application?"
    context: "Legitimate account creation is typically performed by system administrators using specific administrative consoles or scripts. When a non-standard process, like a web server ('w3wp.exe') or a Microsoft Office application ('WINWORD.EXE'), spawns a command-line utility ('net.exe', 'powershell.exe') to create a user, it is a strong indicator of compromise. This often points to an adversary leveraging a web shell or a malicious document macro to establish persistence."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows Event ID 4720"
      - "Windows Event ID 4722"
      - "Domain Controllers, Web Servers, User Endpoints, Application Servers"
    range: "last 90 days"
    queries:
      - "Search for process creation events (Event ID 4688) for account management tools ('net.exe', 'powershell.exe', etc.) with command-line arguments for user creation. Alert if the parent process is on a watchlist of anomalous parents (e.g., 'w3wp.exe', 'WINWORD.EXE')."
  - question: "Has a user account been created via a statistically rare parent-child process relationship?"
    context: "By analyzing historical process creation logs (Event ID 4688), we can build a profile of which parent processes normally launch account management utilities. This question aims to identify when an account is created via an execution chain that is statistically improbable in the environment (e.g., a process that has never before spawned 'net.exe'). This indicates a highly unusual execution chain that may be an attempt to evade defenses."
    answer_sources:
      - "Windows Event ID 4688"
      - "Domain Controllers, Web Servers, User Endpoints, Application Servers"
    range: "last 90 days"
    queries:
      - "For each process creation event involving an account management tool, look up the historical frequency of its parent process. Alert if the observed parent-child pair falls below a rarity threshold (e.g., <1st percentile)."
  - question: "Did the sequence of process executions leading to an account creation deviate from learned normal patterns?"
    context: "This question applies sequence analysis to model the 'grammar' of legitimate process chains that lead to account creation. It is designed to detect sophisticated attacks where an adversary uses a novel or complex series of process executions to create an account. By learning the normal sequences, the model can flag any new sequence that significantly deviates, indicating a high-confidence anomaly potentially linked to post-exploitation activity."
    answer_sources:
      - "Windows Event ID 4688"
      - "Domain Controllers, Web Servers, User Endpoints, Application Servers"
    range: "last 90 days"
    queries:
      - "Model sequences of process creation events (Event ID 4688) leading to account creation. Feed new sequences into an anomaly detection model and alert if the sequence is flagged as a deviation from the learned normal behavior."
  - question: "Was a new account created and immediately added to a high-privilege group, especially by an unauthorized user or outside a change window?"
    context: "A common and effective adversary tactic is to create a new account and then immediately add it to a powerful administrative group like 'Domain Admins' or 'Administrators'. This two-step process provides persistent, privileged access. This question seeks to detect this high-confidence pattern by correlating account creation events (4720) with subsequent group membership changes (4728, 4732) that occur within a short time frame."
    answer_sources:
      - "Windows Event ID 4720"
      - "Windows Event ID 4728"
      - "Windows Event ID 4732"
      - "Windows Event ID 4756"
      - "Domain Controllers, Active Directory Federation Services (ADFS), IT Service Management (ITSM) Platform, Human Resources Systems"
    range: "last 90 days"
    queries:
      - "Correlate account creation events (Event ID 4720) with group addition events (Event ID 4728, 4732, 4756) for the same user occurring within a short time frame (e.g., 10 minutes). Alert if the new user is added to a privileged group."
  - question: "Did an administrator create an account and modify its privileges at a time that is statistically unusual for that specific administrator?"
    context: "Even legitimate administrator accounts can be compromised. This question aims to detect such a compromise by baselining the activity patterns (e.g., typical working hours) for each individual administrator. An administrative action like creating an account or adding it to a privileged group that occurs at a highly anomalous time for that specific admin (e.g., 3 AM on a weekend) could indicate that their credentials are being used by an adversary."
    answer_sources:
      - "Windows Event ID 4720"
      - "Windows Event ID 4728"
      - "Windows Event ID 4732"
      - "Windows Event ID 4756"
      - "Domain Controllers, Active Directory Federation Services (ADFS), IT Service Management (ITSM) Platform, Human Resources Systems"
    range: "last 90 days"
    queries:
      - "For each account creation/privilege modification event, calculate a z-score for the event's timestamp based on the performing administrator's historical activity profile. Alert if the z-score exceeds a set threshold."
  - question: "Was a new user provisioned and granted privileges without a corresponding, preceding authorization event in the HR or ITSM systems?"
    context: "In a mature IT environment, user provisioning follows a strict, auditable workflow, often starting with an HR or IT Service Management (ITSM) ticket. This question aims to enforce that chain of custody by correlating Active Directory events with data from these upstream systems. An account creation and privilege escalation that lacks a corresponding, approved authorization ticket is a significant policy violation and a potential security incident."
    answer_sources:
      - "Windows Event ID 4720"
      - "Windows Event ID 4728"
      - "Windows Event ID 4732"
      - "Windows Event ID 4756"
      - "Domain Controllers, Active Directory Federation Services (ADFS), IT Service Management (ITSM) Platform, Human Resources Systems"
    range: "last 90 days"
    queries:
      - "Correlate events from HR, ITSM, and Active Directory systems. For each new privileged account, verify that a corresponding, approved authorization ticket/event exists. Alert if the authorization event is missing."
  - question: "Was a new user account created with a username that does not conform to the established corporate naming standard?"
    context: "Most organizations enforce a standard username format (e.g., 'firstname.lastname'). An account created with a name that violates this format is an immediate policy violation and a potential indicator of compromise. This could be a default name from an attack tool or an adversary's attempt to create an account that is not easily attributable."
    answer_sources:
      - "Windows Event ID 4720"
      - "Active Directory User Object Export"
      - "Domain Controllers, Member Servers, SIEM/Data Lake"
    range: "last 90 days"
    queries:
      - "For each account creation event (Event ID 4720), test the 'TargetUserName' against a regular expression that defines the valid corporate username format. Alert on any non-matches."
  - question: "Does a new username have statistical properties, such as high randomness or close similarity to a privileged account name, that suggest it is malicious?"
    context: "This question looks for two distinct malicious naming patterns. First, high character entropy (randomness) can indicate an algorithmically generated username, common with certain malware. Second, a low Levenshtein distance (i.e., a difference of one or two characters) to an existing privileged account's name suggests a 'typosquatting' attack, designed to fool analysts or users into misidentifying the account."
    answer_sources:
      - "Windows Event ID 4720"
      - "Active Directory User Object Export"
      - "Domain Controllers, Member Servers, SIEM/Data Lake"
    range: "last 90 days"
    queries:
      - "For each new username, calculate its character entropy and its Levenshtein distance to all privileged account names. Alert if entropy is in the top percentile or if the distance is 1 or 2."
  - question: "Does a machine learning model, trained on the structure of all legitimate usernames, flag a new username as an outlier?"
    context: "This question uses unsupervised machine learning (e.g., a one-class SVM or an autoencoder) to learn the 'normal' structure and character patterns of all existing legitimate usernames. This allows the model to identify new usernames that are statistical outliers, even if they don't match a specific known-bad pattern. This is effective for detecting novel, algorithmically generated usernames that might evade simpler rule-based or statistical checks."
    answer_sources:
      - "Windows Event ID 4720"
      - "Active Directory User Object Export"
      - "Domain Controllers, Member Servers, SIEM/Data Lake"
    range: "last 90 days"
    queries:
      - "Feed the character n-grams of each new username into a pre-trained outlier detection model (e.g., one-class SVM, autoencoder). Alert if the model flags the username as an anomaly."
  - question: "Was a newly created account used for an interactive logon almost immediately after its creation?"
    context: "Legitimate new user accounts often have a natural delay between creation and first use. In contrast, an adversary who creates an account for persistence will often use it immediately to test access or continue their attack. This question aims to detect this suspicious 'create and use' behavior by correlating an account creation event with a subsequent interactive or remote logon event from that same account within a very short time window."
    answer_sources:
      - "Windows Event ID 4720"
      - "Windows Event ID 4624"
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Domain Controllers, User Endpoints, Network Egress Points, DNS Resolvers"
    range: "last 90 days"
    queries:
      - "Correlate account creation events (Event ID 4720) with subsequent logon events (Event ID 4624, Logon Type 2 or 10) for the same username within a short time window (e.g., 15 minutes)."
  - question: "Did a newly created account immediately begin to generate anomalous outbound network traffic or DNS requests?"
    context: "After creating a new account, an adversary may use it to establish a command and control (C2) channel or exfiltrate data. This question looks for the network-level indicators of such activity. This includes statistical anomalies like a sudden spike in outbound traffic, connections to rare ports, or a high entropy in requested domain names, which can be indicative of Domain Generation Algorithm (DGA) malware."
    answer_sources:
      - "Windows Event ID 4720"
      - "Windows Event ID 4624"
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Domain Controllers, User Endpoints, Network Egress Points, DNS Resolvers"
    range: "last 90 days"
    queries:
      - "After an account creation event (Event ID 4720), monitor network and DNS logs for the new user. Compare outbound traffic volume, destination ports, and DNS query entropy against baselines. Alert on significant deviations."
  - question: "Does the immediate activity of a new user account form an anomalous pattern in a graph of user, host, and network relationships?"
    context: "This question uses graph-based analytics to place the creation of a new user account into the broader context of entity relationships. By modeling users, hosts, and network destinations as a graph, we can detect the emergence of anomalous subgraphs, such as a newly created user node that immediately forms connections to unusual external IP addresses or behaves in a way that is inconsistent with its peer group of similar users."
    answer_sources:
      - "Windows Event ID 4720"
      - "Windows Event ID 4624"
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Domain Controllers, User Endpoints, Network Egress Points, DNS Resolvers"
    range: "last 90 days"
    queries:
      - "Construct a graph of users, hosts, and destinations. Search for newly created user nodes that immediately form connections to external nodes or exhibit behavior patterns that are anomalous compared to their peer group."