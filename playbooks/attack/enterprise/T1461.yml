name: T1461: Lockscreen Bypass
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: >-
  This playbook helps investigate if an adversary has bypassed a mobile device's lockscreen to gain initial access to the corporate network.
  Detection focuses on identifying patterns like brute-force login attempts followed by a success from a mobile IP, anomalous network traffic (e.g., accessing unusual internal servers, DGA-like DNS queries, large data exfiltration), or successful logins from a device that has recently failed a critical compliance check (e.g., being jailbroken or rooted).
  The goal is to correlate authentication, network, and mobile device management (MDM/UEM) data to identify compromised mobile devices being used as an entry point.
type: technique
related:
  - TA0027: Initial Access
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has a brute-force login attempt from a mobile device succeeded?
    context: >-
      This question aims to detect a classic brute-force pattern where an attacker repeatedly tries passwords and eventually succeeds. By correlating a high number of failed logins (Windows Event ID 4625) with a subsequent successful login (Windows Event ID 4624) from the same IP address, we can identify a potential lockscreen bypass. Confirming the source IP belongs to a mobile device via MDM/UEM or VPN logs is crucial to scope the threat to mobile-based initial access.
    answer_sources: >-
      Windows Event ID 4625, Windows Event ID 4624, Zeek conn.log, MDM/UEM logs, VPN logs, IdP logs. Data is sourced from Authentication Servers (e.g., Active Directory Domain Controllers), VPN Concentrators, Cloud Identity Providers (e.g., Azure AD, Okta), Internet Gateway, MDM/UEM solution logs.
    range: Last 90 days
    queries:
      - pseudocode: SEARCH for > 4 failed logins (EventID 4625) from same IP and User within 10 mins. IF a successful login (EventID 4624) from same IP and User occurs within 5 mins, THEN CHECK MDM/VPN logs to confirm IP is mobile. IF mobile, ALERT.
  - question: Is the successful login following a brute-force attempt anomalous for the user?
    context: >-
      After identifying a potential brute-force success, this question seeks to add contextual evidence by profiling the user's normal behavior. A login occurring at an unusual time, from a new country, or from a new network (ASN) strongly suggests the activity is not legitimate. This helps prioritize alerts by separating potentially compromised accounts from legitimate but unusual user activity (e.g., traveling).
    answer_sources: >-
      Windows Event ID 4625, Windows Event ID 4624, Zeek conn.log, MDM/UEM logs, VPN logs, IdP logs. Data is sourced from Authentication Servers (e.g., Active Directory Domain Controllers), VPN Concentrators, Cloud Identity Providers (e.g., Azure AD, Okta), Internet Gateway, MDM/UEM solution logs.
    range: Last 90 days
    queries:
      - pseudocode: FOR each alert, GET source IP geolocation and ASN from Zeek conn.log. GET user's 90-day baseline for login hour, country, ASN. IF login hour is anomalous AND (country is new OR ASN is new), THEN ESCALATE alert severity.
  - question: Does an advanced anomaly detection model classify the successful login as highly suspicious?
    context: >-
      This question applies machine learning to provide a more sophisticated and automated verdict on the suspicious login. By training a model (like Isolation Forest) on a user's historical login patterns (including time, location, device OS), it can learn what is "normal" for that specific user. Events that the model flags as highly anomalous provide strong, data-driven evidence of a potential compromise, justifying an automated response like forcing re-authentication.
    answer_sources: >-
      Windows Event ID 4625, Windows Event ID 4624, Zeek conn.log, MDM/UEM logs, VPN logs, IdP logs. Data is sourced from Authentication Servers (e.g., Active Directory Domain Controllers), VPN Concentrators, Cloud Identity Providers (e.g., Azure AD, Okta), Internet Gateway, MDM/UEM solution logs.
    range: Last 90 days
    queries:
      - pseudocode: INPUT successful login event (hour, day, ASN, country, device OS) into user-specific anomaly model (e.g., Isolation Forest). IF anomaly score is in top 1% for that user, THEN CLASSIFY as 'Highly Suspicious' and INITIATE automated response (e.g., MFA re-auth).
  - question: Is a compromised mobile device accessing restricted internal assets or using insecure protocols?
    context: >-
      This question focuses on post-access behavior. Once an attacker is on the network via a mobile device, they may attempt to move laterally or connect to sensitive systems. This query looks for connections from mobile device IPs to high-value assets (defined in a watchlist) or the use of self-signed TLS certificates, which can be an indicator of man-in-the-middle attacks or malicious C2 channels.
    answer_sources: >-
      Zeek conn.log, Zeek dns.log, Zeek http.log, Zeek files.log, Zeek ssl.log, MDM/UEM logs, VPN logs. Data is sourced from Internal network segments (especially those housing sensitive data like developer environments or financial systems), Corporate Wi-Fi access points, VPN termination points, DNS resolvers, Egress points to the internet.
    range: Last 90 days
    queries:
      - pseudocode: JOIN VPN/MDM logs with Zeek logs. IF mobile IP connects to IP on 'Restricted Assets' watchlist OR uses TLS cert with 'validation_status' as 'self_signed', THEN ALERT. SUPPRESS if user is in pre-authorized group for the asset.
  - question: Is the network activity from a mobile device statistically anomalous compared to its own baseline?
    context: >-
      This question uses behavioral baselining to detect subtle indicators of compromise. Attackers often use techniques that deviate from normal user or device behavior. This query checks for three specific anomalies: DGA-like DNS queries (high entropy), unusually large data exfiltration, and the use of a non-standard User-Agent string. Each of these can signal different malicious activities, from C2 communication to data theft.
    answer_sources: >-
      Zeek conn.log, Zeek dns.log, Zeek http.log, Zeek files.log, Zeek ssl.log, MDM/UEM logs, VPN logs. Data is sourced from Internal network segments (especially those housing sensitive data like developer environments or financial systems), Corporate Wi-Fi access points, VPN termination points, DNS resolvers, Egress points to the internet.
    range: Last 90 days
    queries:
      - pseudocode: FOR each mobile IP, CALCULATE 30-day baseline. ALERT IF: (a) DNS entropy > 3 STDEV above mean; OR (b) Outbound connection size > 99th percentile; OR (c) HTTP User-Agent is not in top 20 most common for device.
  - question: Can advanced ML models (GNN and time-series) detect anomalous device-to-server connections or data exfiltration volumes?
    context: >-
      This question leverages sophisticated machine learning to model complex relationships and patterns. A Graph Neural Network (GNN) can learn the normal "map" of which devices talk to which servers, flagging new, improbable connections. Simultaneously, a SARIMA time-series model forecasts expected data transfer volumes, allowing it to spot spikes that indicate data exfiltration. Using both models provides a powerful, multi-faceted approach to detecting advanced threats.
    answer_sources: >-
      Zeek conn.log, Zeek dns.log, Zeek http.log, Zeek files.log, Zeek ssl.log, MDM/UEM logs, VPN logs. Data is sourced from Internal network segments (especially those housing sensitive data like developer environments or financial systems), Corporate Wi-Fi access points, VPN termination points, DNS resolvers, Egress points to the internet.
    range: Last 90 days
    queries:
      - pseudocode: MODEL device-server connections with a GNN. IF new connection has high anomaly score, ALERT. FORECAST outbound data volume with SARIMA model. IF actual volume exceeds 99% prediction interval, ALERT.
  - question: Has a successful login occurred from a device that recently failed a critical compliance check?
    context: >-
      This question directly links a known device integrity issue (e.g., jailbreaking, rooting) with network access. A device that fails a compliance check is in a high-risk state. If a successful login to corporate resources originates from that same device shortly after the failure, it is a critical security event that requires immediate investigation, as the compromise of the device's OS may have enabled the lockscreen bypass.
    answer_sources: >-
      MDM/UEM logs, Windows Event ID 4624, Zeek conn.log, VPN logs, IdP logs. Data is sourced from MDM/UEM Management Servers, Authentication Servers, VPN Concentrators, Cloud Identity Providers.
    range: Last 90 days
    queries:
      - pseudocode: ON MDM critical compliance failure alert, CACHE device ID and last known IP. MONITOR auth logs for 60 mins. IF successful login from cached IP occurs, CREATE critical incident.
  - question: Is a non-compliant device exhibiting signs of data exfiltration while remaining un-remediated for an unusually long time?
    context: >-
      This question aims to identify high-risk devices that have fallen through the cracks of the standard remediation process. A device that stays in a non-compliant state for longer than usual is a significant risk. By cross-referencing these lingering high-risk devices with network data showing significant data transfer, we can proactively identify potential compromises that may have been missed by other alerts.
    answer_sources: >-
      MDM/UEM logs, Windows Event ID 4624, Zeek conn.log, VPN logs, IdP logs. Data is sourced from MDM/UEM Management Servers, Authentication Servers, VPN Concentrators, Cloud Identity Providers.
    range: Last 90 days
    queries:
      - pseudocode: CALCULATE 95th percentile for remediation time per alert type. FIND devices non-compliant longer than this threshold. CHECK Zeek logs for > 1MB data transfer from device's IP in past hour. IF both conditions met, QUARANTINE device.
  - question: Does a predictive model classify a compliance alert, followed by a login, as a high-risk malicious event?
    context: >-
      This question uses a supervised machine learning model (XGBoost) to predict the likelihood that a compliance alert is malicious, based on historical data. By training the model on features of past alerts and their outcomes (true positive vs. false positive), it can learn to distinguish benign compliance issues from those associated with real attacks. When a new alert receives a high risk score and is followed by a login, it can be automatically escalated with high confidence.
    answer_sources: >-
      MDM/UEM logs, Windows Event ID 4624, Zeek conn.log, VPN logs, IdP logs. Data is sourced from MDM/UEM Management Servers, Authentication Servers, VPN Concentrators, Cloud Identity Providers.
    range: Last 90 days
    queries:
      - pseudocode: SCORE new MDM compliance alert using XGBoost model. IF risk score > 0.9 AND successful auth from device's IP occurs within 1 hour, THEN ESCALATE to Tier-3 analyst.