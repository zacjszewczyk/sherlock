name: T1608.006: SEO Poisoning
id: 5a8a183d-3b2d-4f1a-8c9a-7e6d0b3f4c5d
description: This playbook focuses on detecting adversarial use of Search Engine Optimization (SEO) poisoning. An adversary may use this technique to make their malicious websites appear higher in search results, luring internal users into drive-by-compromise or supply chain attacks. The playbook identifies this activity by monitoring for communications with known malicious infrastructure, analyzing web traffic for suspicious redirection chains originating from search engines, detecting the download of high-risk files followed by anomalous endpoint process behavior, and identifying "flocking" events where multiple users are suddenly directed to a new or low-reputation domain.
type: technique
related:
  - TA0042: Resource Development
contributors:
  - Zachary Szewczyk
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags:
  - none
questions:
  - question: Are internal hosts communicating with domains or IPs known to be associated with SEO poisoning campaigns?
    context: This question aims to detect direct communication with known malicious infrastructure. By joining network connection logs with a high-confidence threat intelligence feed, we can identify hosts that have accessed domains or IPs linked to active SEO poisoning campaigns like Gootloader. A match provides a strong signal of a potential compromise.
    answer_sources: Zeek conn.log, Zeek dns.log, Zeek http.log, Internet gateway/proxy servers, Corporate DNS resolvers, Threat Intelligence Platform
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          JOIN dns_logs.query, connection_logs.destination_ip WITH threat_intel_feed.indicator;
          ALERT ON match;
  - question: Are multiple internal hosts accessing low-prevalence, suspicious domains within a short time frame?
    context: This question seeks to identify potential 'flocking' behavior towards a suspicious domain that might not yet be on a threat intelligence list. By analyzing domain query prevalence, we can flag domains that are rarely visited organisation-wide but are suddenly accessed by a small group of hosts. Combining low prevalence with suspicious Top-Level Domains (TLDs) like .zip or .mov helps filter out noise and focus on likely malicious activity.
    answer_sources: Zeek conn.log, Zeek dns.log, Zeek http.log, Internet gateway/proxy servers, Corporate DNS resolvers, Threat Intelligence Platform
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          CALCULATE prevalence = (unique_hosts_querying_domain / total_hosts);
          FLAG IF prevalence < 0.01 AND unique_hosts > 3 IN 1_hour AND domain_tld IN ['.zip', '.mov', '.xyz'];
  - question: Are internal hosts accessing domains that appear to be generated by an algorithm, especially if the traffic originates from a search engine?
    context: Adversaries sometimes use Domain Generation Algorithms (DGAs) to create a large number of disposable domains. This question uses a DGA detection model to identify such domains. Correlating these DGA-flagged domains with traffic originating from a search engine referrer strengthens the signal, as it aligns with the SEO poisoning tactic of luring users from search results to malicious sites.
    answer_sources: Zeek conn.log, Zeek dns.log, Zeek http.log, Internet gateway/proxy servers, Corporate DNS resolvers, Threat Intelligence Platform
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          APPLY dga_model ON new_domains;
          IF dga_model_score > threshold AND http_log.referrer IS search_engine THEN ESCALATE;
  - question: Are users experiencing rapid redirect chains after clicking a link from a search engine?
    context: SEO poisoning campaigns often use a series of quick HTTP redirects to obscure the final malicious destination. This question identifies this behavior by looking for sessions originating from a major search engine that involve three or more redirects (HTTP 3xx status codes) to different hosts within a very short (5-second) window. This is a strong indicator of a malicious redirection chain.
    answer_sources: Zeek http.log, Web content filters, Internet gateway/proxy servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          FROM http_logs WHERE referrer IS search_engine, COUNT http_status_code = 3xx TO different_hosts;
          ALERT IF count >= 3 IN 5_seconds FOR same_source_ip;
  - question: Are there any web browsing sessions from search engines exhibiting an anomalously high number of redirects compared to historical norms?
    context: This question provides a statistical approach to detecting malicious redirect chains. By establishing a baseline for the normal number of redirects in a session, we can use anomaly detection to flag sessions that deviate significantly from this norm (e.g., exceeding the 99th percentile). Focusing on sessions that originate from a search engine helps to contextualize the alert within the SEO poisoning technique.
    answer_sources: Zeek http.log, Web content filters, Internet gateway/proxy servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          BASELINE redirect_chain_length per session over 30_days;
          ALERT IF session_redirect_count > 99th_percentile AND referrer IS search_engine;
  - question: Can we classify web sessions from search engines as benign or malicious based on their redirection characteristics?
    context: This question proposes a more advanced, machine learning-based approach. By training a classification model on various features of an HTTP session (like redirect count, timing, user-agent changes, and domain reputation), we can create a system to automatically score and classify redirection chains in real-time. This allows for more nuanced and accurate detection of sophisticated SEO poisoning campaigns.
    answer_sources: Zeek http.log, Web content filters, Internet gateway/proxy servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          TRAIN classifier_model on http_session_features;
          APPLY model in real-time to sessions WHERE referrer IS search_engine;
          CLASSIFY as benign/malicious;
  - question: Have any high-risk files been downloaded from a recently registered domain following a referral from a search engine?
    context: The goal of SEO poisoning is often to trick users into downloading malware. This question looks for this specific outcome. It correlates web traffic from a search engine with file download logs, specifically flagging downloads of high-risk file types (like ZIP, ISO, or JavaScript) from domains that were registered recently (e.g., in the last 90 days).
    answer_sources: Zeek files.log, Zeek http.log, Windows Event ID 4688, Endpoint devices (workstations, laptops), Internet gateway/proxy servers, EDR Platform
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          JOIN http_logs with files_logs;
          ALERT IF http.referrer IS search_engine AND file.mime_type IN ['application/zip', 'application/x-iso9660-image', 'application/javascript'] AND file_source_domain.registration_age < 90_days;
  - question: Are web browsers spawning unusual or statistically rare child processes, or processes with high-entropy command lines?
    context: After a malicious file is downloaded and opened, it often executes via a child process spawned by the browser. This question seeks to detect this post-exploitation activity. It establishes a baseline of normal browser child processes and alerts on statistical rarities (e.g., a browser spawning wscript.exe or powershell.exe). It also analyzes the command-line arguments for high entropy, which can indicate obfuscated commands.
    answer_sources: Zeek files.log, Zeek http.log, Windows Event ID 4688, Endpoint devices (workstations, laptops), Internet gateway/proxy servers, EDR Platform
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          FROM process_creation_events, BASELINE child_processes of browsers;
          ALERT IF child_process is rare (< 1st_percentile) OR command_line_entropy > 98th_percentile;
  - question: Can we use machine learning to score the likelihood of a browser-spawned process being malicious?
    context: This question proposes a sophisticated endpoint detection method. By training a classifier on features from process creation events (such as command line length, character entropy, and the presence of suspicious keywords like 'IEX' or '-enc'), we can automatically score the maliciousness of any process. Focusing this analysis on processes whose parent is a web browser directly targets the final stage of a successful drive-by-compromise.
    answer_sources: Zeek files.log, Zeek http.log, Windows Event ID 4688, Endpoint devices (workstations, laptops), Internet gateway/proxy servers, EDR Platform
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          TRAIN classifier_model on process_creation_features;
          APPLY model to events WHERE parent_process IS browser;
          ESCALATE on high_score;
  - question: Are an unusually high number of internal hosts being referred from search engines to the same newly observed domain?
    context: This question identifies a 'flocking' event, where a successful SEO poisoning campaign directs many users to the same malicious site in a short period. It specifically looks for domains that have only been seen recently (in the last 30 days) and alerts if more than a certain threshold (e.g., 10) of distinct internal hosts access it from a search engine within 24 hours.
    answer_sources: Zeek http.log, Zeek dns.log, Zeek conn.log, Corporate DNS resolvers, Internet gateway/proxy servers, Centralized SIEM/Log Aggregator
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          FROM http_logs, COUNT distinct source_ips to a common_domain WHERE domain.first_seen < 30_days AND referrer IS search_engine;
          ALERT IF count > 10 in 24_hours;
  - question: Are there any external domains experiencing a statistically significant spike in traffic from internal users referred by search engines?
    context: This question uses anomaly detection to find successful flocking events. By creating a rolling baseline of daily unique visitors for each external domain, we can use statistical measures like a Z-score to identify days where the visitor count is an extreme outlier (e.g., Z-score > 3.5). This method is effective at finding sudden, anomalous bursts of activity characteristic of a successful SEO poisoning campaign.
    answer_sources: Zeek http.log, Zeek dns.log, Zeek conn.log, Corporate DNS resolvers, Internet gateway/proxy servers, Centralized SIEM/Log Aggregator
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          CALCULATE 30-day rolling baseline of unique_visitors_per_day for each external_domain;
          CALCULATE Z-score for today's visitor_count;
          ALERT IF Z-score > 3.5 AND referrer IS search_engine;
  - question: Can we automatically cluster external domains based on their access patterns to identify those exhibiting a 'sudden burst' of traffic?
    context: This question proposes an unsupervised machine learning approach to identify flocking behavior. By applying a time-series clustering algorithm to the daily visitor counts for all external domains, we can group domains with similar access patterns. The cluster representing a 'sudden burst' pattern (low traffic followed by a sharp spike) would contain prime candidates for SEO poisoning investigations.
    answer_sources: Zeek http.log, Zeek dns.log, Zeek conn.log, Corporate DNS resolvers, Internet gateway/proxy servers, Centralized SIEM/Log Aggregator
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          APPLY time-series clustering (e.g., k-shape) on daily_visitor_counts for all domains;
          INVESTIGATE domains in the 'sudden burst' cluster;