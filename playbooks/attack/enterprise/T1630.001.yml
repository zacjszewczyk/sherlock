name: T1630.001: Uninstall Malicious Application
id: f4b1b3b2-9c7a-4a8e-8f6d-1b9c0d1e2f3a
description: This playbook helps investigate whether an adversary is attempting to remove their tools from a compromised mobile device to evade detection. It focuses on identifying several key indicators: the abrupt cessation of a stable beaconing connection not associated with a device power-off; an application uninstall event in MDM logs that lacks a corresponding, approved change ticket in an ITSM system; and network traffic matching a rooting toolkit IOC that is quickly followed by the cessation of a known C2 beacon from the same device.
type: technique
related:
  - TA0030: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is a mobile device communicating with a known command and control (C2) server?
    context: This question aims to identify active C2 communication from mobile devices. By correlating network connection logs (Zeek conn.log) and DNS query logs (Zeek dns.log) with a threat intelligence feed of known malicious servers and domains, an analyst can detect potential infections or compromised devices that are actively communicating with an adversary's infrastructure.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Mobile Device Management (MDM) Device Status Logs
      - Centralized SIEM/log aggregator, corporate Wi-Fi access points, VPN concentrators, and DNS resolvers servicing mobile devices.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH Zeek logs JOIN Threat Intel Feed
          WHERE (conn.log.destination_ip IN c2_list) OR (dns.log.query IN c2_domain_list)
          GROUP BY mobile_device_ip

  - question: Has a previously stable C2 beacon from a mobile device abruptly stopped without a corresponding device-offline event?
    context: This question seeks to detect the sudden cessation of beaconing activity, which could indicate that a malicious application has been uninstalled. It identifies regularly timed, low-variance connections (beacons), establishes a baseline for their timing, and then alerts if a beacon is missed beyond a statistical threshold (e.g., 3 standard deviations), especially when MDM logs show the device is still online.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Mobile Device Management (MDM) Device Status Logs
      - Centralized SIEM/log aggregator, corporate Wi-Fi access points, VPN concentrators, and DNS resolvers servicing mobile devices.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH Zeek conn.log
          | CALCULATE CV for interval and bytes
          | FILTER for low CV (beacons)
          | CALCULATE mean and stdev of interval
          | ALERT if (time_since_last_beacon > mean + 3*stdev) AND (device_ip NOT IN MDM_offline_events)

  - question: Does a time series anomaly detection model indicate a statistically significant cessation of a device's beaconing activity?
    context: This question applies advanced analytics to detect the removal of a malicious application. By training a time series model on a device's historical beaconing patterns (connection frequency and data volume), we can forecast expected activity. An alert is triggered if the actual activity drops to zero and stays there, falling outside the model's high-confidence prediction interval, strongly suggesting an anomalous and potentially malicious event like an uninstallation.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Mobile Device Management (MDM) Device Status Logs
      - Centralized SIEM/log aggregator, corporate Wi-Fi access points, VPN concentrators, and DNS resolvers servicing mobile devices.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY time_series_model to device_beacon_data
          | FORECAST expected activity with prediction interval
          | ALERT if actual_activity == 0 AND is_outside_prediction_interval

  - question: Has an application been uninstalled from a mobile device without an associated approved change request?
    context: This question aims to identify unauthorized software removal by correlating MDM logs with IT service management records. When an application uninstall event is detected, it is cross-referenced with the ITSM system. If there is no corresponding, approved change ticket for that specific device and application, it suggests the action was not sanctioned by IT and could be part of an adversary's cleanup activities.
    answer_sources:
      - MDM Platform Audit Logs
      - IT Service Management (ITSM) System Logs
      - Cloud or on-premise servers hosting the MDM and ITSM platforms, and the centralized SIEM where their logs are aggregated.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          ON MDM log event_type='ApplicationUninstalled'
          | QUERY ITSM for approved_change_request(device_id, app_name, last 24h)
          | IF no_request_found, ALERT 'Unauthorized Uninstall'

  - question: Is a specific device exhibiting a statistically unusual number of unauthorized application uninstalls?
    context: This question focuses on identifying devices with anomalous patterns of unauthorized uninstalls. By establishing a baseline of normal 'Unauthorized Uninstall' alerts for each device over a 30-day period, we can use statistical methods (like Z-score) to detect significant spikes in this activity. A high Z-score indicates a deviation from the norm that warrants further investigation for malicious behavior.
    answer_sources:
      - MDM Platform Audit Logs
      - IT Service Management (ITSM) System Logs
      - Cloud or on-premise servers hosting the MDM and ITSM platforms, and the centralized SIEM where their logs are aggregated.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          COUNT 'Unauthorized Uninstall' alerts per device daily
          | CALCULATE 30-day rolling mean and stdev
          | ALERT if daily_count > (mean + 3*stdev)

  - question: Can a machine learning model classify an unauthorized uninstall event as having a high probability of being malicious?
    context: This question leverages machine learning to increase the confidence of an alert. A classification model is trained on labeled historical data to learn the characteristics of malicious versus benign uninstalls. Features like the app's category, its installation source (sideloaded apps are riskier), and the timing of the uninstall are used. When a new unauthorized uninstall occurs, the model provides a probability score, allowing analysts to prioritize events that are highly likely to be malicious.
    answer_sources:
      - MDM Platform Audit Logs
      - IT Service Management (ITSM) System Logs
      - Cloud or on-premise servers hosting the MDM and ITSM platforms, and the centralized SIEM where their logs are aggregated.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY classification_model to 'Unauthorized Uninstall' event
          | EXTRACT features (app_category, install_source, etc.)
          | IF model_prediction_probability > 0.95, ALERT 'High-Confidence Malicious Uninstall'

  - question: Did a mobile device exhibit signs of being rooted shortly before C2 beaconing activity ceased?
    context: This question attempts to link two highly suspicious events in a tight time window to build a stronger case for malicious activity. An adversary might use a rooting toolkit to gain elevated privileges before removing their malware. This rule correlates an alert for rooting toolkit indicators (e.g., specific network traffic) with a subsequent beacon cessation alert from the same device, suggesting a deliberate, multi-stage cleanup operation.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Threat Intelligence Platform Feeds
      - Network egress points, corporate DNS resolvers, and the Threat Intelligence Platform (TIP) integrated with the SIEM.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          CORRELATE alerts
          | TRIGGER if (alert_type='Rooting_IOC' AND alert_type='Beacon_Cessation') AND (device_id is same) AND (time_diff < 60 minutes)

  - question: Does the time between a rooting IOC and a beacon cessation alert represent a statistically rare and rapid sequence of events?
    context: This question adds statistical rigor to the timing analysis between alerts. By analyzing the historical time delays between a rooting IOC and any subsequent alert, we can establish a distribution. If the time delay to a 'Beacon Cessation' alert is exceptionally short (e.g., in the fastest 1% of all observed delays), it strengthens the hypothesis that the two events are causally linked and part of a rapid, automated attack chain, warranting a critical escalation.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Threat Intelligence Platform Feeds
      - Network egress points, corporate DNS resolvers, and the Threat Intelligence Platform (TIP) integrated with the SIEM.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR devices with 'Rooting_IOC' alert
          | CALCULATE distribution of time_to_next_alert
          | IF next_alert is 'Beacon_Cessation' AND time_delay is in bottom 1st percentile, ESCALATE to 'Critical'

  - question: Can a sequence analysis model identify a high-probability transition from a rooting event to a beacon cessation event?
    context: This question uses a sequence analysis model, like an HMM, to formally model the chain of events an adversary might follow. The model learns normal and abnormal sequences of alerts from historical data. A specific state transition, representing a rooting alert followed by a beacon cessation alert, is defined as a 'Malicious Uninstall' chain. If the model calculates a high probability for a device's alert stream transitioning into this malicious state, it provides a high-confidence signal of a sophisticated cleanup attempt.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Threat Intelligence Platform Feeds
      - Network egress points, corporate DNS resolvers, and the Threat Intelligence Platform (TIP) integrated with the SIEM.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY HMM to device_alert_stream
          | DEFINE state_transition 'Malicious_Uninstall' as (Rooting_IOC -> Beacon_Cessation)
          | IF probability of transition > 0.90, ALERT 'High-Confidence Malicious Uninstall Chain'