name: T1496.003: SMS Pumping
id: f8b1c4d2-3a6e-4f9b-8c1d-5e7a9f0b3c2d
description: This playbook helps investigate if an adversary is causing financial or availability impact through SMS pumping. This involves detecting abuse of SMS-generating web forms or APIs, which can manifest as high volumes of requests from automated sources, suspicious geographic distributions of destination numbers, sudden spikes in messaging costs, and the use of specific tools or scripts on internal systems. The goal is to identify and characterize automated activity designed to fraudulently generate SMS messages, leading to significant financial loss for the organization.
type: technique
related:
- TA0040: Impact
contributors:
- Zachary Szewczyk
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Have any web form submissions that trigger SMS messages originated from IPs or User-Agents, or been sent to phone numbers, that match known malicious indicators from threat intelligence?
  context: This question aims to identify SMS pumping activity by cross-referencing real-time web form submission data with curated threat intelligence. A match against a known malicious IP, User-Agent, or fraudulent phone number prefix is a high-fidelity indicator that the request is part of a coordinated botnet or fraud campaign, rather than from a legitimate user.
  answer_sources:
  - Cloud Messaging Service Logs
  - Zeek http.log
  - Web Server Access Logs
  - Public-facing Web Servers hosting OTP/verification forms
  - API Gateway
  - Cloud tenant for Messaging Services
  - Threat Intelligence Platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: JOIN (WebServerLogs, ZeekLogs) ON source_ip OR user_agent WITH ThreatIntelFeed.malicious_indicators | JOIN (MessagingLogs) ON form_submission.id WITH ThreatIntelFeed.fraudulent_numbers
- question: Has any single source IP submitted an unusually high number of requests to an SMS-generating web form compared to a statistically established baseline?
  context: This question seeks to uncover automated activity from sources not yet identified by threat intelligence. By establishing a normal baseline for request frequency, we can spot outliers. A single IP address exceeding the 99th percentile of requests within a short time frame is a strong statistical indicator of a bot attempting to abuse the form.
  answer_sources:
  - Cloud Messaging Service Logs
  - Zeek http.log
  - Web Server Access Logs
  - Public-facing Web Servers hosting OTP/verification forms
  - API Gateway
  - Cloud tenant for Messaging Services
  - Threat Intelligence Platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM WebServerLogs | GROUP BY source_ip, time_window(5m) | COUNT requests AS request_count | WHERE request_count > (CALCULATE_BASELINE(WebServerLogs, percentile=99, window=5m, lookback=30d))
- question: Have any incoming OTP or web form requests been classified as high-risk or bot-like by a machine learning model based on their features?
  context: This question leverages a machine learning model to perform a more nuanced risk assessment than simple rules or statistical thresholds. By analyzing multiple features in concert (IP reputation, User-Agent, time of day, etc.), the model can identify complex patterns of abuse and flag suspicious requests that might otherwise evade detection.
  answer_sources:
  - Cloud Messaging Service Logs
  - Zeek http.log
  - Web Server Access Logs
  - Public-facing Web Servers hosting OTP/verification forms
  - API Gateway
  - Cloud tenant for Messaging Services
  - Threat Intelligence Platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM WebServerLogs | PIPE to ML_Model(features=[source_ip, user_agent, time_of_day, country]) | WHERE model_prediction = "high-risk bot"
- question: Are there any web requests to SMS-generating endpoints using User-Agent strings associated with common automation tools?
  context: This question aims to detect blatant automation by searching for User-Agent strings of common scripting tools like 'curl' or 'python-requests'. While these can be used for legitimate purposes, their presence in requests to public SMS forms, especially from untrusted sources, is a strong sign of automated abuse characteristic of SMS pumping.
  answer_sources:
  - Zeek http.log
  - Web Server Access Logs
  - Public-facing Web Servers
  - Web Application Firewalls (WAFs)
  - Network Security Monitoring Sensors
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM (ZeekLogs, WebServerLogs) WHERE destination_url CONTAINS "sms_endpoint" AND user_agent IN ("curl", "python-requests", "HeadlessChrome")
- question: Has any source IP submitted requests to an OTP form with a suspiciously consistent, non-human time interval between them?
  context: This question attempts to identify automation by analyzing the timing between requests. Human users exhibit natural variation in their interaction speed, while automated scripts often operate with fixed or near-fixed delays. A very low standard deviation in the time between requests from a single IP is a strong statistical indicator of a bot.
  answer_sources:
  - Zeek http.log
  - Web Server Access Logs
  - Public-facing Web Servers
  - Web Application Firewalls (WAFs)
  - Network Security Monitoring Sensors
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM (ZeekLogs, WebServerLogs) WHERE destination_url CONTAINS "otp_form" | GROUP BY source_ip | CALCULATE time_delta_std_dev | WHERE time_delta_std_dev < 0.5
- question: Can web log data be grouped into distinct clusters that separate automated, bot-like activity from legitimate human user patterns?
  context: This question uses unsupervised machine learning to find hidden patterns of abuse. By clustering requests based on features like source IP, User-Agent, and timing, we can identify groups of highly similar, coordinated activity that are characteristic of a botnet, without needing pre-existing signatures or rules.
  answer_sources:
  - Zeek http.log
  - Web Server Access Logs
  - Public-facing Web Servers
  - Web Application Firewalls (WAFs)
  - Network Security Monitoring Sensors
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM (ZeekLogs, WebServerLogs) | CLUSTER using DBSCAN on features (source_ip, user_agent, request_timing) | IDENTIFY anomalous_clusters
- question: Have any known SMS pumping tools or scripts been executed on internal hosts?
  context: This question looks for direct evidence of compromise by searching for the execution of known malicious SMS pumping scripts on internal systems. A match in process creation or PowerShell logs indicates that an internal host, such as a developer workstation or application server, may have been compromised and is being used to abuse SMS APIs.
  answer_sources:
  - Windows Event ID 4688
  - Windows Event ID 4104
  - Internal application servers
  - Developer workstations with API access to messaging services
  - Endpoint Detection and Response (EDR) platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM (EventID:4688, EventID:4104) WHERE command_line CONTAINS ("smspump.py", "send-sms-bulk", "known_sms_tool_hash")
- question: Have any rare or unusual processes been executed on servers with messaging API access?
  context: This question aims to identify anomalous activity on critical servers by baselining normal process execution for specific users or parent processes. A process that rarely runs, especially one that makes network connections to an SMS gateway, is highly suspicious and could indicate a compromised service account or a living-off-the-land attack.
  answer_sources:
  - Windows Event ID 4688
  - Windows Event ID 4104
  - Internal application servers
  - Developer workstations with API access to messaging services
  - Endpoint Detection and Response (EDR) platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM (EventID:4688) | GROUP BY user, parent_process, process_name | CALCULATE rarity_score | WHERE rarity_score > threshold AND network_connection_to_sms_gateway
- question: Have any service accounts executed command sequences that deviate from normal learned patterns and involve network utilities targeting SMS gateways?
  context: This question uses machine learning to model the normal behavior of service accounts based on their command-line history. Any sequence of commands that significantly deviates from this learned pattern, particularly if it involves tools like curl.exe or Invoke-WebRequest aimed at SMS API endpoints, is flagged as a potential sign of account misuse or compromise.
  answer_sources:
  - Windows Event ID 4688
  - Windows Event ID 4104
  - Internal application servers
  - Developer workstations with API access to messaging services
  - Endpoint Detection and Response (EDR) platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM CommandLogs | PIPE to Sequence_Model(user_account) | WHERE model_anomaly_score > threshold AND command_sequence CONTAINS ("curl.exe", "Invoke-WebRequest") AND destination_url CONTAINS "sms_gateway"
- question: Has any single API key or web form endpoint generated an excessive number of SMS requests in a short time frame?
  context: This question uses a simple, fixed threshold to catch egregious instances of SMS abuse. A rate of over 100 requests per minute from a single source is far beyond typical human behavior for verification and serves as a clear, high-level indicator of an automated attack in progress.
  answer_sources:
  - Cloud Messaging Service Logs
  - Web Server Access Logs
  - Zeek conn.log
  - API Gateway
  - Cloud Messaging Service Console
  - Network Egress Points
  - SIEM Platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM (MessagingLogs, WebServerLogs) | GROUP BY source_api_key, time_window(1m) | COUNT requests AS request_count | WHERE request_count > 100
- question: Has the rate of outbound SMS requests from any single source significantly exceeded its statistical baseline?
  context: This question provides a more dynamic approach than a fixed threshold by comparing current activity against a historical baseline for each specific API key or web form. An alert is triggered if the request count exceeds the baseline by more than three standard deviations, indicating a statistically significant and anomalous spike in activity for that particular source.
  answer_sources:
  - Cloud Messaging Service Logs
  - Web Server Access Logs
  - Zeek conn.log
  - API Gateway
  - Cloud Messaging Service Console
  - Network Egress Points
  - SIEM Platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM (MessagingLogs, WebServerLogs) | GROUP BY source_api_key, time_window(5m) | COUNT requests AS current_count | WHERE current_count > (CALCULATE_BASELINE(source_api_key, lookback=30d) + 3 * STD_DEV)
- question: Has a time-series model detected an anomalous spike in the volume of SMS requests from any source?
  context: This question applies advanced anomaly detection to the volume of SMS requests over time. By forecasting the expected volume for each source, a machine learning model can identify when the actual volume significantly exceeds the prediction, flagging anomalies that might be missed by simpler statistical methods, especially for sources with complex seasonal patterns.
  answer_sources:
  - Cloud Messaging Service Logs
  - Web Server Access Logs
  - Zeek conn.log
  - API Gateway
  - Cloud Messaging Service Console
  - Network Egress Points
  - SIEM Platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM MessagingLogs | PIPE to ARIMA_Model(source_api_key) | WHERE actual_volume > forecast_upper_bound
- question: Has a spike in SMS costs coincided with messages being sent to high-risk or non-business-relevant countries?
  context: This question directly links financial impact (cost overruns) with a key indicator of fraud (messages to suspicious locations). Correlating a cloud billing alert with logs showing SMS messages sent to phone prefixes on a blocklist provides strong, contextual evidence of a financially motivated SMS pumping attack.
  answer_sources:
  - Cloud Provider Billing and Cost Management Logs
  - Cloud Messaging Service Logs
  - Cloud Billing Console
  - Financial Reporting Systems
  - Cloud Messaging Service Console
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: JOIN (BillingLogs) WHERE service = "SMS" AND cost > threshold WITH (MessagingLogs) ON time_window(24h) WHERE destination_country IN (high_risk_country_list)
- question: Has a spike in daily SMS costs been accompanied by a distribution of destination countries skewed toward unusual locations?
  context: This question identifies fraud by looking for statistical anomalies in both cost and destination. An alert for an unusually high daily cost (e.g., above the 95th percentile) triggers an analysis of the destination countries for that day. A distribution heavily concentrated on one or two unexpected countries is a strong indicator that the cost increase is due to fraudulent activity.
  answer_sources:
  - Cloud Provider Billing and Cost Management Logs
  - Cloud Messaging Service Logs
  - Cloud Billing Console
  - Financial Reporting Systems
  - Cloud Messaging Service Console
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM BillingLogs WHERE daily_sms_cost > percentile(daily_sms_cost, 95, 90d) | TRIGGER (ANALYZE MessagingLogs for same_day | CALCULATE frequency_distribution(destination_country))
- question: Has a multivariate model detected a period where SMS costs are disproportionately high relative to the message volume and geographic distribution?
  context: This question uses machine learning to understand the complex relationship between SMS cost, volume, and destinations. An anomaly detection model can flag periods where the cost is unusually high, even if the volume isn't, suggesting a shift to more expensive, premium-rate numbers often used in fraud schemes.
  answer_sources:
  - Cloud Provider Billing and Cost Management Logs
  - Cloud Messaging Service Logs
  - Cloud Billing Console
  - Financial Reporting Systems
  - Cloud Messaging Service Console
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM (BillingLogs, MessagingLogs) | PIPE to Anomaly_Model(features=[cost, volume, geo_distribution]) | WHERE anomaly_score > threshold
- question: Have any SMS messages been sent to countries outside of an approved business allowlist?
  context: This question implements a strict, high-fidelity rule to detect fraud. By maintaining an explicit allowlist of country codes where the organization operates, any SMS sent to a destination outside this list is immediately flagged as a high-severity event, as it represents a clear policy violation and a strong indicator of abuse.
  answer_sources:
  - Cloud Messaging Service Logs
  - Cloud Messaging Service Console
  - SIEM Platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM MessagingLogs WHERE destination_country_code NOT IN (business_country_allowlist)
- question: Has the diversity of destination countries for SMS messages dropped sharply, indicating a focus on a small set of locations?
  context: This question uses information theory to detect attacks by measuring the randomness (entropy) of destination country codes. Normal business activity typically involves a diverse set of countries, resulting in high entropy. A sudden, sharp drop in entropy indicates that traffic is being concentrated on a few countries, a common pattern in targeted SMS pumping campaigns.
  answer_sources:
  - Cloud Messaging Service Logs
  - Cloud Messaging Service Console
  - SIEM Platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM MessagingLogs | CALCULATE shannon_entropy(destination_country_code) over time_window(1h) | WHERE entropy < (baseline_entropy - 2 * STD_DEV)
- question: Have new, distinct geographic clusters of destination numbers appeared, particularly in high-risk regions?
  context: This question uses unsupervised machine learning to identify novel patterns in SMS destinations. A clustering algorithm can identify the normal geographic distribution of legitimate users. If a new batch of messages forms a new, tight cluster in a location with no prior business activity, it is flagged as a likely indicator of a new fraud campaign.
  answer_sources:
  - Cloud Messaging Service Logs
  - Cloud Messaging Service Console
  - SIEM Platform
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM MessagingLogs | CLUSTER on destination_geolocation | IDENTIFY new_or_anomalous_clusters
- question: Has a single user session made requests from different countries within a short time frame?
  context: This question looks for a simple form of "impossible travel" by checking if requests within the same user session originate from different countries in a short period (e.g., 10 minutes). This is a low-fidelity but easy-to-implement indicator that a session token may be compromised and used by multiple malicious actors.
  answer_sources:
  - Zeek http.log
  - Web Server Access Logs
  - Windows Event ID 4624
  - Public-facing Web Servers
  - Authentication Servers
  - Geolocation Enrichment Service
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM WebServerLogs | GROUP BY session_id | IF country_code changes within time_window(10m) THEN ALERT
- question: Has any user session shown activity from geographically distant locations at a speed that exceeds plausible travel?
  context: This question provides a more precise method for detecting "impossible travel". By calculating the distance and time between consecutive requests for a session, we can determine the implied speed. If this speed exceeds that of commercial aircraft, it's a strong indicator that the account is being used simultaneously from multiple locations, a sign of credential abuse.
  answer_sources:
  - Zeek http.log
  - Web Server Access Logs
  - Windows Event ID 4624
  - Public-facing Web Servers
  - Authentication Servers
  - Geolocation Enrichment Service
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM WebServerLogs | GROUP BY session_id | CALCULATE speed between consecutive geolocations | WHERE speed > 800
- question: Has a machine learning model detected anomalous session behavior indicative of impossible travel or other session abuse?
  context: This question uses a sophisticated sequence-based model to learn the normal patterns of user movement and session activity. It can detect not only classic impossible travel but also other subtle anomalies in a user's session sequence (e.g., unusual time of day, strange IP progression). Sessions that the model cannot "reconstruct" well are flagged as highly anomalous.
  answer_sources:
  - Zeek http.log
  - Web Server Access Logs
  - Windows Event ID 4624
  - Public-facing Web Servers
  - Authentication Servers
  - Geolocation Enrichment Service
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FROM WebServerLogs | PIPE session_data to LSTM_Autoencoder_Model | WHERE reconstruction_error > threshold