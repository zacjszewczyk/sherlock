name: T1025: Data from Removable Media
id: a6f5e8d2-c3b4-4a1f-9e8d-7c6b5a4d3e2f
description: This playbook focuses on detecting adversaries collecting data from removable media (e.g., USB drives). It provides investigative questions to identify suspicious processes launched from removable drives, the use of command-line utilities to copy files from these drives, high-volume file read access from removable media, and the correlation of these collection events with subsequent data staging (archiving) or exfiltration (network connections).
type: technique
related:
  - TA0009: Collection
contributors: Zachary Szewczyk, Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are processes known to be associated with data theft malware being launched from removable media drives?
    context: This question seeks to identify the execution of malicious tools directly from a USB or other removable drive. Adversaries may place data collection malware on removable media to introduce it to a target system. Detecting the launch of a process from a removable drive path, where the process's hash or name is known to threat intelligence as a data theft tool, is a high-fidelity indicator of a Collection Tactic (T1025) in progress.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon)
      - Endpoints (desktops, laptops) with USB ports, physical servers with USB access, and virtual machine hosts with USB passthrough enabled.
    range: last 90 days
    queries:
      - pseudocode: SEARCH process_creation_logs WHERE process_path STARTS_WITH removable_drive_letter AND (process_hash IN threat_intel_feed OR process_name IN threat_intel_feed)
  - question: Are any statistically rare or strangely named processes being executed from removable media across the enterprise?
    context: This question aims to find outlier processes originating from removable drives that may not be caught by signature-based threat intelligence. Adversaries often use custom or renamed tools to evade detection. By calculating the prevalence of each process hash launched from removable media, we can identify executables that have run on very few machines. Additionally, high-entropy filenames can indicate an adversary's attempt to randomize tool names to avoid static indicators.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon)
      - Endpoints (desktops, laptops) with USB ports, physical servers with USB access, and virtual machine hosts with USB passthrough enabled.
    range: last 90 days
    queries:
      - pseudocode: FROM process_creation_logs WHERE process_path STARTS_WITH removable_drive_letter | CALCULATE prevalence by process_hash | FILTER prevalence < threshold | CALCULATE entropy of filename | FILTER entropy > threshold
  - question: Can we use a machine learning model to classify processes launched from removable media as benign or malicious?
    context: This question leverages machine learning to build a more nuanced detection capability. By training a classification model on features like the parent process, command-line arguments, and code signing status of executables run from removable media, the system can learn to distinguish normal user activity (e.g., running a portable application) from malicious behavior (e.g., a suspicious script running from a hidden directory on a USB drive). This provides a proactive and adaptive detection method.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon)
      - Endpoints (desktops, laptops) with USB ports, physical servers with USB access, and virtual machine hosts with USB passthrough enabled.
    range: last 90 days
    queries:
      - pseudocode: EXTRACT features from process_creation_events from removable_media | APPLY classification_model | ALERT on malicious_classification
  - question: Are native file copy utilities (xcopy, robocopy, Copy-Item) being used to copy data from removable media?
    context: This question looks for adversaries 'living off the land' by using built-in Windows utilities to perform data collection. Instead of bringing their own tools, they can use legitimate programs like xcopy, robocopy, or PowerShell's Copy-Item cmdlet to move files from a removable drive to the local system or a network share. Detecting these commands with a source path on a removable drive is a strong indicator of this technique.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon)
      - Windows Event ID 4104
      - Endpoints (desktops, laptops) with USB ports, and command-line/scripting log collection infrastructure.
    range: last 90 days
    queries:
      - pseudocode: SEARCH command_line_logs OR powershell_logs WHERE (process_name IN ['xcopy.exe', 'robocopy.exe', 'powershell.exe']) AND (command_line CONTAINS removable_drive_path AND (command_line CONTAINS 'Copy-Item' OR command_line CONTAINS 'xcopy' OR command_line CONTAINS 'robocopy'))
  - question: Is any user exhibiting an anomalous volume or frequency of file copy operations from removable media compared to their baseline?
    context: This question aims to detect unusual user behavior that might indicate compromised credentials or an insider threat. By establishing a historical baseline for each user's file copy activities from removable media (e.g., daily data volume, command frequency), we can flag significant deviations. An alert would be generated if a user suddenly starts copying gigabytes of data or running copy commands far more often than their historical norm or the norm of their peer group.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon)
      - Windows Event ID 4104
      - Endpoints (desktops, laptops) with USB ports, and command-line/scripting log collection infrastructure.
    range: last 90 days
    queries:
      - pseudocode: FOR each user | BASELINE file_copy_volume_from_removable_media | ALERT when current_activity > baseline_percentile
  - question: Can an anomaly detection model identify suspicious command-line arguments used in file copy operations from removable media?
    context: This question applies machine learning to scrutinize the details of how copy commands are used. An adversary's command might look different from a typical user's. An anomaly detection model can be trained on features like the use of wildcards, recursive flags, or unusual file extension targets. The model learns what normal administrative and user copy operations look like and can then flag commands with anomalous parameter combinations as potentially malicious.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon)
      - Windows Event ID 4104
      - Endpoints (desktops, laptops) with USB ports, and command-line/scripting log collection infrastructure.
    range: last 90 days
    queries:
      - pseudocode: EXTRACT features from command_line_arguments (wildcards, recursion, etc.) | APPLY anomaly_detection_model | ALERT on significant_deviation
  - question: Is any single process rapidly reading a large number of files from a removable media drive?
    context: This question seeks to detect automated, indiscriminate data collection. When a malicious script or tool attempts to harvest data, it will often read a large number of files in a very short period. By setting a threshold for file read events (Event ID 4663) from a removable drive path generated by a single process within a short time window (e.g., over 100 reads in one minute), we can detect this behavior, assuming the necessary file access auditing is enabled.
    answer_sources:
      - Windows Event ID 4663
      - Endpoints and file servers where sensitive data is stored and where object access auditing (SACL) for removable media file reads is enabled.
    range: last 90 days
    queries:
      - pseudocode: SEARCH file_access_logs (EventID 4663) WHERE access_type = 'Read' AND source_path is on_removable_drive | GROUP by process_id, time_window | ALERT where event_count > threshold
  - question: Is any user session demonstrating an abnormally high rate of file access or accessing an unusually diverse set of file types from a removable drive?
    context: This question uses statistical analysis to find unusual data access patterns from removable media. We can identify potential data theft by monitoring two key metrics per user session - the rate of file access events per minute and the variety (entropy) of file extensions being accessed. A sudden spike in access rate compared to a user's history, or accessing a wide mix of file types (.docx, .pdf, .jpg, .kdbx) simultaneously, can indicate automated data gathering rather than normal user activity.
    answer_sources:
      - Windows Event ID 4663
      - Endpoints and file servers where sensitive data is stored and where object access auditing (SACL) for removable media file reads is enabled.
    range: last 90 days
    queries:
      - pseudocode: AGGREGATE file_access_events by user, session | CALCULATE access_rate_per_minute and file_extension_entropy | ALERT when access_rate > historical_percentile OR entropy is anomalous
  - question: Can a sequence analysis model detect abnormal patterns in the sequence of files being accessed from a removable drive?
    context: This question applies machine learning to analyze the *order* in which files are accessed. Normal user behavior might involve opening a few related files in a directory. An adversary's script, however, might perform a rapid, recursive traversal of the entire drive. A sequence analysis model (like an LSTM autoencoder) can be trained on benign access sequences. It can then identify and flag sequences that deviate from this learned norm, such as those indicative of automated directory scraping.
    answer_sources:
      - Windows Event ID 4663
      - Endpoints and file servers where sensitive data is stored and where object access auditing (SACL) for removable media file reads is enabled.
    range: last 90 days
    queries:
      - pseudocode: MODEL sequence of file_paths_accessed_from_removable_drive per session | TRAIN on benign sequences | ALERT on sequences with high reconstruction_error (anomalies)
  - question: Is there evidence of data collection from removable media followed closely by data staging (archiving) or exfiltration (suspicious network connection)?
    context: This question connects the act of data collection with subsequent adversary actions. After collecting data from a removable drive, an adversary often stages it by compressing it into an archive (e.g., .zip, .rar) and then exfiltrates it over the network. This query creates a stateful rule that looks for a confirmed 'Data from Removable Media' event, followed within a 30-minute window by either the use of an archiving tool or an outbound network connection to a low-reputation IP or an unusual geographic location.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon)
      - Windows Event ID 4104
      - Network egress points (e.g., firewalls, proxies), DNS servers, and endpoints with direct internet access. Correlation must occur across data from these NAIs.
    range: last 90 days
    queries:
      - pseudocode: IF 'Data from Removable Media' signal on host THEN MONITOR host for 30 mins for (process_creation of archiving_tool OR outbound_connection to low_reputation_ip)
  - question: Does a host exhibit a statistically significant increase in outbound network traffic shortly after a file copy operation from a removable drive?
    context: This question seeks to detect data exfiltration by monitoring for anomalous network behavior following a data collection event. For each host, we establish a baseline of normal outbound network traffic volume in the 15 minutes *after* a file is copied from a removable drive. An alert is triggered if, after a new copy operation, the subsequent outbound traffic volume is statistically significant (e.g., more than 3 standard deviations above the mean), suggesting that the copied data is being sent off the host.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon)
      - Windows Event ID 4104
      - Network egress points (e.g., firewalls, proxies), DNS servers, and endpoints with direct internet access. Correlation must occur across data from these NAIs.
    range: last 90 days
    queries:
      - pseudocode: FOR each host | BASELINE outbound_traffic_volume post-removable_media_copy | ALERT if current_outbound_volume > (baseline_mean + 3 * baseline_std_dev)
  - question: Can a graph-based model identify a malicious sequence of activities involving removable media access, data staging, and network exfiltration?
    context: This question uses a sophisticated graph-based approach to correlate disparate events into a single narrative. We model system activities as a graph where nodes are entities like hosts, processes, and IPs. When a removable media access event occurs, an edge is created. The model then analyzes the evolving sub-graph of activities around that host for the next 30 minutes. A Graph Neural Network (GNN) can be trained to classify the entire sub-graph as malicious or benign based on the presence of features like archiving processes, rare destination IPs, and high data egress, providing a holistic view of the attack chain.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon)
      - Windows Event ID 4104
      - Network egress points (e.g., firewalls, proxies), DNS servers, and endpoints with direct internet access. Correlation must occur across data from these NAIs.
    range: last 90 days
    queries:
      - pseudocode: CREATE graph of host, process, network_destination nodes/edges | ON removable_media_event, analyze evolving_subgraph for 30 mins | APPLY GNN to classify subgraph as malicious/benign