name: "T1562.006: Indicator Blocking"
id: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
description: "This playbook addresses the question: Is the adversary actively blocking security telemetry or indicators to evade detection? It focuses on identifying actions such as running known indicator blocking tools, executing commands to manipulate event logs or firewall rules, generating high-fidelity audit events like log clearing, causing endpoints to cease sending telemetry, or running discovery commands followed by terminating security services."
type: "technique"
related:
  - "TA0005: Defense Evasion"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: "1.0"
tags: "none"
questions:
  - question: "Has a process been created whose file hash matches a known indicator blocking tool from a threat intelligence feed?"
    context: "This question is crucial for detecting the direct execution of known malicious tools. By comparing file hashes of all new processes against a curated list of indicator blocking tools, analysts can quickly identify and respond to the deployment of recognized threats, providing a high-fidelity signal of defense evasion activity."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Endpoint workstations, Critical servers (e.g., Domain Controllers, file servers), Log aggregation servers"
    range: "last 90 days"
    queries:
      - "SEARCH process_creation_events | JOIN file_hashes WITH threat_intel_feed ON hash | WHERE match_found"
  - question: "Have any rare executables, potentially unknown indicator blocking tools, been deployed across multiple systems within a short time frame?"
    context: "This question helps uncover novel or custom tools that are not yet in threat intelligence feeds. By tracking the prevalence of new file hashes, analysts can spot executables that are rare across the enterprise but deployed to multiple hosts, a strong indicator of a targeted attack or tool staging."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Endpoint workstations, Critical servers (e.g., Domain Controllers, file servers), Log aggregation servers"
    range: "last 90 days"
    queries:
      - "SEARCH process_creation_events | CALCULATE prevalence(file_hash) by host | FILTER prevalence < threshold AND host_count > 1 within 24h"
  - question: "Are there processes being executed that exhibit characteristics of malicious indicator blocking tools, even if their hash is unknown?"
    context: "This question leverages machine learning to proactively identify suspicious processes that evade hash-based detection. By analyzing features like parent process, user context, and file metadata, a classification model can score and flag new processes that behave like malicious tools, enabling detection of zero-day or obfuscated threats."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Endpoint workstations, Critical servers (e.g., Domain Controllers, file servers), Log aggregation servers"
    range: "last 90 days"
    queries:
      - "SEARCH process_creation_events | EXTRACT features(parent_process, user, entropy) | SCORE with ML_model | FILTER score > high_probability_threshold"
  - question: "Have any command-line arguments or PowerShell scripts been executed containing keywords or patterns associated with blocking indicators?"
    context: "This question focuses on detecting defense evasion attempts directly through command-line activity. Adversaries often use built-in utilities like 'wevtutil.exe', 'netsh', or PowerShell cmdlets to clear logs, disable security services, or alter firewall rules. Scanning for these specific patterns provides direct evidence of an attempt to tamper with security controls."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Windows PowerShell Event ID 4104"
      - "Endpoint workstations, Servers with local administrative privileges, PowerShell execution environments"
    range: "last 90 days"
    queries:
      - "SEARCH command_line_events OR powershell_script_blocks | REGEX for keywords ('wevtutil cl', 'Clear-EventLog', 'Set-EtwTraceProvider', 'sc stop Sysmon64', 'netsh advfirewall')"
  - question: "Has a common administrative process like powershell.exe or cmd.exe been executed with an unusually long or complex command line, suggesting obfuscation?"
    context: "This question aims to detect obfuscated commands that might bypass simple keyword matching. By baselining the normal length and entropy of command-line arguments for legitimate processes and users, analysts can identify statistical outliers that may represent malicious, encoded, or unusually complex commands used for defense evasion."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Windows PowerShell Event ID 4104"
      - "Endpoint workstations, Servers with local administrative privileges, PowerShell execution environments"
    range: "last 90 days"
    queries:
      - "SEARCH command_line_events | BASELINE entropy and length per user/process | ALERT on executions exceeding 99th percentile"
  - question: "Can machine learning models identify command-line executions that are semantically similar to known malicious defense evasion techniques?"
    context: "This question uses advanced natural language processing to understand the intent behind a command, rather than just matching keywords. A model trained on the structure and semantics of commands can differentiate between a benign administrative action and a malicious one, even if they use similar utilities, by considering the full context of the command."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Windows PowerShell Event ID 4104"
      - "Endpoint workstations, Servers with local administrative privileges, PowerShell execution environments"
    range: "last 90 days"
    queries:
      - "SEARCH command_line_events | ANALYZE with semantic_ML_model | FILTER for high probability of malicious_intent"
  - question: "Has a high-fidelity indicator blocking event occurred, such as the audit log being cleared or the Sysmon configuration being changed?"
    context: "This question targets unambiguous and critical events that are strong indicators of compromise. Events like the security log being cleared (Event ID 1102) or a Sysmon configuration change (Event ID 16) have very few, if any, legitimate use cases and warrant immediate investigation as they signal a direct attempt to erase tracks or disable monitoring."
    answer_sources:
      - "Sysmon Event ID 16"
      - "Windows Security Event ID 1102"
      - "Windows Firewall Event ID 4947"
      - "Windows Security Event ID 5152"
      - "All Windows endpoints and servers, Domain Controllers, Systems with host-based firewalls enabled, Network gateways"
    range: "last 90 days"
    queries:
      - "SEARCH for EventID 1102 OR EventID 16 | CREATE critical_alert"
  - question: "Has an anomalous firewall rule modification been made, such as a manual change by a non-admin user or a rule blocking telemetry to log collectors?"
    context: "This question helps differentiate between legitimate firewall changes (e.g., via Group Policy) and malicious ones. By baselining normal modification activity, analysts can spot outliers, such as a rule added manually to block communication with SIEM collectors, which is a classic defense evasion tactic."
    answer_sources:
      - "Sysmon Event ID 16"
      - "Windows Security Event ID 1102"
      - "Windows Firewall Event ID 4947"
      - "Windows Security Event ID 5152"
      - "All Windows endpoints and servers, Domain Controllers, Systems with host-based firewalls enabled, Network gateways"
    range: "last 90 days"
    queries:
      - "SEARCH firewall_rule_modification_events | COMPARE with baseline | ALERT on statistical outliers (e.g., manual change, destination is log_collector)"
  - question: "Has an anomalous sequence of events occurred on a host, such as a suspicious login followed by a log clearing event and a drop in telemetry?"
    context: "This question seeks to identify indicator blocking by analyzing the context of surrounding events. A single event might be ambiguous, but a sequence—like a remote login, followed by clearing the event log, and then a sudden silence from the host—provides strong, contextually-validated evidence of a malicious actor trying to cover their tracks."
    answer_sources:
      - "Sysmon Event ID 16"
      - "Windows Security Event ID 1102"
      - "Windows Firewall Event ID 4947"
      - "Windows Security Event ID 5152"
      - "All Windows endpoints and servers, Domain Controllers, Systems with host-based firewalls enabled, Network gateways"
    range: "last 90 days"
    queries:
      - "MODEL event sequences per host | SEARCH for anomalous sequences (e.g., login -> log_clear -> telemetry_drop)"
  - question: "Has a host that is active on the network suddenly stopped sending logs to the central collector?"
    context: "This question addresses the complete cessation of logging from an endpoint, a strong sign that telemetry has been disabled or blocked. By correlating the absence of logs with network flow data showing the host is still active, analysts can confirm the issue is not a network outage or shutdown and escalate it as a potential defense evasion attempt."
    answer_sources:
      - "Zeek conn.log"
      - "SIEM/Log Aggregator ingestion health logs"
      - "Network chokepoints (e.g., core switches, internet gateway), SIEM/Log Aggregator ingestion points, All log-generating endpoints and servers"
    range: "last 90 days"
    queries:
      - "SEARCH for hosts with no logs in last 30min | QUERY network_flow_data for same host IP | IF network_traffic_exists, ALERT"
  - question: "Has the log volume from a specific host dropped significantly below its expected baseline for a sustained period?"
    context: "This question helps detect more subtle forms of indicator blocking where logging isn't stopped entirely but is significantly reduced. By modeling the expected log volume for each host and source, this method can identify statistically significant drops that might indicate a service was stopped, a filter was applied, or specific logs are being suppressed."
    answer_sources:
      - "Zeek conn.log"
      - "SIEM/Log Aggregator ingestion health logs"
      - "Network chokepoints (e.g., core switches, internet gateway), SIEM/Log Aggregator ingestion points, All log-generating endpoints and servers"
    range: "last 90 days"
    queries:
      - "MODEL log volume per host/source using time-series | ALERT if volume drops > 3 std deviations from mean"
  - question: "Has an advanced anomaly detection model identified a sudden, unexpected drop in log ingestion rates from a host, accounting for normal daily or weekly fluctuations?"
    context: "This question employs sophisticated anomaly detection to improve the accuracy of 'silent host' detection. Unsupervised models can automatically learn the complex seasonal patterns of log ingestion for each host, allowing them to detect sudden drops with higher precision and fewer false positives compared to simple thresholding."
    answer_sources:
      - "Zeek conn.log"
      - "SIEM/Log Aggregator ingestion health logs"
      - "Network chokepoints (e.g., core switches, internet gateway), SIEM/Log Aggregator ingestion points, All log-generating endpoints and servers"
    range: "last 90 days"
    queries:
      - "APPLY Isolation Forest or Seasonal-ESD model to log ingestion rates per host | ALERT on detected anomalies indicating a drop"
  - question: "Has a discovery command (like 'tasklist') been executed shortly before a termination command (like 'taskkill') targeting a known security service on the same host?"
    context: "This question looks for a common adversary behavior pattern: discovering which security tools are running and then immediately attempting to disable them. Correlating these two actions within a short time window provides strong evidence of an active, hands-on-keyboard attempt to evade endpoint defenses."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Endpoint workstations, Servers with interactive user logins, Privileged Access Workstations (PAWs)"
    range: "last 90 days"
    queries:
      - "CORRELATE process_events on same host/session | ALERT if 'tasklist' or 'sc query' is followed by 'taskkill' or 'sc stop' on a security service within 5 mins"
  - question: "Has a statistically rare sequence of commands, such as 'tasklist' followed by 'taskkill', been observed for a particular user or across the enterprise?"
    context: "This question uses statistical analysis to find unusual command pairings that might indicate malicious activity. While an administrator might occasionally use 'tasklist' and 'taskkill', the sequence is often rare. Flagging these low-probability sequences, especially when the target is a security tool, helps uncover suspicious behavior that might otherwise be missed."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Endpoint workstations, Servers with interactive user logins, Privileged Access Workstations (PAWs)"
    range: "last 90 days"
    queries:
      - "ANALYZE command sequences using n-grams | CALCULATE conditional probability of ('tasklist', 'taskkill') | ALERT on rare sequences"
  - question: "Has a machine learning model detected an anomalous sequence of process creations for a user session, such as the 'discover-then-kill' pattern?"
    context: "This question applies advanced sequence modeling to learn a user's normal command-line behavior. By training a model to recognize typical sequences of actions, it can flag any significant deviation, such as the unusual pattern of discovering and then killing a process. This provides a powerful way to detect novel or unexpected adversary techniques."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Endpoint workstations, Servers with interactive user logins, Privileged Access Workstations (PAWs)"
    range: "last 90 days"
    queries:
      - "TRAIN LSTM autoencoder on process sequences per session | ALERT when reconstruction error for a new sequence is high"