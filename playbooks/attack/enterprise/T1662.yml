name: T1662: Data Destruction
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: This playbook helps investigate whether an adversary is attempting to disrupt mobile device operations by destroying data. This can manifest as a mobile device executing a high volume of file deletion (`rm`) or application uninstallation (`pm uninstall`) commands in a short time, often from a non-standard process. It can also be indicated by a sudden stop in all network activity or a burst of unusual traffic immediately after a high-volume deletion event, suggesting the device was wiped or is communicating with a C2 server post-attack.
type: technique
related:
  - TA0034: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are there any exact string matches for `pm uninstall` or `rm -rf` in command-line logs originating from suspicious parent processes?
    context: This question aims to identify direct evidence of data destruction commands. Adversaries may use these commands to wipe data from a device. Focusing on commands spawned by non-interactive applications or users with recently escalated privileges helps filter out legitimate administrative actions and pinpoints potentially malicious activity.
    answer_sources:
      - MDM/EDR agent logs detailing command-line arguments
      - Android Logcat process execution events
      - iOS Endpoint Security Framework process events
      - Logs from Managed mobile devices (corporate-owned or BYOD), Mobile Device Management (MDM) servers, and SIEM systems where logs are aggregated.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH command_line_logs FOR 'pm uninstall' OR 'rm -rf' WHERE parent_process is non_interactive_app OR user_privileges recently_escalated

  - question: Has any mobile device shown an anomalous spike in the frequency of `pm uninstall` or `rm` commands compared to its historical baseline?
    context: This question seeks to detect data destruction through statistical anomaly detection. Instead of looking for a single command, it identifies a suspicious volume of such commands. A sudden increase above a device's normal behavior (or the behavior of similar devices) strongly indicates a coordinated, automated attempt to destroy data, differentiating it from routine, isolated uninstalls or file deletions.
    answer_sources:
      - MDM/EDR agent logs detailing command-line arguments
      - Android Logcat process execution events
      - iOS Endpoint Security Framework process events
      - Logs from Managed mobile devices (corporate-owned or BYOD), Mobile Device Management (MDM) servers, and SIEM systems where logs are aggregated.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          1. FOR each device, CALCULATE baseline of 'pm uninstall' and 'rm' command counts per hour over last 30 days.
          2. SEARCH command_line_logs in the last 90 days.
          3. COUNT commands per hour for each device.
          4. ALERT if hourly_count > 99th_percentile_of_baseline.

  - question: Has any mobile device exhibited a sequence of command-line activity that is anomalous according to its behavioral profile, specifically involving deletion-related commands?
    context: This question uses machine learning to identify sophisticated data destruction attempts that may not be caught by simple count-based rules. By analyzing multiple features like command entropy, argument length, and timing, a model can detect deviations from a user's normal behavior. This is effective for flagging bursts of destructive commands that are contextually unusual for that specific user or device.
    answer_sources:
      - MDM/EDR agent logs detailing command-line arguments
      - Android Logcat process execution events
      - iOS Endpoint Security Framework process events
      - Logs from Managed mobile devices (corporate-owned or BYOD), Mobile Device Management (MDM) servers, and SIEM systems where logs are aggregated.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR each device, APPLY anomaly_detection_model(command_logs) trained on features (command_entropy, arg_length, deletion_command_frequency, time_of_day). ALERT if model flags activity as anomalous.

  - question: Following a potential data destruction event, did the affected device communicate with any known command-and-control (C2) servers?
    context: This question helps determine if the data destruction was part of a broader attack orchestrated by an external adversary. Communication with a known C2 server immediately before or after a destructive event is a strong indicator that the device was compromised and the action was malicious, possibly to exfiltrate data or cover tracks.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Logs from Network egress points monitoring mobile device traffic (e.g., corporate Wi-Fi, VPN gateway), DNS resolvers, and network sensor grids.
    range: 5-minute window of the alert
    queries:
      - technology: pseudocode
        query: ON host_destruction_alert, SEARCH network_logs (conn, dns) FOR device_ip WITHIN 5_minutes_of_alert. ALERT if destination_ip OR domain IN known_c2_threat_feed.

  - question: Has any mobile device shown a significant and anomalous spike in DNS query entropy, potentially indicating Domain Generation Algorithm (DGA) activity?
    context: This question aims to detect a specific C2 communication technique, DGA, which malware often uses to find its control server. A sudden increase in the randomness (entropy) of DNS queries suggests the device is trying many algorithmically generated domains. This is a common precursor or concurrent activity to a major attack event like data destruction.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Logs from Network egress points monitoring mobile device traffic (e.g., corporate Wi-Fi, VPN gateway), DNS resolvers, and network sensor grids.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          1. FOR each device, CALCULATE 30-day baseline of DNS query entropy.
          2. SEARCH dns_logs in last 90 days.
          3. CALCULATE moving average of DNS entropy in 1-hour windows.
          4. ALERT if entropy > (baseline + 3 * standard_deviation).

  - question: Has any mobile device's network activity dropped to near-zero, deviating significantly from its predicted 'heartbeat', especially after a potential data destruction event?
    context: This question seeks to confirm the impact of a data destruction attack. A healthy device has a predictable pattern of network traffic. If a device's traffic suddenly and unexpectedly ceases, it strongly suggests the device has been rendered inoperable, bricked, or wiped clean and powered down. Correlating this network silence with a prior host-based alert for destructive commands provides high confidence that a successful data destruction attack occurred.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Logs from Network egress points monitoring mobile device traffic (e.g., corporate Wi-Fi, VPN gateway), DNS resolvers, and network sensor grids.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR each device, APPLY time_series_model(network_traffic_volume) to predict expected 'heartbeat'. ALERT if actual_traffic drops to near_zero AND significantly deviates from prediction, especially after host_destruction_alert.