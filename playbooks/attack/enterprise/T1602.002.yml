name: T1602.002: Network Device Configuration Dump
id: 5a8a1b92-3a3e-4f1e-8a21-7d1a2b3c4d5e
description: This playbook helps investigate whether an adversary is attempting to collect network device configurations. It focuses on identifying several key indicators, including the execution of known network reconnaissance tools correlated with C2 traffic, the use of network management utilities from unauthorized workstations, the transfer of unencrypted files containing sensitive configuration keywords, unauthorized connections to device management ports, and automated fan-out activity where a single host connects to an abnormally large number of network devices in a short period.
type: technique
related:
  - TA0009: Collection
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is a known network configuration dumping tool being executed, followed by a connection to a malicious C2 server?
    context: This question looks for a high-fidelity indicator of compromise. The execution of a process with a file hash matching a known network configuration dumping tool, immediately followed by an outbound network connection from the same host to a known command-and-control (C2) server, strongly suggests that an adversary is actively collecting and exfiltrating sensitive network data.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek dns.log
      - Management jump boxes
      - DNS resolvers
      - Internet gateway firewall
      - Network device management interfaces
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH Windows Events (ID 4688) WHERE process_hash IN (known_dumping_tool_hashes) | JOIN (SEARCH Zeek logs (conn.log, dns.log) WHERE destination_ip OR destination_domain IN (malicious_c2_feeds)) ON source_ip, time_window=5m
  - question: Are network management hosts exhibiting unusually high DNS query entropy, potentially indicating DGA-based C2 communication?
    context: This question attempts to identify covert C2 channels. Adversaries often use Domain Generation Algorithms (DGA) to create a large number of random-looking domain names for C2 communication, making blocklists ineffective. A high entropy score in DNS queries from a sensitive subnet like a network management zone is a strong statistical indicator of this type of activity, which could be used for exfiltrating collected configuration data.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Management jump boxes
      - DNS resolvers
      - Internet gateway firewall
      - Network device management interfaces
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH Zeek dns.log WHERE source_subnet IN (network_management_subnets) | CALCULATE entropy(query_domain) | COMPARE against historical_baseline > 95th_percentile
  - question: Can a machine learning model classify any network connections from management systems as malicious exfiltration?
    context: This question uses a machine learning approach to find complex malicious patterns that rule-based systems might miss. By training a classification model on various network connection features (data volume, reputation, port, etc.), it can predict with high probability if a connection from a sensitive management system is part of a data exfiltration attempt, even if the destination is not on a known threat feed.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Management jump boxes
      - DNS resolvers
      - Internet gateway firewall
      - Network device management interfaces
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: INPUT network_connections_from_management_systems | APPLY ML_Model (Random Forest) | FILTER classification == 'malicious' AND probability > threshold
  - question: Are network management utilities being run from unauthorized workstations to interact with network devices?
    context: This question checks for clear policy violations that indicate internal reconnaissance. The execution of network management utilities (like 'plink.exe', 'tftp.exe') with configuration-related commands (like 'show running-config') from a standard user workstation or server is highly anomalous. It suggests a compromised host is being used to pivot and gather information from network infrastructure.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Zeek conn.log
      - General user workstations
      - Application servers
      - Network device management interfaces
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH Process Events (WinEvent 4688, Sysmon 1) WHERE command_line CONTAINS ('show running-config', 'tftp.exe', etc.) AND source_host NOT IN (authorized_admin_hosts)
  - question: Is there a statistically significant increase in the use of network management utilities on any given host?
    context: This question aims to detect a change in a host's behavior. Every host has a typical role and software profile. A sudden, sharp increase in the execution of network management utilities on a host where it's uncommon is a statistical outlier. This anomaly can indicate that the host has been compromised and is now being used for network-focused malicious activities.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Zeek conn.log
      - General user workstations
      - Application servers
      - Network device management interfaces
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: CALCULATE frequency of network_management_utility_execution per host | COMPARE against host_role_baseline | ALERT if frequency > (mean + 3 * std_dev)
  - question: Can an anomaly detection model identify suspicious command-line executions that differ from normal administrative activity?
    context: This question uses machine learning to find novel or obfuscated malicious commands. By training an anomaly detection model on the structural features of legitimate command-lines (length, character types, keywords), it can identify new or unusual command invocations that do not match any known pattern of legitimate administrative work, pointing to potential adversary action.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Zeek conn.log
      - General user workstations
      - Application servers
      - Network device management interfaces
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: INPUT command_line_logs | APPLY ML_Model (Isolation Forest) on features (length, char_dist, etc.) | FILTER anomaly_score > threshold
  - question: Are there any unencrypted file transfers containing sensitive network configuration keywords?
    context: This question looks for direct evidence of configuration data exfiltration in cleartext. Finding high-confidence keywords such as 'enable secret', 'password', or 'snmp-server community' within a file transferred over an unencrypted protocol like FTP, TFTP, or HTTP is a critical security finding, indicating that sensitive credentials and configuration details are exposed.
    answer_sources:
      - Zeek files.log
      - Zeek ftp.log
      - Zeek http.log
      - Zeek conn.log
      - Network backbone sensors
      - Unencrypted file transfer servers (FTP/TFTP)
      - Core network switches
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH Zeek files.log WHERE protocol IN ('FTP', 'HTTP', 'TFTP') | SCAN file_content for regex ('enable secret', 'password', etc.) | ALERT on match
  - question: Are there any unencrypted files being transferred with an unusually high 'sensitivity score' based on configuration keywords?
    context: This question provides a statistical method to find configuration files that may be partially obfuscated or do not contain high-confidence keywords. By assigning a score based on the frequency of various configuration-related terms, this approach can flag files that are statistically likely to be configuration dumps, even if they don't trigger a simple keyword match.
    answer_sources:
      - Zeek files.log
      - Zeek ftp.log
      - Zeek http.log
      - Zeek conn.log
      - Network backbone sensors
      - Unencrypted file transfer servers (FTP/TFTP)
      - Core network switches
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH Zeek files.log | CALCULATE sensitivity_score based on keyword_frequency in file_content | COMPARE against historical_baseline > 99th_percentile
  - question: Can a machine learning classifier identify file contents as being part of a network device configuration?
    context: This question uses a text classification model to identify configuration data. By training a model on a large corpus of legitimate configuration files and benign text, it can learn to recognize the unique structure, syntax, and keywords of configuration data. This allows it to identify even partial or modified configuration snippets being exfiltrated in file transfers.
    answer_sources:
      - Zeek files.log
      - Zeek ftp.log
      - Zeek http.log
      - Zeek conn.log
      - Network backbone sensors
      - Unencrypted file transfer servers (FTP/TFTP)
      - Core network switches
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: INPUT unencrypted_file_content | APPLY ML_Model (Naive Bayes) | FILTER classification == 'config'
  - question: Are connections being made to network device management ports from unauthorized source IP addresses?
    context: This question enforces access control policies for critical infrastructure. Network device management ports (like SSH, Telnet, SNMP) should only be accessible from a small, well-defined set of administrative hosts. Any connection attempt from an IP address not on this allowlist is a significant security event and may indicate an adversary attempting to gain unauthorized access.
    answer_sources:
      - Zeek conn.log
      - Zeek snmp.log
      - Firewall Logs
      - Network device management interfaces
      - Core network switches
      - Internet gateway
      - Firewall concentrators
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH Network Logs (Zeek, Firewall) WHERE destination_port IN (22, 23, 161) AND destination_ip IN (network_device_range) AND source_ip NOT IN (authorized_management_hosts)
  - question: Is there a statistically unusual number of connections to a network device's management ports?
    context: This question aims to detect anomalous connection patterns like brute-force or scanning activity. By establishing a baseline for the normal number of connections to each device's management ports, a sudden, statistically significant spike in this activity can be detected, alerting security analysts to potential unauthorized access attempts or reconnaissance.
    answer_sources:
      - Zeek conn.log
      - Zeek snmp.log
      - Firewall Logs
      - Network device management interfaces
      - Core network switches
      - Internet gateway
      - Firewall concentrators
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: CALCULATE connection_count per device per hour to management_ports | COMPARE against device_baseline | ALERT if count > (mean + 3 * std_dev)
  - question: Is the volume of data transferred to or from network device management ports significantly different from forecasted seasonal norms?
    context: This question uses time-series analysis to detect bulk data transfers. Normal management sessions involve a predictable amount of data. A full configuration dump, however, results in a much larger data transfer. By forecasting the expected data volume, this method can flag significant deviations that strongly indicate a large-scale data exfiltration event.
    answer_sources:
      - Zeek conn.log
      - Zeek snmp.log
      - Firewall Logs
      - Network device management interfaces
      - Core network switches
      - Internet gateway
      - Firewall concentrators
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: INPUT time_series of data_volume to management_ports | APPLY ML_Model (ARIMA) | FILTER observed_volume outside confidence_interval of forecast
  - question: Is a single source IP connecting to an abnormally large number of distinct network devices in a short time frame?
    context: This question looks for "fan-out" activity, which is characteristic of automated scripts used for widespread reconnaissance or data collection. A single host connecting to a large number of network devices (e.g., >10) in a few minutes is not typical human behavior and, unless it's a known network management tool, is highly indicative of malicious automation.
    answer_sources:
      - Zeek ssh.log
      - Windows Event ID 4624
      - Zeek conn.log
      - RADIUS Authentication Logs
      - RADIUS/TACACS+ authentication servers
      - Management jump boxes
      - Network device management interfaces
      - Domain Controllers
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FROM Zeek conn.log in a 5min window, GROUP BY source_ip | COUNT distinct destination_ip in network_device_range on ports 22, 23 | ALERT if count > 10 AND source_ip NOT IN (monitoring_tools)
  - question: Is any user account or source IP authenticating to a number of devices that is a statistical outlier?
    context: This question establishes a behavioral baseline for user-to-device access. By analyzing authentication logs, it's possible to determine the normal number of devices a user or host connects to. An account that suddenly authenticates to a number of devices far exceeding its own or its peers' baseline (e.g., in the 99th percentile) may be compromised and used for broad internal access.
    answer_sources:
      - Zeek ssh.log
      - Windows Event ID 4624
      - Zeek conn.log
      - RADIUS Authentication Logs
      - RADIUS/TACACS+ authentication servers
      - Management jump boxes
      - Network device management interfaces
      - Domain Controllers
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: CALCULATE distinct_devices_authenticated_to per user per hour | COMPARE against all_user_baseline | ALERT if user_activity > 99th_percentile
  - question: Can clustering algorithms identify anomalous authentication patterns indicative of automated scanning or fan-out activity?
    context: This question uses unsupervised machine learning to distinguish normal administrative access from automated malicious activity. Legitimate access patterns from various admins will form dense clusters. A compromised host or account used to scan or access many devices will not fit into these normal clusters and will be identified by the algorithm as an anomalous outlier or a distinct, sparse cluster.
    answer_sources:
      - Zeek ssh.log
      - Windows Event ID 4624
      - Zeek conn.log
      - RADIUS Authentication Logs
      - RADIUS/TACACS+ authentication servers
      - Management jump boxes
      - Network device management interfaces
      - Domain Controllers
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: INPUT authentication_events | APPLY ML_Model (DBSCAN) on features (source_ip, dest_prefix, user) | FILTER points classified as noise or belonging to anomalous_cluster