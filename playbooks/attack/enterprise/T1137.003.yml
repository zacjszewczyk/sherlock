name: T1137.003: Outlook Forms
id: 59a16f3d-5f3b-4c2e-8a2b-9e7f8d1c0b3a
description: This playbook investigates whether an adversary is maintaining persistence by creating or modifying Outlook Forms. This involves looking for the creation of malicious Outlook Form files (.oft, .fdm), suspicious child processes spawned by outlook.exe, unusual network connections initiated by the Outlook process, and unauthorized modifications to Outlook-related files or registry keys used for persistence.
type: technique
related:
  - TA0003: Persistence
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are newly created or modified Outlook Form files (.oft, .fdm) or network connections from outlook.exe associated with known malicious indicators?
    context: This question aims to detect known threats by matching file hashes of new or modified .oft/.fdm files against a threat intelligence database. It also cross-references network activity from outlook.exe with C2 threat feeds to catch command-and-control communication initiated via a malicious form.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek dns.log
      - User workstations
      - Mail servers (Exchange)
      - Network egress points
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH for file creation events (EID 4663) where filename ends with .oft OR .fdm
          CALCULATE file hash
          MATCH hash against threat intelligence database
          
          SEARCH for process creation events (EID 4688) for outlook.exe
          CORRELATE by IP and timestamp with network connection logs (Zeek conn.log)
          MATCH destination IP/domain against C2 threat intelligence feed
          ALERT on any match
  - question: Is outlook.exe communicating with suspicious domains identified by statistical properties like high entropy or recent registration?
    context: This question focuses on identifying potentially malicious domains that are not yet on threat intelligence lists. By analyzing domain characteristics like name entropy (randomness) and age (via WHOIS), we can flag suspicious domains that adversaries might use for C2 or data exfiltration, especially when associated with Outlook.
    answer_sources:
      - Zeek dns.log
      - User workstations
      - Mail servers (Exchange)
      - Network egress points
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each domain in DNS logs (Zeek dns.log) associated with Outlook clients
          CALCULATE domain name entropy and domain age
          FLAG domains with entropy in top 99th percentile OR age < 30 days
          INVESTIGATE flagged domains and associated network connections
  - question: Is any user's Outlook application exhibiting an anomalous volume of outbound network connections compared to their historical baseline?
    context: This uses a time-series model to detect behavioral anomalies. A sudden, significant spike in network connections from a user's Outlook, deviating from their normal pattern, could indicate that a malicious form is active and communicating with an external server.
    answer_sources:
      - Zeek conn.log
      - User workstations
      - Mail servers (Exchange)
      - Network egress points
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each user
          MODEL historical volume of outbound connections from outlook.exe per hour
          ALERT if current volume significantly exceeds the forecasted baseline
  - question: Is outlook.exe spawning child processes with command-line arguments containing known malicious patterns or obfuscation techniques?
    context: This question seeks to identify common malicious commands executed as child processes of Outlook. Attackers often use encoded PowerShell commands, download strings, or other specific command-line structures to execute payloads, which can be detected with pattern matching.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH for process creation events (EID 4688) where parent process is outlook.exe
          SCAN command-line arguments using regex for patterns like 'powershell -enc', 'IEX(', 'DownloadString', 'mshta.exe javascript:'
          ALERT on any match
  - question: Are there command-line arguments from child processes of outlook.exe that have unusually high entropy, suggesting obfuscation?
    context: High entropy (randomness) in a command-line string is a strong indicator of obfuscation used to hide malicious code. This question helps find suspicious commands by measuring this randomness and flagging significant deviations from the established baseline.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each command line from a child process of outlook.exe
          CALCULATE Shannon entropy of the string
          ESTABLISH baseline mean and standard deviation of entropy scores
          FLAG commands with entropy > 3 standard deviations from the mean
  - question: Can a machine learning model classify command-line arguments from outlook.exe child processes as malicious?
    context: This proposes an advanced, predictive approach. By training a classification model on known benign and malicious command lines, it can learn to identify malicious characteristics beyond simple patterns, providing a more robust detection method for novel attacks.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY pre-trained classification model to command-line arguments of outlook.exe child processes
          GENERATE alerts for arguments classified as malicious with high probability
  - question: Has outlook.exe spawned any child processes that are not on the pre-approved allow-list of legitimate applications?
    context: This question uses an allow-listing security posture. Since Outlook typically spawns a predictable set of child processes (e.g., Word, Excel, browser), any deviation, especially the launch of interpreters like cmd.exe or powershell.exe, is highly suspicious and warrants investigation.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Application servers running Outlook
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MAINTAIN allow-list of legitimate child processes for outlook.exe
          MONITOR process creation events (EID 4688) with parent outlook.exe
          ALERT if child process is not in the allow-list
  - question: Has outlook.exe on any user's machine spawned a child process that is statistically rare for that user or for the entire organization?
    context: This question uses user-specific and enterprise-wide baselining to find anomalies. A process that is rarely or never spawned by Outlook is suspicious. This method can catch threats without a rigid allow-list by adapting to the environment's normal behavior.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Application servers running Outlook
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each user, create a baseline of child process frequencies from outlook.exe over 30 days
          ALERT when a child process is observed that is rare for the user (e.g., <1% frequency) or has never been seen enterprise-wide
  - question: Has an unsupervised machine learning model detected an anomalous process creation event originating from outlook.exe?
    context: This leverages unsupervised learning to identify unusual process creation events without prior labels. By modeling 'normal' behavior based on features like parent/child process names and user context, it can flag any event that falls outside this learned norm as a potential threat.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Application servers running Outlook
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN an unsupervised model (e.g., isolation forest) on known benign process creation events from outlook.exe
          APPLY model to new events to score for abnormality
          ALERT on events scored as outliers
  - question: Is outlook.exe making network connections to destinations that match threat intelligence feeds for malicious infrastructure?
    context: This question directly links network activity to the Outlook process and checks it against known malicious IPs and domains (e.g., C2 servers, newly registered domains). This is a high-fidelity method for detecting when a malicious form is actively communicating with an attacker.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Windows Event ID 4688
      - Network egress points
      - DNS resolvers
      - User workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          CORRELATE outlook.exe process events (EID 4688) with network connection logs (Zeek conn.log) by IP and time
          COMPARE destination IP/domain against threat intelligence feeds
          ALERT on any match
  - question: Is outlook.exe initiating connections to unusual geographic locations or network providers (ASNs) for a given user?
    context: This question focuses on identifying anomalous network destinations based on user behavior. If a user's Outlook suddenly connects to a country or network provider it has never contacted before, it could signify a compromised form communicating with an attacker in an unusual location.
    answer_sources:
      - Zeek conn.log
      - Network egress points
      - DNS resolvers
      - User workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each user, establish a baseline of typical destination countries and ASNs from outlook.exe traffic
          ALERT when a connection is made to a country or ASN not in the user's baseline
  - question: Is the volume of data being sent by any user's Outlook application significantly higher than their predicted daily baseline?
    context: This question aims to detect data exfiltration. A malicious form might attempt to send large amounts of stolen data. By modeling the expected daily data transfer volume for each user, we can flag significant, unexplainable spikes as potential exfiltration events.
    answer_sources:
      - Zeek conn.log
      - Network egress points
      - DNS resolvers
      - User workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each user, train a time-series model on daily data transfer volume (orig_bytes) from outlook.exe
          ALERT if observed volume significantly exceeds the forecasted prediction interval
  - question: Has an unauthorized process modified Outlook Forms-related files or registry keys used for persistence?
    context: This question targets the core persistence mechanism. Adversaries must write to specific files or registry keys to install a malicious form. By monitoring these locations and alerting when a non-standard process (e.g., powershell.exe) makes a change, we can detect the installation attempt itself.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4657
      - Windows Event ID 4688
      - User workstations
      - Registry hives on endpoints
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MONITOR for registry modifications (EID 4657) to 'HKCU\Software\Microsoft\Office\*\Outlook\Forms'
          MONITOR for file writes (EID 4663) to '%APPDATA%\Microsoft\Forms'
          ALERT if the modifying process is not an approved installer or outlook.exe
  - question: Has a statistically rare process been observed modifying Outlook Forms folders or their associated registry keys?
    context: This question uses baselining to find unusual processes interacting with Outlook Form persistence locations. It identifies processes that rarely perform these modifications across the enterprise, which could indicate a novel tool being used by an attacker.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4657
      - Windows Event ID 4688
      - User workstations
      - Registry hives on endpoints
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          ESTABLISH a baseline of processes that legitimately modify Outlook Forms paths/registry keys
          CALCULATE the frequency of each modifying process
          ALERT when a statistically rare process performs a modification
  - question: Has an anomalous sequence of events, such as `outlook.exe -> winword.exe -> powershell.exe -> [registry write]`, led to the modification of an Outlook Form persistence location?
    context: This question analyzes the entire causal chain of events. Attackers often use a series of processes to achieve their goal. By modeling normal sequences and flagging abnormal ones (e.g., a script spawned from Word modifying a key), we can detect sophisticated attack paths.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4657
      - Windows Event ID 4688
      - User workstations
      - Registry hives on endpoints
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL normal event sequences leading to Outlook Form modifications
          ANALYZE new event chains leading to a modification
          ALERT when a new, high-risk sequence is detected