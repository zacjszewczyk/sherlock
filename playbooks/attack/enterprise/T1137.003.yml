name: T1137.003: Outlook Forms
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: This playbook helps investigate whether an adversary is maintaining persistence through malicious Outlook Forms. The investigation focuses on detecting the creation or modification of malicious Outlook Form files (.oft, .fdm), monitoring for suspicious child processes spawned by outlook.exe (especially those with obfuscated command lines or those not on an allow-list), identifying unusual network connections initiated by Outlook to low-reputation or anomalous destinations, and detecting unauthorized modifications to Outlook form files or related registry keys.
type: technique
related:
  - TA0003: Persistence
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has a malicious Outlook Form file (.oft, .fdm) been created, or has Outlook initiated a network connection to a known malicious destination?
    context: This question aims to detect the initial placement of a malicious Outlook Form or its communication with command-and-control (C2) infrastructure. Matching file hashes against threat intelligence databases can identify known malware, while correlating Outlook's network activity with C2 feeds can uncover active compromise and data exfiltration channels established through this persistence mechanism.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek dns.log
      - User workstations
      - Mail servers (Exchange)
      - Network egress points
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          Search for file create events for .oft or .fdm files. Calculate hash and check against threat intelligence.
          Search for network connections from outlook.exe. Correlate with process creation events and check destination against C2 threat intelligence.
  - question: Is Outlook communicating with suspicious domains, such as those with high entropy or that were recently registered?
    context: Adversaries often use algorithmically generated (DGA) or newly registered domains (NRD) for C2 communication to evade blocklists. This question helps identify these suspicious domains by analyzing their statistical properties. High entropy can indicate automation, and newness can suggest a temporary, malicious infrastructure.
    answer_sources:
      - Zeek dns.log
      - User workstations
      - Mail servers (Exchange)
      - Network egress points
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Search DNS logs for domains resolved in conjunction with outlook.exe network activity. Calculate entropy and age. Alert on high-entropy or newly registered domains.
  - question: Is there an anomalous volume of outbound network connections from a user's Outlook application?
    context: A sudden spike in the number of network connections from Outlook can indicate malicious activity, such as a C2 beaconing or data exfiltration. This question uses time-series analysis to model a user's normal behavior and detect significant deviations that warrant investigation, especially when other suspicious indicators are present.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Windows Event ID 4688
      - User workstations
      - Mail servers (Exchange)
      - Network egress points
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Model the time-series of network connection volume from outlook.exe per user. Alert on significant deviations from the forecasted baseline.
  - question: Did Outlook spawn a child process with command-line arguments containing known malicious patterns?
    context: Malicious Outlook Forms often execute code by spawning other processes, like PowerShell or mshta.exe, to download and run payloads. This question looks for specific, high-fidelity indicators of malicious activity within the command-line arguments of these child processes, such as commands for encoded execution, in-memory invocation, or file downloads.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Search process creation events where parent is outlook.exe. Scan command-line arguments for keywords like 'powershell -enc', 'IEX', 'DownloadString', etc. Alert on match.
  - question: Has Outlook spawned a child process with a highly entropic or obfuscated command line?
    context: To evade simple keyword-based detection, adversaries often obfuscate their commands using encoding (like Base64) or other techniques. This results in a command-line string with high character randomness, or entropy. This question aims to detect such obfuscation by calculating the entropy of command-line arguments and flagging significant deviations from the norm.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Search process creation events where parent is outlook.exe. Calculate entropy of command-line arguments. Alert on values significantly above the baseline.
  - question: Does a machine learning model classify a command line spawned by Outlook as malicious?
    context: This question leverages a more advanced, machine learning-based approach to detect malicious command lines. By training a model on various features of known good and bad commands, this method can identify novel or complex malicious commands that might be missed by simpler signature or entropy-based checks.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: For process creation events with parent outlook.exe, apply a trained ML model to the command-line arguments. Alert on high-probability malicious classifications.
  - question: Has Outlook spawned a child process that is not on the organizational allow-list?
    context: In a typical enterprise environment, Outlook spawns a predictable set of child processes (e.g., Office applications, web browsers). This question uses an allow-list approach to detect any deviation from this expected behavior. Spawning of scripting engines or command interpreters like PowerShell or cmd.exe is particularly suspicious and is a common technique for malicious payload execution.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Application servers running Outlook
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Search process creation events where parent is outlook.exe. Compare child process name against an allow-list. Alert on any process not on the list.
  - question: Has Outlook spawned a child process that is rare for a specific user or for the entire organization?
    context: This question moves beyond a static allow-list to a dynamic, statistical baseline of behavior. It identifies anomalies by detecting when Outlook spawns a process that is highly unusual for that particular user or has never been seen before in the environment. This helps to detect targeted attacks or insider threats that might use legitimate but contextually inappropriate tools.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Application servers running Outlook
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Build a baseline of child processes per user from outlook.exe. Alert when a rare or previously unseen child process is spawned.
  - question: Does an unsupervised machine learning model identify the spawning of a child process by Outlook as an anomaly?
    context: This question employs unsupervised machine learning to detect anomalous process creation events without relying on predefined rules or signatures. By learning the multi-dimensional boundary of "normal" activity (considering user, parent/child process, paths, etc.), this approach can flag sophisticated, novel, or subtle attack patterns that other methods might miss.
    answer_sources:
      - Windows Event ID 4688
      - User workstations
      - Application servers running Outlook
      - Virtual Desktop Infrastructure (VDI) instances
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Apply a trained unsupervised ML model (e.g., Isolation Forest) to process creation events from outlook.exe. Alert on events scored as outliers.
  - question: Has Outlook made a network connection to a destination that matches threat intelligence indicators?
    context: This question provides a high-fidelity method for detecting malicious C2 communication by directly linking network connections from the Outlook process to known bad destinations. By correlating endpoint process data with network logs and threat intelligence, analysts can confirm that Outlook is the source of malicious traffic, such as connections to known C2 servers or newly registered domains.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Windows Event ID 4688
      - Network egress points
      - DNS resolvers
      - User workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Correlate outlook.exe process events with network connection logs. Check destination IP/domain against threat intelligence feeds (C2, NRDs). Alert on match.
  - question: Has Outlook initiated a network connection to a geographically anomalous destination for a given user?
    context: Users typically have predictable patterns of communication based on their role and location. A connection from Outlook to a country or network (ASN) where the user has no business connecting can be a strong indicator of compromise. This question helps detect such geographical anomalies by baselining normal user behavior.
    answer_sources:
      - Zeek conn.log
      - Network egress points
      - DNS resolvers
      - User workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Baseline destination countries and ASNs for each user's Outlook traffic. Alert on connections to new or unusual geolocations/ASNs.
  - question: Is there an anomalous amount of data being transferred by a user's Outlook application?
    context: Malicious activity, particularly data exfiltration, can often manifest as an unusually large volume of outbound data. This question uses time-series analysis to model the normal data transfer volume for each user's Outlook and alerts on significant deviations, providing a potential signal for data theft or large payload downloads.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Windows Event ID 4688
      - Network egress points
      - DNS resolvers
      - User workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Model the time-series of data transfer volume from outlook.exe per user. Alert on significant deviations from the forecasted baseline.
  - question: Has an unauthorized process modified Outlook form files or their associated registry keys?
    context: The persistence mechanism relies on modifying specific files and registry keys. This question focuses on detecting who or what is making these changes. By monitoring these critical locations and correlating modifications with the responsible process, analysts can identify unauthorized changes made by non-standard processes like scripting engines, which is a strong indicator of malicious activity.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4657
      - Windows Event ID 4688
      - User workstations
      - Registry hives on endpoints
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Monitor Outlook Forms registry keys and file directories for modifications. Identify the modifying process. Alert if the process is unauthorized (e.g., cmd.exe, powershell.exe).
  - question: Has a statistically rare process modified Outlook form files or registry keys?
    context: Legitimate modifications to Outlook form locations are typically performed by a small, predictable set of processes (e.g., Outlook itself, installers). This question identifies anomalies by baselining which processes normally make these changes and alerting when a process that rarely or never does so is observed. This can uncover malware masquerading as a legitimate tool or the use of living-off-the-land binaries.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4657
      - Windows Event ID 4688
      - User workstations
      - Registry hives on endpoints
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Baseline the processes that modify Outlook Forms locations. Alert when a rare or previously unseen process performs a modification.
  - question: Did an anomalous sequence of processes lead to the modification of Outlook form files or registry keys?
    context: The 'how' is often as important as the 'what'. A legitimate modification might follow a simple process chain, while a malicious one might involve a convoluted sequence (e.g., a user opens a document, which launches a script, which then modifies the registry). This question uses sequence analysis to model normal process execution chains and detect suspicious sequences that indicate a multi-stage attack.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4657
      - Windows Event ID 4688
      - User workstations
      - Registry hives on endpoints
      - User profile directories on file servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: Model the sequence of parent processes leading to Outlook Forms modifications. Alert on anomalous or high-risk sequences.