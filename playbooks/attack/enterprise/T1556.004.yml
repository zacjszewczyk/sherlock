name: T1556.004: Network Device Authentication
id: 5c9e8f1a-3b2d-4c6f-8a9b-7d1e0f2c3a4b
description: This playbook focuses on detecting adversary activity related to the modification of network device authentication for persistence, defense evasion, and credential access. It addresses threats such as the installation of malicious firmware, redirection of authentication traffic to adversary-controlled servers, unauthorized configuration changes, and the exploitation of authentication bypass vulnerabilities. Investigative questions aim to identify anomalous file transfers, suspicious login patterns (e.g., from rare geolocations or using non-standard clients), connections from known malicious infrastructure, and sessions established without proper authentication events, which could indicate a compromised network device.
type: technique
related:
- TA0003: Persistence
- TA0005: Defense Evasion
- TA0006: Credential Access
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Are files being transferred to network devices that match known malicious signatures?
  context: Adversaries may replace legitimate firmware or configuration files on network devices with malicious versions to establish persistence. This question aims to detect this activity by comparing the hash of any file transferred to a network device against a curated list of known malicious file hashes from threat intelligence feeds. A match is a high-fidelity indicator of compromise.
  answer_sources:
  - Zeek files.log
  - Zeek conn.log
  - Zeek tftp.log
  - Zeek ftp.log
  - Network management subnet, data center core switches, internet-facing routers and firewalls, configuration management servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH Zeek files.log
      WHERE destination_ip IN network_device_list
      COMPARE file_hash against malicious_hash_threat_feed
      RETURN matching transfers
- question: Are files with unusually high entropy being transferred to network devices?
  context: Adversaries often pack or encrypt malicious firmware to evade signature-based detection. High entropy (a measure of randomness) is a common characteristic of such files. This question seeks to identify potentially malicious files by baselining the entropy of normal firmware and configuration files and alerting on transfers that are statistical outliers, suggesting obfuscation.
  answer_sources:
  - Zeek files.log
  - Zeek conn.log
  - Zeek tftp.log
  - Zeek ftp.log
  - Network management subnet, data center core switches, internet-facing routers and firewalls, configuration management servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each file in "Zeek files.log" WHERE destination is network_device:
        CALCULATE shannon_entropy(file_content)
        COMPARE entropy against historical_baseline
        ALERT if entropy > 95th_percentile
- question: Is there an anomalous spike in the volume of file transfers to network devices?
  context: While legitimate updates occur, a sudden, large-scale push of files to many network devices outside of a planned maintenance window could indicate an automated attack where an adversary is attempting to compromise multiple devices at once. This question uses time-series analysis to detect significant deviations from normal file transfer volumes.
  answer_sources:
  - Zeek files.log
  - Zeek conn.log
  - Zeek tftp.log
  - Zeek ftp.log
  - Network management subnet, data center core switches, internet-facing routers and firewalls, configuration management servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      AGGREGATE hourly count of file transfers to network_devices
      APPLY time-series anomaly detection model
      ALERT on spikes that are outside of documented maintenance windows
- question: Are network devices attempting to authenticate to unapproved central authentication servers?
  context: Adversaries may modify a network device's configuration to point to an authentication server they control. This allows them to harvest credentials or bypass multi-factor authentication. This question checks for connections on standard authentication ports (RADIUS, TACACS+) to destinations that are not on an approved list of servers.
  answer_sources:
  - Zeek conn.log
  - Zeek radius.log
  - Windows Event ID 5156
  - Authentication servers (RADIUS, TACACS+), network device management interfaces, domain controllers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH Zeek conn.log
      WHERE source_ip IN network_device_list AND destination_port IN (49, 1812, 1813)
      ALERT if destination_ip NOT IN approved_auth_server_list
- question: Are network devices communicating with statistically rare authentication servers?
  context: Instead of a static allow-list, this question identifies potentially malicious authentication servers by baselining all historical authentication destinations for each device. A connection to a server that has been seen very infrequently (or never before) is anomalous and warrants investigation, as it could represent a recently added malicious configuration.
  answer_sources:
  - Zeek conn.log
  - Zeek radius.log
  - Windows Event ID 5156
  - Authentication servers (RADIUS, TACACS+), network device management interfaces, domain controllers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each network_device:
        CALCULATE frequency of all destination_ips on auth_ports over last 30 days
        ALERT on any new connection to a destination_ip in the bottom 5th percentile of frequency
- question: Do any network device authentication traffic patterns appear as outliers in a cluster analysis?
  context: This question uses unsupervised machine learning to define "normal" authentication behavior based on features like destination, port, and data volume. Any connection that does not fit into a well-established cluster is flagged as an outlier. This can help detect novel adversary techniques that don't rely on known indicators.
  answer_sources:
  - Zeek conn.log
  - Zeek radius.log
  - Windows Event ID 5156
  - Authentication servers (RADIUS, TACACS+), network device management interfaces, domain controllers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      INGEST connection metadata (dest_ip, port, protocol, bytes) from network_devices
      APPLY DBSCAN clustering algorithm
      ALERT on any connection classified as a noise point or a new, small cluster
- question: Are network device configurations being modified outside of approved maintenance windows or by unauthorized sources?
  context: Strict change control is critical for network security. This question enforces policy by checking if configuration management sessions (like TFTP, FTP, SCP) occur only during pre-defined time windows and originate from authorized administrator workstations. Any deviation is a direct policy violation and potentially malicious.
  answer_sources:
  - Zeek conn.log
  - Zeek ftp.log
  - Zeek tftp.log
  - Zeek ssh.log
  - Windows Event ID 4624
  - Network management jump boxes, network device management interfaces, configuration management servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH management protocol logs (TFTP, FTP, SCP) for connections to network_devices
      ALERT if connection_time is outside maintenance_window OR source_ip NOT IN admin_ip_list
- question: Is an administrator accessing a network device at a time that is highly unusual for their specific work pattern?
  context: Adversaries using stolen credentials may not adhere to the victim's normal working hours. This question establishes a behavioral baseline for each administrator's login times and days. A login that is a significant statistical outlier (e.g., 3 AM for a 9-to-5 user) is flagged as a potential account compromise.
  answer_sources:
  - Zeek conn.log
  - Zeek ftp.log
  - Zeek tftp.log
  - Zeek ssh.log
  - Windows Event ID 4624
  - Network management jump boxes, network device management interfaces, configuration management servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each new admin login:
        CALCULATE z-score of login_timestamp against user's historical login time distribution
        ALERT if z-score > 3
- question: Does a new administrative session to a network device deviate from a machine learning model of normal sessions?
  context: This question employs a one-class SVM model trained on the features of legitimate administrative sessions (source IP, protocol, time, duration). The model learns the boundary of normal activity. Any new session that falls outside this boundary is classified as an outlier, enabling the detection of novel or sophisticated attacks that might otherwise look legitimate in isolation.
  answer_sources:
  - Zeek conn.log
  - Zeek ftp.log
  - Zeek tftp.log
  - Zeek ssh.log
  - Windows Event ID 4624
  - Network management jump boxes, network device management interfaces, configuration management servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      TRAIN one-class SVM on features of legitimate admin sessions
      FOR each new session:
        CLASSIFY session using the trained model
        ALERT if session is classified as an outlier
- question: Are successful logins to network devices originating from unapproved countries?
  context: If an organization's network administrators operate from a known set of countries, any successful login from outside this set is highly suspicious. This question uses geolocation to enrich login data and enforce geographical access policies, providing a straightforward way to detect potentially compromised credentials being used abroad.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Zeek conn.log
  - VPN concentrators, network management jump boxes, perimeter firewalls
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each successful login in ssh.log or telnet.log:
        ENRICH source_ip with geolocation data
        ALERT if source_country NOT IN approved_country_list
- question: Is an administrator successfully logging in from a statistically rare network or ISP?
  context: Beyond country-level geolocation, the Autonomous System Number (ASN) provides insight into the network or ISP of origin. An administrator typically connects from a limited set of ASNs (office, home ISP, mobile provider). A successful login from a very rare or never-before-seen ASN for that user could indicate session hijacking or credential use from an unusual location.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Zeek conn.log
  - VPN concentrators, network management jump boxes, perimeter firewalls
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each user, maintain baseline of source ASNs for successful logins
      FOR each new successful login:
        ALERT if source_asn is in the bottom 1st percentile of frequency for that user
- question: Does an administrative session to a network device have characteristics that a neural network model deems anomalous?
  context: This question uses a sophisticated autoencoder model to learn the complex, non-linear patterns of normal administrative behavior. When a new session is processed, the model attempts to reconstruct it. A high reconstruction error signifies that the session is highly different from anything seen during training and is therefore anomalous, potentially indicating a compromised account or backdoor access.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Zeek conn.log
  - VPN concentrators, network management jump boxes, perimeter firewalls
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      TRAIN autoencoder neural network on features of normal admin sessions
      FOR each new session:
        CALCULATE reconstruction_error using the model
        ALERT if reconstruction_error is high
- question: Are known malicious IP addresses successfully connecting to network device management ports?
  context: This is a critical defense-in-depth check. While perimeter firewalls should block known malicious IPs, a successful connection indicates a failure in those controls. This question aims to detect such failures by comparing the source IP of successful management connections against high-confidence threat intelligence feeds. An alert here signifies both a potential threat and a gap in perimeter security.
  answer_sources:
  - Zeek conn.log
  - Zeek ssh.log
  - Zeek telnet.log
  - Windows Event ID 4624
  - Perimeter firewalls, internet gateway, network device management interfaces
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH Zeek conn.log for successful connections to network_device_management_ports
      ALERT if source_ip is on CTI_malicious_IP_feed AND source_ip is NOT on an allow-list
- question: Is there a statistical increase in successful connections from known-bad IPs that are bypassing firewall blocks?
  context: A single successful connection from a bad IP might be an anomaly, but a rising trend suggests a systematic failure of blocking controls or a targeted campaign. This question monitors the rate of successful connections from threat-intelligence-flagged IPs to detect when the number of bypasses exceeds a normal threshold, indicating a potential large-scale defense evasion.
  answer_sources:
  - Zeek conn.log
  - Zeek ssh.log
  - Zeek telnet.log
  - Windows Event ID 4624
  - Perimeter firewalls, internet gateway, network device management interfaces
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      MONITOR daily count of successful connections from CTI-flagged IPs to management interfaces
      ALERT if count exceeds 99th percentile of the 90-day baseline
- question: Can a machine learning model identify connections to management interfaces that were likely malicious but not blocked?
  context: This question proactively seeks out defense evasions by using a predictive model. The model is trained on various connection features to estimate the probability of it being malicious. It can then flag connections that were allowed by the firewall but had a high probability of being malicious, identifying threats that rule-based systems may have missed.
  answer_sources:
  - Zeek conn.log
  - Zeek ssh.log
  - Zeek telnet.log
  - Windows Event ID 4624
  - Perimeter firewalls, internet gateway, network device management interfaces
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      TRAIN a classification model on connection features to predict maliciousness
      FOR each allowed connection to a management interface:
        PREDICT probability of maliciousness
        ALERT if probability is high
- question: Are network devices being accessed with SSH clients associated with attack tools?
  context: The SSH client software string exchanged during connection setup can reveal the tool used to connect. Adversaries may use offensive security tools (e.g., Metasploit, Nmap) that have unique client strings. This question checks the client string for every successful SSH connection against a watchlist of known malicious or unauthorized tools.
  answer_sources:
  - Zeek ssh.log
  - Network management subnet, jump boxes, core network devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH Zeek ssh.log for successful authentications to network_devices
      COMPARE the 'client' field against a watchlist of malicious tool strings
      ALERT on any match
- question: Is a statistically rare SSH client being used to access a network device?
  context: Legitimate administrators typically use a small, consistent set of approved SSH clients. The appearance of a new or very rare client string for a successful connection is anomalous. This could indicate an adversary using a custom tool or a compromised workstation with non-standard software installed. This question identifies such outliers based on historical frequency.
  answer_sources:
  - Zeek ssh.log
  - Network management subnet, jump boxes, core network devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      CALCULATE frequency of all SSH client strings over the last 30 days
      FOR each new successful connection:
        ALERT if the client string frequency is < 0.1% or has not been seen before
- question: Does a new SSH client string appear anomalous when analyzed by a machine learning model?
  context: Some malicious tools may try to spoof common SSH client strings. This question uses NLP techniques to create a mathematical representation (vector) of each client string and trains a model to recognize the pattern of legitimate strings. It can detect subtle deviations and spoofing attempts that a simple watchlist might miss, flagging them as outliers.
  answer_sources:
  - Zeek ssh.log
  - Network management subnet, jump boxes, core network devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      VECTORIZE SSH client strings using character-level TF-IDF
      TRAIN one-class SVM on vectors of legitimate client strings
      CLASSIFY new client string vectors and ALERT on outliers
- question: Are administrative sessions to network devices originating from outside the designated management subnet?
  context: Network segmentation is a core security principle. Administrative access should only be allowed from a specific, hardened management subnet or bastion host. This question enforces this policy by alerting on any successful management connection that originates from an IP address not on the authorized list, indicating a policy violation and potential lateral movement.
  answer_sources:
  - Zeek conn.log
  - Zeek ssh.log
  - Zeek telnet.log
  - Network device management interfaces, bastion hosts, internal network segments
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH for successful connections to network_device management interfaces
      ALERT if source_ip is NOT IN authorized_management_subnet_list
- question: Is a network device being managed from a statistically rare source subnet?
  context: Even within an organization, administrative access patterns are often predictable. This question baselines the source subnets for all administrative traffic to each network device. A successful connection from a subnet that rarely or never performs management tasks (e.g., a user workstation subnet instead of a server subnet) is anomalous and could indicate a compromised machine being used as a pivot point.
  answer_sources:
  - Zeek conn.log
  - Zeek ssh.log
  - Zeek telnet.log
  - Network device management interfaces, bastion hosts, internal network segments
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each network device, baseline the historical count of connections by source subnet
      ALERT if a new successful connection originates from a subnet in the bottom 5th percentile of counts
- question: Is the network path of an administrative session anomalous compared to historical paths?
  context: Adversaries may manipulate network routes to intercept or redirect traffic. This question seeks to detect such manipulation by modeling the normal network path (e.g., sequence of routers) for administrative sessions. A session that takes a significantly different path than usual is flagged as anomalous, as it could indicate a compromised device acting as an illicit pivot point.
  answer_sources:
  - Zeek conn.log
  - Zeek ssh.log
  - Zeek telnet.log
  - Network device management interfaces, bastion hosts, internal network segments
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      MODEL legitimate network paths for admin sessions using traceroute or flow data
      TRAIN a sequence model (e.g., LSTM) on these paths
      ALERT if a new session's path is flagged as anomalous by the model
- question: Is a network device initiating outbound C2-like connections immediately after an administrative login?
  context: A common adversary tactic is to log in to a compromised device and then have it establish a connection back to their command and control (C2) server. This question uses a correlation rule to detect this specific sequence: a successful admin login followed within minutes by an outbound connection from that same device on a non-standard port, a strong indicator of post-compromise activity.
  answer_sources:
  - Zeek conn.log
  - Zeek ssh.log
  - Zeek telnet.log
  - Network device interfaces (all), internet gateway, internal scanning targets
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      CORRELATE: (Event A: successful admin login to device X) FOLLOWED BY (Event B: outbound connection from device X to external IP on non-standard C2 port) within 5 minutes
      ALERT on correlation match
- question: Is there an anomalously high volume of outbound data from a network device after an administrative login?
  context: After gaining access, an adversary might exfiltrate sensitive data, such as the device configuration or network routing tables. This question baselines the normal amount of outbound data from each network device and alerts if the volume significantly spikes in the hour following a successful administrative login, suggesting potential data exfiltration.
  answer_sources:
  - Zeek conn.log
  - Zeek ssh.log
  - Zeek telnet.log
  - Network device interfaces (all), internet gateway, internal scanning targets
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each network device, baseline hourly outbound byte count
      AFTER a successful admin login, monitor outbound traffic for the next hour
      ALERT if byte count exceeds 99th percentile of the baseline
- question: Does a network device's outbound traffic pattern change anomalously after an administrative login?
  context: This question uses a time-series model to learn the normal rhythm of a device's outbound connections (e.g., bytes per second, new connections per minute). A significant deviation from this learned pattern immediately after a login could signal adversary activity, such as the device being used to scan the internal network or establish a C2 channel, even if the total data volume isn't large.
  answer_sources:
  - Zeek conn.log
  - Zeek ssh.log
  - Zeek telnet.log
  - Network device interfaces (all), internet gateway, internal scanning targets
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      MODEL normal outbound connection patterns (bytes/sec, conns/min) for each device
      DETECT anomalies in the time-series data
      ALERT if a significant anomaly occurs immediately following a login event
- question: Is there network traffic matching signatures for known network device authentication bypass vulnerabilities?
  context: Adversaries may exploit known vulnerabilities to gain access without valid credentials. This question relies on an Intrusion Detection System (IDS) to identify traffic patterns that match the signatures of these known exploits. An IDS alert for an auth bypass vulnerability targeting a network device is a high-confidence indicator of an active attack attempt.
  answer_sources:
  - Zeek conn.log
  - IDS/IPS alert logs
  - Perimeter firewalls, network device management interfaces, IDS/IPS sensors
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH IDS/IPS logs for alerts with signatures for network device auth bypass exploits
      WHERE destination_ip is in network_device_list
      GENERATE high-severity alert
- question: Is there a sudden spike in IDS alerts for auth bypass exploits against network devices?
  context: A sharp increase in the number of IDS alerts related to network device exploits can indicate a targeted scanning or exploitation campaign against a specific device or the network as a whole. This question establishes a baseline for these types of alerts and flags any statistically significant spike, allowing for early detection of a widespread attack.
  answer_sources:
  - Zeek conn.log
  - IDS/IPS alert logs
  - Perimeter firewalls, network device management interfaces, IDS/IPS sensors
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      MONITOR hourly rate of IDS alerts for network device exploits
      ALERT if the rate exceeds 3 standard deviations above the hourly mean
- question: Can a machine learning model detect zero-day or polymorphic authentication bypass exploits?
  context: Signature-based IDS can miss novel or modified (polymorphic) exploits. This question proposes using a supervised machine learning model trained on the raw network traffic (PCAP) of known exploits. This allows the model to learn the fundamental characteristics of an exploit, enabling it to detect new variations that signatures would miss.
  answer_sources:
  - Zeek conn.log
  - IDS/IPS alert logs
  - Perimeter firewalls, network device management interfaces, IDS/IPS sensors
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      TRAIN a classification model on labeled PCAP data of auth bypass exploits
      DEPLOY model to analyze traffic to management interfaces in near real-time
      ALERT on traffic classified as an exploit
- question: Are default, hardcoded, or known-compromised usernames being used to successfully log in to network devices?
  context: Using default usernames (e.g., 'cisco', 'admin') is a poor security practice and a common target for adversaries. This question checks every successful login against a watchlist of forbidden usernames, including defaults and any credentials known to have been exposed in previous breaches. A successful login with one of these usernames is a critical security failure.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Windows Event ID 4624
  - Network device management interfaces, authentication servers (RADIUS/TACACS+), configuration backups
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH for successful authentications to network_devices
      ALERT if username is in forbidden_username_watchlist
- question: Has a username that has never been seen on a specific network device successfully authenticated?
  context: Each network device typically has a small, stable set of administrative users. The first time a new user successfully logs in to a device is an anomalous event that warrants scrutiny. It could be legitimate (e.g., a new team member), but it could also indicate an adversary using a newly created or stolen account to expand their access.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Windows Event ID 4624
  - Network device management interfaces, authentication servers (RADIUS/TACACS+), configuration backups
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each network device, maintain a list of seen usernames
      ALERT on any successful authentication where the username is not on the device's list
- question: Is a user logging in to a device that is unusual for their role or user group?
  context: This question models user access patterns by grouping users and devices into communities based on their interactions. A login that bridges two normally separate communities (e.g., a user from the 'web development' group logging into a 'core network infrastructure' device) is highly anomalous and could indicate credential misuse or lateral movement.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Windows Event ID 4624
  - Network device management interfaces, authentication servers (RADIUS/TACACS+), configuration backups
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      CREATE a graph of users and the devices they access
      APPLY a community detection algorithm
      ALERT on a successful login that connects two previously disconnected communities
- question: Is there evidence of a long-lived interactive session to a network device that was not preceded by a successful login event?
  context: This is a direct hunt for an authentication bypass. A legitimate session should always show a successful authentication log entry before the network connection is established and maintained. This question uses a correlation rule to find cases where there are failed logins, no successful login, but a long-duration connection is still established, indicating an exploit may have been used.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Zeek conn.log
  - Network device management interfaces, log aggregation server/SIEM
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      CORRELATE for a source/destination pair within 2 minutes:
      (Event A: auth_success=false) AND (NOT Event B: auth_success=true) AND (Event C: conn.log duration > 60s)
      ALERT on match
- question: Is there a source IP connecting to a network device with a very low ratio of successful logins to total sessions?
  context: A legitimate administrator might occasionally fail a login, but their success ratio should be high. An adversary attempting to brute-force or exploit a device may generate many connection sessions with few or no successful logins. This question calculates this success ratio for each connecting IP and alerts if the ratio falls below a threshold, indicating suspicious activity.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Zeek conn.log
  - Network device management interfaces, log aggregation server/SIEM
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each source_ip connecting to a network_device over 1 hour:
        CALCULATE success_ratio = (count of successful_logins) / (count of connection_sessions)
        ALERT if success_ratio < 0.5
- question: Does the sequence of authentication and connection events for a session have a low probability according to a sequence model?
  context: Legitimate sessions follow predictable event sequences (e.g., connection starts, login succeeds, connection ends). This question uses a Hidden Markov Model (HMM) to learn these valid sequences. Any observed sequence of events that the model deems to have a very low probability, such as a connection with no corresponding login events, is flagged as a potential authentication bypass.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Zeek conn.log
  - Network device management interfaces, log aggregation server/SIEM
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      TRAIN a Hidden Markov Model (HMM) on legitimate sequences of session events
      FOR each new observed sequence of events:
        CALCULATE the probability of the sequence using the HMM
        ALERT if probability is below a threshold
- question: Has a successful login occurred from a brand new source IP with zero preceding failed attempts?
  context: When a human user logs in from a new location for the first time, they might mistype their password. A successful login on the very first attempt from a never-before-seen IP is uncharacteristic for a human but is typical for an adversary using a hardcoded backdoor password or a stolen credential from a script. This question specifically hunts for this suspicious pattern.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Zeek conn.log
  - Network device management interfaces, VPN concentrators
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH for successful authentications
      WHERE source_ip has not been seen authenticating before
      AND there are zero failed authentications from that source_ip in the last 24 hours
      ALERT on match
- question: Did a successful login occur with a number of preceding failures that is a statistical outlier for that specific user?
  context: This question adds behavioral context to failed login attempts. Some users consistently mistype their password once, while others never do. A sudden change in this personal pattern—such as a user who is typically perfect having a 'first-try' success from a new location, or a user who is normally sloppy having a long series of failed attempts—is anomalous and could indicate someone other than the legitimate user is attempting to log in.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Zeek conn.log
  - Network device management interfaces, VPN concentrators
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each user, baseline the distribution of failed attempts before a successful login
      ALERT on any successful login where the number of preceding failures is a statistical outlier for that user
- question: Does a Bayesian model indicate a low probability of a login being legitimate based on its characteristics?
  context: This question uses a formal probabilistic model to weigh different pieces of evidence together. It calculates the probability of a login being legitimate given factors like whether the source IP is new and the number of failed attempts. This provides a more nuanced risk score than a simple rule, allowing an analyst to prioritize events where the combined evidence strongly suggests malicious activity.
  answer_sources:
  - Zeek ssh.log
  - Zeek telnet.log
  - Zeek conn.log
  - Network device management interfaces, VPN concentrators
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      USING prior data, build a Bayesian model for P(Legit | Source_Is_New, Num_Fails)
      FOR each new login:
        CALCULATE the probability of it being legitimate
        ALERT if the probability is below a defined threshold