name: "T1213.001: Data from Information Repositories: Confluence"
id: "a3b1c2d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
description: "This playbook helps determine if an adversary is collecting sensitive information from Confluence repositories. It covers various detection methods, including identifying logins from malicious IPs or compromised accounts, detecting anomalous search behavior such as using sensitive keywords or unusually high query volumes, and flagging access from non-standard clients or through automated scripting. The playbook also addresses unusual data access patterns, such as excessive page views, large downloads, access from privileged or dormant accounts, browsing of unpopular pages, and subsequent lateral movement to other systems following suspicious Confluence activity."
type: "technique"
related:
  - "TA0009: Collection"
contributors:
  - "Zachary Szewczyk, Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Is a successful Confluence login associated with a known malicious IP or a flagged user account?"
    context: "This question aims to detect initial access or account compromise by correlating login events with external threat intelligence (malicious IPs) and internal watchlists (compromised accounts). A match provides a strong signal of unauthorized access."
    answer_sources:
      - "Zeek conn.log"
      - "Confluence Access Logs"
      - "Windows Event ID 4624"
      - "Confluence web server"
      - "Network gateway/firewall"
      - "Domain Controllers"
    range: "last 90 days"
    queries:
      - "SEARCH Confluence access logs AND Zeek conn.log FOR successful logins. JOIN on timestamp and IP. IF source_ip IN threat_intel_feed OR username IN user_watchlist, THEN ALERT."
  - question: "Did a Confluence login originate from an unusually rare Autonomous System Number (ASN)?"
    context: "Adversaries may use infrastructure (like cloud providers or VPNs) that is not typically used for legitimate access. Identifying logins from statistically rare ASNs helps uncover these unusual access patterns that could indicate malicious activity."
    answer_sources:
      - "Zeek conn.log"
      - "Confluence Access Logs"
      - "Windows Event ID 4624"
      - "Confluence web server"
      - "Network gateway/firewall"
      - "Domain Controllers"
    range: "last 90 days"
    queries:
      - "FOR each Confluence login, get source_ip_asn. PROFILE frequency of all ASNs over last 30 days. IF login_asn_frequency < 5th_percentile, THEN ALERT."
  - question: "Does a machine learning model classify a Confluence login as highly probable to be malicious?"
    context: "This question uses a machine learning approach to holistically evaluate multiple login features (IP geolocation, ASN, time of day, etc.) to detect complex patterns of malicious behavior that simple rules might miss. A high-risk score indicates a login that deviates significantly from normal, legitimate behavior."
    answer_sources:
      - "Zeek conn.log"
      - "Confluence Access Logs"
      - "Windows Event ID 4624"
      - "Confluence web server"
      - "Network gateway/firewall"
      - "Domain Controllers"
    range: "last 90 days"
    queries:
      - "SCORE new Confluence logins with ML model. FEATURES: ip_geo, asn_rep, time_of_day, user_role. IF predicted_probability > 0.9, THEN ALERT."
  - question: "Did a user search for sensitive keywords within Confluence?"
    context: "This question looks for direct evidence of an adversary's intent to find valuable information. Searching for terms like 'password' or 'api_key' is a strong indicator of reconnaissance or data collection."
    answer_sources:
      - "Confluence Access Logs"
      - "Zeek http.log"
      - "Confluence web server"
      - "Network traffic sensor"
    range: "last 90 days"
    queries:
      - "SEARCH Confluence logs OR Zeek http.log for search events. IF search_query CONTAINS keyword from sensitive_term_list, THEN ALERT."
  - question: "Did a user perform an anomalously high number of searches in Confluence compared to their own baseline?"
    context: "This question aims to detect unusual user behavior. A sudden spike in search activity for a specific user, far exceeding their normal patterns, could indicate that their account is compromised and being used for broad reconnaissance."
    answer_sources:
      - "Confluence Access Logs"
      - "Zeek http.log"
      - "Confluence web server"
      - "Network traffic sensor"
    range: "last 90 days"
    queries:
      - "FOR each user, CALCULATE 30-day baseline (mean, stddev) of hourly search count. CHECK current hour's search count. IF count > (mean + 3 * stddev), THEN ALERT."
  - question: "Is a user's search behavior unfocused or outside of normal topic areas, suggesting exploratory reconnaissance?"
    context: "Legitimate users typically search within specific topics related to their work. This question uses topic modeling (LDA) and entropy to identify users whose search patterns are erratic and span many unrelated topics, a behavior characteristic of an adversary trying to understand the environment and find sensitive data."
    answer_sources:
      - "Confluence Access Logs"
      - "Zeek http.log"
      - "Confluence web server"
      - "Network traffic sensor"
    range: "last 90 days"
    queries:
      - "MODEL Confluence search queries with LDA to create topic clusters. FOR each user session, CALCULATE search term entropy and topic distribution. IF entropy is high OR queries fall outside established topics, THEN ALERT."
  - question: "Is a user accessing Confluence with a User-Agent associated with automated scripting tools?"
    context: "This question helps detect the use of non-standard clients, such as `curl` or `python-requests`, which adversaries often use to automate data exfiltration. Legitimate users almost always access Confluence through a standard web browser."
    answer_sources:
      - "Zeek http.log"
      - "Confluence Access Logs"
      - "Confluence web server"
      - "Network traffic sensor"
    range: "last 90 days"
    queries:
      - "SEARCH Zeek http.log or Confluence access logs for requests to Confluence server. IF user_agent IN scripting_tool_denylist, THEN ALERT."
  - question: "Is a Confluence session using a rare User-Agent or exhibiting unnaturally consistent request timing, suggesting automation?"
    context: "This question identifies two indicators of automation. A rare User-Agent might be a custom tool, while very low variance in request timing (jitter) is a hallmark of a script, unlike the variable pauses of a human user."
    answer_sources:
      - "Zeek http.log"
      - "Confluence Access Logs"
      - "Confluence web server"
      - "Network traffic sensor"
    range: "last 90 days"
    queries:
      - "PROFILE User-Agent frequency over 30 days. IF user_agent_frequency < 0.1%, THEN ALERT. FOR each session, CALCULATE stddev of inter-request time. IF stddev < 50ms, THEN ALERT."
  - question: "Does a user's sequence of actions (API calls) in Confluence deviate from normal workflow patterns?"
    context: "Legitimate users follow predictable workflows when interacting with an application. This question uses a sequence model (like an LSTM) to learn these normal patterns and flag sessions that follow an anomalous sequence of actions, which could indicate a malicious actor's scripted interaction."
    answer_sources:
      - "Zeek http.log"
      - "Confluence Access Logs"
      - "Confluence web server"
      - "Network traffic sensor"
    range: "last 90 days"
    queries:
      - "TRAIN LSTM model on legitimate sequences of API calls. SCORE new user sessions against the model. IF session sequence has high anomaly score, THEN ALERT."
  - question: "Has a user accessed an unusually large number of pages or downloaded an excessive amount of data in a short time?"
    context: "This question uses simple, high-volume thresholds to catch blatant 'smash and grab' data collection attempts. While prone to false positives, it's a straightforward way to detect large-scale data exfiltration."
    answer_sources:
      - "Confluence Access Logs"
      - "Zeek http.log"
      - "Zeek files.log"
      - "Confluence web server"
      - "Network traffic sensor"
    range: "last 90 days"
    queries:
      - "FOR each user, COUNT unique pages and SUM egress bytes in 1-hour window. IF unique_pages > 200 OR egress_bytes > 500MB, THEN ALERT."
  - question: "Has a user's page access or data download volume significantly exceeded their own historical baseline?"
    context: "This question refines the previous one by using a dynamic, per-user baseline instead of a static threshold. This helps to identify anomalous activity relative to the user's own normal behavior, reducing false positives from 'power users' who legitimately have high activity."
    answer_sources:
      - "Confluence Access Logs"
      - "Zeek http.log"
      - "Zeek files.log"
      - "Confluence web server"
      - "Network traffic sensor"
    range: "last 90 days"
    queries:
      - "FOR each user, CALCULATE 30-day baseline (mean, stddev) for hourly page views and downloads. IF current hour's activity > (mean + 3 * stddev), THEN ALERT."
  - question: "Does a user's access behavior place them in an anomalous peer group, or have they suddenly shifted from a low-activity to a high-activity group?"
    context: "This question uses peer group analysis (clustering) to identify anomalies. An account that suddenly behaves like a member of a different, more active group may have been compromised. This method can detect more subtle changes than individual baselining alone."
    answer_sources:
      - "Confluence Access Logs"
      - "Zeek http.log"
      - "Zeek files.log"
      - "Confluence web server"
      - "Network traffic sensor"
    range: "last 90 days"
    queries:
      - "CLUSTER users with DBSCAN based on access features (avg pages, total data, etc.). IDENTIFY users classified as outliers or those who shift from low-activity to high-activity clusters. ALERT on these users."
  - question: "Did a highly privileged account, such as a Domain Admin, access Confluence?"
    context: "This question focuses on high-impact events. The access of a highly privileged account to a data repository like Confluence is often unnecessary for its administrative role and is a significant risk, warranting immediate investigation."
    answer_sources:
      - "Confluence Access Logs"
      - "Windows Event ID 4624"
      - "Active Directory security logs"
      - "Confluence web server"
      - "Domain Controllers"
    range: "last 90 days"
    queries:
      - "MAINTAIN list of privileged accounts. SEARCH Confluence access logs. IF username IN privileged_account_list, THEN ALERT."
  - question: "Did a dormant account suddenly become active on Confluence?"
    context: "Dormant accounts are prime targets for attackers because their activity is not closely monitored. An alert on a long-dormant account suddenly accessing a data store can be an early indicator of compromise."
    answer_sources:
      - "Confluence Access Logs"
      - "Windows Event ID 4624"
      - "Active Directory security logs"
      - "Confluence web server"
      - "Domain Controllers"
    range: "last 90 days"
    queries:
      - "FOR each user login to Confluence, CHECK last_login_timestamp. IF time_since_last_login > 180 days, THEN ALERT."
  - question: "Is a user's first-time access to Confluence statistically unlikely given their role and peer behavior?"
    context: "Not all first-time access is legitimate. This question uses a model to differentiate between expected first-time access (e.g., a new employee in a relevant department) and unexpected access (e.g., an account in a department that never uses Confluence), which could indicate credential misuse."
    answer_sources:
      - "Confluence Access Logs"
      - "Windows Event ID 4624"
      - "Active Directory security logs"
      - "Confluence web server"
      - "Domain Controllers"
    range: "last 90 days"
    queries:
      - "MODEL first-time Confluence access based on user role, department, peer activity. SCORE new first-time access events. IF probability of legitimate access is low, THEN ALERT."
  - question: "Did a user access a Confluence space they are not authorized for, based on data sensitivity and role?"
    context: "This question enforces access control policies at the detection layer. Even if technical permissions allow access, a user accessing a space outside their defined job function (e.g., an HR employee accessing engineering source code) is a significant security event."
    answer_sources:
      - "Confluence Access Logs"
      - "Confluence web server"
    range: "last 90 days"
    queries:
      - "MAINTAIN list of sensitive spaces and authorized groups. FOR each access to a listed space, CHECK if user is in an authorized group. IF NOT, THEN ALERT."
  - question: "Did a user access an unusually high number of 'cold' or unpopular Confluence pages?"
    context: "Adversaries often perform broad, indiscriminate searches, leading them to access old, archived, or obscure pages that legitimate users rarely visit. This question identifies such behavior by flagging access to a large number of these 'cold' pages."
    answer_sources:
      - "Confluence Access Logs"
      - "Confluence web server"
    range: "last 90 days"
    queries:
      - "CALCULATE page popularity over 90 days. IDENTIFY pages in bottom 10th percentile as 'cold'. COUNT access to 'cold' pages per user session. IF count > 20, THEN ALERT."
  - question: "Is a user's access pattern traversing multiple, unrelated 'communities of practice' within Confluence?"
    context: "This question models Confluence as a social and content network. Legitimate users tend to stay within their 'community' (e.g., their department's or project's space). An attacker, however, will likely jump between unrelated communities (e.g., HR, Finance, Engineering) in search of valuable data. Graph analysis can detect this cross-community traversal."
    answer_sources:
      - "Confluence Access Logs"
      - "Confluence web server"
    range: "last 90 days"
    queries:
      - "BUILD graph of users, pages, and access events. IDENTIFY communities using clustering algorithms. IF user access path crosses multiple distinct communities they are not part of, THEN ALERT."
  - question: "After triggering a high-volume Confluence alert, did the same user access a new server for the first time?"
    context: "This question connects suspicious data collection with potential lateral movement. An attacker who has just found credentials or sensitive information in Confluence may immediately use it to access other systems. This stateful, cross-system correlation provides strong evidence of an active attack progression."
    answer_sources:
      - "Confluence Access Logs"
      - "Windows Event ID 4624"
      - "Windows Event ID 4648"
      - "Zeek conn.log"
      - "Confluence web server"
      - "Domain Controllers"
      - "Critical internal servers"
      - "Endpoint devices"
    range: "last 90 days"
    queries:
      - "CORRELATION RULE: ON 'High Volume Confluence' alert for user, BEGIN monitoring user's logons. IF user has successful logon (Type 3) to a server not accessed in last 90 days, THEN ESCALATE ALERT."
  - question: "After triggering a high-risk Confluence alert, did the user log on to a host that is statistically rare for them to access?"
    context: "This question improves upon the previous one by using a statistical baseline of normal host access for each user. It detects not just first-time access, but any access that is rare for that specific user, making the lateral movement detection more sensitive to subtle deviations."
    answer_sources:
      - "Confluence Access Logs"
      - "Windows Event ID 4624"
      - "Windows Event ID 4648"
      - "Zeek conn.log"
      - "Confluence web server"
      - "Domain Controllers"
      - "Critical internal servers"
      - "Endpoint devices"
    range: "last 90 days"
    queries:
      - "PROFILE typical hosts accessed per user. ON high-risk Confluence alert for user, MONITOR subsequent logons. IF logon is to a host statistically rare for that user, THEN ALERT."
  - question: "Did a user perform a sequence of actions across systems that is indicative of a malicious attack chain (e.g., data gathering followed by lateral movement)?"
    context: "This question uses advanced sequence analysis to identify entire attack chains as they happen. Instead of alerting on individual events, it alerts on a sequence of events that, when combined, represent a high-fidelity indicator of attack. This significantly reduces false positives and provides analysts with richer context."
    answer_sources:
      - "Confluence Access Logs"
      - "Windows Event ID 4624"
      - "Windows Event ID 4648"
      - "Zeek conn.log"
      - "Confluence web server"
      - "Domain Controllers"
      - "Critical internal servers"
      - "Endpoint devices"
    range: "last 90 days"
    queries:
      - "MODEL common event sequences using HMM or LSTM. SCORE real-time event chains for users. IF a sequence like [Confluence data access, Rare logon] is detected and has a high anomaly score, THEN ALERT."