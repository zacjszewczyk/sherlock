name: T1011.001: Exfiltration Over Bluetooth
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: This playbook helps answer the question - Is the adversary exfiltrating data over an unauthorized Bluetooth channel? It provides investigative steps to detect various indicators of this technique, including: the execution of known malicious tools or legitimate system utilities like fsquirt.exe for Bluetooth data transfer; anomalous creation of large archives which indicates data staging; the unexpected activation of Bluetooth services on hosts where it is normally disabled; correlated sequences of data staging followed by Bluetooth activity; and network traffic anomalies where a host receives significant internal data but sends minimal data externally, suggesting an alternate exfiltration channel like Bluetooth.
type: technique
related:
- TA0010: Exfiltration
contributors:
- Zachary Szewczyk, Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Have any known malicious tools or scripts capable of Bluetooth data transfer been executed?
  context: This question aims to identify the direct execution of malware specifically designed for Bluetooth exfiltration. By comparing process hashes against a threat intelligence feed of known Bluetooth-capable malware, analysts can detect known threats with high confidence. A match indicates a likely compromise and an active attempt to exfiltrate data via a Bluetooth channel.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - User Workstations and Laptops, especially those of high-value targets
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      SEARCH process_creation_events (event_id:4688 OR event_id:1)
      FOR_EACH event:
        COMPARE event.process_hash WITH threat_intel_feed(bluetooth_malware)
        IF match:
          ALERT high_severity
- question: Are there any rarely seen processes running that have Bluetooth capabilities?
  context: This question seeks to find potentially unknown or custom malware by focusing on statistical rarity. A process that runs on very few machines (low prevalence) but has the technical capability to interact with Bluetooth is highly suspicious. This approach helps uncover novel threats that are not yet in threat intelligence feeds.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - User Workstations and Laptops, especially those of high-value targets
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      PROCESS_LIST = get_all_process_hashes_from_logs()
      PREVALENCE = calculate_prevalence(PROCESS_LIST)
      FOR_EACH process IN PREVALENCE:
        IF process.prevalence < 1st_percentile AND process.imports_bluetooth_functions:
          FLAG for_investigation
- question: Can machine learning models identify suspicious processes that are likely malicious and associated with Bluetooth activity?
  context: This question leverages machine learning to predict the maliciousness of a process based on its intrinsic characteristics. By training a model on known good and bad files, it can score new, unseen processes. A high score, especially when correlated with other Bluetooth-related events, provides a strong signal of a potential threat, even for previously unknown malware.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - User Workstations and Laptops, especially those of high-value targets
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      ON new_process_event:
        METADATA = extract_process_metadata(event)
        SCORE = ml_model.predict(METADATA)
        IF SCORE > high_threshold AND recent_bluetooth_activity_on_host:
          ESCALATE alert
- question: Is fsquirt.exe or PowerShell being used for scripted, non-interactive Bluetooth file transfers?
  context: This question focuses on the misuse of legitimate system utilities for exfiltration. Adversaries may use built-in tools like fsquirt.exe or PowerShell to avoid deploying custom malware. Detecting these tools when run in a non-interactive or scripted manner, especially with arguments indicating file transfer, is key to uncovering this "living off the land" technique.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Windows PowerShell Event ID 4104
  - User Workstations and Laptops
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      SEARCH process_creation (process_name:'fsquirt.exe' OR process_name:'powershell.exe')
      OR powershell_script_block_log (event_id:4104)
      ALERT IF fsquirt.exe has '-send' flag OR parent_process is non-interactive
      ALERT IF powershell contains 'Send-BluetoothFile' and parent_process is non-interactive
- question: Are there anomalous patterns in the usage frequency or command-line arguments of fsquirt.exe or PowerShell?
  context: This question uses statistical analysis to find deviations from normal user behavior. By baselining how often users run fsquirt.exe or PowerShell and the typical complexity of their commands, we can spot outliers. A sudden increase in frequency or unusually complex command-line arguments can indicate malicious scripting or automation.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Windows PowerShell Event ID 4104
  - User Workstations and Laptops
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      FOR_EACH user:
        BASELINE fsquirt_and_powershell_usage(frequency, command_entropy)
        MONITOR for new executions
        IF execution_frequency > 3_std_dev_from_baseline OR command_entropy > 95th_percentile:
          ALERT anomaly
- question: Are there sudden, unexplained spikes in Bluetooth-related commands from legitimate utilities?
  context: This question applies time-series analysis to detect unusual bursts of activity. Malicious activity often occurs in concentrated periods, unlike normal user behavior which is more distributed. Anomaly detection models can learn the normal rhythm of a host's activity and flag sudden spikes in Bluetooth-related commands as suspicious events requiring investigation.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Windows PowerShell Event ID 4104
  - User Workstations and Laptops
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      FOR_EACH host:
        MODEL = train_timeseries_model(bluetooth_command_frequency)
        ON new_command_event:
          IF MODEL.predicts_anomaly(event):
            ALERT spike_in_activity
- question: Are common archiving tools being run from unusual locations or by system accounts?
  context: This question aims to detect the data staging phase of an attack. Adversaries often collect and compress data into an archive file before exfiltration. Running archiving tools like 7-Zip or WinRAR from temporary directories or under a system context is highly irregular and a strong indicator that data is being prepared for removal.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Sysmon Event ID 11
  - Windows Event ID 4663
  - File Servers, User Workstations, and Document Management Systems
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      SEARCH process_creation (process_name IN ['7z.exe', 'rar.exe', 'tar.exe'])
      IF process.path CONTAINS 'Temp' OR process.user IS 'SYSTEM':
        ALERT suspicious_archiving
- question: Has there been an anomalous increase in the number or size of archive files being created on any host?
  context: This question provides a statistical method for detecting data staging. By establishing a baseline for normal file creation behavior on each host, we can identify when an unusual number or volume of archive files (.zip, .rar, etc.) are created in a short period. Such an anomaly suggests a large amount of data is being aggregated, likely for exfiltration.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Sysmon Event ID 11
  - Windows Event ID 4663
  - File Servers, User Workstations, and Document Management Systems
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      FOR_EACH host:
        BASELINE hourly_archive_creation(count, total_size)
        MONITOR file_creation_events (event_id:11)
        IF archive_count_or_size_in_10min_window > 99th_percentile_of_baseline:
          ALERT anomalous_file_creation
- question: Can file creation events be clustered to identify anomalous data staging activity?
  context: This question uses unsupervised machine learning to find unusual patterns of file creation without pre-existing rules. By grouping similar file creation events based on features like path, size, and parent process, a clustering algorithm can isolate outlier events that do not fit into any normal cluster. These outliers represent potentially malicious staging activities.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Sysmon Event ID 11
  - Windows Event ID 4663
  - File Servers, User Workstations, and Document Management Systems
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      EVENTS = get_file_creation_events()
      FEATURES = extract_features(EVENTS)
      CLUSTERS = dbscan_cluster(FEATURES)
      ANOMALIES = find_noise_points(CLUSTERS)
      ALERT on ANOMALIES
- question: Has the Bluetooth service been enabled or a Bluetooth adapter connected on a host where it should be disabled?
  context: This question checks for direct violations of security policy. On servers or specific workstations where Bluetooth is disabled by policy for security reasons, any event showing the service starting or a new Bluetooth device being plugged in is a high-fidelity indicator of a potential breach or misconfiguration that an adversary could exploit.
  answer_sources:
  - Windows Event ID 7036
  - Microsoft-Windows-Kernel-PnP/Configuration Event ID 400
  - Microsoft-Windows-Kernel-PnP/Configuration Event ID 410
  - Sysmon Event ID 13
  - Servers in Datacenters, Critical Workstations, and any host where Bluetooth is disabled by Group Policy
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      SEARCH service_state_change (event_id:7036, service:'bthserv', state:'running')
      OR registry_set (event_id:13, path:'...\\bthserv\\Start', value NOT 4)
      IF host in 'Bluetooth_Disabled_Assets':
        ALERT high_priority
- question: Has a Bluetooth device been connected to a host for the first time?
  context: This question aims to identify the introduction of a potentially unauthorized Bluetooth device. For endpoints that have no history of using Bluetooth, the first-time connection of a Bluetooth adapter is a significant anomaly. This could represent an adversary physically or remotely enabling a new exfiltration channel.
  answer_sources:
  - Windows Event ID 7036
  - Microsoft-Windows-Kernel-PnP/Configuration Event ID 400
  - Microsoft-Windows-Kernel-PnP/Configuration Event ID 410
  - Sysmon Event ID 13
  - Servers in Datacenters, Critical Workstations, and any host where Bluetooth is disabled by Group Policy
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      HOSTS_WITH_NO_BT = find_hosts_with_zero_bluetooth_events_in_90_days()
      SEARCH pnp_events (event_id:400 OR event_id:410) for Bluetooth devices
      IF event.host IN HOSTS_WITH_NO_BT:
        ALERT high_priority_anomaly
- question: Does the current state of the Bluetooth service on any host deviate from its predicted, policy-compliant state?
  context: This question uses a machine learning model to proactively audit security policy compliance. The model learns the expected state (Enabled/Disabled) of the Bluetooth service based on a host's role and configuration. By comparing the model's prediction to the actual state, it can automatically flag hosts that have been altered, potentially by an adversary, to enable Bluetooth against policy.
  answer_sources:
  - Windows Event ID 7036
  - Microsoft-Windows-Kernel-PnP/Configuration Event ID 400
  - Microsoft-Windows-Kernel-PnP/Configuration Event ID 410
  - Sysmon Event ID 13
  - Servers in Datacenters, Critical Workstations, and any host where Bluetooth is disabled by Group Policy
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      FOR_EACH host in inventory:
        FEATURES = get_host_features(host)
        PREDICTED_STATE = ml_model.predict(FEATURES)
        ACTUAL_STATE = get_current_bluetooth_service_state(host)
        IF PREDICTED_STATE != ACTUAL_STATE:
          FLAG for_investigation
- question: Has data staging activity been immediately followed by Bluetooth activity on the same host?
  context: This question uses event correlation to link different stages of an attack. While data staging or Bluetooth usage alone can be benign, their occurrence in a tight sequence is highly indicative of exfiltration. A rule that detects large archive creation followed within minutes by the execution of a Bluetooth file transfer tool provides a high-confidence alert.
  answer_sources:
  - Windows Event ID 4688
  - Windows Event ID 7036
  - Windows Event ID 4663
  - Sysmon Event ID 1
  - Sysmon Event ID 11
  - Executive Laptops and workstations of developers or system administrators
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      CREATE correlation_rule:
        TRIGGER IF 'Data Staging Event' (e.g., rar.exe execution)
        IS FOLLOWED BY 'Bluetooth Activity Event' (e.g., fsquirt.exe execution)
        ON same_host WITHIN 15_minutes
- question: Have any hosts accumulated a high risk score based on a sequence of suspicious events related to data staging and Bluetooth?
  context: This question moves beyond single alerts to a risk-based approach. Instead of alerting on every event, a host's risk score is increased for each suspicious activity. This allows the system to tolerate low-level suspicious events but triggers an alert when multiple events accumulate, indicating a more determined and likely malicious actor.
  answer_sources:
  - Windows Event ID 4688
  - Windows Event ID 7036
  - Windows Event ID 4663
  - Sysmon Event ID 1
  - Sysmon Event ID 11
  - Executive Laptops and workstations of developers or system administrators
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      ON suspicious_event (staging OR bluetooth):
        host.risk_score += event.risk_value
      PERIODICALLY:
        CALCULATE 1-hour_moving_average(host.risk_score)
        IF moving_average > 95th_percentile_threshold:
          ALERT
- question: Are there sequences of events on any host that are highly improbable according to a model trained on normal behavior?
  context: This question uses advanced sequence analysis to detect novel attack patterns. By training a model (like an HMM or RNN) on vast amounts of normal event log data, it learns what "normal" sequences of activity look like. When it observes a new sequence of events that has a very low probability of occurring based on its training, it flags it as a suspicious anomaly, even if the individual events themselves are not malicious.
  answer_sources:
  - Windows Event ID 4688
  - Windows Event ID 7036
  - Windows Event ID 4663
  - Sysmon Event ID 1
  - Sysmon Event ID 11
  - Executive Laptops and workstations of developers or system administrators
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      MODEL = train_sequence_model(benign_event_log_sequences)
      ON new_event_sequence on host:
        PROBABILITY = MODEL.calculate_probability(sequence)
        IF PROBABILITY < very_low_threshold:
          ALERT rare_sequence_detected
- question: Have any hosts received a large amount of internal data without sending a corresponding amount of data to an external network?
  context: This question aims to identify data hoarding that is a precursor to exfiltration over a covert channel. If a host pulls a large amount of data from internal file servers or databases but does not send much data out over the monitored corporate network, it raises the question of where the data went. This pattern strongly suggests an alternate exfiltration channel, such as Bluetooth, is being used.
  answer_sources:
  - Zeek conn.log
  - Windows Event ID 5156
  - Sysmon Event ID 3
  - Internal network segments, DMZ, and connections to high-value data repositories (file servers, databases)
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      SEARCH network_logs in last hour:
        bytes_in = SUM bytes from internal_ips
        bytes_out = SUM bytes to external_ips
        IF bytes_in > 500MB AND bytes_out < 5MB:
          ALERT data_hoarding
- question: Is the ratio of internal data received to external data sent for any host deviating significantly from its baseline?
  context: This question establishes a statistical baseline for a host's normal network behavior to spot anomalies. Every host has a typical ratio of data it consumes internally versus data it sends externally. A sudden, drastic change in this ratio—specifically, a large increase—indicates an abnormal data flow pattern consistent with data hoarding before exfiltration.
  answer_sources:
  - Zeek conn.log
  - Windows Event ID 5156
  - Sysmon Event ID 3
  - Internal network segments, DMZ, and connections to high-value data repositories (file servers, databases)
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      FOR_EACH host:
        BASELINE rolling_average_ratio(bytes_in_internal / bytes_out_external)
        MONITOR hourly ratio
        IF current_ratio > 3_std_dev_from_baseline:
          ALERT anomalous_data_ratio
- question: Does the net-flow volume for any host-to-server connection show a large, anomalous spike in data ingress without a corresponding egress?
  context: This question uses time-series modeling on network flow data to detect abnormal data transfers. A model can learn the typical request-response patterns between a host and a server. An alert is generated when the model observes a large data transfer to the host that isn't followed by an expected outbound transfer within a predicted timeframe, suggesting the data was siphoned off to a covert channel.
  answer_sources:
  - Zeek conn.log
  - Windows Event ID 5156
  - Sysmon Event ID 3
  - Internal network segments, DMZ, and connections to high-value data repositories (file servers, databases)
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      FOR_EACH host_server_pair:
        MODEL = train_timeseries_model(net_flow_volume)
        OBSERVE new net_flow
        IF MODEL.predicts_anomaly(large_ingress_without_egress):
          ALERT anomalous_netflow