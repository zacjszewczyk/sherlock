name: T1578.003: Delete Cloud Instance
id: 9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d
description: This playbook addresses the adversary technique of deleting cloud instances to evade detection. It provides investigative steps to identify malicious deletions by analyzing various indicators. These include instance deletions originating from anomalous IP addresses (known IOCs, geographically or organizationally unusual locations), deletions executed with suspicious User-Agent strings (known malicious tools, not on an allow-list, or statistically rare), and deletions of instances with unusual lifecycles, such as those deleted shortly after creation by the same user. The playbook also covers the deletion of critical or long-running production instances by unauthorized users or outside approved change windows, and mass deletion events where a single actor deletes an abnormally high number of instances in a short period.
type: technique
related:
  - TA0005: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Was a cloud instance deletion initiated from an IP address known to be malicious?
    context: This question aims to identify instance deletions originating from IP addresses associated with known malicious activity, such as command and control servers, TOR exit nodes, or anonymizing proxies. An adversary might use compromised infrastructure to hide their true location when deleting resources to cover their tracks. A match against a threat intelligence feed is a strong indicator of malicious intent.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Zeek conn.log
      - Windows Security Event ID 5156
      - Cloud Management Plane
      - Identity and Access Management (IAM) Service
      - Internet Gateway/VPC Flow Logs
      - Threat Intelligence Platform
      - Administrator Workstations
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | JOIN source_ip WITH threat_intelligence_feed ON ip_address | WHERE is_match = true
  - question: Did a cloud instance deletion originate from a geographically or network-wise anomalous location for the acting user or role?
    context: This question seeks to uncover deletions coming from locations that are unusual for a specific user or role. Legitimate administrators typically operate from predictable geographic regions and networks (ASNs). A deletion command from a rare or never-before-seen location could indicate a compromised account being used by an adversary from a different part of the world.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Zeek conn.log
      - Windows Security Event ID 5156
      - Cloud Management Plane
      - Identity and Access Management (IAM) Service
      - Internet Gateway/VPC Flow Logs
      - Threat Intelligence Platform
      - Administrator Workstations
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | LOOKUP user_location_baseline ON user | CALCULATE rarity_score(source_country, source_asn) | WHERE rarity_score < 0.01
  - question: Does an instance deletion event exhibit a combination of anomalous characteristics when analyzed by a machine learning model?
    context: This question uses a machine learning model to detect subtle or complex anomalies that might not be obvious from a single data point. The model considers multiple features simultaneously, such as the rarity of the source IP and ASN, the time of day, user privilege level, and MFA status, to identify deletions that deviate significantly from established normal behavior.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Zeek conn.log
      - Windows Security Event ID 5156
      - Cloud Management Plane
      - Identity and Access Management (IAM) Service
      - Internet Gateway/VPC Flow Logs
      - Threat Intelligence Platform
      - Administrator Workstations
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | ENRICH with geo_rarity, asn_rarity, time_of_day_anomaly, privilege_level, mfa_status | SCORE with anomaly_detection_model | WHERE anomaly_score > threshold
  - question: Was a cloud instance deleted using a tool with a User-Agent string that is either explicitly disallowed or known to be malicious?
    context: This question checks the `userAgent` of the tool used to perform the deletion against organizational policies and threat intelligence. Adversaries may use custom or known hacking tools which have distinct User-Agent strings. Conversely, legitimate administration is often done with a limited set of approved tools. A mismatch against an allow-list or a match against a deny-list can indicate unauthorized activity.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Zeek http.log
      - Windows Security Event ID 4688
      - Cloud Management Plane
      - CI/CD Pipeline Servers
      - Administrator Workstations
      - Proxy and Egress Firewalls
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | CHECK user_agent AGAINST allow_list AND deny_list | WHERE user_agent NOT IN allow_list OR user_agent IN deny_list
  - question: Was a cloud instance deleted using a tool with a User-Agent string that is statistically rare for the executing user or the organization?
    context: This question identifies deletions performed with tools that are unusual for a specific user or role. Even if a tool isn't explicitly malicious, its rare usage by a particular administrator could signal a compromised account or an employee using an unsanctioned tool. It establishes a behavioral baseline for tool usage and flags deviations.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Zeek http.log
      - Windows Security Event ID 4688
      - Cloud Management Plane
      - CI/CD Pipeline Servers
      - Administrator Workstations
      - Proxy and Egress Firewalls
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | LOOKUP user_agent_baseline ON user | CALCULATE rarity_score(user_agent) | WHERE rarity_score < 0.02
  - question: Does the User-Agent string from an instance deletion belong to an anomalous cluster of tools not typically used within the organization?
    context: This question uses machine learning to find structurally unusual User-Agent strings. By converting strings into numerical vectors and clustering them, the analysis can identify outliers that don't conform to the patterns of common, legitimate tools. This can catch novel or obfuscated User-Agents that might evade simple string matching or frequency analysis.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Zeek http.log
      - Windows Security Event ID 4688
      - Cloud Management Plane
      - CI/CD Pipeline Servers
      - Administrator Workstations
      - Proxy and Egress Firewalls
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | VECTORIZE user_agent | CLUSTER with DBSCAN | WHERE cluster = 'noise'
  - question: Was a cloud instance deleted by its creator very shortly after it was launched?
    context: This question looks for 'flash' instances that are created and destroyed in an unusually short time by the same actor. While this can be normal for some automated tests, an adversary might do this to quickly run a payload and then remove the evidence. An alert based on a short, fixed lifespan (e.g., under 15 minutes) can be a simple but effective indicator of this behavior, especially when filtering out known automation accounts.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Cloud Management Plane
      - Virtual Private Cloud (VPC)
      - Cloud Asset Inventory Database (CMDB)
      - Cloud orchestration and automation platforms
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | CORRELATE with creation_logs ON instance_id | CALCULATE lifespan = deletion_time - creation_time | WHERE deletion_user = creation_user AND lifespan < '15 minutes' AND user NOT IN automation_accounts
  - question: Was a cloud instance deleted after a lifespan that is a statistical outlier compared to similar instances?
    context: This question compares an instance's lifespan to the historical lifespans of similar instances (e.g., same type, image, or project tag). Different types of instances have different expected lifecycles. A web server might run for months, while a build agent might only run for an hour. A significant deviation from the norm for its group (e.g., a lifespan in the bottom 5th percentile) suggests its termination was premature and potentially malicious.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Cloud Management Plane
      - Virtual Private Cloud (VPC)
      - Cloud Asset Inventory Database (CMDB)
      - Cloud orchestration and automation platforms
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | CORRELATE with creation_logs ON instance_id | CALCULATE lifespan | LOOKUP lifespan_distribution ON instance_group(type, image, tags) | WHERE lifespan_percentile < 5
  - question: Based on a probabilistic model of instance lifecycles, was the observed lifespan of a deleted instance extremely unlikely?
    context: This question applies a formal statistical model (like a Weibull distribution, often used for lifetime analysis) to the lifecycles of instances. By calculating the probability (p-value) of observing a lifespan as short as the one in question, it provides a rigorous statistical measure of how anomalous the deletion is. A very low p-value indicates the event is a significant outlier from expected behavior.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Cloud Management Plane
      - Virtual Private Cloud (VPC)
      - Cloud Asset Inventory Database (CMDB)
      - Cloud orchestration and automation platforms
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | CORRELATE with creation_logs ON instance_id | CALCULATE lifespan | APPLY lifecycle_model(lifespan) to get p_value | WHERE p_value < 0.01
  - question: Was a critical or production instance deleted by an unauthorized user or outside of a scheduled change window?
    context: This question enforces policy by checking if a high-value asset (identified by tags like 'production' or 'critical') was deleted by someone without the proper permissions or outside of an approved maintenance period. This is a direct check for a policy violation and can be a strong indicator of either a malicious act or a serious operational mistake.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - CMDB/Asset Inventory
      - Change Management System Logs
      - Production Environment VPCs
      - Cloud Asset Inventory Database (CMDB)
      - IT Service Management (ITSM) Platform
      - Identity and Access Management (IAM) Service
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | ENRICH with instance_tags, user_groups, change_windows | WHERE (instance_tags.environment = 'production' OR instance_tags.criticality = 'high') AND (user NOT IN 'AdminGroup' OR timestamp NOT IN change_window)
  - question: Was a deleted instance one of the longest-running, most stable assets in the environment?
    context: This question identifies the deletion of instances that have been running for a very long time. Long uptime often correlates with stability and importance. The unexpected deletion of such an asset is highly suspicious and could indicate an adversary is targeting key infrastructure. This method provides a dynamic way to identify critical assets without relying solely on static tags.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - CMDB/Asset Inventory
      - Change Management System Logs
      - Production Environment VPCs
      - Cloud Asset Inventory Database (CMDB)
      - IT Service Management (ITSM) Platform
      - Identity and Access Management (IAM) Service
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | LOOKUP instance_uptime_percentile | WHERE uptime_percentile > 90
  - question: Does a machine learning model, trained on various contextual features, classify an instance deletion as 'unauthorized'?
    context: This question uses a supervised machine learning model to make a holistic judgment about whether a deletion is authorized. By training on features like actor permissions, time of day, change window status, and instance criticality, the model learns the complex patterns of legitimate vs. illegitimate deletions and can flag suspicious events with a calculated confidence score.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - CMDB/Asset Inventory
      - Change Management System Logs
      - Production Environment VPCs
      - Cloud Asset Inventory Database (CMDB)
      - IT Service Management (ITSM) Platform
      - Identity and Access Management (IAM) Service
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | ENRICH with features (permissions, time, tags, etc.) | SCORE with classification_model | WHERE prediction = 'unauthorized' and confidence > 0.9
  - question: Did a single user or role delete an unusually large number of instances within a short time window (e.g., more than 20 in 10 minutes)?
    context: This question seeks to identify mass deletion events using a simple, static threshold. An adversary with broad permissions might attempt to cause maximum disruption by deleting many instances at once. This query provides a quick, first-pass detection for this type of 'smash and grab' destructive activity, while attempting to filter out noisy automation.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Cloud Management Plane
      - Identity and Access Management (IAM) Service
      - Billing and Cost Management Dashboard
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | TIME_WINDOW 10m | COUNT distinct instance_id BY user | WHERE count > 20
  - question: Did a user or role's rate of instance deletions significantly spike above their own historical baseline?
    context: This question detects mass deletions by comparing a user's recent activity to their own past behavior. Instead of a single static threshold for everyone, this method creates a dynamic baseline for each user. A high Z-score (e.g., >3.5) indicates that the current rate of deletions is multiple standard deviations above their personal average, making it a statistically significant anomaly for that specific user.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Cloud Management Plane
      - Identity and Access Management (IAM) Service
      - Billing and Cost Management Dashboard
    range: last 90 days
    queries:
      - language: pseudocode
        query: SEARCH cloud_deletion_logs | CALCULATE deletions_per_hour BY user | COMPARE to user_baseline (mean, stddev) to get z_score | WHERE z_score > 3.5
  - question: Did the overall rate of instance deletions across the entire organization spike to a level considered anomalous by a time series model?
    context: This question looks for large-scale destructive events by analyzing the global, organization-wide rate of instance deletions. A time series model can learn the normal rhythm of deletions, including daily and weekly cycles (e.g., lower activity on weekends). It can then flag spikes that are unexpected, even if they are caused by multiple actors, pointing to a coordinated or widespread attack.
    answer_sources:
      - AWS CloudTrail
      - Azure Activity Logs
      - Google Cloud Audit Logs
      - Cloud Management Plane
      - Identity and Access Management (IAM) Service
      - Billing and Cost Management Dashboard
    range: last 90 days
    queries:
      - language: pseudocode
        query: AGGREGATE cloud_deletion_logs by minute | APPLY time_series_anomaly_model | WHERE is_anomaly = true