name: T1589.003: Employee Names
id: e3a1b4d0-5f6a-4b7c-8d9e-0f1a2b3c4d5e
description: This playbook helps determine if an adversary is attempting to gather employee names for targeting. This can manifest as web scraping of public-facing company pages (e.g., 'About Us', 'Team'), user enumeration and password spraying attacks against authentication services, or anomalous internal access to employee data repositories by a potentially compromised account. The goal is to detect various methods of reconnaissance focused on collecting employee information.
type: technique
related:
  - TA0043: Reconnaissance
contributors:
  - Zachary Szewczyk
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is a known malicious IP or an IP using a common scraping tool attempting to access web pages that list employee names?
    context: This question identifies blatant reconnaissance attempts by checking if requests to sensitive pages (like 'About Us' or 'Team') originate from IPs on threat intelligence lists or use user-agents associated with automated scraping tools. A positive match is a strong indicator of initial information gathering.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - Zeek notice.log
      - Internet-facing web servers, Network perimeter firewalls/gateways, Web Application Firewalls (WAFs)
    range: last 90 days
    queries:
      - "Pseudocode: JOIN http_logs with conn_logs ON uid. FILTER for URIs containing '/about', '/team', '/contact'. ALERT if source_ip is in threat_intel_feed OR user_agent matches scraping_tool_list."
  - question: Has any single external IP address shown an unusually high rate of requests to pages containing employee information compared to a historical baseline?
    context: This question aims to detect web scraping behavior by identifying statistical outliers. By establishing a baseline of normal traffic patterns (e.g., the 95th percentile of requests per hour), it can flag a source IP making an abnormally high number of requests to employee-related pages, which is a common tactic for harvesting data.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - Zeek notice.log
      - Internet-facing web servers, Network perimeter firewalls/gateways, Web Application Firewalls (WAFs)
    range: last 90 days
    queries:
      - "Pseudocode: For URIs like '/team', '/about', CALCULATE 95th_percentile_requests_per_hour_per_ip over last 30 days. AGGREGATE current requests per hour per source_ip. ALERT if current_requests > 95th_percentile_baseline."
  - question: Is the overall request volume to employee-related web pages experiencing a statistically significant and sustained surge that cannot be explained by normal daily or weekly patterns?
    context: This question uses a more sophisticated time-series model to detect anomalous traffic spikes that simpler thresholding might miss. By forecasting expected traffic volume with confidence intervals, it can identify coordinated or distributed scraping campaigns that cause a sustained deviation from the norm, indicating a potential reconnaissance effort.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - Zeek notice.log
      - Internet-facing web servers, Network perimeter firewalls/gateways, Web Application Firewalls (WAFs)
    range: last 90 days
    queries:
      - "Pseudocode: TRAIN time_series_model on request volume to employee pages. FORECAST expected volume and confidence_interval. ALERT if observed_volume > upper_confidence_interval for a sustained period (e.g., 5 mins)."
  - question: Is a single external IP address rapidly attempting to log in with many different usernames, indicating a user enumeration or password guessing attack?
    context: This question identifies brute-force or enumeration attacks by setting a high-frequency threshold. An attacker trying to discover valid usernames will often trigger a large number of failed logins against many accounts from a single source in a short time. This rule provides a clear signal of such automated attempts.
    answer_sources:
      - Zeek http.log
      - Windows Event ID 4625
      - Authentication servers (e.g., ADFS), Public-facing application servers, Web Application Firewalls (WAFs)
    range: last 90 days
    queries:
      - "Pseudocode: From a single source_ip, COUNT distinct usernames from failed_logins (Event 4625) in a 5-minute window. ALERT if failed_login_count > 20 AND distinct_username_count >= 10."
  - question: Are the usernames being used in failed login attempts from a single source programmatically generated or lexically similar, suggesting an automated enumeration script?
    context: This question looks for evidence of automated username generation. Attackers often use scripts that create usernames based on a common pattern (e.g., 'jsmith', 'j.smith', 'john.smith'). Low Levenshtein distance (high similarity) between usernames or low character entropy (less randomness) are strong indicators that the usernames are not being typed by a human but generated by a tool.
    answer_sources:
      - Zeek http.log
      - Windows Event ID 4625
      - Authentication servers (e.g., ADFS), Public-facing application servers, Web Application Firewalls (WAFs)
    range: last 90 days
    queries:
      - "Pseudocode: For a source_ip, gather attempted usernames from failed logins in a 1-hour window. CALCULATE avg_levenshtein_distance and shannon_entropy. ALERT if avg_distance is low OR entropy is low."
  - question: Does the behavior of a login session from an external source appear anomalous when compared to the typical behavior of benign users?
    context: This question uses machine learning to perform holistic session analysis, moving beyond simple metrics. By modeling features like request rate, username diversity, and login failure ratios, an isolation forest can identify outlier sessions that represent malicious activity (like enumeration) which might not trigger individual threshold-based rules but look highly suspicious when viewed in combination.
    answer_sources:
      - Zeek http.log
      - Windows Event ID 4625
      - Authentication servers (e.g., ADFS), Public-facing application servers, Web Application Firewalls (WAFs)
    range: last 90 days
    queries:
      - "Pseudocode: TRAIN isolation_forest_model on session features (request_rate, username_count, fail/success_ratio). APPLY model to new sessions. ALERT on sessions flagged as anomalous."
  - question: Has an IP address that recently conducted a broad password spraying or enumeration attack successfully authenticated to an account?
    context: This question is critical for detecting the successful culmination of a password spray or brute-force attack. An attacker tries many usernames, fails repeatedly, and then finally succeeds with one. Correlating a single success with a history of many recent failures from the same IP is a high-confidence indicator of a compromised account.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Zeek conn.log
      - Domain Controllers, Authentication servers (e.g., ADFS, RADIUS), Cloud identity providers (e.g., Azure AD)
    range: last 90 days
    queries:
      - "Pseudocode: ON successful_login (Event 4624), CHECK if source_ip has > 10 failed_logins (Event 4625) against other accounts in the last 24 hours. IF TRUE, ALERT."
  - question: Is an external IP address generating a large number of failed logins across many different user accounts, but with only a few attempts per account?
    context: This question specifically targets password spraying attacks. Unlike brute-force attacks which try many passwords for one account, password spraying tries one or a few common passwords (e.g., 'Fall2025!') against many different accounts. This behavior manifests as a high count of unique failed usernames from one IP, but a low failure count for each of those usernames.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Zeek conn.log
      - Domain Controllers, Authentication servers (e.g., ADFS, RADIUS), Cloud identity providers (e.g., Azure AD)
    range: last 90 days
    queries:
      - "Pseudocode: For each source_ip in a 1-hour window, COUNT unique usernames from failed logins. ALERT if unique_username_count > baseline_threshold AND avg_failures_per_username is low (e.g., < 3)."
  - question: Is there a targeted password attack occurring against a specific department or user group within the organization?
    context: This question seeks to identify targeted attacks by leveraging organizational structure. Attackers may target a specific team (e.g., Finance, Engineering). By grouping users into peer groups based on Active Directory memberships, we can detect if an unusual number of users from a single group are simultaneously experiencing login failures from the same source, indicating a focused attack.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Zeek conn.log
      - Domain Controllers, Authentication servers (e.g., ADFS, RADIUS), Cloud identity providers (e.g., Azure AD)
    range: last 90 days
    queries:
      - "Pseudocode: CLUSTER users into peer groups (e.g., by AD group). MONITOR failed login rates per peer group. ALERT if a peer group sees an anomalous spike in failed logins from a common source_ip."
  - question: Is a known web scraping tool or script making a high volume of requests to a specific directory on our web servers?
    context: This is a straightforward check for common, noisy scraping tools. Many automated tools and libraries use distinctive User-Agent strings. Identifying these strings in combination with a high request rate is a simple but effective way to detect unsophisticated scraping activity.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Internet-facing web servers, Public API gateways, Web Application Firewalls (WAFs)
    range: last 90 days
    queries:
      - "Pseudocode: FILTER http_logs for user_agents containing 'Scrapy', 'python-requests', etc. For matching agents, COUNT requests in a 10-min window. ALERT if count > 100 to a common directory."
  - question: Is any single web session exhibiting a combination of anomalous characteristics, such as an extremely high number of requests, unusually large data transfer, and systematic directory exploration?
    context: This question hunts for more advanced or customized scrapers by looking at a combination of session behaviors. A malicious scraper often makes many requests, downloads a lot of data, and accesses URIs in a non-human, predictable way (low URI entropy). A session that is a statistical outlier in multiple of these dimensions is highly suspect.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Internet-facing web servers, Public API gateways, Web Application Firewalls (WAFs)
    range: last 90 days
    queries:
      - "Pseudocode: For each web session, CALCULATE request_count, total_response_bytes, and uri_entropy. ESTABLISH 98th percentile baselines. ALERT if a session exceeds the baseline for at least two metrics."
  - question: Can a machine learning model, trained on known session behaviors, classify a new web session as a malicious scraper?
    context: This question represents a mature detection capability, using a supervised machine learning model to classify web traffic. By training a classifier on labeled examples of human, good bot (e.g., search engine crawlers), and bad bot traffic, the model can learn subtle patterns and automatically flag new, malicious sessions with high accuracy.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Internet-facing web servers, Public API gateways, Web Application Firewalls (WAFs)
    range: last 90 days
    queries:
      - "Pseudocode: TRAIN classifier (e.g., Random Forest) on labeled session data. Features include inter-request timing, POST/GET ratio, user-agent. APPLY model to classify new sessions from external IPs. ALERT on 'malicious' classification."
  - question: Has a user account without a legitimate business need accessed highly sensitive employee data repositories like HR file shares or personnel directories?
    context: This question uses an access control and 'honeytoken' approach. By defining which assets are most sensitive and which user groups should have access, it creates a high-fidelity alert for policy violations. Any access from an unauthorized user is an immediate red flag, potentially indicating a compromised account being used for internal reconnaissance.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Windows Event ID 4663
      - Windows Event ID 4624
      - Internal SharePoint/intranet sites, Human Resources application servers, File servers hosting employee records, Domain Controllers
    range: last 90 days
    queries:
      - "Pseudocode: DEFINE watchlist of sensitive file paths/URIs. ENABLE object access auditing (Event 4663). ON access to watchlist item, CHECK if user is in authorized AD group. IF NOT, ALERT."
  - question: Is a user suddenly accessing a significantly larger number of internal employee records or profiles than they normally do?
    context: This question focuses on detecting anomalous behavior at the individual user level. Every user has a typical pattern of resource access. By creating a personalized baseline for each user, this method can detect when an account (potentially compromised) suddenly begins accessing an abnormally high number of employee records, indicating data gathering.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Windows Event ID 4663
      - Windows Event ID 4624
      - Internal SharePoint/intranet sites, Human Resources application servers, File servers hosting employee records, Domain Controllers
    range: last 90 days
    queries:
      - "Pseudocode: For each user, CALCULATE a 30-day baseline (e.g., 99th percentile) of unique employee records accessed per day. ALERT if a user's daily count exceeds their personal baseline."
  - question: Does a user's overall activity pattern, including logins, file access, and network traffic, deviate significantly from their own established normal behavior?
    context: This question leverages advanced User and Entity Behavior Analytics (UEBA). An autoencoder learns the 'normal' multi-dimensional behavior of a user. When a compromised account is used for reconnaissance, its activity pattern (e.g., unusual logon times combined with high file access) will differ from the norm. The model will fail to reconstruct this new, anomalous behavior, resulting in a high reconstruction error and a high-fidelity alert.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Windows Event ID 4663
      - Windows Event ID 4624
      - Internal SharePoint/intranet sites, Human Resources application servers, File servers hosting employee records, Domain Controllers
    range: last 90 days
    queries:
      - "Pseudocode: TRAIN a UEBA autoencoder model on user activity vectors (logon counts, file access, network volume). For new activity, CALCULATE reconstruction error. ALERT if error is anomalously high."