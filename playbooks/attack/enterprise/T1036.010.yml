name: T1036.010: Masquerade Account Name
id: 42c8b8f0-1e5a-4e2b-9d4f-5e8c1a9f0b3d
description: This playbook helps investigate whether an adversary is attempting to evade defenses by masquerading account names. This involves detecting the creation of user accounts with names that are on curated malicious lists, exhibit unusual randomness (entropy), or are classified as malicious by machine learning models. It also looks for accounts whose names mimic administrative or service account patterns but are created by unauthorized users or at anomalous times. Further, it identifies sophisticated attempts using non-standard characters (homoglyphs) or minor misspellings (typosquatting) to visually resemble existing high-privilege accounts. Finally, it correlates account creation with immediate post-creation activity, such as rapid privilege escalation or anomalous network behavior, to identify accounts that are created and immediately used for malicious purposes.
type: technique
related:
  - TA0005: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has a new user account been created with a name that matches a known malicious or suspicious account name from our threat intelligence blocklist?
    context: This question aims to detect the most straightforward form of account masquerading, where an attacker uses a username that is explicitly known to be associated with malicious activity (e.g., 'haxor', 'system.service'). By comparing newly created account names against a curated blocklist, we can quickly identify and alert on high-confidence threats without complex analysis.
    answer_sources:
      - Windows Event ID 4720
      - Domain Controllers
      - Member Servers
      - Privileged Workstations
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          SEARCH Windows Event ID 4720
          WHERE 'Target Account Name' IN malicious_account_blocklist
          RETURN 'Target Account Name', 'Subject Account Name', 'Timestamp', 'Hostname'
  - question: Has a new user account been created with a name exhibiting unusually high or low randomness, suggesting programmatic generation?
    context: This question helps identify algorithmically generated account names. Attackers may use tools that create accounts with highly random names (e.g., 'x7g3f_svc') or overly simplistic ones (e.g., 'a'). By measuring the Shannon entropy (a measure of randomness) of a new username and comparing it to the typical entropy of legitimate usernames, we can flag statistical outliers that may indicate malicious automation.
    answer_sources:
      - Windows Event ID 4720
      - Domain Controllers
      - Member Servers
      - Privileged Workstations
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          FOR EACH new 'Target Account Name' from Windows Event ID 4720
            CALCULATE shannon_entropy(name)
            IF shannon_entropy IS_OUTLIER compared to baseline
              ALERT 'Anomalous username entropy detected'
          RETURN 'Target Account Name', 'Entropy Score', 'Hostname'
  - question: Does a newly created user account have features (such as name length, character types, or creation time) that a machine learning model classifies as malicious?
    context: This question leverages a machine learning model to perform a holistic assessment of an account creation event. Instead of relying on a single indicator, the model considers multiple features simultaneously (e.g., username characteristics, source of creation, time of day). This allows for the detection of more subtle or novel masquerading attempts that might not be caught by simple blocklists or entropy checks.
    answer_sources:
      - Windows Event ID 4720
      - Domain Controllers
      - Member Servers
      - Privileged Workstations
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          FOR EACH new account event from Windows Event ID 4720
            EXTRACT features (name_length, char_ratios, source_host, time_of_day)
            SCORE event with pre-trained classification_model
            IF score > 0.9
              ALERT 'ML model detected high-confidence malicious account creation'
          RETURN 'Target Account Name', 'ML Score', 'Features'
  - question: Has an account with a name resembling a standard administrative or service account been created by a user who is not an authorized administrator?
    context: This question addresses the risk of an attacker creating an account that mimics a legitimate service or administrative account (e.g., 'svc_backup', 'sql_admin') to blend in. The detection logic focuses on the context of the creation: if an account with a suspicious name is created by a non-administrative user or an unknown service principal, it is a strong indicator of a defense evasion attempt.
    answer_sources:
      - Windows Event ID 4720
      - Domain Controllers
      - Cloud IAM Services (e.g., Azure AD)
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          SEARCH Windows Event ID 4720
          WHERE 'Target Account Name' MATCHES_REGEX admin_patterns_list
          AND 'Subject Account Name' NOT_IN admin_allowlist
          ALERT 'Unauthorized creation of admin-like account'
          RETURN 'Target Account Name', 'Subject Account Name', 'Hostname'
  - question: Was an account with a name resembling an administrative or service account created at an unusual time, such as outside of standard business hours?
    context: This question adds a temporal dimension to the detection of suspicious account creation. Legitimate administrative accounts are typically created during business hours by IT staff. An account with an admin-like name being created late at night or on a weekend is anomalous and could indicate an adversary operating on the network.
    answer_sources:
      - Windows Event ID 4720
      - Domain Controllers
      - Cloud IAM Services (e.g., Azure AD)
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          FOR EACH new account from Windows Event ID 4720 with admin-like name
            IF creation_timestamp IS_OUTLIER compared to historical baseline
              ALERT 'Admin-like account created at anomalous time'
          RETURN 'Target Account Name', 'Creation Time', 'Hostname'
  - question: Has there been a sudden spike or burst in the creation of accounts with names resembling administrative or service accounts, as detected by a time series model?
    context: This question aims to detect a sudden, large-scale creation of masqueraded accounts, which could be part of an automated attack script. A time series model learns the normal rhythm of administrative account creation and can flag any sudden deviation from this pattern, such as the creation of ten service accounts in an hour when the norm is one per day.
    answer_sources:
      - Windows Event ID 4720
      - Domain Controllers
      - Cloud IAM Services (e.g., Azure AD)
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          AGGREGATE hourly counts of admin-like account creations from Event ID 4720
          FEED counts into time_series_anomaly_model
          IF observed_count > forecasted_upper_bound
            ALERT 'Anomalous spike in admin-like account creations'
          RETURN 'Time Window', 'Observed Count', 'Forecasted Count'
  - question: Has a new or renamed user account been detected that uses non-standard characters or homoglyphs to visually impersonate another account?
    context: This question targets homoglyph attacks, a sophisticated masquerading technique where an attacker uses characters from different alphabets that look identical to standard characters (e.g., a Cyrillic 'Ð°' instead of a Latin 'a'). This can trick human analysts. This query specifically looks for the presence of these known confusable characters or mixed character sets within a single username.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4781
      - Domain Controllers
      - HR Systems
      - Financial Systems
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          SEARCH Windows Event ID 4720 OR 4781
          FOR EACH 'Target Account Name'
            IF name CONTAINS characters from homoglyph_list
              ALERT 'Potential homoglyph attack detected in username'
          RETURN 'Target Account Name', 'Detected Homoglyphs', 'Hostname'
  - question: After normalizing for homoglyphs and special characters, does a new or renamed account name have a very small edit distance (1-2 characters) from a known privileged account?
    context: This question addresses homoglyph and typosquatting attacks by comparing the 'skeletons' of usernames rather than the names themselves. A skeleton is a normalized version of the name (e.g., 'Adm1nistr@tor' and 'Admlnlstrator' might both normalize to 'administrator'). A small Levenshtein (edit) distance between skeletons, when the original names differ, strongly suggests a deliberate attempt to impersonate a privileged account.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4781
      - Domain Controllers
      - HR Systems
      - Financial Systems
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          FOR EACH new name from Windows Event ID 4720/4781
            CALCULATE new_skeleton by normalizing name
            FOR EACH privileged_skeleton in privileged_list
              CALCULATE distance = levenshtein(new_skeleton, privileged_skeleton)
              IF distance <= 2
                ALERT 'High similarity to privileged account after normalization'
          RETURN 'Original Name', 'Normalized Skeleton', 'Matched Privileged Account'
  - question: Does a new or renamed account name have an unusual character structure that a neural network autoencoder fails to reconstruct accurately?
    context: This question uses an advanced machine learning technique to spot abnormal usernames. An autoencoder is trained to 'understand' the patterns of legitimate usernames. When presented with an anomalous name containing unusual character sequences, such as those found in homoglyph attacks or generated by domain generation algorithms (DGAs), the model will produce a high reconstruction error, flagging the name as suspicious without needing a predefined list of bad characters.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4781
      - Domain Controllers
      - HR Systems
      - Financial Systems
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          FOR EACH new name from Windows Event ID 4720/4781
            CALCULATE reconstruction_error using character_autoencoder_model
            IF reconstruction_error > baseline_threshold
              ALERT 'Anomalous username structure detected by autoencoder'
          RETURN 'Target Account Name', 'Reconstruction Error'
  - question: Has a new or renamed account been created whose name is an exact match to a pre-generated list of common misspellings of critical account names?
    context: This is a proactive approach to detecting typosquatting. Instead of calculating similarity on the fly, we pre-generate a list of likely typos for high-value accounts (e.g., 'admnistrator', 'administrater', 'adminisrator' for 'administrator'). This allows for a very fast, high-confidence lookup to catch the most common typosquatting attempts.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4781
      - Domain Controllers
      - Privileged Access Workstations (PAWs)
      - Key IT Personnel Endpoints
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          SEARCH Windows Event ID 4720 OR 4781
          WHERE 'Target Account Name' IN pre-generated_typo_list
          ALERT 'Typosquatted account name detected from pre-generated list'
          RETURN 'Target Account Name', 'Matched Privileged Account'
  - question: Does a new or renamed account have an exceptionally high Jaro-Winkler similarity score (e.g., > 0.95) to an existing privileged account, suggesting a typosquatting attempt?
    context: This question uses a string similarity algorithm (Jaro-Winkler), which is particularly effective at detecting typos, to find near-matches to privileged accounts. By comparing every new account name against a list of privileged accounts and flagging those with a very high similarity score, we can catch typosquatting attempts that were not in a pre-generated list.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4781
      - Domain Controllers
      - Privileged Access Workstations (PAWs)
      - Key IT Personnel Endpoints
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          FOR EACH new name from Windows Event ID 4720/4781
            CALCULATE max_similarity = MAX(jaro_winkler(new name, privileged_name) for each privileged_name)
            IF max_similarity > 0.95
              ALERT 'High string similarity to privileged account detected'
          RETURN 'Target Account Name', 'Matched Privileged Account', 'Similarity Score'
  - question: Does a new user account fail to fit into any existing clusters of legitimate account names, marking it as a statistical outlier or 'noise' point?
    context: This question uses unsupervised machine learning to identify anomalous naming conventions. By converting all usernames into numerical vectors and clustering them, we can define what 'normal' looks like based on an organization's own data. A new account that doesn't fit into any existing cluster is, by definition, anomalous and warrants investigation, especially if it also has high string similarity to a privileged account.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4781
      - Domain Controllers
      - Privileged Access Workstations (PAWs)
      - Key IT Personnel Endpoints
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          FOR EACH new name from Windows Event ID 4720/4781
            CONVERT name to vector
            PREDICT cluster using DBSCAN model
            IF cluster_label == 'noise'
              ALERT 'Anomalous username does not fit any naming convention cluster'
          RETURN 'Target Account Name', 'Vector'
  - question: Was a newly created user account granted high-privilege group membership (e.g., Domain Admins) within one hour of its creation?
    context: This question targets 'newborn admin' activity, which is a highly suspicious chain of events. A legitimate account creation and privilege escalation process is typically more deliberate. An adversary, however, will often create an account and immediately add it to a privileged group to establish persistence. Correlating these two events within a short time window is a critical detection for active compromise.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4728
      - Windows Event ID 4732
      - Windows Event ID 4756
      - Domain Controllers
      - Network Gateway
      - DNS Servers
      - Endpoint Devices
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          SEARCH for Windows Event ID 4720 (creation)
          JOIN with Windows Event ID 4728/4732/4756 (group add) on 'Target Account Name'
          WHERE group_add.timestamp < creation.timestamp + 1 hour
          AND group_name IN privileged_groups_list
          ALERT 'Critical: Newborn account immediately added to privileged group'
          RETURN 'Account Name', 'Group Name', 'Creation Time', 'Group Add Time'
  - question: Has a recently created account logged in interactively from a geographically rare or unusual network location (ASN) compared to organizational history?
    context: This question focuses on the post-creation behavior of a new account. An attacker, after creating a masqueraded account, may use it to log in from an external system. By correlating login events with network logs and enriching them with GeoIP and ASN data, we can identify logins from locations that are highly unusual for the organization, which can be an indicator of an external threat actor.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4624
      - Zeek conn.log
      - Domain Controllers
      - Network Gateway
      - DNS Servers
      - Endpoint Devices
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          GET accounts created in last 7 days from Event ID 4720
          FOR EACH account
            GET interactive logins (Event ID 4624, Type 2/10)
            JOIN with network logs (Zeek) on IP and timestamp
            ENRICH with GeoIP and ASN data
            IF Source_Country or Source_ASN is rare for organization
              ALERT 'New account login from anomalous network location'
          RETURN 'Account Name', 'Source IP', 'Source Country', 'Source ASN'
  - question: Did a new account perform its first privileged action (e.g., RDP login, access critical server) in an anomalously short amount of time after its creation?
    context: This question uses survival analysis to model the 'time-to-event' for new accounts. For legitimate users, there's usually a ramp-up period before they perform high-privilege actions. An adversary's account, however, will likely be put to use immediately. This model establishes a baseline for how quickly new accounts perform critical actions and flags any account that acts 'too fast' as suspicious.
    answer_sources:
      - Windows Event ID 4720
      - Windows Event ID 4624
      - Windows Event ID 4732
      - Domain Controllers
      - Network Gateway
      - DNS Servers
      - Endpoint Devices
    range: last 90 days
    queries:
      - type: pseudocode
        query: |
          FOR EACH new account from Event ID 4720
            FIND timestamp of first privileged action (e.g., RDP login)
            CALCULATE time_to_first_action = action_timestamp - creation_timestamp
            IF time_to_first_action is anomalous according to survival_model
              ALERT 'New account performed privileged action in anomalously short time'
          RETURN 'Account Name', 'Action Type', 'Time to Action'