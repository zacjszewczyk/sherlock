name: T1594: Search Victim-Owned Websites
id: 3c5a61a8-9e53-4b68-80a5-81a073f3c301
description: This playbook helps investigate whether an adversary is conducting reconnaissance by searching public-facing websites. It focuses on identifying suspicious activity such as connections from known malicious IP addresses or with malicious User-Agent strings, automated scanning for sensitive files and directories (e.g., /.git/, .sql, /wp-admin/), statistically anomalous request volumes or rates from a single source, targeted enumeration of sensitive content areas like employee or investor pages, and direct access to deep-linked pages that bypasses normal site navigation, often indicated by a missing or invalid Referer header.
type: technique
related:
- TA0043: Reconnaissance
contributors:
- Zachary Szewczyk
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Are there any connections to our public websites originating from IP addresses or using User-Agents known to be malicious?
  context: This question aims to detect the most straightforward reconnaissance attempts by cross-referencing incoming web traffic against established threat intelligence feeds. A match against a known malicious IP (like a TOR exit node or known scanning infrastructure) or a suspicious User-Agent string is a high-fidelity indicator that an adversary is probing our external-facing assets.
  answer_sources:
  - Zeek http.log
  - Zeek conn.log
  - Public-facing web servers
  - Network perimeter firewalls/proxies
  - Web Application Firewalls (WAFs)
  - Cloud-hosted web applications
  - Threat Intelligence Platforms
  range: last 90 days
  queries:
  - pseudocode: SEARCH Zeek conn.log AND http.log WHERE source_ip IN threat_intel_feed_ips OR user_agent IN threat_intel_feed_uas
- question: Is there a statistically significant increase in connections from anonymizing services like VPNs or proxies?
  context: Adversaries often use anonymizing services to obscure their origin. This question seeks to identify unusual spikes in traffic from such services. By establishing a baseline of normal connection volume from anonymizing networks (based on ASN and geolocation), we can detect deviations that might indicate a coordinated reconnaissance effort hiding behind these services.
  answer_sources:
  - Zeek http.log
  - Zeek conn.log
  - Public-facing web servers
  - Network perimeter firewalls/proxies
  - Web Application Firewalls (WAFs)
  - Cloud-hosted web applications
  - Threat Intelligence Platforms
  range: last 90 days
  queries:
  - pseudocode: CALCULATE daily_connection_volume FROM anonymizing_asns. ESTABLISH baseline_mean_and_std_dev. ALERT IF current_volume > (baseline_mean + 3 * baseline_std_dev)
- question: Can we predictively identify malicious reconnaissance sessions using machine learning?
  context: This question leverages a machine learning model to proactively identify malicious reconnaissance activity that might not be caught by simple rules. By training a classifier on features like source IP, User-Agent, ASN, geolocation, and time of day, we can assign a probability score to each session, allowing us to flag suspicious activity that exhibits a combination of subtle malicious characteristics.
  answer_sources:
  - Zeek http.log
  - Zeek conn.log
  - Public-facing web servers
  - Network perimeter firewalls/proxies
  - Web Application Firewalls (WAFs)
  - Cloud-hosted web applications
  - Threat Intelligence Platforms
  range: last 90 days
  queries:
  - pseudocode: APPLY logistic_regression_model to web_session_features. ALERT IF probability_score > 0.85
- question: Are any external sources scanning for common vulnerabilities, sensitive files, or administrative interfaces on our websites?
  context: This question looks for active scanning and enumeration attempts. Adversaries frequently use automated tools to probe for specific, well-known weak points like exposed git repositories (/.git/), backup files (.bak, .sql), or administrative portals (/wp-admin/). This query uses regular expressions to detect these tell-tale signs of targeted scanning in web server logs.
  answer_sources:
  - Zeek http.log
  - Public-facing web servers
  - Content Delivery Network (CDN) edge nodes
  - Web Application Firewalls (WAFs)
  range: last 90 days
  queries:
  - pseudocode: SEARCH Zeek http.log WHERE uri MATCHES regex_list OR user_agent MATCHES scanner_ua_list
- question: Is any single IP address exhibiting statistically unusual file-type probing or generating an excessive number of 'File Not Found' errors?
  context: This question aims to statistically identify scanners. An adversary's tool might request a wide variety of file extensions, leading to high entropy in the URI requests. Simultaneously, searching for non-existent files and directories will generate a high rate of HTTP 404 errors. A combination of these two statistical anomalies for a single source IP is a strong indicator of enumeration.
  answer_sources:
  - Zeek http.log
  - Public-facing web servers
  - Content Delivery Network (CDN) edge nodes
  - Web Application Firewalls (WAFs)
  range: last 90 days
  queries:
  - pseudocode: GROUP BY source_ip. CALCULATE shannon_entropy(file_extensions) AND rate(http_404_errors). ALERT IF entropy > 90th_percentile AND 404_rate > 3_std_dev_from_mean
- question: Is there an anomalous volume of requests for indexable, sensitive files like robots.txt or sitemap.xml?
  context: While files like robots.txt are public, a sudden, massive spike in requests for them can signal the start of a coordinated reconnaissance campaign where multiple adversaries are gathering initial information. This question uses a time-series model to forecast expected traffic to these files and alerts on significant deviations, catching the early stages of a widespread scan.
  answer_sources:
  - Zeek http.log
  - Public-facing web servers
  - Content Delivery Network (CDN) edge nodes
  - Web Application Firewalls (WAFs)
  range: last 90 days
  queries:
  - pseudocode: FORECAST hourly_request_volume for robots.txt, sitemap.xml. ALERT IF observed_volume deviates from forecast_confidence_interval
- question: Are there any high-rate web scanners active on our sites that are not legitimate, whitelisted crawlers like Googlebot?
  context: High-volume traffic isn't always malicious; search engines and other services constantly crawl websites. This question aims to differentiate malicious scanning from benign crawling. By whitelisting the User-Agent strings of known good bots, we can create a high-fidelity rule that alerts only on high-rate activity from unknown or suspicious clients.
  answer_sources:
  - Zeek http.log
  - Zeek conn.log
  - Public-facing web servers
  - Load balancers
  - Web Application Firewalls (WAFs)
  - Network Intrusion Detection Systems (NIDS)
  range: last 90 days
  queries:
  - pseudocode: SEARCH Zeek logs WHERE request_rate > 10_req_per_sec AND user_agent NOT IN legitimate_crawler_whitelist
- question: Is any single IP address accessing an anomalously high number of unique pages at a high rate?
  context: This question identifies aggressive content scraping or site mapping. A normal user might browse several pages, but an automated tool will try to access a vast number of unique URIs in a very short time. By establishing a baseline for both request rate and unique URI count, we can flag any source IP that is a statistical outlier on both metrics simultaneously, which strongly indicates automated reconnaissance.
  answer_sources:
  - Zeek http.log
  - Zeek conn.log
  - Public-facing web servers
  - Load balancers
  - Web Application Firewalls (WAFs)
  - Network Intrusion Detection Systems (NIDS)
  range: last 90 days
  queries:
  - pseudocode: GROUP BY source_ip. CALCULATE request_rate AND unique_uri_count. ALERT IF request_rate > 98th_percentile AND unique_uri_count > 98th_percentile
- question: Can we use clustering to automatically group and identify anomalous web sessions indicative of scanning?
  context: This question uses unsupervised machine learning to discover patterns of behavior without pre-existing labels. By clustering web sessions based on features like duration, number of requests, and URI diversity, we can automatically group them into categories. Sessions that don't fit into the large, dense clusters of 'normal user behavior' can be flagged as outliers or anomalies, likely representing scanning or other non-standard activity.
  answer_sources:
  - Zeek http.log
  - Zeek conn.log
  - Public-facing web servers
  - Load balancers
  - Web Application Firewalls (WAFs)
  - Network Intrusion Detection Systems (NIDS)
  range: last 90 days
  queries:
  - pseudocode: APPLY DBSCAN clustering on session_features (duration, request_count, uri_diversity). ALERT on sessions classified as noise/outliers
- question: Is a single source IP rapidly accessing an unusually large number of pages within sensitive areas like employee directories or investor relations?
  context: This question focuses on reconnaissance targeting specific, high-value information. Adversaries often enumerate pages in sections like 'About Us', 'Team', or 'Careers' to gather intelligence on personnel. This query sets a simple threshold to detect this behavior, alerting when an IP quickly browses through an excessive number of these sensitive pages.
  answer_sources:
  - Zeek http.log
  - Public-facing web servers hosting corporate, HR, or investor relations content
  - Content Management System (CMS) logs
  range: last 90 days
  queries:
  - pseudocode: COUNT unique_sensitive_urls by source_ip in 5_min_window. ALERT IF count > 20
- question: Are any user sessions showing a statistically disproportionate focus on sensitive content areas compared to normal browsing?
  context: This question provides a more nuanced way to detect targeted data collection than a simple threshold. Instead of just counting page hits, it calculates the ratio of sensitive pages to total pages visited in a session. A session with a ratio in the top 95th percentile indicates an abnormal focus on information-rich sections, distinguishing a potential adversary from a casual browser who might visit one or two team pages.
  answer_sources:
  - Zeek http.log
  - Public-facing web servers hosting corporate, HR, or investor relations content
  - Content Management System (CMS) logs
  range: last 90 days
  queries:
  - pseudocode: CALCULATE ratio = (sensitive_pages_visited / total_pages_visited) per session. ALERT IF ratio > 95th_percentile_of_baseline
- question: Are there user sessions with navigation paths that are highly improbable compared to normal, learned user behavior?
  context: This question models the 'flow' of a user through the website. Normal users tend to follow predictable paths (e.g., Homepage -> Products -> Product A). An adversary might jump directly between disparate sensitive pages. By modeling normal navigation as a Markov chain, we can calculate the probability of any given session path. A path with a very low probability is anomalous and likely represents non-human, scripted enumeration.
  answer_sources:
  - Zeek http.log
  - Public-facing web servers hosting corporate, HR, or investor relations content
  - Content Management System (CMS) logs
  range: last 90 days
  queries:
  - pseudocode: MODEL user_navigation_paths with Markov_chain. CALCULATE probability of new_session_path. ALERT IF probability is below threshold
- question: Are sensitive or deep-linked pages being accessed directly, without navigating from another page on our site?
  context: This question helps detect when an adversary accesses a known URL directly, perhaps from a list compiled offline. Legitimate users typically arrive at deep pages by clicking links from other pages on the same site, which populates the 'Referer' HTTP header. A missing or external Referer for a sensitive internal page is suspicious and suggests the user did not follow the intended navigation path.
  answer_sources:
  - Zeek http.log
  - Public-facing web servers
  - Application servers
  - Web Application Firewalls (WAFs)
  range: last 90 days
  queries:
  - pseudocode: SEARCH Zeek http.log for requests to sensitive_uris WHERE referer IS NULL or referer NOT LIKE '%our_domain.com%'
- question: Is there a statistical anomaly in the referrers for requests to our sensitive pages?
  context: This question seeks to detect shifts in how users are arriving at sensitive content. For any given page, there's usually a predictable set of referring pages. A sudden increase in requests with null referrers or referrers outside the normal top-10 list indicates a change in access patterns, possibly due to a tool or adversary directly accessing a list of URLs.
  answer_sources:
  - Zeek http.log
  - Public-facing web servers
  - Application servers
  - Web Application Firewalls (WAFs)
  range: last 90 days
  queries:
  - pseudocode: FOR each_sensitive_page, CALCULATE percentage of requests from null_or_uncommon_referrers. ALERT IF percentage > 3_std_dev_from_mean
- question: Can we use an autoencoder to detect anomalous user navigation paths, such as directly accessing deep pages?
  context: This question applies a more advanced machine learning technique to detect abnormal navigation. An autoencoder is trained to 'compress' and then 'reconstruct' normal user session paths. When given an anomalous path (e.g., a session with only one hit to a deep, internal page), it will fail to reconstruct it accurately, resulting in a high 'reconstruction error'. This error serves as a powerful signal for anomalous, likely malicious, navigation.
  answer_sources:
  - Zeek http.log
  - Public-facing web servers
  - Application servers
  - Web Application Firewalls (WAFs)
  range: last 90 days
  queries:
  - pseudocode: APPLY sequence_autoencoder to session_uri_path. ALERT IF reconstruction_error > threshold