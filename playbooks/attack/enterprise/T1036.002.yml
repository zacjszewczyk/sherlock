name: 'T1036.002: Right-to-Left Override'
id: 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d'
description: This playbook helps investigate whether an adversary is using filename manipulation, specifically the Right-to-Left Override (RTLO) technique (T1036.002), to evade defenses. This involves looking for the RTLO Unicode character (U+202E) or its variants in filenames, command lines, DNS queries, or registry keys. Key indicators include filenames with reversed, benign-looking extensions that are actually executables, legitimate document handlers spawning unexpected processes like shells, and files downloaded by browsers or email clients being executed shortly after, where the executed filename contains the RTLO character.
type: technique
related:
  - 'TA0005: Defense Evasion'
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: none
questions:
  - question: Are there any process command lines, filenames, registry values, or network log fields that contain the Right-to-Left Override (RTLO) character or its encoded variants?
    context: This question aims to find direct evidence of the RTLO technique by searching for its specific byte sequence (UTF-8: E2 80 AE) or common string representations ('\u202e', '%E2%80%AE'). Detecting this character is a high-fidelity indicator that an adversary may be attempting to disguise a malicious file's true nature, tricking users or security tools.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4657
      - Sysmon Event ID 1
      - Sysmon Event ID 11
      - Zeek files.log
      - Zeek http.log
      - Zeek dns.log
      - User Workstations
      - Web Proxies
      - Mail Gateways
      - Active Directory Domain Controllers
      - DNS Resolvers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH logs (process_command_lines, filenames, registry_values, network_fields) FOR (E280AE OR "\\u202e" OR "%E2%80%AE")
  - question: Are there any process command lines or filenames with unusually high complexity (entropy) that might indicate obfuscation?
    context: Adversaries may use complex or randomized strings, including those with control characters like RTLO, to evade simple signature-based detections. This question uses Shannon entropy to measure the randomness or complexity of filenames and command lines. A value significantly higher than the established baseline for a given process or file type suggests potential obfuscation or packing and warrants investigation.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 11
      - User Workstations
      - Web Proxies
      - Mail Gateways
      - Active Directory Domain Controllers
      - DNS Resolvers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: CALCULATE entropy for (process_command_line, filename) FROM process_creation_events. ALERT IF entropy > 99th_percentile_baseline.
  - question: Can machine learning models identify filenames or command lines that are likely malicious based on their characteristics?
    context: This question proposes a proactive, predictive approach. By training a machine learning model on features like character distribution, length, and the presence of control characters, it's possible to score new events in real-time. This helps detect novel or unknown malicious files that use RTLO or other obfuscation techniques, moving beyond simple string matching to a more behavioral and statistical detection method.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User Workstations
      - Web Proxies
      - Mail Gateways
      - Active Directory Domain Controllers
      - DNS Resolvers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: PREDICT malicious_probability for (new_process_event, new_file_event) using trained_ML_model. ALERT IF probability > 0.90.
  - question: Are there any filenames containing the RTLO character followed by a reversed executable extension, while the MIME type indicates an executable?
    context: This is a classic RTLO attack pattern. An adversary names a file like 'invoice_gepj.scr' which appears as 'invoice_rcs.jpeg'. This question seeks to detect this specific pattern using regular expressions and then confirms the file's true nature by checking its MIME type. A mismatch (e.g., looks like a JPEG but is identified as an executable) is a strong indicator of malicious intent.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Sysmon Event ID 11
      - Zeek files.log
      - Zeek http.log
      - Network Egress Points
      - User Workstations
      - Email Servers
      - File Shares
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH logs for filename matching regex (\\u202E + reversed_executable_extension). IF network_log, CORRELATE with mime_type. ALERT if mime_type is executable.
  - question: Is there a statistically significant increase in the proportion of files with non-executable extensions being identified with an executable MIME type?
    context: This question moves from individual alerts to a statistical, population-level view. It aims to detect widespread campaigns by monitoring for an abnormal rise in the rate of file type/MIME type mismatches. A sudden spike in the proportion of '.jpg' files that are actually executables across the network could indicate a large-scale phishing or drive-by download attack using the RTLO technique.
    answer_sources:
      - Zeek files.log
      - Network Egress Points
      - User Workstations
      - Email Servers
      - File Shares
    range: last 90 days
    queries:
      - technology: pseudocode
        query: AGGREGATE hourly file_logs. CALCULATE proportion of (extension vs executable_mime_type). ALERT IF proportion > (7_day_avg + 3 * std_dev).
  - question: Is there an anomalous spike in the hourly count of files with mismatched extensions and MIME types, accounting for normal daily and weekly patterns?
    context: This question refines the statistical approach by using a time-series model (like SARIMA) to understand normal business rhythms (seasonality). It helps to reduce false positives by only alerting on spikes that are truly anomalous compared to expected hourly, daily, and weekly traffic patterns, making it more effective at spotting coordinated attacks.
    answer_sources:
      - Zeek files.log
      - Network Egress Points
      - User Workstations
      - Email Servers
      - File Shares
    range: last 90 days
    queries:
      - technology: pseudocode
        query: MODEL hourly_count_of_mismatched_files using SARIMA. ALERT on observations flagged as anomalies.
  - question: Have any common document viewers or office applications (e.g., Word, Acrobat) spawned suspicious child processes like command shells or script interpreters?
    context: This question focuses on post-exploitation behavior. After a user is tricked by an RTLO-disguised file, the malicious payload often executes by having the legitimate host application (like Word) spawn a shell (like PowerShell or cmd.exe) to run further commands. This is highly anomalous behavior and a key indicator that a user has been compromised.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User Workstations
      - Terminal Servers
      - File Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH process_creation_logs WHERE parent_process in (doc_apps) AND child_process in (shells, interpreters).
  - question: Have any statistically rare or never-before-seen parent-child process relationships occurred?
    context: This question aims to find "unknown unknowns" by baselining all parent-child process relationships across the enterprise. Any new process creation event that represents a very low probability or entirely new pairing (e.g., acrord32.exe spawning wscript.exe for the first time) is flagged. This statistical approach can detect novel attack chains that a static rule might miss.
    answer_sources:
      - Sysmon Event ID 1
      - User Workstations
      - Terminal Servers
      - File Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR each new process_pair(Parent, Child), CALCULATE P(Child | Parent) from historical data. ALERT IF P < 0.001 or pair is new.
  - question: Are there any anomalous process executions that connect otherwise unrelated clusters of process activity on a host?
    context: This question uses graph analysis to model normal software behavior on a host. Processes tend to form communities or clusters (e.g., Office apps, developer tools, system processes). An attack often bridges these communities, such as an Office application spawning a network utility. Detecting these "bridge" events in the process graph can reveal sophisticated lateral movement or payload execution.
    answer_sources:
      - Sysmon Event ID 1
      - User Workstations
      - Terminal Servers
      - File Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: BUILD process_execution_graph. IDENTIFY process communities. ALERT IF a new process_edge connects two previously separate communities.
  - question: Has a file been downloaded with a seemingly benign extension, but then executed shortly after as a process containing the RTLO character?
    context: This question correlates network and host data to trace the full attack chain from download to execution. It specifically looks for a file downloaded by a browser or email client that is then executed within a short time window, where the executed process name reveals the RTLO trick. This provides strong, end-to-end evidence of a successful phishing or drive-by-download attack.
    answer_sources:
      - Sysmon Event ID 11
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Zeek files.log
      - User Workstations
      - Network Egress Points
    range: last 90 days
    queries:
      - technology: pseudocode
        query: JOIN network_file_logs with host_process_logs on host and time_window < 60s. ALERT IF downloaded_file has benign_extension AND executed_process_name contains RTLO.
  - question: Has any user exhibited an abnormal burst of activity where files are created by a browser or email client and then immediately executed?
    context: This question establishes a behavioral baseline for each user. While downloading and running files is normal, a sudden, high-frequency burst of this activity for a specific user is anomalous. This could indicate that the user has fallen victim to a phishing campaign and is rapidly executing multiple malicious attachments or downloads, or that their machine is compromised and performing these actions automatically.
    answer_sources:
      - Sysmon Event ID 11
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - User Workstations
      - Network Egress Points
    range: last 90 days
    queries:
      - technology: pseudocode
        query: PROFILE per-user hourly frequency of (file_create -> process_create) from browsers/email. ALERT IF frequency > (user_mean + 3 * user_std_dev).
  - question: Are there any 'download-then-execute' events that are outliers or part of a very small cluster when compared to normal user behavior?
    context: This question uses unsupervised machine learning (like DBSCAN) to automatically group common, benign 'download-then-execute' behaviors into large clusters. Any event that doesn't fit into these normal clusters is flagged as noise or an outlier. This is a powerful way to detect novel attacks without prior labeling, as it focuses on identifying events that are fundamentally different from the established norm based on features like time delta, file type, and source domain.
    answer_sources:
      - Sysmon Event ID 11
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Zeek files.log
      - User Workstations
      - Network Egress Points
    range: last 90 days
    queries:
      - technology: pseudocode
        query: CLUSTER download-execute events using DBSCAN on features (time_delta, extension, mime_type, domain, etc.). ALERT on events classified as noise/outliers.