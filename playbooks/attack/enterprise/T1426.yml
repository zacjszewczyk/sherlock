name: "T1426: System Information Discovery"
id: "f5a8b1c2-d3e4-4f5a-b6c7-d8e9f0a1b2c3"
description: |
  This playbook helps answer the question: Is an adversary attempting to gather detailed system and hardware information from our mobile devices? This activity is often a precursor to further exploitation. An adversary's attempt to discover system information on a mobile device, typically by making programmatic API calls (e.g., to Android's android.os.Build class [1]), is evidenced by the subsequent network exfiltration of this small data payload. This exfiltration may manifest as one or more of the following network patterns: (A) A single HTTP/S connection where outbound data volume is minimal (e.g., 100 bytes to 5 KB) to a low-reputation or newly registered domain; (B) A DNS query for a high-entropy or algorithmically generated subdomain, indicating potential DNS tunneling; (C) A direct-to-IP connection with a small, periodic outbound data payload, suggesting beaconing; (D) A TLS session where the client's JA3 or JA3S fingerprint is rare or associated with known malicious tools.
type: "technique"
related:
  - "TA0032: Discovery"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: "1.0"
tags: "none"
investigative_questions:
  - question: "Is a mobile device connecting to known malicious infrastructure or exhibiting high-risk indicators like anomalous User-Agents on newly registered domains?"
    context: |
      This question focuses on identifying high-fidelity indicators of compromise by matching network traffic against known threat intelligence. Detecting connections to active C2 or malware domains, known malicious JA3 hashes, or suspicious combinations like an anomalous User-Agent connecting to a Newly Registered Domain (NRD) can provide a strong, direct signal of a potential reconnaissance attempt.
    answer_sources:
      - "Zeek conn.log"
      - "Zeek http.log"
      - "Zeek ssl.log"
      - "Zeek dns.log"
      - "Network egress points for corporate and guest Wi-Fi, VPN concentrators, enterprise DNS resolvers, and secure web gateways where mobile device traffic is inspected."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: |
          Search network logs (dns, http, ssl) from mobile IP space.
          WHERE (destination_ip OR destination_domain IN threat_intel_list)
          OR (ja3_hash IN malicious_ja3_list)
          OR (destination_domain IN nrd_list AND user_agent IS anomalous)
  - question: "Are any mobile devices exhibiting a combination of statistically anomalous network behaviors, such as high-entropy requests, rare TLS fingerprints, small payloads to new destinations, or beaconing?"
    context: |
      This question aims to detect subtler, unknown threats by scoring multiple weak signals that, in aggregate, point to malicious activity. It moves beyond known indicators to profile behavior, identifying deviations from a device's normal 30-day baseline. Indicators include high Shannon entropy in DNS/URI strings, rare JA3 hashes across the fleet, small payloads (100B-5KB) to new IPs, and beaconing behavior. A high aggregate score suggests a reconnaissance or exfiltration attempt.
    answer_sources:
      - "Zeek conn.log"
      - "Zeek http.log"
      - "Zeek ssl.log"
      - "Zeek dns.log"
      - "Network egress points for corporate and guest Wi-Fi, VPN concentrators, enterprise DNS resolvers, and secure web gateways where mobile device traffic is inspected."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: |
          FOR each mobile device:
             CALCULATE 30-day baseline for (DNS/URI entropy, JA3 frequency, destination IPs, connection intervals).
             COMPARE hourly traffic against baseline.
             ASSIGN risk score for deviations (high entropy, rare JA3, small payload to new IP, beaconing).
             IF total_score > threshold, ALERT.
  - question: "Can machine learning models detect sophisticated evasion techniques like Domain Generation Algorithms (DGAs), malicious TLS fingerprints, or anomalous connection patterns indicative of system information discovery?"
    context: |
      This question leverages advanced machine learning to uncover complex threats that evade traditional rule-based or statistical methods. By correlating findings from multiple specialized models—such as a DGA detection model for DNS queries, a malicious fingerprint classifier for TLS sessions, and an anomaly detection model for general connection patterns—it can identify multifaceted attacks with higher confidence and reduce false positives.
    answer_sources:
      - "Zeek conn.log"
      - "Zeek http.log"
      - "Zeek ssl.log"
      - "Zeek dns.log"
      - "Network egress points for corporate and guest Wi-Fi, VPN concentrators, enterprise DNS resolvers, and secure web gateways where mobile device traffic is inspected."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: |
          INPUT: Network logs (dns, ssl, conn) from mobile IP space.
          PROCESS with DGA detection model on DNS queries.
          PROCESS with TLS fingerprint classifier on JA3/JARM hashes.
          PROCESS with anomaly detection model on connection logs.
          IF (at least two models flag the same network event with high confidence), CREATE incident.