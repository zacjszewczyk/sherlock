name: 'T1585.003: Cloud Accounts'
id: 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d'
description: |
  This playbook helps investigate whether an adversary is developing resources by creating or using cloud accounts. It focuses on detecting suspicious activities such as the use of disposable email services to sign up for cloud accounts, unauthorized programmatic access to cloud APIs from non-administrative systems, connections to cloud management portals from non-privileged hosts, and rapid "cloud shopping" behavior where a single host connects to multiple cloud providers in a short time frame.
type: 'technique'
related:
  - 'TA0042: Resource Development'
contributors:
  - 'Zachary Szewczyk'
  - 'Ask Sage'
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: none
questions:
  - question: 'Is an internal host using a disposable email service to sign up for a cloud account?'
    context: |
      This question aims to identify the initial stage of illicit cloud account creation. Adversaries often use disposable or temporary email services to register for cloud services to obscure their identity and hinder attribution. Detecting a host that queries a disposable email domain and immediately afterward connects to a cloud provider's sign-up page is a strong indicator of this technique.
    answer_sources:
      - 'Zeek dns.log'
      - 'Zeek http.log'
      - 'Zeek conn.log'
      - 'Zeek ssl.log'
      - 'Corporate network egress points and internal DNS resolvers.'
    range: 'last 90 days'
    queries:
      - 'SEARCH Zeek DNS logs for disposable email domains AND Zeek HTTP/SSL logs for cloud sign-up URLs from the same source IP within a 5-minute window.'
  - question: 'Are multiple hosts exhibiting low-entropy, scripted behavior consistent with automated cloud account sign-ups using disposable email services?'
    context: |
      This question looks for signs of automated, large-scale account creation. If multiple hosts perform the exact same sequence of actions (query disposable email, visit the same few cloud sign-up domains), it suggests a scripted process rather than normal user behavior. Low domain entropy following a disposable email query is a key indicator of this automated activity.
    answer_sources:
      - 'Zeek dns.log'
      - 'Zeek http.log'
      - 'Zeek conn.log'
      - 'Zeek ssl.log'
      - 'Corporate network egress points and internal DNS resolvers.'
    range: 'last 90 days'
    queries:
      - 'FOR EACH source IP, BASELINE DNS queries to disposable email domains. CALCULATE entropy of destination domains visited within 5 minutes of a query. ALERT on low-entropy events.'
  - question: "Is a user's web browsing sequence, involving a disposable email provider and a cloud sign-up page, anomalous compared to normal behavior?"
    context: |
      This question uses machine learning to detect deviations from established patterns of benign web browsing. A sequence of events like visiting a disposable email site followed by a cloud provider sign-up page is often unusual for typical users. A model trained on normal behavior can flag such sequences as low-probability outliers, indicating potentially malicious activity that might be missed by simple correlation rules.
    answer_sources:
      - 'Zeek dns.log'
      - 'Zeek http.log'
      - 'Zeek conn.log'
      - 'Zeek ssl.log'
      - 'Corporate network egress points and internal DNS resolvers.'
    range: 'last 90 days'
    queries:
      - 'APPLY sequence analysis model (HMM/LSTM) to real-time DNS and HTTP/SSL event sequences. ALERT if the model flags a sequence involving disposable email and cloud sign-up domains as a low-probability anomaly.'
  - question: "Is an unauthorized host using a programmatic User-Agent (e.g., Terraform, Boto3) to interact with a cloud provider's API?"
    context: |
      This question focuses on detecting unauthorized infrastructure-as-code (IaC) or scripted administrative activity. Tools like Terraform and SDKs like Boto3 use distinct User-Agent strings. Traffic with these user agents should only originate from designated administrative servers. An alert on such traffic from a regular user workstation or an unknown host could indicate a compromised machine or an insider threat setting up rogue infrastructure.
    answer_sources:
      - 'Zeek http.log'
      - 'Zeek conn.log'
      - 'Windows Event ID 5156'
      - 'User endpoint subnets, server subnets, and cloud management system enclaves.'
    range: 'last 90 days'
    queries:
      - "SEARCH HTTP logs for programmatic User-Agents (e.g., 'Terraform/', 'Boto3') where the source IP is NOT in the authorized infrastructure management server list."
  - question: 'Is a non-administrative host using a rare or first-seen programmatic User-Agent to connect to cloud APIs?'
    context: |
      This question provides a behavioral approach to detecting unauthorized cloud API access. By baselining the User-Agents used by each host, the first-time use of a programmatic User-Agent on a non-admin host becomes a significant anomaly. Additionally, identifying the use of very rare User-Agents across the entire organization can help uncover novel or custom tools used by an adversary.
    answer_sources:
      - 'Zeek http.log'
      - 'Zeek conn.log'
      - 'Windows Event ID 5156'
      - 'User endpoint subnets, server subnets, and cloud management system enclaves.'
    range: 'last 90 days'
    queries:
      - 'PROFILE User-Agents per host. ALERT when a non-authorized host uses a programmatic User-Agent for the first time OR uses a User-Agent that is statistically rare across the enterprise.'
  - question: 'Does network traffic to cloud APIs from an internal host exhibit characteristics of an outlier when compared to legitimate administrative traffic?'
    context: |
      This question leverages anomaly detection models to identify suspicious cloud API interactions that may not be caught by simple rules. By training a model on features of known-good administrative traffic (source, destination, time, etc.), any new traffic that deviates significantly from this learned profile can be flagged as an outlier, potentially indicating malicious use of cloud APIs.
    answer_sources:
      - 'Zeek http.log'
      - 'Zeek conn.log'
      - 'Windows Event ID 5156'
      - 'User endpoint subnets, server subnets, and cloud management system enclaves.'
    range: 'last 90 days'
    queries:
      - 'APPLY anomaly detection model (One-Class SVM/Isolation Forest) to all internal traffic destined for cloud APIs. ALERT on any traffic classified as an outlier.'
  - question: "Is a host that is not part of the 'Cloud Administrators' group accessing cloud management, billing, or IAM configuration pages?"
    context: |
      This question seeks to identify unauthorized access to sensitive cloud management portals. Access to pages for billing, user management (IAM), or resource creation should be restricted to a small group of administrators. A connection to these specific URIs from a standard user endpoint could indicate a compromised account or an insider threat exploring or creating cloud resources.
    answer_sources:
      - 'Zeek dns.log'
      - 'Zeek http.log'
      - 'Zeek ssl.log'
      - 'Windows Event ID 5156'
      - 'User endpoint subnets, corporate network egress points, and VPN concentrators.'
    range: 'last 90 days'
    queries:
      - "SEARCH DNS/HTTP/SSL logs for connections to cloud management/billing/IAM URIs from source IPs NOT in the 'Cloud Administrators' asset group."
  - question: 'Is a non-administrative host showing an anomalous spike in connections to cloud management domains compared to its own baseline or its peer group?'
    context: |
      This question uses statistical baselining to find abnormal behavior. A regular user might occasionally visit a cloud provider's main page, but a sudden, significant increase in connections to management-specific domains is suspicious. Comparing a host's activity to its own history and to the average activity of its peer group helps to identify meaningful deviations that could signal malicious reconnaissance or resource development.
    answer_sources:
      - 'Zeek dns.log'
      - 'Zeek http.log'
      - 'Zeek ssl.log'
      - 'Windows Event ID 5156'
      - 'User endpoint subnets, corporate network egress points, and VPN concentrators.'
    range: 'last 90 days'
    queries:
      - "FOR each non-admin host, BASELINE daily connections to cloud management domains. ALERT if daily count exceeds historical baseline (e.g., 98th percentile) or peer group average (e.g., >3 standard deviations)."
  - question: 'Are there anomalous or outlier web browsing sessions to cloud management domains that differ from typical administrative activity?'
    context: |
      This question uses unsupervised machine learning to group user sessions based on their characteristics (duration, pages visited, data transferred). Legitimate administrative sessions will likely form large, dense clusters. Sessions that don't fit into any cluster (outliers) or form new, small clusters may represent adversary activity, such as quick, exploratory logins or automated scripts interacting with the management console.
    answer_sources:
      - 'Zeek dns.log'
      - 'Zeek http.log'
      - 'Zeek ssl.log'
      - 'Windows Event ID 5156'
      - 'User endpoint subnets, corporate network egress points, and VPN concentrators.'
    range: 'last 90 days'
    queries:
      - 'APPLY clustering algorithm (DBSCAN) to sessionized web traffic to cloud management domains. FLAG sessions identified as outliers or belonging to small, new clusters.'
  - question: 'Is a single host connecting to the management or API domains of multiple distinct cloud providers within a short time frame?'
    context: |
      This question aims to detect 'cloud shopping,' where an adversary quickly checks or attempts to create accounts across various cloud service providers (e.g., AWS, Azure, GCP). Legitimate users typically work with one or two providers. A single host connecting to three or more within an hour is highly unusual and suggests an automated search for a suitable platform to stage resources.
    answer_sources:
      - 'Zeek dns.log'
      - 'Zeek conn.log'
      - 'Zeek ssl.log'
      - 'Windows Event ID 5156'
      - 'Corporate network egress points, internal DNS resolvers, and VPN user subnets.'
    range: 'last 90 days'
    queries:
      - 'COUNT distinct cloud providers contacted by a single source IP within a 1-hour window. ALERT if the count is >= 3.'
  - question: "Is a host contacting an anomalously high number of distinct cloud providers compared to its own history or its peer group's behavior?"
    context: |
      This question adds a behavioral and statistical layer to the 'cloud shopping' detection. Instead of a fixed threshold, it looks for a significant increase in the variety of cloud providers a host contacts. This can detect more subtle instances of 'cloud shopping' and is more adaptable, as it flags behavior that is abnormal for a specific host or user group, even if it's below a hardcoded rule's threshold.
    answer_sources:
      - 'Zeek dns.log'
      - 'Zeek conn.log'
      - 'Zeek ssl.log'
      - 'Windows Event ID 5156'
      - 'Corporate network egress points, internal DNS resolvers, and VPN user subnets.'
    range: 'last 90 days'
    queries:
      - "BASELINE the daily number of distinct cloud providers contacted per host. ALERT if the hourly count exceeds the 99th percentile of the host's baseline or its user group's baseline."
  - question: 'Can a sequence of connections to multiple cloud providers be classified as suspicious based on features like connection timing, endpoints visited, and data transferred?'
    context: |
      This question uses a sophisticated, feature-rich approach to distinguish between benign and malicious multi-cloud activity. A supervised model can learn the subtle differences, such as an adversary quickly hitting API endpoints versus a developer browsing marketing and documentation pages across different providers. This allows for higher-fidelity alerts by considering a wider context than just the count of providers.
    answer_sources:
      - 'Zeek dns.log'
      - 'Zeek conn.log'
      - 'Zeek ssl.log'
      - 'Windows Event ID 5156'
      - 'Corporate network egress points, internal DNS resolvers, and VPN user subnets.'
    range: 'last 90 days'
    queries:
      - "APPLY supervised classification model (Random Forest) to multi-cloud connection sequences. ALERT if a sequence is classified as 'suspicious' with high confidence."