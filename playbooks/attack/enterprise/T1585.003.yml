name: T1585.003: Cloud Accounts
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: Investigates whether an adversary is developing resources using cloud accounts. This involves detecting suspicious sign-up activities, such as using disposable email services before accessing cloud provider sign-up pages. It also looks for unauthorized use of programmatic tools like Terraform or Boto3 from non-administrative systems, traffic from non-admin hosts to cloud management and billing pages, and a single host rapidly connecting to multiple distinct cloud providers, which may indicate 'cloud shopping' for vulnerable services.
type: technique
related:
  - TA0042: Resource Development
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has any host queried a disposable email domain and then connected to a cloud provider's account creation page within a short time window?
    context: This question aims to identify hosts potentially using temporary, untraceable email addresses to create new cloud accounts. Adversaries often use this method to obscure their identity when provisioning resources for their operations. Correlating DNS queries for disposable email services with subsequent connections to cloud sign-up pages is a strong indicator of this preparatory activity.
    answer_sources:
      - Zeek dns.log
      - Zeek http.log
      - Zeek conn.log
      - Zeek ssl.log
      - Corporate network egress points and internal DNS resolvers.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          WATCHLIST disposable_emails = [...]
          WATCHLIST cloud_signup_urls = [...]
          STREAM dns_logs
          | WHERE query IN disposable_emails
          | JOIN (STREAM http_ssl_logs WHERE url/sni IN cloud_signup_urls) ON source_ip
          | WHERE event_time_2 - event_time_1 < 5_minutes
  - question: Are multiple hosts exhibiting low-entropy (highly similar) web traffic patterns after querying disposable email domains, suggesting automated account creation?
    context: This question seeks to detect automated or scripted behavior across multiple systems. When an adversary uses a script to create numerous cloud accounts, the sequence of web requests will be nearly identical across different source hosts. A low entropy score for destination domains following a disposable email query indicates this lack of randomness and points to potentially malicious, automated activity.
    answer_sources:
      - Zeek dns.log
      - Zeek http.log
      - Zeek conn.log
      - Zeek ssl.log
      - Corporate network egress points and internal DNS resolvers.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR EACH source_ip:
            FIND events where DNS query is for a disposable_email domain
            COLLECT destination domains from http/ssl logs within 5 minutes after event
            CALCULATE entropy of collected domains
            ALERT if entropy is below historical baseline or dynamic threshold
  - question: Has any user's web browsing sequence, involving a disposable email provider and a cloud sign-up page, been identified as a statistical anomaly compared to normal behavior?
    context: This question leverages machine learning to identify user activity that deviates from established patterns of benign web browsing. A sequence analysis model can learn these patterns and flag an observed sequence—such as a visit to a disposable email site followed by a cloud account creation page—as highly improbable and therefore suspicious.
    answer_sources:
      - Zeek dns.log
      - Zeek http.log
      - Zeek conn.log
      - Zeek ssl.log
      - Corporate network egress points and internal DNS resolvers.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL sequence_model = train_on_benign_web_traffic_sequences(dns, http, ssl)
          FOR EACH real_time_event_sequence:
            CALCULATE probability = sequence_model.predict(sequence)
            ALERT if probability is below threshold AND sequence contains disposable_email and cloud_signup
  - question: Is an unauthorized host using a programmatic User-Agent to communicate with a cloud provider's API?
    context: This question looks for the use of infrastructure-as-code or automation tools (like Terraform, Boto3) from systems that are not explicitly authorized for such activity. Legitimate use of these tools is typically restricted to a small set of administrative servers. When such a User-Agent is seen from a standard user workstation, it suggests an adversary is using stolen credentials or a compromised host to programmatically manage cloud resources.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Windows Event ID 5156
      - User endpoint subnets, server subnets, and cloud management system enclaves.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          WATCHLIST programmatic_user_agents = ['Terraform/', 'Boto3', 'aws-sdk-', ...]
          ASSET_LIST authorized_admin_ips = [...]
          STREAM http_logs
          | WHERE user_agent IN programmatic_user_agents AND source_ip NOT IN authorized_admin_ips
  - question: Has a non-administrative host started using a rare or new programmatic User-Agent for the first time?
    context: This question establishes a behavioral baseline for each host's typical User-Agent strings. A sudden change, specifically the first-time use of a programmatic User-Agent on a non-administrative host, is a significant anomaly. It can indicate that a host has been compromised and is now being used for automated cloud interactions.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Windows Event ID 5156
      - User endpoint subnets, server subnets, and cloud management system enclaves.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR EACH host NOT IN authorized_admin_list:
            PROFILE historical_user_agents over 30 days
            ALERT if new_user_agent is programmatic AND not in historical_profile
  - question: Has any traffic to cloud APIs from an internal host been classified as an outlier by a machine learning model?
    context: This question uses an unsupervised machine learning model to find 'needles in a haystack'. The model learns the characteristics of legitimate administrative traffic to cloud APIs. Any traffic that does not conform to this learned profile is flagged as an outlier for investigation, which can catch sophisticated attacks that might evade simple rule-based detections.
    answer_sources:
      - Zeek http.log
      - Zeek conn.log
      - Windows Event ID 5156
      - User endpoint subnets, server subnets, and cloud management system enclaves.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL outlier_model = train_one_class_svm_on_legit_cloud_api_traffic_features()
          FOR EACH internal_connection_to_cloud_api:
            CLASSIFY connection with outlier_model
            ALERT if connection is classified as 'outlier'
  - question: Has a host not belonging to the 'Cloud Administrators' group connected to cloud account management, billing, or IAM pages?
    context: This question enforces access control policies at the network level. Access to sensitive cloud management portals should be restricted to a specific group of administrators. Any connection to these pages from a standard user workstation is a policy violation and a strong indicator of either credential compromise or an insider threat.
    answer_sources:
      - Zeek dns.log
      - Zeek http.log
      - Zeek ssl.log
      - Windows Event ID 5156
      - User endpoint subnets, corporate network egress points, and VPN concentrators.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          WATCHLIST cloud_mgmt_uris = ['.../billing', '.../iam', 'myaccount.google.com', ...]
          ASSET_GROUP cloud_admins_ips = [...]
          STREAM dns/http/ssl_logs
          | WHERE destination IN cloud_mgmt_uris AND source_ip NOT IN cloud_admins_ips
  - question: Has a non-administrative host shown an anomalous spike in connections to cloud management domains compared to its own history or its peer group?
    context: This question establishes a baseline of normal activity to identify abnormal behavior. While a non-administrator might occasionally visit a cloud login page, a sudden increase in the frequency of these connections is suspicious. Comparing an individual's activity against their own historical baseline and their peer group average helps to pinpoint true outliers.
    answer_sources:
      - Zeek dns.log
      - Zeek http.log
      - Zeek ssl.log
      - Windows Event ID 5156
      - User endpoint subnets, corporate network egress points, and VPN concentrators.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR EACH non_admin_host:
            CALCULATE daily_connection_count to cloud_mgmt_domains
            COMPARE to 30-day historical baseline for host and its peer group
            ALERT if count > 98th_percentile_of_host_baseline OR count > 3_std_dev_of_peer_group
  - question: Are there any web traffic sessions to cloud management domains that are statistical outliers in terms of session characteristics?
    context: This question analyzes the qualitative nature of a web session. Legitimate administrative sessions often have predictable characteristics (duration, pages visited). By clustering sessions based on these features, we can identify normal patterns. Sessions that don't fit into any cluster (outliers) may represent an adversary's interactive exploration of a compromised cloud account.
    answer_sources:
      - Zeek dns.log
      - Zeek http.log
      - Zeek ssl.log
      - Windows Event ID 5156
      - User endpoint subnets, corporate network egress points, and VPN concentrators.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SESSIONIZE web traffic to cloud_mgmt_domains
          EXTRACT features (duration, uri_count, bytes_transferred)
          CLUSTER sessions using DBSCAN
          ALERT on sessions classified as noise/outliers
  - question: Has any single host connected to three or more different cloud providers within a one-hour window?
    context: This question aims to detect 'cloud shopping' behavior. It is unusual for a typical user or server to rapidly connect to a wide variety of cloud providers (e.g., AWS, Azure, GCP, DigitalOcean). An adversary might do this to probe for weaknesses or distribute their infrastructure, making this a valuable indicator of suspicious resource development.
    answer_sources:
      - Zeek dns.log
      - Zeek conn.log
      - Zeek ssl.log
      - Windows Event ID 5156
      - Corporate network egress points, internal DNS resolvers, and VPN user subnets.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          WATCHLIST cloud_provider_domains = {aws: [...], azure: [...], gcp: [...], ...}
          FOR EACH source_ip:
            COUNT distinct cloud_providers contacted in 1-hour window
            ALERT if count >= 3
  - question: Has any host exhibited an anomalous increase in the number of distinct cloud providers it contacts compared to its baseline or its peer group?
    context: This question applies baselining to the 'cloud shopping' detection. Instead of a static threshold, it looks for a change in behavior. A host that normally only contacts AWS suddenly starting to contact Azure and GCP is a significant deviation. This method can more accurately identify suspicious multi-cloud activity while ignoring benign multi-cloud administrators.
    answer_sources:
      - Zeek dns.log
      - Zeek conn.log
      - Zeek ssl.log
      - Windows Event ID 5156
      - Corporate network egress points, internal DNS resolvers, and VPN user subnets.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR EACH host:
            CALCULATE daily baseline of distinct_cloud_providers_contacted
            IN a 1-hour window, count distinct_cloud_providers_contacted
            ALERT if hourly_count > 99th_percentile of host's daily_baseline
  - question: Has a machine learning model classified any host's multi-cloud connection activity as suspicious?
    context: This question uses a supervised machine learning model to provide a more nuanced detection of malicious 'cloud shopping'. The model can be trained to distinguish between legitimate multi-cloud administration and an adversary's activity by considering features like the specific endpoints visited (marketing pages vs. API consoles), timing, and data volumes.
    answer_sources:
      - Zeek dns.log
      - Zeek conn.log
      - Zeek ssl.log
      - Windows Event ID 5156
      - Corporate network egress points, internal DNS resolvers, and VPN user subnets.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL multi_cloud_model = train_classifier_on_labeled_activity()
          EXTRACT features from multi-cloud connection sequences
          FOR EACH sequence:
            PREDICT classification = multi_cloud_model.predict(sequence)
            ALERT if classification is 'suspicious' with high confidence