name: 'T1600: Weaken Encryption'
id: 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d'
description: "This playbook investigates whether an adversary is attempting to evade defenses by weakening encryption. This can manifest in several ways, including establishing TLS/SSL connections to known malicious infrastructure, forcing the use of deprecated or weak cryptographic protocols and ciphers, communicating with critical assets over unencrypted cleartext channels, modifying system-level cryptographic settings on endpoints, or gaining unauthorized access to network devices to manipulate their configurations. The goal is to detect these activities across network traffic and endpoint logs to identify and respond to attempts to undermine the confidentiality and integrity of communications."
type: 'technique'
related:
  - 'TA0005: Defense Evasion'
contributors:
  - 'Zachary Szewczyk, Ask Sage'
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: 'none'
questions:
  - question: "Is a network device or internal host establishing a TLS/SSL connection with a known adversary command and control (C2) IP address or domain?"
    context: "This question aims to detect a high-fidelity indicator of compromise. Adversaries often use encrypted channels to their C2 infrastructure for stealth. By correlating outbound network connections with up-to-date threat intelligence feeds of known malicious domains and IPs, we can quickly identify potential C2 communications. Enriching alerts with GeoIP and WHOIS data provides immediate context for triage and incident response."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ssl.log"
      - "Zeek dns.log"
      - "Network egress points, such as firewalls and web proxies, and management interfaces of network devices (routers, switches, VPN concentrators)."
    range: "last 90 days"
    queries:
      - "pseudocode: SEARCH Zeek logs WHERE (destination_ip IN threat_feed_ips) OR (server_name IN threat_feed_domains). ALERT on match. ENRICH with GeoIP and WHOIS."
  - question: "Are there any outbound TLS connections using rare or non-standard client (JA3) or server (JA3S) fingerprints?"
    context: "JA3 and JA3S hashes fingerprint the cryptographic parameters of a TLS client and server, respectively. Malware and non-standard tools often use libraries that produce unique or rare fingerprints. By establishing a baseline of common JA3/JA3S pairs in the environment, we can hunt for outliers. A connection using a very rare fingerprint could indicate the presence of malicious software attempting to communicate."
    answer_sources:
      - "Zeek ssl.log"
      - "Network egress points, such as firewalls and web proxies, and management interfaces of network devices (routers, switches, VPN concentrators)."
    range: "last 90 days"
    queries:
      - "pseudocode: CALCULATE frequency of all JA3/JA3S pairs over 30 days. SEARCH Zeek ssl.log for connections WHERE JA3/JA3S frequency is in the bottom 1st percentile. ALERT on match."
  - question: "Has any internal host exhibited an anomalous spike in the volume of new outbound TLS sessions, deviating from its typical behavior?"
    context: "Adversary C2 activity often involves regular, periodic connections (beacons). While a single connection may look benign, a sudden increase in the rate of connections from a specific host can be anomalous. This question uses time-series forecasting to model the normal connection behavior for each host and detects significant deviations that could represent the start of C2 beaconing."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek ssl.log"
      - "Zeek dns.log"
      - "Network egress points, such as firewalls and web proxies, and management interfaces of network devices (routers, switches, VPN concentrators)."
    range: "last 90 days"
    queries:
      - "pseudocode: TRAIN time-series model on historical TLS session volume per host. PREDICT expected volume. ALERT if actual volume significantly exceeds predicted volume."
  - question: "Is a TLS/SSL session being established that violates security policy by using a deprecated protocol version, a weak cipher suite, or an insufficient certificate key length?"
    context: "This question directly audits network traffic against established security policies. Adversaries may intentionally force a downgrade to a weaker protocol or cipher (e.g., SSLv3, RC4) to exploit known vulnerabilities or to make decryption easier. This is a high-confidence indicator of either a misconfiguration or a malicious downgrade attack."
    answer_sources:
      - "Zeek ssl.log"
      - "All network segments, with a focus on traffic to/from critical assets (e.g., authentication servers, database servers, application servers) and all network egress points."
    range: "last 90 days"
    queries:
      - "pseudocode: DEFINE watchlist of weak protocols, ciphers, key lengths. SEARCH Zeek ssl.log WHERE version IN weak_protocols OR cipher IN weak_ciphers OR key_length < minimum. ALERT on match."
  - question: "Has the overall proportion of policy-non-compliant TLS sessions across the network increased significantly?"
    context: "This question moves from single-instance detection to trend analysis to identify systemic issues. A sudden, network-wide increase in the use of weak encryption could indicate a large-scale, coordinated downgrade attack or a widespread, risky misconfiguration being actively exploited by an adversary. Monitoring this ratio provides a macro-level view of the organization's cryptographic health."
    answer_sources:
      - "Zeek ssl.log"
      - "All network segments, with a focus on traffic to/from critical assets (e.g., authentication servers, database servers, application servers) and all network egress points."
    range: "last 90 days"
    queries:
      - "pseudocode: CALCULATE hourly ratio of compliant vs non-compliant sessions. CALCULATE 30-day moving average and standard deviation. ALERT if current ratio is > 3 standard deviations from the average."
  - question: "Can machine learning identify complex patterns of non-compliant or suspicious TLS sessions that simple rules might miss?"
    context: "Simple rule-based detection can miss nuanced or novel attacks. A machine learning classifier can be trained on a wide range of TLS session features (version, cipher, certificate validity, session resumption, etc.) to learn the complex characteristics of a 'suspicious' session. This allows for the detection of anomalous combinations of parameters that, while not individually violating a strict rule, together represent a deviation from normal, secure traffic."
    answer_sources:
      - "Zeek ssl.log"
      - "All network segments, with a focus on traffic to/from critical assets (e.g., authentication servers, database servers, application servers) and all network egress points."
    range: "last 90 days"
    queries:
      - "pseudocode: TRAIN classifier on labeled Zeek ssl.log data. PREDICT 'compliant' or 'suspicious' for new sessions. ALERT on 'suspicious' classification."
  - question: "Is unencrypted, cleartext protocol traffic being sent to a critical asset that requires encrypted communication?"
    context: "This is a critical policy violation check. Critical assets like domain controllers, database servers, or administrative portals should never communicate over cleartext protocols like HTTP, FTP, or Telnet. Any such traffic is a high-confidence indicator of either a severe misconfiguration or active malicious behavior, such as credential sniffing or lateral movement, and requires immediate investigation."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek http.log"
      - "Zeek ftp.log"
      - "Network segments containing designated critical assets, such as data center networks, management VLANs, and segments hosting authentication servers (e.g., Active Directory Domain Controllers)."
    range: "last 90 days"
    queries:
      - "pseudocode: DEFINE list of critical_asset_ips and cleartext_ports. SEARCH Zeek conn.log WHERE destination_ip IN critical_asset_ips AND destination_port IN cleartext_ports. ALERT on match."
  - question: "Has the ratio of encrypted to unencrypted traffic within a critical network segment dropped significantly?"
    context: "This question monitors for environmental shifts within sensitive network zones. A sudden drop in the proportion of encrypted traffic could indicate that an adversary has successfully reconfigured services to use cleartext protocols, or that a new, unauthorized cleartext service has been activated for data exfiltration or internal reconnaissance. This provides a baseline-driven method to detect such changes."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek http.log"
      - "Zeek ftp.log"
      - "Network segments containing designated critical assets, such as data center networks, management VLANs, and segments hosting authentication servers (e.g., Active Directory Domain Controllers)."
    range: "last 90 days"
    queries:
      - "pseudocode: CALCULATE daily ratio of encrypted_bytes vs unencrypted_bytes in critical segments. ALERT if ratio drops significantly (e.g., > 2 standard deviations from 30-day average)."
  - question: "Are there unusual clusters of network traffic involving critical assets communicating over cleartext protocols?"
    context: "This question uses unsupervised machine learning to find anomalous behavior without pre-defined rules. Clustering algorithms can group all network sessions by their characteristics (hosts, ports, protocol, data volume). Normal, expected cleartext traffic (e.g., DNS) will form its own clusters. A critical asset IP suddenly appearing in a cleartext cluster, or forming a new, small cluster of cleartext activity, is a strong anomaly signal that warrants investigation."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek http.log"
      - "Zeek ftp.log"
      - "Network segments containing designated critical assets, such as data center networks, management VLANs, and segments hosting authentication servers (e.g., Active Directory Domain Controllers)."
    range: "last 90 days"
    queries:
      - "pseudocode: CLUSTER Zeek conn.log data based on features (hosts, ports, proto, bytes). IDENTIFY clusters representing normal cleartext traffic. ALERT if a critical asset IP appears in a cleartext cluster."
  - question: "Has a critical cryptographic registry key, such as the SCHANNEL key, been modified by an unauthorized process or user?"
    context: "This is a host-based detection for a specific and critical adversary action. The Windows SCHANNEL registry path controls system-wide TLS/SSL settings. An adversary modifying these keys is a direct attempt to weaken the host's encryption capabilities. By enabling auditing (SACL) on these keys and alerting on any modification (Event ID 4657) by a process not on an explicit allowlist (e.g., trusted patch management software), we can detect this technique with high fidelity."
    answer_sources:
      - "Windows Event ID 4657"
      - "Windows Event ID 4688"
      - "Windows Event ID 4663"
      - "Critical servers (especially web servers), domain controllers, and administrator workstations where system-wide cryptographic policies are managed."
    range: "last 90 days"
    queries:
      - "pseudocode: ENABLE auditing on SCHANNEL keys. SEARCH for Event ID 4657 on SCHANNEL objects. CORRELATE with parent process (Event ID 4688). ALERT if modifying process is not on allowlist."
  - question: "Has a modification to cryptographic registry settings occurred that is rare or anomalous based on the user, process, and time of day?"
    context: "This question adds behavioral context to registry modifications. While some changes are legitimate (e.g., during patching), they typically occur at predictable times by specific service accounts. A modification made by an interactive user account, especially outside of business hours, is highly suspicious even if the user has administrative privileges. This method scores the rarity of the event to surface high-risk changes that might otherwise be lost in the noise."
    answer_sources:
      - "Windows Event ID 4657"
      - "Windows Event ID 4688"
      - "Windows Event ID 4663"
      - "Critical servers (especially web servers), domain controllers, and administrator workstations where system-wide cryptographic policies are managed."
    range: "last 90 days"
    queries:
      - "pseudocode: PROFILE normal modification events (user, process, time). CALCULATE rarity score for new modifications. ALERT if score is high."
  - question: "Does a sequence of events leading to a cryptographic setting modification deviate from the pattern of normal administrative activity?"
    context: "This question analyzes the entire chain of activity, not just the modification event itself. Normal administration has a typical workflow (e.g., RDP login, run specific tool, log off). An adversary's workflow might be different (e.g., spawn from a web shell, use PowerShell, then modify the registry). An outlier detection model can learn the 'normal' sequences of events and flag these anomalous chains as suspicious."
    answer_sources:
      - "Windows Event ID 4657"
      - "Windows Event ID 4688"
      - "Windows Event ID 4663"
      - "Critical servers (especially web servers), domain controllers, and administrator workstations where system-wide cryptographic policies are managed."
    range: "last 90 days"
    queries:
      - "pseudocode: TRAIN outlier detection model (e.g., Isolation Forest) on normal event sequences (e.g., 4688 -> 4657). ALERT if a new sequence is flagged as an outlier."
  - question: "Has a management session been established to a core network device from an unauthorized source IP address?"
    context: "This question is about enforcing strict access control. Management interfaces of firewalls, routers, and switches are high-value targets. Access should be strictly limited to a small set of administrative workstations or 'jump boxes.' Any connection attempt, successful or not, from an IP address outside this pre-approved allowlist is a serious security event and could indicate an adversary attempting to reconfigure the network or pivot."
    answer_sources:
      - "Zeek conn.log"
      - "Windows Event ID 4624"
      - "Management VLANs, administrator jump boxes, and the network interfaces of core network infrastructure like firewalls, routers, and VPN concentrators."
    range: "last 90 days"
    queries:
      - "pseudocode: DEFINE allowlist of admin source IPs and list of network device mgmt IPs/ports. SEARCH Zeek conn.log WHERE destination is mgmt interface AND source_ip is NOT in allowlist. ALERT on match."
  - question: "Did an authenticated administrative session to a network device exhibit anomalous characteristics, such as an unusual login time or abnormal data transfer volume for that specific user?"
    context: "This provides user-centric behavioral analysis for authenticated sessions. Even if legitimate credentials are used, the behavior might be anomalous if the account is compromised. By baselining what is normal for each administrator (e.g., typical login times, data transferred, source subnet), we can detect multi-dimensional outliers that could signify an attacker using stolen credentials."
    answer_sources:
      - "Zeek conn.log"
      - "Windows Event ID 4624"
      - "Management VLANs, administrator jump boxes, and the network interfaces of core network infrastructure like firewalls, routers, and VPN concentrators."
    range: "last 90 days"
    queries:
      - "pseudocode: BASELINE login time, source, data volume per admin user. ALERT if a new login is a multi-dimensional outlier (e.g., unusual time AND unusual data volume)."
  - question: "Can an autoencoder model detect administrative sessions to network devices that do not conform to learned patterns of normal activity?"
    context: "This question applies a more advanced anomaly detection technique to network session data. An autoencoder is a neural network trained to 'reconstruct' normal data. When it is fed an anomalous session (e.g., an attacker's session with different duration, data volume, and time-of-day characteristics), it will have a high 'reconstruction error,' signaling a deviation from the learned norm that warrants investigation."
    answer_sources:
      - "Zeek conn.log"
      - "Windows Event ID 4624"
      - "Management VLANs, administrator jump boxes, and the network interfaces of core network infrastructure like firewalls, routers, and VPN concentrators."
    range: "last 90 days"
    queries:
      - "pseudocode: TRAIN autoencoder on vectors of normal admin session features. ALERT on new sessions with a high reconstruction error."
  - question: "Has a file been transferred from a network infrastructure device to a destination server that is not an approved configuration backup or management server?"
    context: "Adversaries may try to steal device configurations to find vulnerabilities or exfiltrate modified firmware. This question checks for any file transfers (via FTP, SCP, TFTP, etc.) originating from a network device's IP and going to an unauthorized destination. This is a direct indicator of potential data theft or staging of a malicious firmware image."
    answer_sources:
      - "Zeek files.log"
      - "Zeek conn.log"
      - "Network infrastructure devices, configuration backup servers, TFTP/FTP servers, and network egress points."
    range: "last 90 days"
    queries:
      - "pseudocode: DEFINE list of network device IPs and allowed backup server IPs. SEARCH Zeek logs for file transfers WHERE source is network device AND destination is NOT an allowed server. ALERT on match."
  - question: "Was a file transferred from a network device that was unusually large or had a high-entropy (random-looking) filename?"
    context: "This question adds suspicious characteristics to file transfers. A normal configuration file is typically small; a full firmware image is much larger. An unusually large file transfer could indicate exfiltration of a modified firmware. Furthermore, high-entropy filenames are a common tactic for obfuscation used by malware and attackers to evade signature-based detections."
    answer_sources:
      - "Zeek files.log"
      - "Zeek conn.log"
      - "Network infrastructure devices, configuration backup servers, TFTP/FTP servers, and network egress points."
    range: "last 90 days"
    queries:
      - "pseudocode: BASELINE config file sizes from network devices. ALERT if transferred file size > 99th percentile. CALCULATE Shannon entropy of filenames from network devices. ALERT if entropy > 4.0."
  - question: "Can a machine learning model distinguish between a legitimate backup operation and an anomalous file transfer from a network device?"
    context: "This question uses machine learning to learn the subtle, multi-faceted patterns of legitimate backup operations. A model can be trained on features like protocol, file type, size, time of day, and source/destination that constitute a normal backup. It can then flag transfers that deviate from this learned pattern, providing a more robust detection capability than simple rules alone."
    answer_sources:
      - "Zeek files.log"
      - "Zeek conn.log"
      - "Network infrastructure devices, configuration backup servers, TFTP/FTP servers, and network egress points."
    range: "last 90 days"
    queries:
      - "pseudocode: TRAIN classifier on labeled file transfer data to distinguish 'legitimate backup' from 'anomalous transfer'. ALERT on 'anomalous transfer' prediction."