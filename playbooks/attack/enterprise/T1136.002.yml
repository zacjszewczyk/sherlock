name: T1136.002: Domain Account
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook focuses on detecting adversaries creating new domain accounts to maintain persistence within a network. Detections are based on correlating account creation events with known malicious indicators (e.g., process hashes from threat intelligence), identifying creations from high-risk hosts, analyzing command-line arguments for suspicious patterns or obfuscation, flagging creations with statistically rare attributes (e.g., unusual time or source), monitoring for anomalous post-creation behavior (e.g., rapid lateral movement), and identifying immediate privilege escalation following an account's creation.
type: technique
related:
- TA0003: Persistence
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
investigative_questions:
- question: Was a domain account created by a process whose executable hash is known to be malicious?
  context: This question aims to directly link account creation to known malware. Adversaries often use custom or known malicious tools to create persistence accounts. By correlating the account creation event (Windows Event ID 4720) with the parent process event (Windows Event ID 4688) and checking the process hash against threat intelligence, we can identify high-confidence malicious activity.
  answer_sources:
  - Windows Event ID 4720
  - Windows Event ID 4688
  - Threat Intelligence Feed
  - Domain Controllers
  - Log Aggregation Platform (SIEM)
  - Endpoint Detection and Response (EDR) Platform
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each event 4720, FIND parent process from event 4688. GET file_hash of parent process. CHECK file_hash against threat_intel_feed. ALERT on match.
- question: Was a domain account created from a host that is already considered high-risk?
  context: This question helps identify account creations that occur on systems already exhibiting suspicious behavior. A host with a high-risk score (based on prior security alerts) is a more likely platform for an adversary to operate from. Creating an account from such a compromised system is a common step in furthering an attack.
  answer_sources:
  - Windows Event ID 4720
  - Windows Event ID 4688
  - Threat Intelligence Feed
  - Domain Controllers
  - Log Aggregation Platform (SIEM)
  - Endpoint Detection and Response (EDR) Platform
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each event 4720, GET source_host. GET risk_score for source_host. IF risk_score > threshold, ALERT.
- question: Does a new domain account creation event exhibit characteristics similar to historically confirmed malicious account creations?
  context: This question uses machine learning to find subtle patterns indicative of malicious account creation. By training a model on features from both the creation event and the parent process (like process name, command line, user context, time), it can learn to distinguish malicious activity from benign administrative actions, even for novel threats.
  answer_sources:
  - Windows Event ID 4720
  - Windows Event ID 4688
  - Threat Intelligence Feed
  - Domain Controllers
  - Log Aggregation Platform (SIEM)
  - Endpoint Detection and Response (EDR) Platform
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each event 4720 and parent 4688, EXTRACT features (process_name, cmd_line, user, host, time). INPUT features into classification_model. IF model_score > 0.8, ALERT.
- question: Was a process executed on a Domain Controller with command-line arguments explicitly used for creating a domain account?
  context: This question targets the direct command-line evidence of domain account creation. Monitoring for specific command strings like `net user /add /domain` or `New-ADUser` on Domain Controllers provides a high-fidelity signal that an account creation was attempted, which can then be scrutinized for legitimacy.
  answer_sources:
  - Windows Event ID 4688
  - Domain Controllers
  - Administrative Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH 4688 events on DCs WHERE command_line contains ("net user /add /domain") OR command_line contains ("New-ADUser"). ALERT on match.
- question: Does the command line used to create a domain account show signs of high entropy, suggesting obfuscation?
  context: Adversaries often obfuscate their commands to evade simple keyword-based detection. High Shannon entropy in a command-line string can indicate the presence of encoded or randomized characters, a common obfuscation technique. This question helps detect such attempts by comparing the entropy of a command against a baseline for that specific process.
  answer_sources:
  - Windows Event ID 4688
  - Domain Controllers
  - Administrative Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each 4688 event on DC, CALCULATE entropy of command_line. GET baseline_entropy for process_name. IF entropy > (baseline + 3 * std_dev), ALERT.
- question: Does the command-line structure used for account creation deviate from established patterns of legitimate administrative activity?
  context: This question uses NLP to understand the "topics" or patterns in legitimate command-line usage. A command used by an adversary might be structurally different, even if it uses legitimate tools. By identifying commands that don't fit into known "legitimate" clusters, this method can flag novel or unusual malicious commands.
  answer_sources:
  - Windows Event ID 4688
  - Domain Controllers
  - Administrative Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each 4688 event on DC, CLASSIFY command_line against NLP topic model. IF command_line is outlier to known legitimate topics, ALERT.
- question: Was a domain account created by an unauthorized user or from an unauthorized workstation?
  context: This is a fundamental security check. Domain account creation is a highly privileged action that should only be performed by specific administrative accounts from designated, secured workstations. This question enforces that policy by alerting on any deviation, which is a strong indicator of either policy violation or malicious activity.
  answer_sources:
  - Windows Event ID 4720
  - Active Directory
  - Domain Controllers
  - Human Resources Systems
  - Help Desk Ticketing Systems
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each event 4720, GET creator_user and source_host. IF creator_user NOT IN authorized_user_list OR source_host NOT IN authorized_workstation_list, ALERT.
- question: Was a domain account created by an authorized administrator at an unusual time (e.g., late at night, on a weekend)?
  context: Even legitimate administrators have patterns of behavior. An adversary who has compromised an admin account may not adhere to these patterns. This question aims to detect such compromises by baselining the normal working hours for each admin and alerting on account creation activities that occur at statistically improbable times for that specific user.
  answer_sources:
  - Windows Event ID 4720
  - Active Directory
  - Domain Controllers
  - Human Resources Systems
  - Help Desk Ticketing Systems
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each event 4720, GET creator_user and event_time. COMPARE event_time to historical profile for creator_user. IF event_time is in bottom 5% of frequency, ALERT.
- question: Does the combination of creator, source workstation, and time of a domain account creation event represent a statistical anomaly compared to past legitimate creations?
  context: This question uses unsupervised machine learning to detect anomalous account creations without pre-labeled data. The model learns what "normal" looks like based on a combination of features (creator, source, time). It can then flag any new event that deviates significantly from this multi-dimensional norm, catching unusual combinations that might be missed by single-factor rules.
  answer_sources:
  - Windows Event ID 4720
  - Active Directory
  - Domain Controllers
  - Human Resources Systems
  - Help Desk Ticketing Systems
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each event 4720, EXTRACT features (creator, source_ip, time). INPUT features into anomaly_detection_model. IF model flags as anomaly, ALERT.
- question: Did a newly created domain account's first action involve an interactive logon to a critical 'Crown Jewel' asset?
  context: The initial actions of a new account are highly informative. A legitimate new user account typically accesses standard resources first. An immediate interactive logon to a highly sensitive server, like a Domain Controller or a database with PII, is highly anomalous and suspicious, suggesting the account was created for a specific malicious purpose.
  answer_sources:
  - Windows Event ID 4720
  - Windows Event ID 4624
  - Zeek conn.log
  - Zeek dns.log
  - Domain Controllers
  - Critical Servers
  - Network Gateway/Egress Points
  - Endpoint Devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: ON new account creation (4720), MONITOR for 48h. IF first logon (4624) is Type 2 or 10 AND destination is in crown_jewel_list, ALERT.
- question: Did a newly created domain account log into an anomalously high number of distinct systems within its first 48 hours?
  context: This question aims to detect rapid lateral movement. Adversaries often use a newly created account to quickly access and explore numerous systems on the network. By baselining the typical number of systems a new user logs into, we can flag accounts that exhibit this "land rush" behavior, which is a strong indicator of compromise.
  answer_sources:
  - Windows Event ID 4720
  - Windows Event ID 4624
  - Zeek conn.log
  - Zeek dns.log
  - Domain Controllers
  - Critical Servers
  - Network Gateway/Egress Points
  - Endpoint Devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: ON new account creation (4720), COUNT distinct logon destinations (4624) in first 48h. IF count > 99th_percentile_baseline, ALERT.
- question: Does the network traffic pattern of a newly created account deviate significantly from the established baseline for new accounts within the first 48 hours?
  context: This question looks for anomalous network behavior, such as data exfiltration, C2 communication, or network scanning, performed by a new account. By creating a time-series model of normal network activity (bytes sent/received, connection counts) for legitimate new accounts, we can detect significant deviations that may indicate malicious use of the newly created account.
  answer_sources:
  - Windows Event ID 4720
  - Windows Event ID 4624
  - Zeek conn.log
  - Zeek dns.log
  - Domain Controllers
  - Critical Servers
  - Network Gateway/Egress Points
  - Endpoint Devices
  range: last 90 days
  queries:
  - technology: pseudocode
    query: ON new account creation (4720), MONITOR network traffic for 48h. COMPARE traffic pattern to time-series forecast model. IF traffic is outside 95% prediction interval, ALERT.
- question: Was a newly created domain account immediately added to a high-privilege group like 'Domain Admins'?
  context: This sequence of events—account creation immediately followed by addition to a privileged group—is a classic and high-confidence indicator of a persistence mechanism being established. This question creates a correlation rule to detect this specific, highly suspicious workflow in near-real time.
  answer_sources:
  - Windows Event ID 4720
  - Windows Event ID 4738
  - Windows Event ID 4728
  - Windows Event ID 4732
  - Windows Event ID 4756
  - Domain Controllers
  - Active Directory Database
  range: last 90 days
  queries:
  - technology: pseudocode
    query: TRIGGER on event 4720. LOOK for event (4728, 4732, 4756) for same user_sid within 10 minutes. IF group is in privileged_group_list, CRITICAL ALERT.
- question: Is the username of a newly created account suspiciously similar to an existing privileged account (e.g., 'Admin' vs. 'Admln')?
  context: This question aims to detect typosquatting, a technique where an adversary creates an account with a name very similar to a legitimate privileged account to deceive administrators or evade detection. By using the Levenshtein distance to measure string similarity, we can automatically flag these potentially deceptive usernames.
  answer_sources:
  - Windows Event ID 4720
  - Windows Event ID 4738
  - Windows Event ID 4728
  - Windows Event ID 4732
  - Windows Event ID 4756
  - Domain Controllers
  - Active Directory Database
  range: last 90 days
  queries:
  - technology: pseudocode
    query: ON event 4720, GET new_username. FOR each privileged_user in privileged_user_list, CALCULATE levenshtein_distance(new_username, privileged_user). IF distance <= 2, ALERT.
- question: Did the sequence of management events following a new account's creation (e.g., group memberships, attribute changes) deviate from the normal, automated provisioning workflow?
  context: Legitimate account creation is often part of a standardized, automated workflow involving a predictable sequence of events. An adversary's actions might follow a different, anomalous sequence. This question uses sequence analysis (like a Markov Chain) to model the legitimate workflow and flag any new account whose initial management lifecycle doesn't fit the established pattern.
  answer_sources:
  - Windows Event ID 4720
  - Windows Event ID 4738
  - Windows Event ID 4728
  - Windows Event ID 4732
  - Windows Event ID 4756
  - Domain Controllers
  - Active Directory Database
  range: last 90 days
  queries:
  - technology: pseudocode
    query: ON event 4720, CAPTURE sequence of management events (4738, 4728, etc.) for 1 hour. CALCULATE probability of sequence using sequence_analysis_model. IF probability is low, ALERT.