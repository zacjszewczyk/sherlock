name: 'T1669: Wi-Fi Networks'
id: f1c2d3a4-b567-4890-a123-b4c5d6e7f890
description: |
  This playbook helps determine if an adversary has gained initial access to the network via Wi-Fi. It focuses on identifying malicious or unauthorized wireless activity by analyzing various indicators. These include Wi-Fi authentication events involving known malicious devices, the execution of Wi-Fi attack tools on endpoints, the presence of rogue or evil twin access points, brute-force authentication attacks, connections from unauthorized or spoofed MAC addresses, and hosts improperly bridging wired and wireless network segments.
type: technique
related:
  - 'TA0001: Initial Access'
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are there any successful or failed Wi-Fi authentications from devices or to access points on a threat intelligence watchlist?
    context: |
      This question aims to detect known malicious actors attempting to connect to the corporate wireless network. By cross-referencing real-time authentication logs with a curated list of malicious or unauthorized MAC addresses (for clients) and BSSIDs (for access points), the organization can quickly identify and block connection attempts from previously identified threats.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek radius.log
      - Wireless controller event logs
      - Corporate wireless controllers, RADIUS authentication servers, Network monitoring sensors at Wi-Fi segment boundaries
    range: last 90 days
    queries:
      - pseudocode: |
          SEARCH wireless_auth_logs
          JOIN with threat_intel_watchlist ON (source_mac = watchlist_mac OR bssid = watchlist_bssid)
          WHERE auth_status IN ('success', 'failure')
          ALERT on any match
  - question: Has a device with a rare or unusual hardware manufacturer (OUI) connected to the Wi-Fi network?
    context: |
      This question uses statistical analysis to spot potentially unauthorized hardware. Adversaries may use specialized or non-standard equipment for their attacks. By analyzing the Organizationally Unique Identifier (OUI) part of the client MAC address, we can identify manufacturers that are rarely seen on the network. A new connection from a very infrequent OUI could indicate an unauthorized or malicious device.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek radius.log
      - Wireless controller event logs
      - Corporate wireless controllers, RADIUS authentication servers, Network monitoring sensors at Wi--Fi segment boundaries
    range: last 90 days
    queries:
      - pseudocode: |
          CALCULATE OUI frequency distribution from wireless_auth_logs over last 30 days
          FOR each new connection:
            EXTRACT OUI from client_mac
            IF OUI_frequency is in bottom 5th percentile:
              ALERT for rare hardware connection
  - question: Has a machine learning model classified any new Wi-Fi connection as malicious?
    context: |
      This question leverages a machine learning model to detect subtle patterns of malicious behavior that rule-based systems might miss. By training a model on features like the hardware manufacturer (OUI), time of day, access point location, and authentication type, it can learn to distinguish between normal and malicious connection patterns and score new connections in real-time.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek radius.log
      - Wireless controller event logs
      - Corporate wireless controllers, RADIUS authentication servers, Network monitoring sensors at Wi-Fi segment boundaries
    range: last 90 days
    queries:
      - pseudocode: |
          FOR each new Wi-Fi connection event:
            SCORE event with pre-trained classification model
            IF model_prediction is 'malicious' AND confidence_score > 0.9:
              ALERT for ML-detected malicious connection
  - question: Have any known Wi-Fi reconnaissance or attack tools been executed on corporate endpoints?
    context: |
      This question looks for direct evidence of an adversary's intent by searching for the execution of specialized Wi-Fi hacking tools. The presence of processes like 'aircrack-ng', 'kismet', or 'reaver' on a corporate endpoint is a high-confidence indicator that an attacker is actively attempting to survey, crack, or otherwise compromise the wireless network.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek software.log
      - All corporate endpoints (especially laptops and mobile devices), Domain Controllers and SIEM for log aggregation
    range: last 90 days
    queries:
      - pseudocode: |
          SEARCH process_creation_logs
          WHERE process_name IN (wifi_attack_tool_watchlist) OR process_hash IN (wifi_attack_tool_hashes) OR command_line contains (wifi_attack_tool_patterns)
          ALERT on any match
  - question: Has a standard network utility process, like 'netsh.exe', been executed with an unusually complex or obfuscated command line?
    context: |
      This question aims to uncover adversaries "living off the land" by using legitimate system tools for malicious purposes. Attackers often use complex or obfuscated command-line arguments to hide their actions. By calculating the entropy (randomness) of command-line arguments for common utilities and comparing it to a baseline, we can flag commands that are anomalously complex, which may indicate malicious activity.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek software.log
      - All corporate endpoints (especially laptops and mobile devices), Domain Controllers and SIEM for log aggregation
    range: last 90 days
    queries:
      - pseudocode: |
          FOR each 'netsh.exe' process creation event:
            CALCULATE shannon_entropy of command_line_arguments
            FETCH historical entropy baseline for 'netsh.exe'
            IF current_entropy > 95th_percentile of baseline:
              ALERT for anomalous command-line complexity
  - question: Following the execution of a suspicious process, did the host exhibit anomalous network behavior?
    context: |
      This question increases the confidence of an alert by requiring two separate but related pieces of evidence. It correlates a process-based alert (e.g., a known Wi-Fi tool was run) with a network-based anomaly (e.g., the host started communicating with unusual destinations). This combination makes it much more likely that the activity is genuinely malicious.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek software.log
      - All corporate endpoints (especially laptops and mobile devices), Domain Controllers and SIEM for log aggregation
    range: last 90 days
    queries:
      - pseudocode: |
          WHEN process_alert fires for a host:
            QUERY network_anomaly_model for host in the next 5 minutes
            IF network_anomaly_model also flags the host's behavior:
              ESCALATE original process_alert
  - question: Is there an unauthorized access point broadcasting a corporate SSID or an authorized AP using a weak security configuration?
    context: |
      This question is designed to detect "Evil Twin" and "Rogue AP" attacks. An Evil Twin is an access point set up by an attacker that mimics a legitimate corporate SSID to trick users into connecting. A Rogue AP is any unauthorized access point connected to the corporate network. This query checks all observed APs against a known-good inventory to find unauthorized devices or misconfigurations.
    answer_sources:
      - Wireless Intrusion Detection System (WIDS/WIPS) logs
      - Zeek conn.log
      - Zeek notice.log
      - Physical office locations with Wi-Fi coverage, Wireless Intrusion Prevention System (WIPS) sensors, Corporate wireless controllers
    range: last 90 days
    queries:
      - pseudocode: |
          MAINTAIN inventory of authorized_aps (BSSID, SSID, security_protocol)
          SEARCH wips_logs for observed_aps
          FOR each observed_ap:
            IF (observed_ap.ssid is corporate AND observed_ap.bssid NOT IN authorized_aps) OR (observed_ap.bssid IN authorized_aps AND observed_ap.security_protocol is weaker than standard):
              ALERT for Rogue/Evil Twin AP
  - question: Has the radio-frequency environment changed in a way that suggests a new, rogue, or spoofed access point has appeared?
    context: |
      This question uses the physical properties of radio signals to detect rogue devices. Every access point has a unique signal strength (RSSI) profile based on its location. A sudden, persistent change in the RSSI of a known AP, or the appearance of a new AP broadcasting a corporate SSID, could indicate that an attacker has placed a rogue device or is spoofing a legitimate one.
    answer_sources:
      - Wireless Intrusion Detection System (WIDS/WIPS) logs
      - Zeek conn.log
      - Zeek notice.log
      - Physical office locations with Wi-Fi coverage, Wireless Intrusion Prevention System (WIPS) sensors, Corporate wireless controllers
    range: last 90 days
    queries:
      - pseudocode: |
          FOR each authorized BSSID:
            MONITOR RSSI time-series data from WIPS sensors
            APPLY change point detection algorithm
            IF significant change point detected OR new BSSID with corporate SSID appears:
              ALERT for potential rogue/spoofed AP
  - question: Does machine learning analysis of radio-frequency data identify any outlier access points that could be rogue or evil twin devices?
    context: |
      This question applies unsupervised machine learning to detect rogue APs. By clustering all observed access points based on their RF characteristics (channel, signal strength, etc.), legitimate corporate APs should form stable, predictable groups. A new device that appears as a statistical outlier or forms a new, small cluster, especially if it's mimicking a corporate SSID, is highly suspicious.
    answer_sources:
      - Wireless Intrusion Detection System (WIDS/WIPS) logs
      - Zeek conn.log
      - Zeek notice.log
      - Physical office locations with Wi-Fi coverage, Wireless Intrusion Prevention System (WIPS) sensors, Corporate wireless controllers
    range: last 90 days
    queries:
      - pseudocode: |
          COLLECT RF data for all observed APs
          APPLY DBSCAN clustering algorithm
          FOR each resulting cluster:
            IF cluster is marked as 'outlier' AND contains an AP with a corporate SSID:
              ALERT for potential rogue/evil twin AP
  - question: Is there evidence of a brute-force authentication attack or a deauthentication/disassociation attack on the Wi-Fi network?
    context: |
      This question looks for two common types of Wi-Fi attacks. A high number of failed login attempts from a single device in a short time indicates a brute-force or password spraying attack. A sudden burst of deauthentication frames indicates a "Wi-Fi jamming" attack, often used to disconnect legitimate users and force them to connect to an attacker's Evil Twin AP.
    answer_sources:
      - RADIUS authentication logs
      - Zeek radius.log
      - Wireless controller event logs
      - WIDS/WIPS logs
      - RADIUS authentication servers, Corporate wireless controllers
    range: last 90 days
    queries:
      - pseudocode: |
          ALERT if count(failed_auths) > 20 from same MAC in 5 mins
          ALERT if count(deauth_frames) > 50 in 1 min from WIPS logs
  - question: Has the overall rate of failed Wi-Fi authentications across the network exceeded normal statistical limits?
    context: |
      This question is designed to detect large-scale or distributed password spraying attacks that might not trigger alerts based on a single source. By establishing a baseline of the normal rate of failed logins across the entire network, we can detect when the current rate exceeds a statistical threshold (e.g., three standard deviations above the mean), indicating a widespread anomaly.
    answer_sources:
      - RADIUS authentication logs
      - Zeek radius.log
      - Wireless controller event logs
      - WIDS/WIPS logs
      - RADIUS authentication servers, Corporate wireless controllers
    range: last 90 days
    queries:
      - pseudocode: |
          CALCULATE 30-day moving average (mean) and standard deviation (stddev) of hourly failed auth rate
          IF current_hourly_failed_auth_rate > (mean + 3 * stddev):
            ALERT for network-wide authentication anomaly
  - question: Does a predictive time-series model indicate an anomalous spike in Wi-Fi authentication failures?
    context: |
      This question uses a more advanced statistical method to detect authentication attacks. A time-series forecasting model (like ARIMA) can predict the expected number of authentication failures for any given minute, accounting for normal daily and weekly patterns. An alert is triggered only when the actual number of failures significantly exceeds the model's predicted upper bound, resulting in fewer false positives than simple thresholding.
    answer_sources:
      - RADIUS authentication logs
      - Zeek radius.log
      - Wireless controller event logs
      - WIDS/WIPS logs
      - RADIUS authentication servers, Corporate wireless controllers
    range: last 90 days
    queries:
      - pseudocode: |
          FOR each minute:
            FORECAST expected_failures_count using ARIMA/Prophet model
            GET observed_failures_count
            IF observed_failures_count > forecasted_upper_confidence_bound:
              ALERT for predictive authentication anomaly
  - question: Has an unauthorized or unregistered device successfully authenticated to the corporate Wi-Fi network?
    context: |
      This is a fundamental security check to ensure that only known, trusted devices are on the wireless network. By comparing the MAC address of every successfully connecting device against a master asset management database, we can immediately flag any device that is not registered and authorized, which represents a significant security gap.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek dhcp.log
      - Wireless controller logs
      - Asset Management Database
      - Network Access Control (NAC) system, Asset Management Database, DHCP servers, Network switches, Wireless controllers
    range: last 90 days
    queries:
      - pseudocode: |
          FOR each successful_auth event:
            JOIN client_mac with asset_management_database
            IF no match found:
              ALERT for unauthorized device on network
  - question: Has a device appeared to connect from two physically distant locations in an impossible amount of time, suggesting MAC spoofing?
    context: |
      This question aims to detect MAC address spoofing by using the "impossible travel" concept. If a device disconnects from an access point in one building and then, seconds later, reconnects to an access point a kilometer away, it is physically impossible for the legitimate device to have traveled that distance. This indicates that its MAC address has been cloned and is being used by an attacker in a different location.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek dhcp.log
      - Wireless controller logs
      - Asset Management Database
      - Network Access Control (NAC) system, Asset Management Database, DHCP servers, Network switches, Wireless controllers
    range: last 90 days
    queries:
      - pseudocode: |
          FOR each MAC address:
            TRACK connection history (AP_location, timestamp)
            IF time_between_connections / distance_between_aps < minimum_plausible_travel_time:
              ALERT for impossible travel / MAC spoofing
  - question: Has a known device connected with a new or anomalous device fingerprint (e.g., different DHCP or TCP/IP behavior), suggesting MAC spoofing?
    context: |
      This is another method for detecting MAC spoofing. While an attacker can easily clone a MAC address, it is much harder to perfectly replicate the unique network behavior (the "fingerprint") of the original device's operating system and hardware. By baselining the fingerprint (e.g., from DHCP and TCP packets) for each known device, we can detect when a known MAC address suddenly connects with a different fingerprint, suggesting it has been spoofed.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek dhcp.log
      - Wireless controller logs
      - Asset Management Database
      - Network Access Control (NAC) system, Asset Management Database, DHCP servers, Network switches, Wireless controllers
    range: last 90 days
    queries:
      - pseudocode: |
          FOR each known MAC, train one-class SVM on historical device fingerprints (DHCP/TCP options)
          FOR each new connection from known MAC:
            GENERATE new fingerprint
            IF model classifies new fingerprint as anomaly:
              ALERT for potential MAC spoofing
  - question: Is a corporate device with both wired and wireless connections actively bridging the two networks using Windows Internet Connection Sharing?
    context: |
      This question looks for an unauthorized and dangerous network bridge. A dual-homed device (connected to both wired and wireless networks) that has Internet Connection Sharing (ICS) enabled can create an unsanctioned path from the less-trusted wireless network directly into the more-trusted wired network, bypassing firewalls and other perimeter defenses.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 5156
      - DHCP logs
      - DNS logs
      - Core network switches, Endpoint devices, DNS and DHCP servers, Domain Controllers
    range: last 90 days
    queries:
      - pseudocode: |
          FIND hosts with active DHCP leases on both wired and wireless subnets
          FOR each such host:
            SEARCH for Windows Event 5156 related to SharedAccess service (ICS)
            IF event found:
              ALERT for unauthorized network bridge
  - question: Is a dual-homed device (with both wired and wireless IPs) showing signs of routing traffic between the two networks?
    context: |
      This question uses network traffic analysis to find unauthorized bridges. A normal device connected to two networks should not be forwarding traffic between them. If we observe a host's wireless IP communicating with a large number of internal wired hosts, it is a strong indication that the device is acting as a router or bridge, creating a security risk.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 5156
      - DHCP logs
      - DNS logs
      - Core network switches, Endpoint devices, DNS and DHCP servers, Domain Controllers
    range: last 90 days
    queries:
      - pseudocode: |
          FIND hosts with IPs on both wired and wireless subnets
          FOR each host:
            COUNT unique wired IPs communicating with its wireless IP
            IF count > 5:
              ALERT for potential network bridging
  - question: Does graph analysis of network traffic reveal any hosts with high 'betweenness centrality', indicating they are acting as a bridge between network segments?
    context: |
      This question applies graph theory to find unauthorized network bridges. In a graph of network connections, the wired and wireless networks should appear as two separate communities. A device that is bridging them will have a high "betweenness centrality" score because it lies on many of the shortest paths between the two communities. This makes it a critical and potentially anomalous node in the graph.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 5156
      - DHCP logs
      - DNS logs
      - Core network switches, Endpoint devices, DNS and DHCP servers, Domain Controllers
    range: last 90 days
    queries:
      - pseudocode: |
          BUILD communication graph from conn.log (nodes=IPs, edges=connections)
          IDENTIFY wired and wireless communities using Louvain Modularity
          CALCULATE betweenness centrality for all nodes
          ALERT on nodes with anomalously high centrality score that connect the two communities