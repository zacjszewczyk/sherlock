name: T1669: Wi-Fi Networks
id: c1d5b8e0-6f0a-4a2e-8b1d-9c0f7e6a5d4b
description: This playbook addresses the threat of an adversary gaining initial access to a corporate network via Wi-Fi. It provides investigative questions to detect various attack vectors, including the use of unauthorized or malicious devices identified through threat intelligence, the execution of Wi-Fi hacking tools on endpoints, the deployment of rogue or 'evil twin' access points, brute-force or deauthentication attacks, and the exploitation of dual-homed devices to bridge networks. The overall goal is to identify suspicious Wi-Fi activity that could represent a compromise.
type: technique
related:
  - TA0001: Initial Access
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are there any Wi-Fi authentication attempts from MAC addresses or to BSSIDs known to be malicious or unauthorized?
    context: This question aims to detect connections involving devices or access points that are present on threat intelligence feeds or internal watchlists. A successful or failed authentication involving a known malicious MAC address (client) or BSSID (access point) is a strong indicator of a targeted intrusion attempt.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek radius.log
      - Wireless controller event logs
      - Corporate wireless controllers
      - RADIUS authentication servers
      - Network monitoring sensors at Wi-Fi segment boundaries
    range: last 90 days
    queries:
      - query: SEARCH wireless or RADIUS logs | JOIN client_mac_address, bssid WITH threat_intel_watchlist | ALERT on match
  - question: Have any devices with rare or unusual hardware (OUI) connected to the Wi-Fi network?
    context: Adversaries may use non-standard or specialized hardware for attacks. This question seeks to identify these devices by analyzing the Organizationally Unique Identifier (OUI) of the client's MAC address, which identifies the manufacturer. A connection from a device manufacturer rarely seen on the network is anomalous and could indicate a foreign device.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek radius.log
      - Wireless controller event logs
      - Corporate wireless controllers
      - RADIUS authentication servers
      - Network monitoring sensors at Wi-Fi segment boundaries
    range: last 90 days
    queries:
      - query: SEARCH wireless connection logs | EXTRACT OUI from client_mac | CALCULATE frequency of all OUIs over 30 days | ALERT if a connecting OUI is in the bottom 5th percentile
  - question: Do any new Wi-Fi connections exhibit characteristics similar to previously observed malicious connections?
    context: This question leverages machine learning to proactively identify suspicious connections. By training a model on features from known malicious and benign connections (e.g., hardware type, time of day, AP location), new connections can be scored in real-time. A high malicious score indicates the connection shares traits with past attacks.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek radius.log
      - Wireless controller event logs
      - Corporate wireless controllers
      - RADIUS authentication servers
      - Network monitoring sensors at Wi-Fi segment boundaries
    range: last 90 days
    queries:
      - query: SCORE new connection events using a trained classification model | ALERT if malicious_confidence_score > 0.9
  - question: Has any known Wi-Fi hacking or reconnaissance software been executed on any endpoint?
    context: Adversaries use specific tools to discover, analyze, and attack Wi-Fi networks. This question involves searching endpoint process creation logs for the execution of binaries or scripts associated with tools like 'aircrack-ng', 'kismet', or 'netsh wlan show profiles'. A match is a high-confidence indicator of an attack in progress.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek software.log
      - All corporate endpoints (especially laptops and mobile devices)
      - Domain Controllers and SIEM for log aggregation
    range: last 90 days
    queries:
      - query: SEARCH process creation logs | WHERE process_name, file_hash, or command_line in (wifi_attack_tool_list) | ALERT on match
  - question: Are legitimate network utilities like 'netsh.exe' being used with unusually complex or obfuscated command-line arguments?
    context: To evade detection, attackers often use legitimate system utilities for malicious purposes ('living off the land'). This question aims to detect such abuse by analyzing the complexity (Shannon entropy) of command-line arguments for tools like 'netsh.exe'. An unusually high entropy score suggests obfuscation or non-standard usage, which may be malicious.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek software.log
      - All corporate endpoints (especially laptops and mobile devices)
      - Domain Controllers and SIEM for log aggregation
    range: last 90 days
    queries:
      - query: SEARCH process creation logs for 'netsh.exe' | CALCULATE entropy of command_line | ALERT if entropy > 95th percentile of historical baseline
  - question: Following the execution of a suspicious process, did the host exhibit anomalous network behavior?
    context: This question correlates endpoint and network data to increase detection confidence. When a potentially malicious process is detected on a host, this query checks if the host's network activity (e.g., number of connections, protocol mix) deviates from its established baseline in the minutes following the execution. The combination of a suspicious process and anomalous network traffic strongly indicates a successful compromise.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek software.log
      - All corporate endpoints (especially laptops and mobile devices)
      - Domain Controllers and SIEM for log aggregation
    range: last 90 days
    queries:
      - query: ON suspicious_process_alert for host | ANALYZE network logs from host for the next 5 minutes | IF network behavior is anomalous compared to baseline | ESCALATE alert
  - question: Is there an unauthorized access point broadcasting our corporate Wi-Fi network name (SSID)?
    context: This question is designed to detect 'Evil Twin' attacks, where an adversary deploys a rogue access point that mimics a legitimate corporate AP. By continuously monitoring all beacon frames and comparing the BSSID (hardware address) of any AP broadcasting a corporate SSID against an authorized inventory, unauthorized devices can be quickly identified.
    answer_sources:
      - Wireless Intrusion Detection System (WIDS/WIPS) logs
      - Zeek conn.log
      - Zeek notice.log
      - Physical office locations with Wi-Fi coverage
      - Wireless Intrusion Prevention System (WIPS) sensors
      - Corporate wireless controllers
    range: last 90 days
    queries:
      - query: SEARCH WIPS beacon logs | WHERE ssid is a corporate SSID AND bssid is NOT in the authorized_ap_inventory | ALERT on match
  - question: Has the signal strength profile of any corporate access point changed unexpectedly, or has a new AP appeared broadcasting a corporate SSID?
    context: The signal strength (RSSI) of a stationary access point as seen by multiple sensors is typically stable. A sudden, drastic change in this RSSI profile can indicate that a legitimate AP has been tampered with or that an attacker is spoofing its BSSID from a different location. This method helps detect sophisticated 'Evil Twin' attacks.
    answer_sources:
      - Wireless Intrusion Detection System (WIDS/WIPS) logs
      - Zeek conn.log
      - Zeek notice.log
      - Physical office locations with Wi-Fi coverage
      - Wireless Intrusion Prevention System (WIPS) sensors
      - Corporate wireless controllers
    range: last 90 days
    queries:
      - query: MONITOR RSSI time-series for known BSSIDs | APPLY change point detection algorithm | ALERT on significant, persistent changes
  - question: Are there any access points operating in our radio-frequency space that are statistical outliers compared to known, legitimate devices?
    context: This question uses unsupervised machine learning to identify rogue access points. By clustering all observed APs based on their radio-frequency characteristics (channel, signal strength, etc.), legitimate corporate APs will form stable, predictable groups. A new device that appears as a statistical outlier, especially if it mimics a corporate SSID, is highly suspicious.
    answer_sources:
      - Wireless Intrusion Detection System (WIDS/WIPS) logs
      - Zeek conn.log
      - Zeek notice.log
      - Physical office locations with Wi-Fi coverage
      - Wireless Intrusion Prevention System (WIPS) sensors
      - Corporate wireless controllers
    range: last 90 days
    queries:
      - query: CLUSTER all observed APs using DBSCAN on RF data | IDENTIFY outliers | ALERT if an outlier AP is broadcasting a corporate SSID
  - question: Is there evidence of a brute-force password attack or a deauthentication/disassociation attack against the Wi-Fi network?
    context: This question looks for two common Wi-Fi attack types. A high volume of failed authentication attempts from a single client MAC address indicates a brute-force attack. A sudden burst of deauthentication frames, which forcibly disconnect clients, suggests a denial-of-service or evil twin setup attack.
    answer_sources:
      - RADIUS authentication logs
      - Zeek radius.log
      - Wireless controller event logs
      - WIDS/WIPS logs
      - RADIUS authentication servers
      - Corporate wireless controllers
    range: last 90 days
    queries:
      - query: COUNT failed authentications by source MAC per 5 minutes, ALERT if > 20. COUNT deauth frames per 1 minute, ALERT if > 50.
  - question: Is the overall rate of failed Wi-Fi authentications across the entire network anomalously high?
    context: This question aims to detect slow, distributed attacks like password spraying. While a single attacker might not trigger per-device thresholds, a coordinated attack from many sources will cause a statistically significant increase in the total number of failed logins across the network. This is detected by comparing the current failure rate to a historical baseline.
    answer_sources:
      - RADIUS authentication logs
      - Zeek radius.log
      - Wireless controller event logs
      - WIDS/WIPS logs
      - RADIUS authentication servers
      - Corporate wireless controllers
    range: last 90 days
    queries:
      - query: CALCULATE hourly failed auth rate | COMPARE to (30-day moving average + 3 * standard deviation) | ALERT if current rate exceeds threshold
  - question: Is the current volume of authentication failures significantly higher than what a predictive model would forecast for this time?
    context: This is a more advanced method for detecting large-scale authentication attacks. It uses a time-series forecasting model (like ARIMA) to predict the expected number of authentication failures based on historical patterns (time of day, day of week). An alert is triggered if the actual number of failures significantly exceeds the model's forecasted upper limit, indicating a true anomaly.
    answer_sources:
      - RADIUS authentication logs
      - Zeek radius.log
      - Wireless controller event logs
      - WIDS/WIPS logs
      - RADIUS authentication servers
      - Corporate wireless controllers
    range: last 90 days
    queries:
      - query: FORECAST minute-by-minute auth failure counts using Prophet/ARIMA model | ALERT if observed count > forecasted upper confidence interval
  - question: Has an unknown or unregistered device successfully connected to the corporate Wi-Fi network?
    context: This question enforces a fundamental security policy: only known, authorized devices should be on the network. By checking the MAC address of every successfully authenticated device against a master asset management database, any connection from an unregistered device can be immediately flagged as a policy violation and potential security incident.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek dhcp.log
      - Wireless controller logs
      - Asset Management Database
      - Network Access Control (NAC) system
      - DHCP servers
      - Network switches
    range: last 90 days
    queries:
      - query: ON successful Wi-Fi authentication | JOIN client_mac with asset management database | ALERT if MAC is not found
  - question: Has any device appeared to connect from two physically distant locations in an impossibly short amount of time ('impossible travel')?
    context: This question is designed to detect MAC address spoofing. A legitimate device is bound by the laws of physics and cannot travel between two distant locations (e.g., different buildings or cities) in seconds. If a single MAC address is seen connecting from geographically separate access points in an impossible timeframe, it's a strong indication that the MAC is being spoofed.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek dhcp.log
      - Wireless controller logs
      - Asset Management Database
      - Network Access Control (NAC) system
      - DHCP servers
      - Network switches
    range: last 90 days
    queries:
      - query: FOR each MAC, log AP location and timestamp | CALCULATE implied speed between consecutive connections | ALERT if speed is physically impossible
  - question: Is a known device (by MAC address) suddenly exhibiting a different network fingerprint (e.g., different OS, different DHCP options)?
    context: This is another technique to detect MAC spoofing. A device's hardware, OS, and drivers create a relatively stable network 'fingerprint' (e.g., in DHCP requests and TCP session initiations). If a known MAC address suddenly connects with a new, different fingerprint, it suggests that an attacker is spoofing the MAC address from a different device.
    answer_sources:
      - RADIUS authentication logs
      - Zeek conn.log
      - Zeek dhcp.log
      - Wireless controller logs
      - Asset Management Database
      - Network Access Control (NAC) system
      - DHCP servers
      - Network switches
    range: last 90 days
    queries:
      - query: CREATE device fingerprint from DHCP and TCP options | ON new connection, compare fingerprint to historical fingerprint for that MAC | ALERT on mismatch
  - question: Is any Windows host with connections to both wired and wireless networks actively using the Internet Connection Sharing (ICS) feature?
    context: An adversary who has compromised a dual-homed machine (one connected to both wired and wireless networks) could enable Windows Internet Connection Sharing (ICS) to create an unauthorized bridge between the networks. This question looks for the specific Windows event (Event ID 5156 for the SharedAccess service) that indicates ICS is active on a dual-homed host.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 5156
      - DHCP logs
      - DNS logs
      - Core network switches
      - Endpoint devices
      - DNS and DHCP servers
      - Domain Controllers
    range: last 90 days
    queries:
      - query: IDENTIFY hosts with IPs on both wired and wireless subnets | FOR those hosts, search for Windows Event 5156 from SharedAccess service | ALERT on match
  - question: Is any dual-homed host (connected to both wired and wireless) actively forwarding traffic between the two networks?
    context: A dual-homed host acting as an unauthorized bridge will route traffic between its wired and wireless interfaces. This question identifies such behavior by analyzing network connection logs. A host that shows a significant volume of traffic originating from one network (e.g., wireless) and destined for the other (e.g., wired) is likely acting as a bridge.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 5156
      - DHCP logs
      - DNS logs
      - Core network switches
      - Endpoint devices
      - DNS and DHCP servers
      - Domain Controllers
    range: last 90 days
    queries:
      - query: FIND hosts with IPs on wired and wireless subnets | COUNT unique cross-network connections | ALERT if count exceeds a low threshold (e.g., >5)
  - question: Using network traffic graph analysis, are there any hosts that serve as a critical bridge between the wired and wireless network communities?
    context: This question applies graph theory to find unauthorized network bridges. By modeling network connections as a graph, the wired and wireless networks should appear as distinct communities. A device bridging these two communities will lie on many of the shortest paths between them, resulting in an anomalously high 'betweenness centrality' score, making it a detectable outlier.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 5156
      - DHCP logs
      - DNS logs
      - Core network switches
      - Endpoint devices
      - DNS and DHCP servers
      - Domain Controllers
    range: last 90 days
    queries:
      - query: CONSTRUCT communication graph from connection logs | CALCULATE betweenness centrality for all nodes | ALERT on nodes with anomalously high scores