name: "T1564.013: Bind Mounts"
id: "f8a1b2c3-d4e5-4f6a-7b8c-9d0e1f2a3b4c"
description: "This playbook addresses the defense evasion technique of using bind mounts to hide malicious activity. Adversaries can use the 'mount' command with flags like '--bind' to overlay filesystems, effectively hiding processes or files from standard user-space inspection tools. This is often observed through direct execution of the 'mount' command, discrepancies between kernel-level and user-space process listings, and is frequently followed by suspicious network activity such as command-and-control (C2) beaconing or connections to rare or known malicious domains. The goal is to detect the initial mounting action, identify the resulting hidden artifacts, and correlate this evasion with subsequent malicious network behavior."
type: "technique"
related:
  - "TA0005: Defense Evasion"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Is the 'mount' command being executed with bind mount options to potentially hide files or processes?"
    context: "This question focuses on directly detecting the use of bind mounts. Adversaries can use the 'mount' command with options like '--bind', '-o bind', or '-B' to overlay a directory, effectively hiding the original contents. This is a key indicator of the Defense Evasion technique T1564.013. Observing this command, especially when it involves the '/proc' filesystem, is highly suspicious as it can be used to hide running processes from standard inspection tools. Answering this question helps identify the initial execution of the technique."
    answer_sources:
      - "Windows Security Event ID 4688"
      - "Linux auditd logs"
      - "Sysmon for Linux Event ID 1"
      - "Critical Linux servers, container host nodes (Kubernetes, Docker), and developer workstations using Windows Subsystem for Linux (WSL)."
    range: "last 90 days"
    queries:
      - "Search process creation events for 'mount' where command line includes '--bind' or '-o bind' or '-B'."
  - question: "Is there an anomalous frequency of 'mount' command executions by any user or on any host?"
    context: "While legitimate use of 'mount' exists, a sudden spike in its usage by a specific user or on a particular host can indicate malicious activity, such as repeated attempts to set up or modify bind mounts for defense evasion. This question aims to identify statistically significant deviations from established baselines of behavior, which can surface suspicious activity that might otherwise be missed by signature-based rules."
    answer_sources:
      - "Windows Security Event ID 4688"
      - "Linux auditd logs"
      - "Sysmon for Linux Event ID 1"
      - "Critical Linux servers, container host nodes (Kubernetes, Docker), and developer workstations using Windows Subsystem for Linux (WSL)."
    range: "last 90 days"
    queries:
      - "For each user/host, count 'mount' executions daily. Compare count to 99th percentile baseline over 30 days. Alert on excess."
  - question: "Can we predictively classify 'mount' command executions as benign or suspicious based on contextual features?"
    context: "This question moves beyond simple signatures or frequency analysis to a more advanced, context-aware detection method. By training a machine learning model (like logistic regression) on features such as the parent process, user context, and time of day, we can identify suspicious 'mount' executions that may not trigger other rules. This is useful for detecting novel or subtle variations of the technique and reducing false positives from legitimate administrative activity."
    answer_sources:
      - "Linux auditd logs"
      - "Sysmon for Linux Event ID 1"
      - "Critical Linux servers, container host nodes (Kubernetes, Docker), and developer workstations using Windows Subsystem for Linux (WSL)."
    range: "last 90 days"
    queries:
      - "Input mount event features (parent process, user, arguments, time) into trained logistic regression model. Alert if classified as 'suspicious'."
  - question: "Is there a discrepancy between kernel-level process listings and the contents of the /proc filesystem?"
    context: "This question directly targets the primary goal of using bind mounts on '/proc': hiding processes. A healthy system should have a one-to-one correspondence between running processes visible to the kernel and the directories listed in '/proc'. A discrepancy, where a process exists at the kernel level but lacks a corresponding '/proc/[PID]' directory, is a strong indicator that a process is being actively hidden from user-space tools."
    answer_sources:
      - "EDR kernel-level process listings"
      - "Osquery ('processes' table)"
      - "Custom audit script output comparing 'ps' with 'ls /proc'"
      - "High-value Linux servers, bastion hosts, servers hosting sensitive data, and containerized environments."
    range: "last 90 days"
    queries:
      - "Compare process list from kernel-level source (EDR, ps) with directory list of '/proc'. Alert on PIDs present in kernel list but missing from /proc."
  - question: "Is there a statistically significant increase in the number of hidden processes on a host over time?"
    context: "Instead of just looking for a single instance of a hidden process, this question applies statistical process control to monitor the rate of such occurrences. A sudden increase in the count of mismatched PIDs that exceeds a calculated control limit indicates a significant and potentially malicious change in system behavior. This approach helps to distinguish between transient, benign glitches and a persistent, deliberate attempt to hide multiple processes."
    answer_sources:
      - "EDR kernel-level process listings"
      - "Osquery ('processes' table)"
      - "Custom audit script output comparing 'ps' with 'ls /proc'"
      - "High-value Linux servers, bastion hosts, servers hosting sensitive data, and containerized environments."
    range: "last 90 days"
    queries:
      - "Track count of mismatched PIDs over time. Apply C-chart. Alert if count exceeds upper control limit (mean + 3*std_dev)."
  - question: "Does the current state of the process table represent a significant anomaly compared to historical norms?"
    context: "This question uses an unsupervised machine learning model (an autoencoder) to learn what a 'normal' process table looks like for a given host. The model is trained on features like process counts and user distributions. When a bind mount hides a process, it alters the process table in a way that the model has not seen before, resulting in a high reconstruction error. This high error score serves as an anomaly alert, flagging a potential hidden process without needing a direct comparison of process lists."
    answer_sources:
      - "EDR kernel-level process listings"
      - "Osquery ('processes' table)"
      - "Custom audit script output"
      - "High-value Linux servers, bastion hosts, servers hosting sensitive data, and containerized environments."
    range: "last 90 days"
    queries:
      - "Input process table feature vector into trained autoencoder. Alert if reconstruction error is anomalously high."
  - question: "Following a bind mount event, does the host connect to any known malicious C2 infrastructure?"
    context: "This question correlates the defense evasion activity (bind mount) with subsequent command-and-control (C2) behavior. Adversaries often hide a process (e.g., a reverse shell or beacon) and then use it to communicate with their C2 server. By looking for network connections to destinations on a threat intelligence feed within a short window (e.g., 60 minutes) after a bind mount, we can connect the evasion technique directly to its malicious purpose, significantly increasing the confidence of the alert."
    answer_sources:
      - "Windows Security Event ID 4688"
      - "Linux auditd logs"
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Network egress points, DNS resolvers, critical Linux servers, and developer workstations."
    range: "last 90 days"
    queries:
      - "On 'mount --bind' event, monitor host's network traffic for 60 mins. Correlate destination IPs/domains with C2 threat intel feed. Alert on match."
  - question: "Following a bind mount event, does the host exhibit periodic, 'heartbeat'-like network beaconing?"
    context: "This question seeks to identify C2 beaconing behavior based on its timing characteristics rather than its destination. Automated malware often communicates with its C2 server at regular intervals (a 'heartbeat'). This results in network connections with very little variation in the time between them (low standard deviation of inter-arrival times). Detecting this pattern shortly after a bind mount event is a strong indicator that a hidden process is running a C2 agent."
    answer_sources:
      - "Zeek conn.log"
      - "Network egress points, DNS resolvers, critical Linux servers, and developer workstations."
    range: "last 90 days"
    queries:
      - "On 'mount --bind' event, analyze host's network traffic for 60 mins. For repeating destinations, calculate std dev of connection inter-arrival times. Alert if std dev is below threshold."
  - question: "Following a bind mount event, does the host's network traffic pattern become anomalous compared to its own baseline?"
    context: "This question uses a sophisticated time-series anomaly detection model (LSTM autoencoder) to learn the normal rhythm and flow of a host's network traffic. After a bind mount event, a hidden C2 agent starting its activity will likely create network patterns (e.g., byte counts, connection durations) that deviate significantly from the learned norm. A spike in the model's anomaly score post-mount provides a powerful, behavior-based signal of malicious activity."
    answer_sources:
      - "Zeek conn.log"
      - "Network egress points, DNS resolvers, critical Linux servers, and developer workstations."
    range: "last 90 days"
    queries:
      - "On 'mount --bind' event, monitor host's LSTM autoencoder anomaly score for network traffic. Alert on significant score increase."
  - question: "Is a host previously suspected of bind mount activity attempting to resolve known malicious domains?"
    context: "This question focuses investigative resources on hosts that are already on a watchlist due to prior suspicious activity. By specifically monitoring the DNS queries from these high-risk hosts and comparing them against a threat intelligence feed of malicious domains, we can efficiently detect the next stage of an attack, such as C2 communication or downloading a second-stage payload, with high confidence."
    answer_sources:
      - "Zeek dns.log"
      - "Network traffic logs at the internet gateway, internal network segments, and from corporate DNS servers."
    range: "last 90 days"
    queries:
      - "For hosts on 'bind mount' watchlist, monitor DNS queries. Correlate queried domains with malicious domain threat intel feed. Alert on match."
  - question: "Is a host on the bind mount watchlist connecting to statistically rare or newly observed domains?"
    context: "Adversaries often use newly registered domains (NRDs) or domains that are not commonly visited within an organization for their C2 infrastructure. This question aims to detect such connections by calculating a rarity score for every domain requested by a watchlisted host. A request for an extremely rare domain is highly anomalous and a strong indicator of potential C2 communication, even if the domain is not yet on any threat intelligence feed."
    answer_sources:
      - "Zeek dns.log"
      - "Network traffic logs at the internet gateway, internal network segments, and from corporate DNS servers."
    range: "last 90 days"
    queries:
      - "For hosts on watchlist, calculate enterprise-wide rarity score for each DNS query. Alert on queries for domains in the 99.9th percentile of rarity."
  - question: "Is a watchlisted host connecting to network destinations (countries, autonomous systems) that are unusual for that host?"
    context: "Beyond just domain names, the network location of a destination server can be a powerful indicator. This question involves profiling the 'normal' network destinations (in terms of Autonomous System Numbers and geographic location) for each host. If a host that is already on a watchlist for suspicious bind mount activity suddenly connects to a destination that falls outside its typical profile, it's a significant anomaly. This can detect C2 servers hosted in unusual or high-risk geographic locations."
    answer_sources:
      - "Zeek conn.log"
      - "Network traffic logs at the internet gateway, internal network segments, and from corporate DNS servers."
    range: "last 90 days"
    queries:
      - "For hosts on watchlist, compare new connection's destination ASN/country against historical clusters. Alert if destination is an outlier."