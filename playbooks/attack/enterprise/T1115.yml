name: T1115: Clipboard Data
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: Has the adversary collected data from local system clipboards? This playbook provides investigative questions to detect clipboard data collection by analyzing process creation events for known malicious hashes, suspicious command-line usage of clipboard utilities (like clip.exe or Get-Clipboard), execution from anomalous parent processes, high-frequency execution patterns, and correlation with outbound network connections or file staging activities.
type: technique
related:
  - TA0009: Collection
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Have any processes been created whose hash matches a known signature for clipboard-scraping malware?
    context: This question aims to identify known malicious tools used for clipboard data collection. By comparing process hashes against a threat intelligence feed, analysts can quickly detect the presence of malware with a high degree of confidence, enabling rapid response to a confirmed threat.
    answer_sources:
      - Windows Event ID 4688
      - All user workstations and remote access servers (RDP/Citrix).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH process_creation_logs(EventID 4688)
          JOIN threat_intel_feed ON process_hash
          WHERE category='clipboard_scraper'
          ALERT on match
  - question: If a process hash matches a known clipboard scraper, is its parent process rare across the enterprise?
    context: This question adds statistical context to a symbolic match. A malicious process spawned by a rare or unusual parent process (e.g., not explorer.exe or cmd.exe) increases the likelihood of a sophisticated or targeted attack, as it deviates from common execution patterns. This helps prioritize alerts for investigation.
    answer_sources:
      - Windows Event ID 4688
      - All user workstations and remote access servers (RDP/Citrix).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each malicious_hash_match
          CALCULATE prevalence of parent_process across all endpoints in last 30 days
          IF prevalence < 5%
          INCREASE risk_score
  - question: Do the metadata attributes of a running process indicate it is likely a known or unknown variant of clipboard-scraping malware?
    context: This question leverages machine learning to move beyond simple hash matching. By analyzing a combination of features like file path, parent process, user context, and signature status, a model can identify suspicious processes that exhibit characteristics of clipboard scrapers, even if their hash is not yet known to threat intelligence.
    answer_sources:
      - Windows Event ID 4688
      - All user workstations and remote access servers (RDP/Citrix).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each process_creation_event
          EXTRACT features (path, parent, user, signature_status)
          SCORE with binary_classification_model
          IF score > threshold
          ALERT
  - question: Has a native clipboard utility been used to redirect its output to a file or a network utility?
    context: This question looks for explicit command-line evidence of clipboard data being exfiltrated or staged. Adversaries often use built-in utilities like clip.exe or Get-Clipboard to capture data and pipe it directly to a file for later collection or to a networking tool for immediate exfiltration.
    answer_sources:
      - Windows Event ID 4688
      - All endpoints, particularly administrator workstations and developer jump boxes.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH command_line_logs
          FILTER with regex for 'Get-Clipboard \| Out-File', 'clip.exe >', or 'pbpaste \| nc'
          ALERT on match
  - question: Are there any command-line executions involving clipboard utilities that have an unusually high entropy score?
    context: This question helps detect obfuscated commands. Legitimate administrative scripts tend to have predictable structures, while adversaries may use obfuscation to hide their actions, resulting in a command-line string with higher-than-normal randomness (entropy). Flagging high-entropy commands can uncover hidden malicious logic.
    answer_sources:
      - Windows Event ID 4688
      - All endpoints, particularly administrator workstations and developer jump boxes.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH command_line_logs for 'Get-Clipboard' or 'clip.exe'
          CALCULATE Shannon_entropy for command_string
          IF entropy > 95th_percentile_of_baseline
          ALERT
  - question: Are there command-line executions involving clipboard utilities that are structurally unique and outliers compared to normal activity?
    context: This question uses machine learning to find novel or anomalous command structures without relying on specific patterns or entropy. By clustering all observed command lines, this technique can isolate unique, one-off commands that do not fit into any known group of benign activity, which are highly suspicious.
    answer_sources:
      - Windows Event ID 4688
      - All endpoints, particularly administrator workstations and developer jump boxes.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          VECTORIZE command_line_arguments
          CLUSTER with DBSCAN
          INVESTIGATE commands classified as outliers/noise
  - question: Has a clipboard utility been executed by a parent process not typically associated with interactive user sessions?
    context: This question focuses on identifying when clipboard access is initiated programmatically by a background or system process. Interactive utilities like clip.exe should be spawned by user-facing processes like explorer.exe or cmd.exe. Execution by a parent like a web server (w3wp.exe) or system service (services.exe) is highly indicative of compromise.
    answer_sources:
      - Windows Event ID 4688
      - Application servers (e.g., IIS, Apache), Domain Controllers, and other critical infrastructure servers.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH process_creation for 'clip.exe' or 'powershell.exe'
          IF parent_process NOT IN allow_list (e.g., explorer.exe, cmd.exe)
          ALERT
  - question: For a given parent-child process pair, is the use of 'Get-Clipboard' a statistical outlier compared to its normal command-line arguments?
    context: This question provides a more nuanced way to detect suspicious parent-child relationships. Even if a parent process like w3wp.exe is known to legitimately spawn powershell.exe, it may be highly unusual for it to use the Get-Clipboard command. This detects when a legitimate process relationship is abused for a malicious purpose.
    answer_sources:
      - Windows Event ID 4688
      - Application servers (e.g., IIS, Apache), Domain Controllers, and other critical infrastructure servers.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each parent-child_pair
          BASELINE frequency of command-line arguments over 30 days
          IF 'Get-Clipboard' argument frequency is > 3 standard deviations from mean
          ALERT
  - question: Does the parent process of a clipboard utility exhibit anomalous features compared to a model of legitimate parent processes?
    context: This question uses anomaly detection to identify suspicious parent processes without a predefined allow-list. A model is trained on the typical characteristics (e.g., name, path, user context) of legitimate parents. Any process that deviates significantly from this learned profile is flagged as an anomaly, potentially uncovering a compromised service or application.
    answer_sources:
      - Windows Event ID 4688
      - Application servers (e.g., IIS, Apache), Domain Controllers, and other critical infrastructure servers.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN one-class_SVM or isolation_forest on features of legitimate parent processes
          APPLY model to new clipboard utility parent processes
          ALERT on anomalies
  - question: Has any single user, host, or process executed a clipboard utility an excessive number of times in a short period?
    context: This question aims to detect automated clipboard scraping. A human user will access the clipboard intermittently, whereas a malicious script might poll the clipboard repeatedly to capture data as soon as it appears. A hard threshold (e.g., >10 times in 1 minute) can catch this rapid, repetitive activity.
    answer_sources:
      - Windows Event ID 4688
      - All user workstations and shared terminal servers.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          COUNT executions of 'clip.exe' or 'Get-Clipboard' per user/host
          IF count > 10 in 1 minute
          ALERT
  - question: Is a user's current frequency of clipboard utility execution significantly higher than their own established baseline?
    context: This question improves upon a fixed threshold by creating a personalized baseline for each user. An administrator who frequently uses clipboard commands as part of their job won't trigger false positives, while a sudden burst of activity from a regular user whose baseline is low will be correctly flagged as anomalous.
    answer_sources:
      - Windows Event ID 4688
      - All user workstations and shared terminal servers.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each user
          CALCULATE baseline execution_frequency per hour over 14 days
          IF current_hour_count > baseline + 3 standard deviations
          ALERT
  - question: Is there a sudden burst of clipboard utility executions that deviates from a user's normal daily and weekly activity patterns?
    context: This question uses time-series forecasting models to learn the complex rhythms of a user's activity, including seasonality (e.g., more activity during business hours, less on weekends). The model can then distinguish between a normal increase in activity and a truly anomalous, high-frequency event that does not fit the user's typical workflow.
    answer_sources:
      - Windows Event ID 4688
      - All user workstations and shared terminal servers.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MODEL time_series of execution counts per user with ARIMA/Prophet
          FLAG activity bursts that model identifies as anomalous
  - question: Did a process access the clipboard shortly before the same host initiated a network connection to a known-malicious destination?
    context: This question directly correlates clipboard access with potential data exfiltration. The sequence of 'clipboard access' followed by a 'network connection to a blocklisted IP' is a very strong indicator that the captured data was immediately sent to an adversary-controlled server.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek dns.log
      - Network egress points (firewalls/proxies) and all endpoints.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          CORRELATE (EventA: clipboard_access) followed by (EventB: outbound_connection) on same host within 30s
          IF destination_ip is on a threat intel blocklist
          ALERT
  - question: Following clipboard access, did the host connect to a network destination domain that is extremely rare across the enterprise?
    context: This question helps identify suspicious exfiltration to unknown or new C2 domains. Even if the destination IP is not on a blocklist, a connection to a domain that has been visited by very few (or no) other hosts in the organization is highly suspicious, especially immediately after clipboard data was accessed.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek dns.log
      - Network egress points (firewalls/proxies) and all endpoints.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          ON correlated 'clipboard access -> network' event
          LOOKUP domain for destination_ip from dns.log
          CALCULATE domain prevalence across enterprise over 90 days
          IF prevalence < 1%
          INCREASE risk_score
  - question: Does the sequence of 'clipboard access' followed by a 'network connection' represent an anomalous workflow for the user?
    context: This question uses sequence analysis to understand normal user behavior. A model is trained on common sequences of actions (e.g., 'open browser -> network connection'). A rare or novel sequence like 'clipboard access -> network connection to a new IP' would have a low probability under the model and be flagged as a potential exfiltration attempt.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek dns.log
      - Network egress points (firewalls/proxies) and all endpoints.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN sequence model (HMM/LSTM) on normal user workflows
          SCORE new sequences of process/network events
          ALERT on low-probability sequences like 'clipboard -> new_ip_connection'
  - question: Has an unusual process (e.g., unsigned, running from a temp directory) accessed the clipboard and then immediately created a file or initiated a network connection?
    context: This question looks for a classic adversary tradecraft chain drop an initial payload in a non-standard location, use it to access sensitive data (from the clipboard), and then either stage it to a file or exfiltrate it over the network. Detecting this entire A->B->C chain provides high-confidence evidence of malicious activity.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 11
      - Zeek conn.log
      - User profile directories (%APPDATA%, %TEMP%), endpoint file systems, and network egress points.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          CORRELATE (A: unusual process creation) -> (B: clipboard access by same PID) -> (C: file create or network connection by same PID) within 60s
          ALERT on full chain match
  - question: Has a process with a high initial risk score (based on rarity of path, parent, etc.) subsequently accessed the clipboard?
    context: This question uses a statistical risk score to proactively identify suspicious processes. Instead of waiting for the full malicious chain, security systems can flag a process as high-risk at creation (e.g., it's unsigned and running from %PUBLIC%). This high-risk process is then monitored more closely, and any subsequent clipboard access becomes an immediate, high-priority alert.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 11
      - Zeek conn.log
      - User profile directories (%APPDATA%, %TEMP%), endpoint file systems, and network egress points.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SCORE new processes on features (path_rarity, parent_rarity, signature)
          IF score > 98th_percentile
          MONITOR process
          IF monitored_process accesses clipboard
          ALERT
  - question: Can a graph-based analysis of system activity identify a suspicious subgraph involving a low-prevalence process, clipboard access, and file or network writes?
    context: This question represents an advanced, holistic approach to detection. By modeling all system activity as a graph (processes, files, and IPs are nodes; interactions are edges), anomaly detection algorithms can find entire malicious subgraphs. This is powerful because it contextualizes the clipboard access within the larger attack.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 11
      - Zeek conn.log
      - User profile directories (%APPDATA%, %TEMP%), endpoint file systems, and network egress points.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          BUILD real-time activity graph from system logs
          USE graph anomaly detection to find suspicious subgraphs
          ALERT on subgraphs matching 'low_prevalence_process -> clipboard -> file/network_write'