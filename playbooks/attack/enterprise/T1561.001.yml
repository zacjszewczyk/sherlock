name: T1561.001: Disk Content Wipe
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: This playbook helps identify if an adversary is attempting to destroy data or disrupt system availability by wiping disk content, a technique identified as T1561.001 in the MITRE ATT&CK framework. The investigation focuses on detecting known wiper malware signatures, the misuse of legitimate system utilities (like cipher.exe or vssadmin.exe) for destructive purposes, direct raw disk access that bypasses the file system, statistically anomalous volumes of file deletion events, and unusual network fan-out behavior via SMB to administrative shares, which may indicate the lateral spread of a wiper.
type: technique
related:
  - TA0040: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is a process being created that matches the hash of known wiper malware from our threat intelligence feeds?
    context: This question aims to identify the most direct evidence of a wiper malware attack by detecting the execution of a file with a known malicious signature. By correlating process creation events against a continuously updated threat intelligence feed of wiper malware hashes, we can detect known threats with high confidence as soon as they appear on an endpoint. An alert from this query is a high-fidelity indicator of compromise.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Sysmon Event ID 11
      - All enterprise endpoints and servers, particularly mission-critical systems like Domain Controllers and database servers.
    range: last 90 days
    queries:
      - pseudocode: SEARCH process creation events (WinEvent 4688, Sysmon 1). LOOKUP the process hash against a threat intelligence feed of wiper malware. ALERT if a match is found.
  - question: Are files being created with names that match common wiper malware patterns at a statistically unusual rate?
    context: Adversaries may use wiper tools with predictable or common filenames (e.g., `wiper.exe`). This question looks for the creation of files matching these patterns. By establishing a baseline of normal file creation for each host, we can detect a statistically significant increase in the appearance of these suspicious filenames, which could indicate the staging or execution of a wiper tool.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Sysmon Event ID 11
      - All enterprise endpoints and servers, particularly mission-critical systems like Domain Controllers and database servers.
    range: last 90 days
    queries:
      - pseudocode: SEARCH file creation events (Sysmon 11) for filenames matching wiper regex patterns. COUNT matches per host over time. COMPARE count to the 99th percentile of the host's 30-day baseline. ALERT if exceeded.
  - question: Has a newly observed executable been classified as potential wiper malware by our machine learning model?
    context: This question leverages a machine learning model to proactively identify unknown or zero-day wiper malware. The model analyzes various static and dynamic features of a new executable—such as its structure, imported functions, and execution behavior—to score its likelihood of being malicious. A high-confidence score provides an early warning of a potential threat that might evade signature-based detection.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Sysmon Event ID 11
      - All enterprise endpoints and servers, particularly mission-critical systems like Domain Controllers and database servers.
    range: last 90 days
    queries:
      - pseudocode: ON new executable observation (Sysmon 1, Sysmon 11), EXTRACT static and dynamic features. INPUT features into a pre-trained classification model. ALERT if the malware score is > 0.90.
  - question: Are legitimate system utilities being executed with specific command-line arguments known to be used for disk wiping?
    context: Adversaries often abuse legitimate system tools ('Living off the Land') to perform destructive actions, blending in with normal administrative activity. This question looks for specific, high-confidence indicators of abuse, such as using `cipher.exe` to overwrite free space or `vssadmin.exe` to delete volume shadow copies. Detecting these specific command invocations or a rapid sequence of them can reveal malicious intent.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Windows servers and workstations, especially those with administrative privileges.
    range: last 90 days
    queries:
      - pseudocode: SEARCH process creation events (Sysmon 1, WinEvent 4688) for command lines matching specific wiper patterns (e.g., 'cipher.exe /w:', 'vssadmin.exe delete shadows /all'). ALERT on match or if multiple patterns appear on one host in a 5-minute window.
  - question: Is there a statistically significant increase in the execution of disk-related utilities on any single host?
    context: This question aims to detect anomalous usage of legitimate tools that could be repurposed for wiping data. By profiling the normal execution frequency of utilities like `cipher.exe` or `sdelete.exe` on each host, we can identify when a host's activity deviates significantly from its own baseline. A sudden spike in usage, or the use of very rare command-line arguments, is a strong indicator of malicious activity.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Windows servers and workstations, especially those with administrative privileges.
    range: last 90 days
    queries:
      - pseudocode: FOR each host, SEARCH process creation events for disk utilities (e.g., cipher.exe, sdelete.exe). COUNT executions per host. COMPARE count to 3 standard deviations above the host's 30-day rolling average. ALERT if exceeded.
  - question: Does a sequence of executed commands on a host have a low probability of being benign administrative behavior?
    context: This question uses a sequence analysis model to understand the context of command executions, rather than just individual commands. Benign administrative tasks often follow predictable patterns. A machine learning model can learn these patterns and flag command sequences that are highly unusual, such as a user deleting shadow copies, then overwriting free disk space, then deleting logs. This deviation from normal behavior can signal a coordinated destructive attack.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Windows servers and workstations, especially those with administrative privileges.
    range: last 90 days
    queries:
      - pseudocode: STREAM real-time command-line execution data into a sequence analysis model (RNN/HMM). CALCULATE the probability of the observed sequence. ALERT if the sequence probability is below the 5th percentile threshold of benign behavior.
  - question: Is a process that is not on an established allow-list performing raw disk access?
    context: This question focuses on detecting processes that bypass the file system to interact directly with the physical disk, a common technique for high-speed or anti-forensic data wiping. By maintaining a strict allow-list of known, legitimate utilities (e.g., backup agents, disk health tools), any other process attempting raw disk access can be immediately flagged as highly suspicious.
    answer_sources:
      - Sysmon Event ID 9
      - Windows Event ID 4656
      - Windows Event ID 4663
      - Critical servers hosting sensitive data, Domain Controllers, and virtualization hosts.
    range: last 90 days
    queries:
      - pseudocode: SEARCH for RawAccessRead events (Sysmon 9). FOR each event, CHECK if the process image path is on the pre-defined allow-list. ALERT if the process is not on the allow-list.
  - question: Is a process with a high-entropy (random-looking) name attempting to perform raw disk access?
    context: Adversaries often use packed or randomly named executables to evade simple signature-based detection. This question combines two suspicious indicators: raw disk access and a high-entropy process name. The presence of both in a single event significantly increases the likelihood of malicious intent, as legitimate tools rarely have randomly generated filenames.
    answer_sources:
      - Sysmon Event ID 9
      - Windows Event ID 4656
      - Windows Event ID 4663
      - Critical servers hosting sensitive data, Domain Controllers, and virtualization hosts.
    range: last 90 days
    queries:
      - pseudocode: SEARCH for RawAccessRead events (Sysmon 9). IF process is not on allow-list, CALCULATE Shannon entropy of the process name. ALERT if entropy is greater than 3.5.
  - question: Has our machine learning model classified a raw disk access event as suspicious wiper activity?
    context: This question uses a machine learning classifier to add context to raw disk access events and reduce false positives. The model considers multiple features—such as the parent process, user context, and whether the executable is signed—to differentiate between benign administrative tasks and malicious wiping. This allows security analysts to focus on high-confidence alerts indicative of a genuine threat.
    answer_sources:
      - Sysmon Event ID 9
      - Windows Event ID 4656
      - Windows Event ID 4663
      - Critical servers hosting sensitive data, Domain Controllers, and virtualization hosts.
    range: last 90 days
    queries:
      - pseudocode: ON RawAccessRead event (Sysmon 9), EXTRACT features (parent process, user, path entropy, etc.). INPUT features into a classification model. ALERT on high-confidence 'suspicious' classification.
  - question: Has a non-system process deleted a large number of critical files from a protected system directory?
    context: This question provides a high-confidence rule to detect targeted destruction of the operating system. It looks for a specific, egregious action: a process that is not a trusted system or patching utility deleting more than 10 critical files (like .exe or .sys) from a core directory like System32 within a very short time frame. An alert from this rule indicates a direct and immediate threat to system stability.
    answer_sources:
      - Sysmon Event ID 23
      - Sysmon Event ID 11
      - Windows Event ID 4663
      - File servers, user workstations, and code repositories.
    range: last 90 days
    queries:
      - pseudocode: SEARCH file delete events (Sysmon 23, WinEvent 4663) in protected directories (e.g., C:\Windows\System32). COUNT deletions of critical file types (.dll, .exe) per process in a 1-minute window. ALERT if count > 10 and process is not a trusted system process.
  - question: Is any single process deleting files at a rate that is statistically anomalous for its host?
    context: This question aims to detect mass-deletion activity that could indicate indiscriminate data wiping. By establishing a normal baseline for file deletion rates on a per-host basis, we can identify when a single process suddenly starts deleting files at a rate that is far outside the norm (e.g., in the 99.9th percentile). This approach can catch wipers that don't target specific files but instead attempt to erase as much data as possible.
    answer_sources:
      - Sysmon Event ID 23
      - Sysmon Event ID 11
      - Windows Event ID 4663
      - File servers, user workstations, and code repositories.
    range: last 90 days
    queries:
      - pseudocode: FOR each host, establish a per-process baseline of file deletions (Sysmon 23) per minute. ALERT when a process's deletion count exceeds the 99.9th percentile of the host's historical activity.
  - question: Is a host experiencing a sudden, anomalous spike in file deletion or creation activity?
    context: This question uses time-series analysis to model the normal rhythm of file operations on a host. A machine learning model learns this normal pattern and can therefore detect a sudden, sharp deviation, such as a massive spike in file deletions or overwrites. This is effective for catching rapid, large-scale wiping events that would look dramatically different from any normal user or system behavior.
    answer_sources:
      - Sysmon Event ID 23
      - Sysmon Event ID 11
      - Windows Event ID 4663
      - File servers, user workstations, and code repositories.
    range: last 90 days
    queries:
      - pseudocode: STREAM file I/O events (Sysmon 11, Sysmon 23) into a time-series anomaly detection model (e.g., ARIMA). ALERT when observed activity significantly exceeds the model's 99% prediction interval.
  - question: Is a single host making an unusually high number of new SMB connections to administrative shares on other hosts?
    context: This question seeks to identify a wiper that is attempting to propagate across the network, a behavior common in destructive worms like NotPetya. The rule alerts when a single host suddenly connects to administrative shares (like C$) on a large number of other machines in a short period. This 'fan-out' behavior is a strong indicator of lateral movement for the purpose of widespread data destruction.
    answer_sources:
      - Zeek conn.log
      - Zeek smb_files.log
      - Windows Event ID 5145
      - Network traffic at core switches, Endpoint and server SMB logs.
    range: last 90 days
    queries:
      - pseudocode: SEARCH SMB connection logs (Zeek, WinEvent 5145) for connections to admin shares (C$, ADMIN$). COUNT unique destination hosts per source IP in a 5-minute window. ALERT if count > 20.
  - question: Is a host exhibiting anomalous SMB fan-out behavior compared to its own historical baseline?
    context: Rather than using a static threshold, this question compares a host's current SMB connection behavior to its own past activity. It establishes a rolling baseline of how many unique hosts it typically connects to via SMB. An alert is triggered if the current activity is a significant statistical outlier (e.g., more than 4 standard deviations from the mean), indicating a behavioral change that could signal the start of a propagation attempt.
    answer_sources:
      - Zeek conn.log
      - Zeek smb_files.log
      - Windows Event ID 5145
      - Network traffic at core switches, Endpoint and server SMB logs.
    range: last 90 days
    queries:
      - pseudocode: FOR each host, create a 30-day baseline of unique SMB destinations per 5-minute window. ALERT if the current count exceeds 4 standard deviations from the host's historical mean.
  - question: Is a host suddenly becoming a central hub in the network communication graph?
    context: This question models the network as a graph to identify changes in communication structure. A host that is compromised and begins to propagate a wiper will suddenly start communicating with many other hosts it previously did not interact with, changing its role in the network. By using graph analysis algorithms, we can detect when a host's 'centrality' or 'betweenness' score rapidly increases, flagging it as a potential propagation hub for a worm or wiper.
    answer_sources:
      - Zeek conn.log
      - Zeek smb_files.log
      - Windows Event ID 5145
      - Network traffic at core switches, Endpoint and server SMB logs.
    range: last 90 days
    queries:
      - pseudocode: MODEL SMB network as a graph. USE a community detection algorithm to establish baseline communication clusters. ALERT when a host creates many connections outside its normal cluster or its PageRank score rapidly increases.