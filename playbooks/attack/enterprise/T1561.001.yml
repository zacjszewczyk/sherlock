name: 'T1561.001: Disk Content Wipe'
id: 'f2a3e1d4-b5c6-4a78-9901-234567890abc'
description: "This playbook helps determine if an adversary is attempting to destroy data or disrupt system availability by wiping disk content. It provides investigative questions to detect wiper malware through signatures and behavioral analysis, identify the misuse of legitimate system utilities for destructive purposes, flag unauthorized raw disk access, uncover anomalous mass file deletion events, and spot network propagation behavior indicative of a spreading wiper."
type: 'technique'
related:
  - 'TA0040: Impact'
contributors:
  - 'Zachary Szewczyk'
  - 'Ask Sage'
created: '2025-10-01'
modified: '2025-10-01'
version: '1.0'
tags: 'none'
questions:
  - question: "Has a process been created whose hash matches a known wiper malware signature from a threat intelligence feed?"
    context: "This question aims to identify the execution of known wiper malware by comparing the SHA256 hash of every new process against a curated list of malicious hashes. A match is a high-confidence indicator that an adversary has deployed a recognized destructive tool on the endpoint. This is a fundamental, signature-based detection method."
    answer_sources: "Windows Event ID 4688, Sysmon Event ID 1. Applicable to all enterprise endpoints and servers, particularly mission-critical systems like Domain Controllers and database servers."
    range: 'last 90 days'
    queries:
      - "SEARCH process creation events (EID 4688, EID 1). JOIN ProcessHash_SHA256 with threat intelligence database of wiper malware hashes. RETURN events where a match is found."
  - question: "Is there a statistically anomalous number of files being created with names that match known wiper patterns?"
    context: "This question seeks to detect potential wiper malware that may not be in a hash database but uses common naming conventions (e.g., 'wiper.exe', 'destroy.exe'). By establishing a baseline of normal file creation activity for each host, it can identify a suspicious spike in the creation of files with these names, which could indicate the staging of destructive tools."
    answer_sources: "Sysmon Event ID 11. Applicable to all enterprise endpoints and servers, particularly mission-critical systems like Domain Controllers and database servers."
    range: 'last 90 days'
    queries:
      - "SEARCH file creation events (EID 11) for file names matching regex patterns like 'wiper.exe'. COUNT matches per host over time. COMPARE current count to 99th percentile of host's 30-day baseline. ALERT if threshold is exceeded."
  - question: "Has a newly observed executable been classified as high-confidence wiper malware by a machine learning model?"
    context: "This question leverages machine learning to identify novel or obfuscated wiper malware that evades signature and pattern-based detections. By analyzing a wide range of features from executables (PE headers, imported functions, command-line arguments, etc.), a trained model can score the probability of an executable being malicious. A high score suggests a sophisticated or previously unseen destructive tool is present."
    answer_sources: "Windows Event ID 4688, Sysmon Event ID 1, Sysmon Event ID 11. Applicable to all enterprise endpoints and servers, particularly mission-critical systems like Domain Controllers and database servers."
    range: 'last 90 days'
    queries:
      - "FOR each new executable (from EID 4688, 1, 11), extract static and dynamic features. INPUT features into pre-trained ML classifier. ALERT if malware score > 0.90."
  - question: "Are legitimate system utilities being executed with specific command-line arguments or in a sequence indicative of disk wiping?"
    context: "Adversaries often misuse legitimate tools ('Living off the Land') to avoid detection. This question looks for specific, known-abusive command-line invocations of utilities like `cipher.exe` (to overwrite data) or `vssadmin.exe` (to delete volume shadow copies). Detecting these commands, especially in a rapid sequence, is a strong indicator of an adversary attempting to destroy data and erase forensic evidence."
    answer_sources: "Windows Event ID 4688, Sysmon Event ID 1. Applicable to Windows servers and workstations, especially those with administrative privileges."
    range: 'last 90 days'
    queries:
      - "SEARCH process creation events (EID 4688, EID 1) for command-lines matching 'cipher.exe /w:', 'vssadmin.exe delete shadows /all /quiet', etc. CORRELATE events by host and time. ALERT if multiple commands occur within a 5-minute window."
  - question: "Is a host exhibiting a statistically anomalous frequency of execution or using rare command-line arguments for system utilities like cipher.exe or sdelete.exe?"
    context: "Beyond looking for specific known-bad commands, this question aims to detect unusual behavior. By baselining the normal usage of administrative utilities on a per-host basis, we can flag a sudden, statistically significant increase in their execution or the use of argument combinations that are rare for that host. This can uncover novel or less common misuse of these tools for destructive purposes."
    answer_sources: "Windows Event ID 4688, Sysmon Event ID 1. Applicable to Windows servers and workstations, especially those with administrative privileges."
    range: 'last 90 days'
    queries:
      - "FOR each host, baseline execution frequency of 'cipher.exe', 'sdelete.exe', etc. over 30 days. ALERT if current execution count > 3 standard deviations above the mean. SEPARATELY, baseline argument patterns and ALERT on rare combinations."
  - question: "Has a sequence of command-line executions been identified by a machine learning model as a low-probability, and therefore suspicious, administrative sequence?"
    context: "This question uses a more advanced approach to identify malicious 'Living off the Land' behavior. A sequence model learns what constitutes normal administrative activity. When it observes a new sequence of commands that has a very low probability of being benign according to the model, it flags a potential anomaly, which could represent an adversary's destructive actions."
    answer_sources: "Windows Event ID 4688, Sysmon Event ID 1. Applicable to Windows servers and workstations, especially those with administrative privileges."
    range: 'last 90 days'
    queries:
      - "INPUT real-time stream of command-line executions into a trained sequence analysis model (RNN/HMM). ALERT if the model assigns a probability to the sequence below a benign threshold (e.g., < 5th percentile)."
  - question: "Is a process that is not on the authorized allow-list performing raw disk access?"
    context: "Direct or 'raw' access to a physical drive bypasses the file system and is a powerful technique used by disk utilities and wiper malware. This question checks if any process performing this action is not on a pre-approved list of legitimate tools (e.g., backup agents, disk checkers). An unauthorized process performing raw disk access is highly suspicious and could be attempting to corrupt the Master Boot Record (MBR) or wipe the disk directly."
    answer_sources: "Sysmon Event ID 9, Windows Event ID 4656, Windows Event ID 4663. Applicable to critical servers hosting sensitive data, Domain Controllers, and virtualization hosts."
    range: 'last 90 days'
    queries:
      - "MAINTAIN allow-list of processes authorized for raw disk access. MONITOR RawAccessRead events (Sysmon EID 9). ALERT if the process name is not on the allow-list."
  - question: "Is a process with a high-entropy name or low prevalence performing raw disk access?"
    context: "Adversaries may use randomly generated filenames to evade simple signature or name-based detections. This question looks for statistical indicators of such evasion. High character entropy in a process name suggests it's randomized, and if that process is also performing a sensitive action like raw disk access, it's highly suspect. Similarly, a process that is very rare across the enterprise performing this action warrants investigation."
    answer_sources: "Sysmon Event ID 9. Applicable to critical servers hosting sensitive data, Domain Controllers, and virtualization hosts."
    range: 'last 90 days'
    queries:
      - "MONITOR RawAccessRead events (Sysmon EID 9). CALCULATE Shannon entropy of process name. ALERT if entropy > 3.5 AND process is not on allow-list. SEPARATELY, track process prevalence and ALERT if a process seen on <1% of endpoints performs raw access."
  - question: "Has a machine learning model classified a raw disk access event as 'suspicious wiper activity' based on its context?"
    context: "This question uses a classification model to add intelligence to the detection of raw disk access. Instead of just checking an allow-list, the model considers multiple features simultaneously—such as the parent process, user context, and whether the executable is signed—to make a more nuanced decision. This helps to distinguish between potentially legitimate administrative tasks and genuinely malicious activity."
    answer_sources: "Sysmon Event ID 9. Applicable to critical servers hosting sensitive data, Domain Controllers, and virtualization hosts."
    range: 'last 90 days'
    queries:
      - "FOR each RawAccessRead event (Sysmon EID 9), extract features (parent process, user, signing status, etc.). INPUT features into a trained classification model. ALERT if the event is classified as 'suspicious wiper activity' with high confidence."
  - question: "Has a non-system process deleted a large number of critical files from a protected system directory in a short time frame?"
    context: "This question sets a specific, high-fidelity tripwire for destructive behavior. It focuses on the deletion of critical file types (like .dll, .exe, .sys) from essential directories (like C:\\Windows\\System32) by a process that shouldn't be doing so. Triggering this rule is a strong sign of an active attempt to cripple the operating system."
    answer_sources: "Sysmon Event ID 23, Windows Event ID 4663. Applicable to file servers, user workstations, and code repositories."
    range: 'last 90 days'
    queries:
      - "MONITOR file delete events (Sysmon EID 23, Win EID 4663). COUNT deletions of files with extensions .dll, .exe, .sys from C:\\Windows\\System32 by a single non-system process. ALERT if count > 10 within a 1-minute window."
  - question: "Is a single process deleting files at a rate that is statistically anomalous for its host, or targeting files of a single type?"
    context: "This question aims to detect mass file deletion by identifying behavior that deviates sharply from a host's normal activity. By baselining the rate of file deletions, a sudden spike by a single process can be flagged. Additionally, if the deleted files all have the same extension, the low entropy of extensions suggests a targeted wipe rather than routine cleanup."
    answer_sources: "Sysmon Event ID 23. Applicable to file servers, user workstations, and code repositories."
    range: 'last 90 days'
    queries:
      - "FOR each host, baseline file deletions (Sysmon EID 23) per process per minute. ALERT if a process exceeds the 99.9th percentile. ADDITIONALLY, calculate entropy of file extensions in a deletion burst; ALERT if entropy approaches 0."
  - question: "Has a time-series anomaly detection model detected a significant deviation from the normal volume and velocity of file operations on a host?"
    context: "This question uses a time-series model to understand the rhythm of normal file activity (creations, deletions, modifications) on a host. The model learns this normal pattern and can then identify events, like a sudden, massive spike in file deletions, that break from this pattern. This is a powerful way to detect mass-wiping events without relying on fixed thresholds."
    answer_sources: "Sysmon Event ID 11, Sysmon Event ID 23. Applicable to file servers, user workstations, and code repositories."
    range: 'last 90 days'
    queries:
      - "INPUT stream of file I/O events (Sysmon EID 11, 23) per host into a trained time-series model (ARIMA/LSTM). ALERT if observed activity significantly exceeds the model's prediction interval (e.g., > 99% interval)."
  - question: "Has a single host connected to administrative shares (C$, ADMIN$) on an unusually large number of other hosts in a short period?"
    context: "This question looks for the 'fan-out' behavior characteristic of a worm or an attacker using a script to propagate malware or destructive payloads across a network. A hard threshold (e.g., connecting to more than 20 hosts in 5 minutes) provides a clear signal that one host is attempting to access many others, a common precursor to a widespread destructive event."
    answer_sources: "Zeek conn.log, Zeek smb_files.log, Windows Event ID 5145. Applicable to network traffic at core switches, Endpoint and server SMB logs."
    range: 'last 90 days'
    queries:
      - "MONITOR SMB connections (TCP/445) to administrative shares. COUNT unique destination hosts per source IP in a 5-minute window. ALERT if count > 20."
  - question: "Is a host initiating a number of new SMB connections that is statistically anomalous compared to its own historical baseline?"
    context: "This question refines the 'fan-out' detection by making it relative to the host's own normal behavior. A server that regularly connects to many hosts might not trigger a hard threshold, while a user workstation that suddenly connects to 15 hosts would be highly anomalous. Using a statistical baseline helps to identify behavior that is unusual *for that specific host*."
    answer_sources: "Zeek conn.log, Windows Event ID 5145. Applicable to network traffic at core switches, Endpoint and server SMB logs."
    range: 'last 90 days'
    queries:
      - "FOR each host, create a 30-day baseline of unique SMB destinations per 5-minute window. ALERT if the current count exceeds 4 standard deviations above the host's historical mean."
  - question: "Has graph analysis of the network identified a host that is suddenly acting as a propagation hub, connecting to hosts outside its normal communication community?"
    context: "This question models the entire network's communication patterns as a graph. It uses algorithms to understand 'communities' of hosts that normally talk to each other. An alert is generated when a host suddenly starts making many connections outside of its normal community, or when its importance in the network graph ('centrality') rapidly increases. This can identify a compromised machine being used as a pivot point to spread a destructive payload."
    answer_sources: "Zeek conn.log, Windows Event ID 5145. Applicable to network traffic at core switches, Endpoint and server SMB logs."
    range: 'last 90 days'
    queries:
      - "MODEL SMB connections as a graph. USE community detection algorithms to establish baseline communication clusters. ALERT if a host creates many connections to nodes outside its cluster or if its centrality score rapidly increases."