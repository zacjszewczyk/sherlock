name: T1667: Email Bombing
id: 5e6a9f1a-6d0b-4e89-8d7c-3b0f5c1e2a4b
description: |
  Identifies if an adversary is attempting to impact network or data availability using email bombing. This can be detected through several indicators, including: inbound SMTP transactions matching threat intelligence feeds; a single recipient receiving messages from a high number of unique sender domains or IPs with highly similar subjects (a sign of a subscription bomb); an internal host making an anomalously high number of HTTP POST requests to unique external domains containing an internal email address; the rate of inbound SMTP connections or total email volume exceeding statistically-derived thresholds; and suspicious network or process activity from a user's host immediately following the onset of an email bombing event, suggesting the bombing is a distraction for a separate attack.
type: technique
related:
- TA0040: Impact
contributors:
- Zachary Szewczyk
- Ask Sage
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: none
questions:
- question: Are there any inbound SMTP transactions matching known email bombing indicators
    from threat intelligence feeds?
  context: |
    This question aims to provide a first line of defense by using known indicators of attack. It involves creating a real-time correlation rule that joins inbound SMTP metadata (from sources like Zeek smtp.log and conn.log) with a threat intelligence feed of known email bombing indicators. An analyst should investigate if the sender IP, HELO domain, sender domain, or subject field of an inbound email matches a known malicious indicator. A match would trigger a medium-severity alert, indicating a potential email bombing attempt using recognized malicious infrastructure or patterns.
  answer_sources:
  - Zeek conn.log
  - Zeek smtp.log
  - Mail Transfer Agent (MTA) servers
  - Email security gateway
  - Perimeter firewalls
  - Threat Intelligence Platform (TIP)
  range: last 90 days
  queries:
  - short pseudocode: SEARCH smtp_logs JOIN threat_intel_feed ON (sender_ip OR sender_domain
      OR subject)
- question: For traffic matching known indicators, is a single recipient being targeted
    by a high number of unique malicious senders?
  context: |
    This question helps differentiate a targeted attack from random spam that happens to match an IOC. After an initial alert based on a threat intelligence match, this step performs a statistical aggregation. For all traffic matching the IOC, it groups by recipient and counts the number of unique sender IPs and sender domains over a 10-minute window. If a single recipient is associated with more than 10 unique malicious senders, it strongly suggests a coordinated, targeted campaign, justifying an escalation of the alert to high-severity.
  answer_sources:
  - Zeek conn.log
  - Zeek smtp.log
  - Mail Transfer Agent (MTA) servers
  - Email security gateway
  - Perimeter firewalls
  - Threat Intelligence Platform (TIP)
  range: last 90 days
  queries:
  - short pseudocode: FROM IOC_alerts | AGGREGATE count_unique(sender_ip) BY recipient
      OVER 10_minutes | WHERE count > 10
- question: Can we automatically escalate alerts for emails that match known IOCs and
    also have a high maliciousness score from a machine learning model?
  context: |
    This question seeks to increase the confidence of alerts by combining rule-based detections with machine learning. A pre-trained supervised classification model (e.g., Gradient Boosting) can be deployed to score each incoming email's likelihood of being malicious. The model would use features like sender domain age, IP reputation, ASN and geolocation, presence of URLs, and TF-IDF vectors of the subject line. If an email that has already triggered a symbolic IOC rule also receives a maliciousness score above a high threshold (e.g., 0.8), the alert should be automatically escalated to critical, and a containment playbook could be triggered.
  answer_sources:
  - Zeek conn.log
  - Zeek smtp.log
  - Mail Transfer Agent (MTA) servers
  - Email security gateway
  - Perimeter firewalls
  - Threat Intelligence Platform (TIP)
  range: last 90 days
  queries:
  - short pseudocode: FROM IOC_alerts | APPLY ML_model(email_features) | WHERE model_score
      > 0.8
- question: Is any single recipient receiving emails from an unusually high number
    of unique senders with nearly identical subjects within a short time frame?
  context: |
    This question is designed to detect a common email bombing variant known as a "subscription bomb." The analytic involves a sliding-window rule that triggers if a single recipient address receives emails from a high number of unique sender IPs (e.g., more than 20) within a 5-minute window, and where a large percentage (e.g., more than 80%) of the email subjects are identical. This pattern is characteristic of automated scripts signing a victim up for numerous newsletters or services simultaneously.
  answer_sources:
  - Zeek smtp.log
  - Zeek conn.log
  - Mail Transfer Agent (MTA) servers
  - Email security gateway
  range: last 90 days
  queries:
  - short pseudocode: FROM smtp_logs | AGGREGATE count_unique(sender_ip), percent_identical(subject)
      BY recipient OVER 5_minutes | WHERE unique_senders > 20 AND percent_identical_subject
      > 80
- question: Can we detect subscription bombs by measuring the randomness of sender
    domains against the similarity of subject lines?
  context: |
    This question proposes a more advanced statistical method to identify subscription bombs with high confidence. For each recipient, two metrics are calculated over a 5-minute window: 1) The Shannon entropy of the sender domains (a high value indicates high randomness/variety) and 2) The average Jaccard similarity of the subject lines (a high value indicates the subjects are very similar). A high-severity alert is generated when both sender domain entropy is high (e.g., > 4.0) and average subject similarity is high (e.g., > 0.9), as this combination is a strong indicator of a subscription bomb.
  answer_sources:
  - Zeek smtp.log
  - Zeek conn.log
  - Mail Transfer Agent (MTA) servers
  - Email security gateway
  range: last 90 days
  queries:
  - short pseudocode: FROM smtp_logs | CALCULATE shannon_entropy(sender_domain), jaccard_similarity(subjects)
      BY recipient OVER 5_minutes | WHERE entropy > 4.0 AND similarity > 0.9
- question: Can we use clustering algorithms to identify groups of emails characteristic
    of an email bombing attack?
  context: |
    This question explores an unsupervised machine learning approach for detection. A density-based clustering algorithm like DBSCAN can be applied to 5-minute batches of email metadata. The feature space for clustering would include the recipient address, a fuzzy hash (like ssdeep) of the subject line, and the sender's top-level domain. A dense cluster found by the algorithm would represent a group of emails sent to the same recipient with highly similar subjects but from a variety of senders. Any cluster containing more than a set number of points (e.g., 20) should be flagged as a potential email bombing event.
  answer_sources:
  - Zeek smtp.log
  - Zeek conn.log
  - Mail Transfer Agent (MTA) servers
  - Email security gateway
  range: last 90 days
  queries:
  - short pseudocode: FROM smtp_logs | APPLY DBSCAN(recipient, fuzzy_hash(subject),
      sender_tld) | WHERE cluster_size > 20
- question: Is an internal host making an anomalous number of HTTP POST requests to
    unique external domains, with the POST body containing a corporate email address?
  context: |
    This question shifts focus from the victim's mailbox to the source of a potential subscription bomb, which could be a compromised internal host. The analytic inspects outbound HTTP POST requests (e.g., in Zeek http.log) to see if a single source IP is sending POST requests that contain a corporate email address in the body to an unusually high number of unique destination hostnames (e.g., more than 15) within a 10-minute window. This behavior indicates that an automated script on the host may be registering an email address for numerous services.
  answer_sources:
  - Zeek http.log
  - Zeek dns.log
  - Windows Event ID 4688
  - Web proxies
  - DNS resolvers
  - Egress points of the network
  - User workstations
  range: last 90 days
  queries:
  - short pseudocode: SEARCH http_logs WHERE method='POST' AND body CONTAINS '@yourcompany.com'
      | AGGREGATE count_unique(destination_host) BY source_ip OVER 10_minutes | WHERE
      unique_hosts > 15
- question: Is any internal host exhibiting sign-up behavior that is anomalous compared
    to its own historical baseline?
  context: |
    This question aims to detect anomalous sign-up activity on a per-host basis. A 30-day rolling baseline is established for each internal source IP, tracking the number of unique domains to which it POSTs corporate email addresses each day. An alert is generated if the daily count for a host exceeds its own 99th percentile or 3 standard deviations above its moving average. This method is effective for detecting when a specific user's machine or an internal server begins behaving abnormally, even if the activity isn't high enough to trigger a network-wide threshold.
  answer_sources:
  - Zeek http.log
  - Zeek dns.log
  - Windows Event ID 4688
  - Web proxies
  - DNS resolvers
  - Egress points of the network
  - User workstations
  range: last 90 days
  queries:
  - short pseudocode: FROM http_post_signup_logs | COMPARE daily_count BY source_ip
      TO historical_baseline(30_days) | WHERE daily_count > 99th_percentile
- question: Is there a network-wide spike in sign-up activity that deviates from
    the normal organizational rhythm, as predicted by a time-series model?
  context: |
    This question addresses the detection of large-scale, bot-driven registration campaigns from within the network. A time-series anomaly detection model (e.g., Prophet) is developed for the network-wide count of unique (source IP, destination domain) pairs per hour where the HTTP POST contains a corporate email. This model learns the normal rhythm of sign-ups, including daily and weekly seasonality. An alert is generated when the observed count of sign-ups significantly exceeds the model's predicted upper confidence bound, indicating a coordinated event that stands out from normal aggregate behavior.
  answer_sources:
  - Zeek http.log
  - Zeek dns.log
  - Windows Event ID 4688
  - Web proxies
  - DNS resolvers
  - Egress points of the network
  - User workstations
  range: last 90 days
  queries:
  - short pseudocode: FROM http_post_signup_logs | APPLY time_series_model(count_per_hour)
      | WHERE observed_count > predicted_upper_bound
- question: Has the rate of inbound emails to a specific recipient or the mail server
    as a whole breached simple, hard-coded volume thresholds?
  context: |
    This question addresses the most straightforward form of email bombing: a volumetric attack. It uses simple, tiered threshold rules to provide a rapid, if basic, detection capability. For example, a low-severity alert could be generated if a single recipient receives over 50 emails/minute, a medium-severity alert for over 100 emails/minute, and a high-severity alert if the total inbound SMTP connections to a mail server exceed a hard limit like 1000 new connections per minute. This is a first-level check for sudden, massive floods of email traffic.
  answer_sources:
  - Zeek conn.log
  - Zeek smtp.log
  - Mail Transfer Agent (MTA) servers
  - Email security gateway
  - Network load balancers
  range: last 90 days
  queries:
  - short pseudocode: FROM smtp_logs | COUNT emails BY recipient PER minute | WHERE
      count > 50
- question: Is the current email volume for a recipient or server anomalous when compared
    to its own specific historical baseline for this time of day and week?
  context: |
    This question describes a more intelligent form of volumetric detection using dynamic baselining. For each individual recipient and for the mail server overall, a 30-day rolling baseline of email volume per 5-minute interval is calculated, with separate profiles for weekdays and weekends. A high-severity alert is generated if the current volume for an entity exceeds the 99th percentile of its historical baseline for that specific time window (e.g., a spike on a Tuesday at 2:00 PM is compared to previous Tuesdays at 2:00 PM). This is far more accurate than a static threshold and reduces false positives.
  answer_sources:
  - Zeek conn.log
  - Zeek smtp.log
  - Mail Transfer Agent (MTA) servers
  - Email security gateway
  - Network load balancers
  range: last 90 days
  queries:
  - short pseudocode: FROM smtp_logs | COMPARE current_volume BY entity TO historical_baseline(30_days,
      time_of_week) | WHERE current_volume > 99th_percentile
- question: Can a time-series anomaly detection model detect deviations from the normal,
    complex patterns of mail flow for the entire server?
  context: |
    This question proposes using an advanced machine learning model to detect volumetric attacks that disrupt normal patterns. A time-series model, such as an LSTM Autoencoder, can be trained on historical SMTP connection and email volume data. The model learns the complex, non-linear patterns of normal mail flow. It then attempts to reconstruct live traffic based on its learned patterns. A high reconstruction error indicates that the current traffic pattern is a significant deviation from normalcy, which is characteristic of a volumetric attack that is altering typical flow.
  answer_sources:
  - Zeek conn.log
  - Zeek smtp.log
  - Mail Transfer Agent (MTA) servers
  - Email security gateway
  - Network load balancers
  range: last 90 days
  queries:
  - short pseudocode: FROM smtp_logs | APPLY LSTM_autoencoder(traffic_pattern) | WHERE
      reconstruction_error > threshold
- question: Following an email bomb alert, is the targeted user's host exhibiting
    overtly suspicious activity, like running remote access tools or connecting to
    known malicious IPs?
  context: |
    This question addresses the possibility that an email bomb is a distraction for a more direct attack. It involves creating a correlation rule that, upon a high-severity email bomb alert for a specific user, automatically queries all activity from that user's host(s) for the next 60 minutes. A critical alert should be generated if the host executes a process from a watchlist of remote access tools (e.g., anydesk.exe) or initiates a network connection to an IP on a threat intelligence blocklist. This directly links the distraction event to a potential follow-on intrusion.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Windows Event ID 5156
  - Windows Event ID 4688
  - User endpoints
  - Domain Controllers
  - Internal network segments
  - DNS resolvers
  - Egress firewalls
  range: last 90 days
  queries:
  - short pseudocode: ON email_bomb_alert(user) | SEARCH process_events, network_events
      FROM user.host FOR 60_minutes | WHERE process_name IN (rat_watchlist) OR destination_ip
      IN (ti_blocklist)
- question: Following an email bomb alert, is the targeted user's host initiating
    rare or unusual network connections compared to its own baseline?
  context: |
    This question seeks to find follow-on attacks by looking for behavioral anomalies in network traffic. When an email bomb alert triggers for a user, their host's network traffic is immediately analyzed against its own 30-day baseline. The analysis should look for rarity, such as connecting to a domain in the bottom 1% of popularity for the organization or communicating with an IP from an Autonomous System Number (ASN) it has never communicated with before. This can detect C2 communication or data exfiltration to new, unusual infrastructure that might otherwise go unnoticed.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Windows Event ID 5156
  - Windows Event ID 4688
  - User endpoints
  - Domain Controllers
  - Internal network segments
  - DNS resolvers
  - Egress firewalls
  range: last 90 days
  queries:
  - short pseudocode: ON email_bomb_alert(user) | ANALYZE user.host.network_traffic
      AGAINST baseline(30_days) | WHERE destination_rarity > threshold
- question: Can a behavioral anomaly detection model identify outlier activity on
    a user's host during an email bomb event?
  context: |
    This question proposes using a comprehensive behavioral model to detect malicious activity hidden by an email bomb. Upon an alert, a pre-trained model like an Isolation Forest is applied to the user's host activity. The model is trained on diverse features like process command-line arguments, parent-child process relationships, and network connection tuples to learn a user's normal activity profile. An alert is generated if the user's activity during the email bomb is flagged as a statistical outlier, indicating behavior that deviates significantly from their established norm and is likely malicious.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Windows Event ID 5156
  - Windows Event ID 4688
  - User endpoints
  - Domain Controllers
  - Internal network segments
  - DNS resolvers
  - Egress firewalls
  range: last 90 days
  queries:
  - short pseudocode: ON email_bomb_alert(user) | APPLY isolation_forest(user.host.activity)
      | WHERE activity_is_outlier