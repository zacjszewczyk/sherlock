name: T1133: External Remote Services
id: 5a8e9e1f-7b0d-4b1a-9f8c-3d2e6a5b4c3d
description: This playbook helps determine if an adversary has gained initial access to the network by exploiting external remote services. It focuses on identifying instances where an external IP address connects to and interacts with an exposed administrative service that should not be public, such as a Docker API port or Kubernetes API server.
type: technique
related:
  - TA0001: Initial Access
contributors:
  - Zachary Szewczyk
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is there evidence of a connection from an external IP address to a known administrative remote service port?
    context: This question aims to identify direct, unauthorized access attempts from the internet to critical administrative services. Adversaries often scan for and exploit exposed services like the Docker Engine API (ports 2375, 2376) or the Kubernetes API Server (ports 6443, 8080) to gain an initial foothold. Detecting such connections is a high-fidelity indicator of a potential compromise or a significant security misconfiguration.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - DMZ
      - Cloud Environment Subnets
      - Container Orchestration Platforms
      - Network Gateway
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: SEARCH network_logs WHERE (source_ip IS_EXTERNAL AND destination_port IN [2375, 2376, 6443, 8080])
  - question: Have any new, unexpected listening services or open ports been observed on hosts in the DMZ or cloud environments?
    context: This question focuses on detecting deviations from a known-good security posture. By continuously monitoring for new listening services and comparing them against an established baseline of approved open ports for each host, analysts can proactively identify potentially malicious services or misconfigurations. An unexpected open port could indicate that an adversary has established a backdoor or that a service has been improperly exposed.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - DMZ
      - Cloud Environment Subnets
      - Container Orchestration Platforms
      - Network Gateway
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: GET_CURRENT_LISTENING_PORTS(dmz_hosts, cloud_hosts) | COMPARE against approved_baseline_ports | ALERT on new_unexpected_ports
  - question: Can traffic from external sources to web services be classified as API interaction rather than normal user-driven web browsing?
    context: This question uses a more advanced approach to differentiate between legitimate user activity and potentially malicious automated API interactions. Adversaries may attempt to blend in with normal traffic. By training a model to recognize the characteristics of API calls (e.g., specific URI patterns, user-agents, authorization headers), analysts can flag suspicious, API-like traffic originating from external sources that might otherwise be missed.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - DMZ
      - Cloud Environment Subnets
      - Container Orchestration Platforms
      - Network Gateway
    range: last 90 days
    queries:
      - search_technology: pseudocode
        query: SEARCH http_logs WHERE (source_ip IS_EXTERNAL) | APPLY classification_model(uri, user_agent, headers) | ALERT where classification IS 'api_interaction'