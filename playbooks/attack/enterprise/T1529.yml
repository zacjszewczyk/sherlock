name: T1529: System Shutdown-Reboot
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps investigate whether an adversary is attempting to impact system availability or recovery by initiating system shutdowns or reboots. This can be achieved through various means, including executing known malicious binaries that contain shutdown commands, using scripting interpreters or remote administration tools to force reboots, initiating a shutdown immediately after a remote logon, triggering a statistically anomalous number of shutdowns across the network, or causing a significant drop in network traffic from critical subnets, indicating a mass outage.
type: technique
related:
- TA0040: Impact
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Is a known malicious process, identified by its file hash, initiating a system shutdown or reboot?
  context: Adversaries often use custom malware like wipers or ransomware to cause impact, which may initiate a shutdown or reboot as part of the payload. Checking the file hash of a process issuing shutdown commands against threat intelligence feeds is a high-fidelity method to detect this malicious activity.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Threat Intelligence Feed
  - Critical infrastructure servers (Domain Controllers, Database Servers), application servers, and general user endpoints.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH process_creation_events WHERE (command_line CONTAINS "shutdown /s" OR command_line CONTAINS "shutdown /r" OR command_line CONTAINS "shutdown /g") AND file_hash IN known_malicious_hashes
- question: Is a process with a high-entropy (randomized) name initiating a system shutdown, potentially indicating packed or obfuscated malware?
  context: Malware authors frequently use high-entropy or randomized names for their executables to evade signature-based detection. Legitimate processes that initiate shutdowns (e.g., shutdown.exe) have low-entropy names. A process with a high-entropy name performing this action is highly suspicious and suggests an attempt to hide malicious software.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Critical infrastructure servers (Domain Controllers, Database Servers), application servers, and general user endpoints.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH process_creation_events WHERE command_line CONTAINS "shutdown" | CALCULATE shannon_entropy(process_name) | WHERE shannon_entropy > historical_baseline_95th_percentile
- question: Does a machine learning model classify a process that is initiating a system shutdown as malicious based on its execution context?
  context: This question uses a holistic approach where a machine learning model analyzes multiple features (e.g., parent process, user context, command-line arguments) to identify subtle or novel malicious shutdown activity that might be missed by simpler, single-indicator rules.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Critical infrastructure servers (Domain Controllers, Database Servers), application servers, and general user endpoints.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: STREAM process_creation_events WHERE command_line CONTAINS "shutdown" | PIPE_TO ML_model(features: parent_process, user, command_line, entropy) | ALERT WHERE model_prediction == "malicious" AND confidence > 0.85
- question: Is a scripting interpreter (like PowerShell or Command Prompt) being used to immediately and forcefully shut down or reboot a system?
  context: Adversaries often use scripting interpreters to execute commands non-interactively to disrupt operations. A forced ('/f' or '-Force') and immediate ('/t 0') shutdown initiated by a script is a strong indicator of malicious intent, as it bypasses normal shutdown procedures and user warnings.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Windows PowerShell Logging Event ID 4104
  - All Windows Endpoints and Servers, with heightened scrutiny on administrative jump boxes and domain controllers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH (process_creation_events WHERE parent_process IN ["powershell.exe", "cmd.exe", "wscript.exe"] AND process_name == "shutdown.exe" AND (command_line CONTAINS "/f" OR command_line CONTAINS "/t <60>")) OR (powershell_script_block_logs WHERE script_text CONTAINS "Restart-Computer -Force" OR script_text CONTAINS "Stop-Computer -Force")
- question: Has a system shutdown been initiated using a rare or previously unseen combination of command-line arguments?
  context: System administrators and legitimate software tend to use consistent, predictable patterns for shutdown commands. An adversary might use an unusual combination of flags or parameters to achieve a specific goal. Detecting deviations from the established baseline of normal command usage can uncover novel or stealthy malicious techniques.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Windows PowerShell Logging Event ID 4104
  - All Windows Endpoints and Servers, with heightened scrutiny on administrative jump boxes and domain controllers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH shutdown_events | GROUP_BY command_line_arguments | CALCULATE frequency | WHERE frequency < 1%_of_historical_usage
- question: Is a system shutdown command identified as an outlier by a clustering algorithm, suggesting it does not fit into any known pattern of legitimate administrative behavior?
  context: This question applies unsupervised machine learning to find anomalous shutdown commands without pre-defined rules. By clustering all observed shutdown commands based on their arguments, any command that doesn't fit into a cluster of normal activity is flagged as an outlier, potentially indicating a malicious or unauthorized action.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Windows PowerShell Logging Event ID 4104
  - All Windows Endpoints and Servers, with heightened scrutiny on administrative jump boxes and domain controllers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH shutdown_events | VECTORIZE command_line_arguments | APPLY DBSCAN_clustering | ALERT WHERE cluster_label == "outlier" or "noise"
- question: Is a remote shutdown command being issued from a host that is not an authorized administrative server or automation source?
  context: Remote administration tools are powerful and often used by adversaries for lateral movement and impact. An alert on a remote shutdown from an unauthorized source (e.g., a standard user workstation) is a high-priority indicator of compromise, as this activity should be restricted to known, trusted systems.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Zeek conn.log
  - Windows PowerShell Logging Event ID 4104
  - Administrative Workstations, Jump Servers, Management Network Segments, and Domain Controllers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH (wmic_process_events WHERE command_line CONTAINS "node:" AND command_line CONTAINS "os call shutdown") OR (powershell_remote_execution_logs WHERE command CONTAINS "Restart-Computer" OR "Stop-Computer") | WHERE source_host NOT IN approved_admin_servers_list
- question: Is an administrator account performing an anomalously high number of remote reboots compared to their own historical baseline?
  context: Even legitimate administrator accounts can be compromised. By establishing a baseline of normal remote reboot activity for each admin, we can detect when their account is being used unusually, such as rebooting far more systems than they typically do. This could indicate a compromised account being used for a widespread impact attack.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Zeek conn.log
  - Windows PowerShell Logging Event ID 4104
  - Administrative Workstations, Jump Servers, Management Network Segments, and Domain Controllers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH remote_reboot_events | GROUP_BY user, hour | CALCULATE count(distinct target_host) | COMPARE count to user_specific_historical_profile | ALERT WHERE count > (mean + 3 * stdev)
- question: Does a graph-based analysis show a remote shutdown command creating an unusual connection between entities (e.g., a user from one department rebooting a server in another)?
  context: Visualizing administrative actions as a graph can reveal normal patterns of interaction. An adversary, unaware of implicit organizational boundaries, might perform an action that creates a connection between two normally disconnected parts of the graph. This is a powerful way to detect anomalous lateral movement and impact.
  answer_sources:
  - Windows Event ID 4688
  - Sysmon Event ID 1
  - Zeek conn.log
  - Windows PowerShell Logging Event ID 4104
  - Administrative Workstations, Jump Servers, Management Network Segments, and Domain Controllers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: BUILD_GRAPH from remote_admin_logs with nodes (user, host) and edges (command) | APPLY community_detection_algorithm | ALERT on new edges bridging distinct communities
- question: Was a system shut down or rebooted immediately following a successful remote logon by the same user session?
  context: A common adversary tactic is to gain remote access to a machine for the sole purpose of executing a destructive command. A sequence of 'remote logon' immediately followed by 'system shutdown' is highly suspicious because legitimate remote sessions typically involve a longer period of interactive work.
  answer_sources:
  - Windows Event ID 4624
  - Windows Event ID 1074
  - High-value assets such as Domain Controllers, Database Servers, Certificate Authorities, and critical application servers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH logon_events (type 3 or 10) AND shutdown_events (1074) | JOIN by hostname and logon_id | WHERE shutdown_timestamp - logon_timestamp < 5_minutes
- question: Did a remote logon session that ended with a system shutdown have an unusually short duration compared to that user's typical session length?
  context: This question builds on the previous one by adding user-specific context. A user who normally has sessions lasting hours suddenly having a 30-second session that ends in a reboot is a strong indicator of their credentials being used maliciously in an automated 'login-and-shutdown' script.
  answer_sources:
  - Windows Event ID 4624
  - Windows Event ID 1074
  - High-value assets such as Domain Controllers, Database Servers, Certificate Authorities, and critical application servers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH remote_logon_sessions ending in shutdown | CALCULATE session_duration | COMPARE session_duration to user_specific_historical_duration_profile | ALERT WHERE session_duration < 5th_percentile
- question: Did a sequence analysis model detect the event sequence 'Remote Logon' -> 'System Shutdown' as a statistically anomalous pattern of behavior for a user session?
  context: This advanced analytic learns the normal 'grammar' of user sessions by observing sequences of events. A model trained on normal behavior would learn that a direct transition from a remote logon to a system shutdown is a very rare and improbable sequence, allowing it to flag this activity as anomalous even if it has never been seen before.
  answer_sources:
  - Windows Event ID 4624
  - Windows Event ID 1074
  - High-value assets such as Domain Controllers, Database Servers, Certificate Authorities, and critical application servers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: STREAM security_events per user_session | PIPE_TO LSTM_sequence_model | ALERT WHERE model flags transition from "Remote Logon" to "System Shutdown" as anomalous
- question: Is there a widespread system shutdown or reboot event occurring across the enterprise that is not part of a scheduled maintenance window?
  context: The most direct indicator of a large-scale impact attack is a large number of systems shutting down simultaneously. This query acts as a tripwire by counting these events and alerting if the count exceeds a set threshold, while filtering out expected noise from scheduled maintenance.
  answer_sources:
  - Windows Event ID 1074
  - Windows Event ID 6006
  - The entire enterprise network, logically segmented by asset groups (e.g., Workstations, VDI, Web Servers, Database Servers) for more granular analysis.
  range: last 15 minutes
  queries:
  - technology: pseudocode
    query: SEARCH shutdown_events (1074, 6006) in last 15 minutes | CALCULATE distinct_count(hostname) | ALERT WHERE distinct_count > threshold AND current_time NOT IN maintenance_window
- question: Is the number of system shutdowns within a specific asset group (e.g., Domain Controllers, Web Servers) statistically anomalous compared to its normal baseline for this time of day?
  context: This query refines detection by adding statistical rigor and asset context. Instead of a single static threshold, this method creates a dynamic baseline for each group of assets, allowing for the detection of targeted attacks against critical systems that might not cross a global threshold.
  answer_sources:
  - Windows Event ID 1074
  - Windows Event ID 6006
  - The entire enterprise network, logically segmented by asset groups (e.g., Workstations, VDI, Web Servers, Database Servers) for more granular analysis.
  range: last 15 minutes
  queries:
  - technology: pseudocode
    query: SEARCH shutdown_events in last 15 minutes | GROUP_BY asset_group | CALCULATE count | COMPARE count to historical_baseline(asset_group, time_of_day) | ALERT WHERE Z_score > 4
- question: Has a multivariate anomaly detection model identified an unusual pattern of shutdowns across different asset groups that violates their normal correlated behavior?
  context: This advanced approach learns the complex relationships between different parts of the network (e.g., workstation reboots are independent of database server reboots). An attack causing them to reboot simultaneously would violate this learned pattern and trigger a highly contextualized alert.
  answer_sources:
  - Windows Event ID 1074
  - Windows Event ID 6006
  - The entire enterprise network, logically segmented by asset groups (e.g., Workstations, VDI, Web Servers, Database Servers) for more granular analysis.
  range: last 15 minutes
  queries:
  - technology: pseudocode
    query: STREAM shutdown_counts from all asset_groups | PIPE_TO multivariate_anomaly_detection_model | ALERT WHERE model flags current state as anomalous
- question: Has network traffic from a critical subnet (e.g., Domain Controllers, database servers) suddenly dropped by a drastic amount?
  context: A mass shutdown of critical systems will manifest as a sudden drop in the network traffic they generate. Monitoring this 'heartbeat' from critical subnets provides a network-level view of system availability and can be an early indicator of a successful impact attack.
  answer_sources:
  - Zeek conn.log
  - Network Choke Points (Core Switches, Subnet Aggregation Points, Internet Gateway, VPN Concentrators).
  range: last 5 minutes
  queries:
  - technology: pseudocode
    query: SEARCH network_flows from critical_subnet in last 5 minutes | CALCULATE active_connections | COMPARE to average_active_connections from previous hour | ALERT WHERE current_connections < 10%_of_average
- question: Is the current network traffic volume from a key network segment statistically anomalous low compared to its historical baseline for this specific time?
  context: This query improves on simple thresholds by creating a robust, time-sensitive baseline. Network traffic has natural daily and weekly patterns; a drop in traffic at 3 AM might be normal, but the same drop at 3 PM is anomalous. This statistical approach accounts for seasonality to reliably detect unexpected outages.
  answer_sources:
  - Zeek conn.log
  - Network Choke Points (Core Switches, Subnet Aggregation Points, Internet Gateway, VPN Concentrators).
  range: last 5 minutes
  queries:
  - technology: pseudocode
    query: SEARCH network_flows from segment in last 5 minutes | CALCULATE traffic_volume | COMPARE to 30-day_historical_distribution(segment, time_of_day) | ALERT WHERE traffic_volume < 1st_percentile
- question: Has a time-series forecasting model predicted a certain level of network traffic, but the actually observed traffic has fallen significantly below that prediction?
  context: This proactive approach uses a model to continuously forecast expected network behavior. An alert is triggered when reality deviates significantly from the forecast. This can detect more subtle drops in traffic than simple baselining and is more resilient to gradual changes in 'normal' behavior over time.
  answer_sources:
  - Zeek conn.log
  - Network Choke Points (Core Switches, Subnet Aggregation Points, Internet Gateway, VPN Concentrators).
  range: last 5 minutes
  queries:
  - technology: pseudocode
    query: GET current_traffic_volume from segment | GET forecasted_volume and confidence_interval from forecasting_model | ALERT WHERE current_traffic_volume < lower_bound_of_prediction