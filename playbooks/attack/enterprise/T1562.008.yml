name: T1562.008: Disable or Modify Cloud Logs
id: 5a8e1b2c-9f0a-4d3e-8b1c-7a6f9d0e1b2a
description: This playbook focuses on detecting attempts by an adversary to disable or modify cloud logging capabilities to evade detection and cover their tracks. Detections are based on identifying network connections to cloud management APIs from malicious or rare sources, spotting specific API calls related to log modification in network traffic, observing unexplained drops in log volume, finding endpoint executions of CLI commands that alter logging, and correlating confirmed log tampering alerts with subsequent high-risk activity.
type: technique
related:
  - TA0005: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has a network connection been made to a cloud provider's management API from a known malicious IP address?
    context: This question aims to identify initial attempts by an adversary to interact with cloud management services from compromised infrastructure. Correlating network traffic with threat intelligence feeds provides a high-fidelity signal that an external threat actor is targeting the cloud environment, potentially to disable logging or perform other malicious actions.
    answer_sources:
      - Zeek conn.log
      - Threat Intelligence Feed
      - Cloud Provider IP Ranges
      - Sourced from Internet gateway and network egress points
    range: last 90 days
    queries:
      - search: pseudocode
        query: JOIN (SELECT src_ip FROM zeek_conn_logs WHERE dest_ip IN cloud_api_ranges) WITH (SELECT ip FROM threat_intel_feed) ON src_ip = ip; ALERT on match.
  - question: Has a connection to a cloud API endpoint originated from an unusually rare country or Autonomous System Number (ASN)?
    context: This question seeks to detect connections from atypical geographic or network locations, which can be an indicator of an adversary attempting to hide their origin or using newly provisioned infrastructure. By baselining normal source locations, we can flag outliers that warrant further investigation.
    answer_sources:
      - Zeek conn.log
      - Sourced from Internet gateway and network egress points
    range: last 90 days
    queries:
      - search: pseudocode
        query: SEARCH zeek_conn_logs for connections to cloud_api_endpoints; GROUP BY src_country, src_asn; CALCULATE frequency over 30 days; ALERT if current connection's (country, asn) is in bottom 5th percentile of frequency.
  - question: Does a connection to a cloud API endpoint exhibit characteristics that a machine learning model classifies as likely malicious?
    context: This question leverages a machine learning model to perform a multi-faceted risk assessment of a connection. By analyzing features like ASN, location, time, and threat reputation, the model can identify complex patterns indicative of malicious activity that might be missed by simpler rules, providing a more sophisticated layer of detection.
    answer_sources:
      - Zeek conn.log
      - Threat Intelligence Feed
      - Sourced from Internet gateway and network egress points
    range: last 90 days
    queries:
      - search: pseudocode
        query: FOR each connection to cloud_api_endpoints, ENRICH with geoip, asn, threat_intel; SCORE with Random Forest model; ALERT if score > threshold.
  - question: Has there been a network request (HTTP/TLS) to a cloud management endpoint that explicitly contains an API call to disable or modify logging?
    context: This question looks for direct evidence of log tampering by inspecting the content of network traffic for specific, high-risk API call names. Detecting strings like 'DeleteTrail' or 'StopLogging' is a strong indicator that an adversary is actively trying to cover their tracks.
    answer_sources:
      - Zeek http.log
      - Zeek ssl.log
      - Sourced from Network egress points, forward proxies, and cloud access security brokers (CASB)
    range: last 90 days
    queries:
      - search: pseudocode
        query: SEARCH zeek_http_logs.uri OR zeek_ssl_logs.server_name FOR regex /(DeleteTrail|StopLogging|UpdateTrail|diagnostic-settings.delete|projects.sinks.update)/i; ALERT on match.
  - question: Has a user session involving a rare log-modification API call shown an unusually low entropy, suggesting scripted behavior?
    context: This question aims to differentiate between legitimate administrative actions and automated, malicious scripts. A legitimate user's session often has varied, interactive API calls (high entropy), whereas an adversary's script might be a short, direct sequence of commands (low entropy) that includes a rare action like modifying logs.
    answer_sources:
      - Zeek http.log
      - Zeek ssl.log
      - Sourced from Network egress points, forward proxies, and cloud access security brokers (CASB)
    range: last 90 days
    queries:
      - search: pseudocode
        query: FOR each user session, CALCULATE API call frequency and Shannon entropy; ALERT if session contains rare log-modification_api_call AND entropy is low.
  - question: Has a user's sequence of API calls deviated significantly from their normal, modeled behavior, particularly with the inclusion of a log modification command?
    context: This question uses a sophisticated anomaly detection model (like an LSTM) to understand the normal 'story' of a user's API interactions. An alert is triggered when an action, such as deleting a log trail, occurs out of its normal context, indicating a potential compromise or insider threat deviating from established workflows.
    answer_sources:
      - Zeek http.log
      - Zeek ssl.log
      - Sourced from Network egress points, forward proxies, and cloud access security brokers (CASB)
    range: last 90 days
    queries:
      - search: pseudocode
        query: FOR each user, FEED real-time API call sequence into trained LSTM Autoencoder; ALERT if reconstruction_error > threshold.
  - question: Has a critical cloud log source stopped sending data for an unusual period of time?
    context: This question establishes a simple but effective 'heartbeat' check to ensure log sources are active. An unexpected silence from a source like AWS CloudTrail, outside of a maintenance window, is a critical indicator that logging may have been disabled or interrupted at the source.
    answer_sources:
      - AWS CloudWatch Metrics
      - Azure Monitor Metrics
      - GCP Cloud Monitoring
      - SIEM internal performance logs
      - Sourced from SIEM/Log aggregation platform and Cloud provider monitoring dashboards (e.g., AWS CloudWatch)
    range: last 90 days
    queries:
      - search: pseudocode
        query: FOR each critical_log_source, EXPECT at least 1 log every 15 minutes; IF no log received AND not in maintenance_window, ALERT.
  - question: Has the volume of a cloud log source dropped significantly below its historical, time-specific baseline?
    context: This question applies statistical analysis to detect subtle but significant drops in log volume. Unlike a complete stoppage, a partial reduction might indicate a more nuanced attempt at evasion. Comparing current volume to a historical average for the same time of day and week helps account for natural fluctuations and identifies true anomalies.
    answer_sources:
      - AWS CloudWatch Metrics
      - Azure Monitor Metrics
      - GCP Cloud Monitoring
      - SIEM internal performance logs
      - Sourced from SIEM/Log aggregation platform and Cloud provider monitoring dashboards (e.g., AWS CloudWatch)
    range: last 90 days
    queries:
      - search: pseudocode
        query: FOR each log_source, CALCULATE 30-day rolling average and std_dev of log volume per hour; ALERT if current_volume < (average - 3*std_dev) for 3 consecutive intervals.
  - question: Is the current log volume for a cloud source significantly lower than what a time series forecasting model predicted?
    context: This question employs a predictive model (like ARIMA or Prophet) to create a more accurate forecast of expected log volume, including trends and seasonality. An alert is generated when the actual volume falls outside the model's confidence interval, providing a more robust detection method than simple averages for environments with complex data patterns.
    answer_sources:
      - AWS CloudWatch Metrics
      - Azure Monitor Metrics
      - GCP Cloud Monitoring
      - SIEM internal performance logs
      - Sourced from SIEM/Log aggregation platform and Cloud provider monitoring dashboards (e.g., AWS CloudWatch)
    range: last 90 days
    queries:
      - search: pseudocode
        query: FOR each log_source, FORECAST expected volume and confidence_interval using ARIMA/Prophet; ALERT if actual_volume < lower_bound of confidence_interval.
  - question: Has a non-administrative user executed a command-line tool to disable or modify cloud logs?
    context: This question focuses on detecting log tampering attempts originating from endpoints via cloud CLI tools. By monitoring process creation events for specific commands and correlating them with user privileges, we can flag unauthorized attempts by non-administrators to disable logging, which is a highly suspicious activity.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Active Directory Logs
      - Sourced from Administrator workstations, developer endpoints, and CI/CD servers
    range: last 90 days
    queries:
      - search: pseudocode
        query: SEARCH for EventID 4688 with process in (aws.exe, az.cmd, gcloud.cmd) AND command_line contains ('delete-trail', 'stop-logging'); ENRICH with user_group from AD; ALERT if user_group IS NOT 'Cloud Administrators'.
  - question: Has a user executed a cloud CLI command for modifying logs that is statistically rare for their specific user role?
    context: This question uses role-based behavioral profiling to spot anomalies. While a cloud administrator might occasionally modify logging configurations, the same action performed by a user in a marketing or sales role would be highly unusual. This method detects misuse of credentials or insider threats by identifying actions that are out of character for a user's role.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Active Directory Logs
      - Sourced from Administrator workstations, developer endpoints, and CI/CD servers
    range: last 90 days
    queries:
      - search: pseudocode
        query: FOR each user, PROFILE historical CLI command/argument frequency by role; ALERT if user executes a command that is in the bottom 5th percentile of frequency for their role.
  - question: Has a user executed a log-modification command that is inconsistent with the behavior of their peer group but consistent with a different, more privileged group?
    context: This question applies peer group analysis to detect outlier behavior. Users are clustered based on their typical command-line activity. An alert is triggered if a user's actions, like disabling logs, suddenly align with the behavior of a different group (e.g., a developer's activity suddenly resembles a Site Reliability Engineer's), which could indicate account takeover or privilege escalation.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - Active Directory Logs
      - Sourced from Administrator workstations, developer endpoints, and CI/CD servers
    range: last 90 days
    queries:
      - search: pseudocode
        query: CLUSTER users by command-line activity vectors (TF-IDF); ALERT if a user executes a command anomalous for their cluster but common in another privileged cluster.
  - question: Following a cloud log tampering alert, has the associated user or host generated other alerts that, when combined, reach a critical risk threshold?
    context: This question focuses on alert correlation to identify an attack in progress. A single log tampering event is suspicious, but when it's immediately followed by other risky activities from the same entity, it provides strong evidence of a malicious campaign. This meta-rule automatically elevates the priority of subsequent events to trigger a faster incident response.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - SIEM Alerts
      - Sourced from SIEM alert database and high-value asset endpoints
    range: last 90 days
    queries:
      - search: pseudocode
        query: ON 'Cloud Log Tampering' alert for entity, INCREASE risk score of all subsequent alerts from same entity by 50 for 24 hours; IF cumulative_score > threshold, CREATE incident.
  - question: In the hour following a log modification event, did the associated user or host exhibit an anomalous spike in network traffic or process creation activity?
    context: This question seeks to confirm malicious intent by looking for immediate follow-on activity. After disabling defenses, an adversary will likely proceed with their objectives, such as data exfiltration (spike in network traffic) or running more tools (spike in process creations). Comparing post-alert activity to a historical baseline can quickly validate that the log tampering was part of a larger attack.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - SIEM Alerts
      - Sourced from SIEM alert database and high-value asset endpoints
    range: last 90 days
    queries:
      - search: pseudocode
        query: ON log_modification_event for entity, COMPARE network_traffic and process_count in next hour to historical hourly baseline; ALERT if activity > 99th percentile.
  - question: After a log tampering event is added to an entity's activity graph, does the model predict a high-risk next step in a potential attack path?
    context: This question uses a graph-based model to contextualize a log tampering event within a broader attack chain. By representing users, hosts, and activities as a graph, the model can analyze relationships and predict the adversary's likely next move (e.g., creating a new IAM role). This allows security teams to proactively hunt for the predicted activity instead of waiting for the next alert.
    answer_sources:
      - Windows Event ID 4688
      - Zeek conn.log
      - SIEM Alerts
      - Sourced from SIEM alert database and high-value asset endpoints
    range: last 90 days
    queries:
      - search: pseudocode
        query: ADD 'log tampering' event as an edge in the entity-activity graph; RE-EVALUATE risk of connected nodes; PREDICT and hunt for likely next-hop activity.