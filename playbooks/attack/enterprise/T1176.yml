name: T1176: Software Extensions
id: 5a8e29d6-538a-40a1-9f7c-7a3b3e2b1c4d
description: >-
  Investigates whether an adversary is maintaining persistence using malicious or abused software extensions. This can manifest as browser processes making suspicious network connections to C2 servers, browsers being launched with arguments to load unpacked extensions from unusual locations, unauthorized processes accessing sensitive browser data files (like credentials or cookies), browser network traffic exhibiting C2 characteristics (e.g., DGA, beaconing), or the installation of an extension being immediately followed by the creation of another persistence mechanism on the host.
type: technique
related:
  - TA0003: Persistence
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are browser processes making network connections to known command-and-control (C2) servers?
    context: >-
      This question aims to detect a common indicator of compromise where a malicious browser extension communicates with its C2 server. By correlating process activity with network logs and threat intelligence, analysts can identify active infections. An alert from this correlation is a high-fidelity signal that a browser has been compromised and is communicating with a known malicious infrastructure.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Windows Event ID 4688
      - Endpoint devices
      - Network egress points
      - DNS resolvers
      - SIEM/Data Lake
      - High-confidence C2 threat intelligence feed
    range: last 90 days
    queries:
      - symbolic: "SEARCH process creation logs (EID 4688) FOR browser processes. JOIN with network connection logs (Zeek) and DNS logs (Zeek) ON host and timestamp. FILTER WHERE destination IP or resolved domain IN C2_threat_intel_feed. ALERT on match."
  - question: Are browser processes communicating with statistically rare IP addresses or exhibiting significant changes in domain browsing behavior?
    context: >-
      This question uses statistical methods to find anomalies that symbolic detection might miss. Communication with a very rare IP address could indicate a newly established C2 server not yet on threat feeds. A significant shift in a user's browsing habits (low Jaccard similarity) can also suggest that a malicious extension is directing the browser to new, malicious domains, breaking from the user's normal activity pattern.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Windows Event ID 4688
      - Endpoint devices
      - Network egress points
      - DNS resolvers
      - SIEM/Data Lake
    range: last 90 days
    queries:
      - statistical: "QUERY 1: ANALYZE network logs (Zeek conn) over 30 days to FIND destination IPs with prevalence < 0.01% of hosts. ALERT on new connections to these rare IPs from browser processes. QUERY 2: For each user, CREATE historical baseline of domains from DNS logs (last 90 days). CALCULATE Jaccard similarity between today's domains and baseline. ALERT if similarity < 0.5."
  - question: Are browser-initiated DNS queries being classified as algorithmically generated domains (DGA)?
    context: >-
      Malware, including malicious extensions, often uses Domain Generation Algorithms (DGAs) to create a large number of potential C2 domains, making them resilient to takedowns. This question applies a machine learning model to DNS queries to detect these algorithmically generated names. A browser making a DNS query for a domain flagged as DGA is a strong indicator of a malicious extension attempting to phone home.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Windows Event ID 4688
      - Endpoint devices
      - Network egress points
      - DNS resolvers
      - SIEM/Data Lake
    range: last 90 days
    queries:
      - machine_learning: "INPUT: Stream of DNS query events (Zeek dns.log) from browser processes. APPLY pre-trained NLP model to classify query name as 'legitimate' or 'DGA'. ALERT if classification is 'DGA' with high confidence."
  - question: Are browsers being launched with command-line arguments to load unpacked extensions from high-risk, user-writable directories?
    context: >-
      This question looks for a specific technique where adversaries load a malicious extension in "developer mode" to bypass store-based security controls. Legitimate developers use this feature, but when the extension is loaded from a common, user-writable, or temporary location (e.g., %TEMP%, C:\Users\Public), it is highly suspicious and often indicates a persistence mechanism dropped by malware.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Endpoint devices (workstations, servers)
    range: last 90 days
    queries:
      - symbolic: "SEARCH process creation logs (EID 4688, Sysmon EID 1) for browser executables. FILTER for command lines containing '--load-extension=' or '--user-data-dir='. ALERT if the specified path points to a high-risk directory (e.g., %TEMP%, C:\\Users\\Public)."
  - question: Are rare or unusual parent processes, such as a Microsoft Office application or a script interpreter, launching browsers with extension-loading flags?
    context: >-
      This question focuses on identifying anomalous process ancestry. Normally, users launch browsers from the desktop (explorer.exe). When a browser is launched by an unusual parent process, like Word or PowerShell, and simultaneously instructed to load an extension, it strongly suggests a malicious payload (e.g., a macro in a document) is attempting to install a persistent browser extension.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Endpoint devices (workstations, servers)
    range: last 90 days
    queries:
      - statistical: "PROFILE parent-child process relationships for browser executables to establish a baseline. CALCULATE rarity of each relationship across the enterprise. ALERT when a rare parent process (e.g., winword.exe) launches a browser AND the command line includes extension-loading flags."
  - question: Can command-line arguments from browser launch events be classified as malicious extension sideloading attempts using machine learning?
    context: >-
      This question applies a machine learning model to move beyond simple keyword matching and analyze the characteristics of the entire command line. Features like argument count, length, path entropy, and specific keywords are used to train a model to distinguish between benign and malicious browser launches. This provides a more robust and nuanced detection method for identifying attempts to sideload malicious extensions.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Endpoint devices (workstations, servers)
    range: last 90 days
    queries:
      - machine_learning: "EXTRACT features from browser process command-line arguments (e.g., arg count, length, path entropy, keywords). APPLY trained classification model (e.g., Random Forest) to score the event. ALERT if the event is scored as highly likely to be a malicious sideloading attempt."
  - question: Are unauthorized processes accessing sensitive browser data files like 'Login Data' or 'Cookies'?
    context: >-
      This question aims to detect credential and session theft. Browser extensions and other malware often attempt to steal sensitive data stored by the browser. By auditing access to these specific files and creating an allowlist of legitimate processes (the browser itself, its updater), any other process accessing them can be flagged as a potential threat.
    answer_sources:
      - Windows Event ID 4663
      - Sysmon Event ID 10
      - Endpoint devices
      - File servers hosting roaming user profiles
    range: last 90 days
    queries:
      - symbolic: "ENABLE file access auditing on sensitive browser data directories. MONITOR file access events (EID 4663) or process access events (Sysmon EID 10) for target files like 'Login Data'. DEFINE allowlist of legitimate processes. ALERT if accessing process is NOT in the allowlist."
  - question: Has there been a statistically significant increase in the number of unique processes accessing sensitive browser data files on a host?
    context: >-
      This question provides a statistical approach to detecting credential theft. Instead of relying on a static allowlist, it establishes a baseline of normal access patterns for each host. A sudden spike in the variety of processes (measured by Shannon entropy) accessing sensitive files like 'Login Data' indicates a deviation from normal behavior and could signal that a malicious tool or script is attempting to exfiltrate data.
    answer_sources:
      - Windows Event ID 4663
      - Sysmon Event ID 10
      - Endpoint devices
      - File servers hosting roaming user profiles
    range: last 90 days
    queries:
      - statistical: "For each host, ESTABLISH a baseline of unique processes accessing key browser files per 24-hour window. CALCULATE Shannon entropy of the set of accessing process names. ALERT if entropy on a host increases significantly (e.g., > 3 standard deviations from its mean)."
  - question: Are there anomalous file access patterns to sensitive browser data, such as access by unusual processes or at unusual times?
    context: >-
      This question leverages machine learning to identify complex, anomalous access patterns that may be missed by simpler rules. An anomaly detection model can learn the normal context of file access, including the source process, time of day, and access type. It can then flag highly unusual events, such as a script interpreter reading the cookie database in the middle of the night, as potential threats.
    answer_sources:
      - Windows Event ID 4663
      - Sysmon Event ID 10
      - Endpoint devices
      - File servers hosting roaming user profiles
    range: last 90 days
    queries:
      - machine_learning: "TRAIN an anomaly detection model (e.g., Isolation Forest) on enriched file access events. FEATURES should include: source process, target file, access type, time of day. APPLY model to new events to score for anomalousness. ALERT on events with a high anomaly score."
  - question: Are browser processes making DNS queries for recently registered domains or connecting to non-standard web ports?
    context: >-
      This question focuses on network indicators associated with newly set up C2 infrastructure. Adversaries often use newly registered domains (NRDs) for their campaigns. Alerting on connections to domains registered within the last 30 days can proactively detect threats. Similarly, C2 communication may occur over non-standard ports to evade simple firewalls, making such connections from a browser highly suspicious.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Zeek weird.log
      - Network egress points
      - Web proxies
      - DNS servers
      - SIEM/Data Lake
    range: last 90 days
    queries:
      - symbolic: "QUERY 1: From DNS logs, ENRICH queries with WHOIS data. ALERT if browser process queries a domain registered < 30 days ago. QUERY 2: From connection logs, ALERT if browser process connects to a destination port NOT in (80, 443), excluding known good services."
  - question: Are browsers generating DNS queries with high entropy or exhibiting periodic network beaconing behavior?
    context: >-
      This question looks for statistical network anomalies indicative of C2 communication. High-entropy domain names are often a feature of DGAs. Periodic, 'heartbeat' connections are a classic sign of malware checking in with its C2 server. Detecting these patterns can reveal malicious extensions even when the destination is not on a threat list.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Zeek weird.log
      - Network egress points
      - Web proxies
      - DNS servers
      - SIEM/Data Lake
    range: last 90 days
    queries:
      - statistical: "QUERY 1: For each host, CALCULATE Shannon entropy of requested domain names in 5-min windows. ALERT if entropy > 95th percentile of enterprise baseline. QUERY 2: To detect beaconing, for each source-destination pair, CALCULATE standard deviation of time between connections. ALERT if std dev is near zero over a series of connections."
  - question: Do network traffic patterns from a host show time-series anomalies indicative of C2 communication?
    context: >-
      This question uses a machine learning model to analyze the overall network behavior of a host over time. A model like an LSTM Autoencoder can learn the normal rhythm of a host's traffic (e.g., bytes in/out, connection counts). When a malicious extension begins C2 communication, it can create a subtle but distinct deviation from this learned pattern, which the model can flag as an anomaly based on a high reconstruction error.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Zeek weird.log
      - Network egress points
      - Web proxies
      - DNS servers
      - SIEM/Data Lake
    range: last 90 days
    queries:
      - machine_learning: "TRAIN time-series anomaly detection model (e.g., LSTM Autoencoder) on aggregated network features per host. APPLY model to live traffic data. ALERT on time windows where a host's reconstruction error is high."
  - question: Is a new browser extension installation being followed within a short time window by the creation of a new service, scheduled task, or autorun registry key?
    context: >-
      This question aims to detect when a malicious extension is used as a dropper for a more persistent threat. By correlating a new file in an extension directory with a subsequent, classic persistence event (new service, scheduled task, run key) on the same host, analysts can identify this multi-stage attack pattern. The tight time window (10 minutes) is key to linking the two events.
    answer_sources:
      - Sysmon Event ID 11
      - Windows Event ID 7045
      - Windows Event ID 4698
      - Windows Event ID 4657
      - Windows Event ID 4688
      - Endpoint devices
      - Active Directory domain controllers
    range: last 90 days
    queries:
      - symbolic: "TRIGGER on file creation (Sysmon EID 11) in a browser extension path. SEARCH for subsequent persistence events (EID 7045, 4698, 4657) on the same host within 10 minutes. ALERT if a correlated persistence event is found."
  - question: Is there a statistically significant correlation between new extension installations and subsequent persistence events on hosts?
    context: >-
      This question uses statistical analysis to validate the relationship between extension installations and other persistence events across the enterprise. By calculating whether these two event types co-occur more frequently than would be expected by chance (using a chi-squared test), an organization can build a data-driven case that this sequence is a genuine indicator of malicious activity.
    answer_sources:
      - Sysmon Event ID 11
      - Windows Event ID 7045
      - Windows Event ID 4698
      - Windows Event ID 4657
      - Windows Event ID 4688
      - Endpoint devices
      - Active Directory domain controllers
    range: last 90 days
    queries:
      - statistical: "CALCULATE baseline frequencies of 'new extension' events and 'persistence' events. CALCULATE observed co-occurrence frequency within a 1-hour window. USE chi-squared test to determine if the association is statistically significant (p-value < 0.01)."
  - question: Are host event sequences showing a rare or unlearned pattern where an extension installation is followed by a persistence mechanism?
    context: >-
      This question applies machine learning to model entire sequences of events on a host. A model can learn common, benign sequences that follow software installations. When a new extension installation is followed by an event that creates a new persistence mechanism, this may form a rare or novel sequence that the model has not seen before. Flagging such sequences can uncover new or unusual attack chains.
    answer_sources:
      - Sysmon Event ID 11
      - Windows Event ID 7045
      - Windows Event ID 4698
      - Windows Event ID 4657
      - Windows Event ID 4688
      - Endpoint devices
      - Active Directory domain controllers
    range: last 90 days
    queries:
      - machine_learning: "USE a sequence analysis model on host event streams. LEARN common event sequences that follow an 'extension_install' event. ALERT on sequences that deviate significantly from learned patterns, especially if they contain a rare transition from 'extension_install' to a 'persistence' event."