name: T1657: Financial Theft
id: 9a8b1c7d-4e6f-4a2b-8c9d-0e1f2a3b4c5d
description: >-
  This playbook helps investigate whether an adversary is attempting to perform or facilitate financial theft. 
  Key investigative areas include: identifying network connections to known malicious financial threat infrastructure; 
  detecting the execution of known financial fraud tools, ransomware, or cryptomining software on endpoints; 
  analyzing emails for indicators of Business Email Compromise (BEC) attempts; correlating high-risk user authentications 
  with subsequent access to financial services; monitoring for anomalous access to sensitive financial data repositories; 
  and detecting unusual outbound data flows from critical financial servers that could indicate data exfiltration for extortion.
type: technique
related:
  - TA0040: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Have any internal hosts connected to external destinations that match a threat intelligence feed for financial malware or cryptomining?
    context: This question aims to find direct evidence of compromise by checking for network connections to known malicious infrastructure. A match against a reliable threat intelligence feed is a high-fidelity indicator that an internal system is communicating with an adversary's command and control (C2) server or other malicious host related to financial theft.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Network egress points, including internet gateways, DNS resolvers, and web proxies.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH network_logs | JOIN threat_intel_feed ON destination | WHERE indicator_type = 'financial_theft' | ALERT
  - question: Are there any outbound TLS connections using rare or anomalous JA3 hashes, potentially indicating custom malware?
    context: Malware often uses specific cryptographic libraries, resulting in unique or uncommon JA3 TLS fingerprints. This question seeks to identify these outliers. By baselining common JA3 hashes in the environment, analysts can detect connections using fingerprints that are statistically rare, which could signify a previously unknown malicious tool communicating over an encrypted channel.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Network egress points, including internet gateways, DNS resolvers, and web proxies.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH tls_logs | BASELINE ja3_hash_frequency | FILTER ja3_hash_frequency < 1st_percentile | ALERT
  - question: Can a machine learning model identify network connections that are highly probable to be malicious and related to financial theft?
    context: This question focuses on using predictive analytics to find threats that don't match known signatures. By training a model on features from network logs (e.g., duration, byte counts, entropy), it can learn to distinguish between benign and malicious traffic patterns. This helps detect novel or evasive financial malware by scoring new connections and flagging those with a high probability of being malicious.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Network egress points, including internet gateways, DNS resolvers, and web proxies.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: INPUT network_connection_features | APPLY random_forest_model | FILTER prediction_score > malicious_threshold | ALERT
  - question: Have any processes been created on endpoints that match known signatures for cryptominers or financial malware?
    context: This question looks for the direct execution of malicious software on endpoints. By monitoring process creation events for known malicious file names, hashes, or command-line arguments from a curated watchlist, analysts can quickly detect the presence of tools used for financial theft, such as ransomware or cryptojacking software. A match is a strong indicator of an active intrusion.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Endpoints and servers, particularly those used by Finance/Accounting personnel or hosting financial applications.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH process_creation_events | JOIN malware_watchlist ON process_name, file_hash, command_line | ALERT
  - question: Are there any processes being executed with unusually high-entropy command-line arguments, suggesting obfuscation?
    context: Adversaries often obfuscate commands, especially for tools like PowerShell, to hide their activity. This question aims to detect this obfuscation by analyzing the randomness (entropy) of command-line arguments. A command with an entropy score significantly higher than the established baseline for a given host and process suggests that a complex, likely malicious, script is being run.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Endpoints and servers, particularly those used by Finance/Accounting personnel or hosting financial applications.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH process_creation_events | CALCULATE command_line_entropy | BASELINE entropy_per_host_process | FILTER entropy > 99th_percentile | ALERT
  - question: Can an unsupervised model detect anomalous process creation events that deviate from a host's normal behavior?
    context: This question focuses on identifying unknown threats by modeling normal process activity on a host. An unsupervised algorithm, like an Isolation Forest, can learn a baseline of typical behavior based on features like parent process, user context, and token elevation. It can then flag any new process creation event that is a significant outlier from this baseline, indicating potentially malicious activity.
    answer_sources:
      - Windows Event ID 4688
      - Sysmon Event ID 1
      - Endpoints and servers, particularly those used by Finance/Accounting personnel or hosting financial applications.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: INPUT process_creation_features | APPLY isolation_forest_model | FILTER anomaly_score is outlier | ALERT
  - question: Have any emails been received that show signs of a Business Email Compromise (BEC) attempt, such as header mismatches or financial keywords?
    context: This question targets common indicators of BEC fraud. By automatically scanning email headers for discrepancies (e.g., 'From' vs. 'Reply-To'), sender domains for lookalike patterns, and email content for urgent financial keywords ('wire transfer', 'urgent payment'), analysts can detect and flag phishing attempts designed to trick employees into making fraudulent payments.
    answer_sources:
      - Zeek smtp.log
      - Email gateway logs
      - Microsoft 365 audit logs
      - Email gateways, mail servers, network sensors monitoring SMTP traffic, and cloud email tenants (e.g., Microsoft 365, Google Workspace).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH email_logs | PARSE headers | FILTER (from_header != reply_to_header) AND (body CONTAINS 'urgent payment') | ALERT
  - question: Are there any emails containing financial keywords from senders who rarely or have never communicated with the recipient before?
    context: BEC attackers often impersonate executives or vendors, creating communication patterns that are unusual for the organization. This question aims to detect these anomalies by modeling the normal communication graph. An email with financial keywords from a sender who has a very low communication frequency with the recipient is highly suspicious and could indicate a targeted spear-phishing attempt.
    answer_sources:
      - Zeek smtp.log
      - Email gateway logs
      - Microsoft 365 audit logs
      - Email gateways, mail servers, network sensors monitoring SMTP traffic, and cloud email tenants (e.g., Microsoft 365, Google Workspace).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH email_logs | BASELINE sender_recipient_frequency | FILTER email_contains_financial_keywords AND sender_recipient_frequency < 5th_percentile | ALERT
  - question: Can an NLP model classify incoming emails as potential BEC attempts based on their linguistic patterns and content?
    context: This question leverages advanced AI to understand the intent behind an email's text. By training an NLP model on known BEC and legitimate emails, it can learn to identify subtle cues of social engineering, such as manufactured urgency, unusual sentiment, and specific linguistic patterns. This provides a powerful, context-aware method for detecting sophisticated BEC attacks that rule-based systems might miss.
    answer_sources:
      - Zeek smtp.log
      - Email gateway logs
      - Microsoft 365 audit logs
      - Email gateways, mail servers, network sensors monitoring SMTP traffic, and cloud email tenants (e.g., Microsoft 365, Google Workspace).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: INPUT email_body_text | APPLY fine_tuned_bert_model | FILTER classification = 'BEC_attempt' | ALERT
  - question: Has a high-risk login been followed by connections to financial services websites within a short time frame?
    context: This question correlates a suspicious authentication event with subsequent risky behavior. A login from a known malicious IP (e.g., a TOR exit node) is inherently high-risk. If this event is immediately followed by the compromised user's machine accessing financial websites, it strongly suggests an adversary is attempting to perform fraudulent transactions or steal financial information.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek http.log
      - Zeek ssl.log
      - VPN logs
      - SSO provider logs
      - Authentication servers (e.g., Active Directory), VPN concentrators, SSO platforms, and network egress points.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH login_events WHERE source_ip in tor_watchlist | CORRELATE with network_logs within 30m on user | WHERE destination_category = 'Financial Services' | ALERT
  - question: Are there any user logins with a very high risk score that are correlated with subsequent HTTP POST requests to financial URIs?
    context: This question aims to identify account takeover by scoring the risk of each login. By assigning points for anomalous factors (e.g., rare geolocation, non-business hours, new device), a cumulative risk score can be calculated. Correlating a login that exceeds a high-risk threshold with subsequent web activity, such as POST requests to payment or transfer URIs, provides a strong signal of an attacker using a compromised account for financial theft.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek http.log
      - Zeek ssl.log
      - VPN logs
      - SSO provider logs
      - Authentication servers (e.g., Active Directory), VPN concentrators, SSO platforms, and network egress points.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH login_events | CALCULATE risk_score (geo, time, device) | FILTER risk_score > 98th_percentile | CORRELATE with http_logs | WHERE http_method = 'POST' and uri CONTAINS 'payment' | ALERT
  - question: Are there any user sessions that exhibit an anomalous sequence of activities, such as a high-risk login followed immediately by financial application access?
    context: This question seeks to detect attacks by analyzing the entire chain of user actions within a session. A sequence-based model (like an LSTM autoencoder) can learn the normal flow of user activity. An alert is generated when a session has a high reconstruction error, meaning its sequence of events is highly abnormal. This is especially powerful for detecting sessions that begin with a suspicious login and deviate directly to sensitive financial actions.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek http.log
      - Zeek ssl.log
      - VPN logs
      - SSO provider logs
      - Authentication servers (e.g., Active Directory), VPN concentrators, SSO platforms, and network egress points.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: INPUT user_session_sequences | APPLY lstm_autoencoder_model | FILTER reconstruction_error > anomaly_threshold | ALERT
  - question: Has an unauthorized user or process accessed a critical financial file share or database?
    context: This question enforces a strict access control policy on critical assets. By maintaining an explicit allow list of users and processes permitted to access sensitive financial data, any access event from an entity not on that list can be immediately flagged. This rule-based approach is effective for protecting crown-jewel data stores from unauthorized access, particularly when write or delete permissions are requested.
    answer_sources:
      - Windows Event ID 4663
      - Zeek conn.log
      - Database audit logs
      - Financial databases (e.g., ERP systems), payment processing servers, file servers containing sensitive accounting or payroll data, and cloud storage buckets containing financial data.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH file_access_logs on critical_share | FILTER user NOT IN allow_list OR process NOT IN allow_list | ALERT
  - question: Has a critical financial server experienced an anomalous spike in user access or access during non-standard hours?
    context: This question aims to detect mass data access or off-hours activity that could signal a breach. By establishing a time-series baseline of normal access patterns (e.g., user count per hour, time of day), statistical deviations can be identified. A sudden spike in the number of users or any access during a period that is normally quiet (like 3 AM) is a strong anomaly indicator that warrants investigation for data theft.
    answer_sources:
      - Windows Event ID 4663
      - Zeek conn.log
      - Database audit logs
      - Financial databases (e.g., ERP systems), payment processing servers, file servers containing sensitive accounting or payroll data, and cloud storage buckets containing financial data.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH access_logs_for_critical_server | AGGREGATE unique_users by hour | BASELINE hourly_user_count | FILTER current_count > 3_std_dev_from_avg | ALERT
  - question: Is any user accessing financial data in a way that is inconsistent with their peer group's behavior?
    context: This question identifies insider threats or compromised accounts by comparing a user's behavior to their peers. Users in the same role typically access similar data. By clustering users based on their data access patterns, we can define a 'normal' profile for each group. An alert is triggered when a user's activity significantly deviates from their group's norm, such as a marketing user accessing the payroll database.
    answer_sources:
      - Windows Event ID 4663
      - Zeek conn.log
      - Database audit logs
      - Financial databases (e.g., ERP systems), payment processing servers, file servers containing sensitive accounting or payroll data, and cloud storage buckets containing financial data.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: INPUT user_data_access_patterns | APPLY k-means_clustering | FOR each user, COMPARE activity to cluster_centroid | FILTER deviation > threshold | ALERT
  - question: Are unusual file types (e.g., .zip, .rar, .bak) being transferred outbound from a critical financial server?
    context: This question aims to detect data exfiltration staging. Adversaries often compress and archive data before exfiltrating it. A production database server, for example, should not be sending ZIP or backup files to an external IP. Monitoring for these unusual file types in outbound traffic from sensitive servers provides a strong signal that an attacker is preparing to steal data.
    answer_sources:
      - Zeek conn.log
      - Zeek files.log
      - DLP solution logs
      - Critical data repositories, database servers, file servers, and network egress points.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH file_transfer_logs | WHERE source is critical_server AND destination is external AND file_type IN ('.zip', '.bak', '.rar') | ALERT
  - question: Has any critical financial server sent an anomalously large amount of data outbound?
    context: This question seeks to detect bulk data exfiltration by monitoring network traffic volume. By creating a statistical baseline of normal outbound data flow for each critical server, any significant spike can be identified. Using a method like the IQR to define 'normal' allows the system to automatically flag any time window where the data volume is a statistical outlier, indicating a potential large-scale data theft.
    answer_sources:
      - Zeek conn.log
      - Zeek files.log
      - DLP solution logs
      - Critical data repositories, database servers, file servers, and network egress points.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH network_logs | AGGREGATE outbound_bytes by hour for critical_server | BASELINE hourly_volume_iqr | FILTER current_volume > upper_whisker | ALERT
  - question: Can a machine learning model identify outbound connections from financial servers that are anomalous and likely represent data exfiltration?
    context: This question applies machine learning to build a high-fidelity model of 'normal' egress traffic for sensitive servers. A one-class SVM learns a boundary around normal behavior using features like destination ASN, port, and data volume. Any new connection that falls outside this boundary is flagged as an anomaly. This is effective for detecting novel exfiltration techniques that may not trigger volume or file-type rules.
    answer_sources:
      - Zeek conn.log
      - Zeek files.log
      - DLP solution logs
      - Critical data repositories, database servers, file servers, and network egress points.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: INPUT outbound_connection_features | APPLY one-class_svm_model | FILTER classification = 'anomaly' | ALERT