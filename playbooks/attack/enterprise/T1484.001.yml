name: T1484.001: Group Policy Modification
id: 5a1b3c4d-8e9f-4a7b-8c6d-0e1f2a3b4c5d
description: This playbook helps investigate whether an adversary has modified Group
  Policy for privilege escalation or defense evasion. This involves detecting malicious
  files written to SYSVOL shares, identifying suspicious processes spawned by GPO
  scripts that attempt to add users to privileged groups, and monitoring for changes
  to GPO security descriptors that grant unauthorized permissions. It also covers
  correlating GPO modifications with subsequent sensitive user rights assignments,
  the creation of malicious scheduled tasks or services, the disabling of security
  controls like Windows Defender, the clearing of event logs, and modifications made
  by non-standard processes or from untrusted hosts.
type: technique
related:
- TA0004: Privilege Escalation
- TA0005: Defense Evasion
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Have any files with hashes matching known-bad threat intelligence been
    written to a GPO policy directory on the SYSVOL share?
  context: Adversaries may place malicious scripts or executables within a GPO's
    directory on the SYSVOL share. These files are then replicated to all domain-joined
    computers and can be executed, often with high privileges. This question aims
    to identify the presence of known malicious files by comparing the hash of any
    new file written to a GPO policy directory against a threat intelligence feed.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 5145
  - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4663)
      where object_name contains "\\SYSVOL\\Policies\\"
      calculate file_hash(object_name)
      lookup threat_intel_feed on file_hash
      return events where match_found
- question: Have any files with unusually high entropy, suggesting packing or encryption,
    been written to the SYSVOL share?
  context: Malware is often packed or encrypted to evade signature-based detection,
    which results in a high Shannon entropy score (a measure of randomness). Legitimate
    policy and script files typically have a predictable, lower entropy. This question
    seeks to identify potentially malicious files by detecting those with an abnormally
    high entropy score compared to a baseline of normal files in the SYSVOL share.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 5145
  - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4663)
      where object_name contains "\\SYSVOL\\Policies\\"
      calculate shannon_entropy(object_name)
      compare entropy to established_baseline
      return events where entropy > 95th_percentile
- question: Have any unexpected file types, such as executables, been written to
    the SYSVOL share?
  context: GPO policy directories on the SYSVOL share typically contain specific
    file types like policy files (.pol), scripts (.bat, .ps1), and templates (.inf).
    The presence of unexpected file types, especially executables (.exe) or obfuscated
    scripts, could indicate an adversary has placed malicious tools for execution
    via GPO. This question uses a file-type classification model to detect such anomalies.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 5145
  - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4663)
      where object_name contains "\\SYSVOL\\Policies\\"
      apply file_type_classification_model to object_name
      return events where classification is "executable" or "obfuscated"
- question: Have processes spawned by GPO scripts executed commands indicative of
    local privilege escalation?
  context: GPO can be used to execute scripts on endpoints. Adversaries can abuse
    this to run commands that escalate privileges, such as adding a user to the local
    Administrators group. This question monitors for processes created by GPO script
    hosts (`gpscript.exe`, `gpupdate.exe`) and inspects their command lines for known
    privilege escalation patterns.
  answer_sources:
  - Windows Event ID 4688
  - All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4688)
      where parent_process_name in ("gpscript.exe", "gpupdate.exe")
      and command_line contains patterns like ["net localgroup administrators /add", "sc.exe create"]
      return events
- question: Have any statistically rare or never-before-seen commands been executed
    by GPO scripts?
  context: While administrators use GPO scripts for legitimate purposes, their command
    line patterns are often repetitive and predictable. Adversaries attempting privilege
    escalation may use novel or infrequent commands. This question aims to detect
    such anomalies by baselining command line patterns from GPO-spawned processes
    and alerting on rare or new patterns.
  answer_sources:
  - Windows Event ID 4688
  - All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4688)
      where parent_process_name in ("gpscript.exe", "gpupdate.exe")
      calculate frequency of command_line over time
      return events where frequency is in bottom_1st_percentile or new
- question: Has an NLP model classified any command lines from GPO-spawned processes
    as likely being for privilege escalation?
  context: Manually creating patterns for every possible malicious command is difficult.
    A Natural Language Processing (NLP) model can be trained to understand the intent
    behind command lines. This question applies such a model to classify commands
    executed by GPO scripts, alerting when a command is likely intended to escalate
    privileges.
  answer_sources:
  - Windows Event ID 4688
  - All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4688)
      where parent_process_name in ("gpscript.exe", "gpupdate.exe")
      apply NLP_privesc_model to command_line
      return events where model_probability > threshold
- question: Have write permissions for a GPO been granted to a non-administrative
    user or group?
  context: To modify a GPO, an adversary needs write permissions. They might achieve
    this by altering the GPO's security descriptor (`nTSecurityDescriptor`). This
    question monitors for modifications to `groupPolicyContainer` objects and alerts
    if write-related permissions are granted to any user or group not on an approved
    allowlist of GPO administrators.
  answer_sources:
  - Windows Event ID 5136
  - Active Directory Domain Controllers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=5136)
      where object_class = "groupPolicyContainer"
      parse security_descriptor_change
      return events where write_permission granted to non_allowlisted_subject
- question: Has a user modified a GPO that they do not typically manage?
  context: Administrators often have specific responsibilities and tend to modify
    the same set of GPOs. An adversary using a compromised account might modify a
    GPO outside that account's normal scope of activity. This question establishes
    a baseline of which users modify which GPOs and alerts when a rare or unprecedented
    user-GPO modification pair is observed.
  answer_sources:
  - Windows Event ID 5136
  - Active Directory Domain Controllers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=5136)
      where object_class = "groupPolicyContainer"
      calculate rarity_score for (user, GPO_object) pair based on historical data
      return events where rarity_score > threshold
- question: Has a user's GPO modification behavior anomalously shifted to resemble
    that of a different administrative group?
  context: User behavior can be clustered based on activity patterns. For instance,
    helpdesk staff might modify a different set of GPOs than domain administrators.
    This question uses clustering to group users by their GPO modification behavior.
    An alert is generated if a user's activity causes them to shift clusters (e.g.,
    a standard user's behavior now resembles an admin's) or become an outlier, which
    could indicate account misuse.
  answer_sources:
  - Windows Event ID 5136
  - Active Directory Domain Controllers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=5136)
      where object_class = "groupPolicyContainer"
      input user_activity into clustering_model
      return events where user_shifts_cluster or becomes_outlier
- question: Has a GPO modification been quickly followed by the assignment of a sensitive
    user right on endpoints?
  context: Adversaries can modify a GPO to grant themselves powerful user rights
    (e.g., 'Act as part of the operating system' or 'Debug programs') on domain computers.
    This question looks for a temporal correlation between a GPO being modified and
    a sensitive privilege being assigned via that GPO on endpoints, which strongly
    suggests a malicious GPO change.
  answer_sources:
  - Windows Event ID 5136
  - Windows Event ID 4704
  - Windows Event ID 4672
  - Active Directory Domain Controllers, All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=5136) as gpo_mod
      join with (search source="WinEventLog:Security" AND EventID=4704 AND sensitive_privilege=true) as priv_assign
      where gpo_mod.gpo_name = priv_assign.gpo_name
      and priv_assign.time - gpo_mod.time < 2_hours
      return correlated_events
- question: Has an unauthorized GPO been used to assign a sensitive privilege, or
    has a GPO assigned a privilege to an unusually large number of endpoints?
  context: In a well-managed environment, only specific, designated GPOs should be
    used to assign sensitive privileges. This question checks if a privilege assignment
    originates from an unauthorized GPO. It also looks for anomalous scale, where
    a single GPO suddenly assigns a privilege to a much larger number of endpoints
    than usual, which could indicate a widespread privilege escalation attack.
  answer_sources:
  - Windows Event ID 5136
  - Windows Event ID 4704
  - Windows Event ID 4672
  - Active Directory Domain Controllers, All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4704 AND sensitive_privilege=true)
      where gpo_name is not in authorized_gpo_list
      OR count(endpoints by gpo_name) > 3_std_dev_from_mean
      return events
- question: Has there been an anomalous spike in sensitive privilege assignments
    that correlates with a recent GPO modification?
  context: A widespread privilege escalation attack via GPO would likely cause a
    sudden, significant increase in the number of sensitive privilege assignment
    events across the network. This question uses a time-series model to forecast
    the expected volume of these events and alerts when the actual number far exceeds
    the prediction, especially if the spike occurs shortly after a GPO was modified.
  answer_sources:
  - Windows Event ID 5136
  - Windows Event ID 4704
  - Windows Event ID 4672
  - Active Directory Domain Controllers, All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4704 AND sensitive_privilege=true)
      input event_counts into time_series_model
      alert if observed_count > forecast_upper_bound
      especially if correlated with recent EventID=5136
- question: Has a newly created GPO led to the creation of a scheduled task or service
    running with SYSTEM privileges from a suspicious path?
  context: A common persistence and escalation method is to use a GPO to create a
    scheduled task or service on endpoints. Adversaries often configure these to
    run with the highest privileges (SYSTEM) and execute a payload from a non-standard,
    user-writable directory like AppData or Temp. This question correlates GPO creation
    with subsequent task/service creation to find this pattern.
  answer_sources:
  - Windows Event ID 5137
  - Windows Event ID 4698
  - Windows Event ID 7045
  - Active Directory Domain Controllers, All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=5137) as gpo_creation
      join with (search source="WinEventLog:Security" AND (EventID=4698 OR EventID=7045)) as task_creation
      where task_creation.time - gpo_creation.time is short
      and task_creation.user = "SYSTEM"
      and task_creation.executable_path in ["%APPDATA%", "%TEMP%"]
      return correlated_events
- question: Following a GPO creation, has there been a statistically significant
    increase in new scheduled tasks or services within the affected OUs?
  context: When a GPO is used to deploy a malicious task or service, it will cause
    a burst of creation events across all computers in the Organizational Units (OUs)
    where the GPO is applied. This question aims to detect this burst by baselining
    the normal rate of task/service creation per OU and alerting on a statistically
    significant increase following a GPO creation event.
  answer_sources:
  - Windows Event ID 5137
  - Windows Event ID 4698
  - Windows Event ID 7045
  - Active Directory Domain Controllers, All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=5137)
      get affected_OUs from event
      monitor rate of (EventID=4698 OR EventID=7045) in affected_OUs
      alert if rate > 99th_percentile_of_baseline post-EventID-5137
- question: Have any anomalously configured scheduled tasks or services been created
    shortly after a GPO update?
  context: Malicious scheduled tasks and services often have properties that make
    them outliers compared to legitimate ones (e.g., unusual account names, suspicious
    command arguments, strange trigger types). This question uses an anomaly detection
    algorithm to identify such outlier tasks/services, paying special attention to
    any that appear on multiple machines shortly after a GPO update.
  answer_sources:
  - Windows Event ID 5137
  - Windows Event ID 4698
  - Windows Event ID 7045
  - Active Directory Domain Controllers, All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND (EventID=4698 OR EventID=7045))
      input task_properties into anomaly_detection_model (e.g., Isolation Forest)
      return events flagged as outliers, especially if clustered in time after a GPO update
- question: Have GPO policy files like `registry.pol` or `GptTmpl.inf` been modified
    to include settings that disable security controls?
  context: Adversaries may modify GPO policy files directly on the SYSVOL share to
    disable security tools, such as Windows Defender, or to degrade audit policies
    across the domain. This question aims to detect such modifications by scanning
    the content of key policy files for specific strings that correspond to security-weakening
    settings.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 5136
  - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4663)
      where object_name ends with "registry.pol" OR object_name ends with "GptTmpl.inf"
      scan file_content for keywords ["DisableAntiSpyware", "EnableLsaAuditing"]
      return events where keyword_match_found
- question: Have critical security GPOs been modified in an anomalous way compared
    to their baseline configuration?
  context: Critical GPOs that enforce security settings should remain stable. This
    question establishes a 'golden image' baseline for these GPOs and then performs
    a comparison (diff) upon any modification. An alert is triggered if the number
    of changes is unusually high or if the GPO is being modified more frequently
    than normal, suggesting tampering.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 5136
  - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      on event (EventID=5136 or EventID=4663 for critical_GPO)
      diff current_gpo_file with golden_image_baseline
      alert if num_changes > threshold OR modification_frequency is anomalous
- question: Has a machine learning model classified a recent GPO file change as high-risk
    or malicious?
  context: Evaluating the risk of a GPO change can be complex, involving multiple
    factors. This question applies a trained classification model that considers
    the specific setting changed, the user who made the change, and other contextual
    activities. It alerts when any GPO modification receives a high-risk score, indicating
    a high probability of malicious intent.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 5136
  - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      on event (EventID=5136 or EventID=4663)
      extract_features(setting_changed, user, context)
      apply malicious_gpo_change_model
      alert if risk_score > threshold
- question: Have processes spawned by GPO scripts executed commands known to be used
    for defense evasion?
  context: Adversaries can use GPO-deployed scripts to actively disable security
    measures on endpoints. This question monitors for processes created by GPO script
    hosts (`gpscript.exe`) and inspects their command lines for patterns associated
    with defense evasion, such as modifying firewall rules, clearing event logs,
    or disabling security services.
  answer_sources:
  - Windows Event ID 4688
  - All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4688)
      where parent_process_name = "gpscript.exe"
      and command_line contains patterns like ["netsh advfirewall set", "wevtutil.exe cl", "start= disabled", "Set-MpPreference -Disable"]
      return events
- question: Have any rarely used command-line utilities been executed by GPO scripts,
    especially those associated with defense evasion?
  context: While some defense evasion tools like `netsh.exe` might be used legitimately,
    their execution via GPO scripts might be rare. This question baselines the usage
    frequency of various command-line utilities initiated by GPO scripts and alerts
    when a rarely used utility is executed or when the usage of a known defense evasion
    tool spikes anomalously.
  answer_sources:
  - Windows Event ID 4688
  - All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4688)
      where parent_process_name = "gpscript.exe"
      calculate frequency of process_name over time
      alert if process_name is rare OR usage_of_known_evasion_tool > 95th_percentile
- question: Have any GPO-spawned processes been flagged as anomalous outliers by
    an unsupervised learning model?
  context: Adversaries may use novel or obfuscated command-line arguments that do
    not match predefined patterns. This question uses an unsupervised learning model
    (like DBSCAN) to cluster the command-line arguments of GPO-spawned processes.
    It alerts on any process that doesn't fit into an established cluster of normal
    activity, flagging it as a potential new or unique threat.
  answer_sources:
  - Windows Event ID 4688
  - All Domain-joined Endpoints and Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4688)
      where parent_process_name = "gpscript.exe"
      input command_line_arguments into clustering_model
      alert if process is flagged as noise_point or forms_new_small_cluster
- question: Have critical GPO files been modified to weaken a specific security control
    compared to a 'Golden GPO' template?
  context: Maintaining a secure baseline for GPOs is critical. This question defines
    a 'Golden GPO' template for essential security policies. After any modification
    to a monitored GPO file, it is programmatically compared against this template.
    An alert is generated for any deviation that constitutes a security downgrade,
    such as a firewall being disabled.
  answer_sources:
  - Windows Event ID 5136
  - Windows Event ID 4663
  - Active Directory Domain Controllers, Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      on event (EventID=4663 for critical_gpo_file)
      compare changed_file_settings with golden_gpo_template
      alert on any deviation representing a security downgrade
- question: Has a critical security setting within a GPO been changed to a statistically
    rare or historically unseen insecure value?
  context: Security settings within GPOs can have multiple possible values, some
    more secure than others. This question tracks the historical values for critical
    settings (e.g., UAC levels) and alerts if a GPO modification changes a setting
    to a value that is known to be insecure and is also statistically rare or has
    never been seen before in the environment's history.
  answer_sources:
  - Windows Event ID 5136
  - Windows Event ID 4663
  - Active Directory Domain Controllers, Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      on event (EventID=5136 or EventID=4663)
      for each critical_setting_changed
      check historical_distribution_of_values
      alert if new_value is statistically_rare and insecure
- question: Has a GPO modification resulted in a statistically significant drop in
    its calculated 'security score'?
  context: The overall security posture of a GPO can be quantified into a 'security
    score' based on its various settings. This question uses a regression model,
    trained on audited GPOs, to calculate this score. After any modification, the
    score is recalculated, and an alert is triggered if there is a significant drop,
    indicating a degradation of the GPO's security posture.
  answer_sources:
  - Windows Event ID 5136
  - Windows Event ID 4663
  - Active Directory Domain Controllers, Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*\)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      on event (EventID=5136)
      recalculate_security_score for modified_gpo
      alert if new_score < old_score - threshold
- question: Has a GPO modification been followed by a 'log source silent' alert from
    the affected host group?
  context: An effective defense evasion technique is to use GPO to disable or reconfigure
    security logging on endpoints. This question creates a direct correlation rule:
    if a GPO is modified, and soon after, a SIEM alert indicates that hosts affected
    by that GPO have stopped sending logs, it raises a high-priority alert for potential
    log tampering via GPO.
  answer_sources:
  - Windows Event ID 5136
  - SIEM Log Ingestion Metrics
  - SIEM / Log Aggregator Platform, Active Directory Domain Controllers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=5136) as gpo_mod
      join with (search source="SIEM" AND alert_name="Log Source Silent") as log_silent
      where log_silent.host in get_hosts_for_gpo(gpo_mod.gpo_name)
      and log_silent.time > gpo_mod.time
      return correlated_events
- question: Following a GPO modification, has log volume from an affected OU dropped
    significantly below its baseline?
  context: Rather than logs stopping entirely, an adversary might use GPO to selectively
    disable certain audit categories, causing a drop in log volume. This question
    baselines the normal log volume for each critical log source per Organizational
    Unit (OU). It alerts if, after a GPO modification, the log volume from an affected
    OU drops by a statistically significant amount (e.g., more than 3 standard deviations)
    for a sustained period.
  answer_sources:
  - Windows Event ID 5136
  - SIEM Log Ingestion Metrics
  - SIEM / Log Aggregator Platform, Active Directory Domain Controllers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      on event (EventID=5136)
      get affected_OUs
      monitor log_volume from affected_OUs
      alert if log_volume < (baseline_mean - 3 * baseline_std_dev) for >30_minutes
- question: Has the actual log ingestion volume fallen significantly below the forecasted
    volume after a GPO modification event?
  context: Log volumes can have natural fluctuations (e.g., time of day, day of week).
    A sophisticated time-series forecasting model can predict the expected log volume,
    accounting for these patterns. This question uses such a model and treats GPO
    modifications as a potential influencing factor. An alert is raised if the actual
    log volume falls significantly below the model's predicted range after a GPO
    change.
  answer_sources:
  - Windows Event ID 5136
  - SIEM Log Ingestion Metrics
  - SIEM / Log Aggregator Platform, Active Directory Domain Controllers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      on event (EventID=5136) as gpo_mod_event
      input gpo_mod_event into time_series_model as regressor
      compare actual_log_volume with model_forecast
      alert if actual_log_volume < forecast_lower_confidence_bound
- question: Have GPO files in SYSVOL been modified by a non-standard process or from
    an unapproved source host?
  context: Legitimate GPO modifications are typically made through standard tools
    like `mmc.exe` from administrative workstations or Domain Controllers. An adversary
    might use other tools or modify files from a compromised server. This question
    alerts on file writes to SYSVOL policy paths if the source process or source
    IP address is not on a pre-approved allowlist.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 5145
  - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\), Administrator Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search (source="WinEventLog:Security" AND EventID=4663 AND object_name contains "\\SYSVOL\\Policies\\")
      correlate with EventID=5145 to get source_process and source_ip
      alert if source_process not in allowlist OR source_ip not in admin_zone
- question: Has a highly unusual combination of user, source host, and process performed
    a write operation in SYSVOL?
  context: This question profiles the normal patterns of GPO modifications, looking
    at the combination of the user account, the source hostname, and the process
    name involved. It calculates the frequency of each unique combination (tuple).
    An alert is generated when a file write is performed by a tuple that is statistically
    very rare (e.g., in the bottom 1% of frequency), indicating a highly unusual and
    suspicious access pattern.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 5145
  - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\), Administrator Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      search file_write_events on SYSVOL
      create tuple (user, source_host, process_name)
      calculate historical frequency of tuple
      alert if frequency < 1st_percentile
- question: Has a one-class SVM model, trained on legitimate activity, flagged a
    SYSVOL write event as an anomaly?
  context: A one-class Support Vector Machine (SVM) is an anomaly detection algorithm
    that learns a boundary around 'normal' data. This question applies a model trained
    on the features of legitimate SYSVOL write events (process name, source subnet,
    user, time of day). Any new write event that falls outside this learned boundary
    is flagged as an anomaly, potentially indicating adversary activity.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 5145
  - Domain Controller SYSVOL Share (\\<DOMAIN>\SYSVOL\), Administrator Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |-
      on SYSVOL_write_event
      extract_features(process, source_subnet, user, time_of_day)
      apply one_class_svm_model
      alert if event is flagged as anomaly