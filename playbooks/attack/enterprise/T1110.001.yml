name: T1110.001: Password Guessing
id: 5a8a1835-9f5b-4b1e-8121-0d24e5b9b8b0
description: This playbook helps identify adversarial attempts to gain access to user accounts via password guessing techniques, such as brute-force or password spraying. It focuses on analyzing authentication logs for patterns indicative of malicious activity, including logins from known malicious sources, high ratios of failed to successful logins, targeting of common usernames, distinct patterns of one-to-many (spraying) or many-to-one (brute-force) attempts, spikes in account lockouts, and low-and-slow attacks designed to evade simple thresholds.
type: technique
related:
  - TA0006: Credential Access
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are authentication attempts originating from source IPs or using User-Agents known to be malicious from threat intelligence feeds?
    context: This question aims to identify brute-force or credential stuffing activity by cross-referencing live authentication data against a curated list of known malicious indicators. Matching an IP or User-Agent from a threat feed provides a high-confidence signal that the activity is part of a coordinated attack campaign. This is a direct, symbolic method for detecting known threats.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek http.log
      - Zeek ssh.log
      - Zeek rdp.log
      - Externally-facing Web Applications (e.g., OWA, SharePoint)
      - VPN Concentrators
      - Network Edge Firewalls
      - Cloud Service Provider Portals
      - Domain Controllers
    range: Last 90 days
    queries:
      - technology: SIEM
        query: SEARCH authentication_logs AND web_logs | JOIN source_ip, user_agent with threat_intelligence_feed ON ip_address, user_agent | WHERE threat_match = TRUE
  - question: Is any single external source IP showing an abnormally high ratio of failed to successful logins compared to the established baseline?
    context: This question tries to find outlier IP addresses exhibiting behavior consistent with a brute-force attack. A legitimate user might have a few failed logins, but an attacker will have a significantly higher failure rate. By comparing the ratio for a single IP over a one-hour window against a statistical baseline (e.g., the 95th percentile of all external IPs), we can flag suspicious IPs that deviate from normal user behavior.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Externally-facing Web Applications (e.g., OWA, SharePoint)
      - VPN Concentrators
      - Network Edge Firewalls
      - Cloud Service Provider Portals
      - Domain Controllers
    range: Last 90 days
    queries:
      - technology: SIEM/Data Analytics Platform
        query: SEARCH authentication_logs | BUCKET by 1h | GROUPBY source_ip | CALCULATE ratio = count(failed_logins) / count(successful_logins) | COMPARE ratio against historical_baseline | WHERE ratio > 95th_percentile
  - question: Can a machine learning model classify incoming login attempts as malicious in real-time based on a combination of features?
    context: This question proposes a sophisticated, proactive approach to detection. Instead of relying on single indicators, a machine learning classification model can analyze multiple features simultaneously (e.g., IP reputation, User-Agent string rarity, time of day, country of origin) to make a more nuanced decision. This helps detect novel or complex attacks that might evade simpler rule-based systems by identifying malicious attempts with a high confidence score.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek http.log
      - Zeek ssh.log
      - Zeek rdp.log
      - Threat Intelligence Feeds
      - Externally-facing Web Applications (e.g., OWA, SharePoint)
      - VPN Concentrators
      - Network Edge Firewalls
      - Cloud Service Provider Portals
      - Domain Controllers
    range: Last 90 days
    queries:
      - technology: Machine Learning Model
        query: INPUT login_event_features (ip_rep, ua_rarity, time_of_day, protocol, country) | PREDICT classification using trained_model | WHERE classification = 'malicious' AND confidence_score > 0.9
  - question: Is a single source IP generating failed logins for many common or default usernames within a short time?
    context: This question helps detect dictionary attacks, where an adversary uses a list of common usernames ('admin', 'root', 'guest', etc.) to find a valid account. By maintaining a watchlist of these usernames, a SIEM rule can trigger an alert when a single IP address attempts to log in with more than a few of them (e.g., >5) in a short window (e.g., 15 minutes), which is highly indicative of a targeted reconnaissance or brute-force attempt.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - Zeek ssh.log
      - Domain Controllers
      - Authentication Servers (RADIUS, Kerberos)
      - Application Servers with default accounts
      - Network Appliances (routers, switches)
    range: Last 90 days
    queries:
      - technology: SIEM
        query: SEARCH failed_logins WHERE username IN common_username_watchlist | BUCKET by 15m | GROUPBY source_ip | WHERE distinct_count(username) > 5
  - question: Does the set of usernames targeted by a single source IP show an unusually high level of diversity or randomness?
    context: This question uses a statistical measure, Shannon entropy, to identify dictionary attacks. Legitimate traffic usually has low entropy (few users from one IP). An attacker trying many different usernames will produce a high entropy value for the set of usernames they target. By establishing a baseline for normal entropy and alerting when an IP exceeds the 98th percentile, we can detect an unusually diverse and suspicious set of targeted accounts.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - Zeek ssh.log
      - Domain Controllers
      - Authentication Servers (RADIUS, Kerberos)
      - Application Servers with default accounts
      - Network Appliances (routers, switches)
    range: Last 90 days
    queries:
      - technology: Data Analytics Platform
        query: SEARCH failed_logins | BUCKET by 30m | GROUPBY source_ip | CALCULATE shannon_entropy(username_list) | COMPARE entropy against historical_baseline | WHERE entropy > 98th_percentile
  - question: Can we identify clusters of activity where a single source IP is attempting to access many different common usernames?
    context: This question applies unsupervised machine learning to find dictionary attacks. A density-based clustering algorithm like DBSCAN can group authentication failures based on features like source IP and target username. An attack will form a dense cluster where a single source IP (a 'core point') is linked to many different usernames, a pattern that the algorithm can isolate and flag for investigation.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - Zeek ssh.log
      - Domain Controllers
      - Authentication Servers (RADIUS, Kerberos)
      - Application Servers with default accounts
      - Network Appliances (routers, switches)
    range: Last 90 days
    queries:
      - technology: Machine Learning Model
        query: INPUT failed_login_features (source_ip, target_username) | RUN DBSCAN_clustering | IDENTIFY clusters where one_source_ip is connected to many_target_usernames
  - question: Are we observing patterns of password spraying (one source, many targets) or brute-forcing (one target, many sources)?
    context: This question uses symbolic logic to differentiate between two common attack types. A password spraying rule alerts if a single source IP fails to log into many distinct accounts (e.g., >20) with few attempts each. A brute-force rule alerts if a single account experiences a high volume of failures (e.g., >50) from any source. These distinct rules allow for more specific identification of the adversary's TTP.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Zeek conn.log
      - Domain Controllers
      - Cloud Service Provider Portals (e.g., Azure AD, AWS Console)
      - VPN Concentrators
      - Externally-facing Web Applications
    range: Last 90 days
    queries:
      - technology: SIEM
        query: SEARCH failed_logins | RUN rule_logic | IF (distinct_count(target_account) > 20 AND attempts_per_account <= 3) from single_source_ip in 1h, ALERT 'Password Spray' | IF (count(failures) > 50) for single_target_account in 30m, ALERT 'Brute-Force'
  - question: Is there a statistically significant deviation from the normal rate of unique target accounts per source IP, or unique source IPs per target account?
    context: This question uses statistical analysis to detect anomalies in login patterns. By tracking the hourly count of unique targets per source (for spraying) and unique sources per target (for brute-force), we can establish a 30-day moving average and standard deviation. An alert is triggered if the current count exceeds a threshold (e.g., 3 standard deviations above average), indicating a significant departure from normal behavior.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Zeek conn.log
      - Domain Controllers
      - Cloud Service Provider Portals (e.g., Azure AD, AWS Console)
      - VPN Concentrators
      - Externally-facing Web Applications
    range: Last 90 days
    queries:
      - technology: Data Analytics Platform
        query: CALCULATE hourly_moving_average_and_stddev for (unique_targets_per_source) and (unique_sources_per_target) | SEARCH current_hour_data | WHERE current_count > (average + 3 * stddev)
  - question: Can a time-series anomaly detection model identify sudden spikes in password spraying or brute-force activity?
    context: This question proposes using a machine learning model like Isolation Forest to monitor login attempt rates over time. The model learns the normal baseline fluctuations for two key metrics: the rate of unique target accounts per source IP and the rate of unique source IPs per target account. It can then alert on sudden, anomalous spikes that deviate from the learned pattern, signaling the start of a spray or brute-force attack.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Zeek conn.log
      - Domain Controllers
      - Cloud Service Provider Portals (e.g., Azure AD, AWS Console)
      - VPN Concentrators
      - Externally-facing Web Applications
    range: Last 90 days
    queries:
      - technology: Machine Learning Model
        query: INPUT time_series_data (rate_of_unique_targets_per_source, rate_of_unique_sources_per_target) | RUN isolation_forest_model | IDENTIFY and ALERT on anomalous_spikes
  - question: Are account lockout events correlated with a preceding burst of failed logins from a single source IP for the same account?
    context: This question seeks to confirm that an account lockout was caused by a malicious brute-force attack rather than user error. A correlation rule can be created to automatically investigate the 15 minutes prior to any account lockout event (Event ID 4740). If a high number of failed logins (Event ID 4625) from a single IP address is found for that same account, the alert can be escalated with high confidence, providing the source IP for immediate blocking.
    answer_sources:
      - Windows Event ID 4740
      - Windows Event ID 4625
      - Domain Controllers
      - Active Directory Federation Services (ADFS) Servers
    range: Last 90 days
    queries:
      - technology: SIEM
        query: ON trigger (event_id = 4740) | SEARCH past 15m for event_id = 4625 AND same_username | GROUPBY source_ip | WHERE count(failures) > lockout_threshold | ESCALATE alert
  - question: Is there a widespread, statistically significant spike in the total number of account lockouts across the organization?
    context: This question aims to detect large-scale password spraying attacks that may cause many accounts to be locked out simultaneously. By calculating a historical baseline (e.g., the 99th percentile) for the hourly rate of account lockouts over a 30-day period, we can generate a high-severity alert whenever the current number of lockouts dramatically exceeds this normal threshold, indicating an event affecting the entire organization.
    answer_sources:
      - Windows Event ID 4740
      - Windows Event ID 4625
      - Domain Controllers
      - Active Directory Federation Services (ADFS) Servers
    range: Last 90 days
    queries:
      - technology: Data Analytics Platform
        query: CALCULATE historical_baseline (99th_percentile) for hourly_lockout_count over 30d | SEARCH current_hour_lockouts | WHERE current_count > baseline | ALERT
  - question: Does the observed number of account lockouts significantly exceed the forecasted number based on historical patterns?
    context: This question uses a time-series forecasting model like ARIMA to predict the expected number of account lockouts, accounting for normal business cycles and seasonality. An alert is generated only when the actual number of observed lockouts significantly exceeds the model's predicted upper confidence interval. This helps reduce false positives by distinguishing true anomalies from predictable, benign fluctuations in lockout events.
    answer_sources:
      - Windows Event ID 4740
      - Windows Event ID 4625
      - Domain Controllers
      - Active Directory Federation Services (ADFS) Servers
    range: Last 90 days
    queries:
      - technology: Machine Learning Model
        query: INPUT historical_lockout_data | RUN ARIMA_forecast_model to get predicted_count and confidence_interval | IF observed_count > upper_confidence_bound, ALERT
  - question: Is a single source IP making persistent but infrequent failed login attempts against multiple accounts over several hours or days?
    context: This question is designed to detect "low-and-slow" attacks, which are intentionally throttled to evade simple rate-based detection rules. A stateful rule can track a source IP's activity over a long window (e.g., 24 hours). An alert is triggered if the IP is seen making at least one failed login attempt per hour for many consecutive hours (e.g., 6+) while targeting several different accounts, indicating a patient, methodical attack.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - High-Value Asset Servers
      - Domain Controllers
      - Executive user workstations
      - Cloud administrative accounts
    range: Last 90 days
    queries:
      - technology: SIEM
        query: TRACK source_ip over 24h | IF source_ip has >=1 failed_login per hour for >=6 consecutive_hours AND targets >=3 distinct_accounts, ALERT
  - question: Is any source IP showing a persistently elevated 24-hour failed login count compared to its own historical baseline?
    context: This question uses a statistical Z-score to identify low-and-slow attacks by focusing on an IP's deviation from its *own* normal behavior. For each source IP, we aggregate its total failed logins over a 24-hour window and compare it to its long-term profile. An IP whose failure count is persistently elevated (e.g., a Z-score > 2.0 for 3 consecutive days) is flagged as suspicious, even if the absolute number of failures is low.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - High-Value Asset Servers
      - Domain Controllers
      - Executive user workstations
      - Cloud administrative accounts
    range: Last 90 days
    queries:
      - technology: Data Analytics Platform
        query: For each source_ip, CALCULATE 24h_failed_login_count | CALCULATE Z-score based on historical_profile of that IP | IF Z-score > 2.0 for 3 consecutive days, ALERT
  - question: Can we detect a transition in an IP's behavior from 'benign' to a 'low-and-slow attack' state based on the timing between login attempts?
    context: This question applies a Hidden Markov Model (HMM) to detect subtle changes in attacker behavior. The model analyzes the sequence of inter-arrival times (the time between consecutive failed logins) from a source IP. It can learn to distinguish the statistical distribution of random, benign failures from the more regular, machine-driven pattern of a low-and-slow attack, allowing it to alert when an IP transitions into the 'attack' state.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - High-Value Asset Servers
      - Domain Controllers
      - Executive user workstations
      - Cloud administrative accounts
    range: Last 90 days
    queries:
      - technology: Machine Learning Model
        query: For each source_ip, CREATE sequence of inter-arrival_times for failed_logins | INPUT sequence into trained_HMM | IF model transitions to 'low-and-slow-attack' state, ALERT