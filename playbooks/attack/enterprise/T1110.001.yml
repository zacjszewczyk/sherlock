name: T1110.001: Password Guessing
id: 6e9b8c7d-5a4f-4d3c-2b1a-0e9f8a7b6c5d
description: This playbook focuses on detecting adversary attempts to gain access to accounts via password guessing techniques like brute-force or password spraying. It involves analyzing authentication events for various indicators of compromise, such as a high volume of failed logins from a single source, the use of common usernames, patterns of one-to-many (spraying) or many-to-one (brute-force) attacks, statistically significant spikes in account lockouts, and persistent, low-and-slow attacks designed to evade simple detection thresholds. The goal is to identify and respond to unauthorized credential access attempts across various assets like Domain Controllers, web applications, and VPNs.
type: technique
related:
- TA0006: Credential Access
contributors:
- Zachary Szewczyk
- Ask Sage
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: none
questions:
- question: Are authentication events originating from IP addresses or using User-Agent strings known to be malicious?
  context: This question aims to identify brute-force or credential stuffing activity by cross-referencing source IP addresses from authentication logs and User-Agent strings from web logs against threat intelligence feeds. A match indicates a high probability that the login attempt is part of a known, ongoing attack campaign.
  answer_sources:
  - Windows Event ID 4625
  - Windows Event ID 4624
  - Zeek conn.log
  - Zeek http.log
  - Zeek ssh.log
  - Zeek rdp.log
  - Externally-facing Web Applications (e.g., OWA, SharePoint)
  - VPN Concentrators
  - Network Edge Firewalls
  - Cloud Service Provider Portals
  - Domain Controllers
  range: last 90 days
  queries:
  - pseudocode: JOIN source_ip from (auth_logs) with threat_intel_feed_ips; JOIN user_agent from (web_logs) with threat_intel_feed_user_agents; ALERT on match;
- question: Is any external source IP address generating an anomalously high ratio of failed to successful logins?
  context: This question seeks to detect brute-force attacks by identifying statistical outliers. By calculating the ratio of failed to successful logins for each external IP and comparing it to a baseline, we can flag IPs whose behavior significantly deviates from the norm, which is a strong indicator of a guessing attack.
  answer_sources:
  - Windows Event ID 4625
  - Windows Event ID 4624
  - Externally-facing Web Applications (e.g., OWA, SharePoint)
  - VPN Concentrators
  - Network Edge Firewalls
  - Cloud Service Provider Portals
  - Domain Controllers
  range: last 90 days
  queries:
  - pseudocode: For each source_ip, CALCULATE (COUNT(failed_logins) / COUNT(successful_logins)) over 1hr; ESTABLISH baseline ratio; ALERT if ratio > 95th percentile of baseline;
- question: Can we classify incoming login attempts as malicious in real-time using a machine learning model?
  context: This question explores a proactive approach using machine learning to score login attempts. By training a model on features like IP reputation, User-Agent rarity, time of day, and protocol, the system can identify sophisticated or previously unseen password guessing attacks that might evade simpler rule-based or statistical methods.
  answer_sources:
  - Windows Event ID 4625
  - Windows Event ID 4624
  - Zeek conn.log
  - Zeek http.log
  - Zeek ssh.log
  - Zeek rdp.log
  - Externally-facing Web Applications (e.g., OWA, SharePoint)
  - VPN Concentrators
  - Network Edge Firewalls
  - Cloud Service Provider Portals
  - Domain Controllers
  range: last 90 days
  queries:
  - pseudocode: SCORE login_attempt using trained_classifier_model (features: IP_rep, UA_rarity, time, protocol); ALERT if score > 0.9;
- question: Is a single source IP address attempting to log in with a large number of common or default usernames?
  context: This question is designed to detect dictionary attacks. Adversaries often cycle through a list of common usernames (like 'admin' or 'root'). This rule-based approach quickly identifies a single source IP trying many of these known weak usernames in a short period.
  answer_sources:
  - Windows Event ID 4625
  - Zeek conn.log
  - Zeek ssh.log
  - Domain Controllers
  - Authentication Servers (RADIUS, Kerberos)
  - Application Servers with default accounts
  - Network Appliances (routers, switches)
  range: last 90 days
  queries:
  - pseudocode: From failed_logins, IF source_ip targets > 5 usernames from (common_username_watchlist) within 15 mins, THEN ALERT;
- question: Is the diversity of usernames targeted by a single source IP statistically unusual?
  context: This question uses information theory (Shannon entropy) to quantify the randomness or diversity of usernames targeted by an IP. A high entropy value suggests the IP is not targeting specific, known users but is instead guessing from a large, diverse list, which is characteristic of a dictionary or brute-force attack.
  answer_sources:
  - Windows Event ID 4625
  - Domain Controllers
  - Authentication Servers (RADIUS, Kerberos)
  - Application Servers with default accounts
  - Network Appliances (routers, switches)
  range: last 90 days
  queries:
  - pseudocode: For each source_ip, CALCULATE Shannon_entropy of (target_usernames) from failed_logins over 30 mins; ESTABLISH baseline entropy; ALERT if entropy > 98th percentile of baseline;
- question: Can we identify clusters of authentication failures that indicate a dictionary attack?
  context: This question applies unsupervised machine learning to find patterns in authentication data. A density-based clustering algorithm like DBSCAN can group together failed login events, revealing clusters where one source IP is connected to many different usernames, effectively isolating dictionary attack activity without predefined rules.
  answer_sources:
  - Windows Event ID 4625
  - Zeek conn.log
  - Zeek ssh.log
  - Domain Controllers
  - Authentication Servers (RADIUS, Kerberos)
  - Application Servers with default accounts
  - Network Appliances (routers, switches)
  range: last 90 days
  queries:
  - pseudocode: RUN DBSCAN on (failed_logins) with features (source_ip, target_username); ALERT on clusters showing one_ip to many_usernames;
- question: Are there patterns of authentication failures indicative of password spraying or brute-forcing?
  context: This question uses specific, rule-based thresholds to distinguish between password spraying (one password against many accounts) and brute-forcing (many passwords against one account). By setting distinct thresholds for the number of accounts targeted by an IP versus the number of failures for a single account, we can specifically identify each type of attack.
  answer_sources:
  - Windows Event ID 4625
  - Windows Event ID 4624
  - Zeek conn.log
  - Domain Controllers
  - Cloud Service Provider Portals (e.g., Azure AD, AWS Console)
  - VPN Concentrators
  - Externally-facing Web Applications
  range: last 90 days
  queries:
  - pseudocode: SPRAY_RULE: IF source_ip fails > 20 accounts with < 3 attempts/acct in 1hr, ALERT; BRUTEFORCE_RULE: IF target_account fails > 50 times in 30 mins, ALERT;
- question: Are there statistically significant deviations from the historical average of unique accounts per source IP or unique sources per account?
  context: This question aims to detect password spraying and brute-force attacks by monitoring for statistical anomalies in login failure patterns. By tracking moving averages and standard deviations, we can automatically flag sudden spikes in either the number of accounts an IP targets (spraying) or the number of IPs targeting an account (distributed brute-force), which deviate from normal behavior.
  answer_sources:
  - Windows Event ID 4625
  - Domain Controllers
  - Cloud Service Provider Portals (e.g., Azure AD, AWS Console)
  - VPN Concentrators
  - Externally-facing Web Applications
  range: last 90 days
  queries:
  - pseudocode: For each IP/account, CALCULATE 30-day moving_avg and std_dev of failed_logins; ALERT if current_count > (moving_avg + 3 * std_dev);
- question: Can time-series anomaly detection identify the start of a password spray or brute-force attack?
  context: This question proposes using a machine learning model to learn the normal rhythm of login failures over time. By modeling the rate of unique targets per source and unique sources per target, an anomaly detection model can identify sudden changes in these patterns that signal the beginning of a coordinated attack, often earlier than threshold-based methods.
  answer_sources:
  - Windows Event ID 4625
  - Windows Event ID 4624
  - Zeek conn.log
  - Domain Controllers
  - Cloud Service Provider Portals (e.g., Azure AD, AWS Console)
  - VPN Concentrators
  - Externally-facing Web Applications
  range: last 90 days
  queries:
  - pseudocode: APPLY Isolation_Forest model to time-series of (unique_targets_per_source_ip) and (unique_sources_per_target_account); ALERT on detected anomalies;
- question: Is a recent account lockout event preceded by a high volume of failed logins from a single source IP?
  context: This question directly links a consequence (account lockout) to a probable cause (brute-force attack). By correlating the lockout event with recent failed logins for the same user, we can confirm that the lockout was likely malicious and not due to user error, and immediately identify the attacking IP address.
  answer_sources:
  - Windows Event ID 4740
  - Windows Event ID 4625
  - Domain Controllers
  - Active Directory Federation Services (ADFS) Servers
  range: last 90 days
  queries:
  - pseudocode: ON (account_lockout_event), QUERY failed_logins for same_user in last 15 mins; IF fail_count_from_one_ip > lockout_threshold, THEN ALERT;
- question: Is there a statistically unusual spike in the organization-wide account lockout rate?
  context: This question provides a high-level, organization-wide view to detect large-scale password spraying attacks. A sudden increase in the total number of account lockouts across the enterprise, when compared to a historical baseline, is a strong indicator of a widespread attack affecting many users simultaneously.
  answer_sources:
  - Windows Event ID 4740
  - Domain Controllers
  - Active Directory Federation Services (ADFS) Servers
  range: last 90 days
  queries:
  - pseudocode: CALCULATE hourly total_account_lockouts; ESTABLISH 30-day baseline; ALERT if current_hour_count > 99th percentile of baseline;
- question: Does the current number of account lockouts significantly exceed the number forecasted by a time-series model?
  context: This question uses a predictive model to distinguish between normal fluctuations in account lockouts (e.g., more on Monday mornings) and a true anomaly. By forecasting the expected number of lockouts, the system can alert only when the actual count is statistically improbable, reducing false positives from predictable patterns.
  answer_sources:
  - Windows Event ID 4740
  - Windows Event ID 4625
  - Domain Controllers
  - Active Directory Federation Services (ADFS) Servers
  range: last 90 days
  queries:
  - pseudocode: FORECAST expected_lockouts using ARIMA model; ALERT if actual_lockouts > forecasted_upper_confidence_interval;
- question: Is any single source IP persistently generating failed logins against multiple accounts over many hours?
  context: This question is designed to detect 'low-and-slow' password guessing attacks that are specifically crafted to evade simple rate-based thresholds. By tracking activity over a long window (24 hours), this stateful rule can identify attackers who make infrequent but regular attempts across multiple accounts.
  answer_sources:
  - Windows Event ID 4625
  - Zeek conn.log
  - High-Value Asset Servers
  - Domain Controllers
  - Executive user workstations
  - Cloud administrative accounts
  range: last 90 days
  queries:
  - pseudocode: TRACK source_ips over 24hr; IF ip has >= 1 failed_login/hr for >= 6 consecutive hours AND targets >= 3 unique accounts, THEN ALERT;
- question: Is a source IP's daily failed login count persistently and statistically elevated compared to its own history?
  context: This question focuses on detecting 'low-and-slow' attacks by profiling the long-term behavior of individual IP addresses. Instead of comparing an IP to all others, it compares the IP's current activity to its own historical baseline. A persistent, moderate increase (a Z-score > 2) over several days indicates a change in behavior consistent with a stealthy attack.
  answer_sources:
  - Windows Event ID 4625
  - High-Value Asset Servers
  - Domain Controllers
  - Executive user workstations
  - Cloud administrative accounts
  range: last 90 days
  queries:
  - pseudocode: For each source_ip, CALCULATE 24hr failed_login_count; COMPARE to historical daily count for that IP using Z-score; IF Z-score > 2 for 3 consecutive days, THEN ALERT;
- question: Can we detect a transition to a 'low-and-slow' attack state by modeling the time between failed login attempts?
  context: This question proposes a sophisticated machine learning approach to find 'low-and-slow' attacks. Benign failed logins are typically random and sporadic, while automated attacks, even slow ones, often have a more regular, machine-generated rhythm. A Hidden Markov Model can learn to distinguish between these two patterns based on the timing between events and detect a shift to the attack state.
  answer_sources:
  - Windows Event ID 4625
  - Zeek conn.log
  - High-Value Asset Servers
  - Domain Controllers
  - Executive user workstations
  - Cloud administrative accounts
  range: last 90 days
  queries:
  - pseudocode: MODEL inter-arrival_time of failed_logins from each source_ip using HMM; ALERT if model transitions to 'low-and-slow_attack' state;