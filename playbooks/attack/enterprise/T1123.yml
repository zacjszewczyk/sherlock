name: "T1123: Audio Capture"
id: "c8a49474-b513-4a87-9b48-356c91e3e8e9"
description: "This playbook helps determine if an adversary is capturing audio from endpoint devices. It looks for indicators such as the execution of known audio capture malware, the use of command-line utilities or APIs for recording, unusual process execution chains involving audio-capable applications, the creation of audio files by suspicious processes, and the subsequent exfiltration of captured data over the network."
type: "technique"
related:
  - "TA0009: Collection"
contributors:
  - "Zachary Szewczyk, Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: "1.0"
tags: "none"
questions:
  - question: "Are there any processes being created or antivirus alerts being generated that match known indicators of compromise for audio capture malware?"
    context: "This question seeks to identify known threats by matching process execution data (hashes, names) and antivirus alerts against curated threat intelligence feeds. A positive match provides a high-confidence indicator of a compromise involving specific spyware or audio capture tools."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Windows Defender Event ID 1116"
      - "Windows Defender Event ID 1117"
      - "User workstations, laptops, conference room systems, and executive endpoints."
    range: "last 90 days"
    queries:
      - "SEARCH process creation logs (WEF 4688, Sysmon 1) AND antivirus logs (Defender 1116, 1117) WHERE process hash OR process name OR threat name IN threat_intelligence_list_of_audio_malware."
  - question: "Has there been a statistically significant spike in antivirus alerts related to spyware or audio capture tools?"
    context: "This question uses a statistical approach to detect anomalies in the volume of security alerts. A sudden increase in alerts tagged as spyware, even if they are from different families, could signify a coordinated campaign that would be missed when looking at alerts individually. This helps identify broader trends."
    answer_sources:
      - "Windows Defender Event ID 1116"
      - "User workstations, laptops, conference room systems, and executive endpoints."
    range: "last 90 days"
    queries:
      - "CALCULATE 30-day moving average and standard deviation of daily count for antivirus alerts (Defender 1116) where threat_category = 'spyware' or 'audiocapture'. ALERT if daily count > (moving_average + 3 * std_dev)."
  - question: "Are there any newly created processes that a machine learning model identifies as having a high probability of being a malicious audio capture tool?"
    context: "This question leverages a predictive model to find unknown or novel threats that do not match existing signatures. By analyzing features like file path, parent process, and signature status, the model can assign a risk score, enabling analysts to proactively investigate suspicious processes that exhibit characteristics of malware."
    answer_sources:
      - "Sysmon Event ID 1"
      - "User workstations, laptops, conference room systems, and executive endpoints."
    range: "last 90 days"
    queries:
      - "APPLY logistic regression model to new process events (Sysmon 1). FEATURES = [file_path_entropy, signature_status, parent_process_name, cmd_line_length]. ALERT on processes with high risk_score."
  - question: "Have any command-line arguments or PowerShell scripts been executed containing keywords, utilities, or API calls associated with audio recording?"
    context: "This question hunts for the specific commands and code an adversary might use to initiate audio capture. Searching for keywords like 'ffmpeg', 'mciSendString', or 'System.Media.SoundPlayer' in command-line and script logs provides direct evidence of an attempt to use system resources for recording."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "Windows PowerShell Event ID 4104"
      - "User workstations, Developer machines, Administrator jump boxes"
    range: "last 90 days"
    queries:
      - "SEARCH command-line logs (WEF 4688, Sysmon 1) AND script block logs (PS 4104) FOR REGEX matching keywords like 'ffmpeg', 'sox', 'mciSendString', 'waveInOpen', 'System.Media.SoundPlayer'."
  - question: "Are there any PowerShell scripts with unusually high entropy, potentially indicating obfuscation used to hide audio capture functionality?"
    context: "This question aims to uncover malicious PowerShell scripts that have been intentionally obscured. Adversaries use obfuscation to hide their code's true purpose from basic keyword searches. High information entropy is a strong mathematical indicator of obfuscated or encrypted content, warranting further analysis."
    answer_sources:
      - "Windows PowerShell Event ID 4104"
      - "User workstations, Developer machines, Administrator jump boxes"
    range: "last 90 days"
    queries:
      - "FOR EACH PowerShell script block (PS 4104), CALCULATE entropy of script content. ESTABLISH baseline. ALERT if entropy_score is in top 5th percentile of baseline."
  - question: "Have any command-line executions been observed that are statistically rare and anomalous compared to a baseline of legitimate activity?"
    context: "This question uses a machine learning model (LSTM autoencoder) to learn the patterns of normal command-line usage and detect deviations. This can uncover novel or unusual ways of invoking tools, including audio capture utilities, that would not match pre-defined rules or keywords."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "User workstations, Developer machines, Administrator jump boxes"
    range: "last 90 days"
    queries:
      - "APPLY LSTM autoencoder model to command-line argument sequences. ALERT on any execution with a high reconstruction_error, indicating a statistical anomaly."
  - question: "Has a legitimate audio-capable application been launched by an unusual or unauthorized parent process?"
    context: "This question focuses on detecting 'living-off-the-land' techniques, where adversaries abuse legitimate software. By checking the parent process of audio-capable applications (e.g., Teams.exe), analysts can distinguish normal user-initiated activity (parent is explorer.exe) from suspicious activity (parent is cmd.exe, wscript.exe, or an unsigned binary)."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "User workstations, Executive laptops, Endpoints with collaboration software installed"
    range: "last 90 days"
    queries:
      - "SEARCH process creation logs (WEF 4688, Sysmon 1) WHERE child_process is known_audio_app AND parent_process is NOT in allowlist (e.g., explorer.exe) OR parent_is_unsigned OR parent_path is in temp_directory."
  - question: "Have any rare or statistically infrequent parent-child process relationships involving audio-capable applications been observed?"
    context: "This question automates the detection of anomalous execution chains by statistically analyzing all parent-child process relationships. Instead of relying on a manual allowlist, this method identifies any relationship involving an audio-capable application that is rare compared to a historical baseline, highlighting potentially malicious activity."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "User workstations, Executive laptops, Endpoints with collaboration software installed"
    range: "last 90 days"
    queries:
      - "BUILD frequency table of all parent-child process pairs over 30 days. FOR new executions where child is known_audio_app, ALERT if the parent-child pair frequency is in the bottom 1st percentile."
  - question: "Using graph analysis, are there any unusual process execution chains leading to the launch of audio-capable applications?"
    context: "This question applies advanced graph-based anomaly detection to model process ancestry. This can reveal sophisticated attack patterns, such as multi-stage execution or process injection, that lead to the launch of an audio-capable application. It helps identify malicious processes based on their unusual position or connections within the larger execution graph."
    answer_sources:
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "User workstations, Executive laptops, Endpoints with collaboration software installed"
    range: "last 90 days"
    queries:
      - "MODEL process ancestry as a graph. APPLY graph anomaly algorithm (e.g., PageRank). INVESTIGATE processes with anomalous scores that are ancestors of audio-capable applications."
  - question: "Have any non-media applications created files with audio extensions like .wav, .mp3, or .m4a?"
    context: "This question directly hunts for the output of audio capture activity. While it is normal for a media application to create an audio file, it is highly suspicious for a process like a web browser, office application, or command shell to do so. This check provides strong evidence that a process is saving recorded audio."
    answer_sources:
      - "Sysmon Event ID 11"
      - "Windows Event ID 4688"
      - "Sysmon Event ID 1"
      - "User home directories, Shared network drives, Temporary file system locations (e.g., C:\\Users\\<user>\\AppData\\Local\\Temp)"
    range: "last 90 days"
    queries:
      - "SEARCH file creation events (Sysmon 11) WHERE file_extension IN ['.wav', '.mp3', '.m4a'] AND creating_process_name NOT IN legitimate_media_app_allowlist. CORRELATE with process creation logs (Sysmon 1) for context."
  - question: "Is any process creating files periodically, in a pattern consistent with scheduled or continuous audio recording?"
    context: "This question seeks to identify automated recording behavior. Malware is often configured to capture audio in segments, resulting in files being created at regular intervals (e.g., every 5 minutes). Analyzing the timestamps between file creation events for a given process can reveal this non-human, periodic pattern."
    answer_sources:
      - "Sysmon Event ID 11"
      - "User home directories, Shared network drives, Temporary file system locations (e.g., C:\\Users\\<user>\\AppData\\Local\\Temp)"
    range: "last 90 days"
    queries:
      - "FOR EACH process, analyze timestamps of its file creation events (Sysmon 11). CALCULATE inter-arrival time between events. ALERT if standard deviation of inter-arrival times is low, indicating periodic behavior."
  - question: "Has any process exhibited an anomalous pattern of file write activity compared to its historical baseline and its peers?"
    context: "This question uses time-series modeling to detect changes in a process's file writing behavior. A sudden, sustained increase in the frequency or volume of file writes could indicate that a dormant or benign process has started a malicious activity like recording audio, even if the file names or types are not obviously suspicious."
    answer_sources:
      - "Sysmon Event ID 11"
      - "User home directories, Shared network drives, Temporary file system locations (e.g., C:\\Users\\<user>\\AppData\\Local\\Temp)"
    range: "last 90 days"
    queries:
      - "APPLY time-series anomaly model (e.g., Prophet) to the volume and frequency of file writes (Sysmon 11) on a per-process, per-host basis. ALERT on anomalous patterns."
  - question: "Has a process created an audio file and then immediately attempted to exfiltrate it to a known malicious destination?"
    context: "This question provides a high-fidelity method for detecting the exfiltration of captured audio. By correlating file creation events with subsequent network connections made by the same process within a short time window, we can directly link the creation of a suspicious file to an attempt to send it to a destination on a threat intelligence blocklist."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek files.log"
      - "Sysmon Event ID 3"
      - "Sysmon Event ID 1"
      - "Sysmon Event ID 11"
      - "Network egress points, DNS servers, Proxy servers, User workstations"
    range: "last 90 days"
    queries:
      - "JOIN file creation events (Sysmon 11) with network connection events (Sysmon 3) on ProcessGUID. ALERT if file_extension is audio-related AND network destination is on blocklist AND time_difference < 5 minutes."
  - question: "Have there been any unusually large data transfers to rare network destinations?"
    context: "This question hunts for data exfiltration by looking for statistical outliers in network traffic. Sending large audio files can result in an anomalously high volume of outbound data. Flagging connections that exceed a baseline threshold and are destined for an IP or domain rarely seen in the environment helps to identify potential exfiltration channels."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Network egress points, DNS servers, Proxy servers, User workstations"
    range: "last 90 days"
    queries:
      - "CALCULATE 99th percentile for outbound bytes per host over 30 days from Zeek conn.log. ALERT on connections exceeding this threshold, especially if destination_ip or destination_domain is rare (seen by <1% of hosts)."
  - question: "Using machine learning, have any network connections been identified as anomalous, especially if they originate from processes that have recently created files?"
    context: "This question employs an unsupervised machine learning model to detect novel exfiltration techniques by analyzing multiple network features at once (e.g., duration, bytes, port, JA3 hash). By flagging connections that are statistically anomalous and then prioritizing those that originate from processes known to have recently created files, analysts can more effectively pinpoint suspicious exfiltration activity."
    answer_sources:
      - "Zeek conn.log"
      - "Sysmon Event ID 11"
      - "Sysmon Event ID 3"
      - "Network egress points, DNS servers, Proxy servers, User workstations"
    range: "last 90 days"
    queries:
      - "APPLY Isolation Forest model to network connection logs (Zeek conn.log) using features like duration, bytes, port, protocol, JA3. PRIORITIZE investigation of anomalies from processes with recent file creation activity (Sysmon 11)."