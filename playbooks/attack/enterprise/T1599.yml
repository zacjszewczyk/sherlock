name: 'T1599: Network Boundary Bridging'
id: 'a8c1b3f2-d4e9-4a01-b8f6-9325c7e4d8a1'
description: This playbook investigates whether an adversary is bypassing network defenses through unauthorized network boundary bridging. This technique can be observed through several indicators, including: connections to a network boundary device's management interface from a malicious source; the creation or modification of a network bridge on a multi-homed host using command-line utilities; a multi-homed host receiving a connection on one interface and initiating a related outbound connection on another; direct violations of a defined network segmentation policy; and policy violations that occur shortly after a successful, but anomalous, administrative login to a network boundary device.
type: technique
related:
  - 'TA0005: Defense Evasion'
contributors:
  - Zachary Szewczyk
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: none
questions:
  - question: "Is a network boundary device's management interface being accessed by a known malicious IP or targeted by a known vulnerability?"
    context: This question aims to detect initial access attempts to critical network infrastructure. By monitoring connections to management ports (like SSH, Telnet, HTTPS) on devices such as firewalls and routers, we can identify when a known malicious actor (based on threat intelligence) is attempting to connect. It also checks for known exploit signatures targeting these devices, providing an early warning of a potential compromise.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Network Device Syslog
      - Perimeter firewalls
      - VPN concentrators
      - Internal network segmentation gateways (e.g., routers, layer-3 switches)
    range: last 90 days
    queries:
      - "Pseudocode: `SEARCH Zeek conn.log WHERE dest_ip IN (boundary_devices) AND dest_port IN (mgmt_ports) AND source_ip IN (threat_feed) UNION SEARCH Zeek notice.log WHERE dest_ip IN (boundary_devices)`"
  - question: "Has a network boundary device's management interface been successfully accessed from a geographically or network-topologically rare source?"
    context: This question helps identify suspicious logins that don't originate from known malicious IPs. Adversaries may use novel infrastructure to evade threat feeds. By baselining the typical geographic (country) and network (ASN) origins of administrative access, we can flag successful connections from highly unusual locations as potential intrusions.
    answer_sources:
      - Zeek conn.log
      - Network Device Syslog
      - Perimeter firewalls
      - VPN concentrators
      - Internal network segmentation gateways (e.g., routers, layer-3 switches)
    range: last 90 days
    queries:
      - "Pseudocode: `BASELINE ASN, Country for successful connections to mgmt ports over 90 days. ALERT on new connection WHERE (ASN, Country) is new or in bottom 5% frequency.`"
  - question: "Is there an anomalous volume of connection attempts to a network boundary device's management interface, suggesting a brute-force or scanning attack?"
    context: This question seeks to detect automated attacks like password spraying or vulnerability scanning. By modeling the normal hourly connection rate to management interfaces, we can automatically detect significant spikes in activity that deviate from the established pattern. An alert on such a deviation indicates a potential brute-force or reconnaissance attempt.
    answer_sources:
      - Zeek conn.log
      - Network Device Syslog
      - Perimeter firewalls
      - VPN concentrators
      - Internal network segmentation gateways (e.g., routers, layer-3 switches)
    range: last 90 days
    queries:
      - "Pseudocode: `MODEL hourly connection attempts to mgmt interfaces. ALERT if current hour's count > 95% confidence interval of forecast.`"
  - question: "Has a user attempted to create or modify a network bridge on a multi-homed host using standard Windows command-line tools?"
    context: This question looks for the direct execution of commands used to create a network bridge. Adversaries can use built-in tools like `netsh.exe` or PowerShell cmdlets (`New-NetAdapter`) on a compromised, multi-homed machine to bridge two separate network segments (e.g., a DMZ and the internal corporate network), bypassing firewall rules. Detecting the specific command syntax for these actions is a high-fidelity indicator of this technique.
    answer_sources:
      - Windows Event ID 4688
      - Windows PowerShell Event ID 4104
      - Multi-homed servers (e.g., web servers in a DMZ with an internal management interface)
      - Developer workstations with multiple network adapters (e.g., physical and virtual)
    range: last 90 days
    queries:
      - "Pseudocode: `SEARCH EventID 4688 WHERE ProcessName is 'netsh.exe' AND CommandLine contains 'bridge' and 'add'. UNION SEARCH EventID 4104 WHERE ScriptBlockText contains 'New-NetAdapter' and bridging functions.`"
  - question: "Has a rare or unusual command-line argument been used with networking utilities on a multi-homed host?"
    context: This question aims to find suspicious command executions that don't match specific, known-bad patterns. By analyzing the frequency of all arguments used with `netsh.exe` and PowerShell networking cmdlets, we can identify arguments that are statistically rare across the environment. An adversary's custom or obscure command usage will stand out, flagging it for investigation even if the command itself isn't explicitly malicious.
    answer_sources:
      - Windows Event ID 4688
      - Windows PowerShell Event ID 4104
      - Multi-homed servers
      - Developer workstations
    range: last 90 days
    queries:
      - "Pseudocode: `BASELINE TF-IDF for all netsh.exe/PowerShell networking arguments. ALERT on new command execution with arguments in top 1% TF-IDF score.`"
  - question: "Can a machine learning model classify a recently executed networking command on a multi-homed host as malicious?"
    context: This question uses a supervised machine learning approach to proactively identify malicious commands. By training a model on a labeled dataset of benign and malicious command-line strings, the system can learn the nuanced characteristics of each. It can then classify new, unseen commands in real-time, providing a probabilistic assessment of their maliciousness and alerting when confidence is high.
    answer_sources:
      - Windows Event ID 4688
      - Windows PowerShell Event ID 4104
      - Multi-homed servers
      - Developer workstations
    range: last 90 days
    queries:
      - "Pseudocode: `TRAIN classification model on labeled command lines. DEPLOY model to score new commands. ALERT when maliciousness score > 0.90.`"
  - question: "Is a multi-homed host forwarding traffic between different network segments in a way that is not explicitly allowlisted?"
    context: This question seeks to identify unauthorized traffic relaying. A compromised multi-homed host can act as a covert pivot point. By correlating inbound connections on one interface with outbound connections on another interface within a very short time frame, we can detect this forwarding behavior. If the traffic pattern (e.g., source/destination segments, ports) isn't part of a known, legitimate function like a proxy, it strongly indicates a malicious bridge.
    answer_sources:
      - Zeek conn.log
      - Network taps monitoring traffic to/from DMZ segments
      - Core switch SPAN ports
      - Multi-homed servers
    range: last 90 days
    queries:
      - "Pseudocode: `FOR each inbound connection to multi-homed host, SEARCH for outbound connection from same host within 2s. ALERT if dest_subnet != source_subnet AND (in_port, out_port, proto) NOT in allowlist.`"
  - question: "Is a multi-homed host forwarding traffic with an anomalous data volume ratio, suggesting unusual data transfer?"
    context: This question looks for anomalies within otherwise legitimate-looking relay traffic. For a known proxy or relay, the ratio of inbound to outbound data is often predictable. By baselining this ratio for each interface pair and protocol, we can detect significant deviations. An unusual ratio (e.g., a large exfiltration after a small inbound command) can indicate that a legitimate-looking connection is being used for a malicious purpose.
    answer_sources:
      - Zeek conn.log
      - Network taps
      - Core switch SPAN ports
      - Multi-homed servers
    range: last 90 days
    queries:
      - "Pseudocode: `BASELINE ratio of orig_bytes/resp_bytes for relay traffic on multi-homed hosts. ALERT if new session's ratio is > 3 std deviations from mean.`"
  - question: "Does a connection on a multi-homed host appear as a statistical outlier when compared to established clusters of normal behavior?"
    context: This question uses unsupervised machine learning to find novel or unclassifiable traffic. By grouping all connections on a multi-homed host into clusters based on features like port, protocol, and data volume, we can define what 'normal' looks like. Any connection that does not fit into any of these normal clusters is flagged as an outlier, warranting investigation as it represents a deviation from all known, established traffic patterns.
    answer_sources:
      - Zeek conn.log
      - Network taps
      - Core switch SPAN ports
      - Multi-homed servers
    range: last 90 days
    queries:
      - "Pseudocode: `CLUSTER connection data from multi-homed hosts using DBSCAN. ALERT on any connection classified as noise/outlier.`"
  - question: "Has a network connection occurred that directly violates the defined network segmentation policy?"
    context: This is a fundamental security question. It checks for direct violations of the 'zero trust' or 'defense-in-depth' security posture. By codifying the network architecture into zones (e.g., 'Workstations', 'Databases') and creating an explicit matrix of allowed communication paths, any connection that falls outside this matrix is an immediate and high-fidelity indicator of a policy breach, misconfiguration, or malicious activity.
    answer_sources:
      - Zeek conn.log
      - Network segmentation boundaries (e.g., between PCI and corporate LANs)
      - DMZ perimeter
      - Internet egress/ingress points
    range: last 90 days
    queries:
      - "Pseudocode: `DEFINE zone matrix of allowed (src_zone, dst_zone, dst_port, proto). ENRICH Zeek conn.log with zones. ALERT if connection not in 'allow' matrix.`"
  - question: "Is a host using an allowed communication path to connect to an anomalously large number of distinct destinations, suggesting internal scanning?"
    context: This question seeks to detect the misuse of an approved firewall rule. An adversary who has compromised a host in one zone may use an allowed rule (e.g., workstation access to a web server) to scan the destination zone for other vulnerable hosts. By baselining the normal 'fan-out' behavior (how many unique destinations a single source typically talks to), we can detect when a host begins behaving like a scanner.
    answer_sources:
      - Zeek conn.log
      - Network segmentation boundaries
      - DMZ perimeter
      - Internet egress/ingress points
    range: last 90 days
    queries:
      - "Pseudocode: `FOR each allowed path, BASELINE hourly unique destinations per source. ALERT if a source exceeds the 99th percentile.`"
  - question: "Has there been an anomalous drop in the number of denied connections at a critical network boundary, suggesting a firewall has been disabled or misconfigured?"
    context: This question looks for an 'absence of expected badness.' Firewalls at critical boundaries constantly log connection denials, creating a predictable volume of noise. A sudden, sustained drop in these denials is highly anomalous and can indicate that the firewall policy was removed, the device was disabled, or traffic is being rerouted around it, all of which are critical security events.
    answer_sources:
      - Zeek conn.log
      - Network segmentation boundaries
      - DMZ perimeter
      - Internet egress/ingress points
    range: last 90 days
    queries:
      - "Pseudocode: `MODEL hourly volume of denied connections at boundary. ALERT if observed denials drop below the forecasted lower confidence bound.`"
  - question: "Following a successful administrative login from an unapproved IP address, did a network policy violation occur on the same device?"
    context: This question correlates two suspicious events to increase detection confidence. An administrative login to a network device from an unauthorized location is suspicious. A network policy violation is also suspicious. When the former is immediately followed by the latter on the same device, it creates a compelling narrative: an attacker gained access and then immediately used that access to bypass security controls. Chaining these events provides critical context and elevates the alert's priority.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4624
      - Network Device Syslog
      - Firewall management interfaces
      - Router and switch management interfaces
      - Configuration management servers
      - Network taps at segmentation boundaries
    range: last 90 days
    queries:
      - "Pseudocode: `ALERT on successful login to network device from source IP not in admin_list. IF alert fires, create high-severity alert for any policy violation on same device in next 60 mins.`"
  - question: "Did a high-risk administrative login (based on rare geolocation, ASN, or time) precede a network policy violation?"
    context: This question uses a risk-based approach to flag suspicious administrative sessions. Instead of a binary allow/deny list, it scores each login based on how much its attributes (source country/network, time of day) deviate from the norm. A login with a high risk score triggers a state of heightened scrutiny, automatically cross-referencing traffic logs for any subsequent policy violations, allowing for proactive threat hunting based on probabilistic risk.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4624
      - Network Device Syslog
      - Firewall management interfaces
      - Router and switch management interfaces
      - Configuration management servers
      - Network taps at segmentation boundaries
    range: last 90 days
    queries:
      - "Pseudocode: `SCORE admin logins based on rarity of GeoIP, ASN, time. IF score > 95th percentile, flag session and query for policy violations on that device for the next hour.`"
  - question: "Did an administrative login session, flagged as anomalous by an autoencoder model, precede a network policy violation?"
    context: This question leverages-deep learning to identify subtle anomalies in administrative behavior. An autoencoder is trained to 'reconstruct' only legitimate login sessions. When presented with a session whose characteristics are even slightly novel or abnormal, it will fail to reconstruct it accurately, resulting in a high 'reconstruction error'. This error serves as a powerful, model-driven anomaly flag, triggering an immediate investigation into the device's traffic for any signs of compromise.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 4624
      - Network Device Syslog
      - Firewall management interfaces
      - Router and switch management interfaces
      - Configuration management servers
      - Network taps at segmentation boundaries
    range: last 90 days
    queries:
      - "Pseudocode: `TRAIN autoencoder on legitimate admin session features. FLAG new sessions with high reconstruction error. TRIGGER investigation on flagged device's traffic.`"