name: T1593.001: Social Media
id: 5a8a1e2f-3b9c-4d8e-8f0a-1b2c3d4e5f6a
description: This playbook helps determine if an adversary is conducting reconnaissance using social media. It focuses on identifying unusual network connections from internal hosts to social media platforms, especially after contact with known malicious infrastructure. It also looks for signs of automated data scraping, such as script interpreters making web requests, high-entropy command lines, or robotic request patterns (high volume, low timing variance). Finally, it flags highly anomalous behavior, like server-class assets initiating any connection to social media sites, which deviates from their expected function.
type: technique
related:
- TA0043: Reconnaissance
contributors:
- Zachary Szewczyk
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Has an internal host connected to a social media domain shortly after communicating with a known malicious IP?
  context: This question aims to detect 'staging' behavior. Adversaries may use compromised hosts to perform reconnaissance. A connection to a malicious IP (e.g., C2 server) followed by connections to social media sites could indicate the compromised host is being tasked to gather information on employees or the organization from public sources.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Network egress points (e.g., perimeter firewalls, web proxies) and internal DNS resolvers where traffic is monitored.
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // Monitor conn.log for destination IPs in threat_intel_feed
      // IF match THEN add source IP to 'watchlist' with 60min TTL
      // MONITOR conn.log for source IPs on 'watchlist'
      // IF source_ip.on_watchlist AND destination_domain.in_social_media_list THEN ALERT
- question: Following a connection to a malicious IP, did a host connect to a social media domain from an uncharacteristic ASN or country?
  context: This question seeks to identify anomalous network routing following a potential compromise. Legitimate user traffic to social media typically originates from common, established CDNs and geographic locations. A connection to a social media domain via a rare or first-seen ASN/country for that specific host, especially after contact with a malicious IP, suggests traffic may be proxied or tunneled, which is a common adversary technique.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Network egress points (e.g., perimeter firewalls, web proxies) and internal DNS resolvers where traffic is monitored.
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // FOR each host, create baseline of destination ASNs/countries over 30 days
      // MONITOR for host connection to malicious_ip
      // IF malicious_ip_connection THEN
      //   MONITOR subsequent connections from that host
      //   IF connection_to_social_media AND destination_asn NOT IN host_baseline THEN ALERT
- question: Can network graph analysis predict which hosts, after touching malicious infrastructure, are likely to connect to social media domains?
  context: This question uses predictive analysis to proactively identify hosts at risk of being used for social media reconnaissance. By modeling network connections as a graph, we can measure the 'proximity' of internal hosts to known malicious nodes. A host that is closely linked to malicious infrastructure and is predicted to connect to social media is a high-priority candidate for investigation, even before the connection occurs.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Network egress points (e.g., perimeter firewalls, web proxies) and internal DNS resolvers where traffic is monitored.
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // CREATE network graph: nodes={hosts, ips, domains}, edges={connections, dns_lookups}
      // APPLY link prediction model to graph
      // IF model predicts edge between 'tainted_host' and 'social_media_domain' with high_score THEN ALERT
- question: Is a script interpreter process being used to make programmatic requests to social media sites?
  context: This question looks for direct evidence of automated scraping. Humans use web browsers to access social media. Adversaries often use scripts (Python, PowerShell, cURL) for automated information gathering. Detecting script interpreters executing with social media URLs in their command line, or network requests to social media sites with User-Agents of common HTTP libraries, is a strong indicator of non-human activity.
  answer_sources:
  - Windows Event ID 4688
  - Zeek http.log
  - Zeek ssl.log
  - Endpoint devices (workstations, servers) and network inspection points (e.g., web proxies, NG-firewalls with SSL/TLS inspection).
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // HOST_RULE:
      //   ON EventID 4688
      //   IF ProcessName IN (powershell.exe, python.exe, ...) AND CommandLine contains social_media_domain THEN ALERT
      // NETWORK_RULE:
      //   ON http.log or ssl.log
      //   IF destination_domain IN social_media_list AND (user_agent IN known_script_uas OR ja3 IN known_script_ja3s) THEN ALERT
- question: Did a script interpreter execute with an unusually complex or obfuscated command line that includes a social media domain?
  context: This question aims to detect obfuscated commands used for reconnaissance. Adversaries may obfuscate command-line arguments to evade simple keyword-based detections. High Shannon entropy in a command line suggests randomness or encoding (like Base64), which is not typical for user-generated commands. When this high entropy is seen in a command that also references a social media domain, it raises the suspicion of malicious automation.
  answer_sources:
  - Windows Event ID 4688
  - Zeek http.log
  - Zeek ssl.log
  - Endpoint devices (workstations, servers) and network inspection points (e.g., web proxies, NG-firewalls with SSL/TLS inspection).
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // FOR each script interpreter process event (4688)
      //   CALCULATE entropy of CommandLine
      //   GET baseline entropy for that ProcessName
      //   IF current_entropy > 98th_percentile_baseline AND CommandLine contains social_media_domain THEN ALERT
- question: Can a machine learning model classify host and network sessions to social media as suspicious scraping activity?
  context: This question leverages machine learning for a more nuanced detection than single-indicator rules. By combining multiple features from both the host (process name, command-line properties) and the network (User-Agent, JA3 hash), a model can learn the subtle patterns that differentiate benign user browsing, legitimate automation (e.g., social media management tools), and malicious reconnaissance. This provides a more robust and context-aware classification of activity.
  answer_sources:
  - Windows Event ID 4688
  - Zeek http.log
  - Zeek ssl.log
  - Endpoint devices (workstations, servers) and network inspection points (e.g., web proxies, NG-firewalls with SSL/TLS inspection).
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // EXTRACT features for sessions: process_name, cmd_length, cmd_entropy, parent_process, domain, user_agent, ja3
      // FEED features into trained classification model
      // IF model.predict(session_features) == 'suspicious_reconnaissance' THEN ALERT
- question: Has a single source IP requested an abnormally high number of unique URIs from a social media domain in a short time?
  context: This question aims to detect automated enumeration of profiles or pages. A human user typically browses a limited number of pages in a session. A script, however, can rapidly iterate through many different URIs (e.g., user profiles '.../user/1', '.../user/2', etc.). A high count of unique URIs from one source IP to one social media host within a small time window is a strong signal of automated scraping.
  answer_sources:
  - Zeek http.log
  - Zeek conn.log
  - Network flow and HTTP/S inspection points, typically at the network perimeter or in a cloud access security broker (CASB).
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // FOR each source_ip
      //   COUNT unique URIs requested from social_media_host in 5-min window
      //   IF unique_uri_count > 75 THEN ALERT
- question: Is a host accessing a large number of unique social media pages with unnaturally consistent timing between requests?
  context: This question identifies robotic behavior by analyzing the timing and breadth of requests. Human browsing has variable 'think time' between clicks, resulting in a high standard deviation in request timing. Automated scripts often have minimal, consistent delays between requests, leading to a very low standard deviation. Combining this robotic timing pattern with a high volume of unique URI requests provides strong evidence of automated scraping.
  answer_sources:
  - Zeek http.log
  - Zeek conn.log
  - Network flow and HTTP/S inspection points, typically at the network perimeter or in a cloud access security broker (CASB).
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // GROUP http logs by session (src_ip, dest_host, 30min_timeout)
      // FOR each session to a social_media_host
      //   CALCULATE std_dev of time_deltas between requests
      //   CALCULATE count of unique URIs
      //   IF std_dev < 5th_percentile AND unique_uri_count > 98th_percentile THEN ALERT
- question: Has a host exhibited a statistically significant anomaly in its rate of requests to social media domains compared to its own baseline?
  context: This question uses time-series anomaly detection to find deviations from an individual host's normal behavior. Every host has a unique browsing pattern (e.g., more active during work hours). By modeling this pattern and removing predictable trends and seasonality, we can isolate the irregular 'residual' activity. A sudden, sustained spike in this residual component when accessing social media indicates a departure from normal behavior that could be caused by a malicious script.
  answer_sources:
  - Zeek http.log
  - Zeek conn.log
  - Network flow and HTTP/S inspection points, typically at the network perimeter or in a cloud access security broker (CASB).
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // FOR each host, create time_series of request_rate to social_media_domains
      // APPLY seasonal decomposition to get 'residual' series
      // APPLY anomaly detection (e.g., Isolation Forest) to residual series
      // IF significant_anomaly_detected THEN ALERT
- question: Has a server-class asset initiated any connection to a known social media domain?
  context: This question is based on a high-confidence policy violation. Servers (like domain controllers, databases) have specific, predictable network traffic patterns and should never need to connect to social media websites. Any such connection is a strong deviation from expected behavior and a significant indicator of compromise, misuse, or misconfiguration. This is a simple but powerful rule.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Log sources monitoring traffic from dedicated server VLANs, data center subnets, and critical infrastructure zones. This also includes central DNS resolver logs that can attribute queries to server source IPs.
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // MAINTAIN server_ip_list and social_media_domain_list
      // ON dns.log or conn.log
      // IF source_ip IN server_ip_list AND destination_domain IN social_media_domain_list THEN HIGH-SEVERITY ALERT
- question: Has a server connected to a social media domain that it has never connected to before?
  context: This question uses baselining to detect zero-frequency events, which are highly reliable indicators. By maintaining a historical baseline of every destination a server has ever connected to, we can immediately flag any connection to a new, never-before-seen domain. When that new domain is also identified as a social media site, it constitutes a high-confidence alert for anomalous and unauthorized activity.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Log sources monitoring traffic from dedicated server VLANs, data center subnets, and critical infrastructure zones. This also includes central DNS resolver logs that can attribute queries to server source IPs.
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // FOR each server, maintain 30-day baseline of destination_domains
      // ON new connection from server
      //   IF destination_domain NOT IN server_baseline AND destination_domain IN social_media_list THEN ALERT
- question: Has a server's network behavior profile changed in a way that suggests it has started connecting to social media?
  context: This question uses unsupervised machine learning to detect behavioral drift in servers. Servers can be grouped into clusters based on their network characteristics (ports, protocols, data volume). A server that is compromised and begins connecting to social media sites will exhibit a new behavior profile (e.g., new destination ports like 443, new ASNs, higher outbound data). This change will cause it to be flagged as an outlier (noise) or shift to a different cluster, both of which can trigger an alert for investigation.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Log sources monitoring traffic from dedicated server VLANs, data center subnets, and critical infrastructure zones. This also includes central DNS resolver logs that can attribute queries to server source IPs.
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: |
      // PERIODICALLY (weekly):
      //   FOR each server, create profile vector (dest_ports, dest_asns, protocols, etc.)
      //   RUN clustering (DBSCAN) on all server profile vectors
      //   IF server is flagged as noise_point OR server shifts_cluster THEN ALERT