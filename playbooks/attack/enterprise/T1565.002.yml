name: 'T1565.002: Transmitted Data Manipulation'
id: 'a7b1c1d8-e9f0-4a1b-8c2d-3e4f5a6b7c8d'
description: |
  This playbook helps investigate whether an adversary has manipulated data in transit to compromise its integrity. It focuses on detecting anomalous network connections from critical assets to malicious or unusual destinations, identifying signs of SSL/TLS interception through certificate and protocol analysis, uncovering process injection into network-aware applications, monitoring for significant deviations in the size of routine data transfers, and spotting spikes in application-level data integrity errors like checksum failures or transaction rollbacks.
type: 'technique'
related:
  - 'TA0040: Impact'
contributors:
  - 'Zachary Szewczyk'
  - 'Ask Sage'
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: 'none'
questions:
  - question: "Has a critical internal asset established a network connection with a known malicious proxy, anonymizer, or Man-in-the-Middle (MitM) command-and-control (C2) server?"
    context: |
      This question aims to detect direct communication from high-value internal systems (like payment processors or database servers) to known malicious infrastructure. Such connections are highly anomalous and could indicate that data is being exfiltrated or manipulated by an adversary intercepting the traffic. The symbolic approach provides a high-confidence alert by matching outbound traffic against a curated list of threat intelligence.
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek dns.log'
      - 'Internet gateway'
      - 'Core network switches monitoring traffic from critical assets'
      - 'DNS servers'
      - 'DMZ firewalls'
    range: 'last 90 days'
    queries:
      - 'Pseudocode: JOIN Zeek conn.log destination IPs WITH threat intelligence feed of malicious proxy/MitM IPs WHERE source IP is in critical asset range. ALERT on match.'
  - question: "Has a critical internal asset initiated a network connection to a statistically rare external destination?"
    context: |
      This question helps identify suspicious communications that may not involve known malicious IPs. By baselining normal communication patterns for critical assets, we can flag connections to new or infrequent destinations. This could uncover previously unknown C2 servers or data staging points used in a data manipulation attack.
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek dns.log'
      - 'Internet gateway'
      - 'Core network switches monitoring traffic from critical assets'
      - 'DNS servers'
      - 'DMZ firewalls'
    range: 'last 90 days'
    queries:
      - 'Pseudocode: FOR each critical asset, PROFILE destination IP/ASN frequency over 30 days. ALERT if new connection destination is in bottom 5% frequency.'
  - question: "Does a network connection from a critical asset exhibit characteristics indicative of malicious redirection or data manipulation, based on a machine learning risk score?"
    context: |
      This question uses a machine learning model to provide a more nuanced detection capability than symbolic or statistical methods alone. By analyzing multiple features of a network connection (duration, bytes transferred, service, IP context), the model can identify complex patterns that suggest malicious activity, such as traffic being rerouted through an adversary's infrastructure. This helps detect sophisticated attacks that might otherwise blend in with normal traffic.
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek dns.log'
      - 'Internet gateway'
      - 'Core network switches monitoring traffic from critical assets'
      - 'DNS servers'
      - 'DMZ firewalls'
    range: 'last 90 days'
    queries:
      - 'Pseudocode: FOR each connection, EXTRACT features (duration, service, bytes, threat intel). COMPUTE risk score using trained classification model. ALERT if score > threshold.'
  - question: "Has an SSL/TLS connection to a critical internal service used a certificate from an unapproved Certificate Authority or a JA3/JA3S hash matching a known MitM tool?"
    context: |
      This question seeks to identify classic signs of a TLS interception attack. A valid connection to an internal service should use a certificate issued by a trusted internal CA. The presence of a self-signed certificate, a certificate from an unexpected issuer, or a client/server fingerprint (JA3/JA3S) associated with interception tools like Burp Suite strongly indicates a MitM attack is in progress.
    answer_sources:
      - 'Zeek ssl.log'
      - 'Zeek x509.log'
      - 'Zeek weird.log'
      - 'Application servers'
      - 'Load balancers'
      - 'VPN concentrators'
      - 'Web proxies'
      - 'Network segments between clients and critical services'
    range: 'last 90 days'
    queries:
      - "Pseudocode: ALERT IF (ssl.log ja3/ja3s IN known_mitm_hashes) OR (x509.log certificate.issuer NOT IN approved_ca_list for critical service)."
  - question: "Has an SSL/TLS connection to a critical service presented a statistically rare certificate issuer or subject?"
    context: |
      This question helps detect subtle certificate anomalies that might not be caught by a simple allowlist. By baselining the certificate details (issuer and subject) normally seen for each critical service, we can flag connections that use an infrequent or never-before-seen certificate. This could indicate an adversary has managed to issue a fraudulent certificate from a compromised or less-common CA to perform a MitM attack.
    answer_sources:
      - 'Zeek ssl.log'
      - 'Zeek x509.log'
      - 'Zeek weird.log'
      - 'Application servers'
      - 'Load balancers'
      - 'VPN concentrators'
      - 'Web proxies'
      - 'Network segments between clients and critical services'
    range: 'last 90 days'
    queries:
      - "Pseudocode: FOR each critical service, PROFILE historical certificate issuer/subject frequency. ALERT if new connection's certificate pair is in bottom 1% frequency."
  - question: "Are there clusters of SSL/TLS sessions with anomalous characteristics that could indicate Man-in-the-Middle activity?"
    context: |
      This question uses unsupervised machine learning to find outliers among SSL/TLS sessions. Instead of looking for specific bad signatures, a clustering algorithm groups sessions by their overall characteristics (cipher suite, TLS version, certificate validity, etc.). Sessions that don't fit into any normal cluster are flagged as anomalous, potentially representing a novel or sophisticated MitM attack that uses non-standard TLS parameters.
    answer_sources:
      - 'Zeek ssl.log'
      - 'Zeek x509.log'
      - 'Zeek weird.log'
      - 'Application servers'
      - 'Load balancers'
      - 'VPN concentrators'
      - 'Web proxies'
      - 'Network segments between clients and critical services'
    range: 'last 90 days'
    queries:
      - 'Pseudocode: VECTORIZE SSL/TLS session features. APPLY DBSCAN clustering. INVESTIGATE sessions classified as noise/outliers.'
  - question: "Has a non-standard process accessed the memory of a critical application and granted itself permissions to write memory or create a remote thread, immediately before that application made a network connection?"
    context: |
      This question looks for a common attack chain where an adversary uses a utility like PowerShell to inject code into a legitimate, network-aware application (e.g., a database client). This allows the adversary's malicious code to run within the trusted process, inheriting its network permissions and firewall rules to manipulate or exfiltrate data. Correlating memory access with a subsequent network connection is key to identifying this specific behavior.
    answer_sources:
      - 'Windows Event ID 4688'
      - 'Sysmon Event ID 8'
      - 'Sysmon Event ID 10'
      - 'Windows Event ID 4656'
      - 'Critical application servers (e.g., financial, ERP)'
      - 'Database servers'
      - 'Developer workstations'
      - 'User workstations handling sensitive data (e.g., finance, HR)'
    range: 'last 90 days'
    queries:
      - 'Pseudocode: ALERT IF (Sysmon EID 10 from non-allowlisted SourceImage to critical TargetImage with write/create-thread access) AND (subsequent network connection from TargetImage within 5s).'
  - question: "Has a statistically rare instance of process memory access occurred on a host?"
    context: |
      This question aims to detect unusual process interaction by baselining which processes typically access the memory of other processes. An alert is generated for a triplet (source process, target process, access type) that has never been seen before or is extremely rare. This can uncover novel process injection techniques or the use of legitimate but uncommonly used tools for malicious purposes.
    answer_sources:
      - 'Windows Event ID 4688'
      - 'Sysmon Event ID 8'
      - 'Sysmon Event ID 10'
      - 'Windows Event ID 4656'
      - 'Critical application servers (e.g., financial, ERP)'
      - 'Database servers'
      - 'Developer workstations'
      - 'User workstations handling sensitive data (e.g., finance, HR)'
    range: 'last 90 days'
    queries:
      - 'Pseudocode: BASELINE frequency of (SourceImage, TargetImage, GrantedAccess) triplets per host. ALERT if a new observed triplet is previously unseen or in bottom 1% frequency.'
  - question: "Has a user's sequence of actions (logon, process creation, memory access, network connection) deviated significantly from their normal, learned behavior?"
    context: |
      This question moves beyond single events to analyze the entire sequence of user actions. By modeling a user's typical workflow, a machine learning model can detect when a sequence of events is abnormal, even if each individual event is not inherently suspicious. For example, a user who normally never uses PowerShell to access a database client's memory would trigger an alert, indicating a potential account compromise or insider threat.
    answer_sources:
      - 'Windows Event ID 4688'
      - 'Sysmon Event ID 8'
      - 'Sysmon Event ID 10'
      - 'Windows Event ID 4656'
      - 'Critical application servers (e.g., financial, ERP)'
      - 'Database servers'
      - 'Developer workstations'
      - 'User workstations handling sensitive data (e.g., finance, HR)'
    range: 'last 90 days'
    queries:
      - 'Pseudocode: MODEL user behavior by training a sequence-based autoencoder on event chains. ALERT if the reconstruction error for a new sequence exceeds the learned threshold.'
  - question: "Has a TCP content gap been detected during a network session involving a critical application server?"
    context: |
      This question focuses on a specific network anomaly that can indicate data manipulation at the packet level. A 'content_gap' in Zeek means there is a discrepancy between the TCP sequence numbers and the actual data payload delivered. This can be a direct indicator of an adversary injecting, modifying, or dropping packets in transit, which is a core component of transmitted data manipulation.
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek http.log'
      - 'Zeek files.log'
      - 'Zeek weird.log'
      - 'Data center network fabric'
      - 'Connections between application and database tiers'
      - 'Primary and backup data replication links'
    range: 'last 90 days'
    queries:
      - "Pseudocode: ALERT IF Zeek weird.log shows 'name' == 'content_gap' AND session involves a critical application server IP."
  - question: "Has the volume of data in a recurring, automated transfer between internal systems deviated significantly from its historical average?"
    context: |
      This question is designed to detect anomalies in predictable, machine-to-machine data flows, such as database replication or batch file transfers. By establishing a tight baseline for the expected size of these transfers, a significant deviation (e.g., more than 3 standard deviations) can indicate that data is being illegitimately added (padded) or removed (truncated) in transit.
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek http.log'
      - 'Zeek files.log'
      - 'Zeek weird.log'
      - 'Data center network fabric'
      - 'Connections between application and database tiers'
      - 'Primary and backup data replication links'
    range: 'last 90 days'
    queries:
      - 'Pseudocode: FOR critical periodic data flows, BASELINE mean/stddev of total_bytes. ALERT if new transfer''s total_bytes > (mean + 3 * stddev).'
  - question: "Using a time series model, has the volume of a high-value data flow shown an anomalous spike or drop?"
    context: |
      This question applies a more sophisticated time series analysis to detect anomalies in data transfer volumes. Unlike a simple standard deviation check, models like SARIMA or Prophet can account for seasonality and trends in the data. This allows for more accurate detection of unexpected changes in traffic volume that could be caused by data manipulation, especially for flows that have complex but predictable patterns.
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek http.log'
      - 'Zeek files.log'
      - 'Zeek weird.log'
      - 'Data center network fabric'
      - 'Connections between application and database tiers'
      - 'Primary and backup data replication links'
    range: 'last 90 days'
    queries:
      - "Pseudocode: AGGREGATE total bytes per minute for a data flow. TRAIN time series model (e.g., Prophet). ALERT if observed volume falls outside the model's predicted confidence interval."
  - question: "Have any explicit data integrity errors, such as 'Checksum Mismatch' or 'Transaction Rollback', been logged by critical applications or databases?"
    context: |
      This question looks for the most direct evidence of data manipulation: the applications themselves reporting that the data they received is corrupt or invalid. These error messages are high-fidelity indicators that the integrity of the data has been compromised at some point, and investigating them is critical.
    answer_sources:
      - 'Application Logs'
      - 'Database Logs'
      - 'Zeek files.log'
      - 'Windows Event Logs'
      - 'File servers'
      - 'Database servers logging transaction failures'
      - 'Application servers processing data uploads'
      - 'Systems participating in data replication (e.g., Domain Controllers, backup servers)'
    range: 'last 90 days'
    queries:
      - "Pseudocode: CREATE SIEM rule to ALERT on log messages containing strings like 'Data Integrity Error', 'Checksum validation failed', or 'Hash mismatch'."
  - question: "Has there been a statistically significant spike in the rate of data integrity errors on any single host?"
    context: |
      This question aims to detect a sudden increase in data integrity errors that might otherwise be lost in the noise of normal operations. By calculating a moving average of these errors, we can identify when the current error rate on a host is abnormally high (e.g., more than 4 standard deviations above average), which could signal an active attack or malfunction caused by data manipulation.
    answer_sources:
      - 'Application Logs'
      - 'Database Logs'
      - 'Zeek files.log'
      - 'Windows Event Logs'
      - 'File servers'
      - 'Database servers logging transaction failures'
      - 'Application servers processing data uploads'
      - 'Systems participating in data replication (e.g., Domain Controllers, backup servers)'
    range: 'last 90 days'
    queries:
      - "Pseudocode: COUNT integrity errors per host per hour. CALCULATE 7-day moving average/stddev. ALERT if current hour's count > (moving_avg + 4 * stddev)."
  - question: "Has an unsupervised anomaly detection model identified an unusual pattern or an enterprise-wide increase in the frequency of data integrity errors?"
    context: |
      This question uses machine learning to detect coordinated, low-and-slow attacks that might not trigger single-host statistical thresholds. An algorithm like Isolation Forest can analyze the time series of integrity errors across the entire enterprise and identify periods where the overall pattern is anomalous. This is effective for finding distributed attacks or subtle, widespread data corruption issues.
    answer_sources:
      - 'Application Logs'
      - 'Database Logs'
      - 'Zeek files.log'
      - 'Windows Event Logs'
      - 'File servers'
      - 'Database servers logging transaction failures'
      - 'Application servers processing data uploads'
      - 'Systems participating in data replication (e.g., Domain Controllers, backup servers)'
    range: 'last 90 days'
    queries:
      - 'Pseudocode: CREATE time series of enterprise-wide integrity errors per 5 minutes. APPLY Isolation Forest. ALERT on points flagged as anomalies.'