name: T1485: Data Destruction
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps determine if an adversary is actively destroying or overwriting data on critical systems to disrupt operations. It focuses on detecting known data destruction tools via hash matching, the misuse of legitimate system utilities for wiping, anomalous volumes of file deletions or modifications, files being overwritten with low-entropy data, and attempts to delete system backups or critical OS files.
type: technique
related:
- TA0040: Impact
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Are processes being executed that match the cryptographic hash of known data destruction tools?
  context: This question aims to identify known data destruction malware (e.g., WhisperGate, CaddyWiper) by matching the cryptographic hash of running processes against a threat intelligence feed. A hash match is a high-fidelity indicator of a specific, known threat executing in the environment.
  answer_sources:
  - Windows Event ID 4688
  - EDR Process Creation Logs
  - Domain Controllers, File Servers, Database Servers, Critical Application Servers, User Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH ProcessCreationEvents | HASH process_image | LOOKUP against threat_intel_feed_of_wiper_hashes | WHERE match_found
- question: Are rare or new processes executing that match YARA rules for destructive malware?
  context: This question seeks to identify potentially unknown or polymorphic destructive malware. By focusing on processes that are statistically rare across the enterprise and also match broader behavioral or code-based patterns defined in YARA rules, analysts can uncover threats that would be missed by exact hash matching.
  answer_sources:
  - Windows Event ID 4688
  - EDR Process Creation Logs
  - Domain Controllers, File Servers, Database Servers, Critical Application Servers, User Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH ProcessCreationEvents | STATS prevalence(process_hash) | JOIN with YARA_scan_results | WHERE prevalence < 0.1% AND yara_rule_family = 'destructive'
- question: Are machine learning models identifying newly observed executables as data wipers based on their features?
  context: This question leverages predictive analytics to proactively identify destructive executables. A machine learning model, trained on features like file metadata, imports, and entropy, can classify a never-before-seen file as a "wiper" with a high degree of confidence, enabling automated response before widespread damage occurs.
  answer_sources:
  - Windows Event ID 4688
  - EDR Process Creation Logs
  - Domain Controllers, File Servers, Database Servers, Critical Application Servers, User Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: STREAM NewProcessEvents | EXTRACT file_features | INPUT to ML_model | ALERT where prediction = 'wiper' AND confidence > 0.9
- question: Are legitimate system utilities being executed with command-line arguments known to perform irreversible data destruction?
  context: Adversaries often abuse legitimate tools to evade detection. This question looks for specific, high-confidence command-line patterns (e.g., 'sdelete.exe -p', 'cipher.exe /w:') that indicate a utility is being used for its data wiping capabilities, which is highly unusual in normal operations and a strong sign of malicious intent.
  answer_sources:
  - Windows Event ID 4688
  - EDR Process Creation Logs
  - Domain Controllers, File Servers, Critical System Partitions, User Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH ProcessCreationEvents | REGEX command_line for '(sdelete.*-p|cipher.*/w:|format.*/p:|wevtutil.*cl)' | ALERT on match
- question: Are common system utilities being used with statistically rare or anomalous command-line arguments, especially by unusual users or processes?
  context: This question moves beyond static patterns to identify anomalous usage. By baselining normal command-line arguments for utilities, it can flag when a rare combination of parameters is used, which could indicate misuse. The context of a non-administrative user or a web server process executing such a command significantly increases its suspicion level.
  answer_sources:
  - Windows Event ID 4688
  - EDR Process Creation Logs
  - Domain Controllers, File Servers, Critical System Partitions, User Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH ProcessCreationEvents | BASELINE frequency of command_line_arguments by process_name | ALERT where frequency < 1st_percentile
- question: Are sequences of command-line executions deviating from learned benign patterns, suggesting anomalous or destructive activity?
  context: This question analyzes the sequence of commands, not just individual executions. A machine learning model can learn normal command progressions. An anomalous sequence, such as reconnaissance commands followed by a wiping utility, would be flagged by the model as a significant deviation from normal behavior, indicating a potential attack chain.
  answer_sources:
  - Windows Event ID 4688
  - EDR Process Creation Logs
  - Domain Controllers, File Servers, Critical System Partitions, User Workstations
  range: last 90 days
  queries:
  - technology: pseudocode
    query: STREAM CommandHistory by user,host | INPUT to sequence_anomaly_model | ALERT on high anomaly_score
- question: Is a single process rapidly deleting an abnormally large number of files on a critical server within a short time frame?
  context: This question uses a simple threshold to detect brute-force wiping activity. A legitimate process is very unlikely to delete thousands of files in under a minute. This behavior is a classic indicator of a wiper or ransomware payload executing and is often one of the most visible signs of an active impact event.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 4688
  - Zeek files.log
  - File Integrity Monitoring (FIM) Agent Logs
  - Network File Shares (SMB/NFS), Document Management Systems, User Profile Directories, Source Code Repositories
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH FileDeleteEvents | STATS count by ProcessID over 60s_window | ALERT where count > 1000
- question: Is a user or host exhibiting a rate of file modifications or deletions that is a significant statistical outlier compared to their own historical baseline?
  context: This question provides a more nuanced approach than a static threshold by creating a dynamic baseline of file activity for each user and host. An alert is generated only when an entity's activity dramatically exceeds its own normal behavior (e.g., 4+ standard deviations), making it effective at spotting anomalies while reducing false positives from normally "busy" users or servers.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 4688
  - Zeek files.log
  - File Integrity Monitoring (FIM) Agent Logs
  - Network File Shares (SMB/NFS), Document Management Systems, User Profile Directories, Source Code Repositories
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH FileEvents | BASELINE stats(rate) by user, host | ALERT where current_rate > (mean + 4*stdev) for 3_minutes
- question: Are there spikes in file operations on critical assets that violate established seasonal patterns of activity?
  context: This question uses time-series analysis to understand the normal rhythm of file activity, including daily and weekly patterns. An event is flagged if it occurs at a time when activity is expected to be low (e.g., a massive number of file deletions on a weekend). This can detect stealthy attacks that might otherwise fall below volume-based thresholds.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 4688
  - Zeek files.log
  - File Integrity Monitoring (FIM) Agent Logs
  - Network File Shares (SMB/NFS), Document Management Systems, User Profile Directories, Source Code Repositories
  range: last 90 days
  queries:
  - technology: pseudocode
    query: STREAM FileOperationCounts | INPUT to time_series_model | ALERT where observation is outside predicted_confidence_interval
- question: Following a mass file modification event, do the modified files contain content patterns, such as all null bytes, consistent with data wiping?
  context: This question aims to confirm the destructive nature of a high-volume file write event. By sampling the modified files and inspecting their content, analysts can verify if the files were overwritten with meaningless data (e.g., a single repeating byte) or a known wiper's signature, confirming the event was malicious destruction rather than a legitimate bulk update.
  answer_sources:
  - File Integrity Monitoring (FIM) Agent Logs
  - EDR Telemetry
  - Zeek files.log
  - Zeek file_entropy.log
  - User Workstations, Web Servers, File Servers, Database Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: ON high_volume_write_alert | TRIGGER script to sample_files | ANALYZE file_content | ALERT if content_pattern matches 'wiper_signature'
- question: Do files modified in a mass-write event exhibit abnormally low or high entropy, suggesting they were overwritten with uniform or random data?
  context: This question uses Shannon entropy, a measure of randomness, to identify overwritten files. Legitimate files have a characteristic entropy range. Files overwritten with uniform data (like null bytes) will have very low entropy, while files overwritten with random or encrypted data will have very high entropy. A significant deviation from the expected entropy for a file type is a strong indicator of wiping.
  answer_sources:
  - File Integrity Monitoring (FIM) Agent Logs
  - EDR Telemetry
  - Zeek files.log
  - Zeek file_entropy.log
  - User Workstations, Web Servers, File Servers, Database Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: ON high_volume_write_alert | TRIGGER script to calculate_entropy | COMPARE to baseline_entropy_by_filetype | ALERT on significant_deviation
- question: Are new clusters of files appearing that are characterized by anomalous features like low entropy, indicating a coordinated data destruction event?
  context: This question uses unsupervised machine learning to find groups of anomalous files. Normal files will form clusters based on their features (type, size, entropy). A wiper event will create a new, distinct cluster of files that all share abnormal properties (e.g., same modification time, low entropy), causing them to stand out from the normal file population without prior knowledge of the attack.
  answer_sources:
  - File Integrity Monitoring (FIM) Agent Logs
  - EDR Telemetry
  - Zeek files.log
  - Zeek file_entropy.log
  - User Workstations, Web Servers, File Servers, Database Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: COLLECT file_metadata | INPUT to clustering_algorithm | ALERT on new anomalous_cluster formation
- question: Are commands being executed to delete or tamper with system backups, recovery points, or critical OS files?
  context: This question focuses on detecting an adversary's attempts to hinder recovery. Attackers frequently delete Volume Shadow Copies or other backups before deploying a wiper. This query looks for the explicit execution of commands like 'vssadmin.exe delete shadows' or unauthorized modification attempts on critical OS files (e.g., ntds.dit), which are clear precursors to an impact event.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 4688
  - System Boot Partitions (EFI), C:\Windows\System32\config\ (SAM, SYSTEM hives), Volume Shadow Copy Storage Areas
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH ProcessCreationEvents | FILTER command_line matches 'vssadmin.*delete' OR (target_file in critical_watchlist AND process_name not in trusted_list)
- question: Are processes that can perform destructive actions being launched by unusual or unexpected parent processes?
  context: This question uses process ancestry as a powerful indicator of compromise. System utilities like 'vssadmin.exe' have expected parent processes (e.g., 'cmd.exe'). If such a utility is launched by an unexpected parent, such as a web server process ('w3wp.exe') or Microsoft Word ('winword.exe'), it strongly suggests that the parent process has been compromised and is being used to execute malicious commands.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 4688
  - System Boot Partitions (EFI), C:\Windows\System32\config\ (SAM, SYSTEM hives), Volume Shadow Copy Storage Areas
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH ProcessCreationEvents | LOOKUP parent_process | ALERT where parent_child_relationship is rare and child_process is sensitive
- question: Is a user account exhibiting a sudden and drastic change in behavior, such as a standard user executing a sequence of administrative and destructive commands?
  context: This question applies User and Entity Behavior Analytics (UEBA) to detect compromised accounts. The system learns a baseline of normal activity for each user. If an account that typically only performs business functions suddenly executes a chain of administrative commands associated with data destruction, it constitutes a major behavioral anomaly, indicating the account has been compromised and is being used for an attack.
  answer_sources:
  - Windows Event ID 4663
  - Windows Event ID 4688
  - System Boot Partitions (EFI), C:\Windows\System32\config\ (SAM, SYSTEM hives), Volume Shadow Copy Storage Areas
  range: last 90 days
  queries:
  - technology: pseudocode
    query: STREAM UserActivity | INPUT to UEBA_model | ALERT on significant behavioral_deviation involving destructive commands