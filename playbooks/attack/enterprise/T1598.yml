name: T1598: Phishing for Information
id: f9e0c1a8-4b7e-4d6c-8a2b-9f1e0d3c5b6a
description: This playbook helps determine if an adversary is conducting reconnaissance
  by phishing for information. It provides investigative steps to identify phishing
  attempts based on several key indicators: emails containing metadata or content
  matching threat intelligence feeds; emails that fail standard authentication protocols
  (DMARC/SPF/DKIM), originate from newly registered or typosquatted domains; evidence
  of a single external source sending bulk emails to a large number of internal
  recipients; targeted emails to High-Value Targets (HVTs) exhibiting multiple risk
  factors; and anomalous outbound data transfers from a user shortly after they
  have interacted with a suspected phishing email.
type: technique
related:
- TA0043: Reconnaissance
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Are any inbound emails using sender IPs, domains, or embedded URLs that
    are present on a known threat intelligence feed?
  context: This question aims to detect phishing attempts by cross-referencing key
    email metadata and content against a curated list of known malicious indicators.
    A match provides a high-confidence signal that an incoming email is part of a
    known phishing campaign, allowing for rapid alerting and response.
  answer_sources:
  - Zeek smtp.log
  - Zeek dns.log
  - Zeek http.log
  - Zeek conn.log
  - Perimeter Firewall
  - Network DNS Resolvers
  - Web Proxy
  - Email Gateway
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each inbound_email: IF email.sender_ip OR email.sender_domain OR email.url
      IN threat_intel_feed: GENERATE high_severity_alert
- question: Are inbound emails coming from domains that are statistically rare for
    the organization to interact with?
  context: This question helps identify suspicious emails by focusing on the novelty
    of the sender's domain. Adversaries often use new or obscure domains for phishing
    campaigns. By baselining normal domain interaction frequency, we can flag emails
    from rare domains, which have a higher probability of being malicious, especially
    if they also use an uncommon Top-Level Domain (TLD).
  answer_sources:
  - Zeek smtp.log
  - Zeek dns.log
  - Zeek http.log
  - Zeek conn.log
  - Perimeter Firewall
  - Network DNS Resolvers
  - Web Proxy
  - Email Gateway
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each non_allowlisted_domain in email: CALCULATE historical_query_count.
      IF query_count < 5th_percentile: FLAG as suspicious. INCREASE suspicion if
      domain_tld is also rare.
- question: Do any inbound emails receive a high phishing score from a machine learning
    classification model?
  context: This question leverages a machine learning model to provide a holistic
    risk assessment for each email. By combining multiple features—such as sender
    reputation, domain characteristics, and content analysis—the model can identify
    complex phishing patterns that simple rules might miss. A high score indicates
    a strong likelihood of phishing, justifying automated quarantine or immediate
    analyst review.
  answer_sources:
  - Zeek smtp.log
  - Zeek dns.log
  - Zeek http.log
  - Zeek conn.log
  - Perimeter Firewall
  - Network DNS Resolvers
  - Web Proxy
  - Email Gateway
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each inbound_email: CALCULATE phishing_score using ML_model(features).
      IF phishing_score > 0.85: QUARANTINE or FLAG for review.
- question: Are we receiving inbound emails that fail DMARC, SPF, or DKIM authentication?
  context: This question checks for failures in standard email authentication mechanisms.
    SPF, DKIM, and DMARC are designed to prevent email spoofing. A failure indicates
    that the sender is not authorized to send email from the claimed domain, which
    is a strong indicator of a phishing or spoofing attempt.
  answer_sources:
  - Zeek smtp.log
  - Zeek dns.log
  - Email Gateway
  - Network DNS Resolvers
  - Corporate Domain Registrar
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each inbound_email: PARSE Authentication-Results header. IF header
      contains 'spf=fail' or 'dkim=fail' or 'dmarc=fail': GENERATE alert.
- question: Are emails being received from domains that were registered very recently?
  context: This question aims to identify emails from Newly Registered Domains (NRDs).
    Attackers frequently register new domains for their phishing campaigns to bypass
    reputation-based security controls. By identifying emails from domains created
    within the last 30-90 days, we can flag potentially malicious correspondence
    that has no established history.
  answer_sources:
  - Zeek smtp.log
  - Zeek dns.log
  - Email Gateway
  - Network DNS Resolvers
  - Corporate Domain Registrar
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each inbound_email: GET domain_registration_date via WHOIS. CALCULATE
      domain_age. IF domain_age < 5th_percentile (e.g., < 30 days): FLAG for inspection.
- question: Have we identified any external sender domains that are potential typosquats
    or look-alikes of our own or our partners' domains?
  context: This question seeks to uncover look-alike domains created for impersonation.
    Adversaries use typosquatting to trick users into believing an email is from
    a legitimate source. By systematically comparing new external sender domains
    against our own and our partners' domains using string similarity algorithms,
    we can proactively identify and block these deceptive domains.
  answer_sources:
  - Zeek smtp.log
  - Zeek dns.log
  - Email Gateway
  - Network DNS Resolvers
  - Corporate Domain Registrar
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each new_external_domain: COMPARE against internal/partner_domains
      using Levenshtein_distance. IF distance < 3: CLUSTER and REVIEW for malicious
      look-alikes.
- question: Has a single external source sent emails to an unusually large number
    of internal recipients in a short time frame?
  context: This question helps detect the initial stages of a broad-based phishing
    campaign. A sudden, high-volume email blast from a single IP or domain to many
    different internal users is anomalous behavior for most legitimate senders.
    Triggering an alert based on this threshold can provide early warning of a widespread
    attack.
  answer_sources:
  - Zeek smtp.log
  - Zeek conn.log
  - Email Gateway
  - Mail Transfer Agent (MTA)
  - Network Intrusion Detection System (NIDS)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: 'MONITOR inbound emails: IF count(unique_recipients) from single_source_ip/domain
      > 50 within 60 minutes: GENERATE alert.'
- question: Are there any new or low-reputation senders exhibiting an abnormally
    high fan-out ratio?
  context: This question identifies suspicious sending patterns by analyzing the
    ratio of unique recipients to total emails sent. Legitimate bulk senders usually
    have established patterns, whereas an attacker might send a single email to a
    large, unique list of targets, resulting in a high fan-out ratio. Baselining
    this behavior helps detect outliers that could indicate a phishing campaign.
  answer_sources:
  - Zeek smtp.log
  - Zeek conn.log
  - Email Gateway
  - Mail Transfer Agent (MTA)
  - Network Intrusion Detection System (NIDS)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each sender: CALCULATE fan-out_ratio (unique_recipients / total_emails)
      over 15-min window. IF ratio > 99th_percentile of baseline: GENERATE alert.
- question: Have we observed a sudden, anomalous spike in email volume from any
    single external domain?
  context: This question uses time-series analysis to detect deviations from normal
    email sending patterns. A legitimate sender typically has a predictable volume
    and cadence. A sudden, sharp increase in email volume from a single domain that
    breaks from its historical pattern is a strong indicator of a compromised account
or a domain being used for a malicious campaign.
  answer_sources:
  - Zeek smtp.log
  - Zeek conn.log
  - Email Gateway
  - Mail Transfer Agent (MTA)
  - Network Intrusion Detection System (NIDS)
  range: last 90 days
  queries:
  - technology: pseudocode
    query: APPLY time-series anomaly detection (e.g., LSTM) to email volume per
      domain. IF detected_volume significantly deviates from predicted_pattern:
      GENERATE alert.
- question: Has a High-Value Target (HVT) received an email from an un-allowlisted
    domain that also contains other risk factors?
  context: This question focuses on protecting the organization's most critical
    personnel from spearphishing. By creating a high-priority rule for a predefined
    list of HVTs, we can apply extra scrutiny to their inbound mail. The rule looks
    for a combination of risk factors—such as an unknown sender, urgent language,
    and deceptive subject lines—to quickly identify and flag targeted attacks.
  answer_sources:
  - Zeek smtp.log
  - Zeek dns.log
  - Executive Mailboxes
  - Finance Department Endpoints
  - IT Administrator Workstations
  - Privileged Access Management Systems
  range: last 90 days
  queries:
  - technology: pseudocode
    query: 'FOR email to HVT: IF sender_domain NOT IN allowlist AND (subject contains
      ''urgent''/''password'' OR subject starts with ''RE:'' and is not a reply):
      GENERATE high_priority_alert.'
- question: Is the communication pattern for our High-Value Target (HVT) group showing
    anomalous characteristics, such as a new persistent sender?
  context: This question involves baselining normal communication behavior for HVTs
    to detect subtle attacks. A sudden change, such as a new, uncharacteristic sender
    domain frequently communicating with the HVT group, can indicate a targeted
    spearphishing campaign. Analyzing the statistical properties of communication,
    like sender domain entropy, helps to automatically surface these suspicious
    shifts.
  answer_sources:
  - Zeek smtp.log
  - Zeek dns.log
  - Executive Mailboxes
  - Finance Department Endpoints
  - IT Administrator Workstations
  - Privileged Access Management Systems
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR HVT_group_emails: CALCULATE weekly Shannon_entropy of sender_domains.
      IF sharp_decrease_in_entropy or statistical_outlier_domain is detected: FLAG
      for review.
- question: Have any emails targeting High-Value Targets (HVTs) been flagged as
    high-risk by a dedicated spearphishing detection model?
  context: This question applies a specialized machine learning model trained specifically
    to identify spearphishing attempts against HVTs. This model can use more granular
    features, such as the presence of HVT names in the email body or URLs with non-standard
    ports, to detect highly targeted and sophisticated threats that might otherwise
    be missed. A high probability score from this model warrants immediate investigation.
  answer_sources:
  - Zeek smtp.log
  - Zeek dns.log
  - Executive Mailboxes
  - Finance Department Endpoints
  - IT Administrator Workstations
  - Privileged Access Management Systems
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR email to HVT: CALCULATE spearphish_score using dedicated_ML_model.
      IF score is high: TRIGGER immediate analyst investigation.
- question: Has a user initiated outbound communication to a suspicious destination
    shortly after receiving a potential phishing email from that same source?
  context: This question aims to correlate a phishing alert with subsequent user
    actions to detect a successful compromise or data exfiltration attempt. If a
    user receives a phish and then quickly communicates back to the attacker's infrastructure
    (e.g., by replying with sensitive information), it's a strong sign that the
    phishing attempt was successful in eliciting a response.
  answer_sources:
  - Zeek smtp.log
  - Zeek files.log
  - Zeek conn.log
  - Windows Event ID 4688
  - Windows Event ID 4663
  - User Endpoints
  - Network Egress Points
  - Mail Transfer Agent (MTA)
  - File Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: IF phishing_alert for recipient.user from source.ip: MONITOR for outbound
      traffic from recipient.user to source.ip within 30 minutes. IF match: GENERATE
      alert.
- question: Has any user sent an outbound email that is anomalously large or contains
    an unusually large attachment, especially to a rare recipient?
  context: This question helps detect data exfiltration via email by baselining
    each user's normal sending behavior. An employee sending an email with an attachment
    that is orders of magnitude larger than their typical attachments, especially
    to a domain they've never sent to before, is highly suspicious and could indicate
    the exfiltration of sensitive data prompted by a phishing attack.
  answer_sources:
  - Zeek smtp.log
  - Zeek files.log
  - Zeek conn.log
  - Windows Event ID 4688
  - Windows Event ID 4663
  - User Endpoints
  - Network Egress Points
  - Mail Transfer Agent (MTA)
  - File Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOR each user: BASELINE outbound email size/attachment size. IF outbound_email_size
      > 3_std_dev_above_mean: ALERT. INCREASE severity if recipient_domain is rare
      for user.
- question: Has a user exhibited a sequence of actions that matches a high-risk
    pattern for phishing compromise and data exfiltration?
  context: This question uses sequence analysis to connect a series of seemingly
    disparate events into a coherent, high-risk narrative. An attacker's goal might
    be to get a user to click a link, access a sensitive file, and then email it
    out. By modeling normal user behavior sequences, a Hidden Markov Model or similar
    technique can identify when a user executes an improbable chain of events that
    strongly indicates a compromise.
  answer_sources:
  - Zeek smtp.log
  - Zeek files.log
  - Zeek conn.log
  - Windows Event ID 4688
  - Windows Event ID 4663
  - User Endpoints
  - Network Egress Points
  - Mail Transfer Agent (MTA)
  - File Servers
  range: last 90 days
  queries:
  - technology: pseudocode
    query: 'MODEL user behavior with sequence_analysis_model. DETECT high-risk sequences,
      e.g., [inbound_phish] -> [dns_query] -> [http_conn] -> [sensitive_file_access]
      -> [outbound_email_with_large_attachment]. ALERT on detection.'