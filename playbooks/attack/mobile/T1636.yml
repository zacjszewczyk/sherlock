name: T1636: Protected User Data
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: "This playbook helps to determine if an adversary is collecting protected user data from corporate mobile devices. This is achieved by identifying mobile applications with high-risk or anomalous permissions, detecting unusually large outbound data transfers to suspicious destinations, and correlating protected data access events on the endpoint with subsequent unapproved network connections. The goal is to detect and respond to potential data exfiltration from managed mobile devices."
type: technique
related:
  - TA0035: Collection
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is a known malicious application installed on any corporate mobile devices?
    context: "This question aims to identify threats that have been previously identified and fingerprinted by the security community. By cross-referencing the inventory of installed applications against a threat intelligence feed using multiple identifiers (file hash, package name, certificate hash), an analyst can quickly detect known malware or tools used by malicious actors, enabling a rapid response."
    answer_sources:
      - MDM Application Inventory Export
      - Application Vetting Service Report
      - Mobile Threat Intelligence Feed
      - Mobile Device Management (MDM) platform
      - Corporate App Store
      - Application Vetting System
      - Corporate-managed mobile endpoints
    range: last 90 days
    queries:
      - "pseudocode: FOREACH app in mdm_inventory -> QUERY threat_intel_feed WITH app.hash, app.package_name, app.cert_hash -> IF match THEN ALERT"
  - question: Are there any applications with an anomalously high-risk combination of permissions compared to their peers?
    context: "This question helps uncover unknown or zero-day threats by finding statistical outliers. Not all malicious apps are known. By analyzing the permissions an app requests and comparing them to other apps in the same category (e.g., 'Games', 'Productivity'), we can flag applications that request an unusual or excessive set of permissions. This method provides a data-driven way to surface potentially unwanted or malicious applications for manual security review."
    answer_sources:
      - MDM Application Inventory Export
      - Application Vetting Service Report
      - Mobile Threat Intelligence Feed
      - Mobile Device Management (MDM) platform
      - Corporate App Store
      - Application Vetting System
      - Corporate-managed mobile endpoints
    range: last 90 days
    queries:
      - "pseudocode: GROUP apps by category -> FOREACH category -> CALCULATE permission_prevalence -> FOREACH app -> CALCULATE anomaly_score = sum(1/prevalence) -> IF score > 95th_percentile THEN FLAG for_review"
  - question: "Can a machine learning model identify and block potentially malicious applications based on their manifest files before they are widely installed?"
    context: "This question addresses the need for proactive, automated threat prevention. By training a classification model on the characteristics of known good and bad applications (e.g., requested permissions, specific API calls), it's possible to create a system that automatically scores and blocks new applications from being installed if they are predicted to be malicious with a high degree of confidence ($$ > 0.90 $$). This reduces the manual workload on security teams and prevents threats from ever reaching the endpoint."
    answer_sources:
      - MDM Application Inventory Export
      - Application Vetting Service Report
      - Mobile Threat Intelligence Feed
      - Mobile Device Management (MDM) platform
      - Corporate App Store
      - Application Vetting System
      - Corporate-managed mobile endpoints
    range: last 90 days
    queries:
      - "pseudocode: TRAIN classification_model ON labeled_manifests -> DEPLOY model -> FOREACH new_app -> PREDICT if malicious -> IF malicious AND confidence > 0.90 THEN BLOCK and ALERT"
  - question: Are any corporate mobile devices communicating with known malicious command-and-control or data exfiltration endpoints?
    context: "This question focuses on detecting active data exfiltration by monitoring network traffic. By comparing destination IPs and domains from mobile device network logs against a threat intelligence feed of known malicious infrastructure, an analyst can identify compromised devices that are actively communicating with an adversary. This is a high-fidelity indicator of an ongoing breach."
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Threat Intelligence Feed
      - WHOIS Lookup Service
      - Network egress points
      - Corporate Wi-Fi access points
      - VPN concentrators
      - DNS resolvers
    range: last 90 days
    queries:
      - "pseudocode: FILTER conn_logs WHERE source_ip in mobile_range -> JOIN dns_logs -> QUERY threat_intel_feed WITH dest_ip, dest_domain -> IF match THEN ALERT"
  - question: "Has any mobile device exhibited an unusually large outbound data transfer to a suspicious, newly registered, or high-entropy domain?"
    context: "This question helps detect data exfiltration to unknown or newly created malicious domains. It combines three distinct signals: a volumetric anomaly (a data transfer significantly larger than the device's normal behavior), a temporal signal (a very new domain), and a linguistic signal (a domain name with high entropy, often indicating it was algorithmically generated). A combination of these factors is a strong indicator of malicious activity, even if the destination is not on any blocklist."
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Threat Intelligence Feed
      - WHOIS Lookup Service
      - Network egress points
      - Corporate Wi-Fi access points
      - VPN concentrators
      - DNS resolvers
    range: last 90 days
    queries:
      - "pseudocode: FOREACH device -> CALCULATE baseline_volume (mean, stddev) -> FOREACH connection -> IF volume > (mean + 3*stddev) THEN ALERT and ENRICH with whois, entropy -> IF domain_age < 30 days and entropy > 3.5 THEN ESCALATE"
  - question: Can a time-series model detect anomalous hourly outbound data volumes from mobile devices that might indicate data exfiltration?
    context: "This question explores a more advanced method for detecting volumetric anomalies. Simple standard deviation checks can be noisy. A time-series model, such as an LSTM Autoencoder, can learn the complex, periodic patterns of a device's normal network behavior (e.g., more traffic during work hours, less at night). It can then flag deviations from this learned pattern with much higher accuracy, reducing false positives and detecting more subtle exfiltration attempts that might be missed by static thresholds."
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Threat Intelligence Feed
      - WHOIS Lookup Service
      - Network egress points
      - Corporate Wi-Fi access points
      - VPN concentrators
      - DNS resolvers
    range: last 90 days
    queries:
      - "pseudocode: TRAIN lstm_autoencoder ON hourly_volume_data -> FOREACH new_hour_data -> CALCULATE reconstruction_error -> IF error > threshold THEN ALERT"
  - question: Has any mobile application accessed protected user data and immediately made a network connection to an unapproved or known-malicious destination?
    context: "This question seeks to find a 'smoking gun' by directly correlating sensitive data access with suspicious network activity in near real-time. The logic is that a benign application should only connect to approved, known destinations. An alert that shows a process accessing the user's contacts or location and, within seconds, sending data to an unlisted or malicious IP is a very strong indicator of theft. This correlation provides critical context that a network alert or an API access alert alone would lack."
    answer_sources:
      - Mobile EDR API Monitoring Log
      - Mobile EDR Network Flow Log
      - Zeek conn.log
      - Application-to-Network Allowlist
      - Corporate-managed mobile endpoints
      - Network egress points
    range: last 90 days
    queries:
      - "pseudocode: CORRELATION RULE: TRIGGER on (EDR_data_access_event) AND (EDR_network_event within 10s) WHERE dest NOT IN allowlist OR dest IN threat_feed -> GENERATE ALERT"
  - question: Has an application accessed protected data and then connected to a network destination for the very first time?
    context: "This question focuses on detecting anomalous behavior by baselining an application's network connections. Most applications connect to a predictable set of domains. If an application is observed accessing protected data (like SMS messages) and then immediately connects to a domain it has never been seen connecting to before, it is highly suspicious. This 'first-seen' logic, especially when combined with other risk factors like a newly registered domain, can effectively uncover novel data exfiltration channels."
    answer_sources:
      - Mobile EDR API Monitoring Log
      - Mobile EDR Network Flow Log
      - Zeek conn.log
      - Application-to-Network Allowlist
      - Corporate-managed mobile endpoints
      - Network egress points
    range: last 90 days
    queries:
      - "pseudocode: FOREACH app -> BUILD baseline_network_destinations -> CREATE RULE: TRIGGER on (EDR_data_access_event) -> CHECK for (network_event within 10s) WHERE dest NOT IN baseline -> IF found THEN ALERT"
  - question: Can a sequence-based model detect anomalous chains of events, such as protected data access followed by an unusual network connection, that deviate from normal application behavior?
    context: "This question proposes using advanced modeling to understand the 'grammar' of normal application behavior. Instead of looking at individual events or simple correlations, this approach models the entire sequence of actions (e.g., process start -> file read -> data access -> network connect). By training a model on billions of benign sequences, it can learn what 'normal' looks like. A sequence containing sensitive data access followed by a rare or never-before-seen network connection would be flagged as a high-scoring anomaly, indicating a likely malicious behavior pattern."
    answer_sources:
      - Mobile EDR API Monitoring Log
      - Mobile EDR Network Flow Log
      - Zeek conn.log
      - Application-to-Network Allowlist
      - Corporate-managed mobile endpoints
      - Network egress points
    range: last 90 days
    queries:
      - "pseudocode: TRAIN sequence_model ON benign_event_sequences -> FOREACH new_event_sequence -> CALCULATE anomaly_score -> IF score > threshold AND sequence contains (data_access -> network_connect) THEN ALERT"