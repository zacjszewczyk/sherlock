name: "T1641: Data Manipulation"
id: "a0f7e8c1-4b9d-4e2a-8f6c-1d0b3a5c7e9f"
description: "This playbook helps investigate whether an adversary is manipulating data within critical business applications on corporate mobile devices to disrupt operations or decision-making. This involves looking for signs of data theft via clipboard, such as a mobile application reading clipboard data shortly after a corporate application writes to it, followed by suspicious network activity. It also covers direct data manipulation, such as a mobile application modifying a file or database outside of its own designated application data container or performing high-frequency, small-write modifications to a sensitive file inconsistent with normal user activity."
type: "technique"
related:
  - "TA0034: Impact"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Has a non-corporate or known malicious mobile application been observed reading clipboard data immediately after a corporate application wrote to it?"
    context: "This question seeks to identify 'clipboard hijacking,' a technique where a malicious application steals sensitive information (e.g., passwords, PII, financial details) that a user has copied from a legitimate corporate application. Correlating the reading application with a threat intelligence feed provides high-confidence confirmation of malicious intent, indicating a likely device compromise and data theft."
    answer_sources:
      - "Mobile EDR/MDM logs (capturing API calls, process activity, and clipboard access events)"
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Corporate-managed mobile devices"
      - "Corporate Wi-Fi and VPN network gateways"
      - "Cloud-hosted MDM/EDR platforms"
    range: "last 90 days"
    queries:
      - "pseudocode": "SEARCH Mobile_EDR_Logs | JOIN on device_id and timestamp (within 5 seconds) WHERE writing_process is in [corporate_apps] and reading_process is not | LOOKUP reading_process_package against Threat_Intel_Feed | ALERT on match"
  - question: "Is any mobile application accessing the clipboard at an anomalously high frequency or interacting with other applications in a previously unseen manner?"
    context: "This question aims to detect more subtle data scraping activities that might not involve known malicious applications. By establishing a baseline of normal clipboard access frequency and legitimate application-to-application interactions, analysts can identify deviations that suggest an application is either scraping data excessively or interacting with other apps in a suspicious, previously unobserved way."
    answer_sources:
      - "Mobile EDR/MDM logs (capturing API calls, process activity, and clipboard access events)"
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Corporate-managed mobile devices"
      - "Corporate Wi-Fi and VPN network gateways"
      - "Cloud-hosted MDM/EDR platforms"
    range: "last 90 days"
    queries:
      - "pseudocode": "BASELINE clipboard_read_frequency per app over 30 days to calculate 99th percentile | BASELINE normal source/destination app pairs for clipboard use | SEARCH for clipboard read events | ALERT if daily_read_count > 99th_percentile OR if source/destination_pair is new"
  - question: "Has a device exhibited an anomalous spike in outbound network traffic shortly after a non-standard application was seen reading from the clipboard?"
    context: "This question correlates two distinct suspicious events: clipboard access and network traffic anomalies. The goal is to connect the potential local theft of data (from the clipboard) with the subsequent exfiltration of that data to an external server. A confirmed link between these two activities provides strong evidence that sensitive data has been successfully stolen and removed from the device."
    answer_sources:
      - "Mobile EDR/MDM logs (capturing API calls, process activity, and clipboard access events)"
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Corporate-managed mobile devices"
      - "Corporate Wi-Fi and VPN network gateways"
      - "Cloud-hosted MDM/EDR platforms"
    range: "last 90 days"
    queries:
      - "pseudocode": "FORECAST expected outbound network volume per device | SEARCH for actual volume exceeding predicted volume by >3 standard deviations | CORRELATE network anomaly with a clipboard read by a non-standard app within the previous 60 seconds | ALERT on correlation"
  - question: "Has any mobile application attempted to write or modify data outside of its designated sandbox environment?"
    context: "This question checks for direct violations of the mobile OS security model, specifically application sandboxing. An application writing outside its own container is a major security red flag. It suggests an attempt to tamper with other applications' data, alter system configurations, or plant malicious files. After excluding known legitimate inter-app frameworks, any such event is highly indicative of malicious activity."
    answer_sources:
      - "Mobile EDR/MDM logs (capturing file system and database modifications)"
      - "Zeek http.log"
      - "Zeek files.log"
      - "Corporate-managed mobile devices"
      - "Application servers receiving mobile data"
      - "Application data containers on mobile devices"
    range: "last 90 days"
    queries:
      - "pseudocode": "SEARCH Mobile_EDR file access logs for write events | FILTER where acting_process_sandbox_path does not match parent directory of target_file_path | EXCLUDE known OS processes and inter-app frameworks | ALERT on any remaining events"
  - question: "Is any application modifying critical data files (like the contacts database) with an unusually high frequency or causing an abnormally large change in file size?"
    context: "This question focuses on detecting anomalous modification of shared, sensitive data stores. While legitimate applications may modify these files, an attacker might do so with unusual velocity (e.g., rapid encryption) or by adding/removing large amounts of data. Baselining normal write frequency and data change magnitude helps distinguish legitimate use from suspicious manipulation."
    answer_sources:
      - "Mobile EDR/MDM logs (capturing file system and database modifications)"
      - "Zeek http.log"
      - "Zeek files.log"
      - "Corporate-managed mobile devices"
      - "Application servers receiving mobile data"
      - "Application data containers on mobile devices"
    range: "last 90 days"
    queries:
      - "pseudocode": "BASELINE write_frequency and file_size_delta for critical files (e.g. contacts.db) over 30 days to calculate 95th percentile | SEARCH for write events to critical files | ALERT if write_frequency or file_size_delta exceeds 95th percentile"
  - question: "Do file-write events on mobile devices exhibit characteristics that a machine learning model identifies as likely malicious?"
    context: "This question uses a machine learning model to find complex patterns of malicious file modifications that simple rule-based alerts might miss. By training on features like process name, file type, write frequency, and time of day, the model can learn a nuanced profile of malicious behavior and score new events for risk, allowing analysts to prioritize the most suspicious activities."
    answer_sources:
      - "Mobile EDR/MDM logs (capturing file system and database modifications)"
      - "Zeek http.log"
      - "Zeek files.log"
      - "Corporate-managed mobile devices"
      - "Application servers receiving mobile data"
      - "Application data containers on mobile devices"
    range: "last 90 days"
    queries:
      - "pseudocode": "TRAIN Random Forest model with features (process_name, file_extension, write_frequency, bytes_written, is_outside_sandbox, hour_of_day) | DEPLOY model to score new file-write events | ALERT if malicious probability score > 0.85"