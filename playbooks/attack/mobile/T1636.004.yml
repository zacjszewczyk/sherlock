name: "T1636.004: SMS Messages"
id: "f5c8a9e1-b2d3-4a6f-8b9c-0d1e2f3a4b5c"
description: "This playbook helps investigate whether an adversary is collecting and exfiltrating sensitive data from corporate mobile devices by accessing SMS messages. This can manifest in two primary ways: first, by a malicious mobile application with SMS read permissions sending data to an anomalous external network destination; second, by abusing mobile device synchronization software on a connected Windows host to stage and exfiltrate the collected data. The investigation focuses on identifying anomalous network traffic from mobile devices and unusual process chains originating from synchronization tools on workstations."
type: "technique"
related:
  - "TA0035: Collection"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Has a corporate mobile device communicated with a known-malicious command and control (C2) domain?"
    context: "This question aims to identify high-confidence indicators of compromise. If a mobile device, which potentially has access to SMS messages, is communicating with a domain on a C2 threat intelligence list, it strongly suggests the device is compromised and is being used for data exfiltration or further malicious activity."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Mobile Device Management (MDM) logs"
      - "Corporate Wi-Fi network egress points"
      - "VPN concentrators"
    range: "last 90 days"
    queries:
      - "pseudocode": "SEARCH DNS logs WHERE source_ip in mobile_dhcp_range AND domain in malicious_c2_feed. FOR EACH match, SEARCH connection_logs WHERE source_ip = match.source_ip AND timestamp near match.timestamp. VERIFY connection_established AND data_transferred > 0."
  - question: "Is a mobile device exfiltrating an anomalous amount of data to a rare network destination?"
    context: "This question focuses on detecting exfiltration through behavioral anomaly detection. Adversaries often exfiltrate data to destinations not typically contacted by the user or organization. By baselining normal traffic patterns (data volume, destination country/ASN) for each device, we can spot significant deviations that could indicate data theft, even if the destination is not on a known threat list."
    answer_sources:
      - "Zeek conn.log"
      - "Mobile Device Management (MDM) logs"
      - "Corporate Wi-Fi network egress points"
      - "VPN concentrators"
    range: "last 90 days"
    queries:
      - "pseudocode": "FOR EACH mobile_device_ip: CALCULATE 30-day baseline of hourly_data_volume, destination_countries, destination_asns. ALERT IF current_hourly_volume > 95th_percentile_baseline AND current_destination_country_frequency < 5% AND current_destination_asn_frequency < 5%."
  - question: "Does a mobile device's network traffic profile exhibit complex anomalies indicative of malicious activity?"
    context: "This question leverages advanced machine learning to detect subtle deviations from a device's normal network behavior. Unlike simple volumetric baselines, a time-series model can learn complex patterns across multiple features (e.g., data volume, connection timing, protocol usage, encryption details). A high reconstruction error suggests the current traffic does not match the learned 'normal' profile, which could signal sophisticated C2 communication or data exfiltration."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek ssl.log"
      - "Mobile Device Management (MDM) logs"
      - "Corporate Wi-Fi network egress points"
      - "VPN concentrators"
    range: "last 90 days"
    queries:
      - "pseudocode": "TRAIN time-series anomaly model (e.g., LSTM Autoencoder) on historical network logs (conn, dns, ssl) for each device. IN REAL-TIME, feed current traffic features into model. ALERT IF model_reconstruction_error > dynamic_threshold."
  - question: "Has a mobile device synchronization tool on a workstation spawned a suspicious child process for networking or encoding?"
    context: "This question addresses the threat of an adversary using a connected workstation as a staging point. Mobile sync tools are trusted processes, but they should not be spawning command-line utilities like PowerShell or curl to perform network transfers or data encoding. Detecting such process chains is a strong indicator that the sync tool's access to mobile data is being abused for data staging and exfiltration."
    answer_sources:
      - "Windows Event ID 4688"
      - "Employee workstations with mobile device syncing software installed"
      - "Centralized log aggregator/SIEM"
    range: "last 90 days"
    queries:
      - "pseudocode": "SEARCH process_creation_logs WHERE parent_process in ['PhoneExperienceHost.exe', 'iTunesHelper.exe'] AND child_process in ['powershell.exe', 'certutil.exe', 'bitsadmin.exe', 'curl.exe'] AND command_line contains ['-encode', 'transfer', 'http://', ...]."
  - question: "Has a mobile sync tool executed a statistically rare process chain on a workstation?"
    context: "This question uses statistical analysis to find unusual behavior without relying on predefined suspicious indicators. By baselining the normal child processes and arguments for sync tools across the enterprise, we can identify executions that are statistical outliers. A rare process chain, even if the child process isn't inherently malicious, warrants investigation as it deviates from established normal operations and could represent an adversary's novel technique."
    answer_sources:
      - "Windows Event ID 4688"
      - "Employee workstations with mobile device syncing software installed"
      - "Centralized log aggregator/SIEM"
    range: "last 90 days"
    queries:
      - "pseudocode": "CALCULATE 30-day baseline of parent-child-argument frequency for mobile_sync_tools. FOR EACH new process_creation_event, calculate rarity_score. ALERT IF rarity_score > 99th_percentile."
  - question: "Does a process chain originating from a mobile sync tool match a machine learning model's profile of malicious data staging?"
    context: "This question applies supervised machine learning to classify the intent of process activity. By training a model on known benign and malicious examples, it can learn to identify complex patterns indicative of data staging. Features like command-line entropy and the presence of encoded strings can help the model distinguish malicious commands from normal sync operations, providing a risk score to help analysts prioritize the most suspicious events."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows PowerShell Event ID 4104"
      - "Employee workstations with mobile device syncing software installed"
      - "Centralized log aggregator/SIEM"
    range: "last 90 days"
    queries:
      - "pseudocode": "TRAIN supervised classification model on labeled process_creation and powershell_script_block logs. EXTRACT features (process_names, cmd_line_entropy, etc.). IN REAL-TIME, classify new events originating from sync tools. ALERT IF classification is 'potential data staging' with a high risk_score."