name: T1632.001: Code Signing Policy Modification
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook addresses the threat of adversaries modifying device security policies to evade defenses (TA0030). It provides investigative steps to detect malicious code signing policy modifications on mobile devices, such as an Android application being granted package installation permissions when it's not on an organizational allowlist, the installation of a non-allowlisted user-added CA certificate on an Android device, or the presence of an unauthorized iOS Configuration Profile.
type: technique
related:
  - TA0030: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has the 'REQUEST_INSTALL_PACKAGES' permission been granted to an Android application not on the organizational allowlist of trusted installers?
    context: This question aims to identify unauthorized applications gaining the ability to install other packages on a managed Android device. Granting this permission to an untrusted app is a high-risk activity, as it could be a precursor to malware installation or other defense evasion techniques. Answering this helps detect direct policy violations.
    answer_sources:
      - MDM Log: ApplicationPermissionStateChange
      - MDM Asset Inventory: ApplicationList
      - Corporate-managed Android device fleet
      - MDM Management Server
      - Organizational App Store Servers
    range: Last 90 days
    queries:
      - technology: SIEM
        query: SEARCH MDM logs for 'ApplicationPermissionStateChange' where permission is 'REQUEST_INSTALL_PACKAGES' and state is 'granted'. FOREACH event, CHECK if package name is IN allowlist. ALERT if NOT IN allowlist.
  - question: Has a rare or unusual application been granted the 'REQUEST_INSTALL_PACKAGES' permission?
    context: This question seeks to identify potentially malicious installer applications by focusing on their rarity within the device fleet. Legitimate app stores and MDM-pushed installers are typically widespread. An installer application present on only a small fraction of devices (e.g., below the 5th percentile of prevalence) is statistically anomalous and warrants investigation as it could be part of a targeted attack.
    answer_sources:
      - MDM Log: ApplicationPermissionStateChange
      - MDM Asset Inventory: ApplicationList
      - Corporate-managed Android device fleet
      - MDM Management Server
      - Organizational App Store Servers
    range: Last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each app with 'REQUEST_INSTALL_PACKAGES' permission, CALCULATE fleet-wide prevalence. CALCULATE 90-day baseline prevalence for all apps. FLAG app for review if its prevalence is BELOW 5th percentile.
  - question: Can we predict if the granting of 'REQUEST_INSTALL_PACKAGES' permission is malicious based on application attributes?
    context: This question leverages machine learning to proactively identify high-risk permission grants. By training a classifier on features like app prevalence, category, source, and other requested permissions, the model can score the likelihood of a grant being malicious. A high probability score automates the detection of sophisticated threats that might not be caught by simple allowlist or prevalence checks.
    answer_sources:
      - MDM Log: ApplicationPermissionStateChange
      - MDM Asset Inventory: ApplicationList
      - Corporate-managed Android device fleet
      - MDM Management Server
      - Organizational App Store Servers
    range: Last 90 days
    queries:
      - technology: Machine Learning Pseudocode
        query: INPUT features (prevalence, category, source, permissions_count, is_managed). PREDICT probability with logistic regression model. IF probability > 0.8, GENERATE investigation ticket.
  - question: Has a user-added CA certificate been installed on an Android device that is not on the organizational allowlist?
    context: This question is designed to detect the installation of unauthorized Certificate Authorities (CAs) on managed devices. A malicious CA can be used to issue fraudulent certificates for phishing domains or to intercept and decrypt TLS-encrypted network traffic (Man-in-the-Middle attack). Verifying all user-installed CAs against a known-good allowlist is a critical defense.
    answer_sources:
      - MDM Asset Inventory: DeviceCertificateList
      - MDM Compliance Log: CertificateInstallEvent
      - Zeek ssl.log
      - Zeek x509.log
      - Corporate-managed Android device fleet
      - MDM Management Server
      - Public Key Infrastructure (PKI) Servers
      - Network Egress/Inspection Points
    range: Last 90 days
    queries:
      - technology: SIEM
        query: SEARCH MDM inventory for user-added CA certificates. FOREACH certificate, CHECK if SHA-256 thumbprint is IN allowlist. ALERT if NOT IN allowlist. PIVOT to network logs for associated TLS activity in last 24 hours.
  - question: Does a newly installed, non-allowlisted CA certificate exhibit characteristics of a targeted attack, such as high randomness in its name and low fleet-wide prevalence?
    context: This question provides a method for risk-scoring unauthorized CA certificates. Adversaries often use randomly generated strings for certificate fields (Subject/Issuer) to avoid using identifiable information, resulting in high entropy. When combined with low installation prevalence, it strongly suggests the certificate is not a common, widely distributed one but rather a tool for a targeted attack.
    answer_sources:
      - MDM Asset Inventory: DeviceCertificateList
      - MDM Compliance Log: CertificateInstallEvent
      - Zeek ssl.log
      - Zeek x509.log
      - Corporate-managed Android device fleet
      - MDM Management Server
      - Public Key Infrastructure (PKI) Servers
      - Network Egress/Inspection Points
    range: Last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each non-allowlisted CA, CALCULATE Shannon entropy of Subject/Issuer DN. CALCULATE fleet-wide prevalence. ESCALATE if entropy > 4.0 AND prevalence < 1%.
  - question: Can an anomaly detection model identify suspicious CA certificates based on their metadata?
    context: This question uses an unsupervised machine learning model (Isolation Forest) to find outliers in certificate metadata. The model learns the properties of normal, approved certificates (e.g., validity period, key size, string lengths). Certificates that deviate significantly from this learned norm are flagged as anomalies, providing a powerful way to detect novel or unusual malicious certificates that might not have other obvious indicators.
    answer_sources:
      - MDM Asset Inventory: DeviceCertificateList
      - MDM Compliance Log: CertificateInstallEvent
      - Zeek ssl.log
      - Zeek x509.log
      - Corporate-managed Android device fleet
      - MDM Management Server
      - Public Key Infrastructure (PKI) Servers
      - Network Egress/Inspection Points
    range: Last 90 days
    queries:
      - technology: Machine Learning Pseudocode
        query: INPUT certificate features (validity, key_algorithm, key_size, subject_length, etc.). COMPUTE anomaly score with Isolation Forest model. REQUIRE manual review if score is in top 1%.
  - question: Is an unauthorized iOS Configuration Profile installed on a managed device?
    context: This question aims to detect the installation of malicious or unapproved configuration profiles on iOS devices. These profiles can be used to alter security settings, install root certificates, configure VPNs to intercept traffic, or deploy malicious payloads. Verifying that all installed profiles have an identifier matching an allowlist for that device's group is a fundamental security check.
    answer_sources:
      - MDM Asset Inventory: DeviceProfileList
      - MDM Compliance Log: ProfileInstallEvent
      - Zeek http.log
      - Zeek files.log
      - Corporate-managed iOS device fleet
      - MDM Management Server
      - Apple Push Notification service (APNs) infrastructure
      - Network Egress/Inspection Points
    range: Last 90 days
    queries:
      - technology: SIEM
        query: SEARCH MDM inventory for installed iOS profiles. FOREACH profile, CHECK if PayloadIdentifier is IN allowlist for device's group. ALERT if NOT IN allowlist. CORRELATE device IP with network logs to find download source.
  - question: Was an iOS Configuration Profile installed at a statistically anomalous time, such as outside of normal business hours?
    context: This question seeks to identify suspicious profile installations by analyzing their timing. Most legitimate administrative actions, like deploying profiles, occur during standard business hours. An installation that happens at a highly unusual time (e.g., late at night or on a weekend), as identified by a statistical outlier test like a Z-score, could indicate automated malicious activity or an attacker operating in a different time zone.
    answer_sources:
      - MDM Asset Inventory: DeviceProfileList
      - MDM Compliance Log: ProfileInstallEvent
      - Zeek http.log
      - Zeek files.log
      - Corporate-managed iOS device fleet
      - MDM Management Server
      - Apple Push Notification service (APNs) infrastructure
      - Network Egress/Inspection Points
    range: Last 90 days
    queries:
      - technology: Statistical Pseudocode
        query: FOR each profile installation, CALCULATE baseline of installation counts per hour over 90 days. COMPUTE modified Z-score for the installation's timestamp. FLAG for review if Z-score > 3.5.
  - question: Has there been a sudden, anomalous spike in the number of iOS Configuration Profile installations across the fleet?
    context: This question is designed to detect large-scale or widespread campaigns involving the deployment of malicious configuration profiles. A time-series model can learn the normal rhythm of profile installations and flag any sudden, unexpected surge as an anomaly. If this spike does not correspond to a planned IT activity, it is a strong indicator of a coordinated attack and requires an immediate, fleet-wide incident response.
    answer_sources:
      - MDM Asset Inventory: DeviceProfileList
      - MDM Compliance Log: ProfileInstallEvent
      - Zeek http.log
      - Zeek files.log
      - Corporate-managed iOS device fleet
      - MDM Management Server
      - Apple Push Notification service (APNs) infrastructure
      - Network Egress/Inspection Points
    range: Last 90 days
    queries:
      - technology: Time-Series ML Pseudocode
        query: AGGREGATE profile installations per hour. USE time-series model (e.g., ARIMA) to detect anomalous spikes. IF anomaly detected, CHECK against change management database. TRIGGER high-severity alert if no corresponding change request.