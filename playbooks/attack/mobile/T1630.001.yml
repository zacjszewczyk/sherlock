name: T1630.001: Uninstall Malicious Application
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps identify if an adversary is attempting to remove their tools, such as a malicious application, from a compromised mobile device to evade detection. This is often observed through the sudden cessation of stable beaconing network traffic without a corresponding device power-off event, an application uninstall event in MDM logs that does not have an approved IT change request, or evidence of a rooting toolkit being used shortly before command-and-control (C2) communications stop.
type: technique
related:
- TA0030: Defense Evasion
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Is a mobile device communicating with a known command and control (C2) server?
  context: This question aims to detect initial C2 communication by cross-referencing network connection and DNS logs with a threat intelligence feed of known malicious servers. Identifying this communication is a primary indicator of a potential compromise and a prerequisite for detecting the later cessation of that communication.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Threat Intelligence Feed of known C2 servers
  - Centralized SIEM/log aggregator
  - corporate Wi-Fi access points
  - VPN concentrators
  - DNS resolvers servicing mobile devices.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH Zeek conn.log OR Zeek dns.log
      JOIN source_ip OR dns_query WITH threat_intel_c2_list
      WHERE source_is_mobile_device_ip AND destination_ip_is_c2 OR query_is_c2_domain
      ALERT
- question: Has a previously stable beaconing pattern from a mobile device unexpectedly stopped?
  context: This question attempts to identify the cessation of beaconing activity, which could indicate tool removal. It establishes a baseline of normal beaconing behavior (low variance in connection timing and data size) and alerts when a connection is overdue without a legitimate reason, such as the device being recorded as offline in MDM logs.
  answer_sources:
  - Zeek conn.log
  - Mobile Device Management (MDM) Device Status Logs
  - Centralized SIEM/log aggregator
  - corporate Wi-Fi access points
  - VPN concentrators
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each device_ip in Zeek conn.log over 24h:
        CALCULATE coefficient_of_variation(connection_interval) AND coefficient_of_variation(bytes_sent)
        IF cv < 0.2, IDENTIFY as beacon
        CALCULATE mean_interval and std_dev_interval for beacon
        IF time_since_last_beacon > (mean_interval + 3 * std_dev_interval):
          CHECK MDM logs for device_offline_event for device_ip in same timeframe
          IF no_offline_event, ALERT 'Beacon Cessation'
- question: Does a mobile device's network activity show a statistically significant drop to zero, indicative of beacon cessation, when analyzed by a time series model?
  context: This question uses a more advanced, model-based approach to detect beacon cessation. A time series model (like Prophet or LSTM) learns a device's normal traffic patterns and can more accurately identify when a drop to zero activity is a true anomaly versus random fluctuation, reducing false positives.
  answer_sources:
  - Zeek conn.log
  - Centralized SIEM/log aggregator
  - corporate Wi-Fi access points
  - VPN concentrators
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each device_ip with beaconing_behavior:
        TRAIN time_series_model on historical_connection_frequency and historical_bytes_sent
        FORECAST expected_activity with 99.9% prediction_interval
        IF observed_activity drops to 0 AND remains outside prediction_interval for > 3 * expected_beacon_interval:
          ALERT 'Beacon Cessation Anomaly'
- question: Has an application been uninstalled from a mobile device without an authorized change request?
  context: This question directly checks for unauthorized software removal. By correlating MDM uninstall events with ITSM change tickets, it can quickly flag uninstalls that did not go through the proper approval process, which is a strong indicator of suspicious activity.
  answer_sources:
  - MDM Platform Audit Logs
  - IT Service Management (ITSM) System Logs
  - Cloud or on-premise servers hosting the MDM and ITSM platforms
  - The centralized SIEM where their logs are aggregated.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      ON MDM log event_type = 'ApplicationUninstalled':
        EXTRACT device_id, application_name
        QUERY ITSM API for approved_change_request WHERE device=device_id AND application=application_name in last 24h
        IF no_results_returned:
          ALERT 'Unauthorized Uninstall'
- question: Is a specific mobile device exhibiting an unusually high frequency of unauthorized application uninstalls compared to its own baseline?
  context: This question looks for patterns of abuse on a per-device basis. A single unauthorized uninstall might be a user error, but a sudden spike in such events for one device suggests a more deliberate, possibly malicious, effort to remove multiple tools or evade detection.
  answer_sources:
  - MDM Platform Audit Logs
  - IT Service Management (ITSM) System Logs
  - Centralized SIEM/log aggregator
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each device_id:
        CALCULATE 30-day rolling_mean and rolling_std_dev of 'Unauthorized Uninstall' alerts
        COUNT daily 'Unauthorized Uninstall' alerts per device_id
        IF daily_count > (rolling_mean + 3 * rolling_std_dev):
          ALERT 'Suspicious Uninstall Activity'
- question: Can a machine learning model predict with high confidence that a new unauthorized uninstall event is malicious based on its characteristics?
  context: This question uses a predictive model to score the risk of an uninstall event. By training on historical data and features like the application's category, install source (e.g., App Store vs. Sideloaded), and time of day, the model can provide a confidence score, helping analysts prioritize the most likely malicious events.
  answer_sources:
  - MDM Platform Audit Logs
  - IT Service Management (ITSM) System Logs
  - Centralized SIEM/log aggregator
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      TRAIN classification_model on labeled_uninstalls with features (app_category, install_source, time_of_day)
      ON new 'Unauthorized Uninstall' event:
        APPLY model to event_features
        IF model_prediction_probability('unauthorized') > 0.95:
          ALERT 'High-Confidence Malicious Uninstall'
- question: Has a device exhibited rooting behavior shortly before a C2 beacon ceased, suggesting a clean-up attempt after compromise?
  context: This question correlates two distinct malicious events in a specific sequence. An adversary might use a rooting toolkit to gain elevated privileges and then, after achieving their objective, remove their C2 implant. Detecting this sequence (rooting IOC followed by beacon cessation) provides strong, contextual evidence of defense evasion.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Threat Intelligence Platform Feeds
  - Network egress points
  - corporate DNS resolvers
  - The Threat Intelligence Platform (TIP) integrated with the SIEM.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      CREATE correlation_rule TRIGGER on 'Rooting Toolkit IOC' alert
      WITHIN 60 minutes FOR same device_id:
        LOOK FOR 'Beacon Cessation' alert
        IF found:
          ALERT 'Malicious Uninstall Sequence Detected'
- question: Following a rooting IOC alert, did a beacon cessation alert occur with a statistically unusual speed, indicating a rapid, automated clean-up?
  context: This question adds a statistical dimension to the previous one by analyzing the timing between alerts to find outliers. If a beacon stops almost immediately after a rooting IOC is detected, and this timing is much faster than typical inter-alert delays for that device, it strengthens the hypothesis that the two events are part of a single, automated malicious action.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Threat Intelligence Platform Feeds
  - Centralized SIEM/log aggregator
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each device_class (e.g., iOS, Android):
        CALCULATE distribution of time_delays between all security alerts
      ON 'Rooting Toolkit IOC' alert for a device:
        MEASURE time_delay to next 'Beacon Cessation' alert
        IF time_delay is in bottom 1st percentile of distribution:
          ESCALATE alert to 'Critical: Rapid Uninstall Sequence'
- question: Does a sequence analysis model identify a high-probability transition from a 'Rooting IOC' state to a 'Beacon Cessation' state for a given device?
  context: This is an advanced form of sequence analysis. A Hidden Markov Model (HMM) or similar model can learn the probabilities of transitioning between different alert states. If the model determines that the sequence 'Rooting_IOC_Alert -> Beacon_Cessation_Alert' is a high-probability path for a device's activity, it provides a very strong, model-backed signal of a malicious uninstall chain.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Threat Intelligence Platform Feeds
  - Centralized SIEM/log aggregator
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      TRAIN HMM on historical alert streams per device to learn state transition probabilities
      DEFINE state_transition as (Rooting_IOC_Alert -> Beacon_Cessation_Alert)
      ON new alert stream for a device:
        CALCULATE probability of state_transition
        IF probability > 0.90:
          ALERT 'High-Confidence Malicious Uninstall Chain'