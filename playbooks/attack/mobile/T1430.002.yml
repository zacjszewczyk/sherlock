name: "T1430.002: Impersonate SS7 Nodes"
id: "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
description: "This playbook helps investigate whether an adversary is attempting to discover subscriber locations or actively collect location data by impersonating Signalling System 7 (SS7) nodes. The investigation focuses on identifying SS7 Mobile Application Part (MAP) location queries originating from external Global Titles (GTs) that are not on an approved roaming partner whitelist. It also looks for signs of large-scale scanning, such as a single GT querying for an abnormally high number of unique subscribers, and targeted tracking, indicated by repeated queries for a single subscriber in a short time frame. Finally, it seeks to confirm successful data exfiltration by correlating inbound queries with successful outbound acknowledgment messages sent to non-whitelisted destinations."
type: "technique"
related:
  - "TA0032: Discovery"
  - "TA0035: Collection"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: "1.0"
tags: "none"
questions:
  - question: "Are we receiving SS7 location queries from Global Titles not on our approved roaming partner whitelist?"
    context: "This question aims to identify the most direct evidence of SS7 node impersonation. Legitimate roaming partners communicate from known Global Titles (GTs) that should be on a whitelist. A location query (like SRI-SM or PSI) from a source GT not on this list is a high-fidelity indicator of a potential adversary trying to discover subscriber locations."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways), subscriber databases (HLR/HSS), and network security monitoring platforms."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "SEARCH SGW_map_transactions.log WHERE (OpCode IN [45, 70]) AND source_gt NOT IN (roaming_partner_gt_whitelist.csv) | JOIN with HLR_query_logs"
  - question: "Are any source Global Titles sending an anomalously high ratio of location queries compared to other message types?"
    context: "Adversaries focused on location discovery will likely send a higher proportion of location-related queries compared to legitimate partners who engage in a wider variety of signaling. By baselining normal traffic patterns and looking for statistical outliers, we can uncover suspicious GTs, including potentially compromised but otherwise legitimate partner nodes."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways), subscriber databases (HLR/HSS), and network security monitoring platforms."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "CALCULATE ratio = (count of location queries) / (count of all queries) per source_gt over 24h | COMPARE ratio to 99th percentile of 30-day baseline for legitimate partners | ALERT if ratio > baseline_threshold"
  - question: "Can we use machine learning to proactively identify and score suspicious SS7 transactions indicative of node impersonation?"
    context: "This question moves beyond simple rule-based detection to a more sophisticated, behavioral approach. A machine learning model can learn the subtle, multi-dimensional patterns of both legitimate and malicious SS7 traffic (e.g., time of day, country of origin, query frequency). This allows for the detection of novel or complex attack patterns that might evade static rules."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways), subscriber databases (HLR/HSS), and network security monitoring platforms."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "SCORE SS7 transactions using trained classification model | ALERT on transactions with confidence_score > 0.90, especially from non-whitelisted GTs"
  - question: "Is any single external Global Title conducting large-scale scanning for our subscribers?"
    context: "This question seeks to detect brute-force discovery attempts. A legitimate roaming partner typically queries for subscribers with whom they have a roaming relationship. An adversary, however, might perform a large-scale scan, querying hundreds or thousands of subscriber identifiers (MSISDNs) in a short time to map out a network's user base. A hard threshold (e.g., 500 unique MSISDNs in an hour) provides a clear signal of this activity."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways) and subscriber databases (HLR/HSS)."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "COUNT unique MSISDNs per source_gt over 1-hour window | ALERT if unique_msisdn_count > 500"
  - question: "Are any source Global Titles showing a statistically significant spike in the number of unique subscribers they are querying?"
    context: "This question provides a more dynamic and tailored approach than a fixed threshold. By calculating a Z-score, we compare a GT's current activity against its own historical baseline. A high Z-score (e.g., >3.0) indicates that the GT is behaving abnormally for itself, which can detect scanning activity from even normally low-volume sources or compromised partners."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways) and subscriber databases (HLR/HSS)."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "FOR each source_gt: CALCULATE hourly unique MSISDN count (x) | CALCULATE 30-day rolling average (mu) and standard deviation (sigma) | CALCULATE Z-score = (x - mu) / sigma | ALERT if Z-score > 3.0"
  - question: "Can we use clustering algorithms to identify outlier Global Titles whose query behavior does not match any known profile of legitimate activity?"
    context: "This question uses an unsupervised machine learning approach to find anomalies. Clustering algorithms like DBSCAN group similar data points together. By defining 'similarity' based on features like query volume and type, legitimate roaming partners will form dense clusters. GTs that fall outside these clusters (i.e., 'noise' or 'outliers') represent anomalous behavior that warrants investigation, as they are not behaving like typical partners."
    answer_sources:
      - "SGW_map_transactions.log"
      - "HLR_query_logs"
      - "Core network infrastructure, specifically the SS7 signaling plane interfaces (Signaling Gateways) and subscriber databases (HLR/HSS)."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "APPLY DBSCAN clustering on feature set (source_gt, unique_msisdn_count, query_ratio) | INVESTIGATE GTs classified as noise/outliers"
  - question: "Is any single subscriber being repeatedly queried for their location by an unapproved external entity in a short time frame?"
    context: "This question focuses on detecting targeted tracking of an individual. While a single location query might be incidental, multiple queries for the same subscriber (MSISDN) from the same unapproved source (GT) in a short period (e.g., 15 minutes) strongly suggests a deliberate attempt to monitor that person's movements. This is a significant indicator of active collection."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "VLR_event_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Subscriber location databases (HLR/HSS, VLR) and the signaling gateways (SGW) that route queries to them."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "GROUP HLR logs by MSISDN and source_gt | COUNT location queries within 15-minute window | ALERT if count >= 3 AND source_gt is not whitelisted"
  - question: "Are there subscribers whose location queries are dominated by a single, potentially malicious, source Global Title?"
    context: "This question uses information theory to identify potential targeting. Normally, a subscriber's location might be queried by several different legitimate partner networks over time, resulting in higher entropy. If one source GT is responsible for almost all queries for a specific subscriber, the entropy will be very low (approaching zero). This indicates a lack of diversity in query sources and can be a subtle sign that a single entity is fixated on that subscriber."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "VLR_event_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Subscriber location databases (HLR/HSS, VLR) and the signaling gateways (SGW) that route queries to them."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "FOR each MSISDN: CALCULATE Shannon entropy of source GTs over 24h | FLAG MSISDNs with entropy in the bottom 5th percentile"
  - question: "Can a sequence-aware machine learning model detect anomalous patterns of SS7 events that indicate subscriber tracking?"
    context: "This question addresses the temporal aspect of tracking. An adversary's actions might form a specific sequence (e.g., repeated location queries without any follow-up call or SMS activity). RNNs and LSTMs are designed to recognize patterns in sequential data. By training a model on normal subscriber event sequences, it can learn to flag abnormal sequences that suggest tracking, providing a more context-aware detection method."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "VLR_event_logs"
      - "roaming_partner_gt_whitelist.csv"
      - "Subscriber location databases (HLR/HSS, VLR) and the signaling gateways (SGW) that route queries to them."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "FEED sequences of SS7 events per MSISDN into RNN/LSTM model | INVESTIGATE MSISDNs with sequences flagged as 'anomalous tracking pattern'"
  - question: "Are we successfully sending subscriber location data to unapproved external Global Titles?"
    context: "This is a critical question to confirm successful data exfiltration. It's not enough for an adversary to ask for data; they must receive it. This query correlates the inbound request with the outbound, successful response. If a successful acknowledgment containing location data is sent to a non-whitelisted GT, it confirms that a breach of location privacy has occurred."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "roaming_partner_gt_whitelist.csv"
      - "Egress points of the core network's signaling plane, specifically the Signaling Gateways (SGWs) responsible for forwarding responses to external networks."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "CORRELATE inbound query with outbound response via transaction ID | ALERT if response is successful AND destination_gt is not whitelisted"
  - question: "Do any non-whitelisted Global Titles have an unusually high success rate for their location queries?"
    context: "This question seeks to identify adversaries who have found a weakness and are exploiting it effectively. A very high success rate (e.g., >90%) for location queries from an unapproved source is highly suspicious. Comparing this rate to the baseline for legitimate partners helps to confirm the anomaly. It suggests the adversary is not just blindly probing but has found a reliable method to exfiltrate location data."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "roaming_partner_gt_whitelist.csv"
      - "Egress points of the core network's signaling plane, specifically the Signaling Gateways (SGWs) responsible for forwarding responses to external networks."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "FOR each non-whitelisted GT: CALCULATE success_rate = (successful responses / total queries) per hour | ALERT if success_rate > 90% AND success_rate > 95th percentile of legitimate partner baseline"
  - question: "Can we use graph analysis to identify external nodes that are acting as central hubs for collecting our subscriber location data?"
    context: "This question applies graph theory to visualize and analyze network-wide collection activity. By representing GTs and subscribers as nodes and successful queries as links, an adversary's GT will appear as a 'high-centrality collector'—a node with an unusually high number of connections to subscriber nodes. This provides a powerful, visual way to identify the scope and focus of a large-scale data collection campaign."
    answer_sources:
      - "HLR_query_logs"
      - "SGW_map_transactions.log"
      - "roaming_partner_gt_whitelist.csv"
      - "Egress points of the core network's signaling plane, specifically the Signaling Gateways (SGWs) responsible for forwarding responses to external networks."
    range: "last 90 days"
    queries:
      - technology: "Pseudocode"
        query: "MODEL SS7 network as a graph (nodes=GTs/MSISDNs, edges=successful queries) | USE graph anomaly detection to find non-whitelisted GTs with high centrality | FLAG high-centrality collector nodes"