name: T1512: Video Capture
id: f8a1b2c3-d4e5-4f6a-b7c8-d9e0f1a2b3c4
description: >
  This playbook helps determine if an adversary is using a compromised mobile device's camera to collect video or images. It focuses on identifying suspicious applications with camera permissions, anomalous outbound network traffic indicative of media exfiltration, and non-user-initiated camera API calls. Evidence includes applications with camera access that are not on corporate allow-lists or are statistical outliers in their category; significant spikes in outbound data volume to suspicious domains; and EDR telemetry showing camera activation while an app is in the background or without a corresponding user input event.
type: technique
related:
  - TA0035: Collection
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are there any mobile applications with camera permissions that are not on the corporate allow-list?
    context: >
      This question aims to identify potentially unauthorized or malicious applications that have been granted access to the device's camera. By comparing installed applications against a curated allow-list of approved software and developers, security teams can quickly flag suspicious apps that might be used for unauthorized video capture. An app that is not on the official list and has camera access warrants investigation.
    answer_sources:
      - Mobile Device Management (MDM) application inventory logs
      - App vetting platform scan results
      - Managed corporate mobile devices, Corporate application store, Mobile Application Management (MAM) console
    range: last 90 days
    queries:
      - pseudocode: SEARCH MDM logs FOR apps with camera permissions WHERE app_signature NOT IN (allow_list) OR app_package NOT IN (allow_list)
  - question: Are any applications requesting camera permissions in a functional category where such access is statistically rare?
    context: >
      This question helps detect outliers and suspicious behavior by analyzing permission requests within the context of an application's category. For example, a calculator app requesting camera access is highly unusual. Identifying apps that deviate from the norm for their category can uncover malware masquerading as a legitimate application.
    answer_sources:
      - Mobile Device Management (MDM) application inventory logs
      - App vetting platform scan results
      - Managed corporate mobile devices, Corporate application store, Mobile Application Management (MAM) console
    range: last 90 days
    queries:
      - pseudocode: FROM MDM logs, GROUP apps by category, CALCULATE camera_permission_prevalence. ALERT IF app has camera_permission AND its category_prevalence < 5th_percentile
  - question: Has a machine learning model identified any new or updated applications as likely malicious based on their attributes and permissions?
    context: >
      This question leverages a predictive model to proactively identify high-risk applications. By training a model on features like permissions, developer reputation, and market presence, it can automatically score applications and flag those that exhibit characteristics of malware. A high-confidence 'malicious' prediction necessitates immediate, in-depth analysis, such as reverse engineering, to confirm the threat.
    answer_sources:
      - Mobile Device Management (MDM) application inventory logs
      - App vetting platform scan results
      - Managed corporate mobile devices, Corporate application store, Mobile Application Management (MAM) console
    range: last 90 days
    queries:
      - pseudocode: FOR new/updated apps, PREDICT maliciousness using classification_model. ALERT IF prediction is 'malicious' AND confidence_score > 0.85
  - question: Is any mobile device sending video or image files to a known command-and-control (C2) server?
    context: >
      This question directly hunts for data exfiltration to known malicious infrastructure. By correlating network connection logs with file transfer logs and threat intelligence, analysts can detect the classic pattern of an infected device sending captured media (video/images) to an attacker-controlled server. The combination of a known bad destination, a high volume of outbound data, and the specific file types creates a high-fidelity indicator of compromise.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek files.log
      - Network egress points for corporate Wi-Fi, VPN concentrators, and cellular data gateways
    range: last 90 days
    queries:
      - pseudocode: SEARCH Zeek logs WHERE source is mobile_ip_range AND dest_ip IN (threat_intel_feed) AND orig_bytes > 10 * resp_bytes AND file_mime_type is 'video/*' or 'image/*'
  - question: Has any mobile device exhibited a significant anomaly in its daily outbound data volume, especially to a suspicious or newly registered domain?
    context: >
      This question focuses on detecting anomalous data exfiltration without relying solely on known bad indicators. By establishing a baseline of normal network behavior for each device, any significant spike in outbound traffic can be flagged. Correlating this spike with suspicious domain characteristics—such as high entropy (suggesting a domain generation algorithm) or recent registration—strengthens the hypothesis that the traffic is malicious and not just a benign large file transfer.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek files.log
      - Network egress points for corporate Wi-Fi, VPN concentrators, and cellular data gateways
    range: last 90 days
    queries:
      - pseudocode: FOR each mobile_device, BASELINE daily_outbound_bytes. ALERT IF daily_outbound_bytes > 99th_percentile. ENRICH alert with domain_entropy and domain_registration_age
  - question: Are machine learning models detecting anomalous network traffic patterns, such as unseasonal spikes in data volume or connections to previously unknown infrastructure clusters?
    context: >
      This question uses advanced analytics to find unknown threats. Time-series analysis can detect subtle deviations from established daily and weekly traffic patterns that simple thresholding might miss. Concurrently, clustering algorithms can group network connections across the entire mobile fleet, revealing small groups of devices communicating with the same unknown destination. These clusters may represent a new C2 infrastructure not yet present in threat intelligence feeds.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek files.log
      - Network egress points for corporate Wi-Fi, VPN concentrators, and cellular data gateways
    range: last 90 days
    queries:
      - pseudocode: (1) APPLY time-series model to hourly_outbound_bytes, ALERT on anomalies. (2) CLUSTER connection_metadata, ALERT on small, dense clusters connecting to non-sanctioned services.
  - question: Did any application activate the camera while it was running in the background?
    context: >
      This question seeks to identify a key indicator of spyware: non-interactive camera usage. Legitimate applications typically access the camera only when they are in the foreground and the user is actively interacting with them. An application activating the camera shortly after being moved to the background is highly suspicious and could indicate it is secretly recording or taking pictures without the user's knowledge.
    answer_sources:
      - Mobile EDR logs
      - OS-level API call logs
      - Application lifecycle event logs
      - High-value target mobile devices (e.g., executive leadership, system administrators) with EDR agents installed
    range: last 90 days
    queries:
      - pseudocode: SEARCH EDR logs WHERE event is 'camera_api_call' AND process_id had 'app_in_background' event within last 60s AND app NOT IN (exception_list)
  - question: Did any application activate the camera without a preceding user interaction, based on its own behavioral baseline?
    context: >
      This question uses behavioral baselining to detect anomalous camera activation on a per-application basis. By learning the normal time delay between a user's tap and the camera turning on for a specific app (like a camera or social media app), the system can flag instances where the camera activates without a recent user input. This is a powerful method to detect when an attacker triggers the camera remotely or when a malicious function runs on a timer.
    answer_sources:
      - Mobile EDR logs
      - OS-level API call logs
      - Application lifecycle event logs
      - High-value target mobile devices (e.g., executive leadership, system administrators) with EDR agents installed
    range: last 90 days
    queries:
      - pseudocode: FOR each app, BASELINE time_delta between 'touch_event' and 'camera_api_call'. ALERT IF new 'camera_api_call' has time_delta > 99.9th_percentile for that app.
  - question: Has a sequence-based machine learning model detected an improbable series of application events, such as the camera activating directly from a background state?
    context: >
      This question employs a sophisticated state-based model to understand the 'grammar' of normal application behavior. A Hidden Markov Model can learn the valid sequences of events (e.g., app launch -> UI active -> camera button tap -> camera API call). An observed sequence that has a very low probability under this model, such as an app in the background directly calling the camera API, represents a significant anomaly that is highly indicative of malicious activity.
    answer_sources:
      - Mobile EDR logs
      - OS-level API call logs
      - Application lifecycle event logs
      - High-value target mobile devices (e.g., executive leadership, system administrators) with EDR agents installed
    range: last 90 days
    queries:
      - pseudocode: MODEL normal event sequences with HMM. FOR real-time event sequences, CALCULATE log-likelihood. ALERT IF likelihood is very low, especially for 'background' -> 'camera_active' transitions.