name: "T1642: Endpoint Denial of Service"
id: "f4a5b6c7-d8e9-4f0a-b1c2-d3e4f5a6b7c8"
description: "This playbook helps determine if an adversary has performed an Endpoint Denial of Service (DoS) attack against a mobile device. It focuses on detecting anomalous network behavior and high-risk endpoint configuration changes. Indicators include connections to known malicious infrastructure (e.g., mobile malware C2), bursts of DGA-like DNS queries followed by network silence, connections to rooting/jailbreaking sites, the use of rare User-Agent strings, and MDM alerts for unauthorized administrator privilege grants or suspicious profile installations. The goal is to identify compromised devices that may be disabled or used as part of a broader attack."
type: "technique"
related:
  - "TA0034: Impact"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: "1.0"
tags: "none"
questions:
  - question: "Has a managed mobile device connected to an IP or domain known for mobile malware with Endpoint DoS capabilities?"
    context: "This question aims to detect direct communication with known malicious infrastructure. By correlating threat intelligence matches with actual network connection logs, analysts can identify compromised devices that are part of a botnet or under the control of an attacker capable of launching a DoS attack."
    answer_sources:
      - "Zeek intel.log"
      - "Zeek conn.log"
      - "MDM Logs"
      - "Corporate and Guest Wi-Fi network gateways, VPN concentrators, DNS resolvers, Mobile Device Management (MDM) platform."
    range: "last 90 days"
    queries:
      - "pseudocode: SEARCH Zeek intel.log AND conn.log WHERE intel.uid = conn.uid AND conn.source_ip IN mobile_ip_range AND intel.source_tag IN ('mobile_malware', 'KeyRaider', 'T1642')"
  - question: "Has a mobile device initiated a connection to a new or historically anomalous Autonomous System (AS), especially one with a poor reputation?"
    context: "This question detects deviations from normal network behavior. Mobile devices typically connect to a predictable set of ASNs. A connection to a new, previously unseen ASN, particularly one with a bad reputation or involving an unusually high connection frequency, can indicate communication with a new C2 server or malicious infrastructure."
    answer_sources:
      - "Zeek intel.log"
      - "Zeek conn.log"
      - "MDM Logs"
      - "Corporate and Guest Wi-Fi network gateways, VPN concentrators, DNS resolvers, Mobile Device Management (MDM) platform."
    range: "last 30 days"
    queries:
      - "pseudocode: COMPARE conn.log destination_asn FOR device_ip OVER past_30_days. IF new_asn FOUND, ENRICH asn_reputation. IF reputation is malicious OR connection_count > 99th_percentile_for_peer_group, ALERT."
  - question: "Does a mobile device's network connection exhibit a high-risk score based on a machine learning model, suggesting malicious activity?"
    context: "This question leverages machine learning to identify subtle patterns of maliciousness that rule-based detections might miss. By analyzing multiple features of a connection in real-time (duration, protocol, bytes transferred, reputation, etc.), a model can score the likelihood of a connection being part of a DoS attack, triggering an automated response for sustained high-risk activity."
    answer_sources:
      - "Zeek intel.log"
      - "Zeek conn.log"
      - "MDM Logs"
      - "Corporate and Guest Wi-Fi network gateways, VPN concentrators, DNS resolvers, Mobile Device Management (MDM) platform."
    range: "last 90 days"
    queries:
      - "pseudocode: FOR EACH connection FROM mobile_ip, CALCULATE risk_score using ML_model(features). IF risk_score > 0.9 FOR 3+ consecutive_connections, TRIGGER SOAR_playbook(device_ip)."
  - question: "Has a mobile device attempted to resolve a very recently registered domain and then subsequently ceased all network activity?"
    context: "This question looks for a two-stage indicator of compromise. Attackers often use newly registered domains for C2. A device connecting to one and then going silent could mean a malicious command was received that disabled the device's networking or bricked it entirely, which is a form of DoS."
    answer_sources:
      - "Zeek dns.log"
      - "Zeek conn.log"
      - "Internal DNS resolvers, network traffic monitoring points at internet gateways."
    range: "last 90 days"
    queries:
      - "pseudocode: SEARCH dns.log FOR query_to_domain_registered_within_3_days. IF found, CHECK conn.log FOR no_activity FROM source_ip for next_15_minutes. IF true, ALERT."
  - question: "Is a mobile device generating a high volume of random-looking DNS queries (indicative of DGA) followed by an abnormally long period of network inactivity?"
    context: "This question identifies Domain Generation Algorithm (DGA) behavior, a common technique for malware to find its C2 server. A burst of high-entropy DNS queries followed by an unusual period of silence for that specific device suggests the device may have found its C2, received a payload or command, and then been taken offline as part of a DoS attack."
    answer_sources:
      - "Zeek dns.log"
      - "Zeek conn.log"
      - "Internal DNS resolvers, network traffic monitoring points at internet gateways."
    range: "last 90 days"
    queries:
      - "pseudocode: STREAM dns.log. IF count(high_entropy_queries) > 5 in 5_mins for mobile_ip, FLAG 'Potential DGA'. THEN, CHECK conn.log for time_since_last_connection > 95th_percentile_for_device. IF true, ALERT."
  - question: "Has a mobile device's network traffic pattern deviated significantly from its normal baseline, specifically by dropping to zero after potential DGA activity?"
    context: "This question uses advanced anomaly detection to spot significant changes in a device's network behavior. A sudden drop to zero activity is a major anomaly. When this occurs shortly after the device was flagged for potential DGA activity, it provides a very strong signal that the device has been disabled as part of an attack."
    answer_sources:
      - "Zeek dns.log"
      - "Zeek conn.log"
      - "Internal DNS resolvers, network traffic monitoring points at internet gateways."
    range: "last 90 days"
    queries:
      - "pseudocode: FOR EACH mobile_ip, MONITOR timeseries_network_metrics. IF reconstruction_error > threshold (anomaly), CHECK for 'Potential DGA' flag in last 30_mins AND current_activity is zero. IF true, ELEVATE_ALERT."
  - question: "Has a managed mobile device connected to a domain or IP known to be associated with rooting or jailbreaking tools?"
    context: "This question aims to detect attempts to compromise the device's security at the OS level. Rooting or jailbreaking a device bypasses built-in security controls, making it much easier for an attacker to install malware, gain persistence, and execute a DoS attack. Detecting connections to sites that facilitate this is an early warning sign."
    answer_sources:
      - "Zeek dns.log"
      - "Zeek http.log"
      - "Zeek intel.log"
      - "MDM Logs"
      - "Corporate Wi-Fi access points, VPN concentrators, web proxies, Mobile Device Management (MDM) platform."
    range: "last 90 days"
    queries:
      - "pseudocode: SEARCH intel.log where source_ip IN mobile_ip_range AND intel.source_tag = 'rooting_jailbreaking_site'. IF match, TRIGGER MDM_API_query for device_compliance_status."
  - question: "Is a mobile device reporting a User-Agent string that is statistically rare among its peers?"
    context: "This question identifies outliers based on the software they are running. A rare User-Agent can indicate the use of a non-standard browser, a custom application, or malware trying to impersonate a legitimate client. These are often associated with compromised or jailbroken devices, which are at higher risk for DoS."
    answer_sources:
      - "Zeek dns.log"
      - "Zeek http.log"
      - "Zeek intel.log"
      - "MDM Logs"
      - "Corporate Wi-Fi access points, VPN concentrators, web proxies, Mobile Device Management (MDM) platform."
    range: "last 90 days"
    queries:
      - "pseudocode: CALCULATE frequency of each user_agent per OS_group. IF device_user_agent_frequency < 1%, ALERT 'Rare User-Agent'."
  - question: "Does a mobile device exhibit anomalous network behavior that causes it to be classified as an outlier when compared to its peers?"
    context: "This question uses unsupervised machine learning to find devices that 'don't fit in.' By clustering devices based on a wide range of network behaviors (ports, protocols, data volume, etc.), devices that are outliers (noise) can be identified. These anomalous devices can then be cross-referenced with MDM data to see if they are non-compliant (e.g., jailbroken), indicating a high-risk state."
    answer_sources:
      - "Zeek dns.log"
      - "Zeek http.log"
      - "Zeek intel.log"
      - "MDM Logs"
      - "Corporate Wi-Fi access points, VPN concentrators, web proxies, Mobile Device Management (MDM) platform."
    range: "last 24 hours"
    queries:
      - "pseudocode: CLUSTER devices based on 24hr_network_profile_features. IF device is outlier, QUERY MDM for compliance_status. IF non-compliant, ALERT."
  - question: "Has an unapproved application been granted Device Administrator privileges or has an unapproved configuration profile been installed on a managed mobile device?"
    context: "This is a direct question to detect high-risk configuration changes on the endpoint itself. Gaining Device Administrator rights (Android) or installing a malicious profile (iOS) gives an application extensive control over the device, including the ability to wipe data or lock the screen, all of which are forms of Endpoint DoS."
    answer_sources:
      - "MDM Logs"
      - "SIEM Logs"
      - "Mobile Device Management (MDM) platform, Enterprise Mobility Management (EMM) server logs, SIEM."
    range: "last 90 days"
    queries:
      - "pseudocode: SEARCH MDM_logs FOR event_type IN ('Device Admin Granted', 'Profile Installed') WHERE app_or_cert NOT IN allowlist. IF match, ALERT with device_details."
  - question: "Is a mobile device experiencing an abnormally high rate of application installations or profile modifications compared to its own history and its peer group?"
    context: "This question looks for an unusual velocity of change on a device. While a single app install is normal, a sudden burst of installations or configuration changes can indicate an automated, malicious process, such as a dropper installing multiple malicious packages or an attacker rapidly modifying device settings to prepare for an attack."
    answer_sources:
      - "MDM Logs"
      - "SIEM Logs"
      - "Mobile Device Management (MDM) platform, Enterprise Mobility Management (EMM) server logs, SIEM."
    range: "last 90 days"
    queries:
      - "pseudocode: MONITOR rate of app_installs/profile_mods per device. IF rate > 99th_percentile_for_device AND rate > 99th_percentile_for_peer_group, ALERT."
  - question: "Has a newly installed application on a mobile device been classified as 'high risk' by a machine learning model based on its permissions and characteristics?"
    context: "This question proactively assesses the risk of new software. Instead of waiting for malicious behavior, it uses an ML model to score an application at the time of installation based on its requested permissions, source, developer reputation, and other factors. A high-risk classification can trigger an immediate automated response, like quarantining the device, to prevent a potential DoS attack before it happens."
    answer_sources:
      - "MDM Logs"
      - "SIEM Logs"
      - "Mobile Device Management (MDM) platform, Enterprise Mobility Management (EMM) server logs, SIEM."
    range: "last 90 days"
    queries:
      - "pseudocode: FOR EACH new_app_install, CALCULATE risk_score using ML_model(features). IF risk_score is 'high', TRIGGER SOAR_playbook_to_quarantine_device."