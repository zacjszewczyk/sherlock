name: T1635.001: URI Hijacking
id: d2b1f8e0-1c9a-4b5d-8f6a-9e7c0d3b1a2c
description: >-
  Investigates potential adversary attempts to intercept credentials or access tokens by hijacking URI schemes on mobile devices. This is typically observed when a malicious or unauthorized application registers a URI scheme used by a legitimate application. Evidence includes identifying applications with mismatched package IDs or signing certificates for a given URI scheme, or observing an anomalous rate of 'application chooser' dialogs, which may indicate that multiple apps are competing to handle the same URI.
type: technique
related:
  - TA0031: Credential Access
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: >-
      Are there any applications registered to a URI scheme that do not match our allowlisted package ID or signing certificate for that scheme?
    context: >-
      This question aims to identify potentially malicious applications that are impersonating legitimate ones by registering the same URI scheme. By maintaining an allowlist of trusted application attributes (package ID, signing certificate) for each URI scheme, we can detect discrepancies that indicate a potential hijacking attempt. The investigation should prioritize applications that are sideloaded or from unofficial sources, as these pose a higher risk.
    answer_sources:
      - MDM Application Inventory Log
      - MTD Application Scan Log
      - Threat Intelligence Platform Reputation Feed
      - Managed Mobile Endpoints (iOS/Android)
      - Mobile Device Management (MDM) Server
      - Mobile Threat Defense (MTD) Platform
      - Application Vetting System
    range: Last 90 days
    queries:
      - search_technology: Pseudocode
        query: >-
          JOIN app_inventory ON uri_scheme
          WITH app_allowlist ON uri_scheme
          WHERE app_inventory.package_id != app_allowlist.package_id
          OR app_inventory.signing_cert != app_allowlist.signing_cert
          ALERT IF app_inventory.source IN ('sideloaded', 'unofficial-store')
  - question: >-
      Has there been an anomalous increase in the number of unique applications registered to a sensitive URI scheme across the device fleet?
    context: >-
      This question uses statistical analysis to detect URI hijacking at scale. A sudden spike in the number of different applications handling a sensitive URI (e.g., for single sign-on) can indicate a widespread campaign. This approach also looks for rare applications impersonating very common ones, which is a strong indicator of malicious intent, as a legitimate new application is unlikely to immediately register a popular, established URI scheme.
    answer_sources:
      - MDM Application Inventory Log
      - MTD Application Scan Log
      - Threat Intelligence Platform Reputation Feed
      - Managed Mobile Endpoints (iOS/Android)
      - Mobile Device Management (MDM) Server
      - Mobile Threat Defense (MTD) Platform
      - Application Vetting System
    range: Last 90 days
    queries:
      - search_technology: Pseudocode
        query: >-
          CALCULATE daily_count of unique package_ids per sensitive_uri_scheme
          CALCULATE 30day_moving_avg and 30day_std_dev of daily_count
          ALERT IF daily_count > (30day_moving_avg + 3 * 30day_std_dev)
  - question: >-
      Are there any newly observed application-URI registrations that exceed our defined risk score threshold?
    context: >-
      This question leverages a machine learning model to proactively score the risk of every new application-URI registration. By combining multiple features—such as whether the app is sideloaded, its permission count, the sensitivity of the URI scheme, and its threat intelligence reputation—the model can identify high-risk combinations that may be missed by simpler rules. A high score indicates a strong likelihood of malicious activity and warrants immediate analyst review.
    answer_sources:
      - MDM Application Inventory Log
      - MTD Application Scan Log
      - Threat Intelligence Platform Reputation Feed
      - Managed Mobile Endpoints (iOS/Android)
      - Mobile Device Management (MDM) Server
      - Mobile Threat Defense (MTD) Platform
      - Application Vetting System
    range: Last 90 days
    queries:
      - search_technology: Pseudocode
        query: >-
          FOR each new app_uri_registration:
            CALCULATE risk_score using features (is_sideloaded, permission_count, etc.)
            ALERT IF risk_score > 0.85
  - question: >-
      Has a single mobile device generated an excessive number of 'application chooser' dialogs for a sensitive URI scheme in a short time frame?
    context: >-
      This question focuses on detecting user-facing evidence of URI hijacking on a single device. When a user clicks a link with a URI handled by multiple apps, the OS presents a chooser dialog. A sudden burst of these dialogs for the same sensitive URI suggests that a newly installed malicious app is now competing with a legitimate one, potentially confusing the user into selecting the wrong application. Correlating this with network logs can help trace the activity back to a potential phishing link.
    answer_sources:
      - MTD Security Event Log
      - Android Logcat Data Stream
      - Zeek conn.log
      - Zeek http.log
      - Zeek dns.log
      - Managed Mobile Endpoints (iOS/Android)
      - Mobile Threat Defense (MTD) Platform
      - Network Gateways (VPN Concentrators, Proxies)
    range: Last 90 days
    queries:
      - search_technology: Pseudocode
        query: >-
          COUNT events where event_type = 'app_chooser_dialog_shown' by device_id, uri_scheme
          GROUP BY 5_minute_window
          ALERT IF count > 2 AND uri_scheme IN sensitive_list
          ENRICH with network_logs for source_ip, referring_url
  - question: >-
      Is any user exhibiting an anomalous rate of 'application chooser' dialog events compared to their own historical baseline?
    context: >-
      This question aims to identify behavioral anomalies specific to an individual user. While some users may trigger chooser dialogs more often than others, a significant deviation from an individual's established pattern is suspicious. This personalized baseline approach helps reduce false positives that might arise from a single, fleet-wide threshold and can pinpoint a targeted attack or a user who has recently installed a malicious application.
    answer_sources:
      - MTD Security Event Log
      - Android Logcat Data Stream
      - Zeek conn.log
      - Zeek http.log
      - Zeek dns.log
      - Managed Mobile Endpoints (iOS/Android)
      - Mobile Threat Defense (MTD) Platform
      - Network Gateways (VPN Concentrators, Proxies)
    range: Last 90 days
    queries:
      - search_technology: Pseudocode
        query: >-
          CALCULATE hourly_event_count of 'app_chooser_dialog_shown' per user
          CALCULATE 30day_user_baseline_mean and 30day_user_baseline_std_dev
          ALERT IF hourly_event_count > (user_baseline_mean + 3 * user_baseline_std_dev)
  - question: >-
      Is the fleet-wide rate of 'application chooser' dialog events deviating significantly from the forecasted norm?
    context: >-
      This question uses advanced time-series analysis to detect large-scale campaigns that might otherwise be lost in the noise. By modeling normal daily and weekly patterns of 'application chooser' events across the entire organization, we can detect statistically significant spikes that indicate a widespread issue, such as a successful phishing campaign directing many users to a link that triggers a hijacked URI. The model can flag anomalies that simpler threshold-based rules would miss.
    answer_sources:
      - MTD Security Event Log
      - Android Logcat Data Stream
      - Zeek conn.log
      - Zeek http.log
      - Zeek dns.log
      - Managed Mobile Endpoints (iOS/Android)
      - Mobile Threat Defense (MTD) Platform
      - Network Gateways (VPN Concentrators, Proxies)
    range: Last 90 days
    queries:
      - search_technology: Pseudocode
        query: >-
          MODEL fleet_wide_event_count('app_chooser_dialog_shown') for seasonality
          FORECAST expected_event_count_band
          ALERT IF actual_count outside of forecast_band
          ENRICH with top_uri_schemes, top_package_names