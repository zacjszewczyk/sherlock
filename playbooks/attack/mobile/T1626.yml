name: T1626: Abuse Elevation Control Mechanism
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: This playbook helps investigate whether an adversary is abusing elevation control mechanisms to escalate privileges on managed mobile devices. This is identified by observing device administrator privilege grant events for applications that are either not on a corporate allowlist or are statistically rare across the device fleet. It also involves correlating these grant events with subsequent suspicious network activity, such as communication with known malicious IPs/domains, high-entropy DNS queries indicative of DGA, or anomalous data transfer volumes that deviate from the device's established baseline.
type: technique
related:
- TA0029: Privilege Escalation
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Has a device administrator privilege been granted to an application that is not on the corporate allowlist?
  context: This question aims to identify the most direct violation of policy: granting powerful device administrator rights to an unapproved application. Such an event is a strong indicator of a potential security breach, as it bypasses established corporate controls. Answering this helps an analyst immediately spot and prioritize high-risk privilege escalations that use unauthorized software.
  answer_sources:
  - MDM Device Administrator Event Log
  - MDM Application Inventory Report
  - Corporate App Store Metadata
  - Centralized MDM/EMM log platform
  - Corporate Application Store database
  - the population of managed mobile devices.
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FOR each 'Device Admin Granted' event, EXTRACT package_id. IF package_id NOT IN allowlist, THEN ALERT 'High-Severity: Unauthorized Admin App'.
- question: Has a device administrator privilege been granted to a statistically rare application across the mobile device fleet?
  context: This question focuses on identifying outliers. Legitimate applications requiring administrator privileges are typically well-known and widely deployed. An application with very low installation prevalence (e.g., bottom 5th percentile) receiving these rights is suspicious. It could indicate a targeted, custom-built malicious app or a niche tool being abused. This helps analysts detect threats that might otherwise be missed by static allowlists.
  answer_sources:
  - MDM Device Administrator Event Log
  - MDM Application Inventory Report
  - Corporate App Store Metadata
  - Centralized MDM/EMM log platform
  - Corporate Application Store database
  - the population of managed mobile devices.
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: CALCULATE prevalence for all apps. FOR each 'Device Admin Granted' event, ENRICH with app prevalence. IF prevalence < 5th percentile, THEN ALERT 'Medium-Severity: Statistically Rare Admin App'.
- question: Is a machine learning model flagging a device administrator privilege grant event as likely malicious?
  context: This question leverages a predictive model to score the risk of a privilege grant event based on multiple features, such as application prevalence, age, permissions, and certificate reputation. It provides a more nuanced risk assessment than simple rule-based checks. A high malicious probability score (e.g., > 0.85) from the model serves as a strong signal for an analyst to investigate a potentially sophisticated attempt at privilege escalation that might not violate a single, simple rule.
  answer_sources:
  - MDM Device Administrator Event Log
  - MDM Application Inventory Report
  - Corporate App Store Metadata
  - Centralized MDM/EMM log platform
  - Corporate Application Store database
  - the population of managed mobile devices.
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FOR each 'Device Admin Granted' event, GATHER features (prevalence, age, permissions, etc.). SCORE event with logistic regression model. IF malicious_probability > 0.85, THEN CREATE 'High-Priority Incident Ticket'.
- question: Did a device begin communicating with a known malicious IP address or domain shortly after a device administrator privilege grant?
  context: This question correlates a high-privilege event with immediate, subsequent network communication to a known threat. This is a classic indicator of compromise (IOC), suggesting that the newly-granted administrative rights are being used to establish a command-and-control (C2) channel or download a second-stage payload. Answering this provides high-confidence evidence of malicious post-escalation activity.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - MDM Device Administrator Event Log
  - Network TAPs or switch SPAN ports feeding Zeek sensors at the network egress
  - centralized DNS server logs
  - the centralized MDM/EMM log platform.
  range: 5 minutes after the observed event
  queries:
  - search_technology: pseudocode
    query: ON 'Device Admin Granted' event, JOIN with network logs for the next 5 mins on device_ip. IF destination_ip OR dns_query IN threat_intel_feed, THEN ALERT 'Critical: Post-Escalation C2 Detected'.
- question: Did a device exhibit anomalous network behavior, such as high-entropy DNS queries or unusually large data transfers, after a device administrator privilege grant?
  context: This question seeks to identify statistical anomalies in network traffic that are indicative of malicious activity, even in the absence of a known IOC. High-entropy DNS queries often point to Domain Generation Algorithms (DGAs) used by malware for C2 communication. A sudden spike in data exfiltration, exceeding the device's normal baseline, is a red flag for data theft. This helps detect novel or unknown threats.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - MDM Device Administrator Event Log
  - Network TAPs or switch SPAN ports feeding Zeek sensors at the network egress
  - centralized DNS server logs
  - the centralized MDM/EMM log platform.
  range: 5 minutes after the observed event
  queries:
  - search_technology: pseudocode
    query: AFTER 'Device Admin Granted' event, for next 5 mins, CALCULATE DNS query entropy and outbound bytes. IF avg_entropy > 4.5 OR outbound_bytes > 99th_percentile_baseline, THEN ALERT 'High-Severity: Anomalous Network Activity'.
- question: Did a device's network behavior deviate significantly from its established baseline, as determined by an autoencoder model, following a device administrator privilege grant?
  context: This question employs an advanced anomaly detection technique (an LSTM autoencoder) to spot subtle deviations from a device's normal network patterns. By training a model on each device's unique behavior, it can detect sophisticated C2 activity or data exfiltration that might not be statistically extreme but is abnormal for that specific device. A high reconstruction error from the model is a high-confidence indicator that the device's behavior has fundamentally changed post-privilege-grant, warranting immediate investigation.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - MDM Device Administrator Event Log
  - Network TAPs or switch SPAN ports feeding Zeek sensors at the network egress
  - centralized DNS server logs
  - the centralized MDM/EMM log platform.
  range: 10 minutes after the observed event
  queries:
  - search_technology: pseudocode
    query: AFTER 'Device Admin Granted' event, FEED network telemetry for next 10 mins to device's autoencoder. IF reconstruction_error > threshold (e.g., 3*std_dev), THEN ALERT 'High-Confidence Anomaly Detected'.