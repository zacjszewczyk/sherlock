name: T1629: Impair Defenses
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: This playbook helps investigate whether an adversary is attempting to impair or disable security defenses on mobile devices. This includes detecting when a managed mobile device fails to send its periodic heartbeat signal without a corresponding authorized administrative action, such as unenrollment. It also looks for network traffic from mobile devices that matches indicators of compromise, like DNS queries to malicious domains, downloads of known malicious APK/IPA files, or unusual network behavior. Finally, it addresses explicit events logged by MTD or MDM platforms that indicate direct attempts to weaken a device's security, such as terminating a security agent, modifying a security profile, or granting high-risk permissions without authorization.
type: technique
related:
- TA0030: Defense Evasion
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Has a managed mobile device missed its scheduled MDM check-in without a corresponding authorized administrative action?
  context: This question is crucial for detecting devices that may have been tampered with or had their management software disabled. A missed check-in is a primary indicator that the device is no longer under administrative control. By correlating the missed check-in with a lack of authorized actions like 'unenroll' or 'wipe' in the audit logs, we can distinguish between legitimate administrative tasks and potentially malicious activity, thus reducing false positives.
  answer_sources:
  - Zeek conn.log
  - MDM Server Logs
  - MTD Server Logs
  - Organization's internet gateway, Wi-Fi network infrastructure, and MDM/MTD Management Servers
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FOR each device, IF MDM check-in event is missing THEN SEARCH MDM audit logs for 'unenroll', 'wipe', 'decommission' in last 15 mins. IF NOT FOUND, ALERT.
- question: Has any managed device exceeded its historically normal check-in interval?
  context: This question uses a statistical baseline to detect anomalies in device check-in behavior. Instead of a static threshold, it calculates a dynamic 99th percentile for each device's check-in frequency. This approach is more sensitive to subtle changes and can identify devices that are 'checking in' less frequently than their own established pattern, which could be an early sign of an issue or tampering.
  answer_sources:
  - Zeek conn.log
  - MDM Server Logs
  - MTD Server Logs
  - Organization's internet gateway, Wi-Fi network infrastructure, and MDM/MTD Management Servers
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FOR each device, CALCULATE 99th percentile of check-in time deltas over 30 days. SCHEDULED QUERY: IF (current_time - last_checkin_time) > 99th_percentile_delta, ALERT.
- question: Has any managed device failed to check in within its predicted time window, according to a time-series forecasting model?
  context: This question represents a more advanced, machine learning-based approach to detecting missed check-ins. By using a forecasting model like ARIMA, it accounts for complex patterns and seasonality in a device's check-in behavior. An alert is triggered only when a device deviates significantly from its predicted schedule, making this method highly effective at spotting true anomalies while minimizing false alarms from normal variability.
  answer_sources:
  - Zeek conn.log
  - MDM Server Logs
  - MTD Server Logs
  - Organization's internet gateway, Wi-Fi network infrastructure, and MDM/MTD Management Servers
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FOR each device, TRAIN time-series model on historical check-in times. PREDICT next check-in timestamp with 95% confidence interval. IF actual check-in does not occur within interval, ALERT.
- question: Is any mobile device communicating with known malicious domains or downloading files with known malicious hashes?
  context: This is a fundamental threat detection question that relies on threat intelligence. By comparing network activity (DNS queries, TLS SNI) and file downloads against a curated list of known mobile-specific threats (like spyware C2 servers or malware hashes), we can quickly identify confirmed malicious activity. A positive match provides high-confidence evidence of a compromise.
  answer_sources:
  - Zeek dns.log
  - Zeek ssl.log
  - Zeek http.log
  - Zeek files.log
  - Organization's internet gateway and Wi-Fi network infrastructure
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: IN REAL-TIME: MATCH Zeek dns.log:query, ssl.log:server_name, files.log:hash AGAINST mobile threat intelligence feed. IF match from mobile device IP, ALERT.
- question: Is any mobile device exhibiting a combination of unusual network behaviors, such as using a rare User-Agent string and making high-entropy DNS queries?
  context: This question seeks to identify suspicious activity that may not match known threat intelligence. Rare User-Agents can indicate custom or non-standard client software, while high-entropy DNS queries are often associated with domain generation algorithms (DGAs) used by malware. The combination of these two anomalies within a short time frame is a strong indicator of a potential compromise that warrants investigation.
  answer_sources:
  - Zeek dns.log
  - Zeek ssl.log
  - Zeek http.log
  - Zeek files.log
  - Organization's internet gateway and Wi-Fi network infrastructure
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FIND devices where http.user_agent is rare (<1% of fleet) AND dns.query has high entropy (>4.0) within a 5-minute window. IF BOTH, ALERT.
- question: Has a machine learning model identified any network connections from a mobile device as having a high probability of being malicious?
  context: This question leverages a supervised machine learning model to provide a holistic assessment of a network connection's risk. By analyzing a combination of features (e.g., connection duration, bytes transferred, JA3/JA3S hashes, domain entropy), the model can identify complex patterns indicative of maliciousness that are difficult to capture with simple rules. A high score from the model serves as a strong signal for an analyst to investigate a potentially compromised device.
  answer_sources:
  - Zeek dns.log
  - Zeek ssl.log
  - Zeek http.log
  - Zeek files.log
  - Organization's internet gateway and Wi-Fi network infrastructure
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FOR each network connection, GENERATE features from Zeek logs. SCORE connection using ML model. IF score > 0.90, ALERT.
- question: Has a critical security event, such as the termination of a security agent or a high-risk permission grant, occurred on a mobile device without a corresponding authorized change request?
  context: This question aims to detect direct and explicit attempts to disable security controls. Events like 'Security Agent Process Terminated' or 'Device Administrator Granted' are highly suspicious. By cross-referencing these events with the IT change management system, the playbook can automatically filter out legitimate administrative activities, ensuring that alerts are only generated for unauthorized and potentially malicious actions, which significantly improves the signal-to-noise ratio.
  answer_sources:
  - Mobile Threat Defense (MTD) Agent Logs
  - Mobile Device Management (MDM) Compliance Logs
  - IT Change Management System Logs
  - Managed mobile device endpoints and MDM/MTD Management Servers
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: ON critical MDM/MTD event (e.g., 'Agent Terminated'), QUERY change management system for approved ticket in last 24 hours. IF NO TICKET, ALERT.
- question: Is any user or device generating a statistically anomalous number of security or compliance violations compared to their peers?
  context: This question focuses on identifying outliers within peer groups. A user who suddenly starts generating many more compliance violations than their colleagues with the same role might be compromised or engaging in risky behavior. This peer-group analysis helps to contextualize activity and spot deviations from the norm that might otherwise be missed when looking at absolute numbers.
  answer_sources:
  - Mobile Threat Defense (MTD) Agent Logs
  - Mobile Device Management (MDM) Compliance Logs
  - IT Change Management System Logs
  - Managed mobile device endpoints and MDM/MTD Management Servers
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: CALCULATE 30-day baseline mean/std-dev of violation events per user role. HOURLY: FIND users/devices with 24-hour event count > (mean + 3*std_dev) for their role. IF YES, ALERT.
- question: Has a UEBA platform detected an anomalous sequence of events for a user or device that indicates a potential security compromise?
  context: This question leverages advanced UEBA capabilities to identify malicious behavior based on the sequence and context of actions, not just individual events. A single event like a VPN login from a new country might be benign, but when it's immediately followed by installing an app from an unknown source and granting it admin rights, the entire sequence becomes highly suspicious. A UEBA model can learn normal sequences and flag these dangerous chains of events that simple correlation rules would miss.
  answer_sources:
  - Mobile Threat Defense (MTD) Agent Logs
  - Mobile Device Management (MDM) Compliance Logs
  - IT Change Management System Logs
  - Managed mobile device endpoints and MDM/MTD Management Servers
  range: last 90 days
  queries:
  - search_technology: pseudocode
    query: FEED MDM, MTD, VPN, and network logs into UEBA system. USE sequence model (e.g., LSTM) to score event sequences. IF sequence anomaly score is high, ALERT.