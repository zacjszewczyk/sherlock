name: T1430: Location Tracking
id: f7a9d8c0-1b2e-4f5a-8d9c-0e1f2a3b4c5d
description: This playbook helps identify adversarial attempts to discover and collect the physical location of mobile devices. It focuses on detecting applications with high-risk location permissions, anomalous location service API calls, and the exfiltration of location data to suspicious network destinations. It leverages a combination of mobile device management (MDM) logs, network traffic analysis, and threat intelligence to uncover malicious activity.
type: technique
related:
- TA0032: Discovery
- TA0035: Collection
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags:
- none
questions:
- question: Are any installed mobile applications with high-risk location permissions known to be malicious?
  context: This question aims to identify known threats by cross-referencing applications that have been granted high-risk permissions (e.g., background location access) against a threat intelligence platform. A match provides a high-confidence indicator that a malicious application, specifically designed to track location, is present on a device.
  answer_sources:
  - Mobile Device Management (MDM) application inventory logs
  - AndroidManifest.xml
  - Info.plist
  - Threat intelligence feeds
  - MDM/UEM server, internal application repository, cloud-hosted application vetting sandboxes, threat intelligence platform.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH MDM logs for apps with 'ACCESS_BACKGROUND_LOCATION' or 'NSLocationAlwaysAndWhenInUseUsageDescription' permission. FOREACH app, QUERY threat intel with package_name and file_hash. ALERT on match.
- question: Do any mobile applications request an unusual combination of permissions, specifically including background location access?
  context: This question seeks to uncover novel or unknown malicious applications by identifying statistical outliers. Adversarial applications often request more permissions than legitimate apps in the same category. Flagging an application that requests background location and has an unusually high number of total permissions can surface suspicious software for manual review, even without a prior threat intelligence match.
  answer_sources:
  - Mobile Device Management (MDM) application inventory logs
  - AndroidManifest.xml
  - Info.plist
  - Threat intelligence feeds
  - MDM/UEM server, internal application repository, cloud-hosted application vetting sandboxes, threat intelligence platform.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: PARSE manifests for all applications to extract permissions. GROUP applications by app store category. FOREACH category, calculate permission distribution. ALERT on applications that request background location AND have a total permission count in the >95th percentile for their category.
- question: Can a machine learning model identify potentially malicious applications based on their manifest permissions and API calls?
  context: This question explores the use of automated classification to detect malicious applications at scale. By training a model on features extracted from an application's manifest (like permissions and exported components), it's possible to identify complex patterns indicative of malware. An application that requests location permissions and is classified as malicious with high confidence warrants immediate action, such as automated quarantine via MDM.
  answer_sources:
  - Mobile Device Management (MDM) application inventory logs
  - AndroidManifest.xml
  - Info.plist
  - Threat intelligence feeds
  - MDM/UEM server, internal application repository, cloud-hosted application vetting sandboxes, threat intelligence platform.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: EXTRACT features (permission vectors, component counts, API strings) from application manifests. APPLY pre-trained binary classification model. IF classification is 'malicious' AND confidence > 0.90 AND app has location permission, THEN execute MDM quarantine AND generate CRITICAL alert.
- question: Are mobile devices communicating with network destinations known to be associated with malicious C2 infrastructure?
  context: This question focuses on detecting active compromises by monitoring network traffic. Correlating outbound connections from the mobile device fleet against threat intelligence feeds for known command and control (C2) servers is a direct method for identifying infected devices that are communicating with an adversary.
  answer_sources:
  - Mobile Threat Defense (MTD) API call logs
  - MDM location history logs
  - Zeek conn.log
  - Zeek dns.log
  - Corporate-managed mobile devices, network egress points (e.g., VPN concentrators, corporate Wi-Fi access points), DNS resolvers, cloud-hosted MTD/MDM platforms.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH network logs (Zeek conn.log, dns.log) where source IP is in mobile device range. FOREACH destination IP and DNS query, QUERY threat intelligence feeds. ALERT on any match, enriching the alert with device ID and user from MDM/VPN logs.
- question: Is there a statistical anomaly in the frequency of location API calls or connections to new network destinations from any mobile device?
  context: This question aims to detect behavioral changes on a device that could indicate a malicious feature has been activated. A sudden, sharp increase in location service API calls or a connection to a network destination never before seen from the mobile fleet can be an early indicator of active tracking or C2 communication.
  answer_sources:
  - Mobile Threat Defense (MTD) API call logs
  - MDM location history logs
  - Zeek conn.log
  - Zeek dns.log
  - Corporate-managed mobile devices, network egress points (e.g., VPN concentrators, corporate Wi-Fi access points), DNS resolvers, cloud-hosted MTD/MDM platforms.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOREACH device, ingest hourly location API calls from MTD. CALCULATE 30-day rolling baseline (mean, std dev). ALERT if current hour's count > (mean + 3 * std dev). Separately, MAINTAIN set of known destination IPs from fleet over 60 days. ALERT if a device connects to an IP not in the set.
- question: Can advanced anomaly detection models identify unusual user location patterns or travel to uncharacteristic geographic areas?
  context: This question leverages machine learning to understand a user's normal 'pattern of life' based on location data. Time-series models can detect subtle deviations in location API call frequency, while clustering algorithms can identify when a device appears in a location inconsistent with the user's established routines (e.g., home, office, commute). Such anomalies might indicate device theft or misuse for tracking purposes.
  answer_sources:
  - Mobile Threat Defense (MTD) API call logs
  - MDM location history logs
  - Zeek conn.log
  - Zeek dns.log
  - Corporate-managed mobile devices, network egress points (e.g., VPN concentrators, corporate Wi-Fi access points), DNS resolvers, cloud-hosted MTD/MDM platforms.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOREACH device, APPLY time-series model (e.g., Prophet) to hourly location API call data to find anomalies. Separately, APPLY clustering algorithm (e.g., DBSCAN) to historical MDM geo-coordinates. ALERT if a new location point is an outlier to established clusters.
- question: Are applications with location permissions making network connections to known command and control (C2) infrastructure?
  context: This is a highly specific query to detect the potential exfiltration of location data. By filtering for network connections made only by applications that have been granted location permissions and checking those destinations against C2 threat intelligence, analysts can focus on the highest-risk events where the means (location access) and opportunity (C2 channel) are both present.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Zeek ssl.log
  - Threat intelligence feeds
  - MDM/MTD application network logs
  - Network egress points, firewalls, proxies, VPN concentrators, DNS resolvers, threat intelligence platforms, MDM/MTD cloud consoles.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: JOIN MTD logs (for app permissions) with Zeek logs on device IP and timestamp. WHERE app has location permissions, QUERY threat intel with destination IP, DNS query, and SNI. TRIGGER critical alert on match.
- question: Are applications with location permissions using rare or non-standard TLS clients, potentially to disguise exfiltration traffic?
  context: This question attempts to identify covert C2 channels by fingerprinting the client-side of a TLS session. Malware authors often use custom or less-common libraries for networking, which results in a unique JA3 hash. Detecting a location-aware app communicating with a rare JA3 fingerprint (one not commonly seen across the fleet) is a strong indicator of a non-standard client being used for potentially malicious purposes.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Zeek ssl.log
  - Threat intelligence feeds
  - MDM/MTD application network logs
  - Network egress points, firewalls, proxies, VPN concentrators, DNS resolvers, threat intelligence platforms, MDM/MTD cloud consoles.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: From Zeek ssl.log for mobile IP range, CALCULATE frequency of all JA3 hashes over 30 days. ALERT when an app with location permissions initiates a TLS session with a JA3 hash seen in < 0.01% of sessions.
- question: Can a machine learning model assign a risk score to outbound connections to identify potential data exfiltration?
  context: This question proposes a holistic approach to detecting suspicious outbound connections. Instead of relying on a single indicator, a supervised ML model can be trained on a variety of features (IP reputation, port rarity, JA3 prevalence, data volume, etc.) to produce a comprehensive risk score. Connections exceeding a certain risk threshold can then be flagged for automated investigation, improving detection accuracy and reducing false positives.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Zeek ssl.log
  - Threat intelligence feeds
  - MDM/MTD application network logs
  - Network egress points, firewalls, proxies, VPN concentrators, DNS resolvers, threat intelligence platforms, MDM/MTD cloud consoles.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOREACH outbound connection, ENGINEER features (dest reputation, port rarity, JA3 prevalence, DNS entropy, bytes sent/received, has location permission). APPLY trained model to generate risk_score. ALERT if risk_score > 0.85.
- question: Are mobile devices uploading large amounts of data to destinations not on the approved corporate allow-list?
  context: This question provides a straightforward method to catch blatant data exfiltration. By maintaining an allow-list of known-good corporate and cloud service destinations, any large data upload to a destination not on this list is inherently suspicious and warrants a high-severity alert for immediate investigation.
  answer_sources:
  - Zeek conn.log
  - MDM/MTD application activity logs
  - Network egress points (e.g., VPN concentrators, corporate Wi-Fi gateways), corporate-managed mobile devices, MDM/MTD cloud consoles.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: SEARCH Zeek conn.log for connections from mobile IP range. IF destination IP is NOT in approved allow-list AND uploaded bytes (`orig_bytes`) > 50MB in a single session, generate HIGH alert. ENRICH alert with active app from MDM logs.
- question: Is any mobile device exhibiting a statistically significant increase in its daily data upload volume compared to its historical baseline?
  context: This question aims to detect changes in a device's behavior over time. By establishing a historical baseline for each device's daily upload volume, a significant deviation (e.g., exceeding the 99th percentile) can indicate the start of a data exfiltration event, even if the destination is not known to be malicious. This method is effective for identifying anomalous behavior specific to each user.
  answer_sources:
  - Zeek conn.log
  - MDM/MTD application activity logs
  - Network egress points (e.g., VPN concentrators, corporate Wi-Fi gateways), corporate-managed mobile devices, MDM/MTD cloud consoles.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOREACH device, CALCULATE 30-day rolling baseline of total daily upload volume to external IPs. TRIGGER medium alert if a device's 24-hour upload volume > 99th percentile of its historical baseline.
- question: Can a time-series model detect anomalous data upload volumes, and can the associated network destinations be automatically categorized?
  context: This question leverages advanced analytics for more precise detection and faster response. A time-series forecasting model can more accurately predict expected data volumes than a simple statistical baseline, leading to fewer false positives. Upon detecting a true anomaly, topic modeling can be automatically applied to the destination domains to group them into understandable themes, helping an analyst quickly grasp the nature of the exfiltration.
  answer_sources:
  - Zeek conn.log
  - MDM/MTD application activity logs
  - Network egress points (e.g., VPN concentrators, corporate Wi-Fi gateways), corporate-managed mobile devices, MDM/MTD cloud consoles.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: FOREACH device, APPLY time-series model (e.g., Prophet) to predict daily upload volume. ALERT if actual volume > predicted upper confidence interval. ON ALERT, apply topic modeling (e.g., LDA) to destination domains to identify activity clusters.