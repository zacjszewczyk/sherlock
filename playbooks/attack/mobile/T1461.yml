name: T1461: Lockscreen Bypass
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps investigate if an adversary has gained initial access
  to the corporate network by compromising a mobile device, specifically through
  a lockscreen bypass. The investigation focuses on identifying evidence such as
  a sequence of failed login attempts immediately followed by a success from a mobile-IP,
  anomalous network behavior from a mobile device after a login (e.g., connections
  to unusual internal servers, DGA-like DNS queries, large data transfers, or use
  of self-signed certificates), or successful logins from a device that has recently
  been flagged by an MDM/UEM solution for a critical compliance failure like being
  rooted or jailbroken.
type: technique
related:
- TA0027: Initial Access
contributors:
- Zachary Szewczyk
- Ask Sage
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: none
questions:
- question: Has a brute-force or password-spraying attempt from a mobile device resulted
    in a successful login?
  context: This question aims to detect a common pattern of a lockscreen bypass or
    credential compromise. A series of failed logins followed by a success from the
    same IP address, especially when that IP is confirmed to belong to a mobile device,
    is a strong indicator of an adversary attempting to gain access. Identifying this
    pattern early can prevent further lateral movement.
  answer_sources:
  - Windows Event ID 4625
  - Windows Event ID 4624
  - Zeek conn.log
  - MDM/UEM logs
  - VPN logs
  - IdP logs
  - Authentication Servers (e.g., Active Directory Domain Controllers)
  - VPN Concentrators
  - Cloud Identity Providers (e.g., Azure AD, Okta)
  - Internet Gateway
  - MDM/UEM solution logs.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      SEARCH Windows Event ID 4625
      GROUP BY source_ip, target_user
      WHERE count > 4 in 10 minutes
      JOIN with Windows Event ID 4624
      ON source_ip, target_user
      WHERE success occurs within 5 minutes of last failure
      ENRICH source_ip with MDM/VPN logs
      IF source_ip is mobile_device
      THEN ALERT medium
- question: Is a successful login, following multiple failures from a mobile device,
    anomalous based on the user's historical behavior?
  context: This question adds a layer of behavioral analysis to a potential brute-force
    event. By comparing the suspicious login against the user's established baseline
    for login times, locations, and network origins (ASN), we can differentiate between
    a forgotten password and a genuine attack. A login that deviates significantly
    from the user's normal patterns greatly increases the likelihood of a compromise.
  answer_sources:
  - Windows Event ID 4625
  - Windows Event ID 4624
  - Zeek conn.log
  - MDM/UEM logs
  - VPN logs
  - IdP logs
  - Authentication Servers (e.g., Active Directory Domain Controllers)
  - VPN Concentrators
  - Cloud Identity Providers (e.g., Azure AD, Okta)
  - Internet Gateway
  - MDM/UEM solution logs.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each alert from previous question:
      PROFILE target_user over last 90 days for:
        - login_hour_percentiles
        - known_countries
        - known_asns
      ENRICH alert with source_ip geolocation and ASN from Zeek conn.log
      IF alert.login_hour is NOT IN user.login_hour_percentiles(5-95)
      AND (alert.country IS NEW or alert.asn IS NEW)
      THEN ESCALATE alert to High
- question: Does a machine learning model classify a suspicious login event from a
    mobile device as a high-risk anomaly?
  context: This question leverages machine learning to provide a more sophisticated
    and holistic assessment of the login event. By training a model on multiple features
    (time, location, device OS, etc.), it can detect subtle, complex patterns of anomalous
    behavior that simple rule-based checks might miss. A high anomaly score provides
    strong, data-driven evidence to justify an automated response, such as session
    termination, to contain a potential threat immediately.
  answer_sources:
  - Windows Event ID 4625
  - Windows Event ID 4624
  - Zeek conn.log
  - MDM/UEM logs
  - VPN logs
  - IdP logs
  - Authentication Servers (e.g., Active Directory Domain Controllers)
  - VPN Concentrators
  - Cloud Identity Providers (e.g., Azure AD, Okta)
  - Internet Gateway
  - MDM/UEM solution logs.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      FOR each successful login from brute-force alert:
      EXTRACT features: hour, day_of_week, source_asn, source_country, device_os
      INPUT features into user-specific anomaly detection model (e.g., Isolation Forest)
      IF anomaly_score > user_99th_percentile_score
      THEN CLASSIFY as 'Highly Suspicious' and INITIATE automated response
- question: Is a compromised mobile device attempting to access restricted internal
    assets or communicating over untrusted channels?
  context: After gaining initial access, an adversary will often try to connect to
    high-value targets or establish covert communication channels. This question seeks
    to identify such post-compromise activity by checking if a mobile device is connecting
    to servers it shouldn't be, or using insecure protocols like self-signed TLS,
    which are often used by malware for command and control.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Zeek http.log
  - Zeek files.log
  - Zeek ssl.log
  - MDM/UEM logs
  - VPN logs
  - Internal network segments (especially those housing sensitive data like developer
    environments or financial systems)
  - Corporate Wi-Fi access points
  - VPN termination points
  - DNS resolvers
  - Egress points to the internet.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      JOIN VPN/MDM logs with Zeek logs on IP address
      FOR each connection from a mobile_device_ip:
      IF (destination_ip is in 'Restricted Assets' watchlist AND user is NOT in 'Authorized Group')
      OR (tls_validation_status is 'self_signed' or 'unable_to_get_local_issuer')
      THEN ALERT
- question: Is a mobile device exhibiting anomalous network behavior indicative of
    command and control (C2) activity or data exfiltration?
  context: This question aims to detect signs of malicious activity by baselining
    a device's normal network traffic and alerting on deviations. High entropy in
    DNS queries can indicate the use of Domain Generation Algorithms (DGA) for C2.
    Unusually large data uploads can signify data exfiltration. A new or rare User-Agent
    string might suggest the use of non-standard tools or malware.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Zeek http.log
  - Zeek files.log
  - Zeek ssl.log
  - MDM/UEM logs
  - VPN logs
  - Internal network segments (especially those housing sensitive data like developer
    environments or financial systems)
  - Corporate Wi-Fi access points
  - VPN termination points
  - DNS resolvers
  - Egress points to the internet.
  range: last 30 days
  queries:
  - technology: pseudocode
    query: |
      FOR each mobile_device_ip:
      BASELINE over 30 days for DNS entropy, outbound connection size, and top 20 User-Agents.
      ALERT IF:
       - current_dns_entropy > (mean_entropy + 3 * stdev) OR
       - current_outbound_bytes > 99th_percentile_size OR
       - current_user_agent NOT IN top_20_user_agents
- question: Can advanced machine learning models (GNN, SARIMA) detect anomalous device-to-server
    connections or unexpected data transfer volumes?
  context: This question applies advanced analytics to detect sophisticated threats.
    A Graph Neural Network (GNN) can learn the complex web of normal connections
    within the network, flagging new, improbable connections that could represent
    lateral movement. A SARIMA time-series model can forecast data transfer volumes,
    allowing it to spot data exfiltration that might be missed by simple threshold-based
    rules by accounting for seasonality and trends.
  answer_sources:
  - Zeek conn.log
  - Zeek dns.log
  - Zeek http.log
  - Zeek files.log
  - Zeek ssl.log
  - MDM/UEM logs
  - VPN logs
  - Internal network segments (especially those housing sensitive data like developer
    environments or financial systems)
  - Corporate Wi-Fi access points
  - VPN termination points
  - DNS resolvers
  - Egress points to the internet.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      // GNN Model
      INPUT Zeek conn.log into GNN model of device-server connections.
      FOR each new connection:
      CALCULATE anomaly score.
      IF score is high, THEN ALERT.

      // SARIMA Model
      INPUT hourly outbound data volume into SARIMA time-series model.
      FORECAST expected volume and 99% prediction interval.
      IF actual_volume > upper_bound_of_interval, THEN ALERT.
- question: Has a successful login occurred from a mobile device that was recently
    flagged for a critical compliance failure (e.g., jailbroken, rooted)?
  context: A device that is jailbroken, rooted, or has failed an OS integrity check
    is in a highly vulnerable state and should not be trusted. This question seeks
    to identify the high-risk scenario where such a compromised device is actively
    used to access corporate resources. The temporal correlation—a login occurring
    shortly after a compliance failure—is a very strong indicator of malicious activity.
  answer_sources:
  - MDM/UEM logs
  - Windows Event ID 4624
  - Zeek conn.log
  - VPN logs
  - IdP logs
  - MDM/UEM Management Servers
  - Authentication Servers
  - VPN Concentrators
  - Cloud Identity Providers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      ON MDM/UEM alert for critical compliance failure:
      CACHE device_id and last_known_ip.
      MONITOR authentication logs for 60 minutes.
      IF successful_login from cached_ip occurs:
      THEN CREATE critical incident.
- question: Are there non-compliant mobile devices that have remained in a vulnerable
    state for an unusually long time and are actively transmitting data?
  context: While compliance alerts are common, devices that remain non-compliant
    for an extended period pose a persistent risk. This question focuses on identifying
    these 'chronically sick' devices that are also showing signs of active network
    use (data transmission). This combination suggests that the device might not just
    be misconfigured but actively compromised and in use, justifying an automated
    response like network quarantine to contain the potential threat.
  answer_sources:
  - MDM/UEM logs
  - Windows Event ID 4624
  - Zeek conn.log
  - VPN logs
  - IdP logs
  - MDM/UEM Management Servers
  - Authentication Servers
  - VPN Concentrators
  - Cloud Identity Providers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      CALCULATE 95th percentile time-to-remediation for compliance alerts.
      SCHEDULED HOURLY SEARCH for devices in non-compliant state > threshold.
      FOR each such device:
      CHECK Zeek conn.log for data_transmitted > 1MB in last hour.
      IF both conditions met, THEN QUARANTINE device.
- question: Can a machine learning model predict which mobile device compliance alerts
    are most likely to be associated with a malicious login event?
  context: Not all compliance alerts are created equal. This question uses a supervised
    machine learning model (XGBoost) to score the risk of each alert based on historical
    data and various contextual features (user, device, time). By combining a high-risk
    score from the model with the observation of a subsequent successful login, security
    teams can focus their attention on the alerts that are most likely to represent
    a true security incident, enabling faster, more accurate response.
  answer_sources:
  - MDM/UEM logs
  - Windows Event ID 4624
  - Zeek conn.log
  - VPN logs
  - IdP logs
  - MDM/UEM Management Servers
  - Authentication Servers
  - VPN Concentrators
  - Cloud Identity Providers.
  range: last 90 days
  queries:
  - technology: pseudocode
    query: |
      ON new critical compliance alert:
      EXTRACT features (alert_type, user_dept, os_version, time_of_day).
      INPUT features into XGBoost risk model.
      GET risk_score.
      IF risk_score > 0.9:
      MONITOR auth logs for 1 hour.
      IF successful_login from device_ip occurs:
      THEN ESCALATE to Tier-3 analyst.