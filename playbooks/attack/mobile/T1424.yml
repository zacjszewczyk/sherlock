name: "T1424: Process Discovery"
id: "c8a9b7d6-e5f4-4a3b-9c8d-7e6f5a4b3c2d"
description: "This playbook helps to determine if an adversary is attempting to discover running processes on managed mobile devices. This can be indicated by network exfiltration of a process list, characterized by anomalous HTTP POST requests or DNS tunneling; the use of the Android Debug Bridge (adb.exe) on a connected host to spawn process enumeration utilities like 'tasklist.exe' or 'Get-Process'; or a status change to 'rooted' or 'jailbroken' on a Mobile Device Management (MDM) platform, often corroborated by network connections to malicious domains associated with compromise toolkits [1]."
type: "technique"
related:
  - "TA0032: Discovery"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: "1.0"
tags: "none"
investigative_questions:
  - question: "Is a mobile device connecting to a known command-and-control (C2) server and attempting to exfiltrate data via an HTTP POST request?"
    context: "This question aims to detect direct C2 communication from mobile devices. Adversaries often use known C2 infrastructure for data exfiltration, and process lists are a common target. Correlating connections from mobile devices to threat intelligence lists with specific HTTP methods like POST is a high-fidelity indicator of potential compromise."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek http.log"
      - "C2 threat intelligence list"
      - "Corporate Wi-Fi access points"
      - "network egress points"
      - "VPN concentrators"
      - "web proxies"
      - "Cloud Access Security Broker (CASB) logs"
    range: "last 90 days"
    queries:
      - "Search for connections from mobile IP range where destination IP/domain is on C2 list AND the connection has an associated HTTP POST request."
  - question: "Is a mobile device exfiltrating data through an outbound HTTP POST or DNS query that exhibits anomalous characteristics, such as high entropy or unusual length?"
    context: "This question looks for statistical anomalies that suggest data exfiltration, even when the destination is not on a known threat list. High entropy can indicate encrypted or compressed data, long URIs can be used to encode data, and long DNS queries are a hallmark of DNS tunneling. Baselining normal activity per user/device helps to identify significant deviations that warrant investigation, especially if the destination is a newly observed domain (NOD)."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek http.log"
      - "Zeek files.log"
      - "full packet capture"
      - "Corporate Wi-Fi access points"
      - "network egress points"
      - "DNS servers"
      - "VPN concentrators"
      - "web proxies"
      - "Cloud Access Security Broker (CASB) logs"
    range: "last 90 days"
    queries:
      - "For mobile IP range, calculate entropy of HTTP POST bodies and DNS query names. Alert when values exceed the 99.5th percentile of the 30-day baseline for the user/device."
  - question: "Can machine learning models identify complex patterns indicative of C2 data exfiltration that simple rules might miss?"
    context: "This question leverages machine learning to build a more sophisticated detection mechanism. A Random Forest classifier can analyze multiple network features simultaneously (e.g., entropy, connection duration, domain age, TLS ciphers) to identify subtle C2 patterns. An LSTM autoencoder complements this by detecting anomalous spikes in traffic volume over time, which could correspond to a large data transfer like a process list exfiltration."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek http.log"
      - "Zeek ssl.log"
      - "Corporate Wi-Fi access points"
      - "network egress points"
      - "DNS servers"
      - "VPN concentrators"
      - "web proxies"
      - "Cloud Access Security Broker (CASB) logs"
    range: "last 90 days"
    queries:
      - "Apply trained Random Forest model to network log features. Separately, apply trained LSTM autoencoder to time-series of outbound bytes per device. Alert on high model scores or detected anomalies."
  - question: "Is the Android Debug Bridge (adb.exe) being used on a host computer to execute process discovery commands like 'tasklist.exe' or 'Get-Process'?"
    context: "This question focuses on detecting the use of developer tools for malicious discovery. An adversary with physical access to a mobile device can connect it to a host computer and use ADB to run commands. Spawning process enumeration utilities from 'adb.exe' is a strong indicator of an attempt to inventory running processes on the connected device or the host itself."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows PowerShell Logging (Event ID 4104)"
      - "Employee workstations"
      - "developer machines"
      - "privileged user workstations"
      - "Jump servers"
      - "Virtual Desktop Infrastructure (VDI) instances"
    range: "last 90 days"
    queries:
      - "Search Windows process creation events (4688) where ParentProcessName is 'adb.exe' and NewProcessName is 'tasklist.exe', 'ps.exe', 'wmic.exe', or 'powershell.exe'. Check PowerShell logs (4104) for 'Get-Process'."
  - question: "Has an unusual or rare parent-child process relationship involving 'adb.exe' occurred, especially for a user role where it is not expected?"
    context: "This question uses environmental baselining to find anomalous behavior. While a developer might legitimately use 'adb.exe' to spawn certain processes, the same activity from a user in a non-technical role (e.g., Sales) is highly suspicious. Calculating the prevalence of specific parent-child process pairs for different user roles helps identify these outliers."
    answer_sources:
      - "Windows Event ID 4688"
      - "Active Directory for user roles"
      - "Employee workstations"
      - "developer machines"
      - "privileged user workstations"
      - "Jump servers"
      - "Virtual Desktop Infrastructure (VDI) instances"
    range: "last 90 days"
    queries:
      - "Calculate prevalence of (Parent='adb.exe', Child, User Role) tuples. Alert when a tuple with prevalence < 1% is observed or when a new tuple appears for a user role."
  - question: "Can a machine learning anomaly detection model identify suspicious process creation events involving 'adb.exe' based on the full context of the event?"
    context: "This question employs an unsupervised machine learning model (Isolation Forest) to detect anomalies without pre-existing rules. The model considers multiple features like the parent/child process names, the user, the host, and command-line characteristics. It is particularly effective at flagging rare combinations of these features, such as 'adb.exe' being used on a finance team member's computer, which would be a high-scoring anomaly."
    answer_sources:
      - "Windows Event ID 4688"
      - "Active Directory for user context"
      - "Employee workstations"
      - "developer machines"
      - "privileged user workstations"
      - "Jump servers"
      - "Virtual Desktop Infrastructure (VDI) instances"
    range: "last 90 days"
    queries:
      - "Apply trained Isolation Forest model to process creation event features. Alert on events flagged as high-scoring anomalies."
  - question: "Has a mobile device's status been reported as 'rooted' or 'jailbroken' by the MDM, and is it also communicating with network infrastructure known to be associated with mobile compromise tools?"
    context: "This question combines a high-fidelity host-based indicator (MDM status) with network indicators for confirmation. A 'rooted' or 'jailbroken' status change is a critical alert, as it means security controls have been bypassed. Correlating this with network connections to known malicious domains or IPs associated with rooting/jailbreaking tools provides strong evidence of a successful device compromise."
    answer_sources:
      - "Mobile Device Management (MDM) logs"
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek http.log"
      - "Zeek ssl.log"
      - "Threat intelligence feed"
      - "corporate network egress points"
      - "guest Wi-Fi networks"
      - "DNS resolvers"
      - "Cloud Access Security Broker (CASB) logs"
    range: "last 90 days"
    queries:
      - "Alert on MDM status change to 'rooted'/'jailbroken'. Separately, search for mobile device connections (DNS, HTTP, TLS, IP) to destinations on mobile compromise threat intelligence feed."
  - question: "Is a mobile device exhibiting a pattern of multiple, low-fidelity anomalous network behaviors that, when combined, indicate a high risk of compromise?"
    context: "This question aims to detect compromise by aggregating several weaker signals into a single risk score. An adversary might try to stay under the radar by avoiding single, high-severity actions. This approach detects such 'low and slow' activity by tracking statistical anomalies like connections to newly observed domains, use of non-standard ports, or connections with unusual TLS certificates. A device whose risk score crosses a threshold is flagged for review."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek ssl.log"
      - "Mobile Device Management (MDM) logs"
      - "corporate network egress points"
      - "guest Wi-Fi networks"
      - "DNS resolvers"
      - "Cloud Access Security Broker (CASB) logs"
    range: "last 90 days"
    queries:
      - "For each mobile device, calculate a risk score based on anomalies (connections to NODs, non-standard ports, anomalous TLS certs). Alert when the aggregate score exceeds a threshold."
  - question: "Can a machine learning-based domain reputation model, combined with time-series analysis, detect when a mobile device begins communicating with suspicious domains, potentially indicating compromise?"
    context: "This is a proactive, machine learning-driven approach to identify threats. A real-time domain reputation model (e.g., XGBoost) scores the risk of every domain a device contacts. A separate time-series model (e.g., SARIMA) then monitors the average reputation score for each device over time. A significant drop in this average score indicates the device has started communicating with riskier domains, which is a strong indicator of compromise. This can be automatically correlated with MDM alerts for confirmation."
    answer_sources:
      - "Zeek dns.log"
      - "Zeek ssl.log"
      - "Threat intelligence feeds"
      - "Mobile Device Management (MDM) logs"
      - "corporate network egress points"
      - "guest Wi-Fi networks"
      - "DNS resolvers"
      - "Cloud Access Security Broker (CASB) logs"
    range: "last 90 days"
    queries:
      - "Score all accessed domains with a reputation model. Use a time-series model to detect significant drops in a device's average destination reputation score. Correlate with MDM alerts."