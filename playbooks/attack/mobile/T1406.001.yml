name: T1406.001: Steganography
id: a1b9b2e1-8c48-4286-9a2c-98e3b3e2b1f0
description: This playbook is designed to help analysts determine if an adversary is using steganography to exfiltrate data from or introduce malicious tools to managed mobile devices. It provides investigative steps to detect steganography by analyzing network traffic, files on the device, and process behavior. The playbook focuses on identifying media files (e.g., PNG, JPG) that are transferred to or from known malicious destinations, exhibit anomalous sizes or high Shannon entropy, or are accessed by suspicious processes. It also includes methods for scanning mobile application binaries for known steganography libraries and using behavioral baselining and machine learning to detect anomalous sequences of events, such as a non-standard application reading a media file and immediately initiating a rare outbound network connection.
type: technique
related:
- TA0030: Defense Evasion
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Are media files being transferred to or from mobile devices associated with known malicious IP addresses or domains?
  context: This question aims to identify steganographic activity by correlating file transfers with threat intelligence. Adversaries often use compromised or malicious servers as command-and-control (C2) or exfiltration points. By checking the destination of media file transfers against a blocklist, analysts can quickly spot high-risk activity where media files could be used as containers for malicious data.
  answer_sources:
  - Zeek files.log
  - Zeek conn.log
  - Zeek http.log
  - Zeek dns.log
  - Corporate Wi-Fi network egress points
  - Guest Wi-Fi network segments
  - VPN concentrators serving mobile devices
  - Cloud storage service gateways
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: SEARCH files.log | JOIN uid with conn.log | JOIN uid with http.log, dns.log | LOOKUP threat_intelligence_feed on conn.log.id.resp_h or dns.log.query | WHERE lookup_match=true | RETURN file_info, conn_info, dns_query
- question: Are media files being transferred from or to mobile devices that are anomalously large or have unusually high entropy?
  context: This question seeks to detect steganography by identifying statistical outliers. Embedding data into a media file can increase its size. Likewise, encrypted or compressed hidden data often has high Shannon entropy, making the file appear more random than a typical image or video. Alerting on files that exceed the 99th percentile in size for their type or have an entropy score above 7.5 helps pinpoint files that warrant deeper inspection for hidden content.
  answer_sources:
  - Zeek files.log
  - Zeek conn.log
  - Zeek http.log
  - Zeek dns.log
  - Corporate Wi-Fi network egress points
  - Guest Wi-Fi network segments
  - VPN concentrators serving mobile devices
  - Cloud storage service gateways
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: SEARCH files.log | BASELINE 30d on seen_bytes by mime_type | CALCULATE 99th_percentile | CALCULATE shannon_entropy(file_content) | WHERE seen_bytes > 99th_percentile OR shannon_entropy > 7.5 | RETURN file_info
- question: Can we identify anomalous network file transfers from mobile devices that deviate from established benign behavior patterns?
  context: This question leverages machine learning to uncover subtle or complex patterns of steganographic activity that rule-based detections might miss. By training an anomaly detection model (like Isolation Forest) on multiple features (file size, MIME type, destination, etc.), we can score all new file transfers. Transfers with the highest anomaly scores represent the most significant deviations from the norm and should be prioritized for investigation as they may indicate sophisticated attempts to hide data.
  answer_sources:
  - Zeek files.log
  - Zeek conn.log
  - Zeek http.log
  - Zeek dns.log
  - Corporate Wi-Fi network egress points
  - Guest Wi-Fi network segments
  - VPN concentrators serving mobile devices
  - Cloud storage service gateways
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: INPUT files.log, conn.log, http.log | FEATURES file_size, mime_type, duration, dest_asn, ports, user_agent, time_of_day | TRAIN isolation_forest_model on benign_traffic | APPLY model to new_traffic | WHERE anomaly_score in top_1_percent | RETURN file_transfer_details
- question: Do any installed mobile applications contain known steganography libraries or functions?
  context: This question aims to proactively identify tools that an adversary might use for steganography. By scanning the binaries of installed applications for signatures of known steganography libraries (e.g., 'StegLib', 'LsbSteganography'), we can detect the presence of potentially malicious capabilities on a device, even if they haven't been used yet. A positive match is a strong indicator that the application is either malicious or dual-use and requires immediate investigation.
  answer_sources:
  - MDM Application Inventory Logs
  - Mobile EDR File Creation Events
  - Mobile EDR File Modification Events
  - Mobile Application Sandbox Analysis Reports
  - Managed mobile device fleet
  - Enterprise application store and repository
  - Mobile device sandboxing environment
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: FOREACH device in mdm_inventory | GET installed_apps (.apk, .ipa) | SCAN app_binary with steganography_yara_rule | WHERE yara_match=true | ALERT on device, app_name
- question: Are there any newly created or modified media files on mobile devices with a statistically significant deviation in entropy compared to their file type baseline?
  context: This question focuses on detecting hidden data within files at rest on a device. A z-score greater than 3 indicates that the file's entropy is more than three standard deviations away from the mean, making it a significant statistical outlier. This method is effective at finding files that have been manipulated to embed data, as this process alters the file's statistical properties.
  answer_sources:
  - MDM Application Inventory Logs
  - Mobile EDR File Creation Events
  - Mobile EDR File Modification Events
  - Mobile Application Sandbox Analysis Reports
  - Managed mobile device fleet
  - Enterprise application store and repository
  - Mobile device sandboxing environment
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: FOREACH file_type in ('.jpg', '.png', '.mp4') | BASELINE shannon_entropy to get mean(mu) and std_dev(sigma) | ON file_create or file_modify events | CALCULATE entropy(x) for new_file | CALCULATE z_score = (x - mu) / sigma | WHERE z_score > 3 | ALERT on file_name, device
- question: Can we predictively identify and score the risk of mobile applications being capable of steganography based on a combination of their characteristics?
  context: This question uses a supervised machine learning model to build a more holistic and predictive detection capability. Instead of relying on a single indicator, a Gradient Boosting Classifier can learn from multiple features—such as permissions, API calls, and code structure—to determine the likelihood that an application is malicious. This allows for the assignment of a risk score to every new or updated app, enabling a prioritized, risk-based approach to mobile application security.
  answer_sources:
  - MDM Application Inventory Logs
  - Mobile EDR File Creation Events
  - Mobile EDR File Modification Events
  - Mobile Application Sandbox Analysis Reports
  - Managed mobile device fleet
  - Enterprise application store and repository
  - Mobile device sandboxing environment
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: INPUT sandbox_reports, mdm_inventory | FEATURES permissions, yara_hits, api_calls, app_store, obfuscation_metrics | TRAIN gradient_boosting_model on labeled_apps (benign/malicious) | APPLY model to new_apps | WHERE risk_score > threshold | ALERT on app_name, risk_score
- question: Is a non-media-player process on a mobile device reading a media file and immediately contacting a known malicious IP address?
  context: This question aims to detect the "act" of data exfiltration using steganography. The logic is that a non-standard application (e.g., a calculator) reading a media file and then immediately making a network connection is highly suspicious. Correlating this behavior with a destination IP on a threat intelligence blocklist provides a high-fidelity alert, strongly indicating that a malicious process is reading a container file and exfiltrating its hidden contents.
  answer_sources:
  - Mobile EDR Process Events
  - Mobile EDR File Access Events
  - Mobile EDR Network Flow Logs
  - Zeek conn.log
  - Managed mobile device fleet
  - Corporate Wi-Fi network egress points
  - VPN concentrators
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: SEARCH edr_process_events AND edr_file_access AND edr_network_logs | GROUP by process_name, device_id | WHERE process_name NOT IN (media_app_allowlist) AND file_extension IN (media_files) AND network_direction=outbound | LOOKUP threat_intel on dest_ip | WHERE lookup_match=true AND time_diff(network_event, file_event) < 5s | ALERT on process_name, file_name, dest_ip
- question: Is a process on a mobile device reading a media file and then connecting to a network destination (ASN) that is rare for its normal behavior?
  context: This question seeks to identify anomalous network behavior following a media file access, even without threat intelligence. Applications typically communicate with a predictable set of Autonomous System Numbers (ASNs). If a process reads a media file and then connects to an ASN it has rarely or never contacted before, it suggests a deviation from normal operation. This could indicate that the process is exfiltrating data to a newly established, adversary-controlled endpoint.
  answer_sources:
  - Mobile EDR Process Events
  - Mobile EDR File Access Events
  - Mobile EDR Network Flow Logs
  - Zeek conn.log
  - Managed mobile device fleet
  - Corporate Wi-Fi network egress points
  - VPN concentrators
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: BASELINE process network connections by ASN frequency | ON file_read of media_file by process | CHECK subsequent network connection by same process | WHERE connection_ASN_frequency < 5th_percentile_for_process | ALERT on process_name, file_name, rare_ASN
- question: Can we detect anomalous sequences of system events on mobile devices that are indicative of steganographic activity?
  context: This question applies advanced sequence analysis to detect complex malicious behaviors. Adversary actions are not single events but a sequence of steps. An LSTM autoencoder can be trained on millions of benign event sequences. When it encounters a malicious sequence it has never seen, it will fail to reconstruct it accurately, resulting in a high "reconstruction error." This technique is powerful for detecting novel attack chains that defy simple correlation rules.
  answer_sources:
  - Mobile EDR Process Events
  - Mobile EDR File Access Events
  - Mobile EDR Network Flow Logs
  - Zeek conn.log
  - Managed mobile device fleet
  - Corporate Wi-Fi network egress points
  - VPN concentrators
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: STREAM edr_events (process_start, file_read, network_connect, etc.) | VECTORIZE and CREATE sequences | TRAIN lstm_autoencoder_model on benign_sequences | APPLY model to new_sequences | WHERE reconstruction_error > threshold | ALERT on anomalous_sequence, device