name: T1582: SMS Control
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: |
  This playbook helps determine if an adversary is manipulating SMS messages on mobile devices. This can involve an application being set as the default SMS handler that is not on an approved list or is rarely seen across the device fleet. Adversaries may set a malicious app as the default handler to intercept, modify, or delete messages [1][2]. It also investigates if an application has been granted SMS permissions where its category does not justify such access, or if its permission set is a statistical outlier, indicating potential over-permissioning for malicious activity [1]. Finally, it looks for evidence of a device sending SMS messages to known malicious numbers or exhibiting anomalous sending behavior (e.g., high volume, unusual frequency) compared to its baseline, which could indicate C2 communications, smishing, or fraud.
type: technique
related:
  - TA0034: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is the default SMS handler on any mobile device an unapproved application not on our established allowlist?
    context: |
      Adversaries can gain control over a user's text messages by designating a malicious application as the default SMS handler. This question aims to identify devices where the default handler is not a known, trusted application by comparing it against a curated allowlist of approved SMS app package names. An alert for an unapproved handler is a strong indicator of potential compromise.
    answer_sources:
      - MDM device_settings.log
      - MDM app_inventory.log
      - Centralized Mobile Device Management (MDM) and Mobile Threat Defense (MTD) Platforms; SIEM Log Aggregation Layer
    range: last 90 days
    queries:
      - search: pseudocode
        query: |
          SEARCH mdm_device_settings.log
          FOR each device
            GET default_sms_handler
            IF default_sms_handler NOT IN approved_sms_app_allowlist
              ALERT device_id, handler_name
  - question: Is any mobile device using a default SMS handler that has an unusually low prevalence across the entire device fleet?
    context: |
      Legitimate SMS applications are typically widely distributed. Malicious applications, on the other hand, may only be installed on a small number of targeted devices. This question seeks to identify these outliers by calculating the installation prevalence of every default SMS handler across the organization. A handler present on a very small percentage of devices (e.g., <1%) is suspicious and warrants investigation.
    answer_sources:
      - MDM device_settings.log
      - MDM app_inventory.log
      - Centralized Mobile Device Management (MDM) and Mobile Threat Defense (MTD) Platforms; SIEM Log Aggregation Layer
    range: last 90 days
    queries:
      - search: pseudocode
        query: |
          AGGREGATE mdm_app_inventory.log
          COUNT devices per default_sms_handler
          CALCULATE prevalence_percentage for each handler
          FOR each handler
            IF prevalence_percentage < 1%
              ALERT handler_name, list_of_affected_devices
  - question: Has our machine learning model identified any default SMS handler as potentially illegitimate with a high degree of confidence?
    context: |
      This question leverages a machine learning model to proactively identify malicious SMS handlers. The model analyzes various application features (permissions, developer, age, etc.) to predict legitimacy. An alert from this model, especially with a high confidence score (e.g., > $$ 0.9 $$), provides a sophisticated, data-driven signal that an application is likely malicious and requires immediate review.
    answer_sources:
      - MDM device_settings.log
      - MDM app_inventory.log
      - Centralized Mobile Device Management (MDM) and Mobile Threat Defense (MTD) Platforms; SIEM Log Aggregation Layer
    range: last 90 days
    queries:
      - search: pseudocode
        query: |
          SEARCH ml_model_predictions
          FOR each app scored as default_sms_handler
            IF prediction is 'not_legitimate' AND confidence_score > 0.9
              ALERT device_id, app_name, model_confidence
  - question: Are there any applications with SMS permissions whose functional category does not justify needing that level of access?
    context: |
      Adversaries often hide malicious functionality within seemingly benign applications. An application in a category like 'Games' or 'Utilities' typically has no legitimate reason to request permissions to send or receive SMS messages. This question identifies such mismatches, which are a strong indicator of a potentially malicious application attempting to gain unnecessary and dangerous permissions.
    answer_sources:
      - MDM app_permissions.log
      - MDM app_inventory.log
      - Application Risk Intelligence Feed
      - Centralized Mobile Device Management (MDM) Platform; Application Risk Intelligence Feeds; SIEM Log Aggregation Layer
    range: last 90 days
    queries:
      - search: pseudocode
        query: |
          DEFINE map of app_category to sms_permission_expected (boolean)
          SEARCH mdm_app_permissions.log
          FOR each app with 'SEND_SMS' or 'RECEIVE_SMS' permission
            GET app_category from mdm_app_inventory.log
            IF sms_permission_expected for category is false
              ALERT device_id, app_name, app_category
  - question: Do any applications with SMS permissions have a set of requested permissions that is a statistical outlier compared to legitimate apps in the same category?
    context: |
      Malicious apps often request an unusual combination of permissions to carry out their objectives. This question establishes a baseline of normal permission sets for trusted apps within a specific category (e.g., 'Communication'). It then compares other apps in that category against the baseline. An app with a low similarity score (e.g., Jaccard index $$ < 0.5 $$) has a statistically abnormal permission set and could be malicious.
    answer_sources:
      - MDM app_permissions.log
      - MDM app_inventory.log
      - Application Risk Intelligence Feed
      - Centralized Mobile Device Management (MDM) Platform; Application Risk Intelligence Feeds; SIEM Log Aggregation Layer
    range: last 90 days
    queries:
      - search: pseudocode
        query: |
          FOR each app_category
            CREATE baseline_permission_vector from top 50 apps
          FOR each app with SMS permissions
            CALCULATE jaccard_similarity of its permissions vs. category_baseline
            IF jaccard_similarity < 0.5
              ALERT device_id, app_name, similarity_score
  - question: Has a clustering algorithm identified any applications with a rare or unique combination of permissions that warrants investigation?
    context: |
      This question uses an unsupervised learning approach (e.g., DBSCAN) to find anomalies in application permissions without pre-defined rules. The algorithm groups applications with similar permission sets into clusters. Applications that do not fit into any cluster ('noise points') or form very small, isolated clusters have rare permission combinations that deviate from the norm, making them highly suspicious and worthy of manual analysis.
    answer_sources:
      - MDM app_permissions.log
      - MDM app_inventory.log
      - Application Risk Intelligence Feed
      - Centralized Mobile Device Management (MDM) Platform; Application Risk Intelligence Feeds; SIEM Log Aggregation Layer
    range: last 90 days
    queries:
      - search: pseudocode
        query: |
          VECTORIZE all app permission sets
          RUN DBSCAN clustering algorithm on vectors
          FOR each app classified as 'noise' or in a small cluster
            ALERT app_name, device_id, reason (noise/small_cluster)
  - question: Has any device sent an SMS message to a phone number known to be malicious based on our threat intelligence feeds?
    context: |
      A primary indicator of compromise is communication with known-bad infrastructure. This question directly addresses this by correlating outgoing SMS logs with a continuously updated feed of malicious phone numbers (Indicators of Compromise). A match provides a high-fidelity alert that a device is likely compromised and being used for activities like C2 communication or smishing-based malware propagation.
    answer_sources:
      - Carrier SMS Detail Records
      - Threat Intelligence Phone Number IOC Feed
      - MDM app_inventory.log
      - MDM device_state.log
      - Carrier Billing and Usage Portals; Threat Intelligence Platform (TIP); Mobile Device Management (MDM) Platform; SIEM Log Storage
    range: last 90 days
    queries:
      - search: pseudocode
        query: |
          INGEST threat_intel_phone_iocs
          SEARCH carrier_sms_logs
          FOR each outgoing SMS
            IF destination_number IN threat_intel_phone_iocs
              ALERT device_id, destination_number, source_user
  - question: Is any user exhibiting anomalous SMS activity, such as a sudden spike in volume or messages to unusual country codes, when compared to their historical baseline?
    context: |
      Adversaries using SMS for C2 or fraud often generate traffic that deviates from a user's normal behavior. This question establishes a rolling 90-day baseline of each user's typical SMS patterns (volume, destinations, etc.). It then alerts on significant deviations, such as a volume spike beyond the 98th percentile or messages to a new country code, which could indicate that the device is being used for unauthorized activity.
    answer_sources:
      - Carrier SMS Detail Records
      - Threat Intelligence Phone Number IOC Feed
      - MDM app_inventory.log
      - MDM device_state.log
      - Carrier Billing and Usage Portals; Threat Intelligence Platform (TIP); Mobile Device Management (MDM) Platform; SIEM Log Storage
    range: last 90 days
    queries:
      - search: pseudocode
        query: |
          FOR each user
            CALCULATE 90-day baseline (avg_volume, percentile_98, known_country_codes)
          SEARCH carrier_sms_logs in real-time
          IF daily_sms_count > percentile_98 OR destination_country_code NOT IN known_country_codes
            ALERT user_id, device_id, anomaly_type
  - question: Has our time-series anomaly detection model flagged any user's SMS communication rhythm as deviating significantly from their established normal behavior?
    context: |
      This question employs a sophisticated time-series model (e.g., LSTM autoencoder) to learn the intricate 'rhythm' of each user's SMS activity over time. The model can detect subtle anomalies that simple statistical thresholds might miss. An alert is generated when the live SMS pattern cannot be accurately 'reconstructed' by the model, indicating a significant break from normal behavior that should be investigated and automatically enriched with device context.
    answer_sources:
      - Carrier SMS Detail Records
      - Threat Intelligence Phone Number IOC Feed
      - MDM app_inventory.log
      - MDM device_state.log
      - Carrier Billing and Usage Portals; Threat Intelligence Platform (TIP); Mobile Device Management (MDM) Platform; SIEM Log Storage
    range: last 90 days
    queries:
      - search: pseudocode
        query: |
          FOR each user
            STREAM hourly SMS counts to LSTM autoencoder model
            CALCULATE reconstruction_error
            IF reconstruction_error > dynamic_threshold
              ALERT user_id, device_id, timestamp
              ENRICH alert with recent app installs and device state from MDM logs