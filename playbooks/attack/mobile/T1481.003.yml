name: T1481.003: One-Way Communication
id: e6a3d1b9-3f5c-4e8d-9a1b-2c3d4e5f6a7b
description: This playbook helps identify if an adversary is using legitimate external web services for one-way command and control (C2) against corporate mobile devices. It focuses on detecting two main patterns of evidence. The first is C2-like network beaconing from non-browser applications, characterized by highly regular, automated connections with low timing jitter, small outbound payloads, and a high outbound-to-inbound byte ratio. The second pattern involves mobile devices sending HTTP/S requests to legitimate services (like paste sites or code repositories) that exhibit multiple C2 characteristics, such as high-entropy URIs, unusual User-Agents, non-standard TLS client signatures (JA3), and mismatched content types, all of which are indicative of malware retrieving commands or payloads.
type: technique
related:
- TA0037: Command and Control
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Can suspicious network connections from mobile devices be correlated with a specific non-browser application and matched against known C2 endpoints?
  context: This question aims to attribute suspicious network traffic to a specific application on a mobile device. By correlating network logs (like Zeek) with Mobile Device Management (MDM) logs, an analyst can determine if traffic is coming from a legitimate browser or a potentially malicious, non-standard application. Cross-referencing the destination domain with threat intelligence feeds for known C2 endpoints provides strong confirmation of malicious activity.
  answer_sources:
  - Zeek conn.log
  - Zeek ssl.log
  - Zeek dns.log
  - MDM Application Logs
  - Threat Intelligence Feeds
  - Corporate Wi-Fi access points
  - VPN concentrators
  - Network egress points (Internet gateways)
  - The corporate Mobile Device Management (MDM) platform
  range: last 90 days
  queries:
  - tech: pseudocode
    query: FOR each suspicious connection from Zeek logs (dns.log, ssl.log): GET source_ip, destination_domain. QUERY MDM logs with source_ip to GET source_application. IF destination_domain IN threat_intel_c2_list AND source_application NOT IN browser_list: ALERT.
- question: Are any mobile devices exhibiting network beaconing behavior indicative of automated, non-interactive C2 communication?
  context: This question seeks to identify automated C2 beaconing by analyzing network traffic patterns. Unlike human-driven browsing, malware beacons often exhibit extremely regular timing (low jitter), send consistently small "heartbeat" packets, and have a high ratio of outbound to inbound data. Detecting a combination of these statistical outliers strongly suggests non-interactive, automated communication consistent with a C2 channel.
  answer_sources:
  - Zeek conn.log
  - Zeek ssl.log
  - Zeek dns.log
  - MDM Application Logs
  - Corporate Wi-Fi access points
  - VPN concentrators
  - Network egress points (Internet gateways)
  - The corporate Mobile Device Management (MDM) platform
  range: last 90 days
  queries:
  - tech: pseudocode
    query: GROUP Zeek conn.log by 1-hour window, source_ip, destination_server_name, destination_port. CALCULATE stdev(inter_arrival_time), percentile(orig_bytes, 95), sum(orig_bytes)/sum(resp_bytes), count(*). IF stdev < 5s AND percentile < 1024 AND ratio > 10 AND count > 10: ALERT.
- question: Can a machine learning model detect anomalous network behavior on a per-device basis that deviates from its established normal profile?
  context: This question leverages machine learning to establish a baseline of normal network activity for each individual mobile device. A time-series anomaly detection model (like an LSTM autoencoder) can learn a device's unique patterns. It then flags significant deviations from this learned profile, which can reveal novel or evasive C2 techniques that might not be caught by predefined static rules or signatures.
  answer_sources:
  - Zeek conn.log
  - Corporate Wi-Fi access points
  - VPN concentrators
  - Network egress points (Internet gateways)
  - The corporate Mobile Device Management (MDM) platform
  range: last 90 days
  queries:
  - tech: pseudocode
    query: FOR each device: AGGREGATE Zeek conn.log features in 5-min windows. TRAIN LSTM autoencoder on historical data. FOR new data: CALCULATE reconstruction_error. IF reconstruction_error > (rolling_avg_error + 3 * stdev_error): ALERT.
- question: Are mobile devices making suspicious HTTP/S requests to high-risk web services using non-standard clients?
  context: Adversaries often abuse legitimate services like GitHub or Pastebin to host malicious payloads. This question focuses on identifying these requests by looking for specific indicators of abuse. A request to a high-risk domain that contains keywords for raw content (e.g., '/raw/') and originates from an application that is not a standard mobile browser is a high-confidence indicator of malicious activity.
  answer_sources:
  - Zeek http.log
  - Zeek files.log
  - Zeek ssl.log
  - Corporate Wi-Fi access points
  - VPN concentrators
  - Forward proxy servers that perform TLS inspection
  range: last 90 days
  queries:
  - tech: pseudocode
    query: FROM Zeek http.log: SELECT requests WHERE source_ip IN mobile_range AND destination_domain IN high_risk_list AND (uri CONTAINS '/raw/' OR uri CONTAINS '/blob/') AND user_agent NOT IN mobile_browser_list. ALERT on matches.
- question: Can a risk score based on multiple HTTP/S request attributes identify C2 communication disguised as legitimate traffic?
  context: A single indicator may not be sufficient to identify malicious traffic. This question explores a "stacking" approach, where multiple weak indicators are combined into a single risk score. Characteristics like a high-entropy URI (indicating randomness), a rare User-Agent or JA3 hash, an unusual HTTP method, and a missing Referer header, when observed together, create a strong, composite signal that can effectively distinguish C2 traffic from benign anomalies.
  answer_sources:
  - Zeek http.log
  - Zeek files.log
  - Zeek ssl.log
  - Corporate Wi-Fi access points
  - VPN concentrators
  - Forward proxy servers that perform TLS inspection
  range: last 90 days
  queries:
  - tech: pseudocode
    query: FOR each HTTP request: CALCULATE uri_entropy, user_agent_frequency, ja3_hash_frequency, http_method_unusualness, referer_presence. COMBINE into risk_score. IF risk_score > threshold: ALERT.
- question: Can a supervised machine learning model be trained to assign a probability score of malicious C2 activity to each HTTP/S request?
  context: This question proposes using a supervised classification model (e.g., Random Forest) trained on historical, labeled data (both malicious and benign). By learning from a rich set of features from HTTP/S logs, the model can generate a probability score for each new request, indicating its likelihood of being malicious C2. This helps analysts prioritize their efforts by focusing on the requests with the highest probability scores.
  answer_sources:
  - Zeek http.log
  - Zeek files.log
  - Zeek ssl.log
  - Corporate Wi-Fi access points
  - VPN concentrators
  - Forward proxy servers that perform TLS inspection
  range: last 90 days
  queries:
  - tech: pseudocode
    query: FOR each HTTP request: EXTRACT features (uri_length, uri_entropy, user_agent_entropy, ja3, etc.). INPUT features into trained Random Forest model. GET 'malicious_probability' score. PRIORITIZE investigation for requests with high scores.