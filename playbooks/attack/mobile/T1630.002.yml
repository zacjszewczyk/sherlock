name: T1630.002: File Deletion
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: "This playbook helps determine if an adversary is deleting files or wiping data on corporate mobile devices to evade detection or cause impact. It addresses threats identified by monitoring for unauthorized applications gaining administrator privileges, anomalous high-volume file deletions, deletion of critical files from sensitive locations by unapproved processes, and large outbound data transfers immediately followed by file deletion activity on the same device."
type: technique
related:
  - TA0030: Defense Evasion
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has an application not on the corporate allowlist been granted device administrator privileges?
    context: This question aims to detect the initial stage of a potential attack where a malicious or unauthorized application gains elevated permissions. Granting administrator privileges to an unvetted application is a significant security risk, as it can allow the app to bypass security controls, access sensitive data, and perform destructive actions like file deletion.
    answer_sources:
      - MDM.PrivilegeGrantEvents
      - EDR.ApplicationInventoryLogs
      - Internal.CorporateAppAllowlist
      - Corporate-managed mobile devices (iOS, Android)
      - Mobile Device Management (MDM) Platform
      - Application Vetting System
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "SIEM Query: Search MDM logs for privilege grant events. For each event, check if the app's package name/cert hash exists in the corporate allowlist. Alert if not found."
  - question: Has there been an anomalous spike in the number of device administrator privilege grants across the mobile fleet?
    context: This question helps identify widespread or coordinated malicious activity. A sudden increase in privilege grants, even to seemingly legitimate apps, could indicate a supply chain attack, a misconfiguration pushed to devices, or an adversary attempting to gain a foothold on multiple devices simultaneously.
    answer_sources:
      - MDM.PrivilegeGrantEvents
      - EDR.ApplicationInventoryLogs
      - Internal.CorporateAppAllowlist
      - Corporate-managed mobile devices (iOS, Android)
      - Mobile Device Management (MDM) Platform
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "Time-series Analysis: Monitor the daily count of MDM privilege grant events. Calculate a 30-day rolling baseline (mean, std dev). Alert if the daily count exceeds mean + (3 * std dev)."
  - question: Has a device administrator privilege grant been flagged as high-risk by a machine learning model?
    context: This question leverages machine learning to detect subtle or novel threats that may not be caught by simple rules or baselines. The model analyzes multiple features (app category, permissions, reputation, etc.) to assess the risk of a privilege grant, helping to identify sophisticated malware or suspicious user behavior that mimics legitimate activity.
    answer_sources:
      - MDM.PrivilegeGrantEvents
      - EDR.ApplicationInventoryLogs
      - Internal.CorporateAppAllowlist
      - Corporate-managed mobile devices (iOS, Android)
      - Mobile Device Management (MDM) Platform
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "ML Model Query: Score new MDM privilege grant events using a pre-trained classification model. Alert if the risk score exceeds a defined threshold (e.g., > 0.8)."
  - question: Is a known malicious process or an unapproved process deleting files on a mobile device?
    context: This question focuses on identifying file deletion activity initiated by processes that are either confirmed malicious (on an IOC list) or are not recognized as legitimate system maintenance or uninstallation tools. This is a strong indicator of an adversary attempting to destroy data or cover their tracks.
    answer_sources:
      - EDR.FileModificationEvents
      - Android.Logcat
      - Internal.SystemProcessAllowlist
      - User data partitions on corporate mobile devices
      - MDM/EDR management console
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "SIEM Query: Monitor EDR file deletion events. Alert if the initiating process is on a malware IOC list OR is not on the system process allowlist."
  - question: Has a user or device exhibited an unusually high rate of file deletions in a short time frame?
    context: This question aims to detect wiper-like behavior by establishing a baseline of normal file deletion activity for each user or device. A sudden, rapid burst of deletions that exceeds the historical norm (99th percentile) can indicate a malicious process or compromised user account attempting to quickly erase data.
    answer_sources:
      - EDR.FileModificationEvents
      - Android.Logcat
      - Internal.SystemProcessAllowlist
      - User data partitions on corporate mobile devices
      - MDM/EDR management console
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "Streaming Analytics Query: For each device, count file deletions in a 5-minute rolling window. Compare count to a 30-day baseline (99th percentile). Alert if the current count exceeds the baseline."
  - question: Does the pattern of file deletions on a device deviate significantly from what a time-series model predicts as normal?
    context: This question uses advanced statistical modeling to identify anomalies in the rate of file deletions over time. Unlike a simple threshold, a time-series model can account for seasonality and trends, making it more effective at spotting unusual activity that might not be a simple spike but rather a sustained, abnormal level of deletions.
    answer_sources:
      - EDR.FileModificationEvents
      - Android.Logcat
      - Internal.SystemProcessAllowlist
      - User data partitions on corporate mobile devices
      - MDM/EDR management console
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "Time-series Model Query: For each device, monitor file deletion counts. Feed counts into a trained ARIMA/LSTM model. Alert if the observed count significantly deviates from the model's prediction."
  - question: Has an unapproved application deleted critical file types from a sensitive directory?
    context: This question is highly specific and aims to detect the targeted destruction of important corporate data. By correlating the file type, its location, and the legitimacy of the process deleting it, this query can generate high-fidelity alerts for potentially impactful data loss events.
    answer_sources:
      - EDR.FileModificationEvents
      - Internal.CorporateAppAllowlist
      - Sensitive data storage locations on mobile devices
      - Endpoint devices of high-value targets
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "SIEM Correlation Query: Alert on EDR file deletion events where file path is in sensitive list, file extension is in critical list, AND initiating process is not on the corporate app allowlist."
  - question: When a critical file is deleted, does the name of the process that deleted it appear to be randomly generated or obfuscated?
    context: This question serves as an enrichment and prioritization step for other alerts. Adversaries often use randomly generated names for their malware to evade signature-based detection. A high Shannon entropy score for a process name suggests obfuscation and increases the likelihood that the file deletion was malicious, justifying an immediate escalation.
    answer_sources:
      - EDR.FileModificationEvents
      - Internal.CorporateAppAllowlist
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "Alert Enrichment Logic: On alerts from the previous rule, calculate Shannon entropy of the process name. If entropy > 3.5, escalate alert priority to critical."
  - question: Has a user performed a file deletion that is inconsistent with their normal file access patterns?
    context: This question seeks to identify anomalous behavior at the user level. By clustering a user's typical interactions with files (processes used, file types, time of day), the system can learn what 'normal' looks like for that individual. A file deletion that falls outside these normal clusters is a strong indicator of a compromised account or insider threat.
    answer_sources:
      - EDR.FileModificationEvents
      - Internal.CorporateAppAllowlist
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "Behavioral Analytics Query: Cluster historical user file access events. For new file deletion events, check if the event is an outlier to the user's established clusters. Alert if outlier."
  - question: Has a mobile device connected to a known malicious destination and then immediately performed high-volume file deletions?
    context: This question aims to detect a classic attack sequence: exfiltrate data and then delete the evidence. Correlating network connections to known bad IPs with subsequent file deletion activity on the same device within a short time window provides strong evidence of a compromise and data breach.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - EDR.FileModificationEvents
      - MDM.DHCPLeaseLogs
      - Our organization's internet gateway
      - DNS resolvers
      - DHCP servers
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "Stateful SIEM Query: Correlate events in a 15-minute window. Alert if a mobile device connects to a blocklisted IP (Zeek) and then generates a high-volume file deletion alert (EDR). Use DHCP logs to map IP to device."
  - question: Has a user's device transmitted an anomalously large amount of outbound data, potentially followed by file deletion?
    context: This question looks for signs of bulk data exfiltration by baselining normal outbound traffic for each user. A significant deviation from this baseline is suspicious. Enriching this alert with any subsequent file deletion activity helps build a more complete picture of a potential data theft and cleanup operation.
    answer_sources:
      - Zeek conn.log
      - EDR.FileModificationEvents
      - MDM.DHCPLeaseLogs
      - Our organization's internet gateway
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "Time-series Analysis: Monitor daily outbound bytes per user (Zeek). Calculate a 30-day baseline (mean, std dev). Alert if daily total exceeds mean + (3 * std dev). Enrich with subsequent file deletion events."
  - question: Has a device exhibited a low-probability sequence of events, such as data exfiltration to a new domain followed by file deletion?
    context: This question uses advanced sequence analysis to identify attack patterns that may not be captured by simple correlation rules. A Recurrent Neural Network (RNN) can learn the normal temporal relationships between different event types. It can then flag sequences that are statistically unlikely, such as connecting to a brand-new domain, sending a large amount of data, and then wiping local files.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - EDR.FileModificationEvents
      - MDM.DHCPLeaseLogs
      - Our organization's internet gateway
      - Centralized Log Aggregator (SIEM)
    range: last 90 days
    queries:
      - "Sequence Analysis Model Query: Feed streams of Zeek and EDR logs into a trained RNN. Alert if the model detects a low-probability sequence, such as large data transfer to a new domain followed by high-volume file deletion."