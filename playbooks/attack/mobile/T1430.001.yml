name: T1430.001: Remote Device Management Services
id: f9a1b8d0-6c7e-4f5a-8b3d-1e9c0a7b6d5e
description: |
  This playbook helps to identify if an adversary is attempting to discover the physical location of managed mobile devices or is actively collecting location data through anomalous administrative access to Enterprise Mobility Management (EMM) or Mobile Device Management (MDM) services. Evidence of this activity includes successful administrative authentications to an EMM/MDM console that exhibit anomalous characteristics (e.g., source IP on a threat feed, novel geolocation, unusual login time, rare client fingerprint) when compared against a user-specific baseline. It also includes anomalous patterns of device location queries from an administrative account, such as a high rate of API calls, an unusually high number of unique devices being queried, scripted/automated activity indicated by low Shannon entropy, and a focus on high-value personnel.
type: technique
related:
  - TA0032: Discovery
  - TA0035: Collection
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has a successful administrative login to an EMM/MDM server occurred from an IP address on a threat intelligence feed or with a known malicious user-agent?
    context: |
      This question aims to detect high-confidence indicators of compromise by checking for administrative logins from sources already identified as malicious. A match against a threat intelligence feed or a known malicious user-agent signature provides a strong signal that an adversary is attempting to gain initial access to the mobile device management console for discovery or collection purposes.
    answer_sources:
      - Windows Event ID 4624
      - EMM/MDM application logs
      - Zeek conn.log
      - Zeek ssl.log
      - Zeek http.log
      - Zeek notice.log
      - EMM/MDM web application servers
      - Authentication servers (e.g., Domain Controllers)
      - Network egress points and web proxies
      - Administrative workstations and VDI environments
      - Cloud Identity Provider (IdP) consoles and logs
    range: last 90 days
    queries:
      - SIEM Query: Search for successful administrative logins (e.g., Event ID 4624, Logon Type 3/10) to EMM/MDM servers. Correlate the source IP with threat intelligence feeds. Correlate the HTTP user-agent with known malicious signatures.
  - question: Has an EMM/MDM administrator logged in with multiple characteristics that deviate from their established 90-day baseline?
    context: |
      This question focuses on detecting subtler, behavior-based anomalies. Adversaries may use compromised credentials from legitimate, non-malicious infrastructure. By baselining normal user behavior (source location, login times, client software fingerprints), we can identify logins that are statistically unlikely for a specific user, even if no single attribute is definitively malicious. A high cumulative risk score suggests a potential account takeover.
    answer_sources:
      - Windows Event ID 4624
      - EMM/MDM application logs
      - Zeek conn.log
      - Zeek ssl.log
      - Zeek http.log
      - Zeek notice.log
      - EMM/MDM web application servers
      - Authentication servers (e.g., Domain Controllers)
      - Network egress points and web proxies
      - Administrative workstations and VDI environments
      - Cloud Identity Provider (IdP) consoles and logs
    range: last 90 days
    queries:
      - Behavioral Analytics Query: For a given administrative login, compare source country/ASN, login hour, user-agent, and JA3/JA3S hash against the user's 90-day profile. Calculate a risk score based on deviations. Alert if the score exceeds a predefined threshold.
  - question: Have any recent administrative logins to the EMM/MDM console been flagged as highly anomalous by a machine learning model?
    context: |
      This question leverages advanced machine learning to identify complex and novel attack patterns that rule-based or simple statistical methods might miss. An unsupervised model learns the holistic pattern of normal login activity and can flag outliers that deviate in multiple, subtle ways. An alert from this model indicates a login event is in the top 1% of unusual activity and warrants immediate investigation for potential account compromise.
    answer_sources:
      - Windows Event ID 4624
      - EMM/MDM application logs
      - Zeek conn.log
      - Zeek ssl.log
      - Zeek http.log
      - Zeek notice.log
      - EMM/MDM web application servers
      - Authentication servers (e.g., Domain Controllers)
      - Network egress points and web proxies
      - Administrative workstations and VDI environments
      - Cloud Identity Provider (IdP) consoles and logs
    range: last 90 days
    queries:
      - ML Model Query: Query the output of the unsupervised anomaly detection model for any administrative login events with an anomaly score in the 99th percentile or higher.
  - question: Has a suspicious administrative login been immediately followed by a burst of device location queries from the same account?
    context: |
      This question directly links a suspicious access event to subsequent collection activity, significantly increasing the confidence of a true positive incident. An adversary who has just gained access will often move quickly to achieve their objectives. Correlating an anomalous login with a rapid series of location lookups within a short time window (e.g., 10 minutes) is a strong indicator of an active adversary attempting to track device locations.
    answer_sources:
      - EMM/MDM application logs
      - Zeek http.log
      - Zeek conn.log
      - Zeek dns.log
      - Zeek notice.log
      - EMM/MDM web application servers
      - Network egress points and web proxies
      - Cloud service access points (for iCloud/Google Find My)
      - DNS resolvers and forwarders
    range: last 90 days
    queries:
      - SIEM Correlation Query: Trigger on an anomalous login alert. Within 10 minutes, search for >5 location API calls from the same user/session. If found, generate a critical alert.
  - question: Is any single administrator account exhibiting statistically anomalous device location query behavior compared to their own baseline or the baseline of all administrators?
    context: |
      This question aims to detect an adversary using a compromised account for mass data collection. By establishing baselines for location query volume, the number of unique devices targeted, and the randomness of query timing (entropy), we can spot automated or scripted activity that deviates from normal human administrative behavior. This is crucial for detecting collection efforts that might otherwise be lost in the noise of daily operations, especially if they target high-value personnel.
    answer_sources:
      - EMM/MDM application logs
      - Zeek http.log
      - Zeek conn.log
      - Zeek dns.log
      - Zeek notice.log
      - EMM/MDM web application servers
      - Network egress points and web proxies
      - Cloud service access points (for iCloud/Google Find My)
      - DNS resolvers and forwarders
    range: last 90 days
    queries:
      - Behavioral Analytics Query: In a 1-hour window, check if a user's location API call count, unique device count, or request time entropy deviates significantly from their 30-day baseline or peer group norms. Also check for targeting of high-value groups.
  - question: Does the overall pattern of location query activity across the entire EMM/MDM platform show a significant deviation from the normal, forecasted behavior?
    context: |
      This question provides a macro-level view to detect large-scale or coordinated collection campaigns that might not be obvious when looking at individual user accounts. A time-series model can learn the normal rhythm of the entire system (total queries, unique users, etc.). A significant deviation from this learned pattern, indicated by a high reconstruction error, suggests a widespread event, such as an attack using multiple compromised accounts or a novel automated tool, affecting the platform as a whole.
    answer_sources:
      - EMM/MDM application logs
      - Zeek http.log
      - Zeek conn.log
      - Zeek dns.log
      - Zeek notice.log
      - EMM/MDM web application servers
      - Network egress points and web proxies
      - Cloud service access points (for iCloud/Google Find My)
      - DNS resolvers and forwarders
    range: last 90 days
    queries:
      - ML Model Query: Query the output of the multivariate time-series model for any time intervals where the system-wide activity's reconstruction error exceeds the 99.5% confidence threshold.