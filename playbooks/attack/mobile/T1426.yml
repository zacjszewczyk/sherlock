name: T1426: System Information Discovery
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: Is an adversary attempting to gather detailed system and hardware information from our mobile devices? This playbook helps identify attempts by an adversary to discover system information on a mobile device, typically by making programmatic API calls. This is often evidenced by the subsequent network exfiltration of this small data payload, which can manifest as HTTP/S connections with minimal outbound data to low-reputation domains, DNS tunneling via high-entropy subdomains, direct-to-IP connections with small payloads, or TLS sessions with rare or malicious JA3/JA3S fingerprints [1].
type: technique
related:
  - TA0032: Discovery
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are mobile devices connecting to known malicious indicators or showing signs of anomalous behavior associated with information gathering?
    context: This question aims to detect initial, high-confidence signs of compromise by cross-referencing network traffic from mobile devices against curated threat intelligence. It specifically looks for connections to known command-and-control (C2) servers, domains associated with malware, or the use of TLS fingerprints (JA3) linked to malicious tools. Additionally, it targets suspicious connections to newly registered domains, which are often used in the early stages of an attack, especially when combined with unusual User-Agent strings that might indicate automated scripting or fingerprinting tools rather than standard user activity.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - Zeek ssl.log
      - Zeek dns.log
      - Network egress points for corporate and guest Wi-Fi, VPN concentrators, enterprise DNS resolvers, and secure web gateways where mobile device traffic is inspected.
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH network_logs (dns, http, ssl) FROM mobile_device_ip_space WHERE (destination_ip OR destination_domain IN (c2_threat_intel_list OR malware_threat_intel_list)) OR (ja3_hash IN known_malicious_ja3_list) OR (destination_domain IN newly_registered_domain_list AND user_agent IS_anomalous)
  - question: Are there any mobile devices exhibiting a combination of statistically unusual network behaviors that indicate covert information exfiltration?
    context: This question focuses on detecting subtler, lower-confidence indicators that, when combined, can reveal a sophisticated attempt to gather and exfiltrate system information. Instead of relying on known-bad indicators, this approach establishes a baseline of normal network activity for each device and then flags significant deviations. It looks for high-entropy URLs or DNS queries (often used to encode data), rare TLS fingerprints, small data transfers to new destinations (characteristic of reconnaissance data exfiltration), and beaconing patterns. By aggregating these weak signals into a risk score, analysts can identify devices that warrant further investigation before a full-blown compromise occurs.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - Zeek ssl.log
      - Zeek dns.log
      - Network egress points for corporate and guest Wi-Fi, VPN concentrators, enterprise DNS resolvers, and secure web gateways where mobile device traffic is inspected.
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each mobile_device: CALCULATE risk_score = 0. IF shannon_entropy(dns_query OR uri) > 98th_percentile_baseline THEN risk_score += 10. IF ja3_hash_rarity < 1%_fleet_wide THEN risk_score += 15. IF outbound_payload_size BETWEEN 100B_and_5KB AND destination_ip IS_new_for_device THEN risk_score += 20. IF connection_timing_stddev < 2.0_seconds THEN risk_score += 25. IF risk_score > 30 THEN ALERT.
  - question: Can machine learning models identify complex, previously unseen patterns of malicious activity related to system information discovery?
    context: This question leverages advanced machine learning techniques to move beyond static rules and statistical baselines, aiming to uncover novel or evasive adversary tactics. It involves deploying specialized models to detect (1) Domain Generation Algorithms (DGAs), which are used by malware to create constantly changing C2 domains; (2) malicious TLS fingerprints, which can unmask specific malware families or hacking tools even over encrypted traffic; and (3) general network anomalies that deviate from established normal patterns. Correlating alerts from multiple models for the same event provides a high-fidelity signal that a device is likely compromised and is being used for reconnaissance.
    answer_sources:
      - Zeek conn.log
      - Zeek http.log
      - Zeek ssl.log
      - Zeek dns.log
      - Network egress points for corporate and guest Wi-Fi, VPN concentrators, enterprise DNS resolvers, and secure web gateways where mobile device traffic is inspected.
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each network_event: score_dga = DGA_MODEL(dns_query). score_tls = TLS_CLASSIFIER(ja3_hash). score_anomaly = ANOMALY_MODEL(connection_features). IF (score_dga > threshold AND score_tls > threshold) OR (score_dga > threshold AND score_anomaly > threshold) OR (score_tls > threshold AND score_anomaly > threshold) THEN CREATE_INCIDENT.