name: T1663: Remote Access Software
id: 3c961e68-967a-4712-9721-36427329124a
description: |
  This playbook is designed to detect adversaries leveraging legitimate remote access software for Command and Control on corporate mobile devices. It focuses on identifying unauthorized remote access through three primary methods: first, by matching network traffic against a watchlist of Indicators of Compromise (IoCs) for unapproved remote access tools and cross-referencing with UEM/MDM software inventories to confirm the software is not sanctioned. Second, it hunts for behavioral anomalies indicative of remote access, such as the use of non-standard ports, unusually high data volumes or connection durations, and high interactivity ratios suggestive of a hands-on-keyboard session. Third, the playbook detects blatant policy violations like unsolicited inbound connections from external IP addresses and identifies anomalous listening ports that could signify a backdoor, using both rule-based alerts and machine learning outlier detection.
type: technique
related:
  - TA0037: Command And Control
contributors: Zachary Szewczyk, Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are mobile devices connecting to network indicators (domains, IPs) associated with unapproved remote access software, and is this software absent from the device's approved application list?
    context: |
      This question aims to find direct evidence of unauthorized remote access tool usage by matching network traffic against known bad indicators from threat intelligence. A positive match, when correlated with the absence of the corresponding sanctioned application on the device's UEM/MDM profile, strongly suggests malicious activity or a severe policy violation.
    answer_sources:
      - Zeek dns.log
      - Zeek conn.log
      - Zeek ssl.log
      - UEM/MDM application inventory logs
      - Windows Event ID 5156
      - Network egress points (Internet gateway, VPN concentrators)
      - Corporate DNS resolvers
      - Forward web proxies (potentially Windows-based)
      - Unified Endpoint Management (UEM/MDM) platform API
    range: last 90 days
    queries:
      - pseudocode: |
          SEARCH network logs (DNS, connection, SSL) for destinations matching unapproved remote access IoC watchlist.
          ON MATCH from mobile IP, QUERY UEM/MDM API for installed apps on device.
          IF IoC-related app is NOT found, ALERT.
  - question: Are connections from mobile devices to unapproved remote access services showing unusually high data volume or connection duration compared to their historical baseline?
    context: |
      This question seeks to identify anomalous usage patterns even for connections that might otherwise be legitimate or unconfirmed as malicious. A significant spike in data transfer or connection time for a remote access service can indicate active C2 communication, data exfiltration, or prolonged remote control sessions, warranting investigation.
    answer_sources:
      - Zeek conn.log
      - UEM/MDM application inventory logs
      - Windows Event ID 5156
      - Network egress points (Internet gateway, VPN concentrators)
      - Corporate DNS resolvers
      - Forward web proxies (potentially Windows-based)
      - Unified Endpoint Management (UEM/MDM) platform API
    range: last 90 days
    queries:
      - pseudocode: |
          FOR EACH connection from mobile IP to unapproved remote access IoC, CALCULATE data volume and duration.
          COMPARE against 30-day rolling baseline for that user/service.
          IF volume/duration > 95th percentile, ALERT.
  - question: Can a machine learning model, trained on network connection features, automatically classify new connections from mobile devices as malicious remote access activity?
    context: |
      This question explores a proactive, automated detection method. By training a model on features like protocol, port, data volume, and IoC matches, the system can learn to identify complex patterns indicative of malicious remote access that might be missed by simple rule-based alerts. A high-confidence classification can trigger automated responses, reducing analyst workload and response time.
    answer_sources:
      - Zeek conn.log
      - UEM/MDM application inventory logs
      - Windows Event ID 5156
      - Network egress points (Internet gateway, VPN concentrators)
      - Corporate DNS resolvers
      - Forward web proxies (potentially Windows-based)
      - Unified Endpoint Management (UEM/MDM) platform API
    range: last 90 days
    queries:
      - pseudocode: |
          SCORE new mobile device connections using trained ML model.
          FEATURES: protocol, port, duration, bytes, IoC_match, approved_app_installed.
          IF score > 0.90 for 'malicious-remote-access', TRIGGER automated response.
  - question: Are mobile devices using legitimate remote access protocols (VNC, RDP, TeamViewer) over non-standard ports?
    context: |
      Adversaries often run services on non-standard ports to evade simple firewall rules and signature-based detection. This question aims to uncover this evasion technique by looking for a mismatch between the protocol identified by deep packet inspection and the port being used. Correlating this with other network anomalies can increase confidence that the activity is malicious.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek dpd.log
      - Network TAPs or SPAN ports on Wi-Fi access point uplinks
      - Core network switches segmenting mobile device traffic
      - Network gateways
    range: last 90 days
    queries:
      - pseudocode: |
          SEARCH for Zeek logs where (dpd.log or conn.log) identifies remote access protocol AND destination port is NOT the standard port for that protocol.
          ESCALATE if correlated with Zeek 'Long_Connection' or 'Protocol_Mismatch' notice.
  - question: Do any network connections from mobile devices exhibit both an unusually high interactivity ratio and a duration that are statistical outliers compared to the device's own baseline?
    context: |
      Interactive remote control sessions typically have a high ratio of packets to bytes (many small control packets) compared to bulk data transfers. This question looks for connections that are both long-lived and highly interactive, a behavioral fingerprint of a hands-on-keyboard C2 session. Simultaneously monitoring for a sudden increase in the variety of destination ports (entropy) can also indicate scanning or reconnaissance activity.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek dpd.log
      - Network TAPs or SPAN ports on Wi-Fi access point uplinks
      - Core network switches segmenting mobile device traffic
      - Network gateways
    range: last 90 days
    queries:
      - pseudocode: |
          FOR EACH TCP connection, CALCULATE interactivity ratio and duration.
          COMPARE against per-device 30-day baseline.
          IF both exceed 98th percentile, FLAG.
          SEPARATELY, monitor destination port entropy per device; ALERT on sharp increases.
  - question: Does a time-series anomaly detection model identify significant behavioral deviations in the aggregated network telemetry of any mobile device?
    context: |
      This question leverages machine learning to establish a comprehensive baseline of a device's "normal" network behavior over time. An LSTM autoencoder or similar model can learn this complex pattern and flag any significant deviation (high reconstruction error). This approach can detect novel or subtle attack techniques that don't match predefined rules or signatures.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek dpd.log
      - Network TAPs or SPAN ports on Wi-Fi access point uplinks
      - Core network switches segmenting mobile device traffic
      - Network gateways
    range: last 90 days
    queries:
      - pseudocode: |
          INGEST 1-minute vectors of device network telemetry into a trained LSTM autoencoder.
          IF reconstruction error for a device exceeds dynamic threshold, ALERT for behavioral anomaly.
          CORRELATE with other suspicious connection data.
  - question: Have any unsolicited, successful inbound connections from external, non-private IP addresses been made to corporate mobile devices?
    context: |
      Mobile devices, by policy, should not accept unsolicited inbound connections from the public internet. Any such connection represents a direct violation of a 'default-deny' security posture and is a critical indicator of a potential breach, such as a device compromised with a backdoor listening for commands. This requires immediate investigation.
    answer_sources:
      - Zeek conn.log
      - Zeek known_services.log
      - Firewall accept/deny logs
      - Perimeter firewall appliances
      - Network sensors at the internet gateway
      - Wi-Fi controllers
      - Mobile VPN concentrators
    range: last 90 days
    queries:
      - pseudocode: |
          CREATE critical alert.
          TRIGGER on any successful connection log (firewall or Zeek) WHERE source_IP is EXTERNAL and destination_IP is in MOBILE_DEVICE_RANGE.
  - question: Are any mobile devices listening on network ports that are statistically rare across the rest of the mobile device fleet and are not on an approved services list?
    context: |
      Malware and backdoors often open a listening port to await commands. While some apps legitimately open ports, a malicious listener is likely to be unique or rare across a large fleet of devices. This question aims to hunt for these anomalous listening services by comparing each device's open ports against the population norm and an approved list.
    answer_sources:
      - Zeek conn.log
      - Zeek known_services.log
      - Firewall accept/deny logs
      - Perimeter firewall appliances
      - Network sensors at the internet gateway
      - Wi-Fi controllers
      - Mobile VPN concentrators
    range: last 90 days
    queries:
      - pseudocode: |
          DAILY, inventory all listening ports on mobile fleet from known_services.log.
          FOR EACH device, identify listening ports present on <1% of the fleet AND not on approved list.
          ALERT on findings.
  - question: Can a clustering algorithm identify mobile devices that are outliers based on their inbound connection profiles?
    context: |
      This question uses an unsupervised machine learning approach to find "weird" devices without pre-defining what "weird" looks like. By clustering devices based on features like listening ports and inbound connection patterns, algorithms like DBSCAN can automatically isolate devices that do not conform to the behavior of their peers. These outliers are prime candidates for investigation.
    answer_sources:
      - Zeek conn.log
      - Zeek known_services.log
      - Firewall accept/deny logs
      - Perimeter firewall appliances
      - Network sensors at the internet gateway
      - Wi-Fi controllers
      - Mobile VPN concentrators
    range: last 90 days
    queries:
      - pseudocode: |
          CLUSTER mobile devices using DBSCAN/HDBSCAN on feature vectors (listening ports, inbound/outbound ratio, unique external sources).
          INVESTIGATE any device classified as a noise point (outlier).