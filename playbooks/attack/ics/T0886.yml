name: 'T0886: Remote Services'
id: 'f8a7b6c5-d4e3-4f2a-1b9c-8d7e6f5a4b3c'
description: "This playbook helps determine if an adversary is using remote services (such as RDP, VNC, or SSH) to gain initial access to the ICS network. It focuses on identifying two primary indicators of malicious activity: 1) Successful remote connections to critical OT assets from external sources that exhibit multiple anomalous characteristics simultaneously, such as originating from an unapproved IP address, occurring outside of standard business hours, or using a non-standard user account. 2) Brute-force or password spraying attacks against externally-facing OT assets, identified by a high rate of failed authentications from a single source, followed by a successful login from that same source."
type: 'technique'
related:
  - 'TA0108: Initial Access'
contributors:
  - 'Zachary Szewczyk'
  - 'Ask Sage'
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags:
  - 'none'
questions:
  - question: "Is there a successful remote service connection to a critical OT asset from a source not on the established access allow list?"
    context: "An allow list defines authorized remote access patterns (user, source, destination, port). A successful connection that violates this pre-defined policy is a high-fidelity indicator of either a misconfiguration or a potential compromise, as unauthorized entities should not be able to establish sessions with critical assets. This is often a first step in an intrusion."
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek rdp.log, Zeek ssh.log, Windows Event ID 4624, Microsoft-Windows-TerminalServices-LocalSessionManager/Operational Event ID 21"
      - "Named Areas of Interest: IT/OT Network Perimeter (ICS DMZ), Jump Servers, VPN Concentrators, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Networks (PCN)."
    range: "Last 90 days"
    queries:
      - "SIEM Pseudocode: |
          SEARCH successful_logins (e.g., Zeek conn_state='SF', ssh.log auth_success=T, EventID 4624 Logon Type 10)
          ON ports (22, 3389, 5900)
          TO critical_ot_assets
          WHERE (source_ip, user, destination_asset, port) NOT IN remote_access_allow_list"
  - question: "Has a remote service connection to a critical OT asset exhibited a combination of anomalous characteristics, such as a rare source ASN, unusual login time, or extended session duration?"
    context: "Adversaries often operate from infrastructure and at times that deviate from normal administrative or maintenance behavior. By baselining normal connection patterns (source locations, time-of-day, duration) and scoring new connections against this baseline, we can flag activity that is statistically unlikely. A connection with multiple anomalous factors has a higher probability of being malicious."
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek rdp.log, Zeek ssh.log, Windows Event ID 4624, Microsoft-Windows-TerminalServices-LocalSessionManager/Operational Event ID 21"
      - "Named Areas of Interest: IT/OT Network Perimeter (ICS DMZ), Jump Servers, VPN Concentrators, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Networks (PCN)."
    range: "Last 90 days"
    queries:
      - "SIEM Pseudocode: |
          FOR each new_connection to critical_ot_asset
          CALCULATE risk_score = 0
          IF source_asn is new_or_rare THEN risk_score += 1
          IF login_hour is >2_std_dev_from_mean THEN risk_score += 1
          IF session_duration is >95th_percentile THEN risk_score += 1
          IF risk_score >= 2 THEN ALERT"
  - question: "Has an unsupervised machine learning model identified a remote service session as anomalous based on a rare combination of features?"
    context: "While rule-based and statistical methods are effective, they may miss complex, novel attacks. An unsupervised ML model, like an Isolation Forest, can learn the normal multi-dimensional relationships between various session features (e.g., location, time, protocol, asset type, data volume). It can then identify sessions that are anomalous because their combination of feature values is rare and deviates significantly from all known normal patterns."
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek rdp.log, Zeek ssh.log, Windows Event ID 4624, Microsoft-Windows-TerminalServices-LocalSessionManager/Operational Event ID 21"
      - "Named Areas of Interest: IT/OT Network Perimeter (ICS DMZ), Jump Servers, VPN Concentrators, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Networks (PCN)."
    range: "Last 90 days"
    queries:
      - "ML Platform Pseudocode: |
          STREAM remote_session_data
          FEATURE_ENGINEER (geolocation, on_allow_list, asset_criticality, time_of_day, protocol, bytes_transferred)
          APPLY trained_isolation_forest_model
          WHERE anomaly_score > high_threshold
          THEN ALERT"
  - question: "Has a brute-force attempt, characterized by a high volume of failed logins from one source, been immediately followed by a successful login from that same source?"
    context: "This specific sequence of events is a classic and highly reliable indicator of a successful brute-force or password spraying attack. The initial storm of failed logins reveals the attempt, and the subsequent successful login from the same IP address confirms that the attacker has found valid credentials and gained access. Correlating these events is critical for timely detection."
    answer_sources:
      - "Data Sources: Windows Event ID 4625, Windows Event ID 4624, Zeek conn.log, Zeek ssh.log"
      - "Named Areas of Interest: Externally-facing remote access servers, Jump Servers, ICS DMZ, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Active Directory Domain Controllers within the OT environment."
    range: "Last 90 days"
    queries:
      - "SIEM Correlation Pseudocode: |
          TRIGGER on (
            COUNT(failed_logins, EventID 4625 OR ssh.log auth_success=F) > 20
            FROM same source_ip
            WITHIN 5 minutes
          )
          IF FOLLOWED BY (
            COUNT(successful_logins, EventID 4624 OR ssh.log auth_success=T) >= 1
            FROM same source_ip
            TO same destination_group
            WITHIN 15 minutes
          ) THEN ALERT"
  - question: "Is there a source IP exhibiting a failed login rate that exceeds its historical 99th percentile, which is then followed by a successful login?"
    context: "This is a statistical approach to detecting brute-force attacks that is more adaptive than a fixed threshold. By establishing a baseline of normal failed login rates for each source IP, the system can detect anomalous spikes in failures that are characteristic of an attack. Escalating the alert when a success follows the anomaly adds confirmation that the attack may have been successful, increasing the urgency of the response."
    answer_sources:
      - "Data Sources: Windows Event ID 4625, Windows Event ID 4624, Zeek conn.log, Zeek ssh.log"
      - "Named Areas of Interest: Externally-facing remote access servers, Jump Servers, ICS DMZ, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Active Directory Domain Controllers within the OT environment."
    range: "Last 90 days"
    queries:
      - "SIEM Pseudocode: |
          MONITOR failed_login_rate per source_ip
          IF current_rate > 99th_percentile_baseline(source_ip) THEN
            GENERATE low_priority_alert
            IF successful_login FROM same_ip occurs WITHIN 30 minutes THEN
              ESCALATE to high_priority_alert"
  - question: "Has a Hidden Markov Model detected a sequence of login events that transitions from a 'Brute-Force Attack' state to a 'Successful Compromise' state?"
    context: "A Hidden Markov Model (HMM) is a sophisticated, state-based approach for detecting attack patterns. It models sequences of events (logins, failures) rather than just counts. By training the model to recognize the probable sequence of an attacker's actions—transitioning from normal behavior to a high-rate 'Brute-Force' state and then to a 'Successful Compromise' state upon a successful login—it can detect the entire attack narrative, providing high-confidence alerts."
    answer_sources:
      - "Data Sources: Windows Event ID 4625, Windows Event ID 4624, Zeek conn.log, Zeek ssh.log"
      - "Named Areas of Interest: Externally-facing remote access servers, Jump Servers, ICS DMZ, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Active Directory Domain Controllers within the OT environment."
    range: "Last 90 days"
    queries:
      - "ML Platform Pseudocode: |
          STREAM login_events (success, fail) for each source-destination_pair
          APPLY trained_hmm_model
          IF model_state transitions to 'Successful_Compromise'
          THEN ALERT"