name: 'T0886: Remote Services'
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook addresses adversarial use of remote services (T0886) for both initial access into and lateral movement within an Industrial Control Systems (ICS) network. It provides investigative steps to detect unauthorized external access, such as connections from unknown sources or those exhibiting anomalous characteristics, as well as brute-force or password spraying attacks against internet-facing assets. The playbook also focuses on identifying internal lateral movement, including first-seen connections between OT assets, anomalous pivoting or scanning behavior, and the abuse of SMB for staging and executing malicious files on critical systems.
type: technique
related:
  - 'TA0108: Initial Access'
  - 'TA0109: Lateral Movement'
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is there a successful remote service connection to a critical OT asset from a source not on the established access control list?
    context: This question aims to detect unauthorized initial access attempts via remote services like RDP, SSH, or VNC. By maintaining an allow list of approved (Source IP, User, Destination Asset, Port) combinations, any successful connection not matching this list is highly suspicious. Such activity could represent an adversary who has bypassed perimeter controls and is attempting to establish a foothold on a critical asset like an HMI or EWS.
    answer_sources:
      - Zeek conn.log
      - Zeek rdp.log
      - Zeek ssh.log
      - Windows Event ID 4624
      - Microsoft-Windows-TerminalServices-LocalSessionManager/Operational Event ID 21
      - Data should be collected from IT/OT Network Perimeter (ICS DMZ), Jump Servers, VPN Concentrators, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, and Process Control Networks (PCN).
    range: last 90 days
    queries:
      - pseudocode: "SEARCH for successful remote logins (e.g., Zeek conn_state 'SF', ssh auth_success 'T', Event ID 4624 Logon Type 10) on ports 22, 3389, 5900. COMPARE the connection tuple (source, user, destination, port) against the authorized access allow list. ALERT if the tuple is not found."
  - question: Does a new remote connection to a critical OT asset exhibit multiple behavioral anomalies compared to its historical baseline?
    context: This question seeks to identify suspicious remote connections by scoring them based on deviations from normal, established patterns. Even if a source is not explicitly blocked, a connection originating from a new or rare network (ASN), occurring at an unusual time, or lasting for an atypical duration could indicate malicious activity. A cumulative risk score helps to surface connections that are subtly anomalous across several dimensions, reducing false positives from single deviations.
    answer_sources:
      - Zeek conn.log
      - Data should be collected from IT/OT Network Perimeter (ICS DMZ), Jump Servers, VPN Concentrators, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, and Process Control Networks (PCN).
    range: last 90 days
    queries:
      - pseudocode: "FOR each new connection to a critical asset: CALCULATE risk score. ADD +1 if source ASN is new/rare. ADD +1 if login time is >2 stddev from mean. ADD +1 if duration is >95th percentile. ALERT if total score >= 2."
  - question: Is an unsupervised machine learning model flagging a remote session as anomalous based on a rare combination of its characteristics?
    context: This question leverages machine learning to detect complex, non-obvious patterns of malicious remote access. An unsupervised model, like an Isolation Forest, can learn the normal multi-dimensional relationships between session features (geolocation, user, asset criticality, time, protocol, data volume). It can then identify sessions that are 'isolatable' or rare, even if no single feature is anomalous on its own. This is effective for detecting novel or sophisticated attacker techniques.
    answer_sources:
      - Zeek conn.log
      - Data should be collected from IT/OT Network Perimeter (ICS DMZ), Jump Servers, VPN Concentrators, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, and Process Control Networks (PCN).
    range: last 90 days
    queries:
      - pseudocode: "FOR each new remote session: CREATE feature vector (geolocation, allow_list_status, asset_criticality, time, protocol, bytes). APPLY trained anomaly detection model (e.g., Isolation Forest). ALERT if session receives a high anomaly score."
  - question: Has a brute-force or password spraying attack against an OT asset, characterized by a high volume of failed logins, resulted in a successful authentication from the same source?
    context: This question aims to detect a classic brute-force or password spraying pattern. Adversaries often try many password combinations (generating failed logins) before finding a valid one. Correlating a burst of failed authentications from a single IP with a subsequent successful login from that same IP within a short time window is a high-fidelity indicator of a compromised account.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek ssh.log
      - Data should be collected from Externally-facing remote access servers, Jump Servers, ICS DMZ, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), and Active Directory Domain Controllers within the OT environment.
    range: last 90 days
    queries:
      - pseudocode: "COUNT failed logins (Event ID 4625, ssh auth_success 'F') per source IP in a 5-min window. IF count > 20, THEN monitor source IP for 15 mins. ALERT if a successful login (Event ID 4624, ssh auth_success 'T') from that IP to a targeted destination occurs."
  - question: Is a specific source IP generating a statistically anomalous rate of failed logins against an OT asset compared to its historical baseline?
    context: This question identifies potential brute-force attacks by focusing on statistical deviations rather than fixed thresholds. A 'low-and-slow' attack might not trigger a rule looking for 20 failures in 5 minutes. By baselining the normal failed login rate for each source IP and asset, this method can detect attackers who are attempting to stay under the radar by using a lower-than-normal but still anomalous rate of login attempts. Escalating the alert upon a subsequent success adds crucial context.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek ssh.log
      - Data should be collected from Externally-facing remote access servers, Jump Servers, ICS DMZ, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), and Active Directory Domain Controllers within the OT environment.
    range: last 90 days
    queries:
      - pseudocode: "FOR each source IP/asset pair: BASELINE failed login rate (count/min) over 30 days and find 99th percentile. MONITOR real-time rate. ALERT if rate exceeds 99th percentile. ESCALATE if a successful login from the same source occurs within 30 mins."
  - question: Has a sequence of login events for a source-destination pair transitioned into a 'Successful Compromise' state as determined by a Hidden Markov Model?
    context: This question uses a stateful, sequence-aware machine learning model (HMM) to detect the narrative of an attack. An HMM can learn the probabilities of transitioning between different states of activity, such as 'Normal', 'Brute-Forcing', and 'Compromised'. It can identify an attack pattern not just as a collection of individual events, but as a probable sequence, making it highly effective at spotting the logical progression from reconnaissance/brute-force to successful access.
    answer_sources:
      - Windows Event ID 4625
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek ssh.log
      - Data should be collected from Externally-facing remote access servers, Jump Servers, ICS DMZ, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), and Active Directory Domain Controllers within the OT environment.
    range: last 90 days
    queries:
      - pseudocode: "MODEL login event streams using a trained HMM with states 'Normal', 'Brute-Force', 'Compromise'. APPLY model to live event streams. ALERT when the model's most probable path for an observed sequence transitions to the 'Compromise' state."
  - question: Has a new, never-before-seen internal remote connection occurred between two OT assets?
    context: This question aims to detect lateral movement within the OT network. Internal OT networks often have highly predictable and static communication patterns. By baselining all normal source-destination-port-user combinations, any new, unobserved connection is inherently suspicious. This could indicate an adversary who has compromised one host (e.g., an EWS) and is now using it to pivot to another (e.g., an HMI) in a way that is not part of standard operational workflows.
    answer_sources:
      - Zeek rdp.log
      - Zeek conn.log
      - Zeek ssh.log
      - Windows Event ID 4624
      - Data should be collected from Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Servers, Programmable Logic Controllers (PLCs), Remote Terminal Units (RTUs), and Internal OT network segments.
    range: last 90 days
    queries:
      - pseudocode: "CREATE a baseline set of all (source, destination, port, user) tuples from the last 90 days. FOR each new internal connection, CHECK if the tuple exists in the baseline set. ALERT if the tuple is not found."
  - question: Is an internal OT host suddenly connecting to an unusually high or diverse number of other hosts?
    context: This question seeks to identify lateral movement reconnaissance or widespread pivoting. A compromised host may be used by an attacker to scan the network or connect to multiple targets. Monitoring 'fan-out' (the number of unique destinations) and 'destination entropy' (the randomness of the destinations) can detect this behavior. A sudden spike in either metric for a specific host, compared to its own baseline, suggests it may be compromised and used for internal discovery or movement.
    answer_sources:
      - Zeek rdp.log
      - Zeek conn.log
      - Zeek ssh.log
      - Windows Event ID 4624
      - Data should be collected from Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Servers, Programmable Logic Controllers (PLCs), Remote Terminal Units (RTUs), and Internal OT network segments.
    range: last 90 days
    queries:
      - pseudocode: "FOR each host, BASELINE daily fan-out (unique destinations) and destination entropy over 30 days. CALCULATE 95th percentile for both metrics. ALERT if a host's daily fan-out or entropy exceeds its 95th percentile threshold."
  - question: Has a graph-based anomaly detection model identified a new, low-probability remote connection within the OT network graph?
    context: This question applies graph analytics to detect anomalous lateral movement. By modeling the network as a graph of hosts and connections, we can analyze the network's structure and relationships. A graph-based model (like GraphSAGE) can learn what 'normal' connections look like based on node properties (asset type, criticality) and graph structure. It can then flag new connections that are structurally improbable, such as a direct RDP session between two HMIs in different process areas, which would be highly unusual and suspicious.
    answer_sources:
      - Zeek rdp.log
      - Zeek conn.log
      - Zeek ssh.log
      - Windows Event ID 4624
      - Data should be collected from Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Servers, Programmable Logic Controllers (PLCs), Remote Terminal Units (RTUs), and Internal OT network segments.
    range: last 90 days
    queries:
      - pseudocode: "MODEL the OT network as a graph (nodes=hosts, edges=connections). TRAIN a graph anomaly detection model (e.g., GraphSAGE) on historical graph structure. APPLY model to detect new connections. ALERT on the creation of edges with a low probability score."
  - question: Has a suspicious file been transferred to a critical OT asset's administrative share and then executed shortly after?
    context: This question targets a common lateral movement TTP using SMB to transfer malicious tools and then executing them. This multi-step correlation is a high-fidelity indicator of compromise. It specifically looks for the sequence of an administrative share access, followed by the transfer of a potentially malicious file type (like an executable, script, or ICS project file), and culminating in the execution of that file on the target host. This chain of events strongly suggests an attacker is staging and running payloads.
    answer_sources:
      - Zeek smb_mapping.log
      - Zeek smb_files.log
      - Windows Event ID 5145
      - Windows Event ID 4688
      - Data should be collected from Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Servers, Domain Controllers within the OT network, File Servers, and Internal OT network segments.
    range: last 90 days
    queries:
      - pseudocode: "CORRELATE the following sequence: 1. SMB access to admin share (C$, ADMIN$) (Event ID 5145). 2. File write of suspicious type (.exe, .ps1, .L5K) from same source (smb_files.log). 3. Process creation for that filename on destination within 10 mins (Event ID 4688). ALERT on sequence completion."
  - question: Is a user accessing an administrative share for the first time, or is an unusual volume or type of file being transferred via SMB between hosts?
    context: This question uses behavioral baselining to detect anomalous SMB activity indicative of lateral movement. There are two parts: first, detecting a user accessing a sensitive administrative share they've never touched before, which could indicate credential theft. Second, detecting an abnormal transfer, such as an unusually large amount of data or a transfer of a single, non-standard file type (low file extension entropy), which could represent tool or data staging. Both are deviations from established normal behavior.
    answer_sources:
      - Zeek smb_mapping.log
      - Zeek smb_files.log
      - Windows Event ID 5145
      - Data should be collected from Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Servers, Domain Controllers within the OT network, File Servers, and Internal OT network segments.
    range: last 90 days
    queries:
      - pseudocode: "BASELINE user access to admin shares. ALERT on first-time access by a user to a share. SEPARATELY, baseline SMB data volume and file extension entropy per host pair. ALERT if volume > 3 stddev from mean or if entropy is abnormally low."
  - question: Has a UEBA model identified an SMB session as a significant outlier compared to all established clusters of normal behavior?
    context: This question uses advanced clustering-based anomaly detection to find truly unique and suspicious SMB activity. A UEBA model like DBSCAN groups all historical SMB sessions into clusters of 'normal' activity based on multiple features (user, source, destination, file type, etc.). Any new activity that does not fit into any existing cluster is flagged as 'noise' or an outlier. This is a powerful technique for catching novel attack patterns that don't match any pre-defined rules or simple statistical thresholds.
    answer_sources:
      - Zeek smb_mapping.log
      - Zeek smb_files.log
      - Windows Event ID 5145
      - Data should be collected from Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Servers, Domain Controllers within the OT network, File Servers, and Internal OT network segments.
    range: last 90 days
    queries:
      - pseudocode: "FOR each SMB session, create feature vector (user, source, dest_type, share, file_ext, size, time). APPLY clustering model (e.g., DBSCAN) to all sessions. ALERT on any new session that is classified as a noise point (outlier)."