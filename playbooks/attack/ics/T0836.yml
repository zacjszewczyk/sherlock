name: T0836: Modify Parameter
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook focuses on detecting the modification of critical control system parameters, a technique adversaries can use to disrupt industrial processes, potentially causing loss of productivity or revenue. It investigates anomalous write operations to parameters like setpoints or valve positions by analyzing ICS protocol logs and correlating them with host events and contextual data. Detections range from checking against static allowlists and safety limits to baselining for statistical deviations and using machine learning models to identify complex malicious patterns. The goal is to determine if an adversary's actions have resulted in the unauthorized or dangerous alteration of process control variables.
type: technique
related:
  - TA0105: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is a critical control system parameter being modified by an unauthorized source or with a value outside of established safety limits?
    context: This question aims to identify clear-cut violations of operational policy. By maintaining a strict allowlist of authorized sources (workstations, user accounts) and pre-defined safe value ranges for critical parameters, analysts can quickly detect and alert on unauthorized write operations. This is a foundational detection method that leverages ICS protocol logs (Zeek), host-level user authentication logs (Windows Event ID 4624), and operational context from change management systems to identify high-confidence malicious or accidental misconfigurations.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Historian Process Data
      - Change Management System Logs
      - ICS Control Network (Purdue Model Levels 1 & 2) for PLC/RTU traffic
      - Engineering Workstations (EWS) and HMIs for host logs and command origination context
      - Process Historian servers for correlating network events with physical process impact
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH Zeek ICS logs (modbus, dnp3, enip) for write functions.
          FILTER for target parameters on a pre-defined critical asset list.
          JOIN with Windows Event ID 4624 logs on source IP to find the associated user account.
          ALERT IF (source IP is NOT in IP_allowlist) OR (user account is NOT in user_allowlist) OR (written value is OUTSIDE of pre-defined safety_range).
          SUPPRESS alert if a matching approved change is found in the Change Management System for the event's timeframe.
  - question: Has a critical control system parameter been modified with an anomalous value or at an unusual frequency compared to its historical baseline?
    context: This question addresses more subtle manipulations that may not violate hard-coded safety limits but are statistically unusual. By establishing a rolling baseline (e.g., over 30 days) for a parameter's normal value and the frequency of its modification, analysts can detect deviations that suggest abnormal activity. A sudden spike in write frequency or a value that is technically "safe" but statistically improbable can be an early indicator of an adversary testing capabilities or attempting a slow, low-impact manipulation. Enriching these alerts with the parent process name (from Windows Event ID 4688) helps identify the software or script that initiated the command.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Historian Process Data
      - Change Management System Logs
      - ICS Control Network (Purdue Model Levels 1 & 2) for PLC/RTU traffic
      - Engineering Workstations (EWS) and HMIs for host logs and command origination context
      - Process Historian servers for correlating network events with physical process impact
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each critical parameter:
            CALCULATE 30-day rolling baseline (mean, std_dev) for its value and its hourly write frequency from Zeek and Historian data.
          ON new write event from Zeek ICS logs:
            CALCULATE current hourly write frequency.
            ALERT IF (new_value > (value_mean + 3 * value_std_dev)) OR (current_frequency > (frequency_mean + 3 * frequency_std_dev)).
            ENRICH alert by joining source IP and timestamp with Windows Event ID 4688 to find the parent process name.
  - question: Does a parameter modification event exhibit characteristics similar to previously identified malicious activity, based on a machine learning model?
    context: This question seeks to identify complex, multi-faceted attack patterns that are difficult to define with simple rules or statistical thresholds. By training a machine learning model (e.g., a Random Forest classifier) on a rich set of features—including network data (IPs, function), host data (user, process), and contextual data (time of day)—the system can learn the subtle distinctions between benign and malicious parameter modifications. This approach is powerful for detecting novel attacks or anomalous combinations of legitimate actions, providing a score-based assessment of risk rather than a binary pass/fail.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Historian Process Data
      - Change Management System Logs
      - ICS Control Network (Purdue Model Levels 1 & 2) for PLC/RTU traffic
      - Engineering Workstations (EWS) and HMIs for host logs and command origination context
      - Process Historian servers for correlating network events with physical process impact
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          ON new write event from Zeek ICS logs:
            CREATE feature vector including:
              - source/destination IP, ICS function, address, value from Zeek.
              - user account from Windows Event ID 4624.
              - parent process from Windows Event ID 4688.
              - time-of-day, day-of-week.
            PREDICT classification and confidence score using pre-trained ML model.
            ALERT IF classification is 'malicious' AND confidence_score > 0.9.