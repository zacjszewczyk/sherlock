name: T0836: Modify Parameter
id: 5a9b1c2d-3e4f-4a6b-8c7d-9e0f1a2b3c4d
description: This playbook helps identify if an adversary's action has resulted in a disruption of critical industrial processes by modifying control system parameters. It focuses on detecting write operations targeting critical parameters (e.g., setpoints, valve positions) that are anomalous. Anomalies are defined by several criteria: the new value falls outside engineering safety limits, it deviates significantly from a statistical baseline, the command originates from an unauthorized source (IP or user), it occurs outside a maintenance window without a change ticket, or it is immediately followed by a process alarm or anomalous physical state change. The goal is to detect unauthorized or malicious parameter changes that could lead to a measurable loss of productivity or revenue.
type: technique
related:
  - TA0105: Impact
contributors:
  - Zachary Szewczyk, Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are write operations to critical ICS parameters originating from unauthorized sources or using values outside of pre-defined safety limits, when not associated with a scheduled change?
    context: This question aims to detect blatant violations of operational and safety policies. By maintaining a strict allowlist of authorized users, source systems, and safe parameter value ranges, security teams can quickly identify high-risk activities. Correlating these events with the change management system is crucial to filter out legitimate, planned maintenance, thereby reducing false positives and allowing analysts to focus on genuinely suspicious modifications that could indicate an attack.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Historian Process Data
      - Change Management System Logs
      - ICS Control Network (Purdue Model Levels 1 & 2) for PLC/RTU traffic
      - Engineering Workstations (EWS) and HMIs for host logs and command origination context
      - Process Historian servers for correlating network events with physical process impact
    range: last 90 days
    queries:
      - query: pseudocode
        description: >
          FOR each write_operation in (Zeek modbus.log, dnp3.log, enip.log)
          IF write_operation.target_address is in critical_parameter_list THEN
            source_user = CORRELATE write_operation.source_ip with WinEventID:4624
            is_authorized_source = CHECK if (write_operation.source_ip, source_user) is in source_allowlist
            is_safe_value = CHECK if write_operation.value is within safety_range for target_address
            is_in_maintenance = QUERY change_management_system for active ticket matching (source, target, time)
            IF (NOT is_authorized_source OR NOT is_safe_value) AND NOT is_in_maintenance THEN
              GENERATE high_severity_alert
            ENDIF
          ENDIF
          ENDFOR

  - question: Have there been statistically anomalous modifications to critical ICS parameters, either in value or frequency, that deviate significantly from established historical baselines?
    context: This question addresses more subtle threats that may not violate hard-coded rules but are statistically unusual. Adversaries may attempt "low-and-slow" attacks, making small parameter changes that fall within safety limits but collectively disrupt a process over time. By baselining both the parameter values and the frequency of write operations, analysts can detect deviations from normal operational rhythm. A sudden spike in write frequency, even with valid values, or a value that is technically safe but statistically improbable, can be an early indicator of malicious manipulation.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Historian Process Data
      - Change Management System Logs
      - ICS Control Network (Purdue Model Levels 1 & 2) for PLC/RTU traffic
      - Engineering Workstations (EWS) and HMIs for host logs and command origination context
      - Process Historian servers for correlating network events with physical process impact
    range: last 90 days
    queries:
      - query: pseudocode
        description: >
          FOR each write_operation to a critical_parameter
            value_baseline = GET 30-day rolling (mean, std_dev) for parameter_value
            frequency_baseline = GET 30-day rolling (mean, std_dev) for write_frequency_per_hour
            is_value_anomaly = ABS(write_operation.value - value_baseline.mean) > (3 * value_baseline.std_dev)
            is_frequency_anomaly = current_write_frequency > (frequency_baseline.mean + 3 * frequency_baseline.std_dev)
            IF is_value_anomaly OR is_frequency_anomaly THEN
              parent_process = CORRELATE with WinEventID:4688 from source_ip
              GENERATE medium_severity_alert with (value_anomaly, frequency_anomaly, parent_process)
            ENDIF
          ENDFOR

  - question: Can a machine learning model, trained on historical data, identify malicious parameter modification events in real-time with high confidence?
    context: This question explores the use of advanced analytics to detect complex attack patterns that are difficult to define with static rules or simple statistics. A supervised machine learning model, such as a Random Forest, can learn the intricate relationships between various network features (IPs, ports, function codes), host data (user accounts, processes), and contextual information (time of day). By training the model on labeled historical data (distinguishing between known-good changes and confirmed malicious incidents), it can develop a nuanced understanding of what constitutes a threat and identify novel malicious events with a high degree of confidence.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Historian Process Data
      - Change Management System Logs
      - ICS Control Network (Purdue Model Levels 1 & 2) for PLC/RTU traffic
      - Engineering Workstations (EWS) and HMIs for host logs and command origination context
      - Process Historian servers for correlating network events with physical process impact
    range: last 90 days
    queries:
      - query: pseudocode
        description: >
          ON new write_event
            # Feature engineering
            source_user = GET_user_from_ip(event.source_ip)
            parent_process = GET_process_from_ip(event.source_ip)
            time_of_day = GET_hour(event.timestamp)
            day_of_week = GET_day(event.timestamp)
            feature_vector = [event.source_ip, event.dest_ip, event.function, event.value, source_user, parent_process, time_of_day, day_of_week]
            # Scoring
            prediction_score = random_forest_model.predict(feature_vector)
            # Alerting
            IF prediction_score.class == 'malicious' AND prediction_score.confidence > 0.9 THEN
              GENERATE alert with (event_details, prediction_score)
            ENDIF
          ENDON