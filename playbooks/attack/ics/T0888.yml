name: "T0888: Remote System Information Discovery"
id: "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
description: "This playbook helps determine if an adversary is actively discovering detailed information about remote Industrial Control Systems (ICS) and their peripherals. It focuses on identifying unauthorized or anomalous discovery activity originating from both external and internal sources. Evidence includes unauthorized systems initiating ICS discovery protocol requests (e.g., Modbus, DNP3, EtherNet/IP), authorized systems exhibiting behavior that deviates from historical norms, and un-whitelisted processes on OT hosts initiating scans of ICS devices. The goal is to detect reconnaissance efforts targeting critical OT assets."
type: "technique"
related:
  - "TA0102: Discovery"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: "1.0"
tags: "none"
questions:
  - question: "Is an unauthorized source IP conducting a discovery sweep against multiple ICS devices?"
    context: "This question aims to identify reconnaissance activity from an IP address that is not on the pre-approved list of systems authorized to perform OT management tasks. Detecting an un-whitelisted IP using specific ICS discovery protocols is a high-fidelity indicator of a potential threat. Escalating this detection when the IP scans multiple (e.g., >5) unique devices in a short time frame (e.g., 60 seconds) helps prioritize a likely automated sweep, which is a common precursor to an attack."
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log, Windows Event ID 4624"
      - "Network and Asset Information: OT network segments (e.g., Process Control Network VLANs, Safety Instrumented System networks), network traffic aggregation points (e.g., span ports on core switches), Industrial Demilitarized Zone (IDMZ) gateways, and subnets containing SCADA servers, Engineering Workstations, or Data Historians."
    range: "last 90 days"
    queries:
      - "Pseudocode: Search Zeek logs for ICS discovery function codes (Modbus 43, DNP3 obj_grp 10, ENIP ListIdentity). For each event, check if source IP is NOT in the authorized OT management host whitelist. If true, generate an alert. For that source IP, count unique destination IPs within a 60-second window. If count > 5, escalate the alert priority."
  - question: "Is an authorized OT management system exhibiting anomalous discovery behavior?"
    context: "This question addresses the insider threat or compromised host scenario, where a legitimate, whitelisted system is used for malicious discovery. Since the source is trusted, simple whitelisting is ineffective. This query establishes a historical baseline of normal activity for each authorized host and alerts when behavior significantly deviates (e.g., exceeds the 95th percentile for both the number of discovery requests and unique devices contacted). This indicates that the host is being used in an unusual, potentially malicious, manner. Correlating with user login data can help identify the responsible user or a potential account compromise."
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log, Windows Event ID 4624"
      - "Network and Asset Information: OT network segments (e.g., Process Control Network VLANs, Safety Instrumented System networks), network traffic aggregation points (e.g., span ports on core switches), Industrial Demilitarized Zone (IDMZ) gateways, and subnets containing SCADA servers, Engineering Workstations, or Data Historians."
    range: "last 90 days"
    queries:
      - "Pseudocode: For each authorized source IP, compare the count of discovery requests and unique destination IPs in a 5-minute window against its 30-day 95th percentile baseline. If both metrics exceed their baselines in the same window, generate an alert. Investigate by looking for associated user logins (Windows Event ID 4624) on the source host around the time of the anomaly."
  - question: "Does the time-series pattern of ICS discovery requests from an authorized host indicate an anomaly?"
    context: "This question uses a more advanced, machine learning-based approach to detect compromised authorized hosts. Simple statistical thresholds might miss subtle or slow reconnaissance activities. By training a time-series model (like an Isolation Forest or LSTM) on the normal rhythm of discovery requests from each host, we can detect deviations in the pattern of activity, not just the volume. An alert for a sustained high anomaly score suggests a persistent change in behavior that warrants investigation, even if absolute thresholds aren't breached."
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log, Windows Event ID 4624"
      - "Network and Asset Information: OT network segments (e.g., Process Control Network VLANs, Safety Instrumented System networks), network traffic aggregation points (e.g., span ports on core switches), Industrial Demilitarized Zone (IDMZ) gateways, and subnets containing SCADA servers, Engineering Workstations, or Data Historians."
    range: "last 90 days"
    queries:
      - "Pseudocode: Aggregate ICS discovery requests from each authorized host into 1-minute intervals. Feed the latest interval count into the host's pre-trained time-series anomaly detection model. If the model's anomaly score exceeds the defined threshold for two consecutive minutes, generate an alert."
  - question: "Has an un-whitelisted process on a critical OT host initiated network connections indicative of a discovery scan?"
    context: "This question focuses on detecting malicious software executing on a critical OT endpoint like an HMI or Engineering Workstation. The trigger is the execution of a process whose file hash is not on the approved software whitelist. The logic then confirms malicious intent by observing if this unauthorized process immediately begins making network connections to multiple ICS devices on standard ICS ports. This combination of an unapproved executable and network scanning behavior is a very strong indicator of a malware infection or an unauthorized tool being used for reconnaissance."
    answer_sources:
      - "Data Sources: Windows Event ID 4688, Windows Event ID 4624, Zeek conn.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log"
      - "Network and Asset Information: Engineering Workstations (EWS), Human-Machine Interface (HMI) Workstations, SCADA Servers, Data Historians, and Jump Servers/Bastion Hosts within the Industrial Demilitarized Zone (IDMZ) or OT network segments."
    range: "last 90 days"
    queries:
      - "Pseudocode: Monitor Windows Event ID 4688 for new process creation. Check the new process's file hash against the software whitelist. If the hash is not found, query network logs (Zeek conn.log) for connections from that host within 30 seconds of process creation. If connections are made to >3 unique ICS device IPs on ports 502, 20000, or 44818, generate a high-priority alert."
  - question: "Is a process on an OT host, whether whitelisted or not, exhibiting anomalous network scanning behavior shortly after launch?"
    context: "This question aims to detect the misuse of legitimate tools or the actions of unknown software. It establishes a behavioral baseline for whitelisted processes, noting the normal number of devices they contact shortly after launch. An alert is triggered if a whitelisted tool suddenly contacts far more devices than its norm (e.g., exceeds its 99th percentile), suggesting it's being used for an illicit scan. For any new, un-whitelisted process, a simple, strict threshold is applied. This dual approach helps catch both compromised legitimate tools and new malicious ones."
    answer_sources:
      - "Data Sources: Windows Event ID 4688, Windows Event ID 4624, Zeek conn.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log"
      - "Network and Asset Information: Engineering Workstations (EWS), Human-Machine Interface (HMI) Workstations, SCADA Servers, Data Historians, and Jump Servers/Bastion Hosts within the Industrial Demilitarized Zone (IDMZ) or OT network segments."
    range: "last 90 days"
    queries:
      - "Pseudocode: Upon process creation (Event ID 4688), monitor network activity for 60 seconds. If the process is whitelisted, compare the number of unique ICS IPs contacted against its specific 99th percentile baseline; alert if exceeded. If the process is not whitelisted, alert if it contacts >3 unique ICS IPs."
  - question: "Can a newly executed process be classified as malicious discovery activity based on its initial behavior?"
    context: "This question applies a supervised machine learning model to proactively classify a new process as either benign or malicious. Instead of relying on simple rules or thresholds, this approach uses a model (like a Random Forest) trained on a rich set of features from past events. These features can include the parent process, command-line arguments, and detailed network behavior in the first minute of execution. This allows for the detection of more sophisticated threats that may try to blend in, by identifying a malicious combination of behaviors that, in isolation, might not trigger an alert."
    answer_sources:
      - "Data Sources: Windows Event ID 4688, Windows Event ID 4624, Zeek conn.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log"
      - "Network and Asset Information: Engineering Workstations (EWS), Human-Machine Interface (HMI) Workstations, SCADA Servers, Data Historians, and Jump Servers/Bastion Hosts within the Industrial Demilitarized Zone (IDMZ) or OT network segments."
    range: "last 90 days"
    queries:
      - "Pseudocode: Upon new process creation, extract features (e.g., parent process name, command line entropy, unique destination IPs/ports in first 60s). Input these features into a trained supervised classification model. If the model classifies the process as 'malicious-discovery' with high confidence, generate a high-priority alert."