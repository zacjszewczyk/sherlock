name: "T0888: Remote System Information Discovery"
id: "a9b8c7d6-e5f4-4a3b-9c2d-1e0f9a8b7c6d"
description: "This playbook is designed to detect adversarial attempts to discover detailed information about remote Industrial Control Systems (ICS) and their peripherals. It focuses on identifying reconnaissance activities such as discovery sweeps from unauthorized IP addresses, anomalous discovery behavior from compromised but authorized hosts, and the execution of un-whitelisted or malicious processes on critical OT assets that initiate scanning behavior. The primary goal is to answer the question: Is an adversary discovering detailed information about our remote ICS systems and their peripherals?"
type: "technique"
related:
  - "TA0102: Discovery"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Is an unauthorized source IP address attempting to perform a discovery sweep of our ICS environment?"
    context: "This question aims to detect a classic reconnaissance technique where an attacker, from an unknown or unauthorized system, sends discovery protocol requests (e.g., Modbus function code 43, DNP3 Object Group 10) to multiple ICS devices in a short period. This is a strong indicator of an initial foothold or an external threat attempting to map the OT network. The check against a pre-defined whitelist of authorized management systems is crucial for filtering out legitimate administrative activity and identifying truly unauthorized behavior."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek modbus.log"
      - "Zeek dnp3.log"
      - "Zeek enip.log"
      - "Data should be collected from Network Areas of Interest (NAI) such as OT network segments (e.g., Process Control Network VLANs, Safety Instrumented System networks), network traffic aggregation points (e.g., span ports on core switches), Industrial Demilitarized Zone (IDMZ) gateways, and subnets containing SCADA servers, Engineering Workstations, or Data Historians."
    range: "last 90 days"
    queries:
      - symbolic_logic: "SEARCH Zeek logs (modbus, dnp3, enip) for ICS discovery function codes. FOR each event, IF source_ip is NOT in authorized_OT_whitelist, ALERT high. FOR each unauthorized source_ip, COUNT unique destination_ips in 60s window. IF count > 5, ESCALATE to critical."
  - question: "Is an authorized OT management host exhibiting anomalous discovery behavior by contacting an unusually high number of devices?"
    context: "This question addresses the scenario where an adversary has compromised a legitimate, authorized system (like an Engineering Workstation) and is using it for internal discovery. By establishing a historical baseline of normal activity for each authorized host (e.g., 95th percentile of discovery requests and unique destinations), we can detect deviations that suggest misuse. Correlating this network anomaly with user login information (Windows Event ID 4624) on the host helps identify the specific user session during which the suspicious activity occurred."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek modbus.log"
      - "Zeek dnp3.log"
      - "Zeek enip.log"
      - "Windows Event ID 4624"
      - "Data should be collected from Network Areas of Interest (NAI) such as OT network segments, network traffic aggregation points, IDMZ gateways, and subnets containing SCADA servers, Engineering Workstations, or Data Historians."
    range: "last 90 days"
    queries:
      - statistical: "FOR each authorized_host, CALCULATE 30-day baseline (95th percentile) for discovery_request_count and unique_destination_count in 5min windows. IN real-time, IF host's current 5min window exceeds BOTH baselines, ALERT medium. INVESTIGATE by correlating host_ip and timestamp with user logins (Event ID 4624)."
  - question: "Does the pattern of ICS discovery requests from an authorized host deviate significantly from its learned normal behavior over time?"
    context: "This question uses a more advanced, machine learning-based approach to detect subtle or sophisticated misuse of authorized hosts. A time-series anomaly detection model (e.g., Isolation Forest, LSTM) can learn the normal rhythm and volume of discovery activity for each host. This allows it to flag sustained deviations that might not be caught by simple threshold-based statistical methods, potentially indicating a stealthier adversary who is attempting to blend in."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek modbus.log"
      - "Zeek dnp3.log"
      - "Zeek enip.log"
      - "Data should be collected from Network Areas of Interest (NAI) such as OT network segments, network traffic aggregation points, IDMZ gateways, and subnets containing SCADA servers, Engineering Workstations, or Data Historians."
    range: "last 90 days"
    queries:
      - machine_learning: "FOR each authorized_host, TRAIN time-series anomaly model on 30+ days of 1-min aggregated discovery request counts. IN real-time, FEED new 1-min counts to model. IF anomaly_score exceeds threshold for 2 consecutive minutes, ALERT medium."
  - question: "Has an unapproved process on a critical OT host initiated network connections to multiple ICS devices shortly after its execution?"
    context: "This question focuses on detecting malicious tools or scripts running on key OT assets like HMIs or Engineering Workstations. The execution of a process not on the approved software whitelist is inherently suspicious. When this unapproved process immediately begins communicating with multiple ICS devices on standard OT protocol ports (e.g., 502, 20000, 44818), it is a strong indicator of a malicious payload specifically designed for OT reconnaissance or attack. Enriching alerts with user and process context is critical for rapid response."
    answer_sources:
      - "Windows Event ID 4688 (Process Creation)"
      - "Windows Event ID 4624 (User Logon)"
      - "Zeek conn.log"
      - "Zeek modbus.log"
      - "Zeek dnp3.log"
      - "Zeek enip.log"
      - "Data should be collected from NAIs such as Engineering Workstations (EWS), Human-Machine Interface (HMI) Workstations, SCADA Servers, Data Historians, and Jump Servers/Bastion Hosts within the IDMZ or OT network segments."
    range: "last 90 days"
    queries:
      - symbolic_logic: "ON new process creation (Event ID 4688), GET file_hash. IF file_hash is NOT in approved_software_whitelist, THEN SEARCH Zeek conn.log for connections from host_ip within 30s of process start time to ports (502, 20000, 44818). IF connections to >3 unique ICS_device_ips, ALERT high with process and user details."
  - question: "Is a process on an OT host, whether whitelisted or not, exhibiting anomalous network scanning behavior shortly after launch?"
    context: "This question broadens detection to include the misuse of legitimate tools. An adversary may use a whitelisted administrative tool in an abnormal way to perform discovery. This method establishes a baseline of normal network behavior (e.g., 99th percentile of unique IPs contacted) for each whitelisted process. It then flags any whitelisted process that exceeds its specific baseline or any un-whitelisted process that contacts more than a generic threshold of devices, catching both novel malware and 'living off the land' techniques."
    answer_sources:
      - "Windows Event ID 4688 (Process Creation)"
      - "Zeek conn.log"
      - "Zeek modbus.log"
      - "Zeek dnp3.log"
      - "Zeek enip.log"
      - "Data should be collected from NAIs such as Engineering Workstations (EWS), Human-Machine Interface (HMI) Workstations, SCADA Servers, Data Historians, and Jump Servers/Bastion Hosts."
    range: "last 90 days"
    queries:
      - statistical: "FOR each whitelisted_process, CALCULATE baseline (99th percentile) for unique_ICS_IPs contacted in first 60s. ON new process creation, IF process is whitelisted AND exceeds its baseline, ALERT medium. IF process is NOT whitelisted AND contacts >3 unique_ICS_IPs, ALERT medium."
  - question: "Can we classify a newly executed process as malicious discovery based on its initial characteristics and network activity?"
    context: "This question proposes a proactive, predictive approach using supervised machine learning. By training a classification model (e.g., Random Forest) on features from historical known-benign and known-malicious discovery events, the system can automatically classify new, unseen process activity. This can provide faster and more accurate alerts than rule-based methods by considering a wider range of features (e.g., parent process, command-line entropy, network connection patterns) in concert to determine malicious intent with a calculated confidence score."
    answer_sources:
      - "Windows Event ID 4688 (Process Creation)"
      - "Zeek conn.log"
      - "Data should be collected from NAIs such as Engineering Workstations (EWS), Human-Machine Interface (HMI) Workstations, SCADA Servers, Data Historians, and Jump Servers/Bastion Hosts."
    range: "last 90 days"
    queries:
      - machine_learning: "TRAIN classification model on labeled dataset of past process events, using features like parent_process, command_line_entropy, and network metrics (unique_ips, unique_ports) from first 60s. IN real-time, ON new process creation, EXTRACT features and CLASSIFY. IF classification is 'malicious-discovery' with high confidence, ALERT high."