name: 'T0815: Denial of View'
id: 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d'
description: 'This playbook helps investigate whether an adversary is attempting to disrupt operator visibility of the industrial process. This can be achieved by causing a sustained and anomalous absence of expected periodic ICS protocol messages from a Level 1 field device to a Level 2 SCADA/HMI server, which may manifest as a significant packet volume reduction. It can also be achieved by the unexpected termination of a critical HMI application process on an operator workstation, either by crashing the application or terminating it from an unauthorized parent process.'
type: 'technique'
related:
  - 'TA0105: Impact'
contributors:
  - 'Zachary Szewczyk'
  - 'Ask Sage'
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: 'none'
questions:
  - question: 'Has a critical PLC failed to send its expected periodic message to an HMI/Server within its established polling interval?'
    context: 'This question aims to detect a complete communication loss from a field device. An adversary might block or interrupt this traffic to blind operators to the true state of the physical process. Detecting a missed "heartbeat" that exceeds the normal polling jitter (using a 2.5x multiplier as a threshold) is a direct indicator of a potential Denial of View attack. Correlating this with specific protocol error messages can confirm the HMI is aware of the failure but cannot receive data.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek modbus.log'
      - 'Zeek enip.log'
      - 'Zeek dnp3.log'
      - 'Network Area of Interest: ICS Level 2 (Control System) network segment, specifically traffic between HMI/SCADA servers and Level 1 (Basic Control) PLCs/RTUs.'
    range: 'last 90 days'
    queries:
      - 'SIEM Pseudocode: SEARCH Zeek ICS logs FOR critical PLC/HMI pairs WHERE message_not_seen IN (polling_interval * 2.5) AND CORRELATE WITH ICS error_codes LIKE "Gateway Target Device Failed to Respond".'
  - question: 'Has there been a sustained and anomalous reduction in network traffic volume between a critical PLC and HMI?'
    context: 'This question looks for a significant degradation of communication rather than a complete loss. Adversaries might throttle traffic to degrade, but not completely sever, operator visibility. By baselining normal traffic volumes (packet and byte counts) and inter-arrival times (jitter), we can detect subtle manipulations that fall below normal thresholds for an extended period, indicating a potential ongoing attack that precedes a full communication loss.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek modbus.log'
      - 'Zeek enip.log'
      - 'Zeek dnp3.log'
      - 'Network Area of Interest: ICS Level 2 (Control System) network segment, specifically traffic between HMI/SCADA servers and Level 1 (Basic Control) PLCs/RTUs.'
    range: 'last 90 days'
    queries:
      - 'SIEM Pseudocode: FOR each critical PLC/HMI pair, BASELINE packet/byte counts over 14 days. ALERT IF current packet/byte counts < 1st_percentile_baseline FOR 3 consecutive intervals OR IF message_jitter > 3 * stdev(historical_jitter).'
  - question: 'Does the network traffic pattern between critical PLCs and HMIs deviate significantly from the historically learned normal "heartbeat"?'
    context: 'This question uses machine learning to identify sophisticated anomalies that simple threshold-based rules might miss. A time-series model like an LSTM autoencoder learns the complex, multi-variate relationships in network telemetry over time. A high reconstruction error (anomaly score) indicates that the current traffic pattern is highly improbable based on historical data, providing a high-confidence signal of an abnormal state, such as a Denial of View attack, even if traffic has not completely stopped.'
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek modbus.log'
      - 'Zeek enip.log'
      - 'Zeek dnp3.log'
      - 'Network Area of Interest: ICS Level 2 (Control System) network segment, specifically traffic between HMI/SCADA servers and Level 1 (Basic Control) PLCs/RTUs.'
    range: 'last 90 days'
    queries:
      - 'ML Model Pseudocode: INPUT real-time network telemetry (packets, bytes, protocol_mix) INTO trained LSTM model. ALERT IF anomaly_score > threshold AND packet_count is near-zero.'
  - question: 'Was a critical HMI application terminated by an unapproved parent process or did it crash unexpectedly?'
    context: 'This question focuses on identifying the illegitimate termination of HMI software. Adversaries may kill these processes to prevent operators from viewing or interacting with the control system. By monitoring process termination events (Sysmon ID 5) and checking the parent process that initiated the termination against a whitelist of legitimate launchers, we can distinguish between normal shutdowns and malicious actions. A non-zero exit code is also a strong indicator of a crash, which could be induced by an adversary.'
    answer_sources:
      - 'Windows Event ID 4689'
      - 'Windows Event ID 4688'
      - 'Windows Event ID 1 (Sysmon Process Create)'
      - 'Windows Event ID 5 (Sysmon Process Terminate)'
      - 'Network Area of Interest: ICS Level 2 (Control System) HMI Workstations and Engineering Workstations.'
    range: 'last 90 days'
    queries:
      - 'SIEM Pseudocode: SEARCH for Process_Termination_Event (Sysmon ID 5) WHERE process_name IN critical_HMI_list. CORRELATE with Process_Creation_Event (Sysmon ID 1) to find parent_process. ALERT IF parent_process NOT IN whitelist OR exit_code != 0.'
  - question: 'Has there been an unusual spike in HMI application terminations or has an HMI process terminated with a rare or never-before-seen exit code?'
    context: 'This question seeks to find anomalies in the frequency and nature of HMI process terminations. A sudden increase in terminations within a short timeframe (e.g., hourly) compared to a historical baseline can indicate a repeated attack or instability. Furthermore, analyzing exit codes can reveal problems; a new or statistically rare exit code suggests the process terminated in a way that is not typical, warranting investigation for malicious interference or induced faults.'
    answer_sources:
      - 'Windows Event ID 4689'
      - 'Windows Event ID 4688'
      - 'Windows Event ID 1 (Sysmon Process Create)'
      - 'Windows Event ID 5 (Sysmon Process Terminate)'
      - 'Network Area of Interest: ICS Level 2 (Control System) HMI Workstations and Engineering Workstations.'
    range: 'last 90 days'
    queries:
      - 'SIEM Pseudocode: BASELINE hourly termination counts (Sysmon ID 5) for HMI processes over 30 days. ALERT IF current_hour_count > 99th_percentile_threshold. SEPARATELY, ALERT IF exit_code for HMI termination is new or statistically rare (<0.1% historical occurrence).'
  - question: 'Does a machine learning model classify the termination of an HMI process as potentially malicious based on its context?'
    context: 'This question leverages machine learning to provide a sophisticated, context-aware assessment of HMI process termination events. By training a model on features like the parent process, user context, time of day, and command-line arguments, it can learn the subtle differences between benign and malicious terminations. This allows for the detection of novel or evasive techniques that might not be caught by simple rules, flagging events with a high probability of being malicious for immediate analyst review.'
    answer_sources:
      - 'Windows Event ID 4689'
      - 'Windows Event ID 4688'
      - 'Windows Event ID 1 (Sysmon Process Create)'
      - 'Windows Event ID 5 (Sysmon Process Terminate)'
      - 'Network Area of Interest: ICS Level 2 (Control System) HMI Workstations and Engineering Workstations.'
    range: 'last 90 days'
    queries:
      - 'ML Model Pseudocode: INPUT new HMI process termination event features (parent_process, user, time, etc.) INTO trained classification model. ALERT IF model_output_probability("malicious") > high_confidence_threshold.'