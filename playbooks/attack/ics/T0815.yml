name: T0815: Denial of View
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps investigate whether an adversary is attempting to disrupt operator visibility of the industrial process. This can be achieved by causing a sustained and anomalous absence of expected periodic ICS protocol messages from field devices (PLCs/RTUs) to SCADA/HMI servers, or by causing the unexpected termination of critical HMI application processes on operator workstations.
type: technique
related: TA0105: Impact
contributors: Zachary Szewczyk, Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: How can I detect a Denial of View attack based on the absence of expected ICS protocol messages?
    context: This question focuses on creating a SIEM rule to monitor for the cessation of keep-alive or data polling messages between critical PLCs and HMIs. An alert triggers if a message isn't seen within 2.5 times the normal polling interval, indicating a potential communication loss. This is a primary indicator of an adversary intentionally blinding an operator by stopping data flow.
    answer_sources: 
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek dnp3.log
      - ICS Level 2 (Control System) network segment, specifically traffic between HMI/SCADA servers and Level 1 (Basic Control) PLCs/RTUs.
    range: last 90 days
    queries:
      - search: SIEM
        query: FOR each critical PLC-HMI pair, IF no message seen in (2.5 * polling_interval), ALERT High. CORRELATE with protocol error responses.
  - question: Can I identify a potential Denial of View by baselining network traffic volume between PLCs and HMIs?
    context: This question involves establishing a historical baseline of packet and byte counts from Zeek logs. A significant and sustained drop below this baseline (e.g., below the 1st percentile for three consecutive intervals) suggests a communication disruption. It also suggests monitoring inter-arrival time jitter to detect network degradation before a complete failure, providing an earlier warning.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek dnp3.log
      - ICS Level 2 (Control System) network segment, specifically traffic between HMI/SCADA servers and Level 1 (Basic Control) PLCs/RTUs.
    range: last 90 days
    queries:
      - search: Statistical Analysis
        query: ESTABLISH 14-day baseline of packet/byte counts. IF current counts < 1st_percentile for 3 intervals, ALERT Medium. ADDITIONALLY, if inter-arrival jitter > 3 stddev, ALERT.
  - question: How can machine learning be used to detect a Denial of View based on network telemetry anomalies?
    context: This question explores using a time-series anomaly detection model, like an LSTM autoencoder, to learn the normal 'heartbeat' of network traffic between PLCs and HMIs. A high anomaly score on live traffic, especially when packet counts are near zero, indicates a high-confidence deviation from normal operations, likely a Denial of View event.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek dnp3.log
      - ICS Level 2 (Control System) network segment, specifically traffic between HMI/SCADA servers and Level 1 (Basic Control) PLCs/RTUs.
    range: last 90 days
    queries:
      - search: Machine Learning Model
        query: TRAIN LSTM autoencoder on historical network telemetry. IF real-time data has anomaly_score > threshold AND packet_count is near zero, ALERT High.
  - question: How can I detect if a critical HMI application was maliciously terminated?
    context: This question focuses on creating a detection rule that looks for the termination of a critical HMI process (Sysmon Event ID 5). The termination is considered suspicious and triggers an alert if the parent process that initiated the termination is not on an approved whitelist or if the process crashed (indicated by a non-zero exit code). This helps distinguish between normal user actions and targeted process killing.
    answer_sources:
      - Windows Event ID 4689
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon Process Create)
      - Windows Event ID 5 (Sysmon Process Terminate)
      - ICS Level 2 (Control System) HMI Workstations and Engineering Workstations.
    range: last 90 days
    queries:
      - search: SIEM / EDR
        query: ON Sysmon Event ID 5 for HMI_process, IF parent_process NOT in whitelist OR exit_code is non-zero, ALERT.
  - question: Can statistical baselining of HMI process terminations help identify anomalous activity?
    context: This question involves using historical data to establish baselines for HMI process terminations. An alert is triggered if the number of terminations in an hour exceeds a statistical threshold (e.g., 99th percentile). A separate check profiles the historical exit codes, flagging any new or statistically rare exit codes, which could indicate a new type of crash or a specific tool used by an attacker.
    answer_sources:
      - Windows Event ID 4689
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon Process Create)
      - Windows Event ID 5 (Sysmon Process Terminate)
      - ICS Level 2 (Control System) HMI Workstations and Engineering Workstations.
    range: last 90 days
    queries:
      - search: Statistical Analysis
        query: ESTABLISH 30-day baseline of hourly termination counts. IF current_hour_count > 99th_percentile, ALERT. ADDITIONALLY, if exit_code is new or statistically rare, ALERT.
  - question: How can a machine learning model be used to classify HMI process terminations as benign or malicious?
    context: This question proposes training a classification model (like Random Forest) to distinguish between normal and malicious HMI process terminations. The model uses features like the process name, parent process, user, and time of day. By learning from labeled historical data, the model can score new termination events in real-time, automatically flagging suspicious events for analyst review.
    answer_sources:
      - Windows Event ID 4689
      - Windows Event ID 4688
      - Windows Event ID 1 (Sysmon Process Create)
      - Windows Event ID 5 (Sysmon Process Terminate)
      - ICS Level 2 (Control System) HMI Workstations and Engineering Workstations.
    range: last 90 days
    queries:
      - search: Machine Learning Model
        query: TRAIN classification model on labeled termination events. DEPLOY model to score new events. IF score > malicious_threshold, ALERT.