name: T0880: Loss of Safety
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: |
  Investigates attempts by an adversary to disable or manipulate a Safety Instrumented System (SIS), a critical component for maintaining safe industrial process states. This can be achieved through unauthorized logic file transfers to an SIS PLC, which may occur outside maintenance windows, from unknown sources, or using non-standard protocols. It also covers the use of specific ICS protocol commands to disrupt safety functions, such as stopping the PLC's CPU or writing to protected memory areas. Additionally, the playbook looks for signs of denial-of-service or reconnaissance, such as a high rate of new connection attempts, protocol errors, or anomalous data volumes directed at an SIS PLC, which could precede or accompany a direct manipulation attempt.
type: technique
related:
  - TA0105: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has a PLC logic file been transferred to a Safety Instrumented System (SIS) from an unauthorized source or outside a scheduled maintenance window?
    context: This question is critical because unauthorized or ill-timed logic transfers are a primary vector for introducing malicious code or unsafe configurations into an SIS. A successful transfer could lead to a complete loss of safety function, potentially resulting in equipment damage, environmental release, or personnel injury. This query acts as a high-fidelity tripwire for direct tampering.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4624
      - Windows Event ID 4672
      - Zeek conn.log
      - Zeek files.log
      - Zeek smb.log
      - Zeek ftp.log
      - Zeek s7comm.log
      - Zeek enip.log
      - Network traffic at SIS network segment ingress/egress points; Authentication logs on Domain Controllers; File access and process execution logs on Engineering Workstations (EWS) and file servers; Network protocol logs from network sensors.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH file monitoring logs (e.g., Zeek files.log)
          WHERE destination IP is in SIS asset group
          AND file extension is a PLC logic type
          AND (source IP is NOT in authorized EWS list OR event time is outside scheduled maintenance)
          ALERT on any results.
  - question: Has a logic file transfer to an SIS PLC occurred that is anomalously large in size or long in duration compared to historical norms?
    context: Even if a file transfer originates from an authorized source during a maintenance window, a significant deviation from normal behavior can be an indicator of compromise. An unusually large file might contain malicious payloads alongside legitimate logic, while an unusually long connection could signify data exfiltration or an attacker's interactive session. This helps detect subtle manipulations within seemingly legitimate activities.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4624
      - Windows Event ID 4672
      - Zeek conn.log
      - Zeek files.log
      - Zeek smb.log
      - Zeek ftp.log
      - Zeek s7comm.log
      - Zeek enip.log
      - Network traffic at SIS network segment ingress/egress points; Authentication logs on Domain Controllers; File access and process execution logs on Engineering Workstations (EWS) and file servers; Network protocol logs from network sensors.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each logic file transfer event to an SIS PLC:
          COMPARE transfer size and connection duration against the 30-day rolling 99th percentile baseline for that specific EWS-to-PLC channel.
          ALERT if BOTH size and duration exceed their respective thresholds.
  - question: Does a machine learning model classify a recent logic file download to an SIS PLC as potentially malicious based on its contextual features?
    context: Simple rule-based detections can be bypassed by sophisticated adversaries. A machine learning model can analyze multiple features simultaneously (e.g., time of day, user, source/destination, file size, protocol) to identify complex patterns that are indicative of malicious activity but do not violate any single, simple rule. This provides a more robust and adaptive detection capability against novel or evolving attack techniques.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4624
      - Windows Event ID 4672
      - Zeek conn.log
      - Zeek files.log
      - Zeek smb.log
      - Zeek ftp.log
      - Zeek s7comm.log
      - Zeek enip.log
      - Network traffic at SIS network segment ingress/egress points; Authentication logs on Domain Controllers; File access and process execution logs on Engineering Workstations (EWS) and file servers; Network protocol logs from network sensors.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          INPUT features from file transfer events (time, source/dest, user, size, duration, protocol, maintenance window flag).
          APPLY supervised anomaly detection model (e.g., Random Forest).
          ALERT if classification is 'malicious' with a confidence score greater than 0.95.
  - question: Has a critical ICS command, such as 'Stop CPU' or a write to safety memory, been sent to an SIS PLC from an unauthorized engineering workstation?
    context: This question targets the direct execution of commands known to have an immediate and severe impact on safety functions. Blocking such commands from unauthorized sources is a fundamental security control. Detecting an attempt, even if blocked, is a critical indicator that an adversary has breached the network and is attempting to cause a direct impact.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek s7comm.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Network traffic at the SIS network segment; ICS protocol logs from network sensors monitoring communication to SIS PLCs; Process execution logs on HMIs and Engineering Workstations; Asset inventory database defining SIS device roles and IP addresses.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH deep packet inspection logs (e.g., Zeek s7comm.log).
          WHERE destination IP is in SIS asset group
          AND command function code or memory address is on the critical watchlist
          AND source IP is NOT in the authorized EWS list.
          ALERT immediately on any match.
  - question: Is there a statistically unusual pattern of ICS commands, such as abnormally high command entropy or an excessive frequency of 'write' commands, being sent to an SIS PLC?
    context: Adversaries may attempt to probe a system or cause disruption using a flurry of varied or repeated commands, rather than a single critical one. A sudden increase in the variety of commands (entropy) can indicate reconnaissance, while a high frequency of 'write' or 'program' commands can signal an attempt to modify logic or setpoints. This detects abnormal operational tempo.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek s7comm.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Network traffic at the SIS network segment; ICS protocol logs from network sensors monitoring communication to SIS PLCs; Process execution logs on HMIs and Engineering Workstations; Asset inventory database defining SIS device roles and IP addresses.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          AGGREGATE ICS protocol logs for each SIS PLC in 5-minute windows.
          CALCULATE Shannon entropy of function codes and frequency of 'write'/'program' commands.
          ALERT if entropy increases by >3 standard deviations from baseline OR if write/program frequency exceeds its 99th percentile.
  - question: Does a deep learning model detect an anomalous sequence of ICS commands sent to an SIS PLC, indicating a deviation from normal operational 'grammar'?
    context: Normal industrial processes often follow predictable sequences of operations. A sophisticated attack might use valid individual commands but in an illogical or malicious order to subvert the process. A sequence-aware model (like an RNN or LSTM) learns the 'grammar' of safe operations and can flag these anomalous sequences, which would be invisible to analyses that look at commands in isolation.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek s7comm.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - Network traffic at the SIS network segment; ICS protocol logs from network sensors monitoring communication to SIS PLCs; Process execution logs on HMIs and Engineering Workstations; Asset inventory database defining SIS device roles and IP addresses.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          INPUT live stream of ICS commands for an SIS PLC into a trained RNN/LSTM autoencoder.
          CALCULATE the reconstruction error for each command sequence.
          ALERT if the reconstruction error exceeds a dynamically tuned threshold, indicating a grammatical anomaly.
  - question: Is an SIS PLC experiencing a high rate of failed or rejected connection attempts from a single source, potentially indicating a denial-of-service or scanning attack?
    context: A flood of incomplete or rejected connections is a classic signature of a network scan (to identify open ports) or a denial-of-service (DoS) attack intended to overwhelm the device and prevent it from processing legitimate commands. For a safety system, a DoS attack can be catastrophic, as it may prevent the system from responding to an unsafe process condition.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek weird.log
      - Zeek packet_filter.log
      - Network traffic at the SIS network segment and IDMZ boundaries; Logs from network infrastructure (firewalls, switches) protecting the SIS; Network sensor logs (Zeek conn.log, notice.log) capturing connection state information; Performance and availability monitoring data for SIS PLCs.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH connection logs (e.g., Zeek conn.log) for connections to SIS assets.
          WHERE connection state is 'S0', 'S1', or 'REJ'.
          COUNT connections by source IP over a 1-minute window.
          ALERT if count from a single source exceeds 100.
  - question: Are there statistically significant anomalies in the network traffic profile of an SIS PLC, such as unusual data volume, source IP counts, or connection error rates?
    context: This question aims to detect more subtle indicators of malicious activity than a simple connection flood. A sudden spike in data volume could be data exfiltration, an increase in unique source IPs could be a distributed scan, and a rising ratio of failed-to-successful connections can indicate a system under stress or attack. Baselining these metrics provides a sensitive detector for abnormal network behavior.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek weird.log
      - Zeek packet_filter.log
      - Network traffic at the SIS network segment and IDMZ boundaries; Logs from network infrastructure (firewalls, switches) protecting the SIS; Network sensor logs (Zeek conn.log, notice.log) capturing connection state information; Performance and availability monitoring data for SIS PLCs.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each SIS PLC, track per-minute metrics from connection logs: total inbound bytes, unique source IP count, and ratio of incomplete to established connections.
          ALERT if byte count or IP count exceeds its 99.9th percentile, or if the incomplete connection ratio exceeds 3 standard deviations above its 30-day average.
  - question: Does a time-series forecasting model show a significant and sustained deviation between observed and predicted network traffic metrics for an SIS PLC?
    context: Industrial systems often have predictable daily or weekly cycles of network activity. A multivariate time-series model can learn these complex, multi-faceted patterns. When observed traffic consistently deviates from what the model predicts, it is a strong indicator of non-standard, potentially malicious activity that simple thresholding might miss. This method is effective at finding 'low-and-slow' attacks that stay under the radar of basic alerts.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek weird.log
      - Zeek packet_filter.log
      - Network traffic at the SIS network segment and IDMZ boundaries; Logs from network infrastructure (firewalls, switches) protecting the SIS; Network sensor logs (Zeek conn.log, notice.log) capturing connection state information; Performance and availability monitoring data for SIS PLCs.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          INPUT historical traffic data (volume, packets, protocol mix) for an SIS PLC into a forecasting model (e.g., VAR).
          COMPARE live observed metrics against the model's forecast.
          ALERT if observed values consistently deviate from the forecast beyond a 99% confidence interval for more than 3 consecutive minutes.