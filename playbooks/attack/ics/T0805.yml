name: "T0805: Block Serial COM"
id: "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
description: "This playbook helps determine if an adversary is inhibiting response functions by blocking serial COM ports in an ICS environment. This is often achieved by establishing a long-lived, inactive TCP connection to a serial-to-Ethernet converter, which prevents legitimate systems from accessing the port. Indicators include connections with abnormally long durations and low data transfer, connections from unauthorized source IP addresses, and a subsequent increase in communication failure alarms from systems that rely on the affected serial device."
type: "technique"
related: "TA0107: Inhibit Response Function"
contributors: "Zachary Szewczyk, Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
- question: "Is there a successful connection to a known serial-to-Ethernet converter that has an unusually long duration but minimal data transfer, based on static thresholds?"
  context: "This question seeks to identify connections that are being held open without legitimate communication, a common method to block a serial port and cause a denial of service. By setting static thresholds for duration (e.g., > 1200 seconds) and data transfer (e.g., < 50 bytes), we can quickly flag suspicious, inactive sessions that indicate an adversary is preventing legitimate systems from accessing a physical device."
  answer_sources:
  - "Zeek conn.log"
  - "Network perimeter of the Process Control Network (PCN), Industrial Demilitarized Zone (IDMZ) gateways, and Level 2/3 SCADA/DCS network segments hosting serial-to-Ethernet converters."
  range: "last 90 days"
  queries:
  - search_technology: "Pseudocode"
    query: |
      SEARCH Zeek conn.log WHERE conn_state = 'SF'
      AND destination_port IN [known_converter_ports]
      AND duration > 1200
      AND (orig_bytes + resp_bytes) < 50
- question: "Is there a connection to a serial-to-Ethernet converter that significantly deviates from its historical baseline, showing a duration in the top percentile and data transfer in the bottom percentile?"
  context: "This question improves upon static thresholds by using dynamic, per-device baselines, which adapt to the unique communication patterns of each converter and reduce false positives. A connection that is statistically an outlier in both duration (very long, e.g., >99th percentile) and data volume (very low, e.g., <1st percentile) is a strong indicator of a port being intentionally blocked."
  answer_sources:
  - "Zeek conn.log"
  - "Network perimeter of the Process Control Network (PCN), Industrial Demilitarized Zone (IDMZ) gateways, and Level 2/3 SCADA/DCS network segments hosting serial-to-Ethernet converters."
  range: "last 90 days"
  queries:
  - search_technology: "Pseudocode"
    query: |
      FOREACH new_connection to converter_port:
        baseline_duration = 99th_percentile(duration) for past 90 days on converter_port
        baseline_bytes = 1st_percentile(total_bytes) for past 90 days on converter_port
        IF new_connection.duration > baseline_duration AND new_connection.total_bytes < baseline_bytes:
          ALERT
- question: "Has a machine learning model identified a connection to a serial-to-Ethernet converter as anomalous based on its duration and data transfer characteristics?"
  context: "This question represents an advanced detection method, using machine learning to identify complex deviations from normal behavior that might be missed by simpler statistical methods. An anomaly score above a certain threshold suggests the connection's features (duration, bytes transferred) are highly uncharacteristic of normal operations for that specific port, pointing to potential malicious activity."
  answer_sources:
  - "Zeek conn.log"
  - "Network perimeter of the Process Control Network (PCN), Industrial Demilitarized Zone (IDMZ) gateways, and Level 2/3 SCADA/DCS network segments hosting serial-to-Ethernet converters."
  range: "last 90 days"
  queries:
  - search_technology: "Pseudocode"
    query: |
      INPUT live Zeek conn.log data INTO anomaly_detection_model
      FOREACH connection:
        anomaly_score = model.predict(connection_features)
        IF anomaly_score > tuned_threshold:
          ALERT
- question: "Has a connection been made to a serial-to-Ethernet converter from a source IP address not on the authorized allowlist?"
  context: "This is a high-fidelity check, as access to critical ICS devices like serial converters should be strictly controlled. A connection from an unauthorized source is a clear policy violation and a strong indicator of compromise or misconfiguration. Correlating this network event with host logs (e.g., process creation events) can help identify the specific process on the unauthorized machine responsible for the connection."
  answer_sources:
  - "Zeek conn.log"
  - "Windows Event ID 4688"
  - "Windows Event ID 4624"
  - "IT/OT DMZ network boundary, Process Control Network (PCN) segments, supervisory control systems, engineering workstations, Human Machine Interfaces (HMIs), and network segments directly hosting serial-to-Ethernet converters."
  range: "last 90 days"
  queries:
  - search_technology: "Pseudocode"
    query: |
      SEARCH Zeek conn.log WHERE conn_state = 'SF'
      AND destination_ip IN [known_converters]
      AND source_ip NOT IN [authorized_ip_allowlist]
      THEN, SEARCH Host Logs where source_ip = alerted_ip and timestamp = alert_time
- question: "Is there an anomalous pattern in the source IPs connecting to a serial-to-Ethernet converter, such as a sudden drop in variety or a spike in new, unknown IPs?"
  context: "This question looks for changes in communication patterns. A sharp decrease in source IP entropy (variety) could mean one rogue host is monopolizing the connection, crowding out legitimate systems. Conversely, a sudden spike in new, never-before-seen IPs connecting could indicate a widespread scanning or reconnaissance effort by an adversary."
  answer_sources:
  - "Zeek conn.log"
  - "Windows Event ID 4688"
  - "Windows Event ID 4624"
  - "IT/OT DMZ network boundary, Process Control Network (PCN) segments, supervisory control systems, engineering workstations, Human Machine Interfaces (HMIs), and network segments directly hosting serial-to-Ethernet converters."
  range: "last 90 days"
  queries:
  - search_technology: "Pseudocode"
    query: |
      CALCULATE hourly Shannon entropy of source IPs for each converter
      ALERT if entropy drops sharply
      OR
      COUNT new source IPs per hour for each converter
      ALERT if new_ip_count > 99th_percentile_baseline
- question: "Has a machine learning classification model flagged a new connection to a serial-to-Ethernet converter as 'unauthorized' with high confidence?"
  context: "This leverages a supervised model trained on known-good and known-bad connection patterns. Unlike a simple allowlist, a model can learn more nuanced features (e.g., time of day, protocol details) to identify unauthorized activity. A high-confidence (>0.9) prediction of 'unauthorized' provides a strong signal for immediate investigation."
  answer_sources:
  - "Zeek conn.log"
  - "Windows Event ID 4688"
  - "Windows Event ID 4624"
  - "IT/OT DMZ network boundary, Process Control Network (PCN) segments, supervisory control systems, engineering workstations, Human Machine Interfaces (HMIs), and network segments directly hosting serial-to-Ethernet converters."
  range: "last 90 days"
  queries:
  - search_technology: "Pseudocode"
    query: |
      INPUT live Zeek conn.log data INTO classification_model
      FOREACH connection:
        prediction, confidence = model.classify(connection_features)
        IF prediction == 'unauthorized' AND confidence > 0.9:
          ALERT
- question: "Are there communication failure alarms from legitimate systems (like HMIs or SCADA servers) that coincide with an active, long-duration TCP session to the same device's serial converter?"
  context: "This question directly links the effect (communication failure) to a potential cause (a suspicious network connection). If a system designed to talk to a device suddenly starts reporting errors at the exact time an anomalous connection to that device's converter is active, it strongly implies the connection is blocking legitimate access."
  answer_sources:
  - "Windows Event Log (Application)"
  - "Zeek conn.log"
  - "SCADA master servers, Historian databases, Human Machine Interface (HMI) terminals, and engineering workstations."
  range: "last 90 days"
  queries:
  - search_technology: "Pseudocode"
    query: |
      SEARCH for 'Device Unresponsive' alarms in Application Logs
      EXTRACT device_name and timestamp
      SEARCH Zeek conn.log for active, long-duration sessions to converter for device_name
      IF alarm_timestamp falls within session_time:
        ALERT
- question: "Has there been a statistically significant and sustained increase in the frequency of communication failure alarms for a critical device?"
  context: "This question focuses on identifying an abnormal rate of failure alarms, which serves as a symptom of a potential problem. While not directly pointing to a cause, a sudden, sustained spike in errors (e.g., > 3 standard deviations above the mean) for a specific device is a strong indicator that something is wrong, prompting further investigation into network connections to that device."
  answer_sources:
  - "Windows Event Log (Application)"
  - "Zeek conn.log"
  - "SCADA master servers, Historian databases, Human Machine Interface (HMI) terminals, and engineering workstations."
  range: "last 90 days"
  queries:
  - search_technology: "Pseudocode"
    query: |
      CALCULATE time-series of alarm counts per minute for each device
      CALCULATE mean and std_dev for each device's alarm count
      IF current_alarm_count > (mean + 3*std_dev) for > 5 minutes:
        ALERT
- question: "Has a causal inference model determined a high probability that a specific network connection is the root cause of a recent spike in device communication alarms?"
  context: "This advanced analytic approach moves from correlation to causation. By modeling the relationships between network events (source IP, duration) and system alarms, a causal model can calculate the likelihood that a particular suspicious connection is directly causing the observed failures, allowing analysts to focus on the highest-probability threats."
  answer_sources:
  - "Windows Event Log (Application)"
  - "Zeek conn.log"
  - "SCADA master servers, Historian databases, Human Machine Interface (HMI) terminals, and engineering workstations."
  range: "last 90 days"
  queries:
  - search_technology: "Pseudocode"
    query: |
      INPUT network connection data AND alarm log data INTO Bayesian network model
      CALCULATE P(Alarm_Spike | Suspicious_Connection)
      IF probability > high_threshold:
        ALERT with causal score