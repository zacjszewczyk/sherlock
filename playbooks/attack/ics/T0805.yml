name: T0805: Block Serial COM
id: 5c9e8d4a-1f6b-4b8e-9a7c-3d4f5e6a7b8c
description: This playbook helps investigate if an adversary is inhibiting response functions by blocking serial COM ports in an ICS environment. This is often accomplished by establishing a long-lived, inactive TCP connection to a serial-to-Ethernet converter, effectively locking the port and preventing legitimate systems from communicating. Detections focus on identifying these held-open sessions through anomalous connection durations and low data transfer, detecting connections from unauthorized source IPs not on an allowlist, and correlating a sudden increase in communication failure alarms from HMIs or SCADA servers with these suspicious network sessions.
type: technique
related:
- TA0107: Inhibit Response Function
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: How can I detect an abnormally long and inactive connection to a serial-to-Ethernet converter using static thresholds?
  context: This question aims to identify potential "denial of service" attacks on serial COM ports where an adversary holds a connection open without transmitting data. By comparing connection duration and data volume against predefined static thresholds for known converter devices, analysts can quickly spot sessions that are suspiciously long and quiet, which is a key indicator of this technique.
  answer_sources:
  - Zeek conn.log
  - Asset inventory of serial-to-Ethernet converters
  - Network perimeter of the Process Control Network (PCN), Industrial Demilitarized Zone (IDMZ) gateways, and Level 2/3 SCADA/DCS network segments hosting serial-to-Ethernet converters.
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: SEARCH Zeek conn.log WHERE conn_state = 'SF' AND dest_port IN [converter_ports_list] AND duration > [static_duration_threshold] AND (orig_bytes + resp_bytes) < [static_bytes_threshold]
- question: Can I identify held-open, inactive connections to converters by detecting statistical deviations from historical baselines?
  context: This question moves beyond static thresholds to a more dynamic, data-driven approach. By establishing a historical baseline of normal connection behavior (duration and data volume) for each specific converter, this method can detect anomalies with greater accuracy and fewer false positives. An alert based on exceeding the 99th percentile for duration while being below the 1st percentile for data transfer strongly suggests a malicious held-open session.
  answer_sources:
  - Zeek conn.log
  - Historical connection data for baselining
  - Network perimeter of the Process Control Network (PCN), Industrial Demilitarized Zone (IDMZ) gateways, and Level 2/3 SCADA/DCS network segments hosting serial-to-Ethernet converters.
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: SEARCH Zeek conn.log WHERE conn_state = 'SF' AND dest_port IN [converter_ports_list] | COMPARE duration > 99th_percentile_baseline(dest_port) AND (orig_bytes + resp_bytes) < 1st_percentile_baseline(dest_port)
- question: Is it possible to use a machine learning model to detect anomalous connections to serial-to-Ethernet converters based on their time-series properties?
  context: This question proposes the most advanced detection method, using machine learning to learn the complex patterns of normal network behavior. A time-series anomaly detection model can analyze multiple features simultaneously (like duration, bytes sent/received) and identify subtle deviations that might be missed by simpler statistical rules. This is particularly effective for detecting novel or sophisticated variations of the "Block Serial COM" technique.
  answer_sources:
  - Zeek conn.log
  - Trained anomaly detection model
  - Network perimeter of the Process Control Network (PCN), Industrial Demilitarized Zone (IDMZ) gateways, and Level 2/3 SCADA/DCS network segments hosting serial-to-Ethernet converters.
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: PIPE Zeek conn.log FOR [converter_ports_list] TO anomaly_detection_model | FILTER anomaly_score > [tuned_threshold]
- question: Are there any unauthorized systems connecting to our serial-to-Ethernet converters, and what processes are initiating these connections?
  context: This question focuses on access control violations as an indicator of compromise. By maintaining a strict allowlist of authorized IP addresses for each converter, any connection from an unknown source is an immediate red flag. The follow-up action of pivoting to host logs (like Windows Event ID 4688 for process creation) is crucial for identifying the specific malicious tool (e.g., telnet.exe, nc.exe) used by the adversary and understanding their foothold on the unauthorized system.
  answer_sources:
  - Zeek conn.log
  - Windows Event ID 4688
  - Windows Event ID 4624
  - IP address allowlist for converters
  - IT/OT DMZ network boundary, Process Control Network (PCN) segments, supervisory control systems, engineering workstations, Human Machine Interfaces (HMIs), and network segments directly hosting serial-to-Ethernet converters.
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: SEARCH Zeek conn.log WHERE conn_state = 'SF' AND dest_port IN [converter_ports_list] AND source_ip NOT IN [allowlist_for_dest_port] | PIVOT to host logs (Event ID 4688) on source_ip and timestamp to find initiating process
- question: Can unusual patterns in connecting source IPs, such as a loss of diversity or a surge in new hosts, indicate a potential attack on a converter?
  context: This question uses statistical analysis of source IP behavior over time to find anomalies. A sharp drop in Shannon entropy could mean a single unauthorized host is monopolizing connections, while a sudden spike in new, never-before-seen IPs could indicate a coordinated or scanning activity. This method helps detect suspicious access patterns even without a pre-defined allowlist.
  answer_sources:
  - Zeek conn.log
  - Windows Event ID 4688
  - Windows Event ID 4624
  - IT/OT DMZ network boundary, Process Control Network (PCN) segments, supervisory control systems, engineering workstations, Human Machine Interfaces (HMIs), and network segments directly hosting serial-to-Ethernet converters.
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: CALCULATE per-hour Shannon entropy and new_IP_count from Zeek conn.log for each converter | ALERT if entropy drops sharply OR new_IP_count spikes above baseline (e.g., > 99th percentile)
- question: Can a machine learning classifier be used to automatically identify and alert on unauthorized connections to converters in real-time?
  context: This question applies supervised machine learning to automate the enforcement of access policies. By training a model on labeled historical data (based on the allowlist), the system can learn the characteristics of both legitimate and illegitimate connections. This allows for real-time classification of new connections and can flag unauthorized activity with a high degree of confidence, reducing analyst workload.
  answer_sources:
  - Zeek conn.log
  - Windows Event ID 4688
  - Windows Event ID 4624
  - Labeled historical connection data
  - IT/OT DMZ network boundary, Process Control Network (PCN) segments, supervisory control systems, engineering workstations, Human Machine Interfaces (HMIs), and network segments directly hosting serial-to-Ethernet converters.
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: PIPE live Zeek conn.log TO classification_model | FILTER prediction = 'unauthorized' AND confidence_score > 0.9
- question: Are communication failure alarms from our SCADA/HMI systems correlated with suspicious, long-lived network connections to the corresponding converters?
  context: This question focuses on correlating network-level events with application-level impacts. A held-open connection (the attack) should cause legitimate systems to fail when they try to communicate. This query directly links the symptom (communication failure alarms) with the potential cause (an active, suspicious TCP session), providing strong, contextualized evidence of an attack in progress.
  answer_sources:
  - Windows Event Log (Application)
  - Zeek conn.log
  - SCADA master servers, Historian databases, Human Machine Interface (HMI) terminals, and engineering workstations.
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: JOIN (SEARCH Application_Logs for 'Device Unresponsive' alarms) with (SEARCH Zeek conn.log for active, long-duration sessions to same device) | ALERT on match
- question: Is there a statistically significant and sustained increase in communication failure alarms for any critical devices, indicating a potential service disruption?
  context: This question aims to detect the impact of a denial-of-service attack by monitoring its symptoms. By baselining the normal frequency of communication alarms, a sudden and sustained spike beyond a statistical threshold (e.g., 3 standard deviations above the mean) serves as a strong indicator that a device is being actively disrupted, even if the underlying network cause isn't immediately apparent.
  answer_sources:
  - Windows Event Log (Application)
  - Zeek conn.log
  - SCADA master servers, Historian databases, Human Machine Interface (HMI) terminals, and engineering workstations.
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: CALCULATE per-minute alarm count from Application_Logs for each device | ALERT if count > (mean + 3 * std_dev) for > 5 minutes
- question: Can a causal inference model determine the probability that a specific network connection is the root cause of a observed spike in communication alarms?
  context: This question proposes a sophisticated analytical approach to move from correlation to causation. A causal model, like a Bayesian network, can ingest data from both network connections (source IP, duration) and application alarms. It then calculates the probability that a specific suspicious connection is directly causing the observed alarms, helping analysts to pinpoint the exact root cause with high confidence and prioritize their response.
  answer_sources:
  - Windows Event Log (Application)
  - Zeek conn.log
  - SCADA master servers, Historian databases, Human Machine Interface (HMI) terminals, and engineering workstations.
  range: last 90 days
  queries:
  - technology: Pseudocode
    query: PIPE (Zeek conn.log features) AND (Application_Log alarm data) TO Causal_Inference_Model | RANK connections by probability of causing alarms