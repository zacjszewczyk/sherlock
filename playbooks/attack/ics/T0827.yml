name: T0827: Loss of Control
id: 1c2d5f3e-8b9a-4c7d-8e6f-9a0b1c2d3e4f
description: This playbook addresses the threat of an adversary causing a sustained loss of control over a critical industrial process. It focuses on detecting this impact by correlating various data points. Key indicators include Human Machine Interface (HMI) application errors coinciding with a lack of successful Modbus 'Write' commands or a spike in Modbus exceptions; critical process variables deviating beyond their operational envelopes without corresponding authorized control commands; and Safety Instrumented System (SIS) trips that occur without a valid preceding cause, such as a process variable exceeding its safety limit or an authorized manual command.
type: technique
related:
  - TA0105: Impact
contributors:
  - Zachary Szewczyk, Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Have HMI communication failure events occurred without corresponding successful Modbus 'Write' commands being sent?
    context: This question aims to identify a specific failure pattern where an HMI reports a communication error while network logs confirm that it has stopped sending legitimate control commands (Modbus 'Writes'). This could indicate that the HMI software has crashed, been tampered with, or is being blocked from communicating with the PLC, leading to a loss of operator control.
    answer_sources:
      - Windows Event ID 1000
      - Zeek modbus.log
      - HMI hosts in the control room
      - PCN network taps monitoring traffic to critical PLCs
      - Engineering Workstation subnets
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH Windows Event Logs for Event ID 1000 with 'Modbus communication error' from HMI hosts.
          FOR EACH event, SEARCH Zeek modbus.log for successful 'Write' commands (codes 0x05, 0x06, 0x0F, 0x10) from the HMI's IP in the same 1-minute window.
          ALERT if no writes are found.
  - question: Has there been a statistically significant increase in Modbus exception responses from a PLC to an HMI?
    context: This question seeks to detect anomalous error conditions by baselining normal communication patterns. A sudden spike in exception responses (like 'Illegal Function' or 'Illegal Data Address') from a PLC suggests that it is receiving malformed, unauthorized, or otherwise invalid commands, which could be part of an adversary's attempt to probe or disrupt the device.
    answer_sources:
      - Zeek modbus.log
      - HMI hosts in the control room
      - PCN network taps monitoring traffic to critical PLCs
      - Engineering Workstation subnets
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR EACH HMI-PLC pair, CALCULATE 99th percentile of 5-minute Modbus exception counts over 30 days.
          SEARCH current Zeek modbus.log for 5-minute exception counts.
          ALERT if current count > 99th percentile baseline.
  - question: Is an HMI exhibiting a combination of behaviors that deviates from its normal operational profile, as identified by an anomaly detection model?
    context: This question uses a machine learning approach to identify complex, multi-faceted deviations from normal HMI behavior. By combining features like communication errors, exception responses, and the absence of 'Write' commands, the model can detect subtle or novel patterns of attack that might be missed by simpler, single-indicator rules. An alert indicates a high probability of a non-standard, potentially malicious, state.
    answer_sources:
      - Windows Event ID 1000
      - Zeek modbus.log
      - HMI hosts in the control room
      - PCN network taps monitoring traffic to critical PLCs
      - Engineering Workstation subnets
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY pre-trained anomaly detection model to real-time feature set (Event ID 1000 count, Modbus exception count, absence of 'Write' commands) for each HMI.
          ALERT if anomaly score > threshold.
  - question: Have any 'Write' commands been issued from an unauthorized source IP or directed at a restricted PLC register/object?
    context: This question aims to enforce a strict access control policy on control system communications. Any 'Write' command that violates the established whitelist of authorized sources and targets is a strong indicator of unauthorized activity, potentially from a compromised device or an intruder on the network attempting to manipulate the process.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Process Historian database servers
      - Network taps capturing traffic between Level 1 (PLCs/RTUs) and Level 2 (Supervisory Control)
      - specific PLCs controlling critical physical processes
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH Zeek modbus.log and dnp3.log for all 'Write' commands.
          COMPARE source IP and target register/object against the authorized whitelist.
          ALERT on any mismatch.
  - question: Has a critical process variable deviated significantly from its normal operating range without a legitimate, corresponding control command?
    context: This question correlates physical process data with network control commands to distinguish between normal operational changes and potential manipulation. A process variable moving into an anomalous state (e.g., extreme pressure) without a documented, authorized 'Write' command to cause that change strongly suggests that the process is out of control or being manipulated through an unseen channel.
    answer_sources:
      - Process Historian Data
      - Zeek modbus.log
      - Zeek dnp3.log
      - Process Historian database servers
      - Network taps capturing traffic between Level 1 (PLCs/RTUs) and Level 2 (Supervisory Control)
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH Process Historian for critical PVs outside 1st-99th percentile for >5 mins.
          FOR EACH deviation, SEARCH network logs for a corresponding authorized 'Write' command in the same time window.
          ALERT if no such command is found.
  - question: Is the physical process behaving in a way that is not explainable by legitimate control inputs, according to a predictive model?
    context: This question uses a sophisticated forecasting model to understand the complex interplay between different process variables and control actions. An alert signifies that the physical process's actual state is diverging from the model's predicted state, given the known control inputs. This 'unexplained behavior' is a powerful indicator of a potential loss of control.
    answer_sources:
      - Process Historian Data
      - Zeek modbus.log
      - Zeek dnp3.log
      - Network taps capturing traffic between Level 1 (PLCs/RTUs) and Level 2 (Supervisory Control)
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          FEED real-time PV and control command data into the pre-trained VAR model.
          GENERATE forecast and 95% prediction interval.
          COMPARE actual PV values to the prediction interval.
          ALERT if PV is outside the interval for >3 mins.
  - question: Did a Safety Instrumented System (SIS) trip occur without a valid preceding cause?
    context: This question is critical for identifying a potential attack on the safety system itself. An SIS trip is a last-resort safety measure. If it occurs without a legitimate reason (a process variable exceeding a safety limit or a deliberate manual trip), it strongly implies that the SIS was either malfunctioning or maliciously triggered.
    answer_sources:
      - SIS System Logs
      - Process Historian Data
      - Windows Event ID 4624
      - SIS Logic Solver hardware
      - SIS Engineering Workstations
      - Network segments dedicated to the Safety Instrumented Network (SIN)
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          ON SIS trip alarm, SEARCH Process Historian for PVs exceeding safety limits in the preceding 5 minutes.
          SEARCH command logs and Windows Event ID 4624 for authorized manual trip commands in the same window.
          ALERT if neither is found.
  - question: Was an SIS trip correlated with statistically unusual network activity on the SIS network segment?
    context: This question attempts to find network-based evidence of tampering that could have led to an SIS trip. The SIS network should be highly stable and predictable. Any rare or anomalous network event, such as a new device communicating with the SIS logic solver, occurring just before a trip is highly suspicious and could be the attack vector.
    answer_sources:
      - Zeek conn.log
      - SIS System Logs
      - SIS Logic Solver hardware
      - SIS Engineering Workstations
      - Network segments dedicated to the Safety Instrumented Network (SIN)
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          ON SIS trip alarm, ANALYZE network traffic (Zeek conn.log) from the preceding 30 minutes.
          CALCULATE statistical rarity (z-score) of connections compared to a historical baseline.
          ALERT if trip correlates with connections having a z-score > 3.
  - question: Has a machine learning model classified a recent SIS trip as 'Anomalous' with high confidence?
    context: This question leverages a supervised machine learning model to provide a holistic and automated assessment of each SIS trip. By training on historical data, the model learns to distinguish between legitimate and anomalous trips. An 'Anomalous' classification serves as a high-fidelity alert that the trip was likely caused by malicious or non-standard circumstances.
    answer_sources:
      - SIS System Logs
      - Process Historian Data
      - Windows Event ID 4624
      - Zeek conn.log
      - SIS Logic Solver hardware
      - SIS Engineering Workstations
    range: Last 90 days
    queries:
      - technology: pseudocode
        query: |
          APPLY pre-trained classification model to features from a new SIS trip event (PV state, manual command flag, network rarity score).
          ALERT if model classifies the trip as 'Anomalous' with probability > 0.90.