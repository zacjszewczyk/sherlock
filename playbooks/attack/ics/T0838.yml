name: T0838: Modify Alarm Settings
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook focuses on detecting adversarial attempts to modify or suppress critical process alarms, a key tactic for inhibiting response functions. It provides investigative steps to identify unauthorized changes to alarm configuration files, anomalous network transfers of these files to or from critical ICS assets, and the suspicious stopping or disabling of essential alarm-related services on endpoints like HMIs, EWS, and SCADA servers.
type: technique
related:
  - TA0107: Inhibit Response Function
contributors:
  - Zachary Szewczyk
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Was a critical alarm configuration file modified by an unauthorized user, process, or outside of a designated maintenance window?
    context: This question aims to identify direct, unauthorized tampering with alarm configuration files on host systems. Adversaries may modify these files to suppress alarms, change alarm thresholds, or disable them entirely to hide subsequent malicious activity. Detecting modifications by non-whitelisted users/processes or outside of normal business operations (like maintenance windows) is a strong indicator of compromise.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Windows Event ID 5145
      - Windows Event ID 4656
      - Engineering Workstations (EWS)
      - Human-Machine Interfaces (HMIs)
      - Historian servers
      - Data Gateways/OPC Servers
    range: last 90 days
    queries:
      - pseudocode: SEARCH file access events (EventID 4663, 5145) on critical alarm files. JOIN with process creation events (EventID 4688). FILTER for users/processes not in whitelist OR events outside maintenance windows.
  - question: Has there been an anomalous spike in modification activity or a change in the variety of parent processes modifying critical alarm configuration files?
    context: This question uses statistical and information-theoretic methods to find deviations from normal behavior. A sudden increase in the volume of file modifications can indicate automated tampering, while a change in the entropy of parent processes (e.g., a single, unusual process now responsible for all modifications) can reveal a malicious toolset at work, even if the individual actions seem benign.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 5145
      - Engineering Workstations (EWS)
      - Human-Machine Interfaces (HMIs)
      - Historian servers
      - Data Gateways/OPC Servers
    range: last 90 days
    queries:
      - pseudocode: CALCULATE baseline of hourly write/delete counts (EventID 4663, 5145) for alarm files. ALERT if current hour exceeds 99th percentile. CALCULATE rolling 24-hour Shannon entropy of parent process names. ALERT if entropy deviates by >2 standard deviations.
  - question: Does a machine learning model classify a recent alarm configuration file modification as malicious?
    context: This question leverages machine learning to provide a high-confidence verdict on file modification events. By training a model on features like the process name, user, time of day, and file path from known-good and known-bad historical events, it can identify complex, non-obvious patterns of malicious activity that simpler rule-based alerts might miss.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Engineering Workstations (EWS)
      - Human-Machine Interfaces (HMIs)
      - Historian servers
      - Data Gateways/OPC Servers
    range: last 90 days
    queries:
      - pseudocode: INPUT features (process, parent process, user, time, file path) from file modification events (EventID 4663, 4688) into trained classification model. ALERT if prediction is 'malicious' with confidence > 0.90.
  - question: Was a file resembling an alarm configuration transferred to a critical ICS asset from an unapproved source, over an unapproved protocol, or with a hash that does not match a known-good version?
    context: This question focuses on detecting the introduction or exfiltration of alarm configuration files over the network. Adversaries may transfer modified files to a target system or download existing ones for offline analysis. This query checks for transfers involving unapproved endpoints or protocols and verifies the integrity of the transferred file against a list of known-good hashes.
    answer_sources:
      - Zeek files.log
      - Zeek conn.log
      - Zeek smb_files.log
      - Zeek ftp.log
      - IT/OT boundary firewalls
      - Industrial Demilitarized Zones (IDMZ)
      - Control Network segments (Process Control, Safety Instrumented Systems)
      - Wireless Industrial Networks
    range: last 90 days
    queries:
      - pseudocode: SEARCH network file transfers (Zeek files.log) of alarm configuration files to critical assets. JOIN with connection logs (conn.log). ALERT if source IP or destination port is not in whitelist OR file hash is not in known-good list.
  - question: Has there been an anomalous increase in the volume or frequency of alarm configuration file transfers, or a significant change in the diversity of source IPs sending these files?
    context: This question applies baselining techniques to network traffic to detect unusual data movement. A sudden spike in the number or total size of configuration file transfers to a critical asset could indicate an adversary staging their tools. A sharp drop in the entropy of source IPs might reveal a single compromised machine being used to push malicious configurations across the network.
    answer_sources:
      - Zeek files.log
      - Zeek conn.log
      - IT/OT boundary firewalls
      - Industrial Demilitarized Zones (IDMZ)
      - Control Network segments (Process Control, Safety Instrumented Systems)
      - Wireless Industrial Networks
    range: last 90 days
    queries:
      - pseudocode: CALCULATE baseline of daily count and volume of config file transfers (Zeek files.log) to critical assets. ALERT if current day exceeds 99th percentile. CALCULATE rolling 24-hour Shannon entropy of source IPs. ALERT if entropy drops suddenly.
  - question: Does a time-series anomaly detection model identify a recent period of network activity involving critical ICS assets as a significant deviation from normal behavior?
    context: This question uses an advanced unsupervised machine learning model to detect subtle anomalies in network traffic patterns over time. By learning the complex relationships between various network metrics (byte count, packet count, protocols, etc.), the model can flag periods of activity that don't conform to the established norm, which could be indicative of an adversary's presence even if no single rule is broken.
    answer_sources:
      - Zeek files.log
      - Zeek conn.log
      - IT/OT boundary firewalls
      - Industrial Demilitarized Zones (IDMZ)
      - Control Network segments (Process Control, Safety Instrumented Systems)
      - Wireless Industrial Networks
    range: last 90 days
    queries:
      - pseudocode: INPUT aggregated hourly network features (total bytes, packet count, unique protocols, etc.) from Zeek logs into LSTM Autoencoder model. ALERT if reconstruction error (anomaly score) is high.
  - question: Has a critical ICS alarm service been stopped unexpectedly or had its startup type changed to disabled?
    context: This question seeks to identify direct attempts to disable alarm services. An adversary might stop a service to prevent alarms from being generated or change its startup type to 'Disabled' to ensure it doesn't restart after a system reboot. This query specifically looks for these events while filtering out legitimate stops that occur during a planned system shutdown.
    answer_sources:
      - Windows Event ID 7036
      - Windows Event ID 1074
      - Windows Event ID 4688
      - Windows Event ID 7040
      - Operator Stations
      - Human-Machine Interfaces (HMIs)
      - Alarm management servers
      - SCADA Servers
      - Data Historian Servers
    range: last 90 days
    queries:
      - pseudocode: SEARCH for service stop events (EventID 7036) for critical alarm services. ALERT unless a system shutdown event (EventID 1074) occurred within the last 5 minutes. SEPARATELY, ALERT on any service start type change event (EventID 7040) for these services.
  - question: Has a critical alarm service stopped more frequently than usual or after an atypically short uptime?
    context: This question uses statistical baselining to identify abnormal service behavior. A service that repeatedly stops and starts, or stops prematurely after a very short run time, could indicate instability caused by adversarial manipulation or a failing service being repeatedly killed by a malicious script. This helps detect subtle forms of service disruption.
    answer_sources:
      - Windows Event ID 7036
      - Operator Stations
      - Human-Machine Interfaces (HMIs)
      - Alarm management servers
      - SCADA Servers
      - Data Historian Servers
    range: last 90 days
    queries:
      - pseudocode: CALCULATE baseline uptime distribution for critical services (from EventID 7036). ALERT if a service stop occurs with uptime below the 5th percentile. CALCULATE baseline daily frequency of service stops. ALERT if current day's count exceeds the 99th percentile.
  - question: Does a machine learning model classify a recent critical alarm service stop event as suspicious?
    context: This question applies a supervised machine learning approach to provide a high-confidence assessment of service stop events. By training on features like the service name, time of day, and whether the stop was preceded by a system shutdown, the model can learn the nuanced differences between legitimate administrative actions and suspicious, potentially malicious service terminations.
    answer_sources:
      - Windows Event ID 7036
      - Windows Event ID 1074
      - Operator Stations
      - Human-Machine Interfaces (HMIs)
      - Alarm management servers
      - SCADA Servers
      - Data Historian Servers
    range: last 90 days
    queries:
      - pseudocode: INPUT features (service name, time, preceding shutdown flag) from service stop events (EventID 7036) into trained classification model. ALERT if prediction is 'suspicious' with probability > 0.85.