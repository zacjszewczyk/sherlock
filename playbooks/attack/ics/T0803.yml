name: T0803: Block Command Message
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: This playbook helps investigate whether an adversary is attempting to inhibit response functions by blocking command messages from reaching their intended targets, such as PLCs or RTUs. This can be accomplished through several methods, including network-level disruption (e.g., denial-of-service floods), host-level manipulation (e.g., malicious firewall rules on HMIs), or Layer 2 attacks like ARP poisoning to redirect or drop traffic. The goal is to detect these blocking actions by correlating command initiation logs with network traffic, monitoring for anomalous network behavior, and identifying unauthorized changes to endpoint or network configurations.
type: technique
related:
  - TA0107: Inhibit Response Function
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are HMI commands successfully reaching the target PLC/RTU over the network?
    context: This question verifies the fundamental communication path for control commands. A command logged by an HMI or SCADA server should generate corresponding network traffic to the target device. If no traffic is observed within a short time window, it strongly suggests the command was blocked en route, potentially due to network interception, filtering, or a denial-of-service attack preventing delivery.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Zeek enip.log
      - Windows Event ID 4688
      - HMI Application Logs
      - Control Network Zone (between HMIs/SCADA Servers and PLCs/RTUs)
      - HMI/SCADA Server Endpoints
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH HMI_logs OR win_event_4688 FOR command_initiation
          JOIN with network_logs (zeek) WHERE src_ip=HMI_ip AND dst_ip=PLC_ip AND time < command_time + 10s
          ALERT IF no corresponding network_log is found
  - question: Is there anomalous network traffic on critical control segments that could indicate a resource exhaustion attack?
    context: This question aims to detect network-level denial-of-service (DoS) or flooding attacks that could prevent legitimate command messages from being delivered. By establishing a baseline of normal traffic patterns (e.g., bytes/second, packets/second), significant and sustained deviations can signal an attack designed to saturate the network or overwhelm devices.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Zeek enip.log
      - Windows Event ID 4688
      - HMI Application Logs
      - Control Network Zone (between HMIs/SCADA Servers and PLCs/RTUs)
      - HMI/SCADA Server Endpoints
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          DEFINE baseline for network_metrics (bytes/sec, pkts/sec, entropy) over 30 days
          MONITOR live network_metrics
          ALERT IF live_metric > 99th_percentile_baseline FOR > 60s
  - question: Can advanced anomaly detection models identify subtle network disruptions indicative of command blocking?
    context: This question leverages machine learning to detect complex or low-and-slow attacks that might not trigger simple threshold-based alerts. A multivariate model can learn the intricate relationships between various network features (volume, duration, protocol state) in normal HMI-to-PLC communication. A high reconstruction error on live data indicates a significant deviation from this learned normal behavior, providing a high-confidence signal of potential disruption or attack.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Zeek enip.log
      - Windows Event ID 4688
      - HMI Application Logs
      - Control Network Zone (between HMIs/SCADA Servers and PLCs/RTUs)
      - HMI/SCADA Server Endpoints
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN ML_model (VAE/LSTM) on 30+ days of normal zeek_conn_log data
          APPLY model to live traffic
          ALERT IF reconstruction_error > threshold
  - question: Has a malicious firewall rule been added or modified on a critical endpoint to block outbound ICS traffic?
    context: This question targets a direct method of blocking commands at the source. An attacker with access to an HMI or EWS can create or alter local firewall rules to specifically block connections to PLCs on standard ICS ports. Monitoring for unauthorized rule changes that explicitly block this traffic provides a direct and high-fidelity indicator of malicious activity.
    answer_sources:
      - Windows Event ID 4945
      - Windows Event ID 4947
      - Windows Event ID 4950
      - Windows Event ID 5157
      - Human-Machine Interfaces (HMIs)
      - Engineering Workstations (EWS)
      - Control Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MONITOR win_events 4947, 4945
          FOR each event:
            PARSE rule_details
            ALERT IF rule_action='Block' AND rule_dest_ip IN PLC_subnet AND rule_dest_port IN ICS_ports
  - question: Is there an unusual spike in firewall configuration activity on critical endpoints?
    context: This question seeks to identify suspicious behavior by looking at the volume of activity rather than the content of a single change. A sudden, anomalous increase in the number of firewall rule changes could indicate an attacker attempting to find a working configuration, or a script making rapid modifications. This provides an early warning even if the specific malicious rule is missed.
    answer_sources:
      - Windows Event ID 4945
      - Windows Event ID 4947
      - Windows Event ID 4950
      - Windows Event ID 5157
      - Human-Machine Interfaces (HMIs)
      - Engineering Workstations (EWS)
      - Control Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          DEFINE baseline for hourly count of firewall_change_events (4945, 4947, 4950) over 30 days
          MONITOR live event counts
          ALERT IF hourly_count > (mean + 3 * std_dev) of baseline
  - question: Can a machine learning model automatically classify firewall changes as authorized or unauthorized?
    context: This question proposes using a supervised ML model to automate the detection of malicious firewall changes. By training on historical data labeled from change control records, the model can learn the characteristics of legitimate administrative changes versus unauthorized ones. This allows for real-time scoring of all new changes, catching suspicious activity that might otherwise require manual review and correlation.
    answer_sources:
      - Windows Event ID 4945
      - Windows Event ID 4947
      - Windows Event ID 4950
      - Windows Event ID 5157
      - Human-Machine Interfaces (HMIs)
      - Engineering Workstations (EWS)
      - Control Servers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN ML_model (Classifier) on labeled firewall_change_events
          APPLY model to new firewall_change_events in real-time
          ALERT IF classification is 'unauthorized' with high confidence
          CORRELATE with subsequent block events (5157)
  - question: Is there evidence of ARP poisoning targeting critical ICS devices?
    context: This question addresses a man-in-the-middle attack vector where an attacker falsifies ARP responses to redirect or drop traffic. By maintaining a definitive list of correct IP-to-MAC pairings for critical devices, any deviation observed in network ARP traffic is a strong indicator of an ARP spoofing or poisoning attack attempting to intercept or block communication.
    answer_sources:
      - Zeek arp.log
      - Zeek conn.log
      - Control Network Switches
      - Control Network Gateways
      - Critical PLC Network Interfaces
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          MAINTAIN static IP-to-MAC table for critical devices
          MONITOR zeek_arp_log
          ALERT IF observed MAC for a critical IP does not match static table
  - question: Is there an anomalous volume of ARP traffic or MAC address fluctuation for any critical device?
    context: This question looks for secondary indicators of ARP poisoning. An attack often involves a flood of ARP packets to overwrite legitimate cache entries. Monitoring for a statistically significant increase in ARP activity for a specific IP can detect this flooding. Additionally, a critical device with a static IP should never have more than one MAC address; seeing multiple MACs associated with one IP is a definitive sign of conflict or spoofing.
    answer_sources:
      - Zeek arp.log
      - Zeek conn.log
      - Control Network Switches
      - Control Network Gateways
      - Critical PLC Network Interfaces
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          DEFINE baseline for ARP event frequency per critical IP over 7 days
          MONITOR live ARP events
          ALERT IF event_rate > (mean + 3 * std_dev) of baseline
          ALERT IF unique_mac_count for a critical IP > 1 in a 5-min window
  - question: Can an unsupervised model detect novel or complex ARP-based attacks?
    context: This question uses unsupervised machine learning to find unusual patterns in ARP traffic that may not be caught by simple rules. An Isolation Forest or similar model can identify rare and abnormal combinations of ARP attributes (source, destination, opcode, timing) that deviate from learned normal behavior. This can help detect sophisticated attacks, including those that try to be stealthy by avoiding simple flooding.
    answer_sources:
      - Zeek arp.log
      - Zeek conn.log
      - Control Network Switches
      - Control Network Gateways
      - Critical PLC Network Interfaces
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN ML_model (Isolation Forest) on 30+ days of normal zeek_arp_log data
          APPLY model to new ARP events
          ALERT IF anomaly_score is high