name: "T0829: Loss of View"
id: "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
description: "This playbook aims to detect if an adversary is attempting to cause a Loss of View, which blinds operators to the state of the industrial process. This is achieved by monitoring for signs of HMI instability, such as application crashes or hangs; a significant and sustained reduction in network traffic from PLCs and RTUs to HMIs and Historians; or a denial-of-service attack targeting HMI servers, indicated by a surge in failed network connections."
type: "technique"
related:
- "TA0105: Impact"
contributors:
- "Zachary Szewczyk"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
- question: "Are critical HMI processes crashing or terminating unexpectedly based on predefined rules?"
  context: "This question looks for explicit signs of HMI application failure. By monitoring for specific error events (crashes, hangs) or process terminations without a corresponding restart, analysts can quickly identify targeted attacks against operator visibility tools. A high frequency of these events in a short window is a strong indicator of malicious interference."
  answer_sources:
  - "Windows Event ID 1000"
  - "Windows Event ID 1002"
  - "Windows Event ID 4688"
  - "Windows Event ID 4689"
  - "NAI: Critical Operator Workstations and HMI Servers within the Level 2 (Supervisory) and Level 3 (Site Control) zones of the Process Control Network (PCN), including any associated DMZ for remote HMI access."
  range: "last 90 days"
  queries:
  - "Symbolic Logic: SEARCH EventLogs WHERE (EventID=1000 OR EventID=1002) AND ProcessName IN (critical_hmi_list) | COUNT by host, time_window=60s | ALERT if count > 2"
  - "Symbolic Logic: SEARCH EventLogs WHERE EventID=4689 AND ProcessName IN (critical_hmi_list) | CHECK if EventID=4688 for same process/host follows within 30s | ALERT if not"
- question: "Is there a statistically significant increase in HMI application errors or an abnormal delay in process restarts compared to historical baselines?"
  context: "This question uses statistical baselining to detect more subtle forms of HMI instability. Instead of fixed thresholds, it compares current error rates and restart times against learned norms (e.g., 99th percentile). This approach helps identify 'low and slow' attacks or instability issues that might not trigger simple rule-based alerts but still represent a deviation from normal operation."
  answer_sources:
  - "Windows Event ID 1000"
  - "Windows Event ID 1002"
  - "Windows Event ID 4688"
  - "Windows Event ID 4689"
  - "NAI: Critical Operator Workstations and HMI Servers within the Level 2 (Supervisory) and Level 3 (Site Control) zones of the Process Control Network (PCN), including any associated DMZ for remote HMI access."
  range: "last 90 days"
  queries:
  - "Statistical Method: SEARCH EventLogs WHERE EventID IN (1000, 1002) for critical HMI processes | BASELINE count per 10min over 14 days to find 99th_percentile_threshold | ALERT if current_10min_count > 99th_percentile_threshold"
  - "Statistical Method: SEARCH EventLogs for critical HMI processes | BASELINE time_delta between EventID=4689 and EventID=4688 | ALERT if current_delta > (mean + 3 * stdev)"
- question: "Is the current stability pattern of HMI applications anomalous when compared to a machine learning model trained on historical data?"
  context: "This question employs an unsupervised machine learning model to detect complex anomalies in HMI stability. The model learns the normal, multi-dimensional relationships between different event types (errors, terminations) over time. It can identify novel or sophisticated attack patterns that may not be captured by simpler rule-based or statistical methods, providing a more robust defense against unseen threats."
  answer_sources:
  - "Windows Event ID 1000"
  - "Windows Event ID 1002"
  - "Windows Event ID 4689"
  - "NAI: Critical Operator Workstations and HMI Servers within the Level 2 (Supervisory) and Level 3 (Site Control) zones of the Process Control Network (PCN), including any associated DMZ for remote HMI access."
  range: "last 90 days"
  queries:
  - "Machine Learning: FEATURE_ENGINEERING from EventLogs (EventID 1000, 1002, 4689 counts per 1min) | TRAIN IsolationForest model on 30+ days of data | APPLY model to live data stream | ALERT if anomaly_score > threshold"
- question: "Has communication between a critical PLC/RTU and a Historian/HMI stopped for a period longer than the expected maximum polling interval?"
  context: "This question provides a direct, rule-based check for a complete communication loss. By defining critical device pairs and their expected communication frequency, analysts can immediately detect if a data link goes silent. This is a high-fidelity indicator of a potential network disruption, device failure, or deliberate blocking of process data."
  answer_sources:
  - "Zeek conn.log"
  - "Zeek modbus.log"
  - "Zeek dnp3.log"
  - "Zeek enip.log"
  - "Zeek opcua.log"
  - "NAI: Network sensors monitoring critical network segments at the Level 1.5 (Industrial Demilitarized Zone/IDMZ) and Level 2 (Supervisory) boundaries within the Process Control Network (PCN)."
  range: "last 90 days"
  queries:
  - "Symbolic Logic: DEFINE critical_pairs (e.g., PLC_IP:Historian_IP, port, max_interval) | SEARCH Zeek logs for traffic from critical_pairs | ALERT if no traffic seen for a duration > (3 * max_interval)"
- question: "Has the volume or diversity of network traffic from control devices dropped below a statistically established baseline?"
  context: "This question aims to detect a degradation, rather than a complete loss, of communication. By baselining normal traffic volume (bytes) and message diversity (Shannon entropy of function codes), it can identify situations where data is still flowing but is significantly reduced or less varied. This could indicate a partial DoS, a compromised device sending minimal keep-alives, or a filtering rule being applied."
  answer_sources:
  - "Zeek conn.log"
  - "Zeek modbus.log"
  - "Zeek dnp3.log"
  - "Zeek enip.log"
  - "Zeek opcua.log"
  - "NAI: Network sensors monitoring critical network segments at the Level 1.5 (Industrial Demilitarized Zone/IDMZ) and Level 2 (Supervisory) boundaries within the Process Control Network (PCN)."
  range: "last 90 days"
  queries:
  - "Statistical Method: BASELINE byte/message counts per 1min for critical flows over 7 days to find 5th_percentile | ALERT if current_1min_value < 5th_percentile for 3 consecutive minutes"
  - "Statistical Method: BASELINE Shannon entropy of modbus.function_code over 5min | ALERT if current_entropy < 10th_percentile_of_baseline"
- question: "Does the current network traffic volume from control devices deviate significantly from a machine learning forecast of expected behavior?"
  context: "This question uses a time-series forecasting model to predict what the network traffic should look like at any given moment. By comparing the actual observed traffic against the model's prediction and its confidence interval, it can detect subtle, anomalous drops in volume that might be missed by simple statistical thresholds. This method is particularly effective at accounting for normal cyclical variations in traffic."
  answer_sources:
  - "Zeek conn.log"
  - "Zeek modbus.log"
  - "Zeek dnp3.log"
  - "Zeek enip.log"
  - "Zeek opcua.log"
  - "NAI: Network sensors monitoring critical network segments at the Level 1.5 (Industrial Demilitarized Zone/IDMZ) and Level 2 (Supervisory) boundaries within the Process Control Network (PCN)."
  range: "last 90 days"
  queries:
  - "Machine Learning: FEATURE_ENGINEERING from Zeek logs (bytes, packets, etc. per 5min) | TRAIN SARIMA model on 30+ days of data | FORECAST expected traffic and 99% prediction interval | ALERT if observed_volume < lower_bound_of_interval for > 10 minutes"
- question: "Is an HMI server receiving an abnormally high number of failed connection attempts or blocked packets from a single source or in aggregate?"
  context: "This question uses hard-coded thresholds to detect a flood of failed connections, a classic sign of a Denial-of-Service (DoS) attack. By counting specific failure states ('S0', 'REJ') in network logs or blocked packets in firewall logs, analysts can quickly identify an attempt to overwhelm an HMI server and make it unavailable to legitimate operators."
  answer_sources:
  - "Zeek conn.log"
  - "Windows Event ID 5156"
  - "NAI: Network sensors and host logs on critical HMI Servers within the Level 2 (Supervisory) zone of the Process Control Network (PCN) and any associated IDMZ or enterprise DMZ enabling remote access to HMI systems."
  range: "last 90 days"
  queries:
  - "Symbolic Logic: SEARCH Zeek conn.log for connections to HMI_IPs with state IN ('S0', 'REJ', 'RSTO') | ALERT if count_from_single_source > 30 in 30s OR total_count > 100 in 60s"
  - "Symbolic Logic: SEARCH Windows EventID 5156 on HMI servers | ALERT if inbound_blocked_count_from_single_source > 50 in 60s"
- question: "Is an HMI server experiencing both a statistically unusual increase in total connections and a simultaneous spike in the ratio of failed-to-successful connections?"
  context: "This question refines the DoS detection by combining two statistical metrics. It looks for a condition where not only is the overall connection volume abnormally high (exceeding the 99th percentile), but the proportion of those connections that are failing is also unusually high (exceeding the 95th percentile). This combination is a stronger indicator of a malicious DoS attack versus a benign high-traffic event."
  answer_sources:
  - "Zeek conn.log"
  - "Windows Event ID 5156"
  - "NAI: Network sensors and host logs on critical HMI Servers within the Level 2 (Supervisory) zone of the Process Control Network (PCN) and any associated IDMZ or enterprise DMZ enabling remote access to HMI systems."
  range: "last 90 days"
  queries:
  - "Statistical Method: BASELINE total_connections_per_5min and failed_connection_ratio_per_5min for HMI servers | CALCULATE 99th_percentile_total and 95th_percentile_ratio | ALERT if current_total > 99th_percentile_total AND current_ratio > 95th_percentile_ratio"
- question: "Does the network traffic pattern targeting an HMI server exhibit characteristics of a DoS attack as identified by an unsupervised machine learning model?"
  context: "This question uses a machine learning model to identify complex patterns indicative of a DoS attack that go beyond simple volume metrics. By analyzing features like connection rate, source IP/port entropy, and connection state ratios, the model can learn the signature of normal traffic and flag deviations that match known DoS or network scanning profiles, even if the attacker attempts to be stealthy."
  answer_sources:
  - "Zeek conn.log"
  - "Windows Event ID 5156"
  - "NAI: Network sensors and host logs on critical HMI Servers within the Level 2 (Supervisory) zone of the Process Control Network (PCN) and any associated IDMZ or enterprise DMZ enabling remote access to HMI systems."
  range: "last 90 days"
  queries:
  - "Machine Learning: FEATURE_ENGINEERING from Zeek logs (conn_rate, src_ip_entropy, state_ratios, etc.) | TRAIN One-Class SVM model on 30+ days of normal traffic | APPLY model to live traffic | ALERT if data_point is classified as outlier"