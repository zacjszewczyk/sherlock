name: T0804: Block Reporting Message
id: 6f9c4f5a-7e3d-4c8b-9f0a-1d2e3f4a5b6c
description: |
  This playbook helps investigate whether an adversary is inhibiting response functions by blocking critical reporting messages from Industrial Control Systems (ICS). It addresses scenarios such as the unexpected termination of critical ICS applications (e.g., HMI, historian) correlated with a drop in network traffic, the addition or modification of host-based firewall rules to block essential ICS protocol ports, and denial-of-service conditions caused by anomalous traffic surges that disrupt legitimate communications.
type: technique
related:
- TA0107: Inhibit Response Function
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Was a critical ICS application terminated by a suspicious parent process, such as an interactive shell or remote administration tool?
  context: |
    This question aims to identify if a critical process termination was initiated by an actor using interactive tools (like command prompt or PowerShell) rather than a legitimate system or application process. Such an event could indicate direct, hands-on-keyboard activity by an adversary attempting to disrupt operations by shutting down essential software on an HMI or EWS. Identifying this helps differentiate between accidental crashes and deliberate sabotage.
  answer_sources:
  - Windows Event ID 4689
  - Windows Event ID 4688
  - Human-Machine Interfaces (HMIs)
  - Engineering Workstations (EWS)
  - Historian Servers
  - OPC Servers within the Process Control Network (PCN) segments.
  range: Last 90 days
  queries:
  - pseudocode: |
      SEARCH for Windows Event ID 4689 where process_name is in critical_ics_apps_list.
      CORRELATE with Windows Event ID 4688 from same host within 30 seconds prior.
      ALERT if parent_process_name is in suspicious_shells_list AND event is not in maintenance_window.
- question: Following the termination of a critical ICS process, was there a statistically significant drop in its expected network reporting traffic?
  context: |
    This question validates the impact of a process termination. If a critical application responsible for reporting data (like an OPC server) is stopped, the network traffic it generates should cease. By comparing the traffic volume after the termination event to a historical baseline, analysts can confirm that the process termination resulted in a loss of visibility or control, strengthening the evidence of a successful disruption attempt.
  answer_sources:
  - Zeek conn.log
  - Human-Machine Interfaces (HMIs)
  - Engineering Workstations (EWS)
  - Historian Servers
  - OPC Servers within the Process Control Network (PCN) segments.
  range: Last 90 days
  queries:
  - pseudocode: |
      ON process_termination_alert:
      QUERY Zeek conn.log for host in alert.
      CALCULATE average traffic volume for relevant ICS port in 5 minutes post-alert.
      COMPARE to 14-day baseline for same host/port.
      ALERT if post-alert volume < 5th percentile of baseline.
- question: Did the observed network traffic from a critical ICS host deviate significantly from its predicted forecast, and did this deviation coincide with a critical process termination?
  context: |
    This question uses a more advanced, model-driven approach to detect traffic anomalies. Instead of a simple baseline, a time-series model predicts what the traffic should be. A sustained drop below the predicted lower bound is a strong indicator of an issue. Correlating this network anomaly with a specific process termination event on the host provides a high-confidence signal that the process stop directly caused a loss of reporting, likely as part of a malicious action.
  answer_sources:
  - Zeek conn.log
  - Windows Event ID 4689
  - Human-Machine Interfaces (HMIs)
  - Engineering Workstations (EWS)
  - Historian Servers
  - OPC Servers within the Process Control Network (PCN) segments.
  range: Last 90 days
  queries:
  - pseudocode: |
      MODEL continuously predicts expected traffic volume for critical hosts/ports.
      ALERT if observed volume < lower prediction boundary for > 3 minutes.
      ESCALATE alert if correlated with Windows Event ID 4689 on the same host.
- question: Was a new or modified firewall rule configured on a critical ICS asset to block an essential ICS protocol?
  context: |
    This question focuses on detecting an adversary's attempt to sever communications by manipulating the host-based firewall. Blocking a port for a protocol like Modbus or DNP3 can effectively blind a control system. This query specifically looks for the creation or modification of 'Block' rules on critical ports and attempts to filter out legitimate changes by checking against a change management system, thereby focusing on unauthorized and potentially malicious activity.
  answer_sources:
  - Windows Event ID 4947
  - Windows Event ID 4950
  - Windows Event ID 4956
  - HMIs
  - Historian Servers
  - Application Servers in the Process Control Network (PCN)
  - Industrial Demilitarized Zone (IDMZ) servers that bridge IT/OT networks.
  range: Last 90 days
  queries:
  - pseudocode: |
      SEARCH for Windows Event IDs 4947, 4950, 4956 on critical_ics_assets.
      PARSE event for Rule Action, Direction, Port.
      ALERT if Action is 'Block' for a monitored ICS port AND timestamp not in change_management_db.
- question: Following the creation of a firewall block rule on a critical ICS asset, was there a corresponding and statistically significant drop in network traffic on the affected port?
  context: |
    This question serves to confirm the real-world impact of a detected firewall rule change. An alert for a new block rule is suspicious, but confirming that it actually caused a significant disruption in network traffic elevates the finding from a potential misconfiguration to a likely successful attack. By measuring the traffic drop against a historical baseline, analysts can quantify the impact and escalate the incident with higher confidence.
  answer_sources:
  - Zeek conn.log
  - HMIs
  - Historian Servers
  - Application Servers in the Process Control Network (PCN)
  - Industrial Demilitarized Zone (IDMZ) servers that bridge IT/OT networks.
  range: Last 90 days
  queries:
  - pseudocode: |
      ON firewall_modification_alert:
      QUERY Zeek conn.log for affected host/port.
      CALCULATE average traffic volume in 10 minutes post-alert.
      COMPARE to 14-day baseline.
      ESCALATE if post-alert volume drops > 3 standard deviations OR < 5th percentile.
- question: Can we use a machine learning model to automatically classify firewall changes on critical ICS assets as benign or potentially malicious?
  context: |
    This question explores a proactive, machine learning-based approach to identifying malicious firewall modifications. By training a model on various contextual features (e.g., whether it's a critical asset, if it's off-hours, if it's an authorized change), the system can learn the patterns of normal vs. abnormal changes. This allows for automated, real-time scoring of new events, enabling security teams to focus on high-probability malicious changes that exceed a confidence threshold, reducing alert fatigue from simple rule-based detections.
  answer_sources:
  - Windows Event ID 4947
  - Windows Event ID 4950
  - Windows Event ID 4956
  - HMIs
  - Historian Servers
  - Application Servers in the Process Control Network (PCN)
  - Industrial Demilitarized Zone (IDMZ) servers that bridge IT/OT networks.
  range: Last 90 days
  queries:
  - pseudocode: |
      MODEL scores new firewall change events (4947, 4950, 4956) in real-time using features (is_ics_port, is_critical_asset, time_of_day, etc.).
      ALERT if event is classified 'malicious' with confidence > 0.85.
- question: Is a critical ICS endpoint experiencing a high ratio of failed connection attempts while simultaneously showing a sharp drop in legitimate protocol traffic?
  context: |
    This question helps identify a potential denial-of-service (DoS) attack. A flood of connection attempts can overwhelm a device, causing it to reject new connections, including legitimate ones. This query looks for two correlated symptoms: a high failure rate for incoming connections and a corresponding drop in successful, established traffic from expected sources. This combination strongly suggests the endpoint is under duress and unable to perform its reporting function.
  answer_sources:
  - Zeek conn.log
  - Network interfaces of HMIs, Historians, and Control Servers
  - Network segments/VLANs dedicated to process control.
  range: Last 90 days
  queries:
  - pseudocode: |
      SEARCH Zeek conn.log over 5-min window.
      ALERT if (failed_connections / total_connections) > 0.8 for a critical_ics_endpoint AND legitimate_traffic_volume < 10% of previous 1-hour average.
- question: Has a critical ICS endpoint experienced a sudden, anomalous surge in connections from a small number of source IPs, leading to shorter legitimate connection durations?
  context: |
    This question identifies a specific type of DoS attack: a flood from one or a few sources. A massive spike in connections (high standard deviation from the norm) combined with low source IP entropy (meaning the traffic isn't diverse and comes from few places) is a classic indicator of a flood attack. The additional check for a drop in the duration of legitimate connections helps confirm that the flood is negatively impacting the service's ability to maintain stable sessions.
  answer_sources:
  - Zeek conn.log
  - Network interfaces of HMIs, Historians, and Control Servers
  - Network segments/VLANs dedicated to process control.
  range: Last 90 days
  queries:
  - pseudocode: |
      SEARCH Zeek conn.log over 1-min window.
      ALERT if connection_count > (baseline_mean + 5*std_dev) AND source_ip_entropy < 10th_percentile AND average_legitimate_connection_duration has dropped.
- question: Can an unsupervised machine learning model detect anomalous network behavior directed at a critical ICS endpoint that deviates significantly from established normal patterns?
  context: |
    This question proposes using an unsupervised model to find novel or complex attacks that may not fit predefined rules. The model learns what "normal" network traffic looks like across multiple dimensions (connection counts, entropy, byte counts, etc.). It can then flag any minute-by-minute behavior that is statistically unusual, even if the specific pattern has never been seen before. This provides a powerful safety net for detecting sophisticated DoS or other network-based disruption attempts that might evade simpler, signature-based queries.
  answer_sources:
  - Zeek conn.log
  - Zeek notice.log
  - Network interfaces of HMIs, Historians, and Control Servers
  - Network segments/VLANs dedicated to process control.
  range: Last 90 days
  queries:
  - pseudocode: |
      MODEL ingests feature vectors per minute from Zeek conn.log for critical endpoints.
      ALERT if anomaly_score for a vector > 99th percentile of training data scores.