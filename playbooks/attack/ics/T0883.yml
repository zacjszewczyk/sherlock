name: T0883: Internet Accessible Device
id: f47ac10b-58cc-4372-a567-0e02b2c3d479
description: This playbook helps determine if an adversary is attempting to gain initial access to an ICS network through an internet-exposed device. It provides investigative steps to detect various stages of this technique, starting with initial reconnaissance and scanning. This includes identifying inbound network connections from external, non-allowlisted IP addresses targeting ICS-specific or remote access ports, which often manifest as rejected connections, incomplete handshakes, or unusually short-lived sessions. The playbook then addresses brute-force or password spraying attempts by looking for high frequencies of failed remote access logins from external sources. It also focuses on detecting successful but anomalous logins, where a login originates from an IP address that deviates from the user's established behavioral profile in terms of geolocation, time of day, or inclusion on a pre-approved allowlist. Finally, it covers post-compromise indicators, such as anomalous network activity originating from the asset after a suspicious login, including connections to unusual destinations, strange DNS requests, or abnormally large data transfers.
type: technique
related:
  - TA0108: Initial Access
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are there inbound connections from non-allowlisted external IPs to sensitive OT ports that exhibit scanning behavior (rejected, incomplete, or very short-lived connections)?
    context: This question aims to detect initial reconnaissance or scanning activity targeting internet-exposed ICS assets. By monitoring for connections from unknown external sources to specific ICS or remote access ports and filtering for connection states typical of scanning tools ('S0' for incomplete TCP handshakes, 'REJ' for rejected packets) or fleeting successful connections ('SF' with minimal duration and data transfer), analysts can identify potential precursors to an intrusion attempt. Enriching the source IP with threat intelligence adds valuable context, helping to distinguish targeted attacks from generic internet background noise.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Network security monitoring sensors at the IT/OT boundary (Purdue Level 3.5/DMZ), internet gateway firewalls, and network taps within the supervisory control network (Purdue Level 2).
    range: last 90 days
    queries:
      - pseudocode: SEARCH Zeek conn.log WHERE source_ip is not private AND source_ip not in allowlist AND destination_ip in OT_range AND destination_port in (102, 502, 9600, 20000, 44818, 3389, 5900) AND ( (conn_state in ('S0', 'REJ')) OR (conn_state == 'SF' AND duration < 5 AND total_bytes < 100) ) | ENRICH source_ip with threat_intel
  - question: Is there a statistical anomaly in the number of unique external IPs connecting to specific OT ports, or is a single external IP scanning multiple ports on OT assets?
    context: This question uses two statistical methods to uncover scanning activity that might be missed by simple signature-based rules. The first method detects a 'many-to-one' scan, where an unusually high number of external systems target a single port, by comparing the current volume of unique source IPs against a historical baseline. The second method detects a 'one-to-many' scan by calculating the Shannon entropy of destination ports accessed by a single source IP. A high entropy score indicates the IP is probing a wide variety of ports, which is a classic indicator of a port scan.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Network security monitoring sensors at the IT/OT boundary (Purdue Level 3.5/DMZ), internet gateway firewalls, and network taps within the supervisory control network (Purdue Level 2).
    range: last 90 days
    queries:
      - pseudocode: SEARCH Zeek conn.log | BASELINE hourly unique source_ip count per destination_port over 14 days | ALERT if current count > 99th_percentile. AND/OR SEARCH Zeek conn.log | CALCULATE Shannon entropy of destination_ports per source_ip in 1-hour window | ALERT on high entropy score.
  - question: Does the overall volume and pattern of inbound connection attempts from external sources, categorized by connection state, deviate significantly from established historical norms?
    context: This question employs a machine learning approach to detect sophisticated or large-scale scanning campaigns. By training a time-series anomaly detection model on the normal rhythm of inbound traffic (including failed and successful connections), the system can identify subtle but significant shifts in traffic patterns. A high reconstruction error from the model suggests that the current traffic does not conform to the learned normal behavior, indicating a potential coordinated scanning event that might be too distributed or slow to trigger simpler threshold-based alerts.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Network security monitoring sensors at the IT/OT boundary (Purdue Level 3.5/DMZ), internet gateway firewalls, and network taps within the supervisory control network (Purdue Level 2).
    range: last 90 days
    queries:
      - pseudocode: MODEL time-series anomaly detection on hourly inbound connection volume by conn_state from external IPs | TRAIN on 90 days of Zeek conn.log data | ALERT when model reconstruction error exceeds threshold.
  - question: Is an external IP address generating a high volume of failed remote access logins to an OT asset in a short period?
    context: This question focuses on detecting classic brute-force attacks. By setting a simple threshold for the number of failed logins (Event ID 4625 for logon failure) from a single external IP within a minute, we can quickly identify aggressive attempts to guess credentials. Correlating this endpoint event with network data from Zeek provides crucial context, confirming the external origin of the traffic and adding protocol-specific details (like RDP client name or SSH version) that can help fingerprint the attacker's tools. Checking the source IP against a threat intelligence blocklist provides immediate validation of malicious intent.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - Zeek rdp.log
      - Zeek ssh.log
      - Endpoint security logs on internet-facing Windows-based assets in the process control or supervisory networks (Purdue Levels 2-3), authentication logs from Domain Controllers in the IT/OT DMZ (Purdue Level 3.5), and network security monitoring sensors at the network perimeter.
    range: last 90 days
    queries:
      - pseudocode: SEARCH Windows Event ID 4625 WHERE source_ip is not private | COUNT events by source_ip over 60s window | ALERT if count > 5 | ENRICH with Zeek conn/rdp/ssh logs and threat_intel.
  - question: Is the rate of failed logins from a single external IP statistically unusual, and can we differentiate between a brute-force and a password spraying attack?
    context: This question moves beyond fixed thresholds to a more adaptive, behavioral approach. By baselining the 'normal' rate of failed logins for each asset, it can detect 'low-and-slow' brute-force attempts that might evade simple velocity rules. Furthermore, by analyzing the variety of account names being targeted by a single attacker (using Shannon entropy), analysts can distinguish between two common attack patterns: a brute-force attack (low entropy, many passwords against one account) and a password spraying attack (high entropy, one password against many accounts). This distinction is critical for understanding the attacker's methodology and scoping the potential impact.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - Zeek rdp.log
      - Zeek ssh.log
      - Endpoint security logs on internet-facing Windows-based assets in the process control or supervisory networks (Purdue Levels 2-3), authentication logs from Domain Controllers in the IT/OT DMZ (Purdue Level 3.5), and network security monitoring sensors at the network perimeter.
    range: last 90 days
    queries:
      - pseudocode: SEARCH Windows Event ID 4625 | BASELINE hourly failed login rate per asset over 14 days | ALERT if current rate > 99th_percentile. AND/OR CALCULATE Shannon entropy of target_account_name per source_ip in 5-min window | ALERT on low (brute-force) or high (password spray) entropy.
  - question: Can a machine learning model, trained on various contextual features, accurately classify a failed external login attempt as malicious?
    context: This question proposes a sophisticated, high-fidelity detection method using a supervised machine learning model. Instead of relying on a single indicator, the model considers a rich set of features from both endpoint (logon type, status codes) and network (source geolocation, ASN, time of day, RDP client info) data sources. By training on previously labeled examples of good and bad logins, the model can learn complex patterns that signify malicious intent. This approach is powerful for detecting novel or evasive attack techniques that don't fit simple rule-based or statistical patterns, providing analysts with high-confidence alerts.
    answer_sources:
      - Windows Event ID 4625
      - Zeek conn.log
      - Zeek rdp.log
      - Zeek ssh.log
      - Endpoint security logs on internet-facing Windows-based assets in the process control or supervisory networks (Purdue Levels 2-3), authentication logs from Domain Controllers in the IT/OT DMZ (Purdue Level 3.5), and network security monitoring sensors at the network perimeter.
    range: last 90 days
    queries:
      - pseudocode: MODEL supervised classification (Random Forest) on failed logins | FEATURES from Win Event 4625, Zeek conn.log, Zeek rdp.log | TRAIN on labeled historical data | SCORE new failed logins | ALERT if malicious_score > 0.9.
  - question: Has a successful remote login to an OT asset occurred from an external IP address that is not on an approved allowlist for that user or organization?
    context: This question implements a critical, high-fidelity security control. A successful login is a pivotal event, and a login from an unknown, unapproved external location is a major red flag. This check provides a clear, binary signal of a potential account compromise or a severe policy violation. It relies on maintaining an accurate allowlist of approved IP addresses for remote access, whether per-user or for the entire organization (e.g., trusted partner networks, corporate VPNs). An alert from this rule should be treated with the highest priority.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek rdp.log
      - Zeek ssh.log
      - Approved Remote Access IP Whitelist
      - Active Directory Logs
      - Endpoint security logs on internet-facing Windows-based OT assets, authentication logs from central servers (Domain Controllers, RADIUS) in the IT/OT DMZ, and an Identity and Access Management (IAM) system or asset database containing whitelists of approved remote access IPs and user roles.
    range: last 90 days
    queries:
      - pseudocode: SEARCH Windows Event ID 4624 WHERE logon_type in (10, 3) AND source_ip is not private | FILTER source_ip against user-specific or global IP allowlist | ALERT on any login from an unlisted IP.
  - question: Does a successful remote login exhibit behavioral anomalies compared to the user's established historical patterns, such as logging in from a new country, at an unusual time, or from a new IP subnet?
    context: This question operationalizes the concept of User Behavior Analytics (UBA) with a straightforward, rule-based risk scoring system. It acknowledges that even legitimate users may occasionally log in from new locations, so a single deviation may not be malicious. By building a profile of a user's normal activity (geography, time, network location) and assigning a risk score based on deviations from this profile, the system can flag logins that are cumulatively suspicious. This helps detect compromised accounts by identifying behavior that is anomalous *for that specific user*, providing a more nuanced detection than a simple IP allowlist.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek rdp.log
      - Zeek ssh.log
      - Approved Remote Access IP Whitelist
      - Active Directory Logs
      - Endpoint security logs on internet-facing Windows-based OT assets, authentication logs from central servers (Domain Controllers, RADIUS) in the IT/OT DMZ, and an Identity and Access Management (IAM) system or asset database containing whitelists of approved remote access IPs and user roles.
    range: last 90 days
    queries:
      - pseudocode: PROFILE user logins (Event 4624) over 90 days for country, ASN, login_hour, source_subnet | For new login, SCORE risk based on deviation (new_country=+3, new_hour=+1) | ALERT if total_score > threshold.
  - question: Using an unsupervised machine learning model, does a new successful login fall outside the boundary of 'normal' behavior for that user or user group?
    context: This question represents a sophisticated UEBA implementation using unsupervised machine learning. Unlike the previous rule-based scoring, an unsupervised model (like an Isolation Forest) can learn the complex, multi-dimensional boundary of normal behavior without pre-defined rules or labels. It can automatically identify novel combinations of features (e.g., an impossible travel scenario, a login from a known ASN but at a highly unusual time using a never-before-seen RDP client) that are indicative of a compromised session. This approach excels at finding 'unknown unknowns' in user behavior and is highly effective at detecting credential theft.
    answer_sources:
      - Windows Event ID 4624
      - Zeek conn.log
      - Zeek rdp.log
      - Zeek ssh.log
      - Approved Remote Access IP Whitelist
      - Active Directory Logs
      - Endpoint security logs on internet-facing Windows-based OT assets, authentication logs from central servers (Domain Controllers, RADIUS) in the IT/OT DMZ, and an Identity and Access Management (IAM) system or asset database containing whitelists of approved remote access IPs and user roles.
    range: last 90 days
    queries:
      - pseudocode: MODEL unsupervised UEBA (Isolation Forest) per user | FEATURES time_since_last_login, geo_distance, ASN, IP_rep, RDP_client, time_of_day | TRAIN on historical login data (Event 4624, Zeek) | ALERT on logins flagged as anomalies by the model.
  - question: Following an anomalous login, did the user session lead to a process making an outbound network connection to a known command-and-control (C2) server?
    context: This question seeks to confirm a compromise by linking a suspicious login to subsequent malicious activity. It acts as a triggered analytic once a high-risk login is detected, monitoring is heightened. By correlating process creation events (Event ID 4688) on the host with outbound network connections (Zeek conn.log) and checking the destination against a C2 threat intelligence feed, analysts can quickly find the 'smoking gun' that proves an attacker is establishing a foothold. This provides a high-confidence alert that an active compromise is in progress.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Windows Event ID 4688
      - Windows Event ID 5156
      - Network security monitoring sensors (Zeek) at the ICS perimeter and IT/OT DMZ, endpoint detection and response (EDR) logs on the source OT asset (capturing process creation and network filtering events), and DNS server logs.
    range: last 90 days
    queries:
      - pseudocode: TRIGGER on anomalous_login_alert | SEARCH within 60 mins Win Event 4688 on host AND Zeek conn.log from host | CORRELATE process and network connection | ALERT if destination_ip/domain in C2_threat_intel_list.
  - question: Following an anomalous login, is the asset initiating outbound network connections that are statistically unusual for that specific asset (e.g., to a new country, on a strange port, or involving an abnormally large data transfer)?
    context: This question looks for behavioral evidence of post-compromise activity, such as data exfiltration or connections to attacker infrastructure, without relying on threat intelligence. By comparing the characteristics of new outbound connections to the asset's own historical baseline, it can flag activity that is abnormal *for that device*. For example, an HMI that has never connected to an external IP in China suddenly sending 50MB of data is highly suspicious. This baselining approach can detect C2 channels or exfiltration paths that are not yet on any public blocklists.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Windows Event ID 4688
      - Windows Event ID 5156
      - Network security monitoring sensors (Zeek) at the ICS perimeter and IT/OT DMZ, endpoint detection and response (EDR) logs on the source OT asset (capturing process creation and network filtering events), and DNS server logs.
    range: last 90 days
    queries:
      - pseudocode: TRIGGER on anomalous_login_alert | MONITOR outbound Zeek conn.log from asset | COMPARE destination_country, destination_port, total_bytes against asset's 30-day baseline | ALERT on statistical outliers (e.g., new port, transfer size > 99th percentile).
  - question: Following an anomalous login, does the sequence of actions taken by the user (processes launched, DNS queries made, network connections established) deviate from the typical sequences of actions observed on that asset?
    context: This question employs an advanced machine learning technique to detect malicious TTPs (Tactics, Techniques, and Procedures) by analyzing the *order* of events. A legitimate operator might launch a specific engineering tool which then connects to a known server. An attacker, however, might open a command prompt, download a script using PowerShell, and then connect to a new domain. A sequence analysis model (like an HMM or RNN) learns the 'grammar' of normal operations and can flag an observed sequence of events as improbable or anomalous. This is powerful for detecting malicious tradecraft that may use legitimate tools in an illegitimate order.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Windows Event ID 4688
      - Windows Event ID 5156
      - Network security monitoring sensors (Zeek) at the ICS perimeter and IT/OT DMZ, endpoint detection and response (EDR) logs on the source OT asset (capturing process creation and network filtering events), and DNS server logs.
    range: last 90 days
    queries:
      - pseudocode: MODEL sequence analysis (HMM) on post-login event chains (Event 4688 -> Zeek dns.log -> Zeek conn.log) | TRAIN on historical sequences | TRIGGER on anomalous_login_alert | FEED new event sequence to model | ALERT if model assigns low probability to sequence.