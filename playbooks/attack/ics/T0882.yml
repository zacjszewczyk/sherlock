name: 'T0882: Theft of Operational Information'
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: |
  This playbook addresses the threat of an adversary stealing operational information from an Industrial Control System (ICS) environment. The goal is to determine if an attacker has stolen data such as system design documents, process schedules, or operational data, which could be used to inform future attacks or for direct mission impact, as seen in incidents like the Bowman Dam intrusion. The playbook focuses on detecting three primary indicators of this activity: 1) Anomalous bulk data transfers from critical ICS assets (e.g., Engineering Workstations, Historians) to external or unusual destinations, often using non-standard protocols. 2) The use of archiving or compression utilities on critical assets to stage sensitive operational files (e.g., .L5K, .ACD) for exfiltration, especially when executed by unusual users or outside normal maintenance windows. 3) Unusually high rates of access to numerous sensitive operational files by a single user or process within a short timeframe, indicating a "smash and grab" data collection effort.
type: technique
related:
  - 'TA0105: Impact'
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are critical ICS assets communicating with known malicious domains or exhibiting signs of covert exfiltration channels?
    context: This question aims to detect direct exfiltration to command-and-control infrastructure or the use of tunneling techniques (like DNS or ICMP) to bypass security controls. It focuses on identifying connections to suspicious destinations, such as newly registered domains or those with high-entropy names, which are common tactics for data staging and exfiltration.
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek dns.log'
      - 'Zeek files.log'
      - 'Zeek tunnel.log'
      - 'Monitored at: OT-to-IT network gateways, ICS firewalls, Engineering Workstations, Data Historians, DMZ segments, internal network segments hosting critical ICS servers, Internet egress points, SCADA network segments.'
    range: Last 90 days
    queries:
      - query_tech: pseudocode
        query_text: |
          DEFINE watchlist_ics_ips = [IP_1, IP_2, ...];
          DEFINE malicious_indicators = [domain_1, ip_3, ...];

          QUERY Zeek conn.log WHERE source_ip IN watchlist_ics_ips AND destination_ip IN malicious_indicators;
          QUERY Zeek dns.log WHERE client_ip IN watchlist_ics_ips AND (shannon_entropy(query) > 3.5 OR domain_age(query) < 30_days);
          QUERY Zeek tunnel.log WHERE source_ip IN watchlist_ics_ips;
  - question: Has any critical ICS asset transferred an anomalously large volume of data or communicated over an unusual number of ports?
    context: This question focuses on detecting bulk data transfer by establishing a baseline of normal network behavior for each critical asset. A sudden spike in outbound data volume (exceeding the 99th percentile) or an unusual increase in the variety of destination ports can indicate that an adversary is exfiltrating large amounts of stolen operational data.
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek dns.log'
      - 'Zeek files.log'
      - 'Zeek tunnel.log'
      - 'Monitored at: OT-to-IT network gateways, ICS firewalls, Engineering Workstations, Data Historians, DMZ segments, internal network segments hosting critical ICS servers, Internet egress points, SCADA network segments.'
    range: Last 90 days
    queries:
      - query_tech: pseudocode
        query_text: |
          FOR each asset in watchlist_ics_ips:
            BASELINE hourly_outbound_bytes over last 30 days from conn.log;
            CALCULATE threshold = 99th_percentile(hourly_outbound_bytes);
            ALERT if current_hour_outbound_bytes > threshold;

            BASELINE hourly_unique_destination_ports over last 30 days;
            CALCULATE mean, std_dev;
            ALERT if current_hour_unique_ports > (mean + 3 * std_dev);
  - question: Does the network traffic from critical ICS assets show complex deviations from normal patterns that suggest data exfiltration?
    context: This question leverages machine learning to identify subtle or complex anomalies that simple thresholding might miss. By modeling multiple features of network traffic (volume, duration, destination diversity, protocol usage) over time, this approach can detect sophisticated exfiltration techniques that blend in with normal traffic but represent a significant deviation when analyzed holistically.
    answer_sources:
      - 'Zeek conn.log'
      - 'Zeek dns.log'
      - 'Zeek files.log'
      - 'Zeek tunnel.log'
      - 'Monitored at: OT-to-IT network gateways, ICS firewalls, Engineering Workstations, Data Historians, DMZ segments, internal network segments hosting critical ICS servers, Internet egress points, SCADA network segments.'
    range: Last 90 days
    queries:
      - query_tech: pseudocode
        query_text: |
          MODEL = train_anomaly_detection_model(historical_conn_log_data, features=['bytes_out', 'bytes_in', 'duration', 'unique_dest_ips']);
          FOR each time_window in new_conn_log_data:
            anomaly_score = MODEL.predict(time_window);
            IF anomaly_score > threshold:
              ALERT;
  - question: Is an adversary using archiving tools on a critical ICS asset to stage sensitive operational files for exfiltration?
    context: This question aims to detect the preparatory phase of data theft, where an adversary collects and compresses sensitive files. By monitoring for the execution of common archiving utilities (like 7z, rar, or PowerShell's Compress-Archive) combined with command-line arguments that reference specific ICS project files or keywords, analysts can identify staging activities.
    answer_sources:
      - 'Windows Event ID 4688'
      - 'Windows PowerShell Event ID 4104'
      - 'Windows Event ID 4663'
      - 'Monitored at: Engineering Workstations, ICS Application Servers, File servers hosting project data, SCADA/HMI servers, Historian servers, PLC programming stations.'
    range: Last 90 days
    queries:
      - query_tech: pseudocode
        query_text: |
          DEFINE archiver_processes = ['7z.exe', 'rar.exe', 'tar', 'Compress-Archive'];
          DEFINE sensitive_keywords = ['.L5K', '.ACD', '.ap16', 'project', 'recipe'];

          QUERY (EventID 4688 OR EventID 4104) WHERE
            (process_name IN archiver_processes OR script_block_text CONTAINS archiver_processes)
            AND (command_line CONTAINS sensitive_keywords OR script_block_text CONTAINS sensitive_keywords);
  - question: Has an archiving utility been executed by a user or on a host where its use is not typical?
    context: This question uses baselining to detect unusual behavior. An adversary might use legitimate tools for malicious purposes. By tracking which users run which processes on specific hosts, the first-time execution of an archiving tool by a particular user or on a sensitive server is a strong indicator of anomalous activity. It also detects unusual frequency of use, which could indicate bulk staging.
    answer_sources:
      - 'Windows Event ID 4688'
      - 'Windows PowerShell Event ID 4104'
      - 'Windows Event ID 4663'
      - 'Monitored at: Engineering Workstations, ICS Application Servers, File servers hosting project data, SCADA/HMI servers, Historian servers, PLC programming stations.'
    range: Last 90 days
    queries:
      - query_tech: pseudocode
        query_text: |
          FOR each event in EventID 4688 logs where process_name is an archiver:
            IF user-host-process combination is first_seen:
              ALERT;
            ELSE:
              BASELINE daily execution count for user-host-process;
              CALCULATE mean, std_dev;
              ALERT if current_day_count > (mean + 3 * std_dev);
  - question: Does the execution of an archiving utility exhibit behavioral characteristics that are inconsistent with normal, legitimate use?
    context: This question applies machine learning to process execution data to find subtle deviations. A legitimate use of an archiving tool might be launched by a specific parent process, by a specific user, at a certain time of day. An adversary's use might deviate in one or more of these contextual features. This model aims to detect such behavioral anomalies that simple rules might miss.
    answer_sources:
      - 'Windows Event ID 4688'
      - 'Windows PowerShell Event ID 4104'
      - 'Windows Event ID 4663'
      - 'Monitored at: Engineering Workstations, ICS Application Servers, File servers hosting project data, SCADA/HMI servers, Historian servers, PLC programming stations.'
    range: Last 90 days
    queries:
      - query_tech: pseudocode
        query_text: |
          MODEL = train_anomaly_detection_model(historical_4688_data, features=['parent_process', 'user', 'time_of_day', 'tokenized_cmd_line']);
          FOR each new archiving process execution:
            anomaly_score = MODEL.predict(execution_features);
            IF anomaly_score > threshold:
              ALERT;
  - question: Is an unauthorized user account attempting to access sensitive operational files?
    context: This question provides a direct, rule-based check for unauthorized access. It verifies if accounts that are not explicitly authorized (e.g., non-engineering accounts) are reading sensitive ICS project files, configuration data, or design documents. This is a high-fidelity indicator of potential data theft or reconnaissance.
    answer_sources:
      - 'Windows Event ID 4663'
      - 'Windows Event ID 4656'
      - 'Monitored at: File servers containing operational design documents, PLC/HMI project repositories, Engineering Workstations, Historian file shares, SCADA client machines, central configuration management servers.'
    range: Last 90 days
    queries:
      - query_tech: pseudocode
        query_text: |
          DEFINE sensitive_files = ['*.L5K', '*.ACD', '*\\projects\\*'];
          DEFINE authorized_users = [user_A, user_B, ...];

          QUERY EventID 4663 WHERE
            access_type CONTAINS 'ReadData'
            AND object_name MATCHES sensitive_files
            AND user_name NOT IN authorized_users;
  - question: Has any user accessed an unusually large number or variety of sensitive files in a short time frame?
    context: This question seeks to identify "smash and grab" data collection, where an adversary quickly accesses many files. By baselining the normal file access rate and variety for each user, a sudden spike beyond the statistical norm (e.g., 3 standard deviations) within a short window (10 minutes) strongly indicates anomalous collection behavior preceding exfiltration.
    answer_sources:
      - 'Windows Event ID 4663'
      - 'Windows Event ID 4656'
      - 'Monitored at: File servers containing operational design documents, PLC/HMI project repositories, Engineering Workstations, Historian file shares, SCADA client machines, central configuration management servers.'
    range: Last 90 days
    queries:
      - query_tech: pseudocode
        query_text: |
          FOR each user:
            AGGREGATE file access events in 10-minute windows;
            BASELINE unique_file_count_per_window and file_extension_entropy_per_window;
            CALCULATE mean, std_dev for both metrics;
            ALERT if current_window_count > (mean_count + 3 * std_dev_count)
              OR current_window_entropy > (mean_entropy + 3 * std_dev_entropy);
  - question: Does a user's sequence of file access activities deviate from their established behavioral profile?
    context: This question employs advanced behavioral analytics (UEBA) to detect sophisticated adversaries. Instead of just looking at volume, it analyzes the *sequence* of file accesses. A user might normally access files in a specific order or from a particular directory. An adversary, even if accessing a similar number of files, will likely do so in a different, less probable sequence, which this model is designed to detect.
    answer_sources:
      - 'Windows Event ID 4663'
      - 'Windows Event ID 4656'
      - 'Monitored at: File servers containing operational design documents, PLC/HMI project repositories, Engineering Workstations, Historian file shares, SCADA client machines, central configuration management servers.'
    range: Last 90 days
    queries:
      - query_tech: pseudocode
        query_text: |
          MODEL = train_sequence_model(historical_file_access_data, features=['file_path', 'access_type']);
          FOR each new user session:
            access_sequence = get_file_access_sequence(session);
            sequence_probability = MODEL.score(access_sequence);
            IF sequence_probability < probability_threshold:
              ALERT;