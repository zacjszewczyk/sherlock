name: 'T0882: Theft of Operational Information'
id: 'c8a2b3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d'
description: "This playbook addresses the threat of an adversary stealing operational information from an Industrial Control System (ICS) environment. The primary goal is to determine if an attacker has stolen sensitive data such as system design documents, operational schedules, or process data, which could be used to plan future attacks or achieve direct mission outcomes, as seen in incidents like the Bowman Dam case [1] [2]. The playbook focuses on detecting three main indicators of this activity: 1) Anomalous network data transfers originating from critical ICS assets (e.g., Engineering Workstations, Historians) to external or unusual destinations, often characterized by large data volumes, connections to suspicious domains, or the use of covert channels like DNS or ICMP. 2) The use of archiving or compression utilities (e.g., 7z.exe, tar) on critical assets to package sensitive operational files (.L5K, .ACD), especially when executed by unusual user accounts or outside of normal maintenance windows. 3) Mass file access events, where a single user or process rapidly accesses an unusually high number of distinct, sensitive operational files, indicating a 'smash and grab' data collection attempt."
type: 'technique'
related:
  - 'TA0105: Impact'
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: '2025-10-01'
modified: '2025-10-01'
version: 1.0
tags: 'none'
questions:
  - question: "Have critical ICS assets initiated connections to known malicious domains or domains with suspicious characteristics, or used tunneling protocols for potential data exfiltration?"
    context: "This question focuses on identifying direct exfiltration attempts by checking for connections from high-value ICS assets to known bad destinations from threat intelligence feeds. It also looks for indicators of covert channels, such as DNS tunneling or connections to newly registered or algorithmically generated domains (high Shannon entropy), which are common tactics for bypassing network security controls."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek files.log"
      - "Zeek tunnel.log"
      - "OT-to-IT network gateways, ICS firewalls, Engineering Workstations, Data Historians, DMZ segments, internal network segments hosting critical ICS servers, Internet egress points, SCADA network segments."
    range: "last 90 days"
    queries:
      - "pseudocode: FOR each IP in critical_asset_watchlist; SEARCH Zeek_conn_log WHERE source_ip=IP AND destination_ip IN threat_intel_feed; SEARCH Zeek_dns_log WHERE source_ip=IP AND (domain_shannon_entropy > 3.5 OR domain_age < 30_days); SEARCH Zeek_tunnel_log WHERE source_ip=IP; ALERT on any match."
  - question: "Has any critical ICS asset exhibited an anomalous spike in outbound data volume or connected to an unusually high number of unique destination ports?"
    context: "This question aims to detect bulk data transfer by establishing a baseline of normal network behavior for each critical asset. A significant deviation from this baseline, such as transferring an unusually large amount of data (e.g., exceeding the 99th percentile) or connecting to many different ports in a short period, can be a strong indicator of data staging or exfiltration, even if the destination is not known to be malicious."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek files.log"
      - "Zeek tunnel.log"
      - "OT-to-IT network gateways, ICS firewalls, Engineering Workstations, Data Historians, DMZ segments, internal network segments hosting critical ICS servers, Internet egress points, SCADA network segments."
    range: "last 90 days"
    queries:
      - "pseudocode: FOR each IP in critical_asset_watchlist; CALCULATE 30-day baseline of hourly outbound_bytes AND unique destination_ports from Zeek_conn_log; ALERT IF current_hour_outbound_bytes > 99th_percentile_baseline OR current_hour_unique_ports > (mean_baseline + 3 * std_dev_baseline)."
  - question: "Does the overall network traffic pattern for any critical ICS asset show a significant deviation from historically normal behavior, as identified by a machine learning model?"
    context: "This question leverages machine learning to identify complex and subtle anomalies that might be missed by simple threshold-based rules. A time-series model (e.g., Isolation Forest, STL) can learn the normal 'rhythm' of an asset's network activity—including data volume, connection duration, and protocol usage—and flag periods that do not conform to this learned pattern, which could indicate sophisticated exfiltration techniques."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek dns.log"
      - "Zeek files.log"
      - "Zeek tunnel.log"
      - "OT-to-IT network gateways, ICS firewalls, Engineering Workstations, Data Historians, DMZ segments, internal network segments hosting critical ICS servers, Internet egress points, SCADA network segments."
    range: "last 90 days"
    queries:
      - "pseudocode: INPUT historical Zeek_conn_log data (bytes, duration, protocols, etc.) for critical assets into time-series anomaly detection model (e.g., Isolation Forest); FEED live Zeek_conn_log data into the trained model; ALERT IF model returns a high anomaly score for any time window."
  - question: "Has an archiving or compression utility been executed on a critical ICS asset with command line arguments targeting sensitive operational files?"
    context: "Adversaries often compress and archive data before exfiltration to reduce its size and evade detection. This question directly searches for the use of common archiving tools (like 7z.exe, rar.exe, tar, or PowerShell's Compress-Archive) that are specifically targeting files known to be critical to ICS operations (e.g., .L5K, .ACD, project files, recipes, or design documents)."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows PowerShell Event ID 4104"
      - "Windows Event ID 4663"
      - "Engineering Workstations, ICS Application Servers, File servers hosting project data, SCADA/HMI servers, Historian servers, PLC programming stations."
    range: "last 90 days"
    queries:
      - "pseudocode: SEARCH WinEvent:4688 OR WinEvent:4104 ON critical_assets; ALERT IF process_name IN (7z.exe, rar.exe, tar, etc.) OR script_block CONTAINS 'Compress-Archive' AND (command_line CONTAINS '.L5K' OR command_line CONTAINS '.ACD' OR command_line CONTAINS 'project')."
  - question: "Has an archiving utility been executed on a critical ICS asset by a user who has never used it on that machine before, or has its usage frequency spiked anomalously?"
    context: "This question focuses on behavioral anomalies related to user activity. Legitimate engineers may have a regular, predictable pattern of using archiving tools. A user running an archiver for the first time on a specific machine ('first-seen' analysis), or a sudden, dramatic increase in usage beyond a statistical baseline (e.g., 3 standard deviations), are strong indicators that the activity may be part of an adversary's data collection and staging process."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows PowerShell Event ID 4104"
      - "Windows Event ID 4663"
      - "Engineering Workstations, ICS Application Servers, File servers hosting project data, SCADA/HMI servers, Historian servers, PLC programming stations."
    range: "last 90 days"
    queries:
      - "pseudocode: BUILD baseline of user-host-process combinations from WinEvent:4688; ALERT IF new execution of an archiving utility is a 'first-seen' user-host-process event; FOR known combinations, CALCULATE daily execution baseline; ALERT IF daily_count > (mean_baseline + 3 * std_dev_baseline)."
  - question: "Does the execution of an archiving utility on a critical ICS asset deviate from normal, learned behavior based on its context (e.g., parent process, user, time of day)?"
    context: "This question employs a more sophisticated machine learning approach (e.g., One-Class SVM) to detect malicious process execution. The model learns what 'normal' looks like for every process, considering factors like who ran it, what process spawned it, and when it was run. An archiving process spawned by an unusual parent (e.g., a web server process) or run at an odd time would be flagged as anomalous, indicating potential compromise."
    answer_sources:
      - "Windows Event ID 4688"
      - "Windows PowerShell Event ID 4104"
      - "Windows Event ID 4663"
      - "Engineering Workstations, ICS Application Servers, File servers hosting project data, SCADA/HMI servers, Historian servers, PLC programming stations."
    range: "last 90 days"
    queries:
      - "pseudocode: INPUT historical WinEvent:4688 data (parent process, user, time, command line tokens) into behavioral anomaly detection model (e.g., One-Class SVM); FEED live WinEvent:4688 data into the trained model; ALERT IF model returns a high anomaly score for an archiving process execution."
  - question: "Has a non-authorized user account attempted to read sensitive ICS operational files on a critical file server or workstation?"
    context: "This question provides a direct, rule-based check for unauthorized access. By maintaining a list of sensitive file paths/extensions (e.g., *.L5K, *\\configs\\*.ACD) and a corresponding list of authorized engineering accounts, an alert can be triggered whenever an account outside the approved group attempts to access these protected files. This is a high-fidelity indicator of reconnaissance or data theft."
    answer_sources:
      - "Windows Event ID 4663"
      - "Windows Event ID 4656"
      - "File servers containing operational design documents, PLC/HMI project repositories, Engineering Workstations, Historian file shares, SCADA client machines, central configuration management servers."
    range: "last 90 days"
    queries:
      - "pseudocode: SEARCH WinEvent:4663 WHERE access_type='ReadData'; ALERT IF file_path IN sensitive_file_watchlist AND user NOT IN authorized_user_list."
  - question: "Has any user accessed an abnormally large number or an unusually diverse variety of sensitive files within a short time frame?"
    context: "Adversaries performing 'smash and grab' data theft will often access a large quantity of files in a short period (e.g., 10 minutes). This question establishes a baseline of normal file access behavior for each user. An alert is triggered if a user suddenly accesses far more files than usual (>3 standard deviations from their mean) or if the types of files they access become unusually varied (Shannon entropy of file extensions > 3.0), which can indicate a broad collection effort."
    answer_sources:
      - "Windows Event ID 4663"
      - "Windows Event ID 4656"
      - "File servers containing operational design documents, PLC/HMI project repositories, Engineering Workstations, Historian file shares, SCADA client machines, central configuration management servers."
    range: "last 90 days"
    queries:
      - "pseudocode: FOR each user; AGGREGATE WinEvent:4663 events in 10-minute windows; CALCULATE baseline of unique_file_count and file_extension_entropy; ALERT IF current_window_count > (mean_count + 3 * std_dev) OR current_window_entropy > (mean_entropy + 3 * std_dev)."
  - question: "Does a user's sequence of file access events deviate from their historically learned patterns of behavior, as determined by a UEBA model?"
    context: "This is an advanced question, focusing on the *sequence* of actions rather than just the volume. A User and Entity Behavior Analytics (UEBA) model (e.g., HMM or LSTM) can learn a user's typical workflow, such as 'opens project file -> reads configuration files -> accesses library files.' A sequence that violates this learned pattern, such as rapidly accessing files from many different, unrelated projects, would be flagged as highly anomalous and indicative of malicious activity."
    answer_sources:
      - "Windows Event ID 4663"
      - "Windows Event ID 4656"
      - "File servers containing operational design documents, PLC/HMI project repositories, Engineering Workstations, Historian file shares, SCADA client machines, central configuration management servers."
    range: "last 90 days"
    queries:
      - "pseudocode: INPUT historical WinEvent:4656/4663 data into a sequence model (e.g., HMM, LSTM) to profile user file access patterns; FEED live file access events into the trained model; ALERT IF the model assigns a low probability to a user's observed sequence of file accesses."