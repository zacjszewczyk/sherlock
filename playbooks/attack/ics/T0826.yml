name: T0826: Loss of Availability
id: f5d8e7c0-a5b8-4c3e-8f9a-1b2c3d4e5f67
description: This playbook helps investigate whether an adversary has caused a loss of availability in a critical Industrial Control System (ICS) component. It addresses three primary scenarios: 1) A complete cessation of network communication from a critical host (e.g., HMI, Historian), correlated with process termination or system shutdown events. 2) A sudden and sustained surge of file modification events (writes, renames, deletes) on critical data directories, indicative of ransomware activity designed to make data unusable. 3) An abrupt increase in network traffic volume or connection rates targeting critical field devices (e.g., PLCs, RTUs) on specific ICS protocol ports, suggesting a network-based denial-of-service attack.
type: technique
related:
  - TA0105: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has a period of network silence from a critical ICS host been correlated with an unexpected process termination or system shutdown event on that same host?
    context: This question aims to link a potential network-level denial of service (DoS) or host-based outage with a specific causal event on the host itself. Correlating network silence with critical process crashes (e.g., HMI runtime), service stops, or system shutdowns helps differentiate a targeted attack from a simple network failure. Identifying the specific process or shutdown reason provides strong evidence of malicious intent, such as an adversary terminating essential ICS software to cause a loss of availability.
    answer_sources:
      - Zeek conn.log
      - Windows Event ID 1000
      - Windows Event ID 1002
      - Windows Event ID 7036
      - Windows Event ID 4608
      - Windows Event ID 4609
      - Windows Event ID 1074
      - Windows Event ID 4689
      - Human-Machine Interfaces (HMIs), Engineering Workstations, Operator Stations, Historian Servers, Data Gateways, and Domain Controllers located on the Process Control Network (PCN) or ICS Demilitarized Zone (DMZ).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH host logs (Windows Events 1000, 1002, 7036, 4689, 4608, 4609, 1074) FOR critical process names WITHIN 5 minutes of network silence alert.
  - question: Has any critical ICS host experienced a statistically significant period of network silence?
    context: This question focuses on detecting a loss of availability by identifying when a critical asset stops communicating on the network. By establishing a baseline of normal communication intervals for each host, we can flag abnormal periods of silence that exceed a statistical threshold (e.g., 3 standard deviations) or a fixed time limit. This is a primary indicator that a host may be offline, shut down, or otherwise unable to perform its function, directly impacting system availability.
    answer_sources:
      - Zeek conn.log
      - Human-Machine Interfaces (HMIs), Engineering Workstations, Operator Stations, Historian Servers, Data Gateways, and Domain Controllers located on the Process Control Network (PCN) or ICS Demilitarized Zone (DMZ).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR each critical host, CALCULATE baseline of communication intervals from Zeek logs over 7 days. ALERT if time since last communication > (mean + 3*std_dev) OR > 60 seconds.
  - question: Has a time-series anomaly detection model identified a significant deviation in the communication frequency of a critical ICS host?
    context: This question leverages machine learning to provide a more sophisticated method for detecting network silence. A time-series model (like an LSTM autoencoder) learns the complex, moment-to-moment patterns of a host's network activity. An alert from this model indicates that the current communication pattern, particularly a sustained lack of it, is highly anomalous compared to its learned history. This can detect subtle or complex outages that simpler statistical methods might miss.
    answer_sources:
      - Zeek conn.log
      - Human-Machine Interfaces (HMIs), Engineering Workstations, Operator Stations, Historian Servers, Data Gateways, and Domain Controllers located on the Process Control Network (PCN) or ICS Demilitarized Zone (DMZ).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: APPLY trained LSTM model to per-minute communication frequency from Zeek logs. ALERT if anomaly score > 0.7.
  - question: Is a high rate of file modifications on critical ICS directories associated with known ransomware indicators, such as specific process names, command-line arguments, or file extensions?
    context: This question seeks to confirm if a mass file modification event is ransomware-related, which causes a loss of availability by making data and project files unusable. By correlating file access events (Event ID 4663) with process creation events (Event ID 4688), analysts can identify the malicious process. Further investigation for known ransomware TTPs, like deleting volume shadow copies (`vssadmin.exe`) or the appearance of '.locked' extensions, provides definitive evidence of a ransomware attack.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - Windows Event ID 4656
      - Windows Event ID 4659
      - Historian Servers, Engineering Workstations, File Servers hosting ICS project files and configurations, and Backup Servers storing critical ICS data, all located within the Process Control Network (PCN) or ICS Demilitarized Zone (DMZ).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH for high volume of file modification events (4663, 4656). CORRELATE with process creation events (4688) to find process name. CHECK process name, command line, and file extensions against ransomware watchlist.
  - question: Has any process exhibited a statistically anomalous rate of file modification events or a sudden drop in the entropy of modified file extensions on critical ICS directories?
    context: This question provides a behavioral approach to detecting ransomware-like activity without relying on known signatures. By baselining normal file access rates per process, a sudden, sustained spike above the 99th percentile is a strong anomaly indicator. Additionally, ransomware often renames files to a single new extension (e.g., 'file.txt' -> 'file.txt.locked'). This uniformity causes a sharp drop in file extension entropy, providing a powerful mathematical signal of mass renaming activity.
    answer_sources:
      - Windows Event ID 4663
      - Historian Servers, Engineering Workstations, File Servers hosting ICS project files and configurations, and Backup Servers storing critical ICS data, all located within the Process Control Network (PCN) or ICS Demilitarized Zone (DMZ).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR each process on critical hosts, CALCULATE baseline of file modification rate (Event 4663). ALERT if rate > 99th percentile for 3 mins. SIMULTANEOUSLY, calculate entropy of file extensions in 5-min window. ALERT if entropy drops significantly (e.g., < 0.5).
  - question: Has a machine learning clustering model detected a new, anomalous pattern of file access activity on a critical ICS host?
    context: This question uses unsupervised machine learning to find novel attack patterns. A clustering algorithm like DBSCAN learns what 'normal' file access looks like by grouping similar events (based on process, file path, time) into benign clusters. When a new group of events emerges that doesn't fit any known benign cluster, it signals a significant deviation. This is effective for detecting zero-day ransomware or other mass file manipulation tools whose behavior is inherently different from normal system and user activity.
    answer_sources:
      - Windows Event ID 4663
      - Historian Servers, Engineering Workstations, File Servers hosting ICS project files and configurations, and Backup Servers storing critical ICS data, all located within the Process Control Network (PCN) or ICS Demilitarized Zone (DMZ).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: APPLY trained DBSCAN model to file access events (Event 4663) in 5-minute windows. ALERT if a new, anomalous cluster is detected.
  - question: Are critical ICS field devices receiving traffic from non-allow-listed IP addresses, and does this activity correlate with denial-of-service alerts?
    context: This question aims to detect network-based denial-of-service attacks against PLCs, RTUs, and other field devices. The Process Control Network should operate on a strict allow-list basis. Any traffic from an unauthorized source IP to a critical device is inherently suspicious. Correlating this with specific DoS-related network alerts (e.g., SYN floods, address scans) from the same source strengthens the finding and indicates a deliberate attempt to disrupt or overwhelm the device.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek profinet.log
      - Zeek ethernetip.log
      - The Process Control Network (PCN) segments, specifically network traffic directed at PLCs, RTUs, IEDs, and other field devices. This includes monitoring at network boundaries (e.g., Firewalls between PCN zones) and within specific control segments (e.g., Level 1 control networks).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FROM Zeek conn.log, FILTER traffic to ICS ports on critical devices. CHECK if source IP is in allow-list. ALERT if not. CORRELATE alerts with Zeek notice.log events (DDoS, Scan) from the same source IP within a 1-minute window.
  - question: Has any critical ICS field device experienced a statistically significant increase in inbound connection rate or data volume from a single source?
    context: This question focuses on identifying a denial-of-service attack through volume-based metrics. By establishing a baseline for normal traffic patterns (connections per minute, bytes per minute) to each field device, we can detect anomalous spikes. A sudden, sustained surge from a single source that exceeds a high percentile (99th) or multiple standard deviations above the average is a strong indicator of a flood attack designed to overwhelm the device's processing or network capacity, causing a loss of availability.
    answer_sources:
      - Zeek conn.log
      - The Process Control Network (PCN) segments, specifically network traffic directed at PLCs, RTUs, IEDs, and other field devices. This includes monitoring at network boundaries (e.g., Firewalls between PCN zones) and within specific control segments (e.g., Level 1 control networks).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR each critical device, CALCULATE baseline for connection rate and data volume from Zeek logs. ALERT if metrics from a single source IP > 99th percentile OR > (mean + 4*std_dev) for at least 30 seconds.
  - question: Has an unsupervised anomaly detection model identified anomalous network flows directed at critical ICS devices?
    context: This question uses a machine learning approach to detect novel or complex network attacks that might evade simple threshold-based rules. An Isolation Forest model, for example, can analyze multiple features of a network flow simultaneously (IPs, ports, protocol, byte/packet counts, duration). It learns the characteristics of normal traffic and can flag flows that are 'isolated' or different. An alert from this model indicates a high probability of a malicious or malformed communication pattern designed to disrupt the target device.
    answer_sources:
      - Zeek conn.log
      - The Process Control Network (PCN) segments, specifically network traffic directed at PLCs, RTUs, IEDs, and other field devices. This includes monitoring at network boundaries (e.g., Firewalls between PCN zones) and within specific control segments (e.g., Level 1 control networks).
    range: last 90 days
    queries:
      - technology: pseudocode
        query: APPLY trained Isolation Forest model to network flow features from Zeek logs for traffic to critical ICS devices. ALERT if anomaly score > 0.7.