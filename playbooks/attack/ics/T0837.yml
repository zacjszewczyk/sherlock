name: T0837: Loss of Protection
id: f1a7b8c2-9d0e-4f1a-8b3c-5d7e6f4a2b1c
description: >-
  This playbook helps investigate if an adversary has disabled or degraded critical protective functions. This can involve sending anomalous safety-critical commands (e.g., 'Stop CPU', 'Program/Logic Download') to a Safety Instrumented System (SIS) controller from unauthorized sources or outside maintenance windows. It also covers malicious modifications to critical alarm parameters (setpoints, deadbands) in HMI or industrial protocol traffic, where values are moved to a less safe state. Additionally, it addresses scenarios where a critical protective device, like a Safety PLC or protective relay, stops sending expected network traffic, indicating it may be offline or compromised.
type: technique
related:
  - TA0105: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Has a safety-impacting command been sent to a critical SIS controller from an unauthorized source?
    context: >-
      Adversaries may attempt to directly interact with Safety Instrumented Systems (SIS) to cause a loss of protection. This question looks for specific, high-consequence commands like 'Stop CPU' or 'Program/Logic Download' sent to a known SIS controller. The analysis is triggered if the command originates from an IP address not on an approved Engineering Workstation (EWS) whitelist or is executed by a user account that is not part of an authorized engineering group, indicating a likely unauthorized and malicious action.
    answer_sources:
      - Zeek s7comm.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek dnp3.log
      - Zeek bacnet.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - SIS network segments (Level 0/1)
      - Engineering Workstation (EWS) network segment (Level 2/3)
      - Process Control Network (PCN) segments where EWS communicate with SIS devices
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH industrial_protocol_logs
          WHERE command IN ('Stop CPU', 'Program/Logic Download')
          AND destination_ip IN sis_watchlist
          AND source_ip NOT IN ews_whitelist
          CORRELATE source_ip and timestamp with logon_events
          TO IDENTIFY user and user_groups
          ALERT IF user_group NOT IN authorized_sis_engineer_group
  - question: Have there been anomalous logic downloads to an SIS controller, indicated by unusual file size or frequency?
    context: >-
      Malicious actors might try to overwrite the logic on an SIS controller to disable or alter its safety functions. This question aims to detect such activity by baselining normal logic download behavior. It establishes historical norms for both the frequency of downloads and the size of the downloaded logic files. An alert is triggered if a new download's size or the hourly frequency of downloads exceeds a statistical threshold (e.g., mean plus three standard deviations), suggesting a deviation from routine engineering activity.
    answer_sources:
      - Zeek s7comm.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek dnp3.log
      - Zeek bacnet.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - SIS network segments (Level 0/1)
      - Engineering Workstation (EWS) network segment (Level 2/3)
      - Process Control Network (PCN) segments where EWS communicate with SIS devices
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          DEFINE baseline for sis_controller over 60 days for download_frequency_per_hour and download_file_size
          CALCULATE mean(μ) and std_dev(σ) for both metrics
          SEARCH for new logic_download events
          ALERT if new_download_size > (μ_size + 3σ_size)
          ALERT if hourly_download_count > (μ_freq + 3σ_freq)
  - question: Does the overall communication pattern with an SIS controller deviate significantly from its established historical baseline?
    context: >-
      Beyond specific commands, the overall pattern of interaction with an SIS can reveal adversary activity. This question uses an unsupervised machine learning model (e.g., Isolation Forest) to learn the normal operational profile of an SIS controller. It analyzes features like the volume of commands, command type diversity, ratio of safety-critical commands, and source IP entropy over time. An alert is generated if a time window's activity is scored as a significant anomaly, indicating a behavioral shift that could represent reconnaissance, manipulation, or an attack.
    answer_sources:
      - Zeek s7comm.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek dnp3.log
      - Zeek bacnet.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - SIS network segments (Level 0/1)
      - Engineering Workstation (EWS) network segment (Level 2/3)
      - Process Control Network (PCN) segments where EWS communicate with SIS devices
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          TRAIN anomaly_detection_model on 90-day history of SIS traffic features (command_count, command_types, safety_cmd_ratio, src_ip_entropy) per 5-min window
          SCORE each new 5-minute window in production
          ALERT if anomaly_score > 99th_percentile_of_training_scores
  - question: Has a critical alarm parameter been modified by an unauthorized source or changed to an unsafe value?
    context: >-
      An adversary can create unsafe conditions by altering alarm parameters, such as trip points or deadbands, effectively blinding operators to hazardous situations. This question focuses on detecting unauthorized or unsafe modifications to a predefined list of critical alarm tags. It generates a high-severity alert if a change is made by an unauthorized user or from an unapproved IP address. It triggers a critical alert if any modification, regardless of source, moves a parameter outside its defined safe operating range.
    answer_sources:
      - Zeek opc-ua.log
      - Zeek modbus.log
      - Zeek s7comm.log
      - Zeek dnp3.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - HMI application audit logs
      - HMI network segment (Level 2)
      - EWS network segment (Level 2/3)
      - Process Control Network (PCN) segments (Level 1/2)
      - Data Historian servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          SEARCH (industrial_protocol_logs OR hmi_audit_logs) for write_commands
          WHERE target_tag IN critical_alarm_list
          ALERT if (source_ip OR user) NOT IN authorized_list
          ALERT if new_value NOT IN defined_safe_range for target_tag
  - question: Is there an unusually high rate of alarm management actions from a specific HMI or user?
    context: >-
      A sudden flood of alarm modifications (setpoint changes, inhibitions, acknowledgements) from a single user or HMI can indicate a malicious attempt to suppress alarms or disrupt operator awareness. This question establishes a baseline for the normal hourly rate of such actions for each user and HMI. An alert is triggered if the current rate exceeds a statistical threshold (e.g., mean plus three standard deviations), with severity increasing if multiple distinct critical alarms are altered in a short time frame by the same actor.
    answer_sources:
      - Zeek opc-ua.log
      - Zeek modbus.log
      - Zeek s7comm.log
      - Zeek dnp3.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - HMI application audit logs
      - HMI network segment (Level 2)
      - EWS network segment (Level 2/3)
      - Process Control Network (PCN) segments (Level 1/2)
      - Data Historian servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          DEFINE baseline for each user/HMI over 30 days for hourly_alarm_modification_rate
          CALCULATE mean(μ) and std_dev(σ)
          SEARCH for new alarm_modification events
          ALERT if current_hourly_rate > (μ + 3σ)
  - question: Does a real-time machine learning model classify a recent alarm modification as potentially malicious or unsafe?
    context: >-
      To move beyond simple thresholds, this question leverages a supervised machine learning model trained on historical data to distinguish between benign and malicious alarm modifications. By engineering features such as the source, the tag being modified, the time of day, and proximity to maintenance windows, the model can identify complex patterns indicative of an attack. This provides a higher-confidence alert when a new modification is classified as 'malicious/unsafe', giving analysts contextual data (like feature importance) to speed up investigation.
    answer_sources:
      - Zeek opc-ua.log
      - Zeek modbus.log
      - Zeek s7comm.log
      - Zeek dnp3.log
      - Windows Event ID 4624
      - Windows Event ID 4688
      - HMI application audit logs
      - HMI network segment (Level 2)
      - EWS network segment (Level 2/3)
      - Process Control Network (PCN) segments (Level 1/2)
      - Data Historian servers
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          TRAIN classification_model on labeled dataset of 'benign' and 'malicious' alarm modifications
          INPUT features of new_alarm_modification_event into model
          ALERT if classification == 'malicious/unsafe'
  - question: Has a critical protective device stopped sending its expected periodic network traffic?
    context: >-
      Critical protective devices like safety PLCs or relays often communicate with a consistent heartbeat or polling interval. A sudden cessation of this traffic could mean the device has failed, been taken offline, or is being subjected to a denial-of-service attack. This question involves monitoring network logs for expected traffic from a watchlist of critical device IPs. If a device fails to communicate for a period exceeding a set tolerance (e.g., twice its normal interval), a critical alert is generated.
    answer_sources:
      - Zeek conn.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Zeek s7comm.log
      - ICMP logs
      - Level 0/1 field device network segments
      - Level 2 SCADA/DCS network segments
      - Substation network segments
      - Process Control Network (PCN) segments
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          FOR each device in critical_device_watchlist
          QUERY network_logs for traffic from device.ip in last [2 * device.heartbeat_interval]
          ALERT if log_count == 0
  - question: Has the communication volume or frequency from a critical protective device dropped below its established minimum threshold?
    context: >-
      Even if a device hasn't gone completely silent, a significant drop in its communication volume (bytes transmitted) or frequency (connections established) can indicate a problem. This could be a sign of a device malfunction, network degradation, or a more subtle manipulation. This question establishes a baseline of normal communication patterns and alerts if traffic drops below a minimum threshold (e.g., the 5th percentile) for a sustained period, pointing to a potential health or security issue.
    answer_sources:
      - Zeek conn.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Zeek s7comm.log
      - ICMP logs
      - Level 0/1 field device network segments
      - Level 2 SCADA/DCS network segments
      - Substation network segments
      - Process Control Network (PCN) segments
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          DEFINE baseline for each critical_device over 30 days for bytes_per_minute and connections_per_minute
          CALCULATE 5th_percentile threshold for both metrics
          MONITOR metrics in 1-minute intervals
          ALERT if (bytes < threshold_bytes OR connections < threshold_connections) for 3 consecutive intervals
  - question: Does the recent communication pattern of a critical device show an anomalous disruption when compared to its time-series forecast?
    context: >-
      To detect subtle communication anomalies that static thresholds might miss, this question employs time-series forecasting. A model (like SARIMA or Prophet) is trained on the historical connection patterns of a critical device, learning its daily and weekly cycles. In production, the model forecasts the expected communication volume for the near future. If the actual observed traffic falls significantly below the forecasted range (i.e., below the lower bound of a 95% confidence interval) for a sustained period, it triggers a high-severity alert for an anomalous disruption.
    answer_sources:
      - Zeek conn.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Zeek s7comm.log
      - ICMP logs
      - Level 0/1 field device network segments
      - Level 2 SCADA/DCS network segments
      - Substation network segments
      - Process Control Network (PCN) segments
    range: last 90 days
    queries:
      - search_technology: Pseudocode
        query: |
          TRAIN time-series_model on 90+ days of connection_counts_per_minute for a critical device
          FORECAST expected_connection_count and confidence_interval for the next 5 minutes
          ALERT if actual_connection_count < lower_bound_of_confidence_interval for 2+ consecutive intervals