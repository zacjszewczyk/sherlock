name: "T0813: Denial of Control"
id: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
description: |
  This playbook helps answer the question: "Is an adversary attempting to impact our industrial process by denying operator control?". It focuses on detecting three main indicators of T0813, Denial of Control. The first is a network-based denial of service attack against critical ICS devices like PLCs or RTUs, identified by a sudden, sustained increase in network traffic or connection rates, particularly with connection states indicative of resource exhaustion. The second indicator is the observation of high-risk ICS control commands (e.g., Modbus 'Write', S7Comm 'Stop CPU') that are anomalous due to their origin, timing, or sequence. The third indicator is the crash or hanging of HMI or SCADA client software on operator workstations, especially when temporally correlated with preceding anomalous network activity directed at the workstation.
type: "technique"
related:
  - "TA0105: Impact"
contributors:
  - "Zachary Szewczyk"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Has an un-whitelisted external IP initiated an excessive number of failed or rejected connections to a critical ICS asset on a known ICS protocol port?"
    context: "This question aims to detect a potential flood-based denial-of-service attack from an untrusted source. A high rate of connections with states like 'S0' (connection attempt seen, no reply), 'REJ' (connection rejected), or 'RSTO' (connection reset by originator) to critical assets (PLCs, RTUs) can indicate an attempt to exhaust the device's connection table or processing capacity, thereby denying legitimate control and monitoring traffic."
    answer_sources:
      - "Zeek conn.log"
      - "Network boundary points of Level 1 (Control) and Level 2 (Supervisory) ICS network segments, including firewalls and network taps monitoring traffic to PLCs, RTUs, HMIs, and SCADA servers."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH Zeek conn.log WHERE (conn_state is 'S0' or 'REJ' or 'RSTO') AND destination_ip in Critical_ICS_Assets AND destination_port in [502, 20000, 102, 44818] AND source_ip NOT in External_Comms_Whitelist | GROUP BY source_ip, destination_ip | COUNT connections over 60s | WHERE connection_count > 100"
  - question: "Is a critical ICS asset experiencing a significant, anomalous spike in network traffic volume or connection count, coupled with a sharp decrease in the diversity of source IPs?"
    context: "This question seeks to identify denial-of-service attacks by baselining normal traffic patterns. A legitimate operational issue might cause a traffic spike, but a malicious attack often originates from a single or small number of sources. Therefore, a concurrent drop in source IP entropy (less randomness/diversity) alongside a surge in traffic is a strong indicator of a targeted flood attack."
    answer_sources:
      - "Zeek conn.log"
      - "Network boundary points of Level 1 (Control) and Level 2 (Supervisory) ICS network segments, including firewalls and network taps monitoring traffic to PLCs, RTUs, HMIs, and SCADA servers."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH Zeek conn.log FOR each critical_asset | CALCULATE 5-min rolling average of connection_count, sum(orig_bytes), and entropy(source_ip) | COMPARE to 30-day baseline | ALERT if (connection_count > 5 * 99th_percentile OR sum(orig_bytes) > 5 * 99th_percentile) AND entropy(source_ip) < 10th_percentile for 2+ consecutive intervals"
  - question: "Has a time-series anomaly detection model identified a significant deviation from normal network traffic patterns directed at a critical ICS asset?"
    context: "This question leverages machine learning to detect subtle or complex anomalies that rule-based systems might miss. A model trained on various features of normal network traffic (e.g., byte counts, connection rates, source diversity, connection state ratios) can learn the intricate 'rhythm' of operations. An alert based on high reconstruction error means the current traffic is so different from anything seen during training that the model cannot accurately 'rebuild' it, signaling a potential novel attack."
    answer_sources:
      - "Zeek conn.log"
      - "Network boundary points of Level 1 (Control) and Level 2 (Supervisory) ICS network segments, including firewalls and network taps monitoring traffic to PLCs, RTUs, HMIs, and SCADA servers."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "MONITOR reconstruction_error from time-series anomaly model for each critical_asset | ALERT if reconstruction_error > (mean_error + 3 * stddev_error) for 3+ consecutive minutes"
  - question: "Has a high-risk ICS command been issued from an unauthorized user, workstation, or software process?"
    context: "This question focuses on detecting unauthorized control actions by validating the full context of a command. Simply seeing a 'Stop CPU' command isn't enough; it's crucial to know who issued it, from where, and what application they used. By correlating network ICS protocol logs with endpoint authentication and process logs, we can verify if the action aligns with a pre-approved list of authorized operations, filtering out potentially malicious commands."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek modbus.log"
      - "Zeek s7comm.log"
      - "Zeek dnp3.log"
      - "Windows Event ID 4624"
      - "Windows Event ID 4688"
      - "Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), SCADA servers, and network taps monitoring Level 2 (Supervisory) to Level 1 (Control) network traffic, as well as Active Directory/Identity Management systems for user authentication."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "SEARCH ICS protocol logs for high-risk commands | GET source_ip, target_ip, command | CORRELATE source_ip with WinEvent 4624 (logon) and 4688 (process creation) to find user and process_name | ALERT if (user, source_ip, process_name, target_ip, command) NOT in Authorized_Operations_Whitelist"
  - question: "Is an authorized user issuing ICS commands in an unusual sequence or at an abnormal time?"
    context: "This question aims to detect credential misuse or insider threats by baselining the behavior of authorized users. An attacker who has compromised a legitimate account may not understand the proper operational workflow. This can manifest as issuing commands in a rare or illogical order (anomalous n-gram) or performing sensitive actions at odd hours (e.g., 3 AM on a Sunday). This behavioral analysis adds a layer of defense beyond simple access control."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek modbus.log"
      - "Zeek s7comm.log"
      - "Zeek dnp3.log"
      - "Windows Event ID 4624"
      - "Windows Event ID 4688"
      - "Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), SCADA servers, and network taps monitoring Level 2 (Supervisory) to Level 1 (Control) network traffic, as well as Active Directory/Identity Management systems for user authentication."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "FOR each authorized user | MONITOR issued command sequences and timestamps | COMPARE to 90-day baseline of command n-grams and time-of-day distributions | ALERT if command_sequence_probability < 1st_percentile OR command_timestamp is > 2 stddev from mean operational hours"
  - question: "Has a user's recent session of interaction with a PLC been identified as a behavioral outlier by a clustering model?"
    context: "This question uses a User and Entity Behavior Analytics (UEBA) approach to find anomalous sessions that don't fit any established pattern of normal activity. By grouping historical sessions into clusters of 'normal' behavior based on features like command frequency, read/write ratios, and command types, any new session that doesn't fit into a cluster is flagged as an outlier (noise). This is effective for detecting novel attack patterns that don't match any specific rule."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek modbus.log"
      - "Zeek s7comm.log"
      - "Zeek dnp3.log"
      - "Windows Event ID 4624"
      - "Windows Event ID 4688"
      - "Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), SCADA servers, and network taps monitoring Level 2 (Supervisory) to Level 1 (Control) network traffic, as well as Active Directory/Identity Management systems for user authentication."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "FOR each new user session (commands within 15 mins) | CREATE feature vector (command_count, read_write_ratio, etc.) | INPUT vector into pre-trained clustering model (e.g., DBSCAN) | ALERT if model classifies session as a noise point/outlier"
  - question: "Did a critical HMI or SCADA application crash immediately following suspicious network activity directed at the host workstation?"
    context: "This question attempts to link a denial of control effect (an operator's HMI crashing) to a potential cause. An application crash on its own could be a software bug, but if it's preceded by network indicators of compromise—such as communication with a known malicious IP, the transfer of an executable file, or unauthorized remote access attempts—it strongly suggests the crash was maliciously induced as part of an attack."
    answer_sources:
      - "Windows Event ID 1000"
      - "Windows Event ID 1002"
      - "Zeek conn.log"
      - "Zeek files.log"
      - "Zeek dce_rpc.log"
      - "Zeek rdp.log"
      - "Operator workstations (Level 2), Human-Machine Interfaces (HMIs), Engineering Workstations (EWS), and network taps monitoring traffic to and from these critical endpoints within the ICS network."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "ON trigger of WinEvent 1000/1002 for critical_app | SEARCH network logs for affected_host in the last 5 mins | ALERT if (source_ip in threat_intel_list) OR (executable file transfer seen in files.log) OR (unauthorized RPC/RDP activity seen)"
  - question: "Following an HMI software crash, was there an anomalous spike in the rate or payload entropy of network connections to the affected workstation?"
    context: "This question looks for evidence of exploit delivery or a localized denial-of-service attack against the HMI application. A high rate of connections could be an attempt to exhaust application resources, while high payload entropy (randomness) can be indicative of encrypted or obfuscated shellcode used in an exploit. Comparing this activity to a historical baseline for that specific source-destination pair helps distinguish a targeted attack from normal network chatter."
    answer_sources:
      - "Windows Event ID 1000"
      - "Windows Event ID 1002"
      - "Zeek conn.log"
      - "Zeek files.log"
      - "Zeek dce_rpc.log"
      - "Zeek rdp.log"
      - "Operator workstations (Level 2), Human-Machine Interfaces (HMIs), Engineering Workstations (EWS), and network taps monitoring traffic to and from these critical endpoints within the ICS network."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "ON trigger of WinEvent 1000/1002 for critical_app | ANALYZE network traffic to host in last 5 mins | FOR each source_ip, calculate payload_entropy and connection_rate | COMPARE to 30-day baseline for that source-destination pair | ALERT if payload_entropy > 99th_percentile OR connection_rate > 99th_percentile"
  - question: "Has a machine learning model predicted a high probability of an imminent HMI application crash based on current network traffic patterns?"
    context: "This question represents a proactive, predictive approach to preventing denial of control. By training a model on historical data of traffic patterns that led to crashes versus those that did not, the system can learn to recognize the precursors to an application failure. Alerting when the model predicts a high crash probability allows analysts to investigate and potentially intervene before the operator loses control, rather than reacting after the fact."
    answer_sources:
      - "Windows Event ID 1000"
      - "Windows Event ID 1002"
      - "Zeek conn.log"
      - "Zeek files.log"
      - "Zeek dce_rpc.log"
      - "Zeek rdp.log"
      - "Operator workstations (Level 2), Human-Machine Interfaces (HMIs), Engineering Workstations (EWS), and network taps monitoring traffic to and from these critical endpoints within the ICS network."
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: "CONTINUOUSLY score 60-second windows of network traffic to HMIs using a pre-trained classification model | ALERT if predicted_crash_probability > 0.90"