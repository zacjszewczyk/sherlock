name: T0816: Device Restart-Shutdown
id: 6f1c4a0a-8b1e-4f5a-9a0c-1d2e3f4a5b6c
description: This playbook focuses on detecting the "Device Restart-Shutdown" technique (T0816), which can be used to inhibit response functions or cause impact and physical damage in an Industrial Control System (ICS) environment. It provides investigative steps to determine if a critical ICS device has been restarted or shut down maliciously. The playbook covers three main evidence types: 1) Analyzing Windows Event Logs on critical assets to find shutdowns that are unexpected, occur outside maintenance windows, or are initiated by non-whitelisted processes. 2) Monitoring network traffic for specific ICS protocol commands that explicitly instruct a device to restart. 3) Detecting a sustained cessation of periodic communications from a critical controller, which implies it has gone offline. The goal is to distinguish between benign, operational restarts and malicious activity.
type: technique
related:
  - TA0107: Inhibit Response Function
  - TA0105: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
investigative_questions:
  - question: Has a critical ICS asset experienced a shutdown based on specific event IDs and contextual rules?
    context: This question seeks to identify potentially malicious shutdown events by using rule-based logic. It alerts on any unexpected shutdown (Event ID 6008) on a critical asset. For user-initiated (1074) or clean (6006) shutdowns, it checks if the event occurred outside a scheduled maintenance window and was initiated by a process not on an approved whitelist. This helps filter out routine administrative actions and focuses on anomalous events that require further investigation, which includes correlating with logon and network data to verify the legitimacy of the source.
    answer_sources:
      - Windows Event ID 1074
      - Windows Event ID 6006
      - Windows Event ID 6008
      - Windows Event ID 4624
      - Windows Event ID 4634
      - Windows Event ID 4688
      - Zeek conn.log
      - Human-Machine Interfaces (HMIs), Engineering Workstations (EWS), Operator Stations, SCADA Servers, and Data Historians within the Process Control Network (PCN) and OT DMZ.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH for (EventID 6008 on critical_ics_asset)
          OR (EventID IN [1074, 6006] on critical_ics_asset AND is_outside_maintenance_window AND initiating_process NOT IN whitelist)
          CORRELATE with logon events (4624) and network logs (Zeek conn.log) to verify source user and host legitimacy.
  - question: Has the frequency of shutdown events or the type of shutdown reason on a critical ICS asset deviated from its established baseline?
    context: This question uses statistical analysis to detect anomalies. It establishes a 90-day baseline for the hourly count of shutdown-related events (1074, 6006) during normal, non-maintenance periods. An alert is triggered if the current count exceeds the 99th percentile of this baseline, indicating a statistically significant increase in shutdown activity. Additionally, it baselines the 'ShutdownReason' codes from Event ID 1074 to detect the use of rare or previously unseen shutdown causes, which could indicate a non-standard or malicious action.
    answer_sources:
      - Windows Event ID 1074
      - Windows Event ID 6006
      - Windows Event ID 6008
      - Windows Event ID 4624
      - Windows Event ID 4634
      - Windows Event ID 4688
      - Zeek conn.log
      - Human-Machine Interfaces (HMIs), Engineering Workstations (EWS), Operator Stations, SCADA Servers, and Data Historians within the Process Control Network (PCN) and OT DMZ.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          BASELINE hourly count of events 1074, 6006 over 90 days (non-maintenance).
          ALERT if current hourly count > 99th percentile of baseline.
          BASELINE frequency of 'ShutdownReason' codes from event 1074.
          ALERT if a new or statistically rare reason code is observed.
  - question: Can a machine learning model classify a new shutdown event on a critical ICS asset as malicious?
    context: This question applies supervised machine learning to classify shutdown events in real-time. A model (e.g., Random Forest) is trained on historical logs that have been labeled as 'benign' or 'malicious'. The model uses features like the event ID, time of day, initiating process, and user context to make its prediction. By deploying this model, security teams can automatically flag new shutdown events that are predicted to be malicious with a high degree of confidence, enabling a faster and more proactive response.
    answer_sources:
      - Windows Event ID 1074
      - Windows Event ID 6006
      - Windows Event ID 6008
      - Windows Event ID 4624
      - Windows Event ID 4634
      - Windows Event ID 4688
      - Zeek conn.log
      - Human-Machine Interfaces (HMIs), Engineering Workstations (EWS), Operator Stations, SCADA Servers, and Data Historians within the Process Control Network (PCN) and OT DMZ.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN classification model on labeled historical shutdown events.
          FEATURES = [EventID, time_of_day, day_of_week, is_maintenance_window, process_name, user_context].
          DEPLOY model for real-time classification.
          ALERT if classification is 'malicious' with confidence > 0.9.
  - question: Has a specific ICS protocol command to restart a device been observed on the network?
    context: This question focuses on direct, unambiguous commands sent over ICS protocols to restart a device. It involves creating immediate alerts when specific function codes or commands (e.g., DNP3 'COLD_RESTART', Modbus function 8 sub-function 1) are detected in network traffic logs. Any such alert should be enriched with asset inventory data to confirm the device's criticality and the source IP should be checked against a whitelist of authorized workstations to quickly determine if the command is from a legitimate source.
    answer_sources:
      - Zeek conn.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek opcua.log
      - Network taps or SPAN ports monitoring traffic between Purdue Levels 0, 1, and 2.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          SEARCH for ICS restart commands (e.g., DNP3 'COLD_RESTART', Modbus func 8/sub 1).
          ON-ALERT: Enrich with asset data.
          VERIFY if source IP is in authorized list.
          ESCALATE if source is unauthorized.
  - question: Has the frequency of restart commands or the diversity of source IPs targeting a critical device deviated from the norm?
    context: This question uses statistical methods to find anomalies in restart command patterns. First, it establishes a 30-day baseline for the daily count of legitimate restart commands from authorized sources. An alert is triggered if the daily count exceeds the 99th percentile, suggesting excessive restart activity. Second, it calculates the Shannon entropy of source IPs communicating with a device. A sudden drop in entropy suggests that traffic is becoming less diverse and more concentrated from a few sources, which can be a sign of an attack.
    answer_sources:
      - Zeek conn.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek opcua.log
      - Network taps or SPAN ports monitoring traffic between Purdue Levels 0, 1, and 2.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          BASELINE daily count of restart commands from authorized sources over 30 days.
          ALERT if daily count > 99th percentile.
          CALCULATE Shannon entropy of source IPs in 1-hour windows.
          ALERT if entropy drops below 5th percentile of its baseline.
  - question: Can an unsupervised machine learning model detect an anomalous ICS protocol command?
    context: This question leverages unsupervised machine learning to find novel or unusual ICS commands without prior labeling. An anomaly detection model (e.g., Isolation Forest) is trained on a baseline of normal ICS protocol traffic. The model learns the normal patterns of communication based on features like protocol, function code, source/destination IPs, and timing. When a new command is observed, the model scores it for anomalousness. A high score indicates a significant deviation from normal behavior, triggering an alert for investigation.
    answer_sources:
      - Zeek conn.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek opcua.log
      - Network taps or SPAN ports monitoring traffic between Purdue Levels 0, 1, and 2.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN unsupervised anomaly model (e.g., Isolation Forest) on 30+ days of normal ICS traffic logs.
          FEATURES = [protocol, function_code, src_ip, dst_ip, time_delta].
          SCORE new commands in real-time.
          ALERT on commands with a high anomaly score.
  - question: Has a critical controller stopped communicating for a period longer than a pre-defined static threshold?
    context: This question aims to detect if a device has gone offline using a simple, stateful rule. For each critical controller, a rule tracks the timestamp of its last received communication. A static timeout threshold is defined based on its known polling cycle (e.g., three times the normal interval). If no communication is seen from the device within this timeout period and it's not a scheduled maintenance window, an alert is generated, suggesting the device may have been shut down or has faulted.
    answer_sources:
      - Zeek conn.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek opcua.log
      - Core switches in the Process Control Network (PCN) and aggregation switches at Purdue Levels 1 and 2.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each critical controller:
          TRACK timestamp of last received packet.
          DEFINE timeout_threshold = 3 * polling_interval.
          IF (time_since_last_packet > timeout_threshold) AND (is_not_maintenance_window):
            GENERATE 'Potential Device Offline' alert.
            CORRELATE with TCP RST flags in Zeek conn.log.
  - question: Has the time between communications from a critical controller become statistically significant?
    context: This question uses a more dynamic, statistical approach to detect communication loss. It analyzes the distribution of inter-packet arrival times for each critical controller over a 30-day baseline period. This creates a statistical profile of the device's normal communication timing. An alert is triggered if the current time since the last packet from the device exceeds the 99.9th percentile of this baseline, indicating a communication gap that is statistically rare and highly anomalous for that specific device.
    answer_sources:
      - Zeek conn.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek opcua.log
      - Core switches in the Process Control Network (PCN) and aggregation switches at Purdue Levels 1 and 2.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each critical controller:
          CALCULATE distribution of inter-packet arrival times over 30-day baseline.
          ALERT if time_since_last_packet > 99.9th percentile of baseline distribution.
  - question: Has a time-series model predicted a significant drop in a controller's communication volume?
    context: This question uses predictive analytics to identify abnormal communication patterns. A time-series forecasting model (e.g., ARIMA) is trained on the packet count per minute for each critical controller, allowing it to learn the device's normal communication "rhythm." In real-time, the model predicts the expected packet count. If the actual observed count falls below the model's 99% confidence interval for several consecutive minutes, it triggers an alert, indicating a statistically improbable drop in traffic that likely signifies a device shutdown or fault.
    answer_sources:
      - Zeek conn.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Zeek enip.log
      - Zeek opcua.log
      - Core switches in the Process Control Network (PCN) and aggregation switches at Purdue Levels 1 and 2.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          FOR each critical controller:
          TRAIN time-series model (e.g., ARIMA) on packet_count per minute.
          PREDICT expected packet count in real-time.
          IF observed_count < 99% confidence interval for 3+ consecutive minutes:
            GENERATE 'Anomalous Communication Drop' alert.
  - question: Is a critical ICS device being targeted by a potential denial-of-service attack?
    context: This question seeks to identify network-based attacks intended to disrupt a device's service, such as a SYN flood or packet storm. It uses rule-based alerting to detect high volumes of specific traffic types from a single source within a short time window. For example, it alerts on more than 1,000 failed connection attempts ('S0' state), a high rate of ICMP packets, or a high rate of small UDP packets, all of which are common indicators of a flood attack aimed at overwhelming a device.
    answer_sources:
      - Zeek conn.log
      - Zeek tcp.log
      - Zeek udp.log
      - Zeek icmp.log
      - HMI Alarm Logs
      - Historian Process Data
      - ICS Control and Supervisory Networks (Purdue Model Levels 1, 2, 3), and network boundaries.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          ALERT if single_source_ip generates > 1000 'S0' connections to critical_device in 1 minute.
          ALERT if single_source_ip sends > 500 ICMP packets/sec to critical_device.
          ALERT if single_source_ip sends > 1000 small UDP packets/sec to critical_device.
  - question: Have network performance metrics for a critical ICS device deviated significantly from their baseline?
    context: This question uses statistical baselining of network performance to detect service degradation. For each critical device, a 30-day baseline is established for key metrics like average round-trip time (RTT), connection rate, and the ratio of failed to successful connections. An alert is triggered if any metric deviates by more than three standard deviations from its norm. Additionally, it monitors the entropy of source IPs, alerting on a sharp drop, which indicates a shift from diverse, normal traffic to a concentrated, potentially malicious source.
    answer_sources:
      - Zeek conn.log
      - Zeek tcp.log
      - Zeek udp.log
      - Zeek icmp.log
      - HMI Alarm Logs
      - Historian Process Data
      - ICS Control and Supervisory Networks (Purdue Model Levels 1, 2, 3), and network boundaries.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          BASELINE RTT, connection rate, and failed connection ratio over 30 days for each critical device.
          ALERT if any metric exceeds 3 standard deviations from baseline in a 5-minute window.
          BASELINE Shannon entropy of source IPs.
          ALERT if entropy drops > 50% from its 24-hour average.
  - question: Can a machine learning model detect anomalous network traffic patterns directed at a critical ICS device?
    context: This question applies a time-series anomaly detection model, like an LSTM autoencoder, to learn the normal "heartbeat" of a device's network traffic. The model is trained on historical network flow metrics (e.g., bytes, packets, connection states) from Zeek logs. It learns to reconstruct normal traffic patterns. In real-time, if the model cannot accurately reconstruct the live traffic (i.e., the reconstruction error is high), it indicates a significant deviation from the learned norm, triggering an alert for a potential network-based attack or disruption.
    answer_sources:
      - Zeek conn.log
      - Zeek tcp.log
      - Zeek udp.log
      - Zeek icmp.log
      - HMI Alarm Logs
      - Historian Process Data
      - ICS Control and Supervisory Networks (Purdue Model Levels 1, 2, 3), and network boundaries.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN LSTM autoencoder on historical network flow metrics per critical device.
          FEATURES = [orig_bytes, resp_bytes, orig_pkts, resp_pkts, conn_state_counts].
          IN REAL-TIME, calculate reconstruction error for live traffic.
          ALERT if reconstruction_error > 99th percentile of validation set errors.
  - question: Has a shutdown event occurred on a critical ICS asset initiated by an unauthorized user or a suspicious process?
    context: This question focuses on identifying unauthorized shutdown events that could lead to physical damage. It uses a high-severity rule that cross-references shutdown events (Event ID 1074) with watchlists of critical hosts and authorized administrator accounts. An alert is generated if a shutdown is initiated on a critical host by a user not on the authorized list, or by a suspicious process (e.g., powershell.exe, wmic.exe). It also alerts on unexpected shutdowns (Event ID 6008) that were not preceded by an authorized shutdown command.
    answer_sources:
      - Windows Event ID 1074
      - Windows Event ID 6008
      - Windows Event ID 4624
      - Windows Event ID 4648
      - Windows Event ID 4672
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek rdp.log
      - Zeek smb.log
      - HMIs, Process Historians, SCADA Servers, EWS, Domain Controllers within the ICS environment.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          ALERT if (EventID 1074 on critical_host) AND (User NOT IN admin_list OR Process IN suspicious_list).
          ALERT if (EventID 6008 on critical_host) AND (no authorized 1074 event in previous 5 mins).
  - question: Is there a statistical anomaly in shutdown event frequency or remote access patterns preceding a shutdown?
    context: This question uses statistical analysis to correlate shutdown events with potentially related remote access activity. It establishes a 30-day baseline for the frequency of shutdown events (1074, 6008) outside of maintenance windows, alerting on any 24-hour count that exceeds the 99th percentile. Critically, it also baselines the hourly number of unique source IPs connecting via RDP to critical assets. An alert is triggered if a shutdown event is preceded by an anomalous spike in unique RDP sources, suggesting an attacker may have gained remote access before issuing the shutdown command.
    answer_sources:
      - Windows Event ID 1074
      - Windows Event ID 6008
      - Windows Event ID 4624
      - Windows Event ID 4648
      - Windows Event ID 4672
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek rdp.log
      - Zeek smb.log
      - HMIs, Process Historians, SCADA Servers, EWS, Domain Controllers within the ICS environment.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          BASELINE 24-hour count of events 1074 and 6008 (non-maintenance).
          ALERT if count > 99th percentile.
          BASELINE hourly unique RDP source IPs to critical assets.
          ALERT if shutdown is preceded within 60 mins by RDP source count > 95th percentile.
  - question: Can machine learning models classify a shutdown event as malicious or identify novel pre-shutdown activity clusters?
    context: This question employs a two-pronged machine learning approach. First, a supervised classification model (e.g., Random Forest) is trained to predict if a user-initiated shutdown (Event ID 1074) is malicious based on features like time, user, process, and network context. Second, an unsupervised clustering algorithm (e.g., DBSCAN) is used to group pre-shutdown activities (source IP, user, processes created). This can identify entirely new patterns of activity that don't match known benign administrative behavior, flagging them as suspicious clusters for investigation.
    answer_sources:
      - Windows Event ID 1074
      - Windows Event ID 6008
      - Windows Event ID 4624
      - Windows Event ID 4648
      - Windows Event ID 4672
      - Windows Event ID 4688
      - Zeek conn.log
      - Zeek rdp.log
      - Zeek smb.log
      - HMIs, Process Historians, SCADA Servers, EWS, Domain Controllers within the ICS environment.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: |
          TRAIN classification model to predict 'malicious' for event 1074. ALERT on high-confidence 'malicious' prediction.
          USE clustering (DBSCAN) on pre-shutdown activity features (source_ip, user, processes).
          ALERT on activity clusters that do not match known 'benign' patterns.