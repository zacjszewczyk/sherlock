name: T0887: Wireless Sniffing
id: c8a9b7d6-e5f4-4a3b-9c8d-7f6e5d4c3b2a
description: This playbook helps analysts investigate potential wireless sniffing activity against Industrial Control Systems (ICS). It focuses on two primary adversary goals: collecting wireless communications for subsequent replay attacks, and discovering wireless protocols and frequencies for future exploitation. The playbook provides questions and queries to detect signatures of replayed commands (e.g., illogical timing, redundant commands), identify unauthorized or spoofed wireless devices by analyzing MAC addresses and signal strength, detect reconnaissance patterns like frequency hopping and network scanning, and use machine learning models to spot anomalous command sequences and RF signal behavior.
type: technique
related:
  - TA0100: Collection
  - TA0102: Discovery
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
investigative_questions:
  - question: Are there wireless ICS commands (Modbus/DNP3) that exhibit signs of being replayed, such as occurring outside of normal hours, being redundant, or lacking associated operator activity?
    context: This question aims to detect replay attacks where an adversary captures legitimate commands and re-transmits them later. Such attacks can manifest as commands executed at unusual times, attempts to change a state that is already set (e.g., opening an already open valve), or commands that are not preceded by a legitimate operator logging in or interacting with an HMI. Identifying these anomalies is crucial for detecting unauthorized control actions.
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek dnp3.log, Zeek modbus.log, Windows Event ID 4624, Windows Event ID 4688, Sysmon Event ID 1, Sysmon Event ID 3, Syslog from field devices (PLCs, RTUs), ICS Historian Database Logs (e.g., OSIsoft PI), HMI Application Event Logs"
      - "NAI: Network segments connecting wireless gateways to the ICS network, Wireless Access Points/Gateways, Human-Machine Interfaces (HMIs), Engineering Workstations (EWS), Data Historian servers, and PLC/RTU network interfaces."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH wireless_protocol_logs (Modbus OR DNP3) WHERE (command_time NOT IN operational_hours) OR (command_value == historian.last_value) OR (NOT correlated with HMI_process_creation OR user_login within 2 minutes prior)
  - question: Have any critical PLCs or RTUs received a sequence of commands that is statistically improbable based on historical operational patterns?
    context: Legitimate ICS operations often follow predictable sequences (e.g., 'start pump' is followed by 'confirm flow rate'). A replay attack may inject commands out of their logical order. This question uses a Markov chain model to baseline normal command transitions. An alert on a low-probability sequence suggests a potential manipulation or replay of captured traffic that does not respect the system's operational logic.
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek dnp3.log, Zeek modbus.log, Windows Event ID 4624, Windows Event ID 4688, Sysmon Event ID 1, Sysmon Event ID 3, Syslog from field devices (PLCs, RTUs), ICS Historian Database Logs (e.g., OSIsoft PI), HMI Application Event Logs"
      - "NAI: Network segments connecting wireless gateways to the ICS network, Wireless Access Points/Gateways, Human-Machine Interfaces (HMIs), Engineering Workstations (EWS), Data Historian servers, and PLC/RTU network interfaces."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: BUILD Markov model of command sequences from historical logs. FOR each new command sequence, CALCULATE transition probability. ALERT if probability < 1%
  - question: Has an AI model detected an anomalous sequence of ICS commands that deviates from learned legitimate behavior?
    context: This question leverages an LSTM autoencoder, a type of neural network, to learn the complex temporal patterns of normal ICS command sequences. When the model encounters a sequence it cannot accurately reconstruct (i.e., high reconstruction error), it indicates a significant deviation from the norm. This is a powerful method for detecting novel or sophisticated replay attacks that might evade simpler rule-based checks.
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek dnp3.log, Zeek modbus.log, Windows Event ID 4624, Windows Event ID 4688, Sysmon Event ID 1, Sysmon Event ID 3, Syslog from field devices (PLCs, RTUs), ICS Historian Database Logs (e.g., OSIsoft PI), HMI Application Event Logs"
      - "NAI: Network segments connecting wireless gateways to the ICS network, Wireless Access Points/Gateways, Human-Machine Interfaces (HMIs), Engineering Workstations (EWS), Data Historian servers, and PLC/RTU network interfaces."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: TRAIN LSTM autoencoder on historical command vectors. FOR each new 5-minute window of commands, CALCULATE reconstruction_error. ALERT if reconstruction_error > 99th_percentile_threshold
  - question: Are there any unauthorized devices (i.e., MAC addresses not in the asset inventory) transmitting on the wireless ICS network?
    context: An adversary attempting to sniff or inject traffic into a wireless ICS network will likely use their own equipment. This question focuses on the fundamental security practice of allow-listing. By comparing all observed wireless MAC addresses against a curated inventory of known, authorized devices, analysts can quickly identify any rogue or unauthorized device attempting to communicate on the network.
    answer_sources:
      - "Data Sources: Zeek wifi.log, Wireless IDS/IPS Logs, Spectrum Analyzer Logs, RF Sensor Logs, ICS Asset Inventory Database, Network Access Control (NAC) Logs, Kismet logs (.pcaplog, .netxml)"
      - "NAI: Physical airspace and critical infrastructure corridors surrounding ICS facilities, specifically near wireless field devices, sensors, actuators, and wireless access points/gateways. Includes uncontrolled public areas with line-of-sight to field assets (e.g., parking lots, adjacent properties)."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH wireless_logs FOR source_mac. ALERT if source_mac NOT IN authorized_asset_inventory
  - question: Is any authorized static wireless device transmitting with a signal strength that is statistically inconsistent with its known physical location?
    context: This question aims to detect MAC spoofing. An adversary may impersonate a legitimate device by using its MAC address. However, it is difficult for the adversary to perfectly replicate the physical location and transmission characteristics of the real device. By baselining the normal Received Signal Strength Indicator (RSSI) for a fixed device, a significant deviation (a high Z-score) can indicate that the transmission is coming from a different location, suggesting a spoofing attack.
    answer_sources:
      - "Data Sources: Zeek wifi.log, Wireless IDS/IPS Logs, Spectrum Analyzer Logs, RF Sensor Logs, ICS Asset Inventory Database, Network Access Control (NAC) Logs, Kismet logs (.pcaplog, .netxml)"
      - "NAI: Physical airspace and critical infrastructure corridors surrounding ICS facilities, specifically near wireless field devices, sensors, actuators, and wireless access points/gateways. Includes uncontrolled public areas with line-of-sight to field assets (e.g., parking lots, adjacent properties)."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each static device, CALCULATE rolling baseline of RSSI (mean, stddev). FOR new RSSI values, CALCULATE Z-score. ALERT if absolute(Z-score) > 3.5 for > 60 seconds
  - question: Has a machine learning model detected that an authorized wireless device is behaving in a way that is inconsistent with its normal operational profile?
    context: This question uses K-Means clustering to create behavioral profiles for wireless devices based on multiple features (RSSI, associated SSIDs, channel usage, etc.). A device suddenly shifting from its typical cluster (e.g., 'fixed sensor') to another (e.g., 'mobile tablet') indicates a significant change in its behavior. This could be a sign of device compromise, spoofing, or an adversary using a legitimate but stolen device in an unauthorized manner.
    answer_sources:
      - "Data Sources: Zeek wifi.log, Wireless IDS/IPS Logs, Spectrum Analyzer Logs, RF Sensor Logs, ICS Asset Inventory Database, Network Access Control (NAC) Logs, Kismet logs (.pcaplog, .netxml)"
      - "NAI: Physical airspace and critical infrastructure corridors surrounding ICS facilities, specifically near wireless field devices, sensors, actuators, and wireless access points/gateways. Includes uncontrolled public areas with line-of-sight to field assets (e.g., parking lots, adjacent properties)."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: TRAIN K-Means model on historical device feature vectors to create clusters. FOR each device's current feature vector, ASSIGN to cluster. ALERT if device's cluster assignment changes unexpectedly
  - question: Is there an unknown, persistent RF signal in a protected ICS frequency band exhibiting characteristics of reconnaissance scanning, like rapid frequency hopping or power fluctuations?
    context: Before an adversary can attack a wireless system, they must first discover its operating frequencies. This question looks for the tell-tale signs of a spectrum analyzer or software-defined radio being used for reconnaissance. Characteristics like rapid channel hopping or broad-spectrum sweeps by an unknown signal are strong indicators that an adversary is actively mapping out the RF environment.
    answer_sources:
      - "Data Sources: Spectrum Analyzer Logs, Wireless IDS Logs, RF Sensor Grid Logs, Drone Detection System Logs"
      - "NAI: Physical perimeter, airspace, rooftops, and high-ground locations with line-of-sight to ICS facilities, focusing on control rooms, substations, remote terminal units (RTUs), and field device arrays."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH spectrum_logs FOR signals in protected_bands. ALERT if signal is unknown AND (channel_hops > 5/min OR power_fluctuation > 10dBm) AND duration > 30s
  - question: Has there been a statistically significant increase in the randomness or unpredictability of frequencies being used within protected ICS bands?
    context: Normal wireless operations tend to use a stable set of frequencies. A scanning tool, however, will jump between many different frequencies, increasing the overall randomness (entropy) of the observed spectrum. This question establishes a baseline for normal frequency entropy and alerts when there is a sustained, anomalous increase, which is a strong mathematical indicator of reconnaissance activity.
    answer_sources:
      - "Data Sources: Spectrum Analyzer Logs, Wireless IDS Logs, RF Sensor Grid Logs, Drone Detection System Logs"
      - "NAI: Physical perimeter, airspace, rooftops, and high-ground locations with line-of-sight to ICS facilities, focusing on control rooms, substations, remote terminal units (RTUs), and field device arrays."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: CALCULATE rolling baseline of Shannon entropy for frequencies in protected bands. FOR each 1-minute window, CALCULATE current entropy. ALERT if current_entropy > baseline for 3 consecutive intervals
  - question: Has a machine learning classifier identified a signal in an ICS band as a potential reconnaissance or scanning tool?
    context: This question uses a supervised machine learning model (Random Forest) trained to distinguish between legitimate signals (WiFi, WirelessHART, etc.) and signals from known scanning tools. By classifying unknown signals in real-time, analysts can get a high-confidence alert when a signal's characteristics (power, bandwidth, etc.) strongly match the profile of a scanner, providing a more definitive detection than simple thresholding.
    answer_sources:
      - "Data Sources: Spectrum Analyzer Logs, Wireless IDS Logs, RF Sensor Grid Logs, Drone Detection System Logs"
      - "NAI: Physical perimeter, airspace, rooftops, and high-ground locations with line-of-sight to ICS facilities, focusing on control rooms, substations, remote terminal units (RTUs), and field device arrays."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: TRAIN Random Forest model on labeled RF signal snapshots. DEPLOY model to classify real-time signals. ALERT if signal in ICS_band is classified as 'Unknown_Scanner' with confidence > 0.90
  - question: Is an unknown device on the wireless network generating a high rate of failed connection attempts against an ICS gateway, possibly indicating a network scan?
    context: A common reconnaissance technique is to scan a network to identify live hosts and open ports. This question looks for a classic indicator of such a scan: a single, unknown source generating a large volume of connection attempts that fail or are rejected in a short period. An immediate follow-up with a successful login from the same source is highly suspicious, suggesting the scan was a precursor to a successful intrusion.
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek notice.log, Zeek dnp3.log, Zeek modbus.log, Windows Event ID 4625, Windows Event ID 4624, Windows Event ID 5156, Wireless Gateway Authentication Logs"
      - "NAI: Network interfaces of ICS wireless gateways, associated authentication servers (RADIUS/TACACS+), and Domain Controllers handling ICS-related authentication."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: SEARCH connection_logs for source_ip NOT IN asset_inventory. COUNT connection attempts to ICS_gateway per minute. ALERT if count > 20 AND connection_state is ('S0' OR 'REJ' OR 'RSTOS0'). INCREASE PRIORITY if followed by successful_login from same IP within 10 minutes.
  - question: Is any single device on the wireless network exhibiting a combination of anomalous behaviors, such as connection failures, authentication errors, and protocol violations?
    context: Sophisticated adversaries may try to be stealthy by keeping any single anomalous activity below a simple alert threshold. This question addresses that by calculating a composite risk score. It combines multiple weak indicators (rejected connections, failed logins, protocol errors) into a single, stronger signal. A high risk score indicates that a device is behaving abnormally across several dimensions, making it a high-priority candidate for investigation.
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek notice.log, Zeek dnp3.log, Zeek modbus.log, Windows Event ID 4625, Windows Event ID 4624, Windows Event ID 5156, Wireless Gateway Authentication Logs"
      - "NAI: Network interfaces of ICS wireless gateways, associated authentication servers (RADIUS/TACACS+), and Domain Controllers handling ICS-related authentication."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: FOR each source_ip, CALCULATE Z-scores for rejected_connections, failed_auths, and protocol_notices. CALCULATE weighted risk_score S. ALERT if S > dynamic_threshold
  - question: Has a machine learning model identified a device on the wireless network whose overall traffic profile is highly anomalous compared to all other devices?
    context: This question uses an Isolation Forest model, an unsupervised learning algorithm effective at identifying outliers. It analyzes multiple traffic features for each device (e.g., ports contacted, packet sizes, protocol usage) to learn what 'normal' behavior looks like on the network. The model can then flag any device whose behavior is so different that it is easily 'isolated' from the rest, which is a strong indicator of malicious or unauthorized activity.
    answer_sources:
      - "Data Sources: Zeek conn.log, Zeek notice.log, Zeek dnp3.log, Zeek modbus.log, Windows Event ID 4625, Windows Event ID 4624, Windows Event ID 5156, Wireless Gateway Authentication Logs"
      - "NAI: Network interfaces of ICS wireless gateways, associated authentication servers (RADIUS/TACACS+), and Domain Controllers handling ICS-related authentication."
    range: last 90 days
    queries:
      - technology: Pseudocode
        query: TRAIN Isolation Forest model on historical traffic data per source IP. FOR each new 5-minute aggregation, CALCULATE anomaly_score. ALERT if score is in top 1%