name: T0877: I-O Image
id: a7b1c2d3-e4f5-4a6b-8c9d-0e1f2a3b4c5d
description: "This playbook helps investigate if an adversary is collecting PLC I/O image data to understand or prepare to manipulate the industrial process. This involves looking for unauthorized read requests from non-whitelisted or novel IP addresses, statistically significant increases in read volumes from authorized hosts (suggesting they may be compromised), the use of unusual or non-whitelisted ICS function codes, and correlations between anomalous network read activity and suspicious host-based events (like non-standard process execution) on the source EWS or HMI."
type: technique
related:
  - TA0100: Collection
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags:
  - none
investigative_questions:
  - question: "Is a PLC being read by an IP address not on the authorized whitelist?"
    context: "This is a primary, high-fidelity check. It validates if network traffic adheres to the fundamental security principle of whitelisting, where only explicitly authorized devices (like HMIs, EWS, or Historians) are allowed to communicate with a PLC. An alert here strongly indicates either a misconfiguration or an unauthorized device attempting reconnaissance."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Process Control Network (PCN) segments, specifically network traffic between Level 2 (Supervisory) and Level 1 (Control) zones, captured via SPAN ports or network taps on switches connected to PLCs."
    range: "last 90 days"
    queries:
      - "SIEM Pseudocode: SEARCH ICS protocol logs (S7, Modbus, ENIP) FOR read requests. ALERT IF source_ip NOT IN PLC_whitelist(destination_ip)."
  - question: "Is a PLC being read by a source IP that has never been observed communicating with it before?"
    context: "This question helps detect novel or unexpected communication patterns. By profiling 'normal' communication over a 30-day period, the system can flag any new IP address attempting a read command. This 'first-seen' behavior could indicate a newly compromised device, a new legitimate device that needs to be whitelisted, or an adversary's initial probing."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Process Control Network (PCN) segments, specifically network traffic between Level 2 (Supervisory) and Level 1 (Control) zones, captured via SPAN ports or network taps on switches connected to PLCs."
    range: "last 90 days"
    queries:
      - "SIEM Pseudocode: PROFILE source IPs communicating with each PLC over 30 days. ALERT on new read request if source_ip is not in historical profile for that destination_ip."
  - question: "Has a machine learning model classified a PLC read request as 'unauthorized' with high confidence?"
    context: "This question leverages a supervised machine learning model to move beyond simple rules. By training on historical data with features like IP addresses, protocols, and asset types, the model can learn complex, non-obvious patterns of legitimate traffic. It can then identify and alert on unauthorized read requests that might not violate a simple whitelist or 'first-seen' rule, providing a more sophisticated layer of detection."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Process Control Network (PCN) segments, specifically network traffic between Level 2 (Supervisory) and Level 1 (Control) zones, captured via SPAN ports or network taps on switches connected to PLCs."
    range: "last 90 days"
    queries:
      - "ML Pseudocode: PROCESS new read request features through trained classification model. ALERT if classification is 'unauthorized' AND confidence_score > 0.95."
  - question: "Has the volume of read requests between an authorized source and a PLC exceeded a pre-defined hard threshold?"
    context: "This question helps detect a potential compromise of a legitimate host. An adversary who has gained control of an authorized HMI or EWS might use it to perform bulk data collection. A simple, static threshold (e.g., no more than 500 requests/minute) based on known operational limits can quickly flag this anomalous, high-volume activity."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Network tap points or SPAN ports on managed switches within PCN segments, monitoring traffic flows between Level 3 (Manufacturing Operations Management) devices like HMIs and EWS, and Level 2 (Control Systems) devices like PLCs."
    range: "last 90 days"
    queries:
      - "SIEM Pseudocode: COUNT read requests for each source-destination pair in a 60-second window. ALERT if count > hard_threshold."
  - question: "Is the volume of read requests between an authorized source and a PLC statistically anomalous compared to its historical baseline?"
    context: "This is a more dynamic approach than a hard threshold. It accounts for the fact that 'normal' traffic volume can fluctuate. By establishing a statistical baseline (e.g., average and standard deviation) for each communication pair, this method can detect significant spikes in activity that are unusual for that specific pair and time of day, reducing false positives from generic thresholds."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Network tap points or SPAN ports on managed switches within PCN segments, monitoring traffic flows between Level 3 (Manufacturing Operations Management) devices like HMIs and EWS, and Level 2 (Control Systems) devices like PLCs."
    range: "last 90 days"
    queries:
      - "SIEM Pseudocode: CALCULATE rolling 30-day baseline (average, stddev) for read requests per minute. ALERT if current 1-min count > (average + 3 * stddev)."
  - question: "Has a time-series model detected an anomalous pattern in the frequency of read requests for a high-consequence PLC?"
    context: "This question applies advanced analytics to detect subtle deviations from normal communication rhythms. A time-series model can learn the complex, cyclical patterns of read requests (e.g., higher traffic during shift changes). It can then flag deviations that simple volume or statistical alerts would miss, such as data collection that is deliberately slow and low to evade detection."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Network tap points or SPAN ports on managed switches within PCN segments, monitoring traffic flows between Level 3 (Manufacturing Operations Management) devices like HMIs and EWS, and Level 2 (Control Systems) devices like PLCs."
    range: "last 90 days"
    queries:
      - "ML Pseudocode: INPUT read request frequency data into trained time-series model. ALERT if model's reconstruction_error > dynamic_threshold."
  - question: "Has an authorized device used a non-whitelisted ICS function code to read data from a PLC?"
    context: "This moves beyond analyzing who is communicating to what they are saying. Normal operations typically use a predictable set of ICS protocol function codes. If an authorized device suddenly uses a rare diagnostic or block-read function that is not on its pre-approved list for that PLC, it could indicate an adversary is using the compromised host to probe the device more deeply."
    answer_sources:
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Deep Packet Inspection (DPI) points on network taps or SPAN ports within PCN segments where Level 3 devices (e.g., EWS, HMIs) communicate with Level 2 devices (e.g., PLCs)."
    range: "last 90 days"
    queries:
      - "SIEM Pseudocode: FOR each read request, check function_code. ALERT if function_code NOT IN whitelist(source_ip, destination_ip)."
  - question: "Has the variety of ICS function codes used by a source IP become statistically unusual?"
    context: "This question looks for behavioral changes in communication. An adversary exploring a PLC's capabilities may try many different function codes in a short period. This would cause the Shannon entropy (a measure of randomness or variety) of the function codes used by that source IP to spike. Monitoring for a significant increase in entropy compared to the historical norm can detect this exploratory behavior."
    answer_sources:
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Deep Packet Inspection (DPI) points on network taps or SPAN ports within PCN segments where Level 3 devices (e.g., EWS, HMIs) communicate with Level 2 devices (e.g., PLCs)."
    range: "last 90 days"
    queries:
      - "SIEM Pseudocode: CALCULATE Shannon entropy of function codes per source_ip in a 60-min window. ALERT if entropy > 95th_percentile of historical entropy baseline."
  - question: "Has a machine learning model classified the distribution of function codes used by a source device as an outlier?"
    context: "This question uses unsupervised machine learning to find abnormal command patterns without pre-defined rules. An Isolation Forest model, for example, can be trained on the frequency of different function codes used during normal operation. It can then quickly identify when a new set of commands from a source device is statistically different from anything it has seen before, flagging it as an anomaly."
    answer_sources:
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Deep Packet Inspection (DPI) points on network taps or SPAN ports within PCN segments where Level 3 devices (e.g., EWS, HMIs) communicate with Level 2 devices (e.g., PLCs)."
    range: "last 90 days"
    queries:
      - "ML Pseudocode: INPUT function code frequency distribution into trained Isolation Forest model. ALERT if model scores the input as an outlier."
  - question: "Did a network alert for anomalous PLC reads correlate in time with the execution of a known hacking tool or suspicious command on the source host?"
    context: "This is a critical correlation question that links network and host evidence. An anomalous read from a PLC is suspicious, but if it occurs within minutes of a known hacking tool (like ncat.exe) or a suspicious command being run on the source host, it becomes a high-confidence indicator of compromise. This correlation allows for rapid escalation and response."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Windows Event ID 4688"
      - "Windows Event ID 4624"
      - "Windows Event ID 4663"
      - "Endpoint devices identified as EWS or HMIs within the Level 3 (Manufacturing Operations Management) zone, and network tap points monitoring traffic between these endpoints and Level 2 (Control Systems) PLCs."
    range: "last 90 days"
    queries:
      - "SIEM Correlation Pseudocode: ON network_anomaly(source_ip), QUERY host_logs(source_ip) for +/- 10 mins. IF process_name IN hacking_tool_blacklist, ESCALATE incident."
  - question: "Did a network PLC read anomaly coincide with the execution of a rare or 'first-seen' process on the source host?"
    context: "This question enhances correlation by looking for unknown threats. Instead of relying on a blacklist of known hacking tools, this method baselines all normal process activity on a host. When a network anomaly is detected, it checks the source host for any process executions that are statistically rare or have never been seen before on that machine. This can detect custom malware or living-off-the-land techniques."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Windows Event ID 4688"
      - "Windows Event ID 4624"
      - "Windows Event ID 4663"
      - "Endpoint devices identified as EWS or HMIs within the Level 3 (Manufacturing Operations Management) zone, and network tap points monitoring traffic between these endpoints and Level 2 (Control Systems) PLCs."
    range: "last 90 days"
    queries:
      - "SIEM Correlation Pseudocode: ON network_anomaly(source_ip), ANALYZE host_process_logs(source_ip) for +/- 10 mins. FLAG if process name is 'first-seen' or statistically rare."
  - question: "Has a sequence-based ML model detected a malicious pattern of correlated network and host events?"
    context: "This question represents the most advanced form of correlation, analyzing the entire chain of events rather than isolated incidents. A sequence model (like an LSTM) can be trained to recognize the specific order of network and host activities that constitute an attack path. This allows it to detect a sophisticated attack in progress by identifying a malicious sequence, even if individual events in the sequence appear benign on their own."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek s7comm.log"
      - "Zeek modbus.log"
      - "Zeek enip.log"
      - "Windows Event ID 4688"
      - "Windows Event ID 4624"
      - "Windows Event ID 4663"
      - "Endpoint devices identified as EWS or HMIs within the Level 3 (Manufacturing Operations Management) zone, and network tap points monitoring traffic between these endpoints and Level 2 (Control Systems) PLCs."
    range: "last 90 days"
    queries:
      - "ML Pseudocode: INPUT real-time sequence of network and host events into trained LSTM model. ALERT if model classifies the sequence as malicious."