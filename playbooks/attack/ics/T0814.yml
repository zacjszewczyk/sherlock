name: T0814: Denial of Service
id: f8b4c3d2-1a0e-4b9c-8a7f-9e6d5c4b3a21
description: This playbook investigates Denial of Service (DoS) attacks against Industrial
  Control Systems (ICS). The primary goals of these attacks are to disrupt device
  functionality or impair operator visibility of the industrial process. Indicators
  of such attacks include sustained, anomalous increases in network traffic volume,
  high rates of connection rejections, unexpected crashes or service terminations
  on critical ICS hosts (e.g., HMIs, Historians), and high-volume network floods originating
  from unapproved or non-whitelisted IP addresses. This playbook helps detect these
  activities, which can inhibit an organization's response function or directly impact
  the industrial process.
type: technique
related:
- TA0107: Inhibit Response Function
- TA0105: Impact
contributors:
- Zachary Szewczyk
- Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
- question: Is a high volume of connections to a critical ICS device correlated with
    a burst of protocol-specific errors within the same time frame?
  context: This question aims to detect a common DoS attack pattern where an attacker
    floods a device with connection requests, causing it to generate errors as it
    becomes overwhelmed. Correlating high connection volume with protocol errors
    provides strong evidence of a targeted attack designed to disrupt the device's
    normal operation.
  answer_sources:
  - Zeek conn.log
  - Zeek modbus.log
  - Zeek ether_ip.log
  - Zeek dnp3.log
  - Zeek s7comm.log
  - ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces
    of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'FOR each critical_device_ip: COUNT connections in 1min window. COUNT protocol_errors
      in same 1min window. IF connection_count > 1000 AND error_count > threshold
      THEN ALERT.'
- question: Is a critical ICS device experiencing a sustained traffic anomaly (in
    bytes, packets, or connections) that exceeds its historical baseline, and does
    this anomaly coincide with a drop in source IP address entropy?
  context: This question identifies a DoS flood attack by baselining normal traffic
    and detecting significant deviations. A sustained surge in traffic metrics points
    to an anomaly, while a concurrent drop in source IP entropy (meaning traffic
    is coming from very few sources) strongly suggests a targeted, non-distributed
    flood attack rather than a benign traffic spike.
  answer_sources:
  - Zeek conn.log
  - ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces
    of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'FOR each critical_device_ip: CALCULATE 30-day baseline for bytes, packets,
      connections. IF current_metrics > 99th_percentile for 3 consecutive mins: CALCULATE
      Shannon entropy of source IPs. IF entropy < 1.0 THEN ALERT.'
- question: Has a machine learning model detected a significant deviation from normal
    traffic patterns for a critical ICS asset?
  context: This question leverages a sophisticated, multivariate time-series anomaly
    detection model (like a Variational Autoencoder) to identify complex DoS attacks
    that might not be caught by simple thresholding. The model learns the intricate
    patterns of normal network behavior across multiple features. A high reconstruction
    error indicates the current traffic is unlike anything seen before, flagging it
    as a potential attack.
  answer_sources:
  - Zeek conn.log
  - Zeek modbus.log
  - Zeek ether_ip.log
  - Zeek dnp3.log
  - Zeek s7comm.log
  - ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces
    of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'FOR each critical_device_ip: INPUT 1-min aggregated features (bytes, packets,
      conns, unique_ips, error_rate) into trained VAE model. IF model_reconstruction_error
      > dynamic_threshold THEN ALERT.'
- question: Is a critical ICS device rejecting a high number of connections from a
    very small set of source IP addresses?
  context: This question seeks to identify a DoS attack where one or a few malicious
    sources are overwhelming a target device with connection attempts that the device
    is actively rejecting. A high count of rejected states ('REJ', 'RSTO', etc.) combined
    with a low source IP count points directly to a targeted SYN flood or similar
    resource exhaustion attack.
  answer_sources:
  - Zeek conn.log
  - ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces
    of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'FOR each critical_device_ip: COUNT connections with state in [REJ, RSTO,
      RSTR, RSTRH] in 60s. COUNT unique source IPs for those connections. IF rejected_count
      > 100 AND unique_source_ips < 5 THEN ALERT.'
- question: Is a critical ICS device experiencing an anomalous rate of connection
    rejections compared to its baseline, and is a single source IP responsible for
    the majority of these attempts?
  context: This question improves on simple thresholding by using a dynamic baseline
    to detect anomalous levels of connection rejections. This helps reduce false
    positives from normal network fluctuations. Escalating the alert only when a
    single source IP dominates the traffic provides a high-confidence indicator of
    a targeted DoS attack.
  answer_sources:
  - Zeek conn.log
  - ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces
    of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'FOR each critical_device_ip: CALCULATE 30-day baseline for rejected connections
      per min. IF current_rejected_count > 99th_percentile: CALCULATE source IP distribution.
      IF one_source_ip > 80% of attempts THEN ESCALATE ALERT.'
- question: Can an unsupervised clustering algorithm identify groups of network connections
    that match the profile of a DoS attack (e.g., high density, single target, short
    duration, rejected state)?
  context: This question uses machine learning (DBSCAN clustering) to find hidden
    patterns of DoS attacks in network data without pre-defined rules. A dense cluster
    of connections all targeting the same device, with very short durations, no data
    sent, and a rejected state is a classic signature of a SYN flood or similar DoS
    attack.
  answer_sources:
  - Zeek conn.log
  - ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces
    of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'EVERY 5 mins: APPLY DBSCAN clustering on Zeek conn.log features (dest_ip,
      duration, orig_bytes, conn_state). IF cluster found with properties (single
      critical_ip, short duration, low bytes, rejection state) THEN ALERT.'
- question: Did a critical Windows-based ICS host or service crash immediately after
    receiving an anomalous number of connections from a single source?
  context: This question directly links a network-level event (a flood of connections)
    to a host-level impact (a crash or hang). This temporal correlation is a powerful
    indicator that a network-based DoS attack successfully disrupted a critical system,
    moving beyond simple resource exhaustion to causing an actual failure.
  answer_sources:
  - Windows Event ID 1000
  - Windows Event ID 1002
  - Windows Event ID 7031
  - Windows Event ID 7034
  - Zeek conn.log
  - ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces
    of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'ON Windows Event (1000, 1002, 7031, 7034) for critical host: QUERY network
      logs for preceding 60s. IF connection_count from single_source_ip > 500 to
      host_ip THEN ALERT.'
- question: Following a critical process termination, was the network traffic to the
    affected host significantly higher than its historical norm for that time of day?
  context: This question adds statistical rigor to the investigation of a host crash.
    Instead of using a static threshold for "anomalous traffic," it compares the
    traffic just before the crash to a detailed historical baseline. A significant
    deviation from this specific baseline strongly suggests the traffic was abnormal
    and likely the cause of the crash.
  answer_sources:
  - Windows Event ID 1000
  - Windows Event ID 1002
  - Windows Event ID 7031
  - Windows Event ID 7034
  - Zeek conn.log
  - ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces
    of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'ON Windows Event (1000, 1002, 7031, 7034): QUERY network metrics (conn_count,
      bytes) for host in preceding 5 mins. COMPARE to 30-day historical distribution
      for same time/day. IF current_metrics > 99th_percentile THEN FLAG as potential
      DoS.'
- question: Can a predictive machine learning model, trained on sequences of network
    traffic, forecast an imminent host crash?
  context: This question represents a proactive approach to threat detection. By training
    a sequence-aware model (like an LSTM) on historical data, it learns the specific
    patterns of network traffic that typically precede a crash. The model can then
    monitor live traffic and alert when it recognizes one of these malicious sequences,
    potentially giving analysts a chance to intervene before the system fails.
  answer_sources:
  - Windows Event ID 1000
  - Windows Event ID 1002
  - Windows Event ID 7031
  - Windows Event ID 7034
  - Zeek conn.log
  - ICS Network Segments (Purdue Levels 1-3), Control System DMZ, and network interfaces
    of critical devices (PLCs, RTUs, IEDs, HMIs, EWS, Historians).
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'CONTINUOUSLY feed sequence of network features (conn_rate, byte_rate)
      into trained LSTM model. IF model_output_probability(crash_in_next_minute)
      > high_threshold THEN ALERT.'
- question: Is an external, non-whitelisted IP address generating a high volume of
    incomplete or rejected connections to a critical ICS asset, possibly in conjunction
    with a network scan?
  context: This question focuses on identifying a classic SYN flood from an unauthorized
    external source. It combines multiple indicators for high confidence: the source
    is external, the connection volume is high, the vast majority of connections
    are failing to establish, and it may be correlated with scanning activity.
  answer_sources:
  - Zeek conn.log
  - Zeek notice.log
  - ICS Level 3 (Manufacturing Operations) and Level 2 (Control System) network boundaries,
    Data Historian servers, HMI Workstations.
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'MONITOR Zeek conn.log for traffic to critical assets. IF external_ip_conn_attempts
      > 500 in 60s AND ratio_of_rejected_states > 90%: CHECK Zeek notice.log for recent
      scan notice from same source. IF BOTH true THEN high-severity ALERT.'
- question: Is a critical ICS asset experiencing a sustained, anomalous spike in both
    new connections and traffic volume, coupled with a sudden drop in source IP diversity?
  context: This question seeks to detect a flood attack by identifying a simultaneous,
    sustained anomaly across multiple traffic metrics against a historical baseline.
    The concurrent drop in Shannon entropy of source IPs confirms the traffic surge
    is from a small number of coordinated attackers, a hallmark of a targeted flood.
  answer_sources:
  - Zeek conn.log
  - Zeek notice.log
  - ICS Level 3 (Manufacturing Operations) and Level 2 (Control System) network boundaries,
    Data Historian servers, HMI Workstations.
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'FOR each critical asset: CALCULATE 14-day baseline for conn_rate and byte_rate.
      IF current rates > 99.9th percentile for 3 mins: CALCULATE source IP entropy
      over 5 mins. IF entropy < 5th percentile of baseline THEN ALERT.'
- question: Has an unsupervised machine learning model, like Isolation Forest, identified
    network flows to a critical ICS asset that are highly anomalous?
  context: This question uses an unsupervised learning approach to find outliers.
    An Isolation Forest model can 'isolate' anomalies that are "few and different."
    A DoS attack, with its unusual combination of features (e.g., high volume, single
    destination), would be easily isolated and flagged with a high anomaly score.
  answer_sources:
  - Zeek conn.log
  - Zeek notice.log
  - ICS Level 3 (Manufacturing Operations) and Level 2 (Control System) network boundaries,
    Data Historian servers, HMI Workstations.
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'CONTINUOUSLY stream Zeek conn.log features (IPs, port, protocol, counts,
      state) into trained Isolation Forest model. IF model returns high anomaly_score
      THEN ALERT.'
- question: Did a critical ICS service terminate unexpectedly and fail to restart,
    without being part of a planned system shutdown?
  context: This question aims to filter out benign service restarts and planned shutdowns
    to focus on truly anomalous service failures. By checking for a successful restart
    event (7036) and the absence of a shutdown event (1074), it creates a high-fidelity
    alert for an unexpected service crash.
  answer_sources:
  - Windows Event ID 7034
  - Windows Event ID 7036
  - Windows Event ID 7024
  - Windows Event ID 1074
  - Windows Event ID 4688
  - Windows Event ID 1 (Sysmon Process Create)
  - ICS Level 2 (Control System) HMI Workstations, Engineering Workstations, and SCADA/Historian
    Servers.
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'ON Windows Event (7034 or 7024) for critical service: WAIT 60s. IF no
      Event 7036 for same service AND no Event 1074 in last 5 mins THEN high-severity
      ALERT.'
- question: Is a critical ICS service failing more frequently than its historical
    average, or is it failing with a statistically rare error code?
  context: This question analyzes failure patterns over time. A service that crashes
    more often than its established Mean Time Between Failures (MTBF) suggests a
    new, persistent problem. Furthermore, a novel or rare error code associated with
    the crash can provide a crucial clue to the root cause.
  answer_sources:
  - Windows Event ID 7034
  - Windows Event ID 7036
  - Windows Event ID 7024
  - Windows Event ID 1074
  - Windows Event ID 4688
  - Windows Event ID 1 (Sysmon Process Create)
  - ICS Level 2 (Control System) HMI Workstations, Engineering Workstations, and SCADA/Historian
    Servers.
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'ON Windows Event (7034 or 7024): CALCULATE uptime since last failure.
      CALCULATE historical MTBF. IF uptime < 0.5 * MTBF THEN medium-severity ALERT.
      ANALYZE error code from Event 7024. IF error_code_frequency < 1% in last 90
      days THEN FLAG for investigation.'
- question: Can a supervised machine learning model predict whether a service termination
    is anomalous based on surrounding host events?
  context: This question applies supervised learning to distinguish malicious service
    crashes from benign ones. By training a model on a rich feature set (error codes,
    uptime, recent logins, software installs), the system can learn the contextual
    differences and provide a probabilistic score of how suspicious a crash is.
  answer_sources:
  - Windows Event ID 7034
  - Windows Event ID 7036
  - Windows Event ID 7024
  - Windows Event ID 1074
  - Windows Event ID 4688
  - Windows Event ID 1 (Sysmon Process Create)
  - ICS Level 2 (Control System) HMI Workstations, Engineering Workstations, and SCADA/Historian
    Servers.
  range: Last 90 days
  queries:
  - technology: pseudocode
    query: 'ON service termination: GATHER features (service name, error code, uptime,
      recent logins, recent installs). INPUT features into trained XGBoost model.
      IF model predicts ''anomalous'' with high probability THEN ALERT.'