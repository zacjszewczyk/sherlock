name: "T0832: Manipulation of View"
id: "17c2f0f4-508b-4b68-809c-2795958b883d"
description: |
  This playbook helps determine if an adversary has manipulated an operator's view of the industrial process or executed an action intended to cause physical damage. This is achieved by identifying discrepancies between actual process values and what is displayed or recorded, detecting unauthorized modifications to HMI project files, and spotting malicious ICS write commands. Evidence includes mismatches between PLC network responses and historian data, unauthorized processes altering HMI files (e.g., .gfx, .pvi), and ICS write commands from unapproved sources that set values outside of safe engineering limits or target read-only registers.
type: "technique"
related:
  - "TA0105: Impact"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: "1.0"
tags: "none"
questions:
  - question: "Is there a discrepancy between the process values reported directly by PLCs and the values recorded by the historian or displayed on the HMI?"
    context: |
      This question aims to detect view manipulation by comparing data from different points in the control system. An attacker might intercept and alter data sent to the HMI or historian, making operators and engineers believe the process is normal while it is actually in an unsafe state. By correlating PLC network responses with data sent to visualization platforms, we can identify such discrepancies. An alert is triggered if the difference exceeds a defined engineering threshold, indicating a potential compromise of the operator's view.
    answer_sources:
      - "Zeek modbus.log"
      - "Zeek dnp3.log"
      - "Zeek s7comm.log"
      - "Zeek conn.log"
      - "HMI servers, Historian servers, and network segments connecting PLCs to HMIs and Historians, focusing on data gateways and visualization platforms."
    range: "last 90 days"
    queries:
      - "SEARCH PLC read responses AND HMI/gateway traffic to historian. FOR each critical process tag, JOIN PLC value and historian value by timestamp (within 5s window). WHERE (value_plc - value_historian) > threshold, ALERT."
  - question: "Has the statistical correlation between PLC-reported values and historian-recorded values for critical process tags degraded over time?"
    context: |
      This question seeks to identify a subtle or slow divergence between the actual process state and the operator's view. A strong, consistent correlation is expected between what a PLC reports and what a historian records. A drop in this correlation suggests that the data streams are becoming decoupled, which could be a sign of a sophisticated manipulation attack. Calculating a rolling cross-correlation coefficient can detect this degradation even if the absolute values do not immediately trigger a simple threshold alert.
    answer_sources:
      - "Zeek modbus.log"
      - "Zeek dnp3.log"
      - "Zeek s7comm.log"
      - "Zeek conn.log"
      - "HMI servers, Historian servers, and network segments connecting PLCs to HMIs and Historians, focusing on data gateways and visualization platforms."
    range: "last 90 days"
    queries:
      - "FOR each critical tag, CREATE time_series_plc AND time_series_historian. CALCULATE rolling 10-min Pearson correlation. WHERE correlation_coefficient < 0.9 for > 5 mins, ALERT."
  - question: "Is there a statistical anomaly in the relationship between PLC-reported values, HMI-displayed values, historian-recorded values, and associated control outputs?"
    context: |
      This question uses machine learning to detect complex forms of view manipulation. An autoencoder is trained on the normal, highly correlated state between multiple data sources related to a single process point. When an attacker manipulates one of these data streams, the relationship is broken, causing the model to produce a high reconstruction error. This approach can detect novel or complex attacks that might evade simpler correlation or threshold-based checks by learning the holistic 'normal' behavior of the system's data flow.
    answer_sources:
      - "Zeek modbus.log"
      - "Zeek dnp3.log"
      - "Zeek s7comm.log"
      - "Zeek conn.log"
      - "HMI servers, Historian servers, and network segments connecting PLCs to HMIs and Historians, focusing on data gateways and visualization platforms."
    range: "last 90 days"
    queries:
      - "TRAIN autoencoder on [PLC_value, HMI_value, Historian_value, Control_output]. FOR new data, CALCULATE reconstruction_error. WHERE reconstruction_error > threshold, ALERT."
  - question: "Has an unauthorized process modified HMI configuration or project files?"
    context: |
      This question aims to detect direct tampering with HMI files, which is a common way to manipulate an operator's view. Attackers may modify graphical files to hide alarm conditions or display false data. By maintaining a whitelist of approved software (e.g., HMI editors) and monitoring for file writes to sensitive HMI project directories, we can alert on any modification made by an unapproved process, indicating a potential attack.
    answer_sources:
      - "Windows Event ID 4663"
      - "Windows Event ID 4688"
      - "File systems on HMI servers and engineering workstations, specifically directories containing HMI screen and logic configuration files."
    range: "last 90 days"
    queries:
      - "SEARCH for EventID 4663 (file write) on HMI files. JOIN with EventID 4688 on ProcessId. WHERE ProcessName OR ProcessHash is NOT in whitelist, ALERT."
  - question: "Is there an unusually high frequency of modifications to HMI configuration files by a specific user or process?"
    context: |
      This question seeks to detect anomalous behavior related to HMI file editing. While legitimate changes occur, an attacker attempting to manipulate the view might make numerous, rapid changes. By baselining the normal frequency of modifications for each user and process, we can identify outliers. A sudden spike in editing activity, especially outside of planned maintenance, is a strong indicator of malicious activity.
    answer_sources:
      - "Windows Event ID 4663"
      - "Windows Event ID 4688"
      - "File systems on HMI servers and engineering workstations, specifically directories containing HMI screen and logic configuration files."
    range: "last 90 days"
    queries:
      - "BASELINE EventID 4663 count per user/host/process over 30 days. SEARCH for current 24-hour modification count. WHERE count > 99th percentile of baseline, ALERT."
  - question: "Has a user or system process exhibited anomalous behavior while modifying HMI configuration files?"
    context: |
      This question leverages UEBA to detect sophisticated attacks that may use legitimate credentials. A UEBA model learns the normal context of file modifications, including the user, process, time of day, and source system. An alert would be triggered by a deviation from this learned behavior, such as an administrator account using PowerShell to edit HMI files late at night, instead of an engineer using the official HMI editor during business hours. This helps catch credential misuse and living-off-the-land techniques.
    answer_sources:
      - "Windows Event ID 4663"
      - "Windows Event ID 4688"
      - "File systems on HMI servers and engineering workstations, specifically directories containing HMI screen and logic configuration files."
    range: "last 90 days"
    queries:
      - "TRAIN UEBA model on user/process file modification behavior (file paths, frequency, time, process name). WHERE new activity significantly deviates from baseline, ALERT."
  - question: "Has an unauthorized source sent a command to a critical PLC register with a value outside its safe operating range or to a read-only register?"
    context: |
      This question aims to detect overtly malicious commands sent to a PLC. Such commands could directly cause a hazardous state. By defining critical registers, their safe value ranges, and their read/write status, we can create high-fidelity alerts. Any write command from an unapproved IP that violates these pre-defined safety or configuration rules is a strong indicator of an attack attempting to cause a physical impact.
    answer_sources:
      - "Zeek conn.log"
      - "Zeek modbus.log"
      - "Zeek dnp3.log"
      - "Zeek enip.log"
      - "Zeek s7comm.log"
      - "Windows Event ID 4688"
      - "Windows Event ID 4624"
      - "Process Control Network (PCN) segments, Safety Instrumented System (SIS) network segments, PLC/RTU network interfaces, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), SCADA Servers, Data Historian servers."
    range: "last 90 days"
    queries:
      - "SEARCH for ICS write commands. WHERE (source_ip NOT in allowlist AND value is outside safe range) OR (target_register is read-only), ALERT."
  - question: "Are critical process parameters deviating significantly from their normal, baselined operating ranges or interdependencies?"
    context: |
      This question seeks to identify when the physical process itself enters an anomalous state, which could be the result of a successful manipulation. By baselining the normal statistical distribution of individual parameters and the relationships between multiple parameters (using Mahalanobis distance), we can detect when the system's state becomes abnormal. This can catch the *result* of an attack, even if the attack command itself was missed.
    answer_sources:
      - "Zeek conn.log"
      - "Zeek modbus.log"
      - "Zeek dnp3.log"
      - "Zeek enip.log"
      - "Zeek s7comm.log"
      - "Windows Event ID 4688"
      - "Windows Event ID 4624"
      - "Process Control Network (PCN) segments, Safety Instrumented System (SIS) network segments, PLC/RTU network interfaces, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), SCADA Servers, Data Historian servers."
    range: "last 90 days"
    queries:
      - "BASELINE 30-day distribution for critical parameters. SEARCH live readings. WHERE reading is outside 1st-99th percentile range for 3+ cycles, ALERT. OR CALCULATE Mahalanobis distance for interdependent parameters. WHERE distance > 99.9th percentile, ALERT."
  - question: "Are the observed ICS 'write' commands statistically anomalous compared to a learned baseline of normal command behavior?"
    context: |
      This question uses machine learning to identify unusual or novel ICS 'write' commands that might not violate a simple rule but are inconsistent with normal operations. An OCSVM model can learn the multi-dimensional profile of normal commands (source IP, target register, value). Any command that falls outside this learned 'normal' cluster is flagged as an outlier. A secondary model monitors the temporal patterns of commands (frequency, entropy) to detect behavioral shifts, like a sudden flood of write commands, indicative of a scripting attack.
    answer_sources:
      - "Zeek conn.log"
      - "Zeek modbus.log"
      - "Zeek dnp3.log"
      - "Zeek enip.log"
      - "Zeek s7comm.log"
      - "Windows Event ID 4688"
      - "Windows Event ID 4624"
      - "Process Control Network (PCN) segments, Safety Instrumented System (SIS) network segments, PLC/RTU network interfaces, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), SCADA Servers, Data Historian servers."
    range: "last 90 days"
    queries:
      - "TRAIN OCSVM on normal [source_ip, register, value] tuples. FOR live write commands, WHERE model predicts outlier (-1), ALERT. AND/OR TRAIN anomaly model on 1-min aggregated features (write frequency, entropy). WHERE changepoint or spike detected, ALERT."