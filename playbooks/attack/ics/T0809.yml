name: "T0809: Data Destruction"
id: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
description: "This playbook addresses the potential for an adversary to destroy critical operational data or system files within an Industrial Control System (ICS) environment, which could inhibit response functions. It focuses on detecting signs of data destruction, such as the execution of known data destruction utilities, a high volume of file deletions targeting critical ICS project files and configurations, the specific deletion of files with high-value ICS extensions (e.g., .ACD, .S7P), and the transfer of potentially malicious executables into the OT network."
type: "technique"
related:
  - "TA0107: Inhibit Response Function"
contributors:
  - "Zachary Szewczyk"
  - "Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
  - question: "Are known data destruction utilities being executed on critical ICS assets?"
    context: "This question aims to identify the explicit use of tools or commands designed for data destruction (e.g., sdelete, killdisk, cipher.exe /w). Detecting the execution of these utilities on sensitive ICS assets like Engineering Workstations or HMIs is a strong indicator of malicious intent to disrupt operations or destroy evidence."
    answer_sources:
      - "Windows Event ID 4688"
      - "Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Servers (PCS), Operator Workstations"
    range: "last 90 days"
    queries:
      - "Search: SIEM"
      - "Pseudocode: SEARCH Windows Event ID 4688 WHERE (host IN NAI_list) AND (command_line CONTAINS ('sdelete', 'killdisk', 'cipher.exe /w', 'format', 'wevtutil cl', 'fsutil file setzerodata')) AND (process_name NOT IN whitelist)"
  - question: "Is there anomalous process command line activity on critical ICS assets that could indicate obfuscated data destruction?"
    context: "Adversaries may try to hide their data destruction activities by using obfuscated or unusually long command lines. This question focuses on detecting statistical outliers in command line length or character entropy compared to a historical baseline for a given process on a specific host. A significant deviation could signal an attempt to conceal malicious commands."
    answer_sources:
      - "Windows Event ID 4688"
      - "Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Servers (PCS), Operator Workstations"
    range: "last 90 days"
    queries:
      - "Search: SIEM/Data Analytics Platform"
      - "Pseudocode: FOR each host in NAI_list:\n  CALCULATE baseline (mean, std_dev) of command_line_length and command_line_entropy for each process_name over last 30 days.\n  ALERT IF current event's command_line_length > (mean + 3*std_dev) OR command_line_entropy > (mean + 3*std_dev) OR process_name not seen in 30 days."
  - question: "Can machine learning identify novel or complex patterns of malicious process execution related to data destruction?"
    context: "This question leverages unsupervised machine learning to find unusual process execution events that may not be caught by simple keyword or statistical checks. By analyzing multiple features like process name, parent process, user, command line properties, and time of day, the model can flag sophisticated attacks that deviate from normal operational patterns on critical ICS assets."
    answer_sources:
      - "Windows Event ID 4688"
      - "Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Data Historians, Process Control Servers (PCS), Operator Workstations"
    range: "last 90 days"
    queries:
      - "Search: Machine Learning Platform"
      - "Pseudocode: DEPLOY anomaly detection model (e.g., Isolation Forest) trained on historical WinEvent 4688 data from NAI_list.\n  FEATURES: process_name, parent_process, user, cmd_length, cmd_entropy, time_of_day.\n  SCORE new process events in real-time.\n  ALERT IF event is classified as an outlier."
  - question: "Is there a mass deletion of files occurring in critical ICS directories?"
    context: "This question seeks to detect a brute-force data destruction attempt, characterized by a large number of file deletion events from a single user or process in a very short time. Focusing on critical directories (e.g., project files, historian data) helps prioritize alerts for activity that poses a direct threat to ICS operations."
    answer_sources:
      - "Windows Event ID 4663"
      - "ICS File Servers, Data Historians, ICS Backup Servers, Engineering Workstations (EWS), Process Control Servers (PCS)"
    range: "last 90 days"
    queries:
      - "Search: SIEM"
      - "Pseudocode: SEARCH Windows Event ID 4663 WHERE (accesses CONTAINS 'DELETE') AND (object_name IN critical_ICS_directories).\n  GROUP BY user, process_name.\n  ALERT IF count > 50 in 60 seconds."
  - question: "Is a user or process deleting files at a statistically unusual rate on critical ICS assets?"
    context: "Rather than a fixed threshold, this question uses a rolling baseline to detect abnormal deletion activity relative to the normal behavior of a specific user or process. This helps identify more subtle or slow-and-low destruction attempts that might not trigger a simple volume-based alert. It also checks for unusual deletion patterns by analyzing the entropy of file extensions being deleted."
    answer_sources:
      - "Windows Event ID 4663"
      - "ICS File Servers, Data Historians, ICS Backup Servers, Engineering Workstations (EWS), Process Control Servers (PCS)"
    range: "last 90 days"
    queries:
      - "Search: SIEM/Data Analytics Platform"
      - "Pseudocode: FOR each user, process on NAI_list:\n  CALCULATE baseline (mean, std_dev) of 'DELETE' event counts per 5-minute window.\n  ALERT IF current count > (mean + 3*std_dev).\n  CALCULATE file extension entropy for window.\n  ALERT IF entropy spikes."
  - question: "Can a time-series model predict and detect deviations from normal file deletion patterns on critical ICS assets?"
    context: "This question applies advanced time-series analysis to model the normal rhythm and seasonality of file deletion activities. By learning these complex patterns, a model like an LSTM autoencoder can detect significant deviations that indicate a potential attack, even if the activity falls within simple statistical bounds. This is useful for identifying sophisticated adversaries who understand and try to mimic normal operational behavior."
    answer_sources:
      - "Windows Event ID 4663"
      - "ICS File Servers, Data Historians, ICS Backup Servers, Engineering Workstations (EWS), Process Control Servers (PCS)"
    range: "last 90 days"
    queries:
      - "Search: Machine Learning Platform"
      - "Pseudocode: DEPLOY time-series anomaly detection model (e.g., LSTM) trained on 1-minute aggregated 'DELETE' counts from NAI_list.\n  SEGMENT by user and process.\n  ALERT IF actual count deviates significantly from model's predicted range."
  - question: "Are critical ICS project or configuration files being deleted?"
    context: "This question focuses on the highest-impact scenario: the deletion of specific, irreplaceable ICS files identified by their extensions (e.g., .ACD for Rockwell projects, .S7P for Siemens projects). The deletion of even a single one of these files by an unauthorized process or user is a critical event that requires immediate investigation, as it can halt production or render a system inoperable."
    answer_sources:
      - "Windows Event ID 4663"
      - "Engineering Workstations (EWS), File servers hosting ICS project files, Data Historians, ICS Backup Servers"
    range: "last 90 days"
    queries:
      - "Search: SIEM"
      - "Pseudocode: SEARCH Windows Event ID 4663 WHERE (accesses CONTAINS 'DELETE') AND (object_name ENDS WITH critical_ICS_extensions) AND (user/process NOT IN whitelist).\n  ALERT immediately."
  - question: "Is a user or process deleting a critical ICS file type for the first time or at an unusual time?"
    context: "This question aims to detect suspicious deletions by identifying rare or novel behavior. An administrator might regularly delete backup '.ACD' files, but an operator deleting one for the first time is highly anomalous. By calculating a rarity score based on historical user/file-type interactions and timing, this method can flag suspicious activity that might otherwise appear legitimate."
    answer_sources:
      - "Windows Event ID 4663"
      - "Engineering Workstations (EWS), File servers hosting ICS project files, Data Historians, ICS Backup Servers"
    range: "last 90 days"
    queries:
      - "Search: Data Analytics Platform"
      - "Pseudocode: FOR each deletion of a critical ICS file:\n  CALCULATE rarity_score based on historical frequency of (user, file_extension) pair.\n  ALERT IF rarity_score is high OR deletion time is statistically anomalous."
  - question: "Can a machine learning model be trained to distinguish between legitimate and malicious deletions of critical ICS files?"
    context: "This question proposes using supervised machine learning to build a highly sophisticated detection capability. By training a model on labeled examples of 'good' and 'bad' deletions, it can learn the subtle, multi-faceted patterns that differentiate routine maintenance from a malicious attack. Features like user, process, file type, time, and rarity score are combined to make a high-confidence classification."
    answer_sources:
      - "Windows Event ID 4663"
      - "Engineering Workstations (EWS), File servers hosting ICS project files, Data Historians, ICS Backup Servers"
    range: "last 90 days"
    queries:
      - "Search: Machine Learning Platform"
      - "Pseudocode: DEPLOY classification model (e.g., Random Forest) trained on labeled 'DELETE' events of critical files.\n  FEATURES: user, process, file_extension, source_workstation, time_of_day, rarity_score.\n  ALERT IF classification is 'malicious' with confidence > 0.9."
  - question: "Is a known malicious executable being transferred into the OT/ICS network?"
    context: "This question seeks to identify the introduction of malware or unauthorized tools into the secure OT network. It works by monitoring network traffic for executable file transfers and cross-referencing the file's hash against threat intelligence feeds. An alert here indicates a potential precursor to an attack, such as an adversary staging a data destruction tool."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek files.log"
      - "Zeek pe.log"
      - "Network boundary between IT and OT networks (ICS DMZ), Core ICS network segments, SCADA network, Process Control Network (PCN)"
    range: "last 90 days"
    queries:
      - "Search: SIEM"
      - "Pseudocode: SEARCH Zeek files.log WHERE (destination_ip IN OT_subnet) AND (mime_type is 'application/x-dosexec').\n  CHECK file_hash against threat intelligence.\n  CORRELATE with conn.log to check for non-standard ports.\n  ALERT on match."
  - question: "Is an executable file with suspicious characteristics (e.g., high entropy, anomalous PE header) being transferred into the OT network?"
    context: "This question aims to detect potentially malicious executables that are not yet known to threat intelligence. Packed or encrypted malware often has high entropy. Similarly, malicious tools may have PE headers that deviate from the standard for legitimate ICS software. By baselining these characteristics, this method can flag novel or custom-made malicious executables."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek files.log"
      - "Zeek pe.log"
      - "Network boundary between IT and OT networks (ICS DMZ), Core ICS network segments, SCADA network, Process Control Network (PCN)"
    range: "last 90 days"
    queries:
      - "Search: Data Analytics Platform"
      - "Pseudocode: FOR each executable transferred to OT_subnet:\n  CALCULATE file entropy.\n  ALERT IF entropy > 7.5 OR entropy > 3*std_dev from baseline.\n  COMPARE PE header values to trusted baseline.\n  ALERT on significant deviation."
  - question: "Can a machine learning model proactively classify file transfers into the OT network as malicious or benign?"
    context: "This question uses a supervised machine learning model to provide a comprehensive, real-time assessment of every file transfer into the OT network. By combining multiple features from network logs (file size, type, entropy, PE header info, connection details, IP reputation), the model can make a holistic judgment and flag suspicious transfers with high confidence, providing a powerful defense against the staging of malicious tools."
    answer_sources:
      - "Zeek conn.log"
      - "Zeek files.log"
      - "Zeek pe.log"
      - "Network boundary between IT and OT networks (ICS DMZ), Core ICS network segments, SCADA network, Process Control Network (PCN)"
    range: "last 90 days"
    queries:
      - "Search: Machine Learning Platform"
      - "Pseudocode: DEPLOY classification model (e.g., LightGBM) trained on labeled file transfer data.\n  FEATURES: file_size, mime_type, entropy, PE_header_info, connection_duration, IP_reputation.\n  ALERT IF classification is 'malicious' with confidence > 0.9."