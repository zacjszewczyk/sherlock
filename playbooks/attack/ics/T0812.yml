name: "T0812: Default Credentials"
id: "f3a1b5c2-7d8e-4f9a-8b6c-0e1d2f3a4b5c"
description: "This playbook helps investigate whether an adversary is using default credentials for lateral movement within an OT network. It focuses on detecting successful network connections to critical ICS assets (e.g., PLCs, RTUs) from unauthorized sources using known default credentials, or the use of privileged function codes from unauthorized sources on protocols that lack explicit authentication. It also covers the detection of interactive logons to high-value Windows-based OT assets (e.g., EWS, HMI) using default accounts, followed by the use of remote access tools to pivot to other devices."
type: "technique"
related: 
- "TA0109: Lateral Movement"
contributors:
- Zachary Szewczyk
- Ask Sage
created: "2025-10-01"
modified: "2025-10-01"
version: 1.0
tags: "none"
questions:
- question: "How can I detect successful logins to critical ICS assets using default credentials over management protocols, or privileged actions from unauthorized sources on protocols lacking explicit authentication?"
  context: "This question focuses on real-time detection of unauthorized access attempts. By correlating network flows with authentication logs, analysts can identify when a known default credential is used to access a sensitive device. For protocols like Modbus or DNP3 that don't have native authentication logging, monitoring for privileged commands from untrusted IP addresses serves as a proxy for a potential compromise. This helps catch attackers exploiting common weak configurations for lateral movement. [1]"
  answer_sources:
  - "Data Sources: Zeek conn.log, Zeek ssh.log, Zeek ftp.log, Zeek telnet.log, Zeek rdp.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log, Zeek s7comm.log, Sysmon Event ID 3, ICS Asset Inventory, Network Access Control Lists (ACLs)"
  - "Networks of Interest: Level 1 (Process Control) and Level 2 (Supervisory Control) networks, specifically targeting PLCs, RTUs, HMIs, IEDs, and other field devices. Also, the IT/OT DMZ (Purdue Model Level 3.5), network traffic between Engineering Workstations and Level 2/1 devices, and connections to SCADA servers and Historian databases."
  range: "last 90 days"
  queries:
  - "pseudocode": "SEARCH for network connections to critical ICS assets on management ports AND correlate with successful authentication logs using a username from a default credential watchlist. OR SEARCH protocol-specific logs (e.g., Modbus, DNP3) for write/control function codes originating from a source IP not on the asset's approved whitelist."
- question: "Are there any successful authentications to critical ICS assets using default credentials that are statistically rare or anomalous?"
  context: "This question aims to find outliers. Attackers might use a default credential that is rarely or never used in normal operations. By baselining authentication activity and calculating a risk score based on frequency, analysts can prioritize alerts for authentications that are not only using a weak default password but are also highly unusual for that specific asset, significantly increasing the likelihood of it being a malicious event. [1]"
  answer_sources:
  - "Data Sources: Zeek conn.log, Zeek ssh.log, Zeek ftp.log, Zeek telnet.log, Zeek rdp.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log, Zeek s7comm.log, Sysmon Event ID 3, ICS Asset Inventory, Network Access Control Lists (ACLs)"
  - "Networks of Interest: Level 1 (Process Control) and Level 2 (Supervisory Control) networks, specifically targeting PLCs, RTUs, HMIs, IEDs, and other field devices. Also, the IT/OT DMZ (Purdue Model Level 3.5), network traffic between Engineering Workstations and Level 2/1 devices, and connections to SCADA servers and Historian databases."
  range: "last 90 days"
  queries:
  - "pseudocode": "FOR each critical ICS asset, BASELINE authentication frequency over the last 30 days. FOR each new successful authentication using a default credential, CALCULATE risk score based on inverse frequency. ALERT if risk score exceeds the 99th percentile for that asset."
- question: "Can a graph-based anomaly detection model identify unusual network connections that could indicate lateral movement using default credentials?"
  context: "This question leverages machine learning to understand complex network communication patterns. By modeling the network as a graph, the model can learn what 'normal' looks like. When an attacker uses a default credential to move laterally, they will likely create connections that deviate from this learned baseline. Flagging connections with high anomaly scores, particularly when they coincide with a default credential authentication, provides a sophisticated way to detect novel or stealthy attack paths. [1]"
  answer_sources:
  - "Data Sources: Zeek conn.log, Zeek ssh.log, Zeek ftp.log, Zeek telnet.log, Zeek rdp.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log, Zeek s7comm.log, Sysmon Event ID 3, ICS Asset Inventory, Network Access Control Lists (ACLs)"
  - "Networks of Interest: Level 1 (Process Control) and Level 2 (Supervisory Control) networks, specifically targeting PLCs, RTUs, HMIs, IEDs, and other field devices. Also, the IT/OT DMZ (Purdue Model Level 3.5), network traffic between Engineering Workstations and Level 2/1 devices, and connections to SCADA servers and Historian databases."
  range: "last 90 days"
  queries:
  - "pseudocode": "QUERY graph-based anomaly detection model for network connections with a high anomaly score. CORRELATE anomalous connections with successful authentication events using a username from a default credential watchlist."
- question: "Has a default or shared account been used to log into a critical Windows-based OT asset, and was this logon immediately followed by the use of remote access tools to connect to other ICS devices?"
  context: "This question looks for a specific, high-confidence attack chain. An attacker gaining initial access to an HMI or EWS with a default account is one thing, but immediately using that access to pivot to another device is a strong indicator of active lateral movement. This multi-event correlation (logon -> remote tool execution -> outbound network connection) within a short time window helps filter out noise and focus on active intrusions."
  answer_sources:
  - "Data Sources: Windows Event ID 4624, Windows Event ID 4688, PowerShell Event ID 4104, Sysmon Event ID 1, Sysmon Event ID 3, Zeek conn.log, Zeek ssh.log, Zeek rdp.log"
  - "Networks of Interest: Engineering Workstations (EWS), Jump Servers, Remote Access Servers, SCADA Servers, and Human-Machine Interfaces (HMIs) running Windows operating systems within the Process Control Network (PCN) or IT/OT DMZ."
  range: "last 90 days"
  queries:
  - "pseudocode": "SEARCH for successful logon events (Event ID 4624) on critical OT assets where username is on a default account watchlist. CORRELATE by Logon ID with subsequent process creation (Event ID 4688) of a remote access tool OR PowerShell remote access cmdlets (Event ID 4104) within 5 minutes. FURTHER CORRELATE with an outbound network connection (Sysmon Event ID 3) to another ICS asset."
- question: "Are there user sessions on critical Windows-based OT assets, initiated with a default account, that exhibit statistically anomalous process execution or network connection behavior?"
  context: "This question moves beyond single events to analyze the behavior of an entire user session. By baselining what processes and network connections are common for a given host or user, we can score each session for rarity. A session started with a weak, default account that then involves a series of rare processes or connections is highly suspicious. This approach can detect malicious activity even if the individual tools used are legitimate, as the sequence of actions is what's anomalous."
  answer_sources:
  - "Data Sources: Windows Event ID 4624, Windows Event ID 4688, PowerShell Event ID 4104, Sysmon Event ID 1, Sysmon Event ID 3, Zeek conn.log, Zeek ssh.log, Zeek rdp.log"
  - "Networks of Interest: Engineering Workstations (EWS), Jump Servers, Remote Access Servers, SCADA Servers, and Human-Machine Interfaces (HMIs) running Windows operating systems within the Process Control Network (PCN) or IT/OT DMZ."
  range: "last 90 days"
  queries:
  - "pseudocode": "FOR each critical Windows OT asset, BASELINE process execution and network connection rarity over 30 days. FOR each new user session initiated with a default account, CALCULATE a session risk score based on the rarity of its events. ALERT if the session risk score exceeds the 98th percentile for that host or user."
- question: "Can a sequence-based machine learning model detect anomalous user sessions on EWS or jump servers that may indicate compromise via a default account?"
  context: "This question applies deep learning to model the temporal flow of events within a user session. Models like LSTMs are excellent at learning sequential patterns. When a user session deviates significantly from the learned normal sequences, the model will have a high reconstruction error, flagging it as an anomaly. Prioritizing these anomalies when they originate from a default account login provides a powerful method for detecting sophisticated, multi-step attacks."
  answer_sources:
  - "Data Sources: Windows Event ID 4624, Windows Event ID 4688, PowerShell Event ID 4104, Sysmon Event ID 1, Sysmon Event ID 3, Zeek conn.log, Zeek ssh.log, Zeek rdp.log"
  - "Networks of Interest: Engineering Workstations (EWS), Jump Servers, Remote Access Servers, SCADA Servers, and Human-Machine Interfaces (HMIs) running Windows operating systems within the Process Control Network (PCN) or IT/OT DMZ."
  range: "last 90 days"
  queries:
  - "pseudocode": "QUERY sequence-based anomaly detection model (e.g., LSTM) for user sessions with a high reconstruction error score. FILTER results for sessions that were initiated by a successful logon event using a default/shared account and involve network connections to other ICS assets."