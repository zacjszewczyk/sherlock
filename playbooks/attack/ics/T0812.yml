name: "T0812: Default Credentials"
id: "a3f8e1c2-7b6d-4a9f-8e1c-2d3b4a5c6d7e"
description: |
  This playbook helps answer the question: Is an adversary using default credentials for lateral movement within the OT network? (TA0109 - Lateral Movement). Evidence of this activity includes successful network connections to critical ICS assets (PLCs, RTUs, IEDs) using management protocols followed by authentication with known default credentials (e.g., 'admin', 'root', 'ics'). Such connections often originate from unauthorized network segments, like an IT network. For protocols without explicit authentication, the use of privileged function codes from an unauthorized source is a key indicator [1]. Another form of evidence is a successful interactive or remote logon to a high-value Windows-based OT asset (EWS, HMI, Jump Server) using a default account, which is quickly followed by the creation of a remote access process (mstsc.exe, putty.exe, Enter-PSSession) and an outbound connection to another ICS device.
type: "technique"
related:
  - "TA0109: Lateral Movement"
contributors:
  - "Zachary Szewczyk, Ask Sage"
created: "2025-10-01"
modified: "2025-10-01"
version: "1.0"
tags: "none"
questions:
  - question: "Has a successful network connection to a critical ICS asset using a management or ICS protocol been authenticated with a known default credential from an unauthorized source?"
    context: |
      This question aims to detect direct lateral movement attempts against OT devices. Adversaries often scan for and attempt to log into Programmable Logic Controllers (PLCs), Remote Terminal Units (RTUs), and other field devices using common, factory-set credentials. This rule-based approach looks for the explicit combination of a connection to a sensitive device, the use of a default username, and a source IP that is not on an approved whitelist. For protocols like Modbus or DNP3 that lack native authentication, the query identifies unauthorized sources attempting to issue privileged 'write' or 'control' commands, which is a strong indicator of compromise.
    answer_sources: |
      Zeek conn.log, Zeek ssh.log, Zeek ftp.log, Zeek telnet.log, Zeek rdp.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log, Zeek s7comm.log, Sysmon Event ID 3, ICS Asset Inventory, Network Access Control Lists (ACLs). Networks of Interest: Level 1 (Process Control) and Level 2 (Supervisory Control) networks, specifically targeting PLCs, RTUs, HMIs, IEDs, and other field devices. Also, the IT/OT DMZ (Purdue Model Level 3.5), network traffic between Engineering Workstations and Level 2/1 devices, and connections to SCADA servers and Historian databases.
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: |
          JOIN network_flows ON connection_id WITH authentication_logs
          WHERE destination_ip IN critical_ics_assets
          AND destination_port IN management_ports
          AND username IN default_credential_list
          AND source_ip NOT IN approved_whitelist
  - question: "Has a critical ICS asset experienced a successful authentication event using a default credential that is statistically rare or anomalous for that asset?"
    context: |
      This question uses a statistical, risk-based approach to identify suspicious authentications. Instead of a simple block/allow rule, it baselines normal user authentication behavior for each critical asset over a 30-day period. By calculating the frequency of each username's appearance, it can identify when a common default credential is used for the first time or with unusual rarity. An alert is triggered when a login with a default credential has a risk score (inversely proportional to its historical frequency) that falls into the top percentile, suggesting a deviation from the established norm and a potential compromise.
    answer_sources: |
      Zeek conn.log, Zeek ssh.log, Zeek ftp.log, Zeek telnet.log, Zeek rdp.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log, Zeek s7comm.log, Sysmon Event ID 3, ICS Asset Inventory, Network Access Control Lists (ACLs). Networks of Interest: Level 1 (Process Control) and Level 2 (Supervisory Control) networks, specifically targeting PLCs, RTUs, HMIs, IEDs, and other field devices. Also, the IT/OT DMZ (Purdue Model Level 3.5), network traffic between Engineering Workstations and Level 2/1 devices, and connections to SCADA servers and Historian databases.
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: |
          FOR each critical_ics_asset:
            BASELINE authentication logs over 30 days to get username frequencies
          FOR each new successful authentication:
            IF username IN default_credential_list:
              CALCULATE risk_score = 1 / (frequency + 1)
              IF risk_score > 99th_percentile_for_asset:
                ALERT
  - question: "Is there an anomalous network connection involving a default credential authentication that deviates from the learned model of normal communication patterns?"
    context: |
      This question leverages an unsupervised machine learning model to detect novel or sophisticated lateral movement attempts that might evade rule-based and statistical methods. By representing the entire network as a graph, a model like GraphSAGE can learn the complex relationships and typical communication patterns between all devices. When a new connection occurs, the model can score it for anomalousness. This approach is powerful because it doesn't rely on pre-defined rules. A high anomaly score, especially when correlated with a successful authentication using a default credential, provides a strong signal of a potential threat that does not conform to the learned network baseline.
    answer_sources: |
      Zeek conn.log, Zeek ssh.log, Zeek ftp.log, Zeek telnet.log, Zeek rdp.log, Zeek modbus.log, Zeek dnp3.log, Zeek enip.log, Zeek s7comm.log, Sysmon Event ID 3, ICS Asset Inventory, Network Access Control Lists (ACLs). Networks of Interest: Level 1 (Process Control) and Level 2 (Supervisory Control) networks, specifically targeting PLCs, RTUs, HMIs, IEDs, and other field devices. Also, the IT/OT DMZ (Purdue Model Level 3.5), network traffic between Engineering Workstations and Level 2/1 devices, and connections to SCADA servers and Historian databases.
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: |
          TRAIN GraphSAGE model on baseline network connection graph (nodes=IPs, edges=connections)
          FOR each new network connection:
            CALCULATE anomaly_score using trained model
            IF anomaly_score is high AND connection involves default_credential_auth:
              ALERT
  - question: "Has a default or shared account been used to log into a critical Windows-based OT asset, followed shortly by the use of remote access tools to connect to another ICS device?"
    context: |
      This question focuses on detecting a common adversary pivot technique within Windows-based OT environments like Engineering Workstations (EWS) or HMIs. The pattern involves an initial compromise of a host using a weak, default, or shared account. The adversary then immediately uses that access to launch a remote access tool (like RDP, SSH via PuTTY, or PowerShell Remoting) to move deeper into the OT network. This SIEM-based correlation rule specifically looks for this sequence: a successful logon (Event ID 4624) with a flagged account, followed within 5 minutes by the execution of a remote access process (Event ID 4688/4104) and a subsequent network connection to another sensitive ICS asset.
    answer_sources: |
      Windows Event ID 4624, Windows Event ID 4688, PowerShell Event ID 4104, Sysmon Event ID 1, Sysmon Event ID 3, Zeek conn.log, Zeek ssh.log, Zeek rdp.log. Networks of Interest: Engineering Workstations (EWS), Jump Servers, Remote Access Servers, SCADA Servers, and Human-Machine Interfaces (HMIs) running Windows operating systems within the Process Control Network (PCN) or IT/OT DMZ.
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: |
          TRIGGER on successful logon (WinEvent 4624) WHERE account IN default_account_list AND host IN critical_ot_assets
          CORRELATE by LogonID with process_creation (WinEvent 4688) or powershell_log (4104) for remote_access_tools within 5 minutes
          CORRELATE by source_ip and time with network_connection (Sysmon 3 or Zeek) to another ICS asset
          IF all conditions met: ALERT
  - question: "Has a user session on a critical OT server, initiated with a default or shared account, exhibited a statistically anomalous sequence of process executions or network connections?"
    context: |
      This question provides a more nuanced, behavioral approach to detecting abuse of default accounts on critical Windows servers. Rather than looking for a specific sequence, it scores the entire user session for rarity. It establishes a 30-day baseline to understand what processes and network destinations are common for a given host. When a new session starts with a default account, it calculates a risk score based on the rarity of the actions taken during that session (from logon to logoff). A session with a risk score in the top percentile indicates that the user is performing actions that are highly unusual for that host, which is a strong indicator of malicious activity.
    answer_sources: |
      Windows Event ID 4624, Windows Event ID 4688, PowerShell Event ID 4104, Sysmon Event ID 1, Sysmon Event ID 3, Zeek conn.log, Zeek ssh.log, Zeek rdp.log. Networks of Interest: Engineering Workstations (EWS), Jump Servers, Remote Access Servers, SCADA Servers, and Human-Machine Interfaces (HMIs) running Windows operating systems within the Process Control Network (PCN) or IT/OT DMZ.
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: |
          FOR each critical host:
            BASELINE process executions and network connections over 30 days to get rarity probabilities
          FOR each new user session (by LogonID) initiated with default_account:
            CALCULATE session_risk_score = SUM(-log(probability)) for each action
            IF session_risk_score > 98th_percentile_for_host:
              ALERT
  - question: "Does a user session initiated with a default account on an EWS or jump server show a high reconstruction error when analyzed by a sequence-based anomaly detection model?"
    context: |
      This question applies advanced machine learning to detect anomalous user sessions. It uses a sequence-based model, like an LSTM autoencoder, which is specifically designed to learn normal sequences of events (e.g., process A runs, then connects to server B, then process C runs). The model is trained on historical event logs from EWS and jump servers. In production, it attempts to reconstruct live user sessions. If a session initiated with a default account is highly anomalous (i.e., has a high 'reconstruction error'), it means the sequence of actions does not match any learned normal behavior. This is a powerful method for catching novel attack patterns that other methods might miss.
    answer_sources: |
      Windows Event ID 4624, Windows Event ID 4688, PowerShell Event ID 4104, Sysmon Event ID 1, Sysmon Event ID 3, Zeek conn.log, Zeek ssh.log, Zeek rdp.log. Networks of Interest: Engineering Workstations (EWS), Jump Servers, Remote Access Servers, SCADA Servers, and Human-Machine Interfaces (HMIs) running Windows operating systems within the Process Control Network (PCN) or IT/OT DMZ.
    range: "last 90 days"
    queries:
      - technology: "pseudocode"
        query: |
          TRAIN LSTM autoencoder on baseline user session event sequences
          FOR each new user session:
            CALCULATE reconstruction_error using trained model
            IF reconstruction_error is high AND session initiated with default_account:
              ALERT