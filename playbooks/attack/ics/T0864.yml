name: T0864: Transient Cyber Asset
id: e0a3b3c1-7f8e-4b2a-9d6c-5a4b3c2d1e0f
description: |
  This playbook helps determine if an adversary is leveraging a transient cyber asset (e.g., engineering laptop, diagnostic tool) for initial access into an Industrial Control System (ICS) environment. It focuses on identifying new, uninventoried devices on the network; detecting anomalous behavior from known transient assets; identifying suspicious file transfers followed by execution; and monitoring for malicious command-line activity originating from sessions associated with these transient assets. The goal is to detect unauthorized physical or network access and the subsequent actions an adversary might take using a transient device as a foothold.
type: technique
related:
  - TA0108: Initial Access
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is a new, uninventoried, and un-whitelisted device connecting to a critical ICS host?
    context: |
      This question aims to detect the initial footprint of a potentially unauthorized transient asset. By checking every new MAC or IP address against historical data and authoritative inventories (CMDB, whitelists), we can quickly identify devices that have no legitimate reason to be on the network, especially when they target critical systems like PLCs or Historians. A positive finding is a strong indicator of a potential breach or unauthorized physical/network access.
    answer_sources:
      - Zeek conn.log
      - Zeek dhcp.log
      - Network ingress/egress points for ICS zones (e.g., Level 2 Process Control Network, Level 3.5 Manufacturing Zone), especially within maintenance and engineering VLANs, IT/OT DMZ gateways, core ICS network switches, and physical ports where transient devices (e.g., engineering laptops, diagnostic tools) connect. Also, Jump Servers and Bastion Hosts within the IT/OT DMZ.
    range: last 90 days
    queries:
      - pseudocode: |
          SEARCH network logs (Zeek) for source MAC/IP.
          FOR each source:
            IF not seen in last 30 days:
              THEN SEARCH asset inventory (CMDB) and whitelists.
              IF not found, ALERT.
  - question: Has there been an anomalous surge in the number of new devices appearing on an ICS network segment?
    context: |
      This question moves from identifying a single unauthorized device to detecting broader, potentially coordinated activity. A sudden increase in the volume of new devices, even if some are legitimate, can signal a policy failure, a large-scale maintenance event being used as cover, or an attacker introducing multiple assets. Baselining this activity and alerting on statistical deviations helps to spot unusual trends that might otherwise be missed.
    answer_sources:
      - Zeek conn.log
      - Network ingress/egress points for ICS zones (e.g., Level 2 Process Control Network, Level 3.5 Manufacturing Zone), especially within maintenance and engineering VLANs, IT/OT DMZ gateways, core ICS network switches, and physical ports where transient devices (e.g., engineering laptops, diagnostic tools) connect. Also, Jump Servers and Bastion Hosts within the IT/OT DMZ.
    range: last 90 days
    queries:
      - pseudocode: |
          FOR each network segment:
            COUNT unique source MAC/IP not seen in last 7 days.
            COMPARE daily count to 60-day historical baseline.
            IF count > 99th percentile, ALERT.
  - question: Is a network connection exhibiting characteristics that are anomalous compared to historically normal traffic patterns within an ICS segment?
    context: |
      This question leverages machine learning to find the "unknown unknowns." While previous questions rely on known inventories or simple volume metrics, this one seeks to identify connections that are subtly different from the norm based on a combination of features like source/destination, protocol, duration, and data volume. An outlier could represent a new, previously unseen attack technique or a benign but undocumented change in network behavior that requires investigation.
    answer_sources:
      - Zeek conn.log
      - Network ingress/egress points for ICS zones (e.g., Level 2 Process Control Network, Level 3.5 Manufacturing Zone), especially within maintenance and engineering VLANs, IT/OT DMZ gateways, core ICS network switches, and physical ports where transient devices (e.g., engineering laptops, diagnostic tools) connect. Also, Jump Servers and Bastion Hosts within the IT/OT DMZ.
    range: last 90 days
    queries:
      - pseudocode: |
          INPUT new Zeek conn.log data into pre-trained Isolation Forest model.
          FOR each connection:
            IF anomaly score > threshold (e.g., 0.6), ALERT.
  - question: Is a known transient asset communicating with unauthorized destinations or known malicious infrastructure?
    context: |
      This question focuses on misuse of legitimate, inventoried transient assets. Even authorized devices can be compromised or misused. By strictly enforcing communication whitelists and checking all outbound connections against threat intelligence, we can detect when a legitimate tool is being used for malicious purposes, such as connecting to a C2 server or an unauthorized internal host for lateral movement.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Zeek weird.log
      - Network ingress/egress points for ICS zones, especially at the boundaries of Level 2/3.5 networks, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Historians, Programmable Logic Controllers (PLCs), Remote Terminal Units (RTUs), and network gateways connecting the Process Control Network (PCN) to corporate IT or external networks. Also, the transient asset's point of connection to the ICS network and any associated management/maintenance VLANs.
    range: last 90 days
    queries:
      - pseudocode: |
          FOR connections from known transient assets:
            CHECK destination IP/port/protocol against asset's whitelist.
            IF not in whitelist, ALERT.
            ADDITIONALLY, CHECK destination IP/domain against threat intelligence feed.
            IF match found, ALERT.
  - question: Is a known transient asset exhibiting statistically significant deviations in its communication patterns or data volume?
    context: |
      This question aims to detect subtler signs of compromise or misuse by baselining a known asset's normal behavior. An attacker using a compromised asset might try to stay "under the radar," but their activity may still create statistical anomalies. This could manifest as communication with rarely-used destinations (outside the 99% baseline) or unusual data transfers (e.g., data exfiltration) that cause a spike in traffic volume.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Zeek weird.log
      - Network ingress/egress points for ICS zones, especially at the boundaries of Level 2/3.5 networks, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Historians, Programmable Logic Controllers (PLCs), Remote Terminal Units (RTUs), and network gateways connecting the Process Control Network (PCN) to corporate IT or external networks. Also, the transient asset's point of connection to the ICS network and any associated management/maintenance VLANs.
    range: last 90 days
    queries:
      - pseudocode: |
          FOR each known transient asset:
            COMPARE new connections against 60-day baseline.
            IF destination IP/port is outside 99th percentile of historical activity, ALERT.
            CALCULATE Z-score for hourly data volume.
            IF Z-score > 3, ALERT.
  - question: Can machine learning models predict or classify the behavior of a known transient asset as anomalous?
    context: |
      This question applies more advanced machine learning techniques to model the behavior of known transient assets. Time-series forecasting (Prophet) can predict expected traffic patterns and flag deviations, while a supervised classifier (Random Forest) can learn the complex characteristics of "normal" vs. "anomalous" connections. This provides a more sophisticated and context-aware method of detecting misuse compared to simple statistical thresholds.
    answer_sources:
      - Zeek conn.log
      - Zeek dns.log
      - Zeek http.log
      - Zeek weird.log
      - Network ingress/egress points for ICS zones, especially at the boundaries of Level 2/3.5 networks, Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Historians, Programmable Logic Controllers (PLCs), Remote Terminal Units (RTUs), and network gateways connecting the Process Control Network (PCN) to corporate IT or external networks. Also, the transient asset's point of connection to the ICS network and any associated management/maintenance VLANs.
    range: last 90 days
    queries:
      - pseudocode: |
          INPUT hourly data volume and destination counts into Prophet model.
          IF observed values exceed predicted 'yhat_upper' for 3+ hours, ALERT.
          INPUT connection features into Random Forest classifier.
          IF classification is 'anomalous' with confidence > 0.75, ALERT.
  - question: Was an executable file transferred from a transient asset to an ICS host and then executed shortly after?
    context: |
      This question addresses a classic attack vector: dropping and executing a payload. By correlating network file transfer events with host-based process creation events in a tight time window (5 minutes), we can directly link the introduction of a file to its execution. This is a high-fidelity indicator of an adversary attempting to establish persistence or run malicious tools on a critical ICS host.
    answer_sources:
      - Zeek files.log
      - Zeek smb_files.log
      - Zeek http.log
      - Windows Event ID 4688
      - Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Historians, file servers, and other Windows-based servers within the Process Control Network (PCN), especially endpoints configured to accept file transfers from transient devices. Also, network segments where transient assets connect and hosts within those segments, and IT/OT DMZ file transfer zones.
    range: last 90 days
    queries:
      - pseudocode: |
          SEARCH for executable file transfers from transient asset IPs to ICS hosts.
          FOR each transfer:
            SEARCH for process creation events (ID 4688) on the destination host within 5 minutes.
            IF process name matches filename, ALERT.
  - question: Is a file being transferred from a transient asset that has a suspicious filename or an anomalous file size?
    context: |
      This question looks for indicators of obfuscation or file manipulation. Attackers often use randomized or high-entropy filenames to evade simple signature-based detection. They might also replace a legitimate, expected executable with a malicious one of a different size. By baselining normal filename characteristics (entropy) and file sizes, we can flag suspicious transfers even if the file isn't immediately executed.
    answer_sources:
      - Zeek files.log
      - Zeek smb_files.log
      - Zeek http.log
      - Windows Event ID 4688
      - Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Historians, file servers, and other Windows-based servers within the Process Control Network (PCN), especially endpoints configured to accept file transfers from transient devices. Also, network segments where transient assets connect and hosts within those segments, and IT/OT DMZ file transfer zones.
    range: last 90 days
    queries:
      - pseudocode: |
          FOR file transfers from transient assets:
            CALCULATE filename entropy.
            IF entropy > 99th percentile of baseline, ALERT.
            IF filename is known, COMPARE file size to baseline.
            IF deviation > 10%, ALERT.
  - question: Does a machine learning model classify a file transfer and subsequent execution event as malicious?
    context: |
      This question uses a holistic, machine learning-based approach to evaluate the entire "drop and execute" chain. By training a model on features from both the network (file type, size, protocol) and the host (parent process, time-to-execution), it can learn the subtle patterns that differentiate benign software updates from malicious payload delivery. This can provide a more accurate and robust detection capability than rule-based correlation alone.
    answer_sources:
      - Zeek files.log
      - Zeek smb_files.log
      - Zeek http.log
      - Windows Event ID 4688
      - Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Historians, file servers, and other Windows-based servers within the Process Control Network (PCN), especially endpoints configured to accept file transfers from transient devices. Also, network segments where transient assets connect and hosts within those segments, and IT/OT DMZ file transfer zones.
    range: last 90 days
    queries:
      - pseudocode: |
          INPUT features from file transfer (Zeek) and process creation (Win Event 4688) into pre-trained Gradient Boosting model.
          IF classification is 'malicious' with confidence > 0.85, ALERT.
  - question: Is a user session from a transient asset executing commands with suspicious keywords or issuing potentially disruptive ICS protocol commands?
    context: |
      This question focuses on detecting overtly malicious actions during an interactive session. It involves looking for known "red flag" keywords in command-line arguments (e.g., credential dumping tools, reconnaissance commands) and correlating them with a session originating from a transient asset. It also expands to the control system layer, monitoring for potentially harmful industrial protocol commands (like DNP3 or Modbus writes) that originate from these assets, especially outside of approved maintenance periods.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4624
      - Windows Event ID 4689
      - Zeek rdp.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Domain Controllers, Bastion Hosts, and other Windows-based servers within the ICS environment, particularly endpoints where transient assets establish direct or indirect interactive sessions. Also, network segments where DNP3/Modbus communications are monitored to detect effects of malicious commands.
    range: last 90 days
    queries:
      - pseudocode: |
          CORRELATE logon events (Win Event 4624, Zeek rdp.log) from transient assets with process creation events (Win Event 4688).
          SCAN command lines for suspicious keyword list.
          IF match found, ALERT.
          MONITOR ICS protocol logs (dnp3, modbus) for write commands from transient asset IPs.
          IF outside maintenance window, ALERT.
  - question: Is a transient asset session executing a novel or obfuscated command using a common administrative tool?
    context: |
      This question seeks to detect "living off the land" techniques, where attackers use legitimate system tools for malicious purposes. By baselining the typical command-line arguments for tools like PowerShell or `net.exe`, we can flag new, unseen command structures (low Jaccard similarity) or those that appear obfuscated (high entropy). This helps to identify when a legitimate tool is being used in an illegitimate way.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4624
      - Windows Event ID 4689
      - Zeek rdp.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Domain Controllers, Bastion Hosts, and other Windows-based servers within the ICS environment, particularly endpoints where transient assets establish direct or indirect interactive sessions. Also, network segments where DNP3/Modbus communications are monitored to detect effects of malicious commands.
    range: last 90 days
    queries:
      - pseudocode: |
          FOR new commands from transient asset sessions:
            CALCULATE Jaccard similarity against 90-day baseline of commands for that tool.
            IF score < 0.5, ALERT.
            CALCULATE command-line entropy.
            IF entropy > 98th percentile of baseline, ALERT.
  - question: Can machine learning models classify a command line or a sequence of process executions from a transient asset session as malicious or anomalous?
    context: |
      This question applies sophisticated ML models to analyze command-line activity and process workflows. An NLP model can learn the linguistic structure of malicious commands, going beyond simple keyword matching. An RNN can model the normal sequence of operations (e.g., a specific maintenance task) and flag any deviation from that learned workflow. This provides a powerful, context-aware method for detecting complex or novel attacker behavior during an interactive session.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4624
      - Windows Event ID 4689
      - Zeek rdp.log
      - Zeek dnp3.log
      - Zeek modbus.log
      - Engineering Workstations (EWS), Human-Machine Interfaces (HMIs), Domain Controllers, Bastion Hosts, and other Windows-based servers within the ICS environment, particularly endpoints where transient assets establish direct or indirect interactive sessions. Also, network segments where DNP3/Modbus communications are monitored to detect effects of malicious commands.
    range: last 90 days
    queries:
      - pseudocode: |
          INPUT new command lines from transient asset sessions into pre-trained NLP/Logistic Regression model.
          IF classification is 'malicious' with confidence > 0.8, ALERT.
          INPUT sequence of process creations into pre-trained RNN model.
          IF sequence probability is low, ALERT.