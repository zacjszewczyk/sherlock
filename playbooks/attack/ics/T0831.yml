name: T0831: Spoof Reporting Message
id: f4b1b3a0-6234-45e1-8f92-5a9b8d7c6e5f
description: This playbook addresses the threat of an adversary manipulating an operator's view of the industrial process (MITRE ATT&CK Tactic TA0105 - Impact). This is achieved by detecting various techniques an adversary might use to spoof reporting messages and manipulate what the operator sees on an HMI. The playbook provides investigative questions to detect network-level anomalies indicative of Man-in-the-Middle (MitM) attacks, such as ARP spoofing or duplicate MAC addresses. It also covers the detection of anomalous ICS protocol messages, such as unsolicited responses or values that are physically implausible. Furthermore, it includes checks for unauthorized or statistically unusual write commands, modifications to HMI application programs and graphical configuration files, and discrepancies between process values reported by the PLC versus those recorded by the historian or displayed on the HMI. The overall goal is to identify any action that could lead to a disconnect between the true state of the physical process and the operator's perception of it.
type: technique
related:
  - TA0105: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Are there any unauthorized or unexpected IP-to-MAC address mappings for critical ICS assets on the network?
    context: This question aims to detect Man-in-the-Middle (MitM) precursors. An adversary might spoof the MAC address of a critical device (like a PLC or HMI) to intercept or inject traffic. By comparing real-time network mappings against a known-good whitelist and monitoring for suspicious ARP activity (like spoofing notices or duplicate IP detections), analysts can identify attempts to compromise network integrity at Layer 2, which is a common setup for spoofing reporting messages.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek arp.log
      - Process control network segments connecting PLCs, HMIs, and other critical control system devices within the Operational Technology (OT) network.
    range: last 90 days
    queries:
      - "[pseudocode] SEARCH Zeek arp.log and conn.log FOR IP-MAC pairs of critical assets. COMPARE against whitelist. ALERT on mismatch. SEARCH Zeek notice.log FOR 'ARP::Spoofing' or 'ARP::Duplicate_IP_Detected'."
  - question: Is any critical ICS device IP address associated with more than one MAC address simultaneously?
    context: In a stable OT network, a critical device's IP address should consistently map to a single MAC address. The sudden appearance of a second MAC address associated with that same IP is a strong statistical indicator of an ARP spoofing or MitM attack, where an attacker's machine is trying to impersonate the legitimate device. This question helps detect such anomalies by baselining the normal one-to-one relationship and alerting on any deviation.
    answer_sources:
      - Zeek conn.log
      - Zeek arp.log
      - Process control network segments connecting PLCs, HMIs, and other critical control system devices within the Operational Technology (OT) network.
    range: last 90 days
    queries:
      - "[pseudocode] FOR each critical_IP: BASELINE count of distinct MACs over 24h (should be 1). IN sliding 5-min window, COUNT distinct MACs from conn.log and arp.log. ALERT if count > 1."
  - question: Have there been any anomalous structural changes in the network communication graph involving critical assets?
    context: This question uses advanced machine learning to model the network's normal state. OT network communication patterns are typically very predictable. A graph neural network (GNN) can learn this normal topology. An alert for a structural anomaly, like a new, unexpected connection between a critical asset's IP and an unknown MAC address, can pinpoint a sophisticated MitM attack that might be missed by simpler rule-based checks.
    answer_sources:
      - Zeek conn.log
      - Zeek arp.log
      - Process control network segments connecting PLCs, HMIs, and other critical control system devices within the Operational Technology (OT) network.
    range: last 90 days
    queries:
      - "[pseudocode] TRAIN GNN on historical Zeek conn.log and arp.log data to learn normal network graph. DEPLOY model to analyze real-time graph structure. ALERT on anomalous new edges, especially those involving critical IPs and unknown MACs."
  - question: Are we observing ICS protocol responses that do not have a corresponding request from an authorized device, or are any reporting messages coming from an unapproved source IP?
    context: This question focuses on validating the legitimacy of ICS communications at the protocol level. In a typical request-response protocol like Modbus, a PLC should only send a response message after receiving a request from an authorized HMI or historian. An unsolicited response is a red flag for a spoofed message. This check ensures that all communications adhere to the expected protocol state and originate from whitelisted, trusted sources.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Zeek conn.log
      - Network gateways between control zones, and network taps monitoring traffic to and from HMIs and Historian servers.
    range: last 90 days
    queries:
      - "[pseudocode] CACHE transaction_ids from HMI/historian requests. FOR each PLC response, CHECK if transaction_id was requested by whitelisted source. ALERT if no matching request is found. ALSO, ALERT if any reporting message source IP is not on the PLC whitelist."
  - question: Are any reported process values physically implausible or deviating significantly from their historical rate of change without a corresponding control action?
    context: An adversary spoofing a reporting message may inject values that, while syntactically correct, are physically nonsensical. For example, a tank level cannot instantly jump from 20% to 80%. This question seeks to apply process physics and statistical analysis to the reported data. By baselining the normal rate of change for a process variable, we can detect and alert on sudden, unrealistic jumps that indicate the reported value may not reflect the true physical state.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Network gateways between control zones, and network taps monitoring traffic to and from HMIs and Historian servers.
    range: last 90 days
    queries:
      - "[pseudocode] FOR each critical process tag: MAINTAIN time-series of values. ON new value, CALCULATE deviation from historical rate-of-change. ALERT if deviation > 3 standard deviations, especially if no recent write command was logged for that tag."
  - question: Are the sequences of ICS protocol transactions between HMIs and PLCs consistent with historically normal patterns?
    context: This question uses a sequence-aware machine learning model to detect subtle deviations in communication patterns. An attacker might inject a single spoofed message that breaks the normal conversational flow between an HMI and a PLC. A model like an LSTM can learn the valid sequences of requests and responses, including timing and function codes, and flag any transaction that appears out of order or context, such as a response without a request.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Zeek conn.log
      - Network gateways between control zones, and network taps monitoring traffic to and from HMIs and Historian servers.
    range: last 90 days
    queries:
      - "[pseudocode] TRAIN sequence model (LSTM) on normal request-response sequences from Zeek logs (features: IPs, function codes, timing). DEPLOY model to score new transactions. ALERT on transactions with high anomaly scores, indicating a break in the learned sequence."
  - question: Are there any ICS write commands originating from unauthorized sources or attempting to set process variables to unsafe values?
    context: This question aims to detect the malicious use of legitimate ICS protocols. An adversary might use standard write commands to manipulate a process. This check validates every write command against two critical criteria: 1) Did it come from an authorized device (HMI/EWS)? 2) Is the value being written within pre-defined safe engineering limits? An alert on either condition can indicate an attempt to cause a disruptive or unsafe state.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Network interfaces of PLCs and other field controllers, particularly on segments accessible by engineering workstations and HMIs.
    range: last 90 days
    queries:
      - "[pseudocode] ON ICS write command (e.g., Modbus FC 5,6,15,16): CHECK if source IP is in HMI/EWS whitelist for the destination PLC. ALERT if not. CHECK if written value is within safe limits for the target register. ALERT if not."
  - question: Is the frequency or value of ICS write commands statistically anomalous compared to historical behavior?
    context: Beyond simple whitelisting, this question looks for behavioral anomalies. An attacker might use an authorized workstation but issue commands at an unusual rate or set a variable to a value that is valid but statistically rare. By baselining the normal frequency of write commands and the typical distribution of written values, we can detect outliers that suggest a compromised system or malicious insider activity.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Network interfaces of PLCs and other field controllers, particularly on segments accessible by engineering workstations and HMIs.
    range: last 90 days
    queries:
      - "[pseudocode] FOR each HMI-PLC pair: PROFILE hourly write command count from baseline. ALERT if current hour count > 99th percentile. FOR each register: ALERT if written value is > 4 standard deviations from historical value distribution."
  - question: Can machine learning classify any ICS write commands as suspicious based on contextual features?
    context: This question applies a supervised machine learning model to provide a more nuanced risk assessment of write commands. By training on labeled historical data, the model can learn complex patterns that distinguish between benign and malicious operations, considering features like source, destination, function code, value, and time of day. This allows for the detection of sophisticated attacks that might appear legitimate to simpler rule-based systems.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Network interfaces of PLCs and other field controllers, particularly on segments accessible by engineering workstations and HMIs.
    range: last 90 days
    queries:
      - "[pseudocode] TRAIN classification model (e.g., Random Forest) on labeled ICS write commands using features like IP, function, value, time. DEPLOY model to classify new write commands in real-time. FLAG 'suspicious' commands for analyst review."
  - question: Have any critical HMI project or application files been modified by an unauthorized process or user?
    context: This question aims to protect the integrity of the HMI software itself. An adversary might modify HMI project files to alter the operator's view or embed malicious logic. By implementing file integrity monitoring (FIM) with a strict whitelist of approved modifying processes (e.g., the HMI editor) and users, we can immediately detect and alert on any unauthorized changes to these critical files.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4663
      - Windows Event ID 4656
      - File systems of HMI application servers, engineering workstations, and historian servers, specifically monitoring application directories and configuration folders.
    range: last 90 days
    queries:
      - "[pseudocode] MONITOR Windows Event ID 4663 (File Write) in HMI directories. CORRELATE ProcessId with Event ID 4688. ALERT if the modifying process name, hash, or user SID is not on the approved whitelist."
  - question: Is there an anomalously high variety of processes modifying HMI project files?
    context: In a normal environment, only a very small, predictable set of processes should ever modify HMI files. This question uses Shannon entropy to measure the randomness or variety of process names involved in these modifications. A sudden spike in this entropy score indicates that many different, potentially unauthorized, processes are writing to these sensitive directories, which is a strong sign of malicious activity.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4663
      - File systems of HMI application servers, engineering workstations, and historian servers, specifically monitoring application directories and configuration folders.
    range: last 90 days
    queries:
      - "[pseudocode] CALCULATE Shannon entropy of process names (from Event ID 4688) that modify HMI files (from Event ID 4663) in a sliding window. BASELINE the 95th percentile. ALERT if entropy score spikes above the threshold."
  - question: Are there any abnormal process execution chains leading to the modification of HMI files?
    context: This question looks for suspicious parent-child process relationships. Legitimate modifications to HMI files are typically initiated directly by an engineer running the HMI editor software. An attacker, however, might use a more convoluted chain, such as a compromised service spawning a command shell to run a script that modifies the files. A sequence analysis model can learn the normal execution chains and flag these anomalous sequences as high-risk.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4663
      - File systems of HMI application servers, engineering workstations, and historian servers, specifically monitoring application directories and configuration folders.
    range: last 90 days
    queries:
      - "[pseudocode] TRAIN sequence model (HMM) on normal process execution chains (ParentProcessName -> ProcessName from Event ID 4688). FLAG anomalous chains, especially those that result in HMI file modification (Event ID 4663), as high-risk."
  - question: Is there a significant discrepancy between the process value reported by the PLC and the value recorded by the historian or displayed on the HMI?
    context: This question directly targets a 'manipulation of view' attack by comparing data from different points in the control system. The value read directly from the PLC is the 'ground truth'. If the value recorded by the historian or sent to the HMI network differs significantly, it implies that data is being manipulated somewhere in between, likely by a MitM attack. This cross-source validation is a powerful method for detecting data spoofing.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Zeek conn.log
      - HMI servers, Historian servers, and network segments connecting PLCs to HMIs and Historians, focusing on data gateways and visualization platforms.
    range: last 90 days
    queries:
      - "[pseudocode] FOR critical tags: CORRELATE value from PLC response logs with value sent to historian/HMI for the same timestamp. ALERT if values differ by more than a predefined threshold (e.g., 2%)."
  - question: Has the statistical correlation between the PLC-reported data and the historian-recorded data degraded over time?
    context: This question provides a continuous, statistical measure of data integrity. Under normal conditions, the time series of data from the PLC and the historian should be almost perfectly correlated. A drop in the Pearson correlation coefficient indicates that the two data streams are diverging. This sustained statistical drift is a strong indicator of a subtle, ongoing manipulation of view attack.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Zeek conn.log
      - HMI servers, Historian servers, and network segments connecting PLCs to HMIs and Historians, focusing on data gateways and visualization platforms.
    range: last 90 days
    queries:
      - "[pseudocode] CREATE two time series for each tag: (1) PLC-reported value, (2) Historian-recorded value. CALCULATE rolling 10-min Pearson correlation between them. ALERT if correlation drops below a threshold (e.g., 0.9) for a sustained period."
  - question: Does a machine learning model detect a statistical anomaly in the relationship between PLC, HMI, historian, and control output values?
    context: This question uses an unsupervised autoencoder model to learn the complex, normal relationships between multiple related data points (PLC value, HMI value, etc.). The model can detect subtle inconsistencies that might be missed by simple pairwise comparisons. A high reconstruction error from the model signifies that the current state of the system does not match the learned normal behavior, pointing to a potential manipulation attack.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Zeek conn.log
      - HMI servers, Historian servers, and network segments connecting PLCs to HMIs and Historians, focusing on data gateways and visualization platforms.
    range: last 90 days
    queries:
      - "[pseudocode] TRAIN autoencoder on feature vectors [PLC_value, HMI_value, Historian_value, Control_output]. DEPLOY model to calculate reconstruction error on new data. ALERT on high reconstruction error."
  - question: Have any HMI graphical configuration or project files been modified by an unapproved application?
    context: This question focuses on protecting the integrity of the HMI's visual components and configuration. An attacker could modify these files to hide an alarm, change a display to show a false safe value, or add malicious scripts. This rule-based check provides a first line of defense by ensuring that only authorized, whitelisted HMI editing software can make changes to these sensitive files.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - File systems on HMI servers and engineering workstations, specifically directories containing HMI screen and logic configuration files.
    range: last 90 days
    queries:
      - "[pseudocode] MONITOR Event ID 4663 for writes to HMI file types (.gfx, .pvi). CORRELATE with parent process via Event ID 4688. ALERT if process name or hash is not on the approved software whitelist."
  - question: Is the frequency of modifications to HMI configuration files abnormally high for a specific user, host, or process?
    context: Even if modifications are made by an authorized user or process, an unusually high frequency of changes can be suspicious. An attacker who has compromised a legitimate account might make many rapid changes while experimenting or deploying their attack. This question establishes a behavioral baseline for modification activity and alerts on statistical outliers, which could indicate malicious use of a legitimate account.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - File systems on HMI servers and engineering workstations, specifically directories containing HMI screen and logic configuration files.
    range: last 90 days
    queries:
      - "[pseudocode] BASELINE modification frequency (Event ID 4663 count) per user/host/process. ALERT if the 24-hour count for any entity exceeds the 99th percentile of its historical behavior."
  - question: Does a UEBA model detect any deviation from the normal behavior of users or processes interacting with HMI configuration files?
    context: This question employs a comprehensive UEBA model to detect sophisticated threats. The model learns the normal context of file modifications, including who, what, where, when, and how. It can then flag deviations from this multi-faceted baseline. For example, it could detect an administrator using PowerShell to modify HMI files late at night, which is highly anomalous compared to the normal behavior of an engineer using the HMI editor during business hours.
    answer_sources:
      - Windows Event ID 4663
      - Windows Event ID 4688
      - File systems on HMI servers and engineering workstations, specifically directories containing HMI screen and logic configuration files.
    range: last 90 days
    queries:
      - "[pseudocode] DEPLOY UEBA model trained on normal user/process file access patterns (file paths, frequency, time of day, process name). ALERT on significant deviations from the learned baseline for HMI file modifications."