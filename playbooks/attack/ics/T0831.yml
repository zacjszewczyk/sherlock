name: T0831: Manipulation of Control
id: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
description: This playbook helps identify adversarial manipulation of Industrial Control Systems (ICS). It focuses on detecting unauthorized 'write' commands, anomalous changes to process setpoints, network-level indicators of spoofing or Man-in-the-Middle (MitM) attacks, and malicious process execution on critical OT systems. The goal is to uncover attempts by adversaries to either directly cause a physical impact by altering control logic or to manipulate an operator's view of the process, potentially hiding a physical attack or causing incorrect operator responses.
type: technique
related:
  - TA0105: Impact
contributors:
  - Zachary Szewczyk
  - Ask Sage
created: 2025-10-01
modified: 2025-10-01
version: 1.0
tags: none
questions:
  - question: Is an ICS 'write' command being issued from an unauthorized source, by an unauthorized user, or at an unusual time?
    context: This question aims to detect direct, unauthorized manipulation commands. By checking the command's source IP against an allowlist, the initiating user account against authorized Active Directory groups, and the timing against documented operational windows, we can identify commands that violate established policies and may represent a malicious actor's attempt to alter a physical process.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Zeek s7comm.log
      - Windows Event ID 4624
      - Data Historian Logs
      - Engineering Workstations (EWS) on the Process Control Network (PCN)
      - Human-Machine Interfaces (HMIs) on the PCN
      - Level 1 and 2 Network Segments (containing PLCs, RTUs, IEDs)
      - Data Historian Servers
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH ICS protocol logs for 'write' commands. FOR EACH command, GET source IP and timestamp. CORRELATE IP and time with Windows logon events (Event ID 4624) to find user. ALERT if source IP not in target's allowlist OR user not in 'ICS_Operators' AD group OR time is outside operational hours.
  - question: Is a critical process setpoint being changed at a statistically anomalous rate or frequency?
    context: This question focuses on detecting manipulation through unusual behavior, even from an otherwise authorized source. Adversaries may try to make subtle but impactful changes. By comparing the rate of change and modification frequency of setpoints against a historical 99th percentile baseline, we can flag statistically significant deviations that could indicate a deliberate and potentially harmful manipulation attempt.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Zeek s7comm.log
      - Windows Event ID 4624
      - Data Historian Logs
      - Engineering Workstations (EWS) on the Process Control Network (PCN)
      - Human-Machine Interfaces (HMIs) on the PCN
      - Level 1 and 2 Network Segments (containing PLCs, RTUs, IEDs)
      - Data Historian Servers
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH data historian for writes to critical tags. FOR EACH write, CALCULATE rate of change (value delta/min) and hourly write frequency. COMPARE to 90-day baseline for that tag. ALERT if rate or frequency > 99th percentile.
  - question: Does a setpoint modification event deviate from complex, learned patterns of normal operational behavior?
    context: This question uses a multivariate machine learning model to find sophisticated anomalies that simpler statistical checks might miss. A model can consider multiple factors simultaneously (e.g., setpoint value, time of day, source IP, user) to build a rich understanding of 'normal'. An event with a high anomaly score suggests a combination of factors that is highly unusual and warrants investigation for complex manipulation.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Zeek s7comm.log
      - Windows Event ID 4624
      - Data Historian Logs
      - Engineering Workstations (EWS) on the Process Control Network (PCN)
      - Human-Machine Interfaces (HMIs) on the PCN
      - Level 1 and 2 Network Segments (containing PLCs, RTUs, IEDs)
      - Data Historian Servers
      - Active Directory Domain Controllers
    range: last 90 days
    queries:
      - technology: pseudocode
        query: INPUT new write events (value, time, source IP, user) into trained anomaly detection model (e.g., Isolation Forest). ALERT if anomaly score > threshold (e.g., 0.9).
  - question: Is a device that is unknown, or designated as 'read-only', attempting to issue a 'write' or 'control' command?
    context: This question aims to identify control commands originating from illegitimate or misconfigured devices. An authoritative asset inventory defines which devices are allowed to perform control actions. Any 'write' command from an IP/MAC address not in the inventory or explicitly marked as 'read-only' is a high-fidelity indicator of a rogue device or a compromised asset being used for unauthorized purposes.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Zeek s7comm.log
      - Network switches and routers within Level 1 and Level 2
      - Industrial DMZ (IDMZ) gateways
      - Firewalls segmenting IT and OT networks
      - SCADA Servers
      - Management Workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH ICS protocol logs for 'write'/'control' commands. FOR EACH command, GET source IP/MAC. QUERY asset inventory for source. ALERT if source not found OR source role is 'read-only'.
  - question: Is the diversity of sources sending control commands to a critical device increasing suspiciously?
    context: This question seeks to detect abnormal changes in control patterns. A critical device like a PLC should typically receive commands from a small, stable set of HMIs or servers. A sudden increase in the variety of source IPs, measured by a significant rise in Shannon entropy, suggests that new, potentially unauthorized systems are attempting to take control, which could be a precursor to or part of a manipulation attack.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Zeek s7comm.log
      - Network switches and routers within Level 1 and Level 2
      - Industrial DMZ (IDMZ) gateways
      - Firewalls segmenting IT and OT networks
      - SCADA Servers
      - Management Workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR EACH critical device, CALCULATE Shannon entropy of source IPs for 'write' commands in a 1-hour window. COMPARE to 30-day baseline entropy. ALERT if current entropy > (mean + 3 * standard deviation) of baseline.
  - question: Is a 'write' command originating from a device that does not normally issue control commands?
    context: This question uses graph-based anomaly detection to identify illicit communication pathways. By modeling the OT network, we can learn which devices (nodes) normally form a 'subgraph' of authorized control operations. A 'write' command that creates a new connection (edge) from a node outside this learned subgraph is a strong indicator of a compromised or rogue device attempting to manipulate the process.
    answer_sources:
      - Zeek conn.log
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek enip.log
      - Zeek s7comm.log
      - Network switches and routers within Level 1 and Level 2
      - Industrial DMZ (IDMZ) gateways
      - Firewalls segmenting IT and OT networks
      - SCADA Servers
      - Management Workstations
    range: last 90 days
    queries:
      - technology: pseudocode
        query: INPUT new 'write' command (source IP, dest IP) into a trained graph anomaly model of the network. ALERT if the model flags the communication edge as an anomaly not part of the learned 'authorized control' subgraph.
  - question: Has a high-risk process related to ICS control been executed from an unauthorized context on a critical endpoint?
    context: This question looks for malicious software execution on critical HMIs or EWSs. Adversaries may use legitimate ICS tools or scripting utilities for malicious ends. This activity can be detected by checking if a high-risk process (e.g., powershell.exe, plccmd.exe) was launched by an unexpected parent process or initiated within a non-interactive network session (Logon Type 3), which is abnormal for operator-driven actions.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4624
      - Windows Event ID 4648
      - Human-Machine Interfaces (HMIs) on the PCN
      - Engineering Workstations (EWS) on the PCN
      - SCADA Servers
      - Remote Access Servers (RAS)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH for process creation (Event 4688) of high-risk executables. CORRELATE with logon event (4624) to get session type. ALERT if ParentProcessName is not on whitelist OR Logon Type is 3 (network) and not from a legitimate admin tool.
  - question: Has a historically rare parent-child process relationship involving an ICS tool or interpreter occurred?
    context: This question aims to detect novel or unusual execution chains that may indicate adversarial activity. By baselining all normal parent-child process relationships, we can identify new process creations that are statistical outliers (e.g., in the bottom 1st percentile of frequency). Such rare events, especially when the child process is a powerful ICS utility or scripting tool, are highly suspicious and warrant investigation.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4624
      - Windows Event ID 4648
      - Human-Machine Interfaces (HMIs) on the PCN
      - Engineering Workstations (EWS) on the PCN
      - SCADA Servers
      - Remote Access Servers (RAS)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR EACH new process creation (Event 4688), look up the historical frequency of the (parent, child) pair from a 30-day baseline. ALERT if the frequency is in the bottom 1st percentile, especially if the child is an ICS tool.
  - question: Does a process execution event on an HMI or EWS match the characteristics of known malicious activity?
    context: This question uses a machine learning classifier to proactively identify malicious process executions. By training a model on features like process name, parent process, command-line arguments, and user context, the system can score new events in real-time. A high suspicion score, particularly for a process with command-line arguments containing ICS-related keywords, provides a strong, context-aware signal of potential manipulation.
    answer_sources:
      - Windows Event ID 4688
      - Windows Event ID 4624
      - Windows Event ID 4648
      - Human-Machine Interfaces (HMIs) on the PCN
      - Engineering Workstations (EWS) on the PCN
      - SCADA Servers
      - Remote Access Servers (RAS)
    range: last 90 days
    queries:
      - technology: pseudocode
        query: INPUT process creation features (process name, parent, command line entropy, etc.) into a trained classification model. ALERT if classification is 'suspicious' with confidence > 0.9.
  - question: Is there evidence of ARP spoofing or other Man-in-the-Middle precursors on the OT network?
    context: This question seeks to detect network-level setup for a view manipulation attack. An adversary might use ARP spoofing to place themselves between a PLC and an HMI. This can be detected by monitoring for inconsistencies in IP-to-MAC address mappings, such as a critical asset's IP suddenly being associated with a new MAC address, or by direct alerts for duplicate MACs or spoofing from network sensors.
    answer_sources:
      - Zeek conn.log
      - Zeek notice.log
      - Zeek arp.log
      - Process control network segments connecting PLCs, HMIs, and other critical control system devices within the Operational Technology (OT) network.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: SEARCH Zeek logs for IP-to-MAC mappings. COMPARE current mappings against a static whitelist for critical assets. ALERT if a mapping contradicts the whitelist or if Zeek generates an 'ARP::Spoofing' notice.
  - question: Is a critical process state report originating from an unauthorized or unexpected source?
    context: This question aims to detect spoofed process data intended to manipulate the operator's view. By implementing stateful protocol analysis, we can verify that every PLC response corresponds to a legitimate request from an authorized HMI or historian. An unsolicited response, or a response from a device not known to be a PLC, is a strong indicator of a spoofing attack.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Zeek conn.log
      - Network gateways between control zones, and network taps monitoring traffic to and from HMIs and Historian servers.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR EACH PLC response message, CHECK for a corresponding request from a whitelisted HMI/historian IP within a timeout window. ALERT if no corresponding request is found OR if the response originates from an IP not on the PLC allowlist.
  - question: Is a reported process value physically implausible or inconsistent with recent control actions?
    context: This question seeks to identify manipulated process values by checking them against physical reality. A spoofed value may represent a sudden, drastic change that is not physically possible or does not align with recent control commands. By comparing a new value to the established rate of change for that process point, we can flag deviations that are statistically improbable (e.g., >3 standard deviations) and likely indicate a falsified report.
    answer_sources:
      - Zeek modbus.log
      - Zeek dnp3.log
      - Zeek s7comm.log
      - Zeek conn.log
      - Network gateways between control zones, and network taps monitoring traffic to and from HMIs and Historian servers.
    range: last 90 days
    queries:
      - technology: pseudocode
        query: FOR EACH new process value reported, CALCULATE its deviation from the historical rate of change for that tag. ALERT if the change is > 3 standard deviations from the mean rate, especially if no recent 'write' command was logged for that tag.