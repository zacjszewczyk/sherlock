[
  {
    "Is the adversary attempting to evade detection by modifying process trees? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1036.009 - Break Process Trees": {
          "Process creation events where the parent process ID is PID 1 for a process that is not a standard service or system process.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect Windows Event ID 4688 logs. Filter for events where 'ParentProcessId' is '1'. Identify the 'NewProcessName' and 'CommandLine' for these events. Compare against a baseline of expected processes legitimately parented by PID 1. Flag unexpected processes for investigation using descriptive statistics of parent processes over time to identify outliers."
          },
          "Process creation events where the parent process ID is zero or does not correspond to a currently running process.": {
            "Data": "Windows Event ID 4688, Windows Event ID 4689",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect Windows Event ID 4688 logs, recording 'ProcessId' and 'ParentProcessId'. Collect Windows Event ID 4689 logs (Process Termination), recording 'ProcessId'. Correlate termination events with process creation events to identify active processes whose reported parent process (from 4688) has terminated (identified in 4689). Alternatively, filter 4688 logs for 'ParentProcessId' values that are zero or do not exist in the set of currently active ProcessIds. Use correlation analysis to link process creation and termination events and identify potential orphaned processes."
          }
        }
      }
    }
  }
]