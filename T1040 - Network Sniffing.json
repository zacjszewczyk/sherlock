[
  {
    "Is the adversary attempting to capture credentials via network sniffing? (TA0006 - Credential-Access)": {
      "Indicators": {
        "T1040 - Network Sniffing": {
          "Presence of tools or configurations indicative of network sniffing (e.g., promiscuous mode enabled, suspicious packet capture files).": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for creation of known network sniffing tools (e.g., Wireshark, tcpdump, kismet). Analyze Zeek conn.log for unusual outbound connections from hosts running these processes. Use correlation analysis to link process creation events with network traffic patterns."
          },
          "Detection of ARP spoofing or gratuitous ARP broadcasts on the network.": {
            "Data": "Zeek arp.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek arp.log for gratuitous ARP broadcasts or conflicting ARP entries. Detect multiple ARP responses for the same IP address from different MAC addresses within a short time window. Use time series analysis to identify bursts of unusual ARP activity."
          },
          "Network traffic containing credentials transmitted over unencrypted protocols (e.g., Telnet, FTP, SMBv1, HTTP Basic Auth).": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek ftp.log; Zeek telnet.log; Zeek smb.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek logs (conn.log, http.log, ftp.log, telnet.log, smb.log) for connections using known unencrypted credential-passing protocols (e.g., default ports for Telnet 23, FTP 21, HTTP 80 without TLS, SMBv1). Analyze application layer data in http.log (Authorization headers) and smb.log for signs of authentication over insecure connections. Filter conn.log for these ports and analyze payload if possible, or correlate with other logs confirming application use. Calculate the frequency of such connections and flag outliers or connections to sensitive targets using descriptive statistics."
          },
          "Anomalous DNS or NetBIOS traffic patterns potentially indicating name service poisoning attempts (LLMNR/NBT-NS Poisoning).": {
            "Data": "Zeek dns.log; Zeek dcerpc.log; Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek dns.log for unusual query types, responses, or repeated queries for non-existent hosts originating from internal IPs. Monitor Zeek dcerpc.log and conn.log (ports 137/138 UDP, 139/445 TCP) for high volumes of NetBIOS or SMB-related traffic directed at multiple hosts within a short timeframe, potentially indicating responses to poisoned requests. Use frequency analysis and correlation to identify hosts sending/receiving anomalous volumes of name service traffic."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  },
  {
    "Is the adversary gathering network information via network sniffing? (TA0007 - Discovery)": {
      "Indicators": {
        "T1040 - Network Sniffing": {
          "Suspicious network traffic patterns suggesting data exfiltration related to captured network configuration details.": {
            "Data": "Zeek conn.log; Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and http.log for unusual outbound data volume or connections to suspicious external destinations from hosts that might have captured data. Use descriptive statistics (e.g., byte volume per flow, frequency of connections to external IPs) and compare against historical baseline to identify anomalies using methods like IQR or percentile analysis."
          },
          "Anomalous access attempts or activity on network device management interfaces, potentially preceding sniffing configuration changes.": {
            "Data": "Zeek conn.log; Zeek ssl.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections on network device management ports (e.g., 22, 23, 443, 80) targeting network infrastructure IPs. Identify connections from unusual source IPs, times, or authentication failures (if visible in Zeek ssl.log or other relevant logs). Use frequency analysis and behavioral profiling based on historical data to flag anomalous management access attempts."
          },
          "Discovery of reconnaissance traffic patterns originating from a potentially compromised host, based on sniffed network configuration details.": {
            "Data": "Zeek conn.log; Zeek dns.log; Zeek http.log; Zeek ssl.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "From identified potentially compromised hosts (via other detections), analyze outbound network traffic patterns using Zeek logs (conn.log, dns.log, http.log, ssl.log). Look for rapid scanning behavior (many connections to different IPs/ports - conn.log), numerous DNS queries for internal hosts (dns.log), or web requests revealing network topology (http.log, ssl.log subject/issuer common names). Use correlation analysis and time series analysis to identify bursts of reconnaissance traffic."
          },
          "Detection of software execution or network connections associated with accessing or exfiltrating data from cloud traffic mirrors or network device packet captures.": {
            "Data": "Windows Event ID 4688; Zeek conn.log; Zeek http.log; Zeek ssl.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for processes related to cloud provider CLIs (`aws.exe`, `gcloud.cmd`, `az.ps1`) or data transfer tools (`curl`, `wget`, `pscp`). Correlate execution of these processes with network connections in Zeek logs (conn.log) to cloud provider endpoints or external data repositories. Analyze Zeek http.log/ssl.log for large outbound data transfers or interactions with APIs potentially related to traffic mirroring services. Use correlation analysis and descriptive statistics (data volume per connection/host) to identify suspicious activity."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]