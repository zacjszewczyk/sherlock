[
  {
    "Is the adversary maintaining persistence by creating cloud accounts? (TA0003 - Persistence)": {
      "Indicators": {
        "T1136.003 - Cloud Account": {
          "Successful logins using accounts not previously seen or associated with known users/systems, potentially corresponding to newly created cloud accounts accessing on-prem resources.": {
            "Data": "Windows Event ID 4624; Zeek conn.log",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Baseline legitimate user account login activity. Identify successful logins (Event ID 4624) or network connections (Zeek conn.log) using account names that do not match known on-premise users or systems. Cross-reference these accounts with HR/IT onboarding records. Use descriptive statistics and anomaly detection (e.g., clustering or outlier analysis) to flag accounts with zero prior activity exhibiting sudden successful logins or unusual access patterns."
          },
          "Network connections originating from resources (VMs, containers) exhibiting communication patterns or destinations indicative of malicious activity, potentially using newly created cloud service accounts.": {
            "Data": "Zeek conn.log; Windows Event ID 4688",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections originating from cloud-based IP ranges or resource names. Analyze destination IPs, ports, and protocols. Use correlation analysis to identify suspicious communication patterns (e.g., connections to known C2 servers, unexpected outbound traffic). On Windows hosts, monitor Event ID 4688 for unusual processes initiating network connections that might be related to compromised cloud resources."
          },
          "Successful administrative network logons (e.g., RDP, network share access) on sensitive systems by accounts not part of documented on-prem administrative groups or exhibiting 'cloud sync' properties.": {
            "Data": "Windows Event ID 4624; Zeek conn.log",
            "Data Platform": "Servers; Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect Windows Event ID 4624 on sensitive servers. Filter for successful network logons (Type 3 or 10). Correlate the logging 'Account_Name' or 'Subject.Sid' with documented on-prem administrative group memberships (e.g., Domain Admins, Local Administrators). Identify accounts not in these groups or showing characteristics of cloud-synced accounts (if distinguishable in logs). Use frequency analysis to identify accounts with low historical login frequency on sensitive systems suddenly logging in with administrative-like access. Investigate such logons for potential persistence."
          },
          "Unexpected inbound or internal connections from cloud-based resources or IPs to internal network systems on non-standard ports or protocols.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections where the source IP falls within known cloud provider ranges (AWS, Azure, GCP) and the destination is within the internal network. Establish a baseline of legitimate cloud-to-internal communication flows (ports, protocols, destination systems). Use frequency distribution and percentile analysis on destination ports/protocols to identify connections deviating from the established baseline (e.g., low-frequency destination ports, unusual protocol usage). Flag connections from cloud IPs to internal systems on non-standard or unexpected ports/protocols for potential persistence via compromised cloud accounts or resources."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]