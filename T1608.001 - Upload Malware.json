[
  {
    "Has the adversary prepared infrastructure to support their attack? (TA0042 - Resource Development)": {
      "Indicators": {
        "T1608.001 - Upload Malware": {
          "Ingress of files via common web protocols (HTTP/HTTPS) matching known malware characteristics or originating from suspicious external sources.": {
            "Data": "Zeek http.log; Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek http.log for file downloads (GET requests for executable/archive file extensions). Analyze Zeek conn.log for connections to known suspicious IPs or domains (e.g., from threat intelligence feeds updated within at least 30 days). Use frequency analysis on source IPs/domains downloading files. Identify rare file types downloaded."
          },
          "Execution of suspicious files downloaded from external sources, followed by anomalous network connections.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation, specifically processes spawned from potentially suspicious parent processes (e.g., web browsers, email clients) or with unusual command-line arguments/paths. Correlate new process creation events with subsequent outbound connections in Zeek conn.log to rare or suspicious destination IPs/ports within a short time window. Use correlation analysis to link process activity and network connection events."
          },
          "Execution of file packaging or encryption utilities followed by outbound connections to external file hosting/cloud services.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation related to common archiving (e.g., rar.exe, 7z.exe, zip.exe) or encryption utilities (e.g., gpg.exe, openssl.exe). Correlate events where these processes are executed with subsequent outbound connections in Zeek conn.log to known cloud storage providers (e.g., Dropbox, Google Drive, specific file hosting services) or IPs not typically accessed by the user/host. Use correlation analysis to link process execution and network connections within a short time window."
          },
          "Outbound connections from internal hosts to external IPs/domains known or suspected to host adversary infrastructure or staged malware.": {
            "Data": "Zeek conn.log; Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify outbound network connections in Zeek conn.log from internal hosts to external IPs or domains identified through threat intelligence feeds or OSINT as associated with adversary staging infrastructure for malware. Analyze http.log for specific file requests from these destinations. Use frequency analysis of connections to these external staging points from various internal hosts and correlate with internal host activity to prioritize investigations."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]