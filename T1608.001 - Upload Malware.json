
[
  {
    "Has the adversary uploaded malware to external infrastructure for subsequent use in an attack against the organization? (TA0042 - Resource Development)": {
      "Indicators": {
        "T1608.001 - Upload Malware": {
          "File download or network connection from/to an external domain, IP, or URL known to be a malware staging or distribution point.": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek files.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Inner join network connection logs (Zeek conn.log destination IPs/domains) and file download logs (Zeek http.log host/URI fields, Zeek files.log source field) with a high-confidence, frequently updated (e.g., hourly) threat intelligence feed of known malware hosting infrastructure, command and control servers, and malicious domains. Alert on any matches and investigate the associated host and user activity."
          },
          "File download of a high-risk file type originating from a known public file-sharing service not sanctioned for business use or from a recently registered domain (NRD).": {
            "Data": "Zeek http.log; Zeek dns.log; Zeek files.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Maintain a list of non-sanctioned public file-sharing service domains (e.g., Pastebin, AnonFiles, Mega). Monitor Zeek http.log for downloads where the `host` field matches this list. Separately, analyze Zeek dns.log to identify domains with a recent creation date by enriching logs with WHOIS data. Correlate these NRDs with file download events (Zeek files.log, http.log) and flag downloads of high-risk file types (e.g., .exe, .dll, .ps1, .zip) from these suspicious sources. Use descriptive statistics to find rare or new file-sharing domains being used."
          },
          "An internal host downloads a high-risk file (e.g., executable, script, or encrypted archive) from an external source exhibiting multiple low-reputation attributes.": {
            "Data": "Zeek http.log; Zeek files.log; Zeek ssl.log; Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Develop a risk score for file downloads by correlating multiple data points. Analyze Zeek http.log and files.log to identify downloads of files with high-risk MIME types or extensions (.exe, .dll, .ps1, .vbs, .zip). For each download, check for low-reputation attributes: analyze Zeek ssl.log for `validation_status` of 'self-signed' or other certificate anomalies; check Zeek conn.log source IP against reputation databases; and identify domains that are uncategorized by web proxies. Use correlation analysis to flag downloads where multiple risk factors are present (e.g., executable file + self-signed cert + new domain)."
          },
          "A process is created on a host that corresponds to a recently downloaded high-risk file, especially when the download originated from a suspicious source and the new process immediately initiates outbound network connections.": {
            "Data": "Windows Event ID 4688; Zeek files.log; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate file download events observed on the network (Zeek files.log) with process creation events on endpoints (Windows Event ID 4688). Link the downloaded file name/hash to the `NewProcessName` or `CommandLine` field in the event log. If a process is spawned from a file downloaded within a short time window (e.g., < 5 minutes), especially from a source flagged as suspicious by other detections (NRD, known malicious IP, low reputation), and this new process then initiates its own outbound connections (observed in Zeek conn.log), this sequence strongly indicates execution of staged malware. Use time series analysis to detect beaconing behavior from the new process."
          }
        }
      },
      "version": "2.0",
      "last_updated": "2025-05-11"
    }
  }
]
