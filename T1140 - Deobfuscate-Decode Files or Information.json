[
  {
    "Is the adversary using deobfuscation or decoding techniques to evade defenses? (TA0005 - Defense-Evasion)": {
      "Indicators": {
        "T1140 - Deobfuscate-Decode Files or Information": {
          "Execution of system utilities like certutil with command line arguments indicative of decoding/deobfuscation activities.": {
            "Data": "Windows Event ID 4688; Windows Event ID 1",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation events (Windows Event ID 4688, Sysmon Event ID 1) for executions of 'certutil.exe' or similar utilities. Analyze command line arguments for keywords like '-decode', '-urlcache', base64 strings, or file path patterns indicative of decoding. Use frequency analysis to identify rare or unusual command line patterns for these utilities compared to baseline."
          },
          "Execution of scripting interpreters or archive tools with suspicious command lines or file paths, potentially involving reassembly or decoding.": {
            "Data": "Windows Event ID 4688; Windows Event ID 1",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation events (Windows Event ID 4688, Sysmon Event ID 1) for scripting interpreters (powershell.exe, cmd.exe, wscript.exe) or archive utilities (winrar.exe, 7z.exe) with suspicious command lines (e.g., involving 'copy /b', 'type', unusual file extensions) or targeting uncommon locations. Correlate execution with other suspicious activity like file writes."
          },
          "Download or retrieval of potentially encoded/obfuscated files using utilities like certutil from external sources, immediately followed by decode attempts.": {
            "Data": "Zeek http.log; Windows Event ID 4688; Windows Event ID 1",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation events (Windows Event ID 4688, Sysmon Event ID 1) for executions of 'certutil.exe' or other download utilities (e.g., bitsadmin.exe, wget.exe if present) with arguments specifying URLs or file download operations. Correlate these executions with Zeek http.log for matching source/destination IPs and URLs. Investigate downloads of files with suspicious extensions (e.g., .cer, .txt disguised as certificates) or from unusual sources, especially if immediately followed by subsequent executions of decoding utilities or scripting interpreters attempting deobfuscation using correlation analysis based on timestamps and process lineage."
          },
          "Creation or modification of executable files resulting from suspicious command line operations (like copy /b, type) or extraction from password-protected archives in unusual locations.": {
            "Data": "Windows Event ID 4688; Windows Event ID 1; Windows Event ID 4663",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation events (Windows Event ID 4688, Sysmon Event ID 1) for scripting interpreters (cmd.exe, powershell.exe) or file manipulation commands ('copy', 'type') with arguments indicative of binary reassembly (e.g., 'copy /b', multiple source files, output to a potential executable path). Correlate these executions with file write/modify events (Windows Event ID 4663 if configured for relevant paths and extensions) creating or modifying executable files (.exe, .dll) or common script types (.ps1, .bat) in unusual locations (e.g., user profile directories, Temp). Use frequency analysis on file write locations and source processes to identify anomalies. Additionally, monitor for command lines involving common archiving utilities (e.g., 7z.exe, WinRAR.exe) with password-related arguments or targeting unusual destinations, potentially linked to user execution prompts."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]