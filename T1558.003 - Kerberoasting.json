[
  {
    "Is the adversary attempting to steal credentials using Kerberoasting? (TA0006 - Credential-Access)": {
      "Indicators": {
        "T1558.003 - Kerberoasting": {
          "Numerous Kerberos TGS service ticket requests (Event ID 4769) made by a single account within a short timeframe.": {
            "Data": "Windows Event ID 4769",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4769 logs across Domain Controllers. Group events by Account Name. Calculate the request rate and total volume of TGS tickets requested per account within sliding time windows (e.g., 5 minutes, 1 hour). Flag accounts with significantly higher-than-average request rates or total volumes using statistical methods like z-score or IQR analysis on the count/rate distributions."
          },
          "Kerberos TGS service ticket requests (Event ID 4769) specifically requesting RC4 encryption (Type 0x17).": {
            "Data": "Windows Event ID 4769",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4769 logs across Domain Controllers. Filter events to identify requests where the Ticket Encryption Type field corresponds to RC4 (Type 0x17). Investigate all accounts making such requests, especially if they are not known service accounts or have no legitimate need for RC4 encrypted tickets."
          },
          "Numerous requests for distinct Service Principal Names (SPNs) made by a single client principal within a short time period, observed in Kerberos network traffic.": {
            "Data": "Zeek kerberos.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek kerberos.log. Group events by client principal (e.g., cname, crealm). For each client, count the number of unique server principals (SPNs - sname, srealm) requested within sliding time windows (e.g., 1 minute, 5 minutes). Calculate the mean and standard deviation of unique SPN requests per client. Flag clients that request an unusually high number of unique SPNs (e.g., exceeding 3 standard deviations above the mean, or based on percentile thresholds) compared to baseline activity for that client or across all clients."
          },
           "Kerberos TGS service ticket requests (Event ID 4769) for high-value SPNs made by standard user accounts that do not typically access the associated service.": {
            "Data": "Windows Event ID 4769",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4769 logs across Domain Controllers. Maintain a list of high-value SPNs (e.g., based on service type like SQL, Exchange, or asset criticality). For requests targeting these SPNs, identify the Account Name requesting the ticket. Establish a baseline of which user accounts normally request tickets for these high-value SPNs using historical data (e.g., frequency analysis). Flag requests from user accounts that fall outside of this established baseline (e.g., accounts that have never requested this SPN before or rarely do)."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]