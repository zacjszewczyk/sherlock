[
  {
    "Is the adversary using a rogue domain controller for defense evasion or persistence? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1207 - Rogue Domain Controller": {
          "Anomalous Active Directory replication traffic or events originating from a non-Domain Controller host.": {
            "Data": "Windows Event ID 4928, Windows Event ID 4929, Zeek dce_rpc.log",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4928 and 4929 on Domain Controllers for replication events. Correlate these events with network traffic logs (Zeek dce_rpc.log) to identify DRS calls (DrsAddEntry, DrsReplicaAdd, GetNCChanges). Analyze the source IPs of replication traffic/events. Flag traffic originating from IPs not present in the list of authorized Domain Controllers. Use time series analysis to detect spikes or deviations from baseline replication traffic volume/frequency."
          },
          "Creation of new nTDSDSA objects or unusual Kerberos SPN activity associated with Directory Replication Service (DRS) on non-DC hosts.": {
            "Data": "Windows Event ID 4662, Windows Event ID 4769, Zeek krb.log",
            "Data Platform": "Servers, Endpoints, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Domain Controllers for Windows Event ID 4662 (Object Modified) on the Configuration partition for nTDSDSA objects (requires specific SACL). Monitor Windows Event ID 4769 (Kerberos Service Ticket Requested) and Zeek krb.log for requests for DRS SPNs (GUID E3514235–4B06–11D1-AB04–00C04FC2DCD2). Identify the source hosts of these SPN requests. Use frequency analysis or outlier detection (e.g., box plot on event counts per host) to identify hosts requesting DRS SPNs that are not designated Domain Controllers."
          }
        }
      }
    }
  }
]