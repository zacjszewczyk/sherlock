[
  {
    "Has the adversary accessed credentials via web portal capture? (TA0006 - Credential Access)": {
      "Indicators": {
        "T1056.003 - Web Portal Capture": {
          "Unauthorized changes to files on the external-facing web portal server, particularly login page files.": {
            "Data": "Windows Event ID 4663, Windows Event ID 4656, Windows Event ID 4657",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4663, 4656, 4657 on web portal servers for modifications or read access to critical login page files (e.g., index.html, login.asp/php, javascript files). Baseline normal file access patterns by trusted processes/users and use correlation analysis to identify unauthorized or anomalous access events."
          },
          "Outbound network connections from the web portal server to unusual or external destinations, potentially containing captured credential data.": {
            "Data": "Zeek conn.log, Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and http.log originating from the web portal server. Identify connections to non-standard ports or external IPs that do not belong to known legitimate services. Use frequency analysis and time series analysis to identify unusual connection destinations or sudden changes in connection volume to new destinations."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  },
  {
    "Is the adversary collecting data via web portal capture? (TA0009 - Collection)": {
      "Indicators": {
        "T1056.003 - Web Portal Capture": {
          "Creation or modification of files on the web portal server potentially used to store captured credentials.": {
            "Data": "Windows Event ID 4663",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4663 (write access) on web portal servers for the creation or modification of files with unusual names or in unexpected directories, particularly those that could store credentials. Use descriptive statistics to identify file types or locations with high rates of anomalous changes."
          },
          "Anomalous outbound data transfer volume or patterns from the web portal server that could indicate exfiltration of collected credentials.": {
            "Data": "Zeek conn.log, Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for outbound byte counts from the web portal server. Calculate descriptive statistics (mean, median, quartiles) and use box plots or IQR analysis to identify sessions with unusually large outbound data transfers. Use time series analysis to detect spikes in outbound data volume that deviate significantly from the baseline."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]