[
  {
    "Is the adversary collecting data from the network or systems using automated techniques? (TA0009 - Collection)": {
      "Indicators": {
        "T1119 - Automated Collection": {
          "Detection of unusual process accessing multiple files in rapid succession across different directories, potentially followed by copy operations.": {
            "Data": "Windows Event ID 4656, Windows Event ID 4663, Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event IDs 4656 and 4663 (if configured/Sysmon) for file access events. Identify processes accessing a high number of files within a short time window across diverse paths. Use descriptive statistics (e.g., mean, standard deviation) and outlier detection on file access counts per process over time. Correlate with process creation (Event ID 4688) and file copy commands."
          },
          "Execution of command-line tools or scripts (PowerShell, WMI) performing file discovery or data exfiltration commands.": {
            "Data": "Windows Event ID 4688, Windows Event ID 4104",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 and 4104 for suspicious command-line arguments or script block content related to file discovery, compression, or transfer (e.g., find, copy, compress-archive, Invoke-WebRequest). Look for entropy increases in command-line arguments that might indicate obfuscation. Use correlation analysis to link script execution with subsequent file access or network connection events (Zeek conn.log)."
          }
        }
      }
    }
  }
]