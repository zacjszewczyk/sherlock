[
  {
    "Has the adversary impacted systems or data by defacing internal resources? (TA0040 - Impact)": {
      "Indicators": {
        "T1491.001 - Internal Defacement": {
          "Unplanned content changes detected on internal web pages or system login banners.": {
            "Data": "Zeek http.log; Application Logs",
            "Data Platform": "Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor internal web server logs (access, error) and application logs for unusual GET/POST requests, status codes, or error messages indicative of content modification attempts. Use time series analysis on web request volume/type to detect anomalies. Implement automated content monitoring tools or integrity checks on critical internal web pages and login banners. Analyze Zeek http.log for suspicious activity like mass uploads or modifications (e.g., PUT/POST requests)."
          },
          "Anomalous application or system log entries indicating attempts or success in modifying system configuration or content (e.g., changing desktop wallpaper, altering system files).": {
            "Data": "Windows Event ID 4688; Windows Event ID 4656; Windows Event ID 4663; Application Logs",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event logs (4688 for process creation, 4656/4663 for object access) for processes attempting to modify system files, registry keys (especially those related to desktop settings, logon screens), or execute commands associated with file manipulation or display settings. Analyze process execution paths and command line arguments. Use frequency analysis on file modification events for unusual patterns or concentrations on specific systems."
          },
          "Network traffic indicating bulk file uploads or modifications to internal web server directories not typically accessed for content updates.": {
            "Data": "Zeek http.log; Zeek file.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek http.log for PUT/POST requests targeting internal web server directories. Analyze request volumes, source IPs, and file extensions. Correlate with Zeek file.log entries showing file transfers over HTTP to identify unusual file types or sizes uploaded to web servers. Use frequency analysis to identify rare source IPs or sudden spikes in file modification activity towards internal web assets."
          },
          "Execution of system utilities or scripts attempting to modify desktop wallpaper or system login background files/registry keys on multiple endpoints or servers.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4656; Windows Event ID 4663",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 on endpoints and servers for processes like `reg.exe`, `powershell.exe`, `cmd.exe`, or specific image viewers/editors executing with command-line arguments targeting known wallpaper or login screen file paths or registry keys (e.g., `HKCU\\Control Panel\\Desktop\\Wallpaper`, `HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Authentication\\LogonUI\\Background`). Correlate with Event IDs 4656/4663 logging write attempts to these specific files or registry keys. Use correlation analysis to identify instances where multiple systems are targeted from a common source or within a short timeframe."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]