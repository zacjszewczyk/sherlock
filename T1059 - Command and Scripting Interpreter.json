[
  {
    "Is the adversary executing commands and scripts on target systems? (TA0002 - Execution)": {
      "Indicators": {
        "T1059 - Command and Scripting Interpreter": {
          "Execution of command/script interpreters with unusual or suspicious command-line arguments or parent-child relationships.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) logs. Filter for executions of known command/script interpreters (cmd.exe, powershell.exe, python.exe, cscript.exe, wscript.exe). Analyze command-line arguments for suspicious keywords, encoded commands, or long/obfuscated strings. Identify unusual parent-child process relationships (e.g., Office applications spawning cmd/powershell). Use frequency analysis to identify rare or never-before-seen command lines for these interpreters."
          },
          "Creation or modification of script files in unusual locations followed by their execution.": {
            "Data": "Windows Event ID 4656, Windows Event ID 4663, Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4656/4663 for file writes/modifications of script file extensions (.ps1, .bat, .cmd, .py, .vbs, .js) in unusual directories (e.g., %TEMP%, user profile directories). Correlate these write events with subsequent Windows Event ID 4688 showing execution of the created script file. Use time series analysis or correlation to detect clustered file write and execution events within short periods."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]