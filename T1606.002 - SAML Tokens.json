[
  {
    "Has the adversary accessed credentials using forged SAML tokens? (TA0006 - Credential-Access)": {
      "Indicators": {
        "T1606.002 - SAML Tokens": {
          "SAML SSO logins to service providers without corresponding authentication events in the domain (e.g., missing Windows Event IDs 4769, 1200, 1202).": {
            "Data": "Windows Event ID 4769, Windows Event ID 1200, Windows Event ID 1202",
            "Data Platform": "Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Query Windows Event Logs (4769, 1200, 1202) on domain controllers for successful SAML authentication events. Identify periods or users where SAML-based access to resources occurred but corresponding domain events are missing. Correlate based on timestamps and user identities if available. Investigate discrepancies indicating potentially forged tokens bypassing standard domain authentication logging."
          },
          "Anomalous SAML SSO login source IP addresses or patterns inconsistent with user behavior (e.g., logins from unusual geolocations, logins occurring at odd hours).": {
            "Data": "Zeek conn.log, Windows Event ID 4624",
            "Data Platform": "Network devices, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek conn.log for connections to known SAML service provider endpoints. Extract source IP addresses and connection timestamps. Geolocate source IPs and calculate frequency distribution of source countries/regions and connection times. Identify anomalies using descriptive statistics, IQR, or percentile analysis to flag connections from unusual locations or occurring outside typical business hours. Additionally, analyze Windows Event ID 4624 events that may follow successful SAML authentication if resources are accessed on-premise."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]