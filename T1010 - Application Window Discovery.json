[
  {
    "Is the adversary attempting to discover open application windows? (TA0007 - Discovery)": {
      "Indicators": {
        "T1010 - Application Window Discovery": {
          "Execution of commands or scripts associated with listing open windows (e.g., specific PowerShell or command prompt commands).": {
            "Data": "Windows Event ID 4688, Windows Event ID 4104",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 (Process Creation) and Windows Event ID 4104 (PowerShell Script Block Logging) for command lines or script blocks containing keywords or patterns indicative of window enumeration commands (e.g., Get-Process, tasklist, query user). Identify frequency and correlation of these commands across hosts."
          },
          "Suspicious process activity making calls associated with enumerating windows, potentially from unexpected locations or in conjunction with other suspicious behavior.": {
            "Data": "Windows Event ID 4688, Zeek conn.log",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for process creation events. Analyze process execution paths and parent-child relationships. Identify processes running from unusual locations or with suspicious names (e.g., using frequency analysis to find rare processes). Correlate identified processes with network connections logged in Zeek conn.log to detect potential C2 communication or data exfiltration attempts."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]