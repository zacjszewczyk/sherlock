[
  {
    "Is the adversary attempting to evade defenses by modifying process arguments? (TA0005 - Defense Evasion)": {
      "Indicators": {
        "T1036.011 - Overwrite Process Arguments": {
          "Linux process command lines that do not match the expected command or contain suspicious spoofed strings.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect Windows Event ID 4688 for process creation. Analyze command line arguments. Compare observed command lines against a baseline of expected commands using correlation analysis or frequency distribution to identify rare or potentially spoofed process arguments. Cross-reference initiating process with Zeek conn.log for suspicious network destinations."
          },
          "Unusual process behavior or network activity originating from a process exhibiting signs of argument modification.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect Windows Event ID 4688 for process creation. Monitor Zeek conn.log for connections from endpoints/servers where defense evasion might occur. Identify connections with anomalous entropy in destination patterns or unusual protocols. Use time series analysis on connection volume/patterns from specific hosts/processes to detect deviations that might signal successful evasion and subsequent malicious activity."
          },
          "Process creation with an initial command line that is inconsistent with its subsequent network activity or observed process path.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect Windows Event ID 4688 (Process Creation), capturing process path, command line, and parent process. Correlate these events with Zeek conn.log network connections originating from the corresponding process/host (using process ID, if available and logged, or host/timestamp correlation). Compare the initial command line from 4688 against the network behavior observed in Zeek logs. Flag instances where processes with seemingly benign command lines (e.g., common system processes) exhibit unexpected network destinations, protocols, or data volumes, using frequency analysis or baseline comparisons via descriptive statistics."
          },
          "Identification of process command lines matching common spoofing targets followed by suspicious process behavior or network connections.": {
            "Data": "Windows Event ID 4688; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Gather intelligence on process names and command lines commonly targeted for argument spoofing (e.g., legitimate system process names). Filter Windows Event ID 4688 logs for process creations where the initial command line matches these known spoofing targets. For these processes, examine their parent processes and correlate with Zeek conn.log entries to identify any associated outbound network connections. Use correlation analysis or join operations to find connections to suspicious destinations (e.g., C2 servers, unusual external IPs) originating from these potentially spoofed processes."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]