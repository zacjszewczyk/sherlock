[
  {
    "Is the adversary performing process discovery on systems or network devices? (TA0007 - Discovery)": {
      "Indicators": {
        "T1057 - Process Discovery": {
          "Execution of suspicious commands or scripts (tasklist, Get-Process) or unusual API calls related to process enumeration on endpoints/servers.": {
            "Data": "Windows Event ID 4688",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 logs for process creations containing suspicious command-line arguments associated with process enumeration utilities (tasklist, powershell Get-Process, ps) or known adversary tools. Use frequency analysis or clustering to identify rare or unusual command-line patterns executed on multiple systems."
          },
          "Unusual network activity originating from a host, potentially indicative of remote process discovery or interaction with network devices via CLI.": {
            "Data": "Zeek conn.log, Zeek ssh.log",
            "Data Platform": "Network devices, Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for connections to or from systems/users where process discovery is suspected. Look for connections to common network device management ports (e.g., SSH, Telnet) followed by unusual data transfer volumes or specific command patterns if logged (e.g., in Zeek ssh.log). Use correlation analysis to link specific host activity with network connections at the same time."
          }
        }
      }
    }
  }
]