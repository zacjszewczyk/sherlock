[
  {
    "Has the adversary used exploitation techniques to gain credential access? (TA0006 - Credential-Access)": {
      "Indicators": {
        "T1212 - Exploitation for Credential Access": {
          "System logs showing crashes or abnormal behavior in processes targeted by known credential exploitation vulnerabilities (e.g., authentication services, domain controller processes).": {
            "Data": "Windows Application Logs; Windows System Logs",
            "Data Platform": "Servers, Endpoints",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Application and System logs for crash reports or errors related to targeted authentication services or processes (e.g., Lsass.exe, Kerberos services). Use time series analysis to identify unusual spikes in crash occurrences for these specific processes compared to historical baseline."
          },
          "Successful authentication attempts using credentials exhibiting suspicious patterns (e.g., associated with replay attacks, used from unusual locations/times, used for accessing resources not normally accessed by that account).": {
            "Data": "Windows Event ID 4624; Windows Event ID 4625; Zeek conn.log; Zeek Kerberos.log; Zeek NTLM.log",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect successful and failed authentication logs (Windows Event ID 4624, 4625, Zeek conn.log for Kerberos/NTLM, Zeek Kerberos.log, Zeek NTLM.log). Identify accounts with a sudden increase in failed login attempts followed by success using statistical analysis of login sequences. Analyze login source IPs and times for accounts showing unusual behavior using descriptive statistics and percentile analysis. Use correlation analysis to link suspicious login activity to specific accounts or source IPs. Identify accounts logging in from rare geographic locations or during atypical hours using frequency analysis and deviation from baseline behavior."
          },
          "Detection of repeated, identical authentication requests (potential replay attack) against services that shouldn't exhibit this behavior.": {
            "Data": "Zeek conn.log; Zeek Kerberos.log; Zeek NTLM.log; Windows Event ID 4624; Windows Event ID 4768; Windows Event ID 4769",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze authentication logs (Zeek Kerberos.log, NTLM.log, Windows Event ID 4624, 4768, 4769) for patterns of identical authentication requests (same source IP, account, timestamp or sequence number within a short period) that deviate from expected behavior for specific services. Group authentication events by source IP and target service/account. Use frequency analysis and time series analysis to identify clusters of repeated requests inconsistent with legitimate client behavior, potentially indicating replay attacks."
          },
          "Detection of forged Kerberos tickets or authentication activity inconsistent with legitimate ticket attributes (e.g., related to MS14-068 exploitation).": {
            "Data": "Zeek Kerberos.log; Windows Event ID 4768; Windows Event ID 4769; Windows Event ID 4624",
            "Data Platform": "Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek Kerberos.log for suspicious ticket attributes (e.g., unusual Ticket Flags, PAC validation failures). Monitor Windows Event ID 4768 (AS Ticket) and 4769 (TGS Ticket) for signs of MS14-068 exploitation (e.g., checking PAC signature status where available). Correlate authentication events (Event ID 4624) involving accounts or tickets that exhibit suspicious Kerberos attributes or anomalies detected in Kerberos logs using correlation analysis. Identify and investigate authentication events associated with potential forged tickets."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]