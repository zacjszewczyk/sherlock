[
  {
    "Is the adversary performing reconnaissance on our network? (TA0043 - Reconnaissance)": {
      "Indicators": {
        "T1595.002 - Vulnerability Scanning": {
          "High volume of network connections or connection attempts from external sources targeting multiple ports or services.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for external source IPs attempting connections to a high number of distinct destination ports or internal IPs within a short time frame. Use statistical analysis (e.g., frequency distribution, entropy measures on destination ports per source IP) to identify potential scanning activity. Flag source IPs exceeding a defined threshold of distinct ports or IPs contacted."
          },
          "Network traffic containing suspicious User-Agent or Referer strings commonly used by scanning tools.": {
            "Data": "Zeek http.log; Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek http.log for connections originating externally and containing unusual or known scanning tool User-Agent or Referer strings. Correlate these with connection patterns in Zeek conn.log from the same source IPs. Use correlation analysis between specific header values and connection patterns. Flag connections matching known malicious patterns or tools."
          },
          "Network traffic requesting specific files or endpoints commonly used to identify software versions or configurations (e.g., /server-status, /VERSION, robots.txt).": {
            "Data": "Zeek http.log; Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek http.log for external source IPs making GET requests to specific file paths (e.g., `/server-status`, `/VERSION`, `/CHANGELOG`, `/README`, `/.git/config`, `/.env`, `robots.txt`) known to reveal server or application details. Correlate these requests with connection patterns in Zeek conn.log from the same IPs. Use frequency analysis to identify external IPs requesting multiple such paths within a short period. Flag IPs exceeding a defined threshold of requests to such paths."
          },
          "Network connection attempts to internal services (e.g., SMB, RDP, SSH on non-standard external ports) from external sources characteristic of service enumeration or banner grabbing.": {
            "Data": "Zeek conn.log; Zeek dce_rpc.log; Zeek rdp.log; Zeek ssh.log; Zeek smb_mapping.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for external source IPs attempting connections to services like SMB (445), RDP (3389), SSH (22), or others not expected to be externally accessible. Filter for connections with short durations and minimal bytes transferred (using 'orig_bytes' and 'resp_bytes' in conn.log), which can indicate simple connection checks or banner grabbing. Correlate findings with service-specific logs (e.g., zeek ssh.log for version details, zeek smb_mapping.log for attempts to map shares) to identify enumeration attempts. Use frequency analysis on target ports/services per source IP attempting connections, flagging outliers."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]