```json
[
  {
    "Is the adversary performing vulnerability scanning against our external-facing infrastructure? (TA0043 - Reconnaissance)": {
      "Indicators": {
        "T1595.002 - Vulnerability Scanning": {
          "Vulnerability scanning activity originating from IP addresses known to be malicious, part of public scanning projects, or associated with known adversarial infrastructure.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Continuously correlate source IP addresses from all inbound traffic in Zeek conn.log against a high-confidence, frequently updated cyber threat intelligence (CTI) feed of known scanning IPs, malicious botnets, TOR exit nodes, and public scanning services (e.g., Shodan, Censys). Generate high-priority alerts for any connections originating from these sources, regardless of connection state (succeeded, rejected), and investigate for further malicious activity."
          },
          "Web requests containing suspicious User-Agent strings of known scanning tools or probes for specific files and endpoints indicative of web application vulnerability scanning.": {
            "Data": "Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Filter Zeek http.log for external requests with User-Agent strings matching a maintained list of known scanning tools (e.g., 'nmap', 'sqlmap', 'zgrab', 'masscan', 'acunetix', 'feroxbuster'). Additionally, monitor for requests targeting common reconnaissance paths (e.g., '/.git/config', '/.env', '/server-status', '/wp-admin') or containing common vulnerability scanner payloads (e.g., '.../../../etc/passwd', '<script>alert(1)</script>', 'UNION SELECT'). Use regular expressions for pattern matching and alert on matches or a high frequency of such probes from a single source."
          },
          "Connection attempts to specific services (e.g., SSH, RDP, Telnet) followed by protocol-specific interactions consistent with banner grabbing or version enumeration without a valid session establishment.": {
            "Data": "Zeek conn.log; Zeek ssh.log; Zeek rdp.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Zeek service-specific logs (e.g., Zeek ssh.log, rdp.log) for external connections where client and server version information is exchanged but no authentication is attempted or the connection is immediately terminated. Correlate these events with Zeek conn.log to identify sources that perform this activity across multiple hosts or ports. Look for patterns like successful SSH handshakes without a subsequent login attempt or an RDP connection that closes after the initial bitmap data exchange. Use frequency analysis to flag IPs repeatedly performing these actions."
          },
          "A single external source attempting to connect to a large number of distinct ports on one or more hosts, indicative of horizontal or vertical port scanning.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log by aggregating on source IP over short time windows (e.g., 5 minutes). For each source IP, calculate the count of distinct destination ports and distinct destination IPs. Calculate the entropy of the destination ports contacted by a single source. Flag source IPs that exceed a statistically derived threshold for port count (e.g., > 3 standard deviations from the mean of all sources, or a fixed number like >50 ports) or exhibit high port entropy, which indicates scanning behavior rather than legitimate traffic."
          },
          "A single external source attempting to connect to a common port across a wide range of hosts within the network address space, indicative of a network sweep or host discovery.": {
            "Data": "Zeek conn.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log by aggregating on source IP and destination port over short time windows (e.g., 5 minutes). For each source/port pair, calculate the count of distinct destination IPs contacted. Flag external sources that contact an unusually large number of distinct internal hosts on a single port (e.g., 445, 443, 80, 22, 3389). Use descriptive statistics and percentile analysis (e.g., flag sources in the 99th percentile) on the count of destination IPs per source to identify outliers performing network sweeps."
          },
          "A single external source exhibiting multiple, distinct types of scanning behaviors over a period of time, such as port scanning followed by targeted web vulnerability scanning on discovered open ports.": {
            "Data": "Zeek conn.log; Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Implement a risk scoring system for external source IPs based on alerts from other scanning detections. Correlate alerts over time (e.g., within 1 hour). If a source IP triggers a port scan alert and subsequently triggers a web vulnerability probe or banner grabbing attempt against a discovered open port on the same target host, escalate the priority of the alert. Use correlation analysis to link these disparate events into a single, higher-fidelity alert representing a multi-stage reconnaissance campaign from a single actor."
          }
        }
      },
      "version": "2.0",
      "last_updated": "2025-05-11"
    }
  }
]
```