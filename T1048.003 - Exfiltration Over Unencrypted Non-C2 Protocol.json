[
  {
    "Is the adversary exfiltrating data from the network over unencrypted non-C2 protocols? (TA0010 - Exfiltration)": {
      "Indicators": {
        "T1048.003 - Exfiltration Over Unencrypted Non-C2 Protocol": {
          "Network traffic from internal hosts exhibiting significantly higher outbound data volume than normal or expected for the protocol/service.": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek ftp.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log, http.log, ftp.log. Calculate outbound data volume (bytes sent) per internal host and destination. Establish baseline traffic patterns using descriptive statistics (mean, median, std dev) and time series analysis. Identify hosts/connections with outbound volume significantly exceeding baselines or exhibiting unusual spikes using methods like Z-score, IQR, or cumulative sum (CUSUM)."
          },
          "Network traffic containing data formatted or encoded inconsistently with the expected protocol standard (e.g., base64 encoded data in unencrypted HTTP requests).": {
            "Data": "Zeek conn.log; Zeek http.log; Zeek ftp.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek http.log (request/response bodies, headers), ftp.log (commands, arguments) for suspicious data patterns. Look for high entropy strings (potential encoding/obfuscation) in unencrypted protocols using entropy measures. Identify uncommon character sets or patterns indicative of obfuscated data (e.g., excessive base64 in fields not typically containing it). Correlate with known encoding techniques."
          },
          "Network connections to external destinations made by processes not typically expected to initiate outbound network communication.": {
            "Data": "Windows Event ID 4688; Windows Event ID 5156; Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Baseline network communication patterns for known processes (Windows Event ID 5156, Zeek conn.log). Monitor Windows Event ID 4688 for process creation events. Correlate process names and command lines from 4688 with network connections (5156, Zeek conn.log). Flag connections initiated by processes with no prior history of external network communication or known internally as non-network-aware applications. Use frequency analysis to identify rare process-network connections."
          },
          "Execution of command-line tools or scripts involved in file transfer (e.g., copy, ftp, tftp, bitsadmin) immediately preceding or concurrent with outbound network traffic on unencrypted non-C2 ports.": {
            "Data": "Windows Event ID 4688; Zeek conn.log; Zeek ftp.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor Windows Event ID 4688 for command-line arguments indicating file transfer utilities (e.g., `copy \\remote_host\share\*`, `ftp put`, `tftp -p`, `bitsadmin /transfer`). Correlate these events with concurrent or near-concurrent outbound Zeek conn.log sessions on common unencrypted ports (e.g., 21, 23, 69, 80) to external destinations. Analyze associated Zeek logs (e.g., ftp.log for FTP) and Zeek conn.log for high outbound data volume associated with these command executions. Use time correlation analysis to link process execution time with network connection timestamps."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]