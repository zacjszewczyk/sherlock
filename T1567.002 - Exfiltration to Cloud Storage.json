[
  {
    "Has the adversary exfiltrated sensitive data using cloud storage services? (TA0010 - Exfiltration)": {
      "Indicators": {
        "T1567.002 - Exfiltration to Cloud Storage": {
          "Unusual data upload volume or asymmetric network traffic patterns from internal hosts to known cloud storage services.": {
            "Data": "Zeek conn.log; Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log and http.log for connections to IP ranges or domains associated with known cloud storage services (e.g., Dropbox, Google Drive). Calculate sent_bytes and received_bytes for these connections. Use descriptive statistics or correlation analysis to identify sessions with significantly higher sent_bytes than received_bytes (asymmetric traffic) or hosts with outlier total upload volume to these services using box plots or percentile analysis."
          },
          "Connections to cloud storage services originating from unusual processes or user accounts, or at unusual times/frequencies.": {
            "Data": "Windows Event ID 4688; Windows Event ID 4624; Zeek conn.log; Zeek http.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Correlate Zeek connection logs to cloud storage services with Windows Event ID 4688 (Process Creation) on source hosts to identify the process initiating the connection. Analyze user activity (Event ID 4624, Zeek logs) and process activity associated with these connections for unusual patterns compared to historical baselines using time series analysis or entropy measures on activity timestamps. Flag connections initiated by processes not typically observed accessing cloud storage or by unusual user accounts."
          },
          "Execution of cloud storage client processes or command-line tools followed by unusual file activity or network connections to cloud storage destinations.": {
            "Data": "Windows Event ID 4688; Zeek conn.log; Zeek http.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Identify process creation events (Windows Event ID 4688) for known or suspected cloud storage clients or command-line tools (e.g., curl, wget, powershell accessing cloud domains). Correlate these process executions with outbound connections in Zeek conn.log/http.log to cloud storage destinations. Baseline normal process-to-destination connections per host/user using frequency analysis. Flag instances where a process connects to a cloud storage service for the first time from a specific host, or if the associated network traffic volume (sent_bytes) significantly deviates from historical patterns for that process/host combination using statistical methods like percentiles."
          },
          "Network connections to cloud storage services using non-standard ports/protocols, or exhibiting byte flow characteristics inconsistent with typical client usage.": {
            "Data": "Zeek conn.log; Zeek http.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze Zeek conn.log for connections to IP ranges or domains associated with cloud storage services on ports other than standard HTTP/S (80, 443) or using unexpected protocols. Examine Zeek http.log for unusual request sizes, multipart uploads, or custom header fields associated with cloud storage traffic. Use time series analysis on `orig_bytes`/`resp_bytes` or correlation analysis between traffic size and connection duration to identify potentially disguised large data transfers (e.g., chunking, tunneling)."
          }
        }
      },
      "version": "1.1",
      "last_updated": "2025-05-07"
    }
  }
]