[
  {
    "Has the adversary captured user input to obtain credentials? (TA0006 - Credential-Access)": {
      "Indicators": {
        "T1056 - Input Capture": {
          "Monitoring for specific Windows API calls associated with input capture (e.g., SetWindowsHook, GetKeyState, GetAsyncKeyState).": {
            "Data": "Windows Event ID 4688, Windows Event ID 1 (Sysmon), Windows Event ID 11 (Sysmon)",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor process creation events (Event ID 4688, Sysmon Event ID 1) for processes known to perform API hooking or related low-level input capture. Use correlation analysis to identify processes that create files (Sysmon Event ID 11) or modify handles (Event ID 4656 - if available and relevant) in ways inconsistent with normal application behavior, particularly when combined with suspicious command-line arguments. Use frequency analysis on API calls captured by EDR/Sysmon to identify statistically unusual sequences."
          },
          "Execution of command or scripting interpreter processes with unusual parameters or from unexpected locations, potentially associated with input capture scripts.": {
            "Data": "Windows Event ID 4688, Windows Event ID 1 (Sysmon), Zeek conn.log",
            "Data Platform": "Endpoints, Servers, Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Collect process creation events (Event ID 4688, Sysmon Event ID 1). Filter for common scripting/command interpreters (cmd.exe, powershell.exe, wscript.exe, cscript.exe, etc.). Analyze command-line arguments for suspicious patterns (e.g., long obfuscated strings, references to input-related functions/modules). Use frequency analysis and percentile calculations on process execution paths and arguments to identify rare or unusual instances. Correlate these processes with outbound network connections in Zeek conn.log."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  },
  {
    "Has the adversary captured user input to collect information? (TA0009 - Collection)": {
      "Indicators": {
        "T1056 - Input Capture": {
          "Presence of unauthorized or unusual drivers or kernel modules on endpoints or servers.": {
            "Data": "Windows Event ID 7045, Windows Event ID 4697, Windows Event ID 5136",
            "Data Platform": "Endpoints, Servers",
            "NAI": "Insert site-specific NAI here",
            "Action": "Monitor service installation events (Event ID 7045, 4697) and directory service changes related to services (Event ID 5136). Cross-reference installed service/driver names against known legitimate lists or threat intelligence feeds. Use time series analysis to identify spikes in service installations or installations occurring outside scheduled maintenance windows."
          },
          "Network traffic patterns consistent with exfiltration of captured input data from endpoints or servers.": {
            "Data": "Zeek conn.log, Zeek http.log, Zeek dns.log",
            "Data Platform": "Network devices",
            "NAI": "Insert site-specific NAI here",
            "Action": "Analyze network connection logs (Zeek conn.log, http.log, dns.log) from endpoints/servers. Identify connections to external destinations, particularly those with unusual data transfer sizes or patterns inconsistent with normal activity (e.g., large uploads following user logon). Use correlation analysis to link suspicious network traffic to process execution events (Event ID 4688/Sysmon 1) on the originating host. Use entropy measures on data streams to identify potentially encoded or encrypted exfiltration."
          }
        }
      },
      "version": "1.0",
      "last_updated": "2025-05-04"
    }
  }
]